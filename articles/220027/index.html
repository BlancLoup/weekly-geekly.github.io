<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Who does BillGates attack?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It seems that the BillGates botnet is spreading more and more - already 4 familiar people have asked me how to get rid of it, and what it is. 
 I mana...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Who does BillGates attack?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3b5/b64/35b/3b5b6435b77e71c5de244f71f13e5094.jpg" alt="image"><br><br>  It seems that the <a href="http://habrahabr.ru/post/213973/">BillGates</a> botnet <a href="http://habrahabr.ru/post/213973/">is</a> spreading more and more - already 4 familiar people have asked me how to get rid of it, and what it is. <br>  I managed to get a fresh version that worked fine on my system (I got commands from the server and DOS-silt), and it's fun! <br><br><h4>  What changed? </h4><br>  The <b>‚ÄúGates‚Äù</b> module now consists of 2 modules: <b>‚ÄúBeikong‚Äù</b> and <b>‚ÄúMonitor (moni)‚Äù</b> .  If it runs along the path <b>/ usr / bin / pojie</b> (in my case), then moni runs, if on some other path, then Beikong.  Beikong, in essence, is a hrenoten who reconfigures and updates other modules, and moni monitors the status of all modules (and restarts them if necessary), collects statistics from them and sends it to the server via Beikong.  If <b>/ usr / bin / pojie</b> does not exist, then Beikong will copy itself there and launch it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/277/b99/080/277b99080159aebdf5e39fa2afa28d1b.png" alt="image"><a name="habracut"></a><br><br><img src="https://habrastorage.org/getpro/habr/post_images/dad/e75/9a3/dade759a353ba0f62e41d5d552bf08b1.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/abf/270/c56/abf270c560d4fb7a19b8583779eff641.png" alt="image"><br><br>  Beikong writes the path to itself in <b>/tmp/notify.file</b> , and moni writes its PID to <b>/tmp/moni.lock</b> . <br>  Gates is still dropping a simple DDoS module packed with UPX (in my case, it was again called cupsddh). <br>  No more major changes. <br><br><h4>  Time to have fun! </h4><br>  Since the botnet was working on my computer and even started attacking someone, I decided to see how traffic flows between CnC servers and bots.  As expected, there was no encryption, and everything went in the clear. <br>  It should be noted that Gates uses one type of CnC servers (for the Bill module and sending statistics via moni), and <b>‚ÄúMelinda‚Äù</b> (the module I called ‚Äúknocking‚Äù in the previous article. In fact, this is an advanced DDoS module , and I was wrong. There was no name in the code, and I decided to give this) different, and they have a different communication protocol, but there are similarities. <br><br>  At startup, both modules connect to their servers and send a HELLO package: for Gates, it contains the OS name, the kernel, the name and version of the module, and Melinda only the OS name and the kernel. <br>  The data in the packages I replaced in accordance with the recommendations <a href="http://www.youtube.com/watch%3Fv%3DtmPG5WfO14A">of the famous video</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6a7/5c9/ced/6a75c9cedea0c08a5ac46b762c214993.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f5a/ef6/048/f5aef604868f0429748a9cc47ebee5e6.png" alt="image"><br><br>  Then, they exchange PING packets with each other. <br>  Gates CnC can send multiple servers at once to attack via cupsddh.  The module is not very smart, it can attack only via TCP and cannot forge packets, which cannot be said about Melinda, which can attack via TCP, UDP, ICMP and 2 types of DNS. <br><br><h4>  Tracking </h4><br>  In general, I decided to write a tracker for this botnet: a client that would connect to CnC servers and receive commands on DDoS.  The tracker works with both Gates servers and Melinda.  And wrote. <br><br>  <a href="https://github.com/ValdikSS/billgates-botnet-tracker">github.com/ValdikSS/billgates-botnet-tracker</a> <br><br>  For about a week, I tracked the botnet‚Äôs actions and wrote the results into the database. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/974/4d6/183/9744d6183b551d8b5cdf1115cccd9047.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ab2/cc4/8e6/ab2cc48e6d2686b65cc4e49ffa962a86.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/176/214/d13/176214d13b97d92d10d6350db1e3eadf.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c5c/311/504/c5c311504500d4f3b6496fb67e030b5c.png" alt="image"><br><br>  Yes, I'm so lazy that the graphics drew me phpmyadmin. <br>  You can track the botnet's actions in real time here: <br>  <a href="http://billgates.valdikss.org.ru/">billgates.valdikss.org.ru</a> <br><br>  Take care of your servers. </div><p>Source: <a href="https://habr.com/ru/post/220027/">https://habr.com/ru/post/220027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220017/index.html">Hope Microelectronics 24-bit I2C Pressure Sensors HP203B and HP206C</a></li>
<li><a href="../220019/index.html">HD FPV on Raspberry Pi</a></li>
<li><a href="../220021/index.html">From the IT preacher to the designer of medical robots: future professions in IT and robotics</a></li>
<li><a href="../220023/index.html">Use of encryption in Russian companies</a></li>
<li><a href="../220025/index.html">Secure payment card do it yourself</a></li>
<li><a href="../220031/index.html">Writing Penguin Daycare Simulator on Go (Google App Engine) and Lua (Corona SDK)</a></li>
<li><a href="../220033/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ105 (April 13 - 19, 2014)</a></li>
<li><a href="../220035/index.html">Google‚Äôs Universal Analytics came out of Beta and is available at Funding.To</a></li>
<li><a href="../220037/index.html">Ruby on Rails Developer Competency Matrix</a></li>
<li><a href="../220041/index.html">Family stories, dining table and sales growth</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>