<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>To the issue of costing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few days ago I conducted a partnership seminar - training new employees. Concerned the issue of calculating the totals (registers) of the system, in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>To the issue of costing</h1><div class="post__text post__text-html js-mediator-article">  A few days ago I conducted a partnership seminar - training new employees.  Concerned the issue of calculating the totals (registers) of the system, in particular, the calculation of the cost price. <br>  In the evening, one of the listeners sent a link to <a href="http://blogs.technet.com/b/denisfed/archive/2009/05/07/3236801.aspx">an article detailing the issues of cost calculation in MS Axapta</a> . <br>  A request to comment on the main differences in approaches. <br><br><div class="spoiler">  <b class="spoiler_title">The author honestly spent two days at least 8 hours, understanding the text.</b> <div class="spoiler_text">  As a result, I was forced to admit defeat - I was NOT able to figure out how it works. <br>  An incredible amount of special cases, settings, dozens of pages describing how to handle the features of working with each account, cost transfer procedures, and migration of lots. <br>  Having spent two days trying to understand this text, I still did not get a clear understanding of what I need to do if I want to take into account the goods not only in the warehouse, but, for example, in the driver.  Or I want to consider the cost price not only for the goods (these could be claims in the guarantee, objects of fixed assets or anything else - yes, the same money). <br>  In addition, some surprise was caused by the presence of special sections describing the closure of the service warehouse and a description of write-off errors during rounding.  Why even deduct services from the warehouse? <br>  A two-stage system for dealing with rounding residues also did not fit in my head. <br>  Passage type <br><blockquote>  It would be more correct to accumulate the amount of errors on some selected account, and then, when transforming the balance, close this account manually.  In order to achieve this effect, you need to correct the method inventAdj :: errorAccountOperation (), so that it returns the account of rounding errors you need.  I would probably use for this account deviations from the standard cost price.  If standard costing is used, then these accounts just need to be written off for deviations, and if not used, then these accounts are not occupied in setting up the warehouse postings and can be adjusted for writing off errors and rounding off.  If this scheme suits you, it is enough to change the values ‚Äã‚Äãof InventAccountType :: InventProfit and InventAccountType :: InventLoss to InventAccountType :: InventStdProfit and InventAccTType :: InventStdLoss in InventAdj :: errorAccountOperation () method, respectively. </blockquote><br>  on the one hand - they inspire respect, on the other - they inspire horror. </div></div><br>  The study of this document, however, gave the idea of ‚Äã‚Äãpublishing on Habr√© on how the cost calculation is arranged in our country. <br>  I did not describe the details that do not affect the understanding of the essence of the process, if desired, they can be found in the <a href="http://www.ultimabusinessware.com/architecture/">extract from the documentation</a> . <br><br>  The cost calculation is probably one of the most difficult to understand processes in our system, and it is also one of the most ordered.  IMHO. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a spoiler picture: <br><br><img src="https://habrastorage.org/files/974/579/f90/974579f90d9e4f6cb84ef5a8cfde89b6.png"><br><a name="habracut"></a><br>  In our case, the cost calculation is the process of calculating the cost of a specific accounting unit at each of its movement. <br>  Perhaps it sounds incomprehensible, try to explain. <br>  We use totals (similar to registers in 1C) - some analogue of a multidimensional cube, well, or its relational representation.  Accordingly, the total displays the current status of the company‚Äôs measurable indicators. <br>  A textbook example - the remnants of the goods in stock.  The total, with measurements warehouse and goods and variables quantity and amount.  The fact table (which is part of the total) contains the actual data on the changes - we call them transactions, the accountant - the transactions.  The cost calculation system is not limited to the actual cost calculation, but at the platform level it is generalized before calculating the values ‚Äã‚Äãof variable totals in accordance with one or another algorithm.  Such algorithms (or drivers in our terminology) are tied to the results (one for the total). <br><br>  Let's return to the first diagram. <br>  A special service (in this case, not a Windows service, but a service in terms of an application server as a class) participates in the calculation process. TotalCalculator reads the transactions from the fact table, transfers them to the appropriate drivers, and applies the changes to the fact table. <br>  In turn, transactions contain values ‚Äã‚Äãfor dimensions and deltas for variables.  Some of the dimensions and variables may not contain a value at the time the transaction is created.  To be precise, we have 2 fact tables - operational and detailed, which are distinguished by the fact that the detailed is filled in during the work of the totals calculator.  In this case, there is a certain access monopoly, which allows, for example, to use bitmap indexes, and also perform other optimization tricks. <br>  The empty value of a variable in a transaction means that it should be calculated later.  For example, when a product is written off from a warehouse, it is prompt (without executing the FIFO algorithm) that it is impossible to calculate the cost at which goods are written off.  Therefore, the value of the variable quantity is indicated, and the amount is not indicated. <br>  In turn, when purchasing a product (simplifying) the cost is known, and is equal to the purchase price.  In this case, the transaction will indicate the amount and amount. <br><br>  Thus, the driver for the total stock balance implements the FIFO algorithm. <br>  But the driver for the total account balances implements a modified FIFO for the cost of money, taking into account the presence of an overdraft (this assumes the existence of transactions that write off money that was not previously debited).  Proper implementation and organization of drivers would have been impossible if it were not for double-record support - each transaction knows the pair to it.  In a pair, one transaction is always outgoing, the other is incoming (this is determined by the signs of the values ‚Äã‚Äãof the variables, more precisely, the outgoing transaction is always negative, and the incoming one is positive). <br>  The driver receives a pair of entries at the input, and its task is to return the calculated wiring. <br>  Accordingly, the algorithm for calculating the cost of FIFO looks like this: <br><pre><code class="1c hljs"><span class="hljs-keyword"><span class="hljs-keyword"></span></span>     ,       <span class="hljs-keyword"><span class="hljs-keyword"></span></span>     <span class="hljs-keyword"><span class="hljs-keyword"></span></span> ,         <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  ,    <span class="hljs-keyword"><span class="hljs-keyword"></span></span>    .     .</code> </pre> <br>  For the cost of money it happens that an outgoing transaction spends money when there is an empty queue of lots.  In this case, we use the current (on the day of the transaction) rate of the Central Bank of the Russian Federation (in the variant for Russia). <br><br>  Similarly, for the results with a different purpose, the drivers use other algorithms.  In a real <a href="http://www.ultimaecommerceerp.com/">Ultima eCommerceERP</a> configuration <a href="http://www.ultimaecommerceerp.com/">,</a> no more than 10 drivers are enough.  Thus, information on the calculation of the results is stored in a neatly structured form, laid out in several drivers, each of which implements a clearly defined functionality. <br><br>  <b>As a result</b> : <br><ul><li>  The cost calculation logic is isolated in the total drivers. </li><li>  Simplified unit testing functionality </li><li>  Safe code is now written faster </li><li>  Reduced the ‚Äúinput threshold‚Äù of the developer to make changes, increasing the number of developers who can implement the functionality </li></ul><br><br>  Regarding performance, in one of the installations of the system several million transactions per hour are processed in this way. </div><p>Source: <a href="https://habr.com/ru/post/243743/">https://habr.com/ru/post/243743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243727/index.html">Just backup btrfs</a></li>
<li><a href="../243731/index.html">Update on Android 5 Lolipop kills self-signed applications without the possibility of recovery</a></li>
<li><a href="../243733/index.html">The Seven Laws of the Jedi Freelancer</a></li>
<li><a href="../243737/index.html">Evolution: graphics and mechanics</a></li>
<li><a href="../243741/index.html">Cards, money, two ... factors</a></li>
<li><a href="../243747/index.html">Learn WatchKit - create the first application for Apple Watch</a></li>
<li><a href="../243749/index.html">Unity3D nonplayer application</a></li>
<li><a href="../243751/index.html">"Holes" of startups: the most common problems of young companies that hinder their development</a></li>
<li><a href="../243755/index.html">DataTalks 10.25.14: First meeting</a></li>
<li><a href="../243757/index.html">Amazon distributes $ 25 for AWS account for free and launches Russian version of the site.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>