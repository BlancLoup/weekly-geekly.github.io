<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Squeak: Simulation of Queuing Systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Habr√© there is very little information about such a programming language as Squeak . I will try to talk about it in the context of simulation of qu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Squeak: Simulation of Queuing Systems</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/getpro/habr/post_images/906/9b8/c4c/9069b8c4cb7f9042774a9be2cfc046fc.png">  On Habr√© there is very little information about such a programming language as <a href="http://squeak.org/">Squeak</a> .  I will try to talk about it in the context of simulation <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%25BC%25D0%25B0%25D1%2581%25D1%2581%25D0%25BE%25D0%25B2%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25BE%25D0%25B1%25D1%2581%25D0%25BB%25D1%2583%25D0%25B6%25D0%25B8%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F">of queuing systems</a> .  I will show you how to write a simple class, tell you its structure and use it in a program that will serve applications through several channels. <br><br><h4>  A few words about Squeak </h4><br>  Squeak is an open, cross-platform implementation of the <a href="http://ru.wikipedia.org/wiki/Smalltalk">Smalltalk-80</a> programming <a href="http://ru.wikipedia.org/wiki/Smalltalk">language</a> with dynamic typing and garbage collection.  The interface is quite specific, but quite convenient for debugging and analysis.  Squeak fully complies with the concept of OOP.  Everything consists of objects, even <i>if-then-else, for, while constructs are</i> implemented with their help.  The entire syntax is reduced to sending the message object in the form: <br><blockquote>  &lt;object&gt; &lt;message&gt; </blockquote>  Any method always returns an object and you can send a new message to it. <br>  Squeak is often used to model processes, but it can also be used as a tool for creating multimedia applications and a variety of educational platforms. <br><a name="habracut"></a><br><h4>  Queuing systems </h4><br>  Queuing systems (QS) contain one or several channels that process applications coming from several sources.  The service time for each application can be fixed or arbitrary, as well as the intervals between their receipt.  This could be a telephone exchange, laundry, cashiers in the store, a typewriting bureau, etc. It looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/413/a23/2ab/413a232ab6f169cfbfd6063f8e54f725.png"></div><br>  The QS includes several sources that enter the common queue and are sent for servicing as the processing channels become free.  Depending on the specific features of real systems, the model may contain a different number of sources of requests and service channels and have different limits on the queue length and the associated possibility of losing requests (refusals). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the simulation of QS, problems of estimating the average and maximum queue lengths, the frequency of service failures, the average load on channels, and the determination of their number are usually solved.  Depending on the task, the model includes program blocks for collecting, accumulating and processing the necessary statistical data on the process behavior.  The most frequently used models of event flows in the analysis of QS are regular and Poisson.  Regular ones are characterized by the same time between occurrences of events, and Poisson ones are random. <br><br><h4>  A bit of math </h4><br>  For a Poisson flow, the number of events <b>X</b> falling in the interval of length <b>œÑ</b> (tau) adjacent to the point <b>t</b> is distributed according to the Poisson law: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/faa/28c/749/faa28c74990c13f70e0ec3cfd6a33995.png"></div><br>  where <b>a <sub>(t, œÑ)</sub></b> is the average number of events occurring on the time interval <b>œÑ</b> . <br>  The average number of events occurring per unit time is equal to <b>Œª (t)</b> .  Consequently, the average number of events in the time interval <b>œÑ</b> adjacent to the time <b>t</b> , will be equal to: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/550/946/fb5/550946fb57aadaaa2d1cf5c5653bb32b.png"></div><br>  The time <b>T</b> between two events at <b>Œª (t) = const = Œª is</b> distributed according to the law: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/56b/f83/993/56bf839934bb9003e967be08f0f234a7.png"></div><br>  The distribution density of a random variable <b>T</b> has the form: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/425/db8/e6d425db8bf21b7c6d3145f8c8cccdb2.png"></div><br>  To obtain pseudo-random Poisson sequences of time intervals <b>t <sub>i</sub></b> solve the equation: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/70d/e4b/851/70de4b851ab719585e9fdc9342d6952e.png"></div><br>  where <b>r <sub>i</sub></b> is a random number uniformly distributed on the interval [0, 1]. <br>  In our case, this gives the expression: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/101/556/a07/101556a073a9ae425cdc7f08c0142e07.png"></div><br>  By generating random numbers, you can write whole volumes.  Here, to generate integers uniformly distributed on the interval [0, 1], we use the following algorithm: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/47b/5e0/6cd/47b5e06cd0d91c569f23d874f3ec69a3.png"></div><br>  where <b>R <sub>i</sub></b> is another random integer; <br>  <b>P</b> - some large prime number (for example 2311); <br>  <b>Q</b> - integer - the upper limit of the interval, for example, 2 <sup>21</sup> = 2097152; <br>  <b>rem</b> is the operation to get the remainder from dividing integers. <br><br>  The initial value of <b>R <sub>0 is</sub></b> usually set arbitrarily, for example, using the timer readings: <br><pre><code class="smalltalk hljs"><span class="hljs-type"><span class="hljs-type">Time</span></span> totalSeconds</code> </pre> <br>  To obtain numbers evenly distributed on the interval [0, 1], we use the language operator: <br><blockquote>  r: = (r / q) asFloat </blockquote><br><h4>  Rand class </h4><br>  To obtain random numbers uniformly distributed on the interval [0, 1], create a class - the generator of real numbers: <br><br><pre> <code class="smalltalk hljs"><span class="hljs-type"><span class="hljs-type">Float</span></span> variableWordSubclass: <span class="hljs-symbol"><span class="hljs-symbol">#Rand</span></span> <span class="hljs-comment"><span class="hljs-comment">" "</span></span> instanceVariableNames: <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-comment"><span class="hljs-comment">" "</span></span> classVariableNames: <span class="hljs-string"><span class="hljs-string">'R'</span></span> <span class="hljs-comment"><span class="hljs-comment">" "</span></span> poolDictionaries: <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-comment"><span class="hljs-comment">" "</span></span> category: <span class="hljs-string"><span class="hljs-string">'Sample'</span></span> <span class="hljs-comment"><span class="hljs-comment">" "</span></span></code> </pre> <br>  Methods: <br><br><pre> <code class="smalltalk hljs"><span class="hljs-comment"><span class="hljs-comment">""</span></span> init <span class="hljs-type"><span class="hljs-type">R</span></span> := <span class="hljs-type"><span class="hljs-type">Time</span></span> totalSeconds.next <span class="hljs-comment"><span class="hljs-comment">"  "</span></span> next <span class="hljs-type"><span class="hljs-type">R</span></span> := (<span class="hljs-type"><span class="hljs-type">R</span></span> * <span class="hljs-number"><span class="hljs-number">2311</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>) rem: <span class="hljs-number"><span class="hljs-number">2097152.</span></span> ^(<span class="hljs-type"><span class="hljs-type">R</span></span>/<span class="hljs-number"><span class="hljs-number">2097152</span></span>) asFloat</code> </pre> <br>  To set the initial state of the sensor, send a <i>Rand init</i> message. <br>  For receiving the next random number we send <i>Rand next</i> . <br><br><h4>  Application Processing Program </h4><br>  So, as a simple example, we will do the following.  Suppose we need to simulate the maintenance of a regular flow of requests from one source with a random time interval between requests.  There are two channels of different performance, allowing to serve applications for 2 and 7 time units, respectively.  It is necessary to register the number of applications served by each channel in the interval of 100 time units. <br><br><div class="spoiler">  <b class="spoiler_title">Squeak Code</b> <div class="spoiler_text"><pre> <code class="smalltalk hljs"> <span class="hljs-comment"><span class="hljs-comment">"  "</span></span> | proc1 proc2 t1 t2 s1 s2 sysPriority queue continue r | <span class="hljs-comment"><span class="hljs-comment">"  "</span></span> <span class="hljs-type"><span class="hljs-type">Rand</span></span> init. <span class="hljs-type"><span class="hljs-type">SysTime</span></span> := <span class="hljs-number"><span class="hljs-number">0.</span></span> s1 := <span class="hljs-number"><span class="hljs-number">0.</span></span> s2 := <span class="hljs-number"><span class="hljs-number">0.</span></span> t1 := <span class="hljs-number"><span class="hljs-number">-1.</span></span> t2 := <span class="hljs-number"><span class="hljs-number">-1.</span></span> continue := <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>. sysPriority := <span class="hljs-type"><span class="hljs-type">Processor</span></span> activeProcess priority. <span class="hljs-comment"><span class="hljs-comment">" "</span></span> queue := <span class="hljs-type"><span class="hljs-type">Semaphore</span></span> new. <span class="hljs-comment"><span class="hljs-comment">"  "</span></span> <span class="hljs-comment"><span class="hljs-comment">"  -   1"</span></span> (<span class="hljs-type"><span class="hljs-type">Process</span></span> forContext: [ proc1 := <span class="hljs-type"><span class="hljs-type">Processor</span></span> activeProcess. [continue] whileTrue: <span class="hljs-comment"><span class="hljs-comment">" "</span></span> [ queue wait. <span class="hljs-comment"><span class="hljs-comment">" "</span></span> t1 := <span class="hljs-type"><span class="hljs-type">SysTime</span></span> + <span class="hljs-number"><span class="hljs-number">2.</span></span> <span class="hljs-comment"><span class="hljs-comment">"  "</span></span> s1 := s1 + <span class="hljs-number"><span class="hljs-number">1.</span></span> proc1 suspend. <span class="hljs-comment"><span class="hljs-comment">"     "</span></span> ]. proc1 := <span class="hljs-keyword"><span class="hljs-keyword">nil</span></span>. <span class="hljs-comment"><span class="hljs-comment">"    1"</span></span> ] priority: (sysPriority + <span class="hljs-number"><span class="hljs-number">1</span></span>)) resume. <span class="hljs-comment"><span class="hljs-comment">"   "</span></span> <span class="hljs-comment"><span class="hljs-comment">"  -   2"</span></span> (<span class="hljs-type"><span class="hljs-type">Process</span></span> forContext: [ proc2 := <span class="hljs-type"><span class="hljs-type">Processor</span></span> activeProcess.. [continue] whileTrue: [ queue wait. t2 := <span class="hljs-type"><span class="hljs-type">SysTime</span></span> + <span class="hljs-number"><span class="hljs-number">7.</span></span> s2 := s2 + <span class="hljs-number"><span class="hljs-number">1.</span></span> proc2 suspend. ]. proc2 := <span class="hljs-keyword"><span class="hljs-keyword">nil</span></span>. ] priority: (sysPriority + <span class="hljs-number"><span class="hljs-number">1</span></span>)) resume. <span class="hljs-comment"><span class="hljs-comment">"      "</span></span> [<span class="hljs-type"><span class="hljs-type">SysTime</span></span> &lt; <span class="hljs-number"><span class="hljs-number">100</span></span>] whileTrue: [ r := (<span class="hljs-type"><span class="hljs-type">Rand</span></span> next * <span class="hljs-number"><span class="hljs-number">10</span></span>) rounded. (r = <span class="hljs-number"><span class="hljs-number">0</span></span>) ifTrue: [r := <span class="hljs-number"><span class="hljs-number">1</span></span>]. ((<span class="hljs-type"><span class="hljs-type">SysTime</span></span> rem: r) = <span class="hljs-number"><span class="hljs-number">0</span></span>) ifTrue: [queue signal]. <span class="hljs-comment"><span class="hljs-comment">" "</span></span> <span class="hljs-comment"><span class="hljs-comment">"  "</span></span> (t1 = <span class="hljs-type"><span class="hljs-type">SysTime</span></span>) ifTrue: [proc1 resume]. (t2 = <span class="hljs-type"><span class="hljs-type">SysTime</span></span>) ifTrue: [proc2 resume]. <span class="hljs-type"><span class="hljs-type">SysTime</span></span> := <span class="hljs-type"><span class="hljs-type">SysTime</span></span> + <span class="hljs-number"><span class="hljs-number">1.</span></span> <span class="hljs-comment"><span class="hljs-comment">"  "</span></span> ]. <span class="hljs-comment"><span class="hljs-comment">"   "</span></span> <span class="hljs-type"><span class="hljs-type">PopUpMenu</span></span> inform: <span class="hljs-string"><span class="hljs-string">'proc1: '</span></span>,(s1 printString),<span class="hljs-string"><span class="hljs-string">', proc2: '</span></span>,(s2 printString). continue := <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>.</code> </pre><br></div></div><br>  At startup, we see that process 1 managed to process 31 applications, and process 2 only 11: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9e2/8ce/9ee/9e28ce9ee38550ceab71ffd4217e7f54.png"></div></div><p>Source: <a href="https://habr.com/ru/post/198664/">https://habr.com/ru/post/198664/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../198646/index.html">Dancing Bender on CSS3</a></li>
<li><a href="../198648/index.html">Orthodox Twitter from schoolchildren from the Samara region</a></li>
<li><a href="../198656/index.html">FRP (functional reactive programming) on ‚Äã‚ÄãBacon.js</a></li>
<li><a href="../198660/index.html">3G Internet at a distance from the base station using a dish and a coffee can</a></li>
<li><a href="../198662/index.html">Preparing Servers with Chef Solo</a></li>
<li><a href="../198666/index.html">IndexedDB - unlimited data storage</a></li>
<li><a href="../198668/index.html">QIWI and the new REST protocol in the examples</a></li>
<li><a href="../198672/index.html">How to start making the engine control unit from scratch</a></li>
<li><a href="../198674/index.html">Budget TimeLapse Slider do it yourself</a></li>
<li><a href="../198680/index.html">Pavel Durov's speech at the GMIC conference in San Francisco - the first public appearance of the VK founder and Telegram in Silicon Valley</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>