<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Correct moving average for real-time monitoring</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Proper real-time monitoring of the system is not as simple as it might seem at first glance. 

 The most common example is measuring the response time...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Correct moving average for real-time monitoring</h1><div class="post__text post__text-html js-mediator-article">  Proper real-time monitoring of the system is not as simple as it might seem at first glance. <br><br>  The most common example is measuring the response time of a server to a request.  Suppose we have everything: <br>  - the server for each request calculates execution time, adds to the counter <br>  - the server is able to give the counter value on external request <br>  - there is a monitoring server that collects values ‚Äã‚Äãevery poll interval, stores, aggregates and draws graphics <br><br>  Solution to the forehead - to measure the instantaneous value of the counter - it does not make much sense, if the poll interval is one or five minutes, we will get the instantaneous value of the system performance measured by the last request.  If all 5 minutes before that queries were executed for 2 seconds or more, and the last one was easy for 20ms, we will see only 20ms.  Or vice versa. <br><a name="habracut"></a><br>  The standard solution is a moving average for the last N queries.  The solution works fine as long as the N requests are executed during the smaller poll interval.  If the load drops, it turns out like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img title="Moving average before" src="http://www.katkovonline.com/wp-content/uploads/2009/07/graph_image1.png" width="500" height="197"><br><br>  Between midnight and 4 am, either there were no requests at all, or it was less than N. The value of the moving average did not change and the deceptive impression was created that the server processed all requests in 6ms. <br><br>  Below, the same counter, only from another server where the moving average has been modified. <br><br><img title="Moving average afrer" src="http://www.katkovonline.com/wp-content/uploads/2009/07/graph_image21.png" width="500" height="197"><br><br>  The picture is visible much better.  It can be seen where there were requests, and where it was not. <br><br>  The modification is quite simple.  In addition to the parameter N - the window size for the moving average.  One more parameter is entered - T, time of forgetting (expiration time), all values ‚Äã‚Äãin the window, older than T are not taken into account when calculating the average. <br><br>  Selecting T (ms) for a given value of poll interval (ms) is another interesting problem. <br>  If T &lt;&lt; poll interval, (much less) there will be lost values <br>  If T &gt;&gt; poll interval, (much longer) there will be a schedule # 1 <br>  As a first approximation, you can accept T = 2 * poll interval </div><p>Source: <a href="https://habr.com/ru/post/66812/">https://habr.com/ru/post/66812/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../66803/index.html">As Calvin Coolidge said</a></li>
<li><a href="../66805/index.html">CSS Sticky Footer / Sticky Footer</a></li>
<li><a href="../66806/index.html">Adzbuk - Free</a></li>
<li><a href="../66807/index.html">Drone Draganflyer X6 Helicopter for reconnaissance operations</a></li>
<li><a href="../66808/index.html">Japanese Parable: Tea Master and Samurai</a></li>
<li><a href="../66815/index.html">SQL Azure</a></li>
<li><a href="../66817/index.html">Looking for static code analysis tools for finding vulnerabilities</a></li>
<li><a href="../66819/index.html">Making smart backups of editable files</a></li>
<li><a href="../66820/index.html">Puzzle for habrauzera</a></li>
<li><a href="../66823/index.html">Social advertising in the field of IT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>