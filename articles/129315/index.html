<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Matlab cluster do it yourself</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Sooner or later, the user of the Matlab / Simulink package is faced with the problem of insufficient performance of the computer on whi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Matlab cluster do it yourself</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  Sooner or later, the user of the Matlab / Simulink package is faced with the problem of insufficient performance of the computer on which it works.  I faced also. <br><br>  The first thing that came to mind was the modernization of iron.  I work on an old laptop, and so I started thinking about a stationary PC.  But this did not promise a big performance increase, and indeed this is a gamer's method but not an engineer. <br><br>  Details under the cut &gt;&gt; <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Based on the fact that this was my first experience in using parallel computing, the topic is also intended for beginners.  To connoisseurs of parallel computing I would like to express my deep gratitude for the kind advice and comments of my actions. <br><br>  So: <br><ol><li>  New computer. <br>  As I mentioned above, for a comfortable ‚Äúscientific‚Äù work I needed just a ‚Äúgaming‚Äù PC, having a <s>multi-</s> core processor and a graphics accelerator with a <a href="http://www.mathworks.com/discovery/matlab-gpu.html">cuda capability of at least 1.3</a> .  Expensive and not scalable.  I was sure that I would master the unbridled power rather quickly, and it would not be enough again. </li><li>  Optimization / minimization / refinement of models and code. <br>  I have already traveled this path before I ran into the ceiling of the capabilities of my laptop.  The method has completely exhausted itself when the time for modeling the situation has become longer than the standard coffee / tea drinking time.  ‚ÄúYou can start the simulation and go to sleep!‚Äù, The knowledgeable will say, but for this you need to have an already optimized model and a clear idea of ‚Äã‚Äãhow it will behave.  I also needed performance in the initial stages of development. </li><li>  Use of the computing cluster. <br>  There was no cluster at hand, and on such as <a href="http://parallel.uran.ru/node/3">Uranus</a> you need to knock for a long time.  And the formulation of the problem is not very suitable for the use of third-party resources.  I was not ready to run the task once and collect the results.  This was still far away. </li></ol><br>  As a result, it was decided to build a small one, but <s>with a blackjack</s> cluster. <br><br><h4>  Iron search </h4><br>  Hoping for the predominance of good in our world, I turned to colleagues and friends for help.  As a result, some volunteered and provided their PCs for my experiment.  There were several options, but I had to choose only two cars.  I will try to explain why: <br><ul><li>  Everyone had a core i7 processor onboard.  Four cores gave 2 virtual ones.  So I had the opportunity to create 16 virtual WORKERs based on them, which is pretty good.  Plus, the entire memory was operational in one 6 and in the other 8 Gb. </li><li>  They were in the same local area network, which was simply necessary to minimize the time spent on transferring data between virtual laboratories.  To connect with this network, I raised the VPN channel, and to work with each PC I set up a standard remote desktop. </li></ul><br>  The cons were also present: <br><ul><li>  Both PCs worked under Windows 7 x64, whereas my laptop was with the x86 operating system.  One of the mandatory requirements for a Matlab cluster is the uniform bitness of the operating systems used.  As a result, I lost the opportunity to add two more WORKERs to the cluster based on the processor of my laptop. </li><li>  The video cards' s juda capability were less than 1.3, and they also failed to include them in the bundle. </li></ul><br>  But since the advantages still outweighed, the first stone of the cluster on the knee was laid. <br><br><h4>  Build a cluster </h4><br><h5>  Software Requirements </h5><br>  I have highlighted the requirements for iron.  Software requirements are as follows: <br><ol><li>  Matlab on every machine. <br>  Do not do without the platform. </li><li>  Distributed Computing toolbox (DCT) on each machine. </li><li>  MATLAB Distributed Computing Engine (MDCE) on each machine. <br>  Both toolboxes work only together. </li><li>  The compiler is different from the standard Matlab compiler. <br>  On machines with a 64bit operating system, if we are going to use them as a host to compile the Simulink model into C code.  Matlab offers a long list of supported compilers, some of which are free.  I used Microsoft Visual C ++ 2010. </li><li>  Simulink and other extensions depending on the type of activity. </li></ol><br><h5>  Cluster startup </h5><br>  First, install and run MDCE as a service on each machine.  This can be done both without leaving Matlab (using the "!" Sign performs the Matlab command as a system command) or using the command line.  The * .bat files for this are relative to the Matlab installation directory along the path \ toolbox \ distcomp \ bin \. <br><br>  Install and run MDCE on each machine: <br> <code>cd('C:\Program Files\MATLAB\R2010b\toolbox\distcomp\bin\') <br> !mdce install <br> !mdce start</code> <br>  We start the scheduler, which will manage parallel computing: <br> <code>!startjobmanager -name jm -v</code> <br>  The -v parameter is responsible for the detailed display of the startup process in the Matlab command window.  Scheduler can be run remotely on any PC in our possession. <br><br>  We start the cycle of so-called workers (worker), which will carry out the tasks assigned to them in parallel: <br> <code>clientHost = 'slovak'; <br> node = {'slovak', 'puls'}; <br> for i = 1:length(node) <br> for j = 1:8 <br> str = ['!startworker -name w_' num2str(j) '_' node{i} ' -jobmanagerhost ' clientHost ' -jobmanager jm -remotehost ' node{i} ' -v']; <br> eval(str) <br> end <br> end</code> <br>  The 'slovak' host is the computer on which the scheduler is running.  In my case, this is one of the working PCs.  I had to rename, because the previous name was in Cyrillic, which Matlab does not tolerate. <br><br>  After the creation of work <s>horses,</s> we can admire our cluster: <br> <code>!nodestatus -infolevel 3</code> <br>  The -infolevel 3 parameter for detailed information about nodes. <br> <code>... <br> Job manager: <br> Name jm <br> Running on host Slovak <br> Number of workers 16 <br> ...</code> <br>  You can manage the cluster using the GUI.  To do this, in the folder with the batch file there is a file admincenter.bat, which launches the administration utility.  In our case, it looks like this: <br><img src="https://habrastorage.org/storage1/4c722dd5/0089d523/7aa4841a/dd4c4bb1.jpg"><br>  At the time of writing the article, PC puls ‚Äúfell off‚Äù and therefore only 8 workers in the admin center. <br>  Next we need to find the created scheduler using Matlab: <br> <code>jm = findResource('scheduler','type','jobmanager', ... <br> 'LookupURL', 'slovak:27350', 'Name', 'jm');</code> <br>  After this step, you can solemnly cut the ribbon and confidently assume that our cluster is created and ready to work.  Next, you need to properly distribute the work between the nodes, to organize access to shared resources and much more.  I also want to note that at this stage we can run parallel tasks only from Matlab.  In order to parallelize the Simulink model I had to dance with a tambourine more than once.  As a result, I radically changed the concept of all my work specifically for the convenience of parallel solution, but this is a topic for a separate topic. <br><br>  Information on the topic was drawn from the following resources: <br><ol><li>  <a href="http://www.mathworks.com/">Matlab website</a> </li><li>  <a href="http://blogs.mathworks.com/">Matlab User Blogs</a> </li><li>  <a href="http://matlab.exponenta.ru/forum/viewforum.php%3Ff%3D10">Russian-language user forum Matlab</a> </li><li>  <a href="http://www.ccas.ru/mmes/distcompbook.pdf">N.N.</a>  <a href="http://www.ccas.ru/mmes/distcompbook.pdf">Olenev, R.V.</a>  <a href="http://www.ccas.ru/mmes/distcompbook.pdf">Pechenkin, A.M.</a>  <a href="http://www.ccas.ru/mmes/distcompbook.pdf">Chernetsov Parallel Programming in MATLAB and Its Applications Moscow: EC of the Russian Academy of Sciences, 2007. 120 p.</a> </li><li>  <a href="http://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B1_%25D0%25B8_%25D0%25BE%25D1%2588%25D0%25B8%25D0%25B1%25D0%25BE%25D0%25BA">Method of <s>scientific</s> trial and error</a> </li></ol><br>  Thank you for attention! <br><br>  PS: All the work done was done with the Matlab R2010b version, but when I glanced at the distcomp folder of the new version of the R2011a, at first glance, the work with the mathworks team was not a small one.  Unfortunately, the new version is not yet available, but as soon as I get the opportunity I will try to highlight the innovations that it can offer us.  Although now I'm more busy generating C code from the Simulink model for microcontrollers. </div><p>Source: <a href="https://habr.com/ru/post/129315/">https://habr.com/ru/post/129315/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../129309/index.html">First HabRstart: Report</a></li>
<li><a href="../129310/index.html">17 simple tips to increase productivity</a></li>
<li><a href="../129312/index.html">The web version of Windows Phone Marketplace has opened</a></li>
<li><a href="../129313/index.html">Image design on CSS3</a></li>
<li><a href="../129314/index.html">New name among mobile platforms: Tizen</a></li>
<li><a href="../129316/index.html">Data emulator with GNSS receiver using NMEA protocol</a></li>
<li><a href="../129319/index.html">Misunderstanding zone</a></li>
<li><a href="../129320/index.html">Letters that annoy us</a></li>
<li><a href="../129321/index.html">Ya. Incident: Why did I read your SMS?</a></li>
<li><a href="../129322/index.html">Administration for the smallest (Part 2: we write identifiers correctly)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>