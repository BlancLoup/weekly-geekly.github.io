<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>phpMyExcel - table with formulas in PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear readers of Habr! 

 About a year ago, at night, sitting behind the wheel of my nine, moving along the winding roads of the Krasnodar Te...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>phpMyExcel - table with formulas in PHP</h1><div class="post__text post__text-html js-mediator-article">  Good day, dear readers of Habr! <br><br>  About a year ago, at night, sitting behind the wheel of my nine, moving along the winding roads of the Krasnodar Territory to my parents in the village, I thought of making a simple tool for creating reports on visitor statistics on the site, similar (though only externally) to an Excel spreadsheet. <br><br>  The fact is that, by the nature of my activity, I had to display all kinds of figures from the mysql tables and monitor them in every way: how many visitors were there, how many unique types of addresses the update checked, how many people used it, all amounts, count (*) and tons .P.  Of course, I placed the basic queries on a special statistics page, and I usually did all sorts of curious, but not very valuable samples in phpMyAdmin, and I was too lazy to commit them to this page.  Yes, and did not want to heavily load the page statistics with all sorts of dubious need for numbers.  These requests went nowhere, it upset me, and all the time I wanted to make some kind of report-making tool that remembers my last requests. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The road took 3 hours on a length of 250 km of Adyghe asphalt, and I had a great opportunity to think it over carefully.  When I came home to my parents, I sat down at a laptop and wrote the simplest thing that looks like an Excel table, internally consisting of one mysql table. <br><br><img src="http://orfoswitcher.ru/i/myexcel2.png"><br><br>  The implementation consisted of a single table of cells containing the fields for the sheet name, the X, Y coordinates, and, in fact, the formula itself: <br><br><img src="http://orfoswitcher.ru/i/myexcel1.png"><br><br>  In the <b>index.php</b> file, all the cells for the current sheet were selected (the sheet was set with the GET parameter sheet = xxx in the address line) and the contents of the <b>src</b> field were either displayed on the screen or executed using the PHP function <b>eval ()</b> if its first character was ". <br><br>  Thus, formulas were able to use all PHP functions, including all user functions from the user_functions.php file.  For example, I wrote the functions <b>sql ()</b> and <b>val ()</b> : <br><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/**      sql  */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sql</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($sql)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Database::selectAndFetch($sql); } <span class="hljs-comment"><span class="hljs-comment">/**      val("A0")    A0 */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">val</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($cell)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> MyExcel::getCellValue(get_current_sheet(), $cell); }</code> </pre> <br><br>  All this helps me out quite well, and I decided to write about it here, maybe it may be useful to someone else.  <a href="http://code.google.com/p/phpmyexcel/">The source is</a> open and anyone can participate in the improvement of the script and get the password for the commit by writing me a personal message, describing in it the essence of the desired improvement. <br><br>  Download the source in one zip archive using this <a href="">link</a> .  After unpacking, you need to run the <b>install.php</b> file - it will create the table necessary for the work. <br><br>  Distributed under the <a href="http://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B8%25D1%2586%25D0%25B5%25D0%25BD%25D0%25B7%25D0%25B8%25D0%25B8_MIT">MIT license</a> .  Those.  you can do absolutely anything. </div><p>Source: <a href="https://habr.com/ru/post/126736/">https://habr.com/ru/post/126736/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126730/index.html">Buying Google from Motorola brought good luck to RIM</a></li>
<li><a href="../126731/index.html">90% of people do not know about Ctrl + F</a></li>
<li><a href="../126733/index.html">PHP console under MODx Revolution</a></li>
<li><a href="../126734/index.html">The August update of Windows Phone Toolkit is out!</a></li>
<li><a href="../126735/index.html">IT movies</a></li>
<li><a href="../126737/index.html">If PHP were British</a></li>
<li><a href="../126738/index.html">Blitzkrieg in the tablet market. How could HP fly webOS or a ghostly chance for RIM and ...?</a></li>
<li><a href="../126739/index.html">Writing a macro bot for the browser game</a></li>
<li><a href="../126741/index.html">Quick send screenshots</a></li>
<li><a href="../126744/index.html">Hiring VS Outsourcing (in small business projects)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>