<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How did I manage to hack the application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello dear% habrauser%. In this article, I will share with you the story of how I hacked the application. The application EXE itself cannot be cracked...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How did I manage to hack the application</h1><div class="post__text post__text-html js-mediator-article">  Hello dear% habrauser%.  In this article, I will share with you the story of how I hacked the application.  The application EXE itself cannot be cracked, but the desired result was obtained in another way.  To preserve confidentiality, I will omit some points, cut screenshots strongly.  So <br><br><img src="https://habrastorage.org/webt/_v/dv/l8/_vdvl8amddh2nocmigl8ycellx8.png" alt="image"><br><a name="habracut"></a><br><h2>  This inanimate and fabulous world </h2><br>  It all started well, nothing foreshadowed trouble.  In one late evening, one good friend asked me for one favor, using phrases like "well, you have a programmer."  He wrote about a request to hack a certain application.  To which I replied that I would try, but I cannot guarantee successful hacking.  The next day we met, he gave me a disk and explained what kind of application it was. <br><br><h2>  Start </h2><br>  There is a certain organization that trains people to pass one specific exam.  To get this application you need to go to this organization, register and pay for courses.  At the end of the course, the organization for an additional fee gives a disk with the installer of the program with an individual activation key.  The application allows you to do tests, look at the results.  There is a mode "On the exam", which allows you to simulate the exam environment.  The application gives random tests from different sections.  Everything is good and beautiful. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  First steps - experimenting </h2><br>  Install the application, run it to see what it is. <br>  This splash screen opens, and the application freezes for a few seconds (this freeze is not casual). <br><br>  Splash screen opens, and after it, after a few seconds, this window opens: <br><br><img src="https://habrastorage.org/webt/xd/m6/au/xdm6au_9agwkth5pohswzl_iczk.png" alt="image"><br><br>  We are required to enter the activation key, which we naturally do not have.  The first thing that alerted me was that the activation key input window opens with a noticeable delay, as if the application is connected somewhere via the Internet and the application developer did not take care of the asynchronous connection to the Internet.  To make sure that the application climbs to the Internet has disconnected the network connections on the computer, <s>pulled out the ethernet cable</s> and re-launched the application.  After some time, thinking about being human, the application still opened the activation window, but after entering a random text there, a message appeared saying that there was no internet connection. <br><br>  From here we conclude that the application is activated via the Internet and in its source code no activation keys or decryption algorithms are wired. <br><br>  I climb into the folder of the installed program: <br><br><img src="https://habrastorage.org/webt/ea/qt/8x/eaqt8xyu86ar5c84ticneb3beza.png" alt="image"><br><br>  Structure: <br><br><ol><li>  Arial Narrow.ttf - font <br><br><div class="spoiler">  <b class="spoiler_title">Kep</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jm/o0/ao/jmo0ao-jxhib5vmktn8alj9qeyo.jpeg" alt="image"></div></div></li><li>  DataSource.data - a database file in which all tests </li><li>  **************. exe - application executable </li><li>  MySql.Data.dll - free opensource library from MySql </li></ol><br>  The presence of MySql.Data.dll in the program folder suggested that the application is most likely written in C #.  Not protected by special utilities, applications written in this programming language are the easiest to decompile.  Delighted by this assumption, my brain automatically gave me a signal to start the program <i>IlSpy</i> , which allows me to decompile applications written in C # and open the application in it. <br><br>  As a result, such a picture opened before me. <br><br><img src="https://habrastorage.org/webt/2y/nr/c0/2ynrc0-5mnnochzoje7l93k6gmq.png" alt="image"><br><br>  As you can see, the application is really written in C #, it displays information about the developer, the version of .NET used.  After opening the structure of the application, disappointment followed. <br><br><img src="https://habrastorage.org/webt/sh/qq/5c/shqq5ctxzxixezjvkgtsrtlr81a.png" alt="image"><br><br>  Judging by the incomprehensible signs, empty functions, the application is obfuscated - the code is unreadable.  For help, I turned to the search engines and soon I found the free de4dot open-source program, which allows deobfuscating obfuscated applications written in C #. <br><br>  Let's try to de-fuss and get the following result: <br><br><img src="https://habrastorage.org/webt/a5/ny/jg/a5nyjgqy8-jbeyngrokl_wxomoq.png" alt="image"><br><br>  Judging by the message, the application is obfuscated using the <i>.NET Reactor</i> , and it is not possible to decompile it.  After a long search for a deobfuscation method against the protection of <i>.Net Reactor</i> was not found. <br><br>  Then I decided to try to at least open the DataSource.data database file in <i>SQLite</i> . <br><br><img src="https://habrastorage.org/webt/99/mp/z-/99mpz-phkxgab3ihubvpzt_vu-e.png" alt="image"><br><br>  We are required to password from the database. <br><br>  Disappointed with the failure, I have already surrendered, I left the hack for better times.  But the thought that I had missed something did not leave my mind. <br><br><h2>  Dear you healthy? </h2><br><blockquote>  Sometimes a step forward is the result of a kick in the ass. </blockquote><br>  Some time has passed.  When I delved into the files found this program and drew attention to the file MySql.Data.dll.  And what if I change MySql.Data.dll to a modified one so that it displays the connection string to the database.  For these purposes there is an opensource program - <i>dnSpy</i> .  It allows you to edit the code .net applications and libraries.  Load the dll file in the program and find the class MySqlConnection and edit the function .ctor: <br><br><img src="https://habrastorage.org/webt/dk/w0/wn/dkw0wngr4iedsoymboknhnywy7q.png" alt="image"><br><br>  Add a line: <br><br><blockquote>  System.Windows.Forms.MessageBox.Show (connectionString); </blockquote><br><br><img src="https://habrastorage.org/webt/zv/ay/3f/zvay3fmoa2wokorl5voiwzr0pgg.png" alt="image"><br><br>  Click "Compile", save the file, replace it with the original one and finally launch the application. <br><br>  This window will appear: <br><br><img src="https://habrastorage.org/webt/5p/gr/vx/5pgrvxryxoyowy2fbsu0x7w0ueq.png" alt="image"><br><br>  By the name of the cloudapp.net server, we can conclude that the database was created on Azure. <br>  Download any free connection utility to the <i>database</i> , say <i>HeidiSQL</i> .  After entering the data connection is opened DB.  And here are our activation keys: <br><br><img src="https://habrastorage.org/webt/vl/j0/tz/vlj0tz3elrivnylwe9xyav_lxgm.png" alt="image"><br><br>  Most of the keys lacked the values ‚Äã‚Äãof the Name, CardId, Phone fields.  Apparently these keys have not yet been sold.  Added a 16 digit key and registered the program.  The data.dat file appeared in the folder with the installed program and the application issued a message about successful registration.  The key created earlier disappeared in the table with keys.  After a brief search, I found this key in the logs table.  There was my key with a detailed description of the characteristics of my computer such as a model, processor, video card, etc.  I deleted this line in order not to leave traces behind. <br><br><h2>  Total </h2><br>  It is necessary to pay tribute to the developer of the application, he took care of protecting his application.  He protected the database, obfuscated the application, the contents of the data.dat file was also encrypted, but he forgot about checking the hash of the library used. <br><br>  PS: Harm organization hacking applications did not produce.  By the time the application was able to be hacked, the friend no longer needed it.  <b>I only had an activated copy of the application and it was not transferred to third parties</b> .  Due to the uselessness of the application, I also deleted it. </div><p>Source: <a href="https://habr.com/ru/post/344922/">https://habr.com/ru/post/344922/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344912/index.html">The battle for network neutrality: wars with operators and first courts</a></li>
<li><a href="../344914/index.html">New generation of networks: the first specification 5G is introduced</a></li>
<li><a href="../344916/index.html">How does the frame render the Metal Gear Solid V engine: Phantom Pain</a></li>
<li><a href="../344918/index.html">Give me your salary and I will tell you who you are</a></li>
<li><a href="../344920/index.html">The grand piano must disappear: the levels of professional development and their evaluation, the programmers</a></li>
<li><a href="../344924/index.html">Digital events in Moscow from December 18 to 24</a></li>
<li><a href="../344926/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ293 (December 11 - 17, 2017)</a></li>
<li><a href="../344930/index.html">How to animate the picture in the browser. Multi-pass WebGL rendering</a></li>
<li><a href="../344932/index.html">Economy solution for the Internet of Things. Azure IoT Hub + Azure functions</a></li>
<li><a href="../344934/index.html">Jeb Klitschko</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>