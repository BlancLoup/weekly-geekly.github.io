<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rhino inside the cat - run the firmware in the Kopycat emulator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During the meeting 0x0A DC7831 DEF CON Nizhny Novgorod, on February 16, we presented a report on the basic principles of binary code emulation and our...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rhino inside the cat - run the firmware in the Kopycat emulator</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/gi/pb/7e/gipb7e8ucwinvebjerxy1fk2d-8.jpeg" width="80%"></div><br><p>  During the meeting 0x0A DC7831 <a href="http://defcon-nn.ru/">DEF CON Nizhny Novgorod,</a> on February 16, we presented a report on the basic principles of binary code emulation and our own development - an emulator of <a href="https://kopy.cat/">Kopycat</a> hardware platforms. </p><br><p>  In the article we will describe the launch of the device firmware in the emulator, demonstrate the interaction with the debugger, and perform a small dynamic analysis of the firmware. </p><a name="habracut"></a><br><h2 id="predystoriya">  Prehistory </h2><br><p><del>  A long time ago in a galaxy far far away </del></p><br><p>  A couple of years ago in our laboratory it became necessary to investigate the firmware of the device.  The firmware was compressed, unpacked by the bootloader.  He did this in a very confused way, shifting data in memory several times.  And the firmware itself then actively interacted with the periphery.  And all this at the MIPS core. </p><br><p>  The existing emulators for objective reasons did not suit us, but I still wanted to run the code.  Then they decided to make their own emulator, which will do the minimum and allow unpacking the main firmware.  Tried - it turned out.  We thought, what if we add peripherals, so that we can also perform the main firmware.  It was not very painful - and it also worked out.  We thought again and decided to make a full emulator. </p><br><p>  The result was an emulation of <a href="https://kopy.cat/">Kopycat</a> computing systems. </p><br><img src="https://habrastorage.org/webt/eb/cx/b6/ebcxb6pxtiypy0s-usvu6i_hdwu.png" align="right"><br><div class="spoiler">  <b class="spoiler_title">Why Kopycat?</b> <div class="spoiler_text"><p>  There is a play on words. </p><br><ol><li>  <em>copycat</em> (English, n. [Ààk…íp…™k√¶t]) - copycat, imitator </li><li>  <em>cat</em> (English, n. [Ààk√¶t]) - a cat, a cat - the favorite animal of one of the creators of the project </li><li>  The letter "K" - from the programming language Kotlin </li></ol></div></div><br><h2 id="kopycat">  Kopycat </h2><br><p>  When creating an emulator, quite definite goals were set: </p><br><ul><li>  the ability to quickly create a new periphery, module, processor core; </li><li>  the ability to assemble a virtual device from different modules; </li><li>  the ability to load into memory of the virtual device any binary data (firmware); </li><li>  ability to work with snapshots (snapshots of the system state); </li><li>  the ability to interact with the emulator through the built-in debugger; </li><li>  nice modern language to develop. </li></ul><br><p>  As a result, Kotlin was chosen for implementation, the bus architecture (this is when modules communicate with each other via virtual data buses), JSON as the device description format, and GDB RSP as the protocol for interacting with the debugger. </p><br><p>  Development has been going on for a little over two years and is actively continuing.  During this time, MIPS, x86, V850ES, ARM, PowerPC processor cores were implemented. </p><br><p>  The project is growing, and it's time to introduce it to the general public.  A detailed description of the project will be done later, and now we will focus on using Kopycat. </p><br><p>  For the most impatient - the promo version of the emulator can be downloaded from the <a href="https://kopy.cat/download">link</a> . </p><br><h2 id="nosorog-v-emulyatore">  Rhino in the emulator </h2><br><p>  Earlier, for the conference SMARTRHINO-2018 a test device "Rhino" was created to teach reverse engineering skills.  The process of static firmware analysis was described in <a href="https://habr.com/ru/company/inforion/blog/359116/">this article</a> . </p><br><p>  Now we will try to add "dynamics" and launch the firmware in the emulator. </p><br><p>  We will need: <br>  1) Java 1.8 <br>  2) Python and <a href="https://github.com/ninia/jep">Jep</a> module for using Python inside the emulator.  WHL-assembly of the Jep module for Windows can be <a href="https://github.com/inforion/jep/releases/tag/v3.8.2-whl">downloaded here</a> . </p><br><p>  <strong>For Windows:</strong> <br>  1) <a href="https://sourceforge.net/projects/com0com/">com0com</a> <br>  2) <a href="https://www.chiark.greenend.org.uk/%255C~sgtatham/putty/latest.html">PuTTY</a> </p><br><p>  <strong>For Linux:</strong> <br>  1) socat </p><br><p>  Eclipse, IDA Pro, or radare2 can be used as a GDB client. </p><br><h2 id="kak-eto-rabotaet">  How it works? </h2><br><p>  In order to perform the firmware in the emulator, it is necessary to ‚Äúassemble‚Äù a virtual device, which is an analogue of a real device. </p><br><p>  The real device ("rhino") can be shown on the structural diagram: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nh/ph/ph/nhphph7rjwm3xiv52mvp_uefdq8.jpeg" alt="Real device diagram" width="60%"></div><br><p>  The emulator has a modular structure and the final virtual device can be described in a JSON file. </p><br><div class="spoiler">  <b class="spoiler_title">JSON on 105 lines</b> <div class="spoiler_text"><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"top"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, // Plugin name should be the same as file name (or full path from library start) <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"rhino"</span></span>, // Directory where plugin places <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"user"</span></span>, // Plugin parameters (constructor parameters if jar-plugin version) <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"tty_dbg"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"String"</span></span>}, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"tty_bt"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"String"</span></span>}, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"firmware"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"String"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"NUL"</span></span>} ], // Plugin outer ports <span class="hljs-attr"><span class="hljs-attr">"ports"</span></span>: [ ], // Plugin internal buses <span class="hljs-attr"><span class="hljs-attr">"buses"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"mem"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"size"</span></span>: <span class="hljs-string"><span class="hljs-string">"BUS30"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"nand"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"size"</span></span>: <span class="hljs-string"><span class="hljs-string">"4"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"gpio"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"size"</span></span>: <span class="hljs-string"><span class="hljs-string">"BUS32"</span></span> } ], // Plugin internal components <span class="hljs-attr"><span class="hljs-attr">"modules"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"u1_stm32"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"STM32F042"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"firmware:String"</span></span>: <span class="hljs-string"><span class="hljs-string">"params.firmware"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"usart_debug"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"UartSerialTerminal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"terminals"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tty"</span></span>: <span class="hljs-string"><span class="hljs-string">"params.tty_dbg"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"term_bt"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"UartSerialTerminal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"terminals"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"params"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"tty"</span></span>: <span class="hljs-string"><span class="hljs-string">"params.tty_bt"</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"bluetooth"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"BT"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_6"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_7"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_8"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_9"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_10"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_11"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_12"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_13"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_14"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"led_15"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"LED"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"library"</span></span>: <span class="hljs-string"><span class="hljs-string">"mcu"</span></span> } ], // Plugin connection between components <span class="hljs-attr"><span class="hljs-attr">"connections"</span></span>: [ [ <span class="hljs-string"><span class="hljs-string">"u1_stm32.ports.usart1_m"</span></span>, <span class="hljs-string"><span class="hljs-string">"usart_debug.ports.term_s"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"u1_stm32.ports.usart1_s"</span></span>, <span class="hljs-string"><span class="hljs-string">"usart_debug.ports.term_m"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"u1_stm32.ports.usart2_m"</span></span>, <span class="hljs-string"><span class="hljs-string">"bluetooth.ports.usart_m"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"u1_stm32.ports.usart2_s"</span></span>, <span class="hljs-string"><span class="hljs-string">"bluetooth.ports.usart_s"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"bluetooth.ports.bt_s"</span></span>, <span class="hljs-string"><span class="hljs-string">"term_bt.ports.term_m"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"bluetooth.ports.bt_m"</span></span>, <span class="hljs-string"><span class="hljs-string">"term_bt.ports.term_s"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_0.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x00"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_1.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x01"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_2.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x02"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_3.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x03"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_4.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x04"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_5.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x05"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_6.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x06"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_7.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x07"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_8.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x08"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_9.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x09"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_10.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x0A"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_11.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x0B"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_12.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x0C"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_13.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x0D"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_14.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x0E"</span></span>], [ <span class="hljs-string"><span class="hljs-string">"led_15.ports.pin"</span></span>, <span class="hljs-string"><span class="hljs-string">"u1_stm32.buses.pin_output_a"</span></span>, <span class="hljs-string"><span class="hljs-string">"0x0F"</span></span>] ] }</code> </pre> <br><p>  Note the <em>firmware</em> parameter in the <strong>params</strong> section ‚Äî this is the name of the file that can be downloaded to the virtual device as firmware. </p></div></div><br><p>  A virtual device and its interaction with the main operating system can be represented by the following scheme: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m9/i_/27/m9i_27btauj0onjugttzj3srmfg.jpeg" alt="The circuit emulated device" width="80%"></div><br><p>  The current test copy of the emulator implies interaction with the COM ports of the main OS (debugging UART and UART for the Bluetooth module).  These can be real ports to which devices are connected or virtual COM ports (for this you just need <em>com0com / socat)</em> . </p><br><p>  To interact with the emulator from the outside at the moment there are two main ways: </p><br><ul><li>  GDB RSP protocol (respectively, supporting this protocol, tools - Eclipse / IDA / radare2); </li><li>  internal emulator command line (Argparse or Python). </li></ul><br><h3 id="virtualnye-com-porty">  Virtual COM Ports </h3><br><p>  In order to interact with the UART of a virtual device on a local machine through a terminal, you need to create a pair of connected virtual COM ports.  In our case, one port uses the emulator, and the second - the terminal program (PuTTY or screen): </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5d/jr/0w/5djr0wz88dgdaiw1xaasrof2wyk.png" alt="Virtual COM Ports" width="80%"></div><br><h4 id="ispolzovanie-com0com">  Using com0com </h4><br><p>  Virtual COM ports are configured by the setup utility from the com0com kit (the console version is <em>C: \ Program Files (x86) \ com0com \ setup.exe,</em> or the GUI version is <em>C: \ Program Files (x86) \ com0com \ setupg.exe</em> ) : </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v-/j9/pf/v-j9pfquunpiezqhkcr6cuyq-9k.png" alt="Configure Virtual COM Ports"></div><br><p>  You should check <strong><em>enable buffer overrun</em></strong> for all created virtual ports, otherwise the emulator will expect a response from the COM port. </p><br><h4 id="ispolzovanie-socat">  Using socat </h4><br><p>  On UNIX systems, virtual COM ports are automatically created by the emulator using the socat utility. To do this, when you start the emulator, specify the <code>socat:</code> prefix in the port name <code>socat:</code> </p><br><h3 id="vnutrenniy-interfeys-komandnoy-stroki-argparse-ili-python">  Internal command line interface (Argparse or Python) </h3><br><p>  Since Kopycat is a console application, the emulator provides two options for the command line interface for interacting with its objects and variables: Argparse and Python. </p><br><p>  Argparse is a CLI built into Kopycat, it is always available and for everyone. </p><br><p>  Alternate CLI - Python interpreter.  To use it, you need to install the Python module Jep and configure the emulator to work with Python (the Python interpreter installed on the user's main system will be used). </p><br><h4 id="ustanovka-python-modulya-jep">  Installing the Jep Python module </h4><br><p>  Under Linux, Jep can be installed via pip: </p><br><pre> <code class="bash hljs">pip install jep</code> </pre> <br><p>  To install Jep for Windows, you must first install the Windows SDK and the corresponding Microsoft Visual Studio.  We have simplified your task a bit and made JEP <a href="https://github.com/inforion/jep/releases/tag/v3.8.2-whl">WHL assemblies</a> for the current versions of Python for Windows, so the module can be installed from a file: </p><br><pre> <code class="bash hljs">pip install jep-3.8.2-cp27-cp27m-win_amd64.whl</code> </pre> <br><p>  To check the installation of Jep, you need to run the command line: </p><br><pre> <code class="bash hljs">python -c <span class="hljs-string"><span class="hljs-string">"import jep"</span></span></code> </pre> <br><p>  In response, a message should be received: </p><br><pre> <code class="bash hljs">ImportError: Jep is not supported <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> standalone Python, it must be embedded <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Java.</code> </pre> <br><p>  In the emulator command file for your system ( <em>kopycat.bat</em> for Windows, <em>kopycat</em> for Linux) add the additional parameter <code>Djava.library.path</code> to the list of <code>DEFAULT_JVM_OPTS</code> parameters ‚Äî it should contain the path to the installed Jep module. </p><br><p>  As a result, Windows should have the following string: </p><br><pre> <code class="plaintext hljs">set DEFAULT_JVM_OPTS="-XX:MaxMetaspaceSize=256m" "-XX:+UseParallelGC" "-XX:SurvivorRatio=6" "-XX:-UseGCOverheadLimit" "-Djava.library.path=C:/Python27/Lib/site-packages/jep"</code> </pre> <br><h2 id="zapusk-kopycat">  Running Kopycat </h2><br><p>  The emulator is a console JVM application.  Run through the operating system command line script (sh / cmd). </p><br><p>  The command to run under Windows: </p><br><pre> <code class="plaintext hljs">bin\kopycat -g 23946 -n rhino -l user -y library -p firmware=firmware\rhino_pass.bin,tty_dbg=COM26,tty_bt=COM28</code> </pre> <br><p>  The command to run on Linux using the socat utility: </p><br><pre> <code class="plaintext hljs">./bin/kopycat -g 23946 -n rhino -l user -y library -p firmware=./firmware/rhino_pass.bin, tty_dbg=socat:./COM26,tty_bt=socat:./COM28</code> </pre> <br><ul><li>  <code>-g 23646</code> - TCP port that will be opened for access to the GDB server; </li><li>  <code>-n rhino</code> - the name of the main module of the system (device assembly); </li><li>  <code>-l user</code> - library name to search for the main module; </li><li>  <code>-y library</code> - the path to search for modules included in the device; </li><li>  <code>firmware\rhino_pass.bin</code> - path to the firmware file; </li><li>  COM26 and COM28 are virtual COM ports. </li></ul><br><p>  As a result, the <code>Python &gt;</code> (or <code>Argparse &gt;</code> ) prompt will be displayed: </p><br><pre> <code class="plaintext hljs">18:07:59 INFO [eFactoryBuilder.create ]: Module top successfully created as top 18:07:59 INFO [ Module.initializeAndRes]: Setup core to top.u1_stm32.cortexm0.arm for top 18:07:59 INFO [ Module.initializeAndRes]: Setup debugger to top.u1_stm32.dbg for top 18:07:59 WARN [ Module.initializeAndRes]: Tracer wasn't found in top... 18:07:59 INFO [ Module.initializeAndRes]: Initializing ports and buses... 18:07:59 WARN [ Module.initializePortsA]: ATTENTION: Some ports has warning use printModulesPortsWarnings to see it... 18:07:59 FINE [ ARMv6CPU.reset ]: Set entry point address to 08006A75 18:07:59 INFO [ Module.initializeAndRes]: Module top is successfully initialized and reset as a top cell! 18:07:59 INFO [ Kopycat.open ]: Starting virtualization of board top[rhino] with arm[ARMv6Core] 18:07:59 INFO [ GDBServer.debuggerModule ]: Set new debugger module top.u1_stm32.dbg for GDB_SERVER(port=23946,alive=true) Python &gt;</code> </pre> <br><h2 id="vzaimodeystvie-s-ida-pro">  Interaction with IDA Pro </h2><br><p>  As a source file for analysis in IDA, to simplify testing, we use the ‚ÄúRhino‚Äù firmware in the form of an <a href="">ELF file</a> (meta information is stored there). </p><br><p>  You can also use the main firmware without metainformation. </p><br><p>  After launching Kopycat in IDA Pro, in the Debugger menu, go to the " <em>Switch debugger ...</em> " item and select " <em>Remote GDB debugger</em> ".  Next, configure the connection: menu <em>Debugger - Process options ...</em> </p><br><p>  Set values: </p><br><ul><li>  Application - any value </li><li>  Hostname: 127.0.0.1 (or the IP address of the remote machine where Kopycat is running) </li><li>  Port: 23946 </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mx/kw/-l/mxkw-lbzq_igoewovazplw4moho.png" alt="Configuring the connection to the GDB server"></div><br><p>  Now the debug start button is available (F9 key): </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/af/mu/-q/afmu-qpi0ymfpsga-orunargmas.png"></div><br><p>  Click it - it connects to the debugger module in the emulator.  IDA goes into debug mode, additional windows become available: information about registers, about the stack. </p><br><p>  Now we can use all standard debugger features: </p><br><ul><li>  step-by-step execution of instructions ( <em>Step into</em> and <em>Step over</em> - keys F7 and F8, respectively); </li><li>  start and pause; </li><li>  creating breakpoints both on code and on data (F2 key). </li></ul><br><p>  Connecting to the debugger does not mean running the firmware code.  The current position for execution must be the address <code>0x08006A74</code> - the beginning of the <em>Reset_Handler</em> function.  If you scroll the listing below, you can see the <em>main</em> function call.  You can position the cursor on this line (address <code>0x08006ABE</code> ) and perform the <em>Run until cursor</em> operation (F4 key). </p><br><p><img src="https://habrastorage.org/webt/wx/k4/3r/wxk43r-316cpnsdabb9eydkzus4.png" alt="image"></p><br><p>  Then you can press F7 to enter the <em>main</em> function. </p><br><p>  If you run the <em>Continue process</em> command (F9 key), the "Please wait" window will appear with a single <em>Suspend</em> button: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9e/78/tg/9e78tgoterc50rqvmosunzp1u5i.png"></div><br><p>  When you click <em>Suspend, the</em> execution of the firmware code is suspended and can be continued from the same address in the code where it was interrupted. </p><br><p>  If you continue the execution of the code, then in the terminals connected to the virtual COM ports, you can see the following lines: </p><br><p><img src="https://habrastorage.org/webt/fi/vi/j-/fivij-hshz3izcxoo0lnewnznc8.png" alt="image"></p><br><p><img src="https://habrastorage.org/webt/2m/cn/oq/2mcnoqd__te1i0sq5z28jd29mdg.png" alt="image"></p><br><p>  The presence of the line "state bypass" indicates that the virtual Bluetooth module has switched to the mode of receiving data from the user's COM port. </p><br><p>  Now, in the Bluetooth terminal (in the figure - COM29), you can enter commands in accordance with the "Rhino" protocol.  For example, the string "mur-mur" will return to the "MEOW" command in the Bluetooth terminal: </p><br><img src="https://habrastorage.org/webt/yq/td/ab/yqtdabgfdd3jlzswsrk3rvbdzds.png"><br><br><h3 id="emuliruy-menya-ne-polnostyu">  Emulate me not completely </h3><br><p>  When building an emulator, you can choose the level of detail / emulation of a device.  For example, the Bluetooth module can be emulated in different ways: </p><br><ul><li>  fully device emulated with a full set of commands; </li><li>  AT commands are emulated, and the data stream is received from the main system COM port; </li><li>  virtual device provides full redirection of data to the real device; </li><li>  in the form of a simple stub, which always returns "OK". </li></ul><br><p>  In the current version of the emulator, the second approach is used - the virtual Bluetooth module performs configuration, after which it switches to the "proxying" mode of data from the COM port of the main system to the UART port of the emulator. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e6/5c/m_/e65cm_tl2bggpbg0-q0azjvdz64.jpeg"></div><br><p>  Consider the possibility of simple code instrumentation if some part of the periphery is not implemented.  For example, if a timer is not created that is responsible for controlling the data transfer in DMA (the check is performed in the <em>ws2812b_wait</em> function located at <code>0x08006840</code> ), then the firmware will always wait for the <em>busy</em> flag reset located at <code>0x200004C4</code> , which shows the DMA data line occupancy: </p><br><img src="https://habrastorage.org/webt/pt/jj/su/ptjjsutfya2dkoqdoshkeyeeqzw.png"><br><p>  We can bypass such a situation by "manually" resetting the <em>busy</em> flag immediately after its installation.  In IDA Pro, you can create a Python function and call it in a breakpoint, while putting the breakpoint itself in the code after writing the value 1 to the <em>busy</em> flag. </p><br><h4 id="breakpoint-obrabotchik">  Breakpoint handler </h4><br><p>  First, create a Python function in IDA.  <em>File</em> menu <em>- Script command ...</em> </p><br><p>  Add a new snippet in the list on the left, give it a name (for example, <em>BPT</em> ), <br>  In the text box on the right, enter the function code: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">skip_dma</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Skipping wait ws2812..."</span></span> value = Byte(<span class="hljs-number"><span class="hljs-number">0x200004C4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> value == <span class="hljs-number"><span class="hljs-number">1</span></span>: PatchDbgByte(<span class="hljs-number"><span class="hljs-number">0x200004C4</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zi/za/-d/ziza-ddx3arqlqfbd-o6jvdmnjc.png"></div><br><p>  After that, click <em>Run</em> and close the script window. </p><br><p>  Now let's move to the code at <code>0x0800688A</code> , set the breakpoint (F2 key), edit it ( <em>Edit breakpoint</em> context menu <em>...</em> ), let's not forget to set the script type - Python: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fo/pn/1v/fopn1vb8fbxqrhn6xoia_rgnsau.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h6/yq/b2/h6yqb29r1m9sngr3csfimxcxsew.png"></div><br><p>  If the current value of the <em>busy</em> flag is 1, then the <em>skip_dma</em> function should be <em>executed</em> in the script line: </p><br><img src="https://habrastorage.org/webt/m-/t8/in/m-t8in2th7ei6neigdzgzq17kxy.png"><br><p>  If you run the firmware for execution, then the triggering of the breakpoint-handler code can be seen in IDA in the <em>Output</em> window along the line <code>Skipping wait ws2812...</code>  Now the firmware will not expect to reset the <em>busy</em> flag. </p><br><h4 id="vzaimodeystvie-s-emulyatorom">  Interaction with the emulator </h4><br><p>  Emulation for the sake of emulation is unlikely to cause delight and joy.  It is much more interesting if the emulator helps the researcher to see the data in memory or to establish the interaction of streams. </p><br><p>  Let us show how to establish the interaction of RTOS tasks in dynamics.  You should first suspend code execution if it is running.  If you go to the <em>bluetooth_task_entry</em> function in the processing branch of the "LED" command (address <code>0x080057B8</code> ), you can see what is created first, and then some message is sent to the <em>ledControlQueueHandle</em> system queue. </p><br><p><img src="https://habrastorage.org/webt/po/bk/zm/pobkzmapmust02eaafle7d_pxba.png" alt="image"></p><br><p>  You should set a breakpoint to access the <em>ledControlQueueHandle</em> variable located at <code>0x20000624</code> and continue with the code: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ev/wo/g3/evwog3vrv7ozxlxjozd4itvve0a.png"></div><br><p>  As a result, it will first stop at address <code>0x080057CA</code> before calling the function <em>osMailAlloc</em> , then at address <code>0x08005806</code> before calling the function <em>osMailPut</em> , then after a while at address <code>0x08005BD4</code> (before calling the function <em>osMailGet</em> ), which belongs to the function <em>leds_task_entry</em> (LED-task), that is, There was a switch of tasks, and now the control has received a LED task. </p><br><p><img src="https://habrastorage.org/webt/th/ni/zh/thnizhzqykfn20l9-btkuqhawlc.png" alt="image"></p><br><p>  In such a simple way, it is possible to establish how RTOS tasks interact with each other. </p><br><p>  Of course, in reality, the interaction of tasks can be more complicated, but using the emulator to track this interaction becomes less time consuming. </p><br><p>  <a href="https://youtu.be/a8xK4T2XNhw">Here</a> you can watch a small video of the emulator launch and interaction with IDA Pro. </p><br><h2 id="zapusk-s-radare2">  Run with Radare2 </h2><br><p>  You can not ignore such a universal tool like Radare2. </p><br><p>  To connect to the emulator using r2, the command will look like this: </p><br><pre> <code class="plaintext hljs">radare2 -A -a arm -b 16 -d gdb://localhost:23946 rhino_fw42k6.elf</code> </pre> <br><p>  Startup ( <code>dc</code> ) and suspension of execution (Ctrl + C) are now available. </p><br><p>  Unfortunately, at the moment in r2 there are problems when working with a hard-core gdb server and memory markup, because of this, breakpoints and Stepes do not work ( <code>ds</code> command).  We hope this will be fixed soon. </p><br><h2 id="zapusk-s-eclipse">  Run with Eclipse </h2><br><p>  One of the uses of the emulator is to debug the firmware of the device being developed.  For clarity, we will also use the firmware "Rhino".  Download the firmware sources <a href="https://github.com/inforion/smartrhino-quest-2018">from here</a> . </p><br><p>  As an IDE, we will use Eclipse from the <a href="https://www.st.com/en/development-tools/sw4stm32.html">System Workbench for STM32</a> suite. </p><br><p>  In order for the emulator to load the firmware directly compiled in Eclipse, you need to add the parameter <code>firmware=null</code> to the command to start the emulator: </p><br><pre> <code class="plaintext hljs">bin\kopycat -g 23946 -n rhino -l user -y library -p firmware=null,tty_dbg=COM26,tty_bt=COM28</code> </pre> <br><h3 id="nastroyka-debug-konfiguracii">  Configuring debug configuration </h3><br><p>  In Eclipse, select the menu <em>Run - Debug Configurations ...</em> In the window that opens, in the <em>GDB Hardware Debugging</em> section, you need to add a new configuration, and then on the Main tab specify the current project and application for debugging: </p><br><img src="https://habrastorage.org/webt/f-/yk/eo/f-ykeob2i5vg25qbrz_egbqntou.png"><br><p>  On the "Debugger" tab, you need to specify the GDB command: <br> <code>${openstm32_compiler_path}\arm-none-eabi-gdb</code> </p> <br><p>  And also enter the parameters for connecting to the GDB server (host and port): </p><br><img src="https://habrastorage.org/webt/ef/ud/fo/efudfommb7a9gkr4kcvp0vtnqfm.png"><br><p>  On the "Startup" tab, you must specify the following parameters: </p><br><ul><li>  Enable the <em>Load image</em> checkbox (to load the assembled image of the firmware into the emulator); </li><li>  Enable the tick <em>Load symbols</em> ; </li><li>  add a start command: <code>set $pc = *0x08000004</code> (set the PC register value from the memory at <code>0x08000004</code> - the <code>0x08000004</code> address is stored there). </li></ul><br><p>  <strong>Note</strong> that if you do not want to load the firmware file from Eclipse, then you do not need to specify the parameters <em>Load image</em> and <em>Run commands</em> . </p><br><img src="https://habrastorage.org/webt/w3/q8/2f/w3q82fvei4c91385rlcipmuiy_i.png"><br><p>  After clicking Debug you can work in debugger mode: </p><br><ul><li>  step-by-step code execution <br><img src="https://habrastorage.org/webt/1h/6n/ax/1h6nax1gpgcdyrwakdmzzlu6_x8.png"></li><li>  interaction with breakpoints <br><img src="https://habrastorage.org/webt/4d/n1/5e/4dn15e4hzaukbif58ggwhy_wg18.png"></li></ul><br><p>  <strong><em>Note</em></strong>  <em>Eclipse has, hmm ... some features ... and you have to live with them.</em>  <em>Here, for example, if the message "No source available for" 0x0 "appears when starting the debugger, then execute the Step command (F5)</em> </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ra/uz/ko/rauzko55hgnj1y_uapnqbz8ftrw.png"></div><br><h2 id="vmesto-zaklyucheniya">  Instead of conclusion </h2><br><p>  Native code emulation is very interesting.  For the device developer, it is possible to debug the firmware without a real device.  For the researcher - the ability to conduct dynamic code analysis, which is not always possible even with the device. </p><br><p>  We want to provide specialists with a tool that would be convenient, fairly simple and did not take much time and effort to set up and launch. </p><br><p>  Write in the comments about your experience using hardware emulators.  We invite you to the discussion and will be happy to answer questions. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/445798/">https://habr.com/ru/post/445798/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445786/index.html">Cryptography in Java. KeyStore class</a></li>
<li><a href="../445788/index.html">Doing cloud-based video surveillance do-it-yourself: new Ivideon Web SDK features</a></li>
<li><a href="../445792/index.html">How we develop documentation in an open project Embox</a></li>
<li><a href="../445794/index.html">IT giants unveiled collaborative solution to deploy hybrid cloud</a></li>
<li><a href="../445796/index.html">Fintech Digest: Dorsey pays Bitcoins, Australia's blockchain strategy, Levi's IPO, Chicago Mayor and the inevitability of Bitcoin</a></li>
<li><a href="../445800/index.html">Monads in 15 minutes</a></li>
<li><a href="../445802/index.html">5 trends of the Internet of Things everyone should know about</a></li>
<li><a href="../445804/index.html">Encapsulation for real samurai, or nuances related to the internal keyword in C #</a></li>
<li><a href="../445806/index.html">How artificial intelligence changes science</a></li>
<li><a href="../445808/index.html">Hated and hounded: the dangerous life of a virus hacker, making powerful enemies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>