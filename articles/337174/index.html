<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to protect yourself from encryptors on the perimeter of the network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Although the most effective protection from encryptors is implemented on end devices, however, preventive measures should be taken at the network peri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to protect yourself from encryptors on the perimeter of the network</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/c32/68c/1a1/c3268c1a14844d27a21625d729a8597c.jpg"><br><br>  Although the most effective protection from encryptors is implemented on end devices, however, preventive measures should be taken at the network perimeter.  <a href="https://www.cloudav.ru/enterprise/downloads/docs/product/gatedefender/">Let us explain</a> how this can be done with the help of <a href="https://www.cloudav.ru/enterprise/downloads/docs/product/gatedefender/">Panda GateDefender</a> . <a name="habracut"></a><br><br>  The events of recent months have shown that traditional antivirus solutions are not very effective in the fight against unknown threats and attacks, including from encrypters.  In <a href="https://habrahabr.ru/company/panda/blog/323138/">our articles,</a> we repeatedly tried to draw your attention to a new security model based on the use of EDR technologies, which, thanks to continuous monitoring, tracking the relationship between all processes and classifying 100% of active processes, can significantly increase the level of security from today's unknown threats: targeted attacks, Fileless attacks, malware-free attacks, unknown exploits and cryptographers, etc.  For example, the <a href="https://habrahabr.ru/company/panda/blog/325710/">Panda Adaptive Defense</a> family of solutions, which uses EDR technologies, are designed to combat such ‚Äúsurprises‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But such solutions are solutions for protecting end devices directly.  And what would not hurt to take on the perimeter of the network? <br><br>  Today in our article we will talk about what preventive security measures should be implemented on the network perimeter in order to filter encryptors before penetrating the corporate network, and also to reduce the possible consequences if some of the representatives of this class of threats are activated on end devices. <br><br>  <b>A little bit about cryptographers</b> <br><br>  As you know, cryptographers are a form of fraud used to extort money from a victim whose end devices were blocked by a certain type of malware, with the result that she (the victim) loses access to the data on these devices. <br><br>  Encryption is a type of malware that installs on the end device and encrypts the contents (all or certain types of files) of its hard drives and on all attached network drives.  As a result, the user loses access to the stored data until he pays the ransom (and it‚Äôs not a fact that after this it will be possible to get full access to all the data!).  CryptoLocker is one of the most "popular" examples of cryptographers using a public RSA key.  Recently, other well-known examples have also become known. <br><br>  To put it simply, cryptographers, as a rule, are distributed in disguised form through quite legitimate content, for example, an email attachment, a zip file containing photos, or other types of files that a potential victim is likely to open, t. to.  does not imply any danger.  However, when opening such files, the encrypter communicates with its management server (the so-called C &amp; C server), which is responsible for generating a new RSA key pair (public / private) and storing the private key, and also sends the public key to the victim's device, after which the malware encrypts everything that it can find on hard drives and connected resources on the local network.  After that, the encrypted data cannot be accessed until it is decrypted using the private key, which is only available on the C &amp; C server. <br><br>  <i>(Although it is worth noting that the latest copies of encrypters ‚Äúlearned‚Äù to activate without actions from a potential victim ...).</i> <br><br>  Indeed, due to the fact that the size of the keys used for encryption is usually not less than 2048 bits, it is almost impossible to decrypt encrypted files without a private key: of course, this is possible in theory, but in practice it may take a lot of time .  Thus, the only way to restore access to the data is to either reinstall all affected devices and restore the backup copy to them, or pay a ransom (which we do not recommend doing!) And hope to receive the private key (although there are many cases when the victims did not receive keys after payment). <br><br>  Therefore, we advise you to keep all your systems and applications in an updated state, as well as to be sure that your employees are well aware of the danger of opening suspicious files or sites.  Preventive measures are the best solution to prevent unpleasant events! <br><br>  <b>Why pay attention to the perimeter of the network?</b> <br><br>  Ensuring the fight against cryptographers and other modern threats, it is necessary to take preventive measures in various directions.  Yes, the most effective measures (if we exclude strict prohibitions for everything at all, so that no one could work properly) can be taken at the level of end devices.  The same EDR-technologies show a very high efficiency in the fight against cryptographers and new threats. <br><br>  But due to the fact that the overwhelming majority of threats penetrate the corporate network from the Internet, the implementation of certain security measures at the perimeter of the network will definitely allow filtering known threats and complicating the encrypters' communication with their external management servers.  Moreover, there is not much to do. <br><br>  <b>An example of protection from encryptors on the network perimeter</b> <br><br>  As an example, consider the <a href="https://www.cloudav.ru/enterprise/downloads/docs/product/gatedefender/">Panda GateDefender solution</a> - a UTM solution for integrated and integrated network perimeter protection, which offers the following modules: antivirus, antispam, content filtering, URL filtering, proxy, firewall, IPS / IDS, VPN, Hotspot, monitoring web applications and more.  This solution comes in hardware, software and virtual versions. <br><br>  With this solution, we will show a number of methods that allow you to intercept these threats at the perimeter of the network, as well as minimize their activity, blocking the channels used by attackers to control malicious processes and the spread of infection. <br><br><h4>  1. Use Panda antivirus </h4><br>  Panda GateDefender uses the Panda anti-virus engine to filter all types of traffic.  It stores its signatures in the cloud, so you will always use updated signatures to identify and block any direction of infection.  Thanks to the Panda antivirus engine, all checks are carried out in real time using the most "fresh" signatures and cloud knowledge bases. <br><br>  To enable the anti-virus engine, in the Panda GateDefender management console, go to <b>Services ‚Üí Anti-virus engine</b> , and on the Panda Anti-virus tab, configure the antivirus options. <br><br><img src="https://habrastorage.org/web/848/517/414/848517414f2242e5b5366f37ff0972df.png"><br><h4>  2. Use IPS service </h4><br>  Intrusion Prevention System (IPS) can not only detect but also block traffic generated from cryptographers to their management servers. <br><br>  To enable protection using IPS, in the Panda GateDefender Management Console, go to <b>Services ‚Üí Intrusion Prevention</b> , where click the <b>Enable IPS</b> switch if it is disabled. <br><br><img src="https://habrastorage.org/web/59d/4d8/eca/59d4d8eca3bd4dcb98476a48cac6eeeb.png"><br><br>  After enabling this service on the <b>Intrusion Prevention System</b> tab, you can configure additional IPS operation options. <br><br><img src="https://habrastorage.org/web/908/051/4a8/9080514a87924b1780fd953ed4f38a0f.png"><br><br>  But in this matter we are more interested in the following <b>Rules</b> tab.  Here on the third page, find the rule set <b>auto / emerging-trojans.rules</b> . <br><br><img src="https://habrastorage.org/web/391/46c/aac/39146caac2a5405f819933e7c85a7cda.png"><br><br>  In this rule set, change the policy from warning to active use by clicking on the icon with the exclamation mark.  After applying the change, the icon will change to a red shield. <br><br><img src="https://habrastorage.org/web/d09/4d7/ac1/d094d7ac18384964b2097d850dce3be6.png"><br><br>  Now all traffic identified with Trojans will be blocked.  You can also use the <b>auto / emerging-tor.rules rule set</b> for additional protection. <br><br><h4>  3. Use a firewall for outgoing connections. </h4><br>  The same CryptoLocker uses Torrents as an infection vector, and TOR connections to interact with their C &amp; C management servers.  Thus, another tip to improve security is to block all outgoing traffic that uses these two protocols. <br><br>  In the Panda GateDefender Management Console, go to <b>Firewall ‚Üí Outbound Traffic.</b> <br><br><img src="https://habrastorage.org/web/e14/3f5/f7c/e143f5f7cbcb4388a5fb7f32e2bc1b85.png"><br><br>  Here create a new rule with a policy to <b>reject or deny</b> to block this outgoing traffic.  At the same time, in order to provide a higher level of protection, add all networks or zones that are after Panda GateDefender, specifying the <b>&lt;ANY&gt;</b> for <b>Source / Type</b> option. <br><br><img src="https://habrastorage.org/web/bea/adb/d91/beaadbd91dc245c4995497066b1b0b9c.png"><br><br>  In addition, this rule must necessarily be first in the list of rules, therefore, it is necessary to set the corresponding value for the option <b>Policy / Position</b> . <br>  As a result, in the list of rules you will see something like the following: <br><br><img src="https://habrastorage.org/web/6a5/be7/709/6a5be7709cd748df9c3c99085f3c9325.png"><br><br><h4>  4. Use HTTP Proxy 1/2: Web Filter </h4><br>  Specify a profile in the HTTP proxy that blocks malicious URLs that can be distributed by encryptors. <br><br>  In the Panda GateDefender management console, go to <b>Proxy ‚Üí HTTP</b> . <br><br><img src="https://habrastorage.org/web/de2/e69/ef4/de2e69ef41814c978b03735a60a04ac9.png"><br><br>  Here go to the <b>Web Filter</b> tab, where you can make changes to an existing profile or create a new one. <br><br><img src="https://habrastorage.org/web/5ee/94c/2a2/5ee94c2a23a7451db90f71dc66d9a06a.png"><br><br>  In the block for selecting filtered categories of web sites in the category Security, block access to the categories <b>Anonymizers, Botnets, Compromised, Malware, Network Errors, Parked Domains, Phishing &amp; Fraud, Spam Sites</b> . <br><br>  By the way, this method is best used in conjunction with the following method. <br><br><h4>  5. Use HTTP Proxy 2/2: Antivirus HTTP Verification </h4><br>  On the same page with options, check that the <b>Enable antivirus scan</b> option <b>is</b> enabled.  By default, it is turned on, and therefore we recommend leaving it on. <br><br><img src="https://habrastorage.org/web/fc4/eb6/10e/fc4eb610eea540a88beeced3c2259847.png"><br><br><h4>  6. Enable HTTPS Proxy </h4><br>  HTTPS connections are often used to spread the infection.  Thus, HTTPS proxies can be used to intercept connections, allowing only legitimate connections to well-known websites. <br><br>  Since  HTTPS proxy works only in a pair with the HTTP proxy enabled, then first check that the latter is enabled in the <b>Proxy ‚Üí HTTP</b> section.  After that, go to the <b>HTTPS proxy</b> tab and enable the Enable <b>HTTPS proxy</b> option. <br><br><img src="https://habrastorage.org/web/a80/61b/071/a8061b07108847dd8988fcff4959ae58.png"><br><br><h4>  7. Enable SMTP proxy 1/2: Anti-virus scan </h4><br>  Often, cryptographers are distributed through attachments to emails, which at first glance may seem letters from well-known and legitimate senders, but in fact they contain a false link or a fake dangerous attachment.  In this regard, it is recommended to activate anti-virus scanning in the SMTP proxy. <br><br>  In the Panda GateDefender management console, go to <b>Proxy ‚Üí SMTP</b> and enable SMTP proxy.  Then, in the <b>Virus settings</b> section, enable the <b>Scan mail for viruses</b> option to activate the anti-virus engine for mail traffic. <br><br><img src="https://habrastorage.org/web/8d0/34c/f00/8d034cf0085947d18fdbe572ddbc3aee.png"><br><br>  You can also configure what to do with the letters that will be marked as spam, as well as a number of other options. <br><br>  After that, click the Save button to save the new configuration, and then in the confirmation message, you must apply the modified configuration in order to restart the SMTP proxy. <br><br>
<h4>  8. Enable SMTP Proxy 2/2: File Extensions and Dual Extensions </h4><br>  Another way to deliver encryptors as a mail attachment is to name the attached file using a double extension.  (for example, meeting.png.bat), as a result of which the email client shows only the first extension (meeting.png), by virtue of which the user thinks that he has received a file with a picture.  Double-clicking on this file, the user will not see any image, but a bat file will run without the user's permission.  So another good recommendation is to block potentially dangerous file extensions and to ban the transfer of email attachments with a double extension. <br><br>  To configure in the Panda GateDefender management console, go to the Proxy -&gt; SMTP section and enable the SMTP proxy (if it was turned off). <br><br><img src="https://habrastorage.org/web/4b8/92e/37e/4b892e37e34a42618adb6b8de0c695de.png"><br><br>  Then, in the <b>File settings</b> section, enable the <b>Block files by extension</b> option to activate the email attachment checking system. <br>  After that, in the list for selecting file types for blocking by extension, select all extensions that should be blocked by SMTP proxy, and enable the option to block double extension files and select the corresponding values ‚Äã‚Äãin the drop-down menu that appears. <br><br><h4>  9. Enable DNS Proxy </h4><br>  When CryptoLocker or other cryptographers are launched, they will try to change the DNS settings on the infected machine so that they can communicate with their management servers to work correctly.  This development can be avoided by enabling the DNS proxy in the Panda GateDefender solution.  In this case, all DNS requests from the device, which is located behind the Panda GateDefender solution, will always be intercepted by them, blocking any opportunity for cryptographers to contact their management server. <br><br>  To do this, go to the section <b>Proxy ‚Üí DNS</b> . <br><br><img src="https://habrastorage.org/web/279/052/bbd/279052bbd4f84572998536cad1ca05fe.png"><br><br>  By the way, on the <b>Antispyware</b> tab, it makes sense to put daily updates to block known malicious domains. <br><br><h4>  Conclusion </h4><br>  As a result of the above simple actions, you can configure the perimeter protection of the network from encrypters by trying to block their penetration into the corporate network from the Internet, as well as complicating their ability to interact with their management servers.  Such preventive measures will significantly reduce the risk of infection, as well as be able to minimize the possible consequences after the launch of encrypters in the corporate network. <br>  <b><a href="https://www.cloudav.ru/enterprise/downloads/docs/product/gatedefender/">More information about Panda GateDefender</a></b> <br><br>  You can also order a free version of Panda GateDefender for a period of 1 month by sending a request to sales@rus.pandasecurity.com. </div><p>Source: <a href="https://habr.com/ru/post/337174/">https://habr.com/ru/post/337174/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337164/index.html">Excursion to the Museum of Computer History in California, with the benefit of the development. Part 1. ENIAC, Stretch, CDC6600, IBM / 360</a></li>
<li><a href="../337166/index.html">Moving to the server side with bem-express</a></li>
<li><a href="../337168/index.html">We write and parsim assembly language MCS-51, as in BASIC</a></li>
<li><a href="../337170/index.html">The book "Continuous delivery. The practice of continuous updates "</a></li>
<li><a href="../337172/index.html">IT events digest for September</a></li>
<li><a href="../337176/index.html">According to Rambler.iOS # 9</a></li>
<li><a href="../337178/index.html">How to stop worrying and start talking</a></li>
<li><a href="../337180/index.html">Differences Postgres Pro Enterprise and PostgreSQL</a></li>
<li><a href="../337182/index.html">Greetings to Yandex developers</a></li>
<li><a href="../337184/index.html">Current data on the telephone codes of Russian cities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>