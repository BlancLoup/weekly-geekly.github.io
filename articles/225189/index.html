<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Multimodule Java-project with Gradle. Step by step</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A lot of articles about Gradle written. And for my part, I would like to add such step-by-step instructions to the piggy bank, the reading of which, I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Multimodule Java-project with Gradle. Step by step</h1><div class="post__text post__text-html js-mediator-article">  A lot of articles about <a href="http://www.gradle.org/">Gradle</a> written.  And for my part, I would like to add such step-by-step instructions to the piggy bank, the reading of which, I hope, will allow those who are not familiar with Gradle to ‚Äútry out‚Äù and continue to independently study this tool. <br><br>  This article will not describe in detail such topics as the gradle (plugin) plug-ins, tasks (tasks), dependencies (dependencies), automatic testing and other delights of this project builder.  First, each topic deserves a separate article or even a series of articles, and secondly, there are already articles on these topics on these topics, for example: <a href="http://habrahabr.ru/post/107558/">Gradle: Tasks Are Code</a> , <a href="http://habrahabr.ru/post/107085/">Gradle: Better Way To Build</a> .  And on the Gradle official site there is a beautifully written <a href="http://www.gradle.org/docs/current/userguide/userguide.html">Gradle User Guide</a> .  I will focus on the direct solution of the problem, and all related topics will be described within the framework of this very task. <br>  First we decide on the goal, what do we want to get at the output?  And the goal is indicated in the title of the article.  We want to get a project with several modules that is built using Gradle.  And so, let's get started. <br><a name="habracut"></a><br><br><h5>  Step 1. Install gradle </h5><br>  <b>Note:</b> <i>If you just want to ‚Äúplay‚Äù with gradle by downloading the files for the article, or you get other people's sources with the magic file gradlew (gradlew.bat) in the root of the project, then installing gradle is not necessary.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Gradle can be delivered by downloading the latest version from the Gradle <a href="http:/www.gradle.org/downloads">downloads page</a> or using the package manager in your favorite OS (note I put on Mac OS via brew and on Debian via apt-get from standard sources) <br><br>  Result of the first step: <br><pre><code class="hljs pgsql">$ gradle -<span class="hljs-keyword"><span class="hljs-keyword">version</span></span> <span class="hljs-comment"><span class="hljs-comment">------------------------------------------------------------ Gradle 1.11 ------------------------------------------------------------ Build time: 2014-02-11 11:34:39 UTC Build number: none Revision: a831fa866d46cbee94e61a09af15f9dd95987421 Groovy: 1.8.6 Ant: Apache Ant(TM) version 1.9.2 compiled on July 8 2013 Ivy: 2.2.0 JVM: 1.8.0_05 (Oracle Corporation 25.5-b02) OS: Mac OS X 10.9.3 x86_64</span></span></code> </pre> <br><br><h5>  Step 2. Empty project, plug-ins (plugin), wrapper (wrapper) </h5><br>  Create a project folder and in its root make the file <code>build.gradle</code> with the following contents: <br><br>  <b>{project_path} /build.gralde</b> <br><pre> <code class="hljs pgsql">apply plugin: ‚Äújava‚Äù apply plugin: ‚Äúapplication‚Äù task <span class="hljs-keyword"><span class="hljs-keyword">wrapper</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Wrapper</span></span>) { gradleVersion = <span class="hljs-string"><span class="hljs-string">'1.12'</span></span> }</code> </pre><br>  Let's take a closer look at what we wrote in the file.  It uses the dynamic language Groovy.  Using a full-fledged programming language in gradle gives you more freedom compared to package builders using declarative languages. <br>  In this file we connect <code>java</code> and <code>application</code> plugins.  The <code>java</code> plugin contains such useful tasks as jar ‚Äî compile a jar archive, compileJava ‚Äî compile source codes, etc. You can read more about the plugin <a href="http://www.gradle.org/docs/current/userguide/java_plugin.html">here</a> .  The <code>application</code> plugin contains the following tasks: run - launch the application;  installApp - installing an application on a computer, this task creates executable files for * nix and for windows (bat file);  distZip - assembles the application in a zip archive, placing there all the jar files, as well as operating system-specific scripts.  Read more about the plugin in the <a href="http://www.gradle.org/docs/current/userguide/application_plugin.html">documentation</a> . <br>  Now let's dwell on the task <code>wrapper</code> .  This very useful task is probably the most ingenious solution, designed to make life easier for programmers.  After completing the <code>$ gradle wrapper</code> , we get the following result: <br><br><pre> <code class="hljs pgsql">$ gradle <span class="hljs-keyword"><span class="hljs-keyword">wrapper</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">wrapper</span></span> BUILD SUCCESSFUL Total <span class="hljs-type"><span class="hljs-type">time</span></span>: <span class="hljs-number"><span class="hljs-number">7.991</span></span> secs</code> </pre><br><pre> <code class="hljs mel">$ <span class="hljs-keyword"><span class="hljs-keyword">ls</span></span> -a . .. .gradle build.gradle gradle gradlew gradlew.bat</code> </pre><br>  We see that the script created us gradlew executable files for * nix, gradlew.bat for Windows, as well as the gradle and .gradle folders.  Hidden folder .gradle can not be included in the repository, it contains libraries of dependencies.  All the core lies in the gradle and in the gradlew file itself.  Now we can safely give our project to anyone with jdk of the required version, and he can independently compile, build, install the project using <code>./gradlew</code> .  Note that my version of gradle (see the result of the <code>$ gradle -version</code> above) is different from the one I specified in the build.gradle file, but this is not terrible, because after running the wrapper task, we will get the necessary version of gradle. <br><br><pre> <code class="hljs pgsql">$ ./gradlew -<span class="hljs-keyword"><span class="hljs-keyword">version</span></span> <span class="hljs-comment"><span class="hljs-comment">------------------------------------------------------------ Gradle 1.12 ------------------------------------------------------------ Build time: 2014-04-29 09:24:31 UTC Build number: none Revision: a831fa866d46cbee94e61a09af15f9dd95987421 Groovy: 1.8.6 Ant: Apache Ant(TM) version 1.9.3 compiled on December 23 2013 Ivy: 2.2.0 JVM: 1.8.0_05 (Oracle Corporation 25.5-b02) OS: Mac OS X 10.9.3 x86_64</span></span></code> </pre><br>  Now, instead of <code>gradle</code> you can safely use <code>gradlew</code> .  By the way, executing the <code>$ ./gradlew</code> without parameters will create a <code>.gralde</code> folder and download all dependent libraries there (about dependencies below).  But the execution of this command is not necessary, since at any launch of gradle (gradlew) dependencies will be checked and the missing files will be downloaded.  Therefore, having received a project in which the gradlew files are located, you can immediately start the necessary task, the list of which can be obtained using the command <code>./gradlew tasks</code> <br><br>  Results of the second step (withdrawal reduced): <br><pre> <code class="hljs delphi">$ ./gradlew tasks :tasks ------------------------------------------------------------ All tasks runnable from root project ------------------------------------------------------------ Application tasks ----------------- distTar - Bundles the project <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> a JVM application <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> libs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> OS specific scripts. distZip - Bundles the project <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> a JVM application <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> libs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> OS specific scripts. installApp - Installs the project <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> a JVM application along <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> libs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> OS specific scripts. run - Runs this project <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> a JVM application ... Other tasks ----------- wrapper ... <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> see all tasks <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> more detail, run <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> --all. BUILD SUCCESSFUL Total time: <span class="hljs-number"><span class="hljs-number">7.808</span></span> secs</code> </pre><br><br><h5>  Step 3. Fill in the blanks </h5><br>  At this stage, we can already perform several <code>gradle</code> tasks.  We can even compile a jar file, but nothing but an empty manifest will be there.  It's time to write the code.  Gradle uses by default the same directory structure as <a href="http://maven.apache.org/">Maven</a> , namely <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">src</span></span> -main -java -resources -test -java -resources</code> </pre><br>  <code>main/java</code> are java-files of our program, <code>main/resources</code> are other files (* .properties, * .xml, * .img and others).  The <code>test</code> contains the files necessary for testing. <br>  Since the testing in this article will not be considered, we will manage to create the <code>src/main</code> folder with all the nested ones and start creating our application.  And the application is Hello World, in which we will use the <a href="http://logging.apache.org/log4j/1.2/">Log4j</a> library.  Let's just figure out how dependencies work in gradle.  <code>build.gradle</code> 's make changes to the <code>build.gradle</code> file, create a <code>com/example/Main.java</code> with the main application class in the <code>src/main/java</code> folder, as well as the Log4j <code>src/main/resources/log4j.xml</code> .  And the file <code>gradle.properties</code> (optional, details below) <br><br>  <b>{project_path} /build.gradle</b> <br><pre> <code class="hljs pgsql">apply plugin: "java" apply plugin: "application" mainClassName = "com.example.Main" sourceCompatibility = JavaVersion.VERSION_1_7 targetCompatibility = JavaVersion.VERSION_1_7 repositories { mavenCentral() } dependencies { compile "log4j:log4j:1.2.17" } jar { manifest.attributes("Main-Class": mainClassName); } task <span class="hljs-keyword"><span class="hljs-keyword">wrapper</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Wrapper</span></span>) { gradleVersion = "1.12" }</code> </pre><br>  <b>{project_path} /gradle.properties</b> <br><pre> <code class="hljs javascript">org.gradle.java.home=<span class="hljs-regexp"><span class="hljs-regexp">/Library/</span></span>Java/JavaVirtualMachines/jdk1<span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>_55.jdk/Contents/Home/</code> </pre><br>  <b>{project_path} /src/main/java/com/example/Main.java</b> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.log4j.Logger; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Logger LOG = Logger.getLogger(Main.class); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ LOG.info(<span class="hljs-string"><span class="hljs-string">"Application started"</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"I'm the main project"</span></span>); LOG.info(<span class="hljs-string"><span class="hljs-string">"Application finished"</span></span>); } }</code> </pre><br>  <b>{project_path} /src/main/resources/log4j.xml</b> <br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">log4j:configuration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:log4j</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://jakarta.apache.org/log4j/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appender</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"console"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.apache.log4j.ConsoleAppender"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Target"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.out"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.apache.log4j.PatternLayout"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ConversionPattern"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%p %c: %m%n"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">layout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appender</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">priority</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag"> =</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"debug"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appender-ref</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"console"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">root</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">log4j:configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Consider the changes in the <code>build.gradle</code> file.  We added the <code>mainClassName</code> variable.  It indicates the main class of our application and is used by the <code>application</code> plugin in the <code>run</code> task.  This class will be launched.  We also added the variables <code>sourceCompatibility</code> and <code>targetCompatibility</code> , assigning them the value <code>JavaVersion.VERSION_1_7</code> .  These are variables from the <code>java</code> plugin that show which version of jdk we need when building.  The next block is <code>repositories</code> .  In this block we connect <a href="http://maven.apache.org/">Maven</a> repository.  Gradle is friends with him.  The <code>dependencies</code> block contains the dependencies of our application.  Subtleties settings look in the <a href="http://www.gradle.org/docs/current/userguide/dependency_management.html">documentation</a> .  Here we indicate that the <code>compile</code> task requires log4j.  In the example, the abbreviated syntax is specified.  You can write a detailed version and it will look like this: <br><pre> <code class="hljs pgsql">complie <span class="hljs-keyword"><span class="hljs-keyword">group</span></span>: <span class="hljs-string"><span class="hljs-string">'log4j'</span></span>, <span class="hljs-type"><span class="hljs-type">name</span></span>: <span class="hljs-string"><span class="hljs-string">'log4j'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-string"><span class="hljs-string">'1.2.17'</span></span></code> </pre><br>  For comparison, a similar block in maven: <br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>log4j<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>log4j<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.2.17<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  You can also configure dependencies on the <code>compile files('libs/a.jar', 'libs/b.jar')</code> and on the <code>compile project(':library_project')</code> subprojects. <br>  The last addition to <code>build.gradle</code> is the <code>jar</code> block.  It also refers to the <code>java</code> plugin.  Contains additional information for assembling jar-file.  In this case, we add the main class to the manifest, using the variable declared above, <code>mainClassName</code> . <br>  Next is the optional <code>gradle.properties</code> file.  This file is scattered throughout the documentation, a bit found <a href="http://www.gradle.org/docs/current/userguide/tutorial_this_and_that.html">here</a> and <a href="http://www.gradle.org/docs/current/userguide/build_environment.html">here</a> .  In this case, we actually override the <code>JAVA_HOME</code> variable.  This is true when you have several versions of jdk, as in my case, you could notice at the beginning of the article, <code>$ gradle -version</code> shows that my version of <code>JVM: 1.8.0_05 (Oracle Corporation 25.5-b02)</code> . <br>  I think it‚Äôs pointless to dwell on the files <code>src/main/java/Main.java</code> and <code>src/main/resources/log4j.xml</code> , since everything is extremely simple.  We send two messages to the Logger, the message ‚ÄúI'm the main project‚Äù is output to the console.  In the log4j settings file, it is written that our logger will display messages also to the console. <br><br>  Results of the third step: <br><pre> <code class="hljs ruby">$ ./gradlew run <span class="hljs-symbol"><span class="hljs-symbol">:compileJava</span></span> Download <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/repo1.maven.org/maven</span></span>2/log4j/log4j/<span class="hljs-number"><span class="hljs-number">1.2</span></span>.<span class="hljs-number"><span class="hljs-number">17</span></span>/log4j-<span class="hljs-number"><span class="hljs-number">1.2</span></span>.<span class="hljs-number"><span class="hljs-number">17</span></span>.jar <span class="hljs-symbol"><span class="hljs-symbol">:processResources</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:classes</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:run</span></span> INFO com.example.<span class="hljs-symbol"><span class="hljs-symbol">Main:</span></span> Application started I<span class="hljs-string"><span class="hljs-string">'m the main project INFO com.example.Main: Application finished BUILD SUCCESSFUL Total time: 14.627 secs</span></span></code> </pre><br>  It is seen that the missing library is downloaded, and its use is demonstrated. <br><br><h5>  Step 4. Reaching the goal </h5><br>  We already have a project that works, builds and runs through gradle.  It remains to finish a little: implement multi-modularity, stated in the title of the article, or a <a href="http://www.gradle.org/docs/current/userguide/tutorial_java_projects.html">multi-project</a> , if you use the terminology of gradle.  Create two directories in the project root: <code>main_project</code> and <code>library_project</code> .  Now move the <code>src</code> folder and the <code>build.gradle</code> file to the newly created <code>main_project</code> directory, and create a new <code>settings.gradle</code> file with this content in the root (more about this file <a href="http://www.gradle.org/docs/current/userguide/build_lifecycle.html">here</a> ): <br><br>  <b>{project_path} /settings.gradle</b> <br><pre> <code class="hljs pgsql">rootProject.name = <span class="hljs-string"><span class="hljs-string">'Gradle_Multiproject'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> <span class="hljs-string"><span class="hljs-string">'main_project'</span></span></code> </pre><br>  In this file we say what our project is called and which folders to connect (in fact, independent gradle projects).  At this stage, we need one <code>main_project</code> folder.  After such changes, we can execute the <code>$ ./gradlew run</code> or with the specific <code>$ ./gradlew main_project:run</code> subproject, and get the same result as at the end of step 3. That is, a working project.  We can also execute all other jar, build, installApp, and so on.  Gradle, if you do not specify a specific subproject, will run the task in all connected subprojects that have this task (for example, if the application plugin is connected to only one subproject, we will have main_project, the <code>$ ./gradlew run</code> will run only this subproject ) <br>  Now create the code in our <code>library_project</code> .  Create <code>build.gradle</code> and <code>src/main/java/com/example/library/Simple.java</code> <br><br>  <b>{project_path} /library_project/build.gradle</b> <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">apply</span></span> plugin: <span class="hljs-string"><span class="hljs-string">"java"</span></span> sourceCompatibility = JavaVersion.VERSION_1_7 targetCompatibility = JavaVersion.VERSION_1_7</code> </pre><br><br>  <b>{project_path} /library_project/src/main/java/com/example/library/Simple.java</b> <br><pre> <code class="hljs cs">package com.example.library; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Simple</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getValue</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setValue</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } }</code> </pre><br><br>  <code>build.gradle</code> much easier for this subproject.  We use java plugin and set variables with JDK version.  This article is sufficient for this article.  Now we want gradle to know about the library_project <code>library_project</code> , we will describe it in the file <code>settings.gradle</code> : <br><br>  <b>{project_path} /settings.gradle</b> <br><pre> <code class="hljs pgsql">rootProject.name = <span class="hljs-string"><span class="hljs-string">'Gradle_Multiproject'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> <span class="hljs-string"><span class="hljs-string">'main_project'</span></span>, <span class="hljs-string"><span class="hljs-string">'library_project'</span></span></code> </pre><br>  Now we can build the jar file containing our library with the <code>$ ./gradlew library_project:jar</code> command. <br><pre> <code class="hljs ruby">$ ./gradlew <span class="hljs-symbol"><span class="hljs-symbol">library_project:</span></span>jar <span class="hljs-symbol"><span class="hljs-symbol">:library_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:compileJava</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:library_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:processResources</span></span> UP-TO-DATE <span class="hljs-symbol"><span class="hljs-symbol">:library_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:classes</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:library_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:jar</span></span> BUILD SUCCESSFUL Total <span class="hljs-symbol"><span class="hljs-symbol">time:</span></span> <span class="hljs-number"><span class="hljs-number">10.061</span></span> secs</code> </pre><br>  The resulting file can be found at: <code>{project_path}/library_project/build/libs/library_project.jar</code> . <br>  Now let's add the use of the <code>Simple</code> class in <code>main_project</code> .  To do this, add the line <code>compile project(":library_project")</code> to the <code>{project_path}/main_project/build.gradle</code> file in the <code>dependencies</code> block, which reports that the <code>library_project</code> project is needed for the execution of the compile task in this module. <br><br>  <b>Addition from <a href="https://habrahabr.ru/users/minim/" class="user_link">MiniM</a></b> : In graddle, the symbol ":" is used instead of "/" and for a more branchy structure, references to the project may look like this: "loaders: xml-loader" <br><br>  <b>{project_path} /main_project/build.gradle</b> ( <code>dependencies</code> block) <br><pre> <code class="hljs nginx"><span class="hljs-section"><span class="hljs-section">dependencies</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">compile</span></span> <span class="hljs-string"><span class="hljs-string">"log4j:log4j:1.2.17"</span></span> compile project(<span class="hljs-string"><span class="hljs-string">":library_project"</span></span>) }</code> </pre><br><br>  <b>{project_path} /main_project/src/main/java/com/example/Main.java</b> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.log4j.Logger; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.example.library.Simple; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Logger LOG = Logger.getLogger(Main.class); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ LOG.info(<span class="hljs-string"><span class="hljs-string">"Application started"</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"I'm the main project"</span></span>); Simple simple = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Simple(); simple.setValue(<span class="hljs-number"><span class="hljs-number">10</span></span>); System.out.println(<span class="hljs-string"><span class="hljs-string">"Value from Simple: "</span></span> + simple.getValue()); LOG.info(<span class="hljs-string"><span class="hljs-string">"Application finished"</span></span>); } }</code> </pre><br>  You can check. <br><br>  The result of the fourth step: <br><pre> <code class="hljs ruby">$ ./gradlew run <span class="hljs-symbol"><span class="hljs-symbol">:library_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:compileJava</span></span> UP-TO-DATE <span class="hljs-symbol"><span class="hljs-symbol">:library_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:processResources</span></span> UP-TO-DATE <span class="hljs-symbol"><span class="hljs-symbol">:library_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:classes</span></span> UP-TO-DATE <span class="hljs-symbol"><span class="hljs-symbol">:library_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:jar</span></span> UP-TO-DATE <span class="hljs-symbol"><span class="hljs-symbol">:main_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:compileJava</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:main_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:processResources</span></span> UP-TO-DATE <span class="hljs-symbol"><span class="hljs-symbol">:main_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:classes</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:main_project</span></span><span class="hljs-symbol"><span class="hljs-symbol">:run</span></span> INFO com.example.<span class="hljs-symbol"><span class="hljs-symbol">Main:</span></span> Application started I<span class="hljs-string"><span class="hljs-string">'m the main project Value from Simple: 10 INFO com.example.Main: Application finished BUILD SUCCESSFUL Total time: 11.022 secs</span></span></code> </pre><br><br><h5>  Step 5 (final).  Remove trash </h5><br>  The main goal has been achieved, but at this stage quite legitimate questions could arise about the duplication of information in the build files, a deeper gradle setting, and also what to study further.  For self-study, I advise you to read the contents of the links at the end of the article.  For now, let's tidy up our build files by creating <code>build.gradle</code> in the project root and changing the contents of the rest of the build files. <br><br>  <b>{project_path} /build.gradle</b> <br><pre> <code class="hljs pgsql">apply plugin: "idea" apply plugin: "eclipse" subprojects { apply plugin: "java" tasks.withType(JavaCompile) { sourceCompatibility = JavaVersion.VERSION_1_7 targetCompatibility = JavaVersion.VERSION_1_7 } repositories { mavenCentral() } } task <span class="hljs-keyword"><span class="hljs-keyword">wrapper</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Wrapper</span></span>) { gradleVersion = "1.12" }</code> </pre><br>  <b>{project_path} /main_project/build.gradle</b> <br><pre> <code class="hljs cs">apply plugin: <span class="hljs-string"><span class="hljs-string">"application"</span></span> version = <span class="hljs-string"><span class="hljs-string">'1.0'</span></span> mainClassName = <span class="hljs-string"><span class="hljs-string">"com.example.Main"</span></span> dependencies { compile <span class="hljs-string"><span class="hljs-string">"log4j:log4j:1.2.17"</span></span> <span class="hljs-function"><span class="hljs-function">compile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">project</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">":library_project"</span></span></span></span></span><span class="hljs-function">) } jar</span></span> { manifest.attributes(<span class="hljs-string"><span class="hljs-string">"Main-Class"</span></span>: mainClassName); }</code> </pre><br>  <b>{project_path} /build.gradle</b> <br><pre> <code class="hljs pgsql">version = "1.1_beta"</code> </pre><br>  In the root <code>build.gradle</code> we will store what applies to all projects (in fact, you can store all the settings at all, but I prefer to split large files) and what is not needed in the subprojects, for example, we need only one wrapper, fundamentally. <br>  In the <code>subprojects</code> block we place the settings of the subprojects, namely: we connect the java plugin - everyone needs it;  we expose the jdk version;  we connect a maven repository.  Also in this file we connect the plugins <a href="http://www.gradle.org/docs/current/userguide/idea_plugin.html">idea</a> and <a href="http://www.gradle.org/docs/current/userguide/eclipse_plugin.html">eclipse</a> .  These plugins contain tasks for generating project files for the respective IDEs.  And here we transfer the task wrapper.  It is needed only in the root to create common gradlew files for all. <br>  In the subprojects, we removed all unnecessary and added the variable <code>version</code> .  The value of this variable will be added to jar files, for example, instead of library_project.jar will now be library_project-1.1.beta.jar. <br>  In addition to the <code>subprojects</code> block, you can use <code>allprojects</code> or <code>project(':project_name')</code> .  Read more <a href="http://www.gradle.org/docs/current/userguide/multi_project_builds.html">here</a> . <br><br>  On this I will finish.  I hope this article has aroused interest among people who are not familiar with Gradle, and prompted a more detailed study and subsequent use of this tool in their projects. <br><br>  Thanks for attention. <br><br>  <b>Additions:</b> <br>  <a href="https://habrahabr.ru/users/minim/" class="user_link">MiniM</a> : In the gradle, the symbol ":" is used instead of "/" and for a more branched structure, the links to the project may look like this ": loaders: xml-loader" <br>  <a href="https://habrahabr.ru/users/leventov/" class="user_link">leventov</a> : <code>idea  </code> with the <code>idea  </code> plugin.  <a href="http://issues.gradle.org/browse/GRADLE-1041">issues.gradle.org/browse/GRADLE-1041</a> , there is a solution in the last comment. <br><br><h5>  useful links </h5><br>  <a href="https://bitbucket.org/evsan/gradle_multiproject">Sources of the project created in the article on bitbucket</a> ( <a href="">zip archive</a> ) <br>  <a href="http://www.gradle.org/">Gradle</a> <br>  <a href="http://www.gradle.org/docs/current/userguide/userguide.html">Gradle User Guide</a> <br>  <a href="http://logging.apache.org/">Apache logging services</a> <br>  <a href="http://maven.apache.org/">Apache maven</a> <br>  <a href="http://groovy.codehaus.org/">Groovy language</a> </div><p>Source: <a href="https://habr.com/ru/post/225189/">https://habr.com/ru/post/225189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225175/index.html">New invariant number. The study of the natural number series (NPS)</a></li>
<li><a href="../225177/index.html">Rule number N + 0: do not be afraid to dig deeper</a></li>
<li><a href="../225179/index.html">Speech recognition in Asterisk using the Yandex SpeechKit HTTP API</a></li>
<li><a href="../225183/index.html">Non-obvious features of the storage</a></li>
<li><a href="../225187/index.html">Zetes: Java with a multi-platform GUI, but without an Oracle JVM</a></li>
<li><a href="../225191/index.html">Chinese Internet: a brief overview of near-social services</a></li>
<li><a href="../225193/index.html">The history of joint trips in Russia and abroad</a></li>
<li><a href="../225195/index.html">Crucial MX100: 256GB SSD for 110 dollars</a></li>
<li><a href="../225197/index.html">Google has released a 64-bit version of Chrome for Windows</a></li>
<li><a href="../225199/index.html">We study Three.js.Glava 2: Work with the main components of whichThree.js-scene</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>