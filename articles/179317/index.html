<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Debugging Go Code with GDB. Introduction</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The following applies to the gc toolkit. Gccgo has built-in gdb support. In addition to this review, you can consult the GDB manual . 

 When you comp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Debugging Go Code with GDB. Introduction</h1><div class="post__text post__text-html js-mediator-article"> <i>The following applies to the <code>gc</code> toolkit.</i>  <i>Gccgo has built-in gdb support.</i>  <i>In addition to this review, you can consult the <a href="http://sourceware.org/gdb/current/onlinedocs/gdb/">GDB manual</a> .</i> <br><br>  When you compile and link your Go programs using gc tools in Linux, Mac OS X, or FreeBSD, the resulting binary files contain DWARFv3 debugging information that the latest version of GDB debugger (&gt; 7.1) can use to examine the live process or dump. <a name="habracut"></a><br><br>  To omit debug information, pass the <code>'-s'</code> flag to the linker (for example, <code>go build -ldflags "-s" prog.go</code> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The code generated by the gc compiler includes embedding function calls and registering variables.  These optimizations can sometimes make debugging using GDB more difficult.  To disable them during debugging, pass the <code>-gcflags "-N -l"</code> flag to the <a href="http://golang.org/cmd/go"><code>go</code></a> command, which is used to build debugged code. <br><br><h4>  Common operations </h4><br><ul><li>  Display the file and line number of the code, set a breakpoint and disassemble: <br><pre> <code class="hljs cmake">(gdb) <span class="hljs-keyword"><span class="hljs-keyword">list</span></span> (gdb) <span class="hljs-keyword"><span class="hljs-keyword">list</span></span> line (gdb) <span class="hljs-keyword"><span class="hljs-keyword">list</span></span> <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>.go:line (gdb) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> line (gdb) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>.go:line (gdb) disas</code> </pre> <br></li><li>  Show traces and promoted stack frames: <br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">gdb</span></span>) bt (<span class="hljs-name"><span class="hljs-name">gdb</span></span>) frame n</code> </pre> <br></li><li>  Show the name, type, and location in the stack frame of local variables, arguments, and return values: <br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">gdb</span></span>) info locals (<span class="hljs-name"><span class="hljs-name">gdb</span></span>) info args (<span class="hljs-name"><span class="hljs-name">gdb</span></span>) p variable (<span class="hljs-name"><span class="hljs-name">gdb</span></span>) whatis variable</code> </pre> <br></li><li>  Show name, type and location of global variables: <br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">gdb</span></span>) info variables regexp</code> </pre> <br></li></ul><br><h4>  Go extensions </h4><br>  The new extension mechanism GDB allows you to load extension scripts for a given binary file.  The toolkit uses this fact to expand GDB with a small number of commands that allow you to explore the insides of executable code (such as gorutiny) and beautifully display the built-in types of dictionaries, slices and channels. <br><br><ul><li>  Beautiful display of strings, slices, dictionaries, channels or interfaces: <br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">gdb</span></span>) p var</code> </pre> <br></li><li>  The $ len () and $ cap () functions for strings, slices, and dictionaries: <br><pre> <code class="hljs go">(gdb) p $<span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>)</code> </pre> <br></li><li>  The function to bring interfaces to their dynamic types: <br><pre> <code class="hljs php">(gdb) p $dtype(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>) (gdb) iface <span class="hljs-keyword"><span class="hljs-keyword">var</span></span></code> </pre> <br>  <b>Known issue:</b> GDB cannot automatically find the dynamic type of the interface value if its name is long and short (annoying when the stack trace is displayed, instead of a beautiful display, we get a short type name and a pointer). <br><br></li><li>  Research gorutin: <br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">gdb</span></span>) info goroutines (<span class="hljs-name"><span class="hljs-name">gdb</span></span>) goroutine n cmd (<span class="hljs-name"><span class="hljs-name">gdb</span></span>) help goroutine</code> </pre> <br>  For example: <br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">gdb</span></span>) goroutine <span class="hljs-number"><span class="hljs-number">12</span></span> bt</code> </pre> <br></li></ul><br>  If you want to know how the extension script works or you want to expand it, look at <a href="http://golang.org/src/pkg/runtime/runtime-gdb.py">src / pkg / runtime / runtime-gdb.py</a> in the Go source directory.  It depends on several special magic types ( <code>hash&lt;T,U&gt;</code> ) and variables ( <code>runtime.m</code> and <code>runtime.g</code> ), the description of which in the DWARF code is provided by the linker ( <a href="">src / cmd / ld / dwarf.c</a> ). <br><br>  If you are interested in what debugging information looks like, run ' <code>objdump -W 6.out</code> ' and review the <code>.debug_*</code> sections. <br><br><h4>  Known Issues </h4><br><ol><li>  A beautiful display of strings works only for the type of the string, and not for the types inherited from it. </li><li>  Type information is missing for parts of the runtime library written in C. </li><li>  GDB does not understand the definition of Go names and treats <code>"fmt.Print"</code> as an unstructured literal with <code>"."</code>  which should be placed in quotes.  This is even more true of the <code>pkg.(*MyType).Meth</code> . </li><li>  All global variables are ranked in the <code>main</code> package. </li></ol></div><p>Source: <a href="https://habr.com/ru/post/179317/">https://habr.com/ru/post/179317/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../179299/index.html">The digest of interesting news and materials from the world of IT and web development for the last week No. 56 (May 4 - 10, 2013)</a></li>
<li><a href="../179303/index.html">In-app purchases - some statistics</a></li>
<li><a href="../179307/index.html">Learning experience in programming students</a></li>
<li><a href="../179309/index.html">The story of one garbage collection</a></li>
<li><a href="../179315/index.html">Microsoft and Adobe have released updates for their products.</a></li>
<li><a href="../179319/index.html">Analysis of "scam" on playing cards</a></li>
<li><a href="../179323/index.html">DLink DNS-325 - we connect cloud storages via WebDav</a></li>
<li><a href="../179327/index.html">Million articles in Russian Wikipedia!</a></li>
<li><a href="../179331/index.html">What has the IT industry learned from Linus Torvalds?</a></li>
<li><a href="../179333/index.html">Windows NT kernel developer explains reasons for poor OS performance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>