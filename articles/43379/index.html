<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Animation in MooTools. The basics and not only.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this topic, I'm going to put all my knowledge about animation in MooTools together and look at topics more in-depth than just examples of using plu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Animation in MooTools. The basics and not only.</h1><div class="post__text post__text-html js-mediator-article">  In this topic, I'm going to put all my knowledge about animation in MooTools together and look at topics more in-depth than just examples of using plugins.  The theoretical information is valid not only for MooTools, but also for other frameworks.  It will be interesting for beginners to familiarize themselves with the capabilities of the framework, and for those who continue - to understand how it all works :).  The article contains many examples, there are quite original ones, here are some of them: <a href="http://cray.net84.net/store/habrahabr/mootools/animation/caterpillar/">1</a> , <a href="http://cray.net84.net/store/habrahabr/mootools/animation/heart/">2</a> , <a href="http://cray.net84.net/store/habrahabr/mootools/animation/menu1/">3</a> .  Enjoy your reading. <br><a name="habracut"></a><br><h4>  Animation in MooTools. </h4><br><h5>  Basic principles.  Class Fx. </h5>  So today we will do the animation.  First you need to understand how the principles of animation are implemented in MooTools.  An animation in MooTools is a change in a property of an element over time (transition), for example, changing the CSS property left is horizontal movement, and background-color is a smooth change in fill color. <br><br>  MooTools uses the Fx class to create animated effects.  All classes that implement any animation are inherited from Fx.  In this class, helper methods for animation are defined: <br><ul><li>  <b>start</b> - this method starts the transition. </li><li>  <b>set</b> - changes the value of the parameter being animated.  Called at each transition step.  It is an abstract method, if it can be called that, i.e.  each implementation of an animated plugin must override set in its own way. </li><li>  <b>cancel</b> - cancels the current animation. </li><li>  <b>pause</b> - pauses the current animation. </li><li>  <b>resume</b> - resumes paused animation. </li></ul>  The constructor accepts the following options: <br><ul><li>  <b>fps</b> - the number of frames per second for animation.  It characterizes, if I may say so, the ‚Äúsmoothness‚Äù of the animation - the bigger it is, the ‚Äúsmoother‚Äù. </li><li>  <b>unit</b> - a unit of measurement, for example, "em", "px", "%".  Used to transform CSS properties. </li><li>  <b>link</b> is an option that characterizes the behavior of the animation when start was called during the transition.  It can take the following values ‚Äã‚Äã( <a href="http://cray.net84.net/store/habrahabr/mootools/animation/link/">an example with different link values</a> ): <ul><li>  <b>'ignore'</b> - all start calls during the animation are ignored.  Used by default. </li><li>  <b>'cancel'</b> - the current animation will be stopped and a new one will be started with the parameters that came to start. </li><li>  <b>'chain'</b> - all start calls during the animation will be added to the chain and their animation will begin immediately after the current one ends. </li></ul></li><li>  <b>duration</b> - the duration of the animation. </li><li>  <b>transition</b> is a <b>transition</b> equation.  The transition equations will be discussed in more detail below. </li></ul>  Fx works as follows.  The start and end values ‚Äã‚Äãof the variable parameter are transferred to the start method call, then the timer is started, which periodically (period is 1 / fps) calls the step method, where the value of the parameter to be animated is calculated at each animation step.  And it is calculated as follows: <br><ol><li>  The time elapsed from the start of the transition to the current moment is divided by the duration, thus we get a number from 0 to 1 characterizing the progress of the animation.  Let's call it progress. </li><li>  This number is passed to the transition function (which will be discussed below).  The result of calculating the transition function is called delta. </li><li>  The value of the parameter being animated is calculated as follows: param = (to - from) √ó delta + from, where from is the initial value of the parameter, and to is the final value of the parameter.  Obviously, when delta is equal to 0, we get the initial value of the parameter, and when 1 - the final value. </li></ol>  After calculating the parameter value, in the set method, the immediate visualization of the animation takes place (for example, changing the CSS property left). <br><br>  It should be emphasized that the Fx class itself is abstract, that is, it does not animate anything, it operates only with general data to implement the principles of animation.  Direct animation involved heirs Fx.  Basically, to animate elements on HTML pages, classes are used that animate various CSS properties of elements.  We will talk about these classes, and also consider the case of creating your own class, which implements the animation of non-CSS properties. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Transition Equations.  Writing your own equation. </h5>  Agree, the animation of moving an element on a page would not look very nice if it started abruptly and stopped abruptly at the end of the path.  This happens if the increment delta (which was mentioned above) remains constant throughout the entire time.  This is called a linear transition, its equation is delta = progress.  If we successively take several progress values ‚Äã‚Äãfrom 0 to 1 and substitute them into the equation, we obtain the usual straight line, which starts abruptly at 0 and ends abruptly at 1. <br><br>  I hope that from the previous paragraph it became clear that the transition equation is the law for calculating the increment delta.  Fortunately, in MooTools there is a whole set of such laws that will allow to make the animation smooth, sharp, fading, jumping, etc., but this will not be enough for us - we will also write our own equation.  But more about that later.  Now let's see what the standard equations are: <br><ul><li>  <b>Linear</b> - direct (delta = progress). </li><li>  <b>Quad</b> is a quadratic function (delta = progress <sup>2</sup> ). </li><li>  <b>Cubic</b> is a cubic function (delta = progress <sup>3</sup> ). </li><li>  <b>Quart</b> - delta = progress <sup>4</sup> . </li><li>  <b>Quint</b> - delta = progress <sup>5</sup> . </li><li>  <b>Pow</b> is the general power function delta = progress <sup>x</sup> (by default, the power is 6). </li><li>  <b>Expo</b> is an exponential function (delta = 2 <sup>(progress - 1) √ó 8</sup> ). </li><li>  <b>Circ</b> - quarter of a circle (delta = 1 - sin (acos (progress))). </li><li>  <b>Sine</b> - a piece of sinusoid (delta = 1 - sin ((1 - progress) √ó œÄ / 2)). </li><li>  <b>Back</b> - first delays the delta in the minus, and then smoothly brings to 1. </li><li>  <b>Bounce</b> - bouncing transition. </li><li>  <b>Elastic</b> - elastic transition (the only association - elastic :). </li></ul>  All these equations are available in the Fx.Transitions class.  They are used as the value of the transition option of the Fx constructor.  In addition to directly using these equations, you can also apply modifiers to them: <br><ul><li>  <b>easeIn</b> - is used by default and does not change anything. </li><li>  <b>easeOut</b> - calculates the delta value using the formula 1 - transition (1 - progress), thus expanding the transition curve. </li><li>  <b>easeInOut</b> - to the middle of the transition calculates delta by the formula transtition (2 √ó progress), and then - by (2 - transition (2 √ó progress)) / 2, combining two curves in one transition: straight and unfolded. </li></ul> For clarity, I present the curves of some of the most interesting equations. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dad/b29/b7d/dadb29b7d6f0dca246b9cf166b04968e.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/65a/93c/8fe/65a93c8fe5d7e9c497e2485c8557374f.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/8de/816/7ef/8de8167ef0a2dc8283f6d746761f555b.gif" width="227" height="254"><br><br>  And here is the same jumping animation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/425/b84/cf9/425b84cf9273c687c2f0e80adf1e7d65.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/65b/b11/37d/65bb1137ddec089797e55c802359a024.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/e3b/3b6/79d/e3b3b679d6a08c3886942ee0139fff76.gif" width="227" height="254"><br><br>  Quarter circle. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1df/72d/4b9/1df72d4b92e936768c805fdc7c029604.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/7d0/50e/6a1/7d050e6a1ca87b59546cc56d8745b5da.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/22d/a94/859/22da94859e3e7555a224ece7c0a1791a.gif" width="227" height="254"><br><br>  Elastic. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5d2/92b/db3/5d292bdb3ca9ee5143343d3026f60f7a.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/7d3/0dc/df4/7d30dcdf48b06c794112e8df3c503c2a.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/a8f/10b/a38/a8f10ba3832cd72a39f7221c3455a558.gif" width="227" height="254"><br><br>  Exponential function. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/deb/0e9/6ff/deb0e96ff4bfb978d00173c468830f69.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/083/518/ac6/083518ac60549f1b47b58c89ae920e00.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/2c9/1d3/2f0/2c91d32f00e176408431af471cba6f98.gif" width="227" height="254"><br><br>  Fifth degree <br><br><img src="https://habrastorage.org/getpro/habr/post_images/12e/53e/e95/12e53ee9544612b090a4f0d8c5db5c9b.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/486/e10/125/486e10125abef574ffde2ad50ab358b5.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/09b/ddc/598/09bddc598608ed3336621e773604445e.gif" width="227" height="254"><br><br>  A piece of sinusoid. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/64f/d5a/117/64fd5a117a8b47484de901e3ca2c95c2.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/0a7/bc0/341/0a7bc034170f808a45bfc68d6ef48c4e.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/8a7/fe9/d1e/8a7fe9d1e0c1ff45748ee499efd82f4d.gif" width="227" height="254"><br><br>  An example showing the use of various equations of transitions in the animation look <a href="http://cray.net84.net/store/habrahabr/mootools/animation/transitions/">here</a> . <br><br>  And what if among the whole variety of embedded equations there is no need?  No problem, you can always write your own, what we now do.  Ideally, the equation should be such that, for an argument equal to zero, it returns 0, and for a unit it is 1. In this case, there will be no jumps of the parameter to be animated at the beginning and at the end of the animation. <br><br>  As an example, I wanted to write an equation imitating oscillations on an electrocardiogram.  Of course, it would be possible to remove points from someone's cardiogram and interpolate them into a polynomial, for example (for this, I even wrote a prog in the third year of study :), but this would not be so accurate and resource-intensive (on large orders) for final use.  Therefore, the function turned out to be complicated.  The entire conventional domain of definition (from 0 to 1) is divided into intervals, each of which has its own small function.  The result was the following: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0d3/907/56a/0d390756a08a432b5fc2ff3628610120.gif" width="193" height="176"><br><br>  As you can see, on the first interval a ‚Äúquadro-function‚Äù is defined for a smooth rise from zero, then a set of straight lines with different inclinations and lengths, and at the end a quarter of a circle for a smooth lift to unity.  Here is what it looks like in the form of curves: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8d3/3f6/8e8/8d33f68e8f54fa5987dead2130f0ba5a.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/38c/e3c/1a1/38ce3c1a176e342ff5e7d7e31c01ba8a.gif" width="227" height="254"><img src="https://habrastorage.org/getpro/habr/post_images/3da/f78/aa3/3daf78aa3b421d6542c90cf56695b201.gif" width="227" height="254"><br><br>  Add this function to the Fx.Transitions object as follows: <br><br><blockquote><code><font color="black">Fx.Transitions.extend({ <br> Heartbeat: <font color="#0000ff">function</font> (x){ <br> <font color="#0000ff">if</font> (x &lt; 0.3) <br> <font color="#0000ff">return</font> Math.pow(x, 4) * 49.4; <br> <br> <font color="#0000ff">if</font> (x &lt; 0.4) <br> <font color="#0000ff">return</font> 9 * x - 2.3; <br> <br> <font color="#0000ff">if</font> (x &lt; 0.5) <br> <font color="#0000ff">return</font> -13 * x + 6.5; <br> <br> <font color="#0000ff">if</font> (x &lt; 0.6) <br> <font color="#0000ff">return</font> 4 * x - 2; <br> <br> <font color="#0000ff">if</font> (x &lt; 0.7) <br> <font color="#0000ff">return</font> 0.4; <br> <br> <font color="#0000ff">if</font> (x &lt; 0.75) <br> <font color="#0000ff">return</font> 4 * x - 2.4; <br> <br> <font color="#0000ff">if</font> (x &lt; 0.8) <br> <font color="#0000ff">return</font> -4 * x + 3.6; <br> <br> <font color="#0000ff">if</font> (x &gt;= 0.8) <br> <font color="#0000ff">return</font> 1 - Math.sin(Math.acos(x)); <br> } <br> });</font></code> </blockquote> <br>  Now you can use it by passing the transition option as an option (note: the example uses the Fx.Morph plugin, which will be discussed below, but for now it can simply be considered a successor of Fx, which understands all options in the designer that Fx understands): <br><br><blockquote> <code><font color="black"><font color="#0000ff">var</font> fx = <font color="#0000ff">new</font> Fx.Morph($( <font color="#A31515">'Heart'</font> ), { transition: Fx.Transitions.Heartbeat, duration: 900, link: <font color="#A31515">'chain'</font> }); <br> <br> <font color="#008000">//   10 .</font> <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0; i &lt; 10; i++){ <br> <font color="#008000">//  .</font> <br> fx.start({ <br> <font color="#A31515">'width'</font> : 265, <br> <font color="#A31515">'height'</font> : 238, <br> <font color="#A31515">'margin-left'</font> : -20, <br> <font color="#A31515">'margin-top'</font> : -20 <br> }); <br> <br> <font color="#008000">//  .</font> <br> fx.start({ <br> <font color="#A31515">'width'</font> : 225, <br> <font color="#A31515">'height'</font> : 198, <br> <font color="#A31515">'margin-left'</font> : 0, <br> <font color="#A31515">'margin-top'</font> : 0 <br> }); <br> } <br></font></code> </blockquote><br>  There is only one element in the HTML code: <br><br><blockquote> <code>&lt;img id="Heart" src="./images/heart.png" /&gt; <br></code> </blockquote><br>  A living example lies <a href="http://cray.net84.net/store/habrahabr/mootools/animation/heart/">here</a> .  An interesting effect: during the testing of the script, I listened to Drum'n'Bass and it seemed that the heartbeat of this heart was very in time with the music (try it yourself). <br><br>  Ok, we may not have achieved an ideal human cardiogram, but we have written our function.  As it turned out, it is not so difficult :). <br><br><h5>  Chains.  Coupling animation transformations. </h5>  It is often necessary to specify several consecutive transformations so that each of the following occurs after the end of the previous one.  If you simply call them sequentially, then by default every next call will be ignored (see the link option of the Fx class).  If you specify a link equal to 'chain', then all subsequent calls will be added to the chain and will be executed sequentially. <br><br>  However, there is a special syntax for creating chains.  They are implemented in the class of Chain.  It contains as many as three methods: <br><ul><li>  <b>chain</b> - appends the function to the end of the chain. </li><li>  <b>callChain</b> - calls the next function in the chain and removes it from the chain. </li><li>  <b>clearChain</b> - clears the chain. </li></ul>  Based on Chain, we will write a class that will be managed by a green caterpillar and will support call chains.  With the help of a call chain, we will make the caterpillar crawl along the eight. <br><br>  The caterpillar itself is a regular div, in which the CSS properties of the left, top, width and height change, creating the effect of movement (oh, yes, its color also changes for realism).  The caterpillar's pitch will consist of two stages: the first is the movement of its head to the right place, and the second is the pulling of the tail to the head.  The example uses Fx.Morph, which allows you to animate several CSS properties simultaneously, which will be discussed in more detail below. <br><br><blockquote> <code><font color="black"><font color="#0000ff">var</font> CaterpillarController = <font color="#0000ff">new</font> Class({ <br> <font color="#008000">//   Chain  .</font> <br> Implements: Chain, <br> <br> <font color="#008000">//     .</font> <br> largeSize: 200, <br> smallSize: 10, <br> <br> <font color="#008000">// .</font> <br> initialize: <font color="#0000ff">function</font> (caterpillar){ <br> <font color="#0000ff">this</font> .caterpillar = $(caterpillar); <br> <br> <font color="#008000">//      Fx.Morph     start.</font> <br> <font color="#0000ff">this</font> .fx = <font color="#0000ff">new</font> Fx.Morph( <font color="#0000ff">this</font> .caterpillar, { duration: 900, transition: Fx.Transitions.Expo.easeOut, link: <font color="#A31515">'chain'</font> }); <br> <br> <font color="#008000">//              .</font> <br> <font color="#0000ff">this</font> .fx.addEvent( <font color="#A31515">'chainComplete'</font> , <font color="#0000ff">this</font> .callChain.bind( <font color="#0000ff">this</font> )); <br> <br> <font color="#0000ff">return</font> <font color="#0000ff">this</font> ; <br> }, <br> <br> <font color="#008000">//       .</font> <br> <font color="#008000">//     (dimension:  ‚Äî true,  ‚Äî false)</font> <br> <font color="#008000">//   (direction:  ‚Äî true,  ‚Äî false).</font> <br> move: <font color="#0000ff">function</font> (dimension, direction){ <br> <font color="#0000ff">var</font> dimensions = <font color="#0000ff">this</font> .caterpillar.getCoordinates(); <br> <font color="#0000ff">var</font> options1, options2; <br> <br> <font color="#008000">//         .</font> <br> <font color="#0000ff">if</font> (dimension){ <br> <font color="#008000">//   .</font> <br> <font color="#0000ff">if</font> (direction){ <br> options1 = { <font color="#A31515">'width'</font> : dimensions.width + <font color="#0000ff">this</font> .largeSize }; <br> options2 = { <font color="#A31515">'left'</font> : dimensions.left + <font color="#0000ff">this</font> .largeSize, <font color="#A31515">'width'</font> : <font color="#0000ff">this</font> .smallSize }; <br> } <font color="#0000ff">else</font> { <br> options1 = { <font color="#A31515">'left'</font> : dimensions.left - <font color="#0000ff">this</font> .largeSize, <font color="#A31515">'width'</font> : <font color="#0000ff">this</font> .largeSize + <font color="#0000ff">this</font> .smallSize }; <br> options2 = { <font color="#A31515">'width'</font> : <font color="#0000ff">this</font> .smallSize }; <br> } <br> } <font color="#0000ff">else</font> { <br> <font color="#008000">//   .</font> <br> <font color="#0000ff">if</font> (direction){ <br> options1 = { <font color="#A31515">'height'</font> : dimensions.height + <font color="#0000ff">this</font> .largeSize }; <br> options2 = { <font color="#A31515">'top'</font> : dimensions.top + <font color="#0000ff">this</font> .largeSize, <font color="#A31515">'height'</font> : <font color="#0000ff">this</font> .smallSize }; <br> } <font color="#0000ff">else</font> { <br> options1 = { <font color="#A31515">'top'</font> : dimensions.top - <font color="#0000ff">this</font> .largeSize, <font color="#A31515">'height'</font> : <font color="#0000ff">this</font> .largeSize + <font color="#0000ff">this</font> .smallSize }; <br> options2 = { <font color="#A31515">'height'</font> : <font color="#0000ff">this</font> .smallSize }; <br> } <br> } <br> <br> <font color="#008000">//          (  ).</font> <br> $extend(options1, { <font color="#A31515">'background-color'</font> : <font color="#A31515">'#7CCB26'</font> }); <br> $extend(options2, { <font color="#A31515">'background-color'</font> : <font color="#A31515">'#4C9004'</font> }); <br> <br> <font color="#008000">//    </font> <br> <font color="#008000">// (     ,  link  'chain').</font> <br> <font color="#0000ff">this</font> .fx.start(options1); <br> <font color="#0000ff">this</font> .fx.start(options2); <br> <br> <font color="#0000ff">return</font> <font color="#0000ff">this</font> ; <br> } <br> }); <br> <br> window.addEvent( <font color="#A31515">'domready'</font> , <font color="#0000ff">function</font> (){ <br> <font color="#008000">//    move  .</font> <br> <font color="#0000ff">new</font> CaterpillarController( <font color="#A31515">'Caterpillar'</font> ).move( <font color="#0000ff">true</font> , <font color="#0000ff">true</font> ). <br> chain( <font color="#0000ff">function</font> () { <font color="#0000ff">this</font> .move( <font color="#0000ff">false</font> , <font color="#0000ff">true</font> ); }). <br> chain( <font color="#0000ff">function</font> () { <font color="#0000ff">this</font> .move( <font color="#0000ff">true</font> , <font color="#0000ff">false</font> ); }). <br> chain( <font color="#0000ff">function</font> () { <font color="#0000ff">this</font> .move( <font color="#0000ff">false</font> , <font color="#0000ff">true</font> ); }). <br> chain( <font color="#0000ff">function</font> () { <font color="#0000ff">this</font> .move( <font color="#0000ff">true</font> , <font color="#0000ff">true</font> ); }). <br> chain( <font color="#0000ff">function</font> () { <font color="#0000ff">this</font> .move( <font color="#0000ff">false</font> , <font color="#0000ff">false</font> ); }). <br> chain( <font color="#0000ff">function</font> () { <font color="#0000ff">this</font> .move( <font color="#0000ff">true</font> , <font color="#0000ff">false</font> ); }). <br> chain( <font color="#0000ff">function</font> () { <font color="#0000ff">this</font> .move( <font color="#0000ff">false</font> , <font color="#0000ff">false</font> ); }); <br> }); <br></font></code> </blockquote><br>  A living example is <a href="http://cray.net84.net/store/habrahabr/mootools/animation/caterpillar/">here</a> .  And <a href="http://cray.net84.net/store/habrahabr/mootools/animation/chasing.caterpillar/">here</a> is an example of nothing to do with chains, just a flight of fantasy, but cool. <br><br><h5>  Animate your own variables. </h5>  So far, we have used animations of various CSS properties.  But, as I pointed out at the beginning of the article, the Fx class can be used to animate anything.  Therefore, it would be nice to try to write your successor Fx.  We take as the basis the improved version of the rheostat script I wrote about in <a href="http://habrahabr.ru/blogs/mootools/41894/">this topic</a> .  What can be animated in it?  For example, the angle of rotation of the indicator.  Recall that if you make a single click on the rheostat, the indicator immediately appears in the place of pressing.  And what if you animate this transition?  It would be fun, and you need to write just a few lines :).  So, what you need to create a full-fledged successor to Fx: <br><ul><li>  add to the class description <b>Extends: Fx</b> for inheritance. </li><li>  pass options to the base constructor. </li><li>  override the <b>set</b> method to apply the value of the parameter to be animated to the parameter ‚Äúphysics‚Äù, in this case, turn the indicator by the angle value. </li><li>  call <b>start</b> to start the animation. </li></ul>  Set method code: <br><br><blockquote> <code><font color="black">set: <font color="#0000ff">function</font> (now){ <br> <font color="#008000">// now ‚Äî      .</font> <br> <font color="#0000ff">this</font> .oldMouseAngle = <font color="#0000ff">this</font> .mouseAngle = <font color="#0000ff">this</font> .angle = now; <br> <font color="#0000ff">this</font> .updateIndicatorPosition(); <br> } <br></font></code> </blockquote><br>  The method that responded to the mouse click instead of instantly changing the angle now calls the start method and sends the current value of the angle of rotation of the indicator and the value of the angle it should be rotated to after the end of the animation: <br><br><blockquote> <code><font color="black">captureMouse: <font color="#0000ff">function</font> (e){ <br> <font color="#0000ff">this</font> .captured = <font color="#0000ff">true</font> ; <br> <br> <font color="#0000ff">var</font> mouseAngle = <font color="#0000ff">this</font> .getMouseAngle(e); <br> <font color="#0000ff">if</font> ((mouseAngle &gt;= <font color="#0000ff">this</font> .options.minAngle) &amp;&amp; (mouseAngle &lt;= <font color="#0000ff">this</font> .options.maxAngle)) <br> <font color="#008000">//       .</font> <br> <font color="#0000ff">this</font> .start( <font color="#0000ff">this</font> .angle, mouseAngle); <br> } <br></font></code> </blockquote><br>  That's all, we have an animated transition, which can be seen <a href="http://cray.net84.net/store/habrahabr/mootools/animation/rheostat/">here</a> . <br><br><h4>  Standard animated plugins. </h4><br><h5>  Fx.Tween. </h5>  This class is the simplest class that animates any CSS property of an element.  To work, he needs a link to the element being animated, the name of the CSS property being animated, and a range of values.  Creation example: <br><br><blockquote> <code><font color="black"><font color="#0000ff">var</font> myFx = <font color="#0000ff">new</font> Fx.Tween(element, [, options]); <br></font></code> </blockquote><br>  An <a href="http://cray.net84.net/store/habrahabr/mootools/animation/transitions/">example</a> based <a href="http://cray.net84.net/store/habrahabr/mootools/animation/transitions/">on various transition equations is</a> based on this class: <br><br><blockquote> <code><font color="black"><font color="#008000">//     CSS- top     'Ball'.</font> <br> <font color="#0000ff">var</font> fx = <font color="#0000ff">new</font> Fx.Tween( <font color="#A31515">'Ball'</font> , { property: <font color="#A31515">'top'</font> , duration: 900, link: <font color="#A31515">'cancel'</font> }); <br> <font color="#0000ff">var</font> transitionSelect = $( <font color="#A31515">'Transition'</font> ); <br> <font color="#0000ff">var</font> modifierSelect = $( <font color="#A31515">'Modifier'</font> ); <br> <font color="#0000ff">var</font> test = $( <font color="#A31515">'Test'</font> ); <br> <br> <font color="#008000">//        .</font> <br> modifierSelect.addEvent( <font color="#A31515">'change'</font> , startAnimation); <br> transitionSelect.addEvent( <font color="#A31515">'change'</font> , startAnimation); <br> test.addEvent( <font color="#A31515">'click'</font> , startAnimation); <br> <br> <font color="#0000ff">function</font> startAnimation(){ <br> <font color="#008000">//      'sine:in'.</font> <br> fx.options.transition = transitionSelect.value + modifierSelect.value; <br> <br> <font color="#008000">//     .</font> <br> fx.start(60, 400); <br> } <br></font></code> </blockquote><br>  In the HTML code of the example, two drop-down lists, an animated ball and a button for every fireman. <br><br><h5>  Fx.Morph. </h5>  It is used more often than Fx.Tween because it can simultaneously animate several CSS properties of an element.  The constructor is almost the same as that of Fx.Tween, except for the absence of the property option, instead of it, an object describing which CSS properties to animate and in what ranges is passed to the start method.  For example: <br><br><blockquote> <code><font color="black">morph.start({ <br> <font color="#A31515">'margin-left'</font> : [0, 10], <br> <font color="#A31515">'background-color'</font> : [ <font color="#A31515">'#EEE'</font> , <font color="#A31515">'#555'</font> ] <br> }); <br></font></code> </blockquote><br>  means that two CSS properties will be animated: margin-left (from 0 to 10) and background-color (from '#EEE' to '# 555').  The ranges of values ‚Äã‚Äãcan not be specified, but only indicate the final value, then the current value specified in the element style will be taken as the initial value.  As an example, use Fx.Morph to create an animated menu: <br><br><blockquote> <code><font color="black"><font color="#0000ff">var</font> menuHeadItems = $$( <font color="#A31515">'#Menu .MenuHeadItem'</font> ); <br> <br> menuHeadItems.each( <font color="#0000ff">function</font> (item, i){ <br> <font color="#0000ff">var</font> morph = <font color="#0000ff">new</font> Fx.Morph(item, { duration: 900, transition: Fx.Transitions.Elastic.easeOut, link: <font color="#A31515">'cancel'</font> }); <br> <br> <font color="#008000">//          100i ms.</font> <br> <font color="#008000">//   : opacity  margin-left.    ""</font> <br> <font color="#008000">//       1.</font> <br> morph.start.delay(i * 100, morph, { <br> <font color="#A31515">'opacity'</font> : [0, 1], <br> <font color="#A31515">'margin-left'</font> : 0 <br> }); <br> <br> item.addEvents({ <br> <font color="#008000">//          .</font> <br> <font color="#A31515">'mouseenter'</font> : <font color="#0000ff">function</font> (){ <br> morph.start({ <br> <font color="#A31515">'margin-left'</font> : 8, <br> <font color="#A31515">'background-color'</font> : <font color="#A31515">'#DDD'</font> <br> }); <br> }, <br> <font color="#008000">//         .</font> <br> <font color="#A31515">'mouseleave'</font> : <font color="#0000ff">function</font> (){ <br> morph.start({ <br> <font color="#A31515">'margin-left'</font> : 0, <br> <font color="#A31515">'background-color'</font> : <font color="#A31515">'#EEE'</font> <br> }); <br> } <br> }); <br> }); <br></font></code> </blockquote><br>  And also you can <a href="http://cray.net84.net/store/habrahabr/mootools/animation/menu3/">see the</a> menu. <br>  <a href="http://demos111.mootools.net/Fx.Morph">The official example</a> . <br><br><h5>  Fx.Slide. </h5>  Quite a useful class when you need something from somewhere left or drove.  The constructor is very similar to all previous ones, so I will not dwell on it especially.  I can only say that he understands a few more options, the most important of which is the mode, which determines the direction of the ‚Äúexit‚Äù: vertical or horizontal.  On the basis of this class two more examples with animated menus are made: the <a href="http://cray.net84.net/store/habrahabr/mootools/animation/menu1/">first</a> and the <a href="http://cray.net84.net/store/habrahabr/mootools/animation/menu2/">second</a> . <br>  <a href="http://demos.mootools.net/Fx.Slide">The official example</a> . <br><br><h5>  Fx.Elements. </h5>  Allows you to conveniently animate any number of CSS properties for any number of elements at the same time.  An array of the elements over which the transformations will be performed is transferred to its constructor.  And the beauty is in the start method - an array of objects is transferred there for conversion.  It turns out that each element from the array passed to the constructor corresponds to an element object from the array passed to start.  Thus, mass animation of elements is carried out. <br><br>  In the example below, the transparency of the array of elements changes when the cursor hovers over them, and the closer the element is to what is currently under the cursor, the less its transparency, and the farther - the more: <br><br><blockquote> <code><font color="black"><font color="#0000ff">var</font> elements = $$( <font color="#A31515">'#ElementsContainer .Element'</font> ); <br> <font color="#0000ff">var</font> elementsFx = <font color="#0000ff">new</font> Fx.Elements(elements, { duration: 500, link: <font color="#A31515">'cancel'</font> }); <br> <br> elements.each( <font color="#0000ff">function</font> (element, i){ <br> <font color="#008000">//        .</font> <br> element.addEvent( <font color="#A31515">'mouseenter'</font> , <font color="#0000ff">function</font> (){ <br> <font color="#0000ff">var</font> arg = {}; <br> <br> <font color="#008000">//        </font> <br> <font color="#008000">//      .</font> <br> elements.each( <font color="#0000ff">function</font> (element, j){ <br> arg[j] = { opacity: 1 - Math.min(Math.abs(i - j), 5) / 8 }; <br> }); <br> <br> <font color="#008000">//   .</font> <br> elementsFx.start(arg); <br> }); <br> }); <br></font></code> </blockquote><br>  <a href="http://cray.net84.net/store/habrahabr/mootools/animation/elements/">Living example</a> . <br>  <a href="http://demos111.mootools.net/Fx.Elements">An interesting menu option from MooTools</a> . <br><br>  I hope that the readers were interested in digging deeper into the implementation of animation in MooTools.  Most of what is described here should be applicable to other frameworks. <br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/43379/">https://habr.com/ru/post/43379/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433730/index.html">Optimization of relational databases without downtime on the example of the most loaded database in Badoo</a></li>
<li><a href="../43375/index.html">Moving from ‚ÄúFake‚Äù Software to Free</a></li>
<li><a href="../43376/index.html">Announcements on PDC: Azure - a new platform "in the cloud", Oslo - a new approach to application development</a></li>
<li><a href="../43377/index.html">Basics of the basics: stocks</a></li>
<li><a href="../43378/index.html">Startup to find ideas for startups</a></li>
<li><a href="../433790/index.html">Advanced multi-stage build templates</a></li>
<li><a href="../433792/index.html">Shell scripts in Ansible</a></li>
<li><a href="../433796/index.html">How Homo Sapiens conquered the world. Communication and Negotiation Skills</a></li>
<li><a href="../433798/index.html">HomeKit and ioBroker Let's be friends houses</a></li>
<li><a href="../43380/index.html">Attention users as the universal value of the Internet, or support your favorite resources!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>