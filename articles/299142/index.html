<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Test shot: about the role of a / a tests in a / b testing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, suddenly there will be no presentation at all. The fact is that in the past I did a bit a / b testing and yesterday, once again I got on an art...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Test shot: about the role of a / a tests in a / b testing</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/1c8/4fe/84b/1c84fe84b40e412a910e8b5b9a28b000.jpg"><br><br>  Today, <i>suddenly there</i> will be no presentation at all.  The fact is that in the past I did a bit a / b testing and yesterday, once again I got on an article that says that before starting the experiments you need to do a / a test (that is, one where the control group sees the same version of the site As an experimental one), I decided that I could and should add my two pennies to this question.  It turns out non-core for my blog, but once you can, I guess.  Otherwise, it will break me, yes. <br><br>  Some of the most costly errors of a / b testing in the sense of lost lives were made when searching for a cure for scurvy.  After it <i>seemed that</i> it turned out that the lemons were helping her, the experiment was re-passed, and there, already in a clinical setting, the patients were treated with lemon juice concentrate.  And how in the eighteenth century, did you get the concentrate?  Of course, a long boil.  Well, you understand: the clinical verification of the previously obtained results is not confirmed.  But it was just necessary to be treated, as in the photograph to the post.  It is possible to hope that human life does not directly depend on errors in your system a / b testing, but one cannot assume that there are no errors in it.  And what is the connection of some of them with a / a tests. <br><a name="habracut"></a><br><h1>  What is bad control experiment? </h1><br><h2>  <font color="blue">Terminology digression</font> </h2><br>  I will sometimes call a / a test a <i>control experiment</i> or even just a <i>control</i> .  Also, in the case of a present a / b experiment, control is the collection of users who sees the production version (it‚Äôs a <i>control group</i> or <i>control sample</i> ), and not an experimental one.  I will try to make it clear from the context what exactly it is about, and the concepts of ‚Äúcontrol‚Äù and ‚Äúcontrol‚Äù are not confused. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Also, I will not be able to write every time ‚Äúthe experiment revealed a winner with a given statistical significance,‚Äù and I will use the words <i>triggered</i> or <i>shot</i> instead.  If not revealed, then, therefore, <i>did not work</i> . <br><br><h2>  <font color="blue">Actually, the claim</font> </h2><br>  Control before the start of real experiments is <b>insufficient</b> .  Why do people spend it?  To verify that none of the two identical system versions wins.  We are all sparrows, we know that we need statistical significance (we know, right?), And set its threshold in our tools, depending on the available users, at 0.95 (if we have dense hopeless poverty in terms of users), 0.99 ( this is a plus or minus normal case) or at 0.999 or more (if we are like Google or Yandex or have come up with a very good metric, which can be estimated with a small scatter). <br><br>  What do these numbers mean?  The threshold of statistical significance tells us only what proportion of mistakes we are prepared to make.  The number 0.95 means that we are ready to make the wrong decision in 0.05 cases, that is, an average of one time out of twenty, with 0.99 - this is one time out of a hundred, and so on.  That is, a certain fixed percentage of controls has the right to show the winner when the system is operating normally.  Attention, the rhetorical question: is it possible to check the normal operation of the system with one launch?  Of course not.  If a problem has crept into the implementation, then it is not at all necessary that all controls will reveal the winner (give the so-called false positive).  It is possible that there will simply not be one of the twenty, but two or three.  Or even one and a half. <br><br>  Is it possible to check the regular operation of the system by twenty control experiments for a case with a significance of 0.95?  How much do you think false positives out of twenty controls should be if the system is working correctly? <br><br>  The probabilities of getting a different number of triggers look like this (on the right there are also no zeros, they are simply not visible on this scale): <br><br><img src="https://habrastorage.org/files/cb6/95c/3ad/cb695c3ad40d47c9b1114de82a75271d.png"><br><br>  That is, the probability of getting one and not getting one is very close and great, two are also easy, although a little more difficult, three are suspicious, but it is possible, with four you can put money on the fact that the system works incorrectly, with five or more already put not money, but parts of the body on the fact that all the <b>hell raztak and razedak generally</b> broken <b>in the trash</b> . <br><br>  One should not be overjoyed if we have not received a single response.  In this case, it is impossible to exclude breakdowns in the opposite direction: we could have a system that never shows a winner at all.  This will have to be checked separately. <br><br>  Now let's imagine that out of twenty experiments we have five (that is, everything is <b>very</b> bad), and we only had one.  The chances that it will work are just 0.25 (5 out of 20).  That is, having conducted one control over such an incorrect system, we in three cases out of four will not even suspect anything. <br><br><h2>  <font color="blue">So what to do instead of the control experiment?</font> </h2><br>  Instead of one control experiment at the beginning, it is necessary to conduct such experiments constantly (ideally) or at least regularly and monitor the accumulated statistics.  If you make modifications, even the most innocuous ones, into the system of experiments, it makes sense to consider the statistics accumulated in the latest version separately.  If control experiments shoot more often than they are supposed to by a given level of significance, this is a strong signal that something is wrong. <br><br><h1>  How exactly this will help </h1><br>  Of course, constant control experiments are not a panacea, and with their help it is impossible to insure against all possible problems in general.  But quite a few things you will notice over time that I will show with examples below. <br><br><h2>  <font color="blue">Breakdown classification</font> </h2><br>  First of all, we note that an error in the system of experiments can hide in one of two places: <br><ol><li>  System run experiments.  Splitting users, determining what user to show, that's all. </li><li>  Calculate the results of experiments.  Calculation of metrics, implementation of stattest. </li></ol><br>  The error may lie in the implementation, and in the algorithm or the very concept of how you make decisions. <br><br>  Errors in calculating the results are a bit less traumatic: if you have user activity logs saved ( <i>logs? What other logs?</i> ), Then you can correct the error and recalculate all affected experiments with an afterthought to restore the picture.  Users, of course, will not understand what you decided to roll out to production on the incorrect results of experiments, but at least you can understand how bad it was.  If the launch system of experiments is broken, then everything gets worse.  In order to understand that you rolled out all these half a year, while it worked incorrectly, you need to recast all the affected experiments.  It is clear that for a dynamically developing website, restoring the version that was six months ago is fantastic, impossible in real life. <br><br>  For more convincing, I will cite one example of conceptual problems in conducting experiments and in the calculation system. <br><br><h2>  <font color="blue">Problem with splitting users</font> </h2><br>  If our project grows, we have more developers and designers, and at some point the throughput of the experiment system becomes a blocker for implementing the entire stream of <s>consciousness of</s> improvements that they generate.  One of the natural ideas for optimizing bandwidth is the division of all users into fixed-size buckets, so for each specific experiment a whole number of buckets is allocated (one, two, four, ...).  As soon as the experiment is completed, the buckets are returned to the system, and they can be immediately used for new experiments. <br><br>  This allows you to standardize the volume of the experiment within the company (if the improvement does not win the improvement on this fixed volume in a fixed time, it means that the change is not good enough), and also to avoid user downtime.  The benefit is about the same as from container shipping, it becomes very easy to run and track experiments. <br><br>  So, if we mistakenly show something really awful (idle buttons, broken layout or a very bad content aggregation algorithm) in an experiment to some bakery loser, and we notice this not right away, then users from such a bake will be unhappy for a long time, and their behavior will be different from the behavior of ordinary users who have not been tortured.  Comrades from Bing purposefully caught such a situation when, after a bad experiment, the freed bake was made a control group.  The number of sessions per user, which is the main metric there (this is really a good measure of user loyalty), was still very long in this unfortunate batch than in the other control: <br><br><img src="https://habrastorage.org/files/689/9cf/0c5/6899cf0c5b7c4c138a50dbbf87225ed9.png"><br>  <i>Picture from here: <u><a href="http://www.exp-platform.com/documents/puzzlingoutcomesincontrolledexperiments.pdf">www.exp-platform.com/documents/puzzlingoutcomesincontrolledexperiments.pdf</a></u></i> <br><br>  I want to separately note that the reality is much more dramatic than this picture: people break into buckets by hash code from cookies, and in three months a fairly significant percentage of users have been updated in the bucket, simply because of the swelling of the cookies.  That is, by the end of the third month, there are already quite a few <s>monkeys</s> in the bakery <s>, which have never been poured over by</s> users who have not been destructively affected, but the behavior of the others still shifts the average. <br><br>  My own experience confirms the existence of post-effects from the experiment. <br><br>  If you regularly carry out controls, then there is a chance to notice this problem and <b>fix</b> it.  No, the chance is not 100%: if some buckets are fixed under control forever, then it will not manifest there.  But still.  For fixing, for example, you can regularly mix users between bakes, adding to all user cookies (or what you use for hashing instead of cookies) the same modifier. <br><br><h2>  <font color="blue">The problem in the calculation of experiments</font> </h2><br>  In cases where we do not focus directly on the conversion (if we are not an online store, then this is normal), we need some kind of indicator, calculated from user actions.  Clicks, visits to the site, whatever.  The danger lies in gathering all the actions of all users in one big heap and counting the average value over it. <br><br>  The calculation of the statistical significance of the difference of the average values ‚Äã‚Äãobtained for a given metric in the control and experimental samples is based on the <a href="https://ru.wikipedia.org/wiki/%25D0%25A6%25D0%25B5%25D0%25BD%25D1%2582%25D1%2580%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2582%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0"><u>Central Limit Theorem</u></a> (hereinafter referred to as the CLT).  She tells us that the average has a normal distribution, which means that we can estimate confidence intervals well and make a verdict on whether the averages are different in the control and experimental groups. <br><br>  The catch here is that the PTC requires independence of averaged measurements. <br><div class="spoiler">  <b class="spoiler_title">On the fingers of the independence of events for those who forgot</b> <div class="spoiler_text">  Events are considered independent if the known outcome of one does not affect the likelihood of the other.  A vivid example of dependent events is the survival by the same person up to 80 and up to 90 years.  If we know that a person has lived to 90, then the probability to live to 80 is equal to 1. In the opposite direction, if a person did not live to 80, then he will not exactly live to 90 either.  Some outcomes of one event affect the probabilities of outcomes of the second.  In contrast, for two unfamiliar, unrelated people living to the same age - independent events.  Of course, everything in the world is interconnected, and for some pairs of such people there is still an addiction, but in practice it has to be neglected. </div></div><br><br>  So, the actions of the same user on our service in the general case <b>are not independent events</b> .  From examples close to me, suppose that a person consistently asks a search for something like this: <br><br>  <font color="brown">Kalashnikov machine Price</font> <font color="brown"><br></font>  <font color="brown">Kalashnikov automatic buy</font> <font color="brown"><br></font>  <font color="brown">Kalashnikov automatic buy</font> <font color="brown"><br></font>  <font color="brown">Kalashnikov assault rifle is not a layout to buy</font> <font color="brown"><br></font>  <font color="brown">hire a hit man</font> <br><br>  If, say, we consider the fact of a click on each request (abandonment rate, although it‚Äôs the day before the search, but let's say it took us for some reason), then even such a user, as in the example above, most likely will not click on the documents that came from the issuance of previous requests.  Well, or it will be less likely to click than if I had asked such a request directly.  And of course, he would not have asked him directly at all, if not for the previous results.  He will be especially upset by the fact that to say ‚Äúnot a mock-up‚Äù is a sure guarantee for getting a mock-up, but he does not understand this. <br><br>  I am sure that everyone who wants to come up with other metrics himself, for which not one, but several digits per average is taken from one user.  It is very easy to create a new metric and not to notice that it has a dependency element in it.  So, it happens that in such a situation, the controls start to operate <b>much</b> more often than they are supposed to by the chosen threshold of significance.  This undoubtedly means that a / b experiments often work randomly, and it is dangerous to make decisions based on their results. <br><br><h1>  I will sum up </h1><br>  Allocating the same amount of users for a constant a / a experiment (or for a few) as for a / b experiments that you are conducting is a good practice.  If you follow the accumulated statistics, it helps to notice <b>some</b> problems that arise in the system of conducting and calculating the results of user experiments.  Control experiments should not, on average, reveal a winner more often than they are supposed to by a given level of significance.  If you see that instead of one experiment out of twenty, two or three systematically work for you, this is a reason to think.  Such monitoring is not a panacea, so not everything that can break there can be seen, but it is definitely useful. </div><p>Source: <a href="https://habr.com/ru/post/299142/">https://habr.com/ru/post/299142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../299132/index.html">Alison Moore takes CRO's position at SoundCloud as part of the introduction of a paid subscription</a></li>
<li><a href="../299134/index.html">How Hotjar helps increase conversions (Service Overview and 3 Case Studies)</a></li>
<li><a href="../299136/index.html">Where myths about Agile</a></li>
<li><a href="../299138/index.html">Investments in virtual and augmented reality exceeded $ 1.1 billion in the first two months of 2016</a></li>
<li><a href="../299140/index.html">Lead4CRM: Now we pay for the information about our service.</a></li>
<li><a href="../299144/index.html">Where to go to learn to write good texts: Russian expert courses</a></li>
<li><a href="../299146/index.html">Find one caring person. Then everything is simple</a></li>
<li><a href="../299148/index.html">Using Google Analytics to search for user insights</a></li>
<li><a href="../299150/index.html">New versions of sites, services for their promotion ... Are you sure that this is all you need?</a></li>
<li><a href="../299152/index.html">Companies with websites! Remember customers!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>