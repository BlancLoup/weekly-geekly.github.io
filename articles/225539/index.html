<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How IPv6 helps routers break</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 I woke up today with the thought that a huge number of instructions for configuring NAT are advised to use a line like this: 


iptables -t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How IPv6 helps routers break</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/5d8/a04/29f/5d8a0429f0eacc5f507caf3e7e962a98.jpg" alt="image"><br><br><h4>  Foreword </h4><br>  I woke up today with the thought that a <a href="http://help.ubuntu.ru/wiki/sharing_internet">huge</a> <a href="http://kubuntu.ru/nat-iptables">number of</a> <a href="http://codeghar.wordpress.com/2012/05/02/ubuntu-12-04-ipv4-nat-gateway-and-dhcp-server/">instructions</a> for <a href="https://wiki.archlinux.org/index.php/Internet_sharing">configuring</a> NAT are advised to use a line like this: <br><pre><code class="hljs matlab">iptables -t nat -A POSTROUTING -o eth0 -<span class="hljs-built_in"><span class="hljs-built_in">j</span></span> MASQUERADE</code> </pre> <br>  Many understand the problems of this design, and advise adding: <br><pre> <code class="hljs matlab">iptables -A FORWARD -<span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ppp0 -o eth1 -m state --state ESTABLISHED,RELATED -<span class="hljs-built_in"><span class="hljs-built_in">j</span></span> ACCEPT</code> </pre> <br>  But, often, they forget to set the FORWARD table with the default DROP action, or add the REJECT rule to the end of the table. <br>  At first glance, it seems, everything seems normal.  However, this is not the case.  The fact is that if you do not prohibit the routing of traffic from a <b>WAN</b> port to a <b>WAN</b> port, someone from your <b>WAN</b> network (suppose that the provider drives the entire entrance into one / 24) can route traffic through you simply by setting your IP as a gateway.  All modern SOHO routers take this into account, but an inexperienced administrator who makes a router under normal linux may not know or forget about it.  There were no such routers in the subnet of my provider, and my plan to take over the world failed.  However, the article is not about that. <br><br><h4>  Magical colon </h4><br>  As you may know, many modern programs and services are bound to IP <b>::</b> (two colons), not <b>0.0.0.0</b> , as it was before.  IPv6 address <b>::</b> means the same as IPv4 <b>0.0.0.0</b> , i.e.  "We listen to all interfaces".  Many people believe that if a program listens on ::, then this socket can only accept IPv6 connections, but this is far from the case. <br>  In IPv6, there is a so-called mapping of IPv4 addresses to the IPv6 range.  If the program listens on the socket <b>::</b> and it is accessed from the IPv4 address <b>1.2.3.4</b> , then the program will receive a connection from the address <b>:: ffff: 1.2.3.4</b> .  This can be avoided by doing: <br><pre> <code class="hljs dos">sysctl -w <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.ipv6.bindv6only=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  But this is not always necessary, since  It is usually convenient that the program listens to one socket, and it can receive connections using two protocols at once.  In almost all distributions, IPv6 sockets behave this way, i.e.  bindv6only = 0. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  fe80 and his friend ff02 </h4><br>  If you are not stuck in the 90s, you are guaranteed to come across IPv6 without knowing it.  Absolutely all modern operating systems have IPv6 support enabled by default, which means that each (except for rare exceptions) interface is automatically assigned an IPv6 Link-Local address that starts with <b>fe80 ::</b> .  Moreover, in some cases, this address is obtained simply by encoding the MAC address. <br>  It would seem that finding Link-Local addresses should be problematic, they are still long and scary, but here we come to the aid of a multicast range <b>ff02 ::</b> . <br><br>  There is such a cool address: <b>ff02 :: 1</b> .  If you ping it (necessarily with the indication of the interface, because this is the Link Local address), then all the computers on the network will respond: <br><pre> <code class="hljs pgsql">% ping6 ff02::<span class="hljs-number"><span class="hljs-number">1</span></span>%enp4s0 PING ff02::<span class="hljs-number"><span class="hljs-number">1</span></span>%enp4s0(ff02::<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">56</span></span> data bytes <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::<span class="hljs-number"><span class="hljs-number">21</span></span>f:d0ff:fea2:<span class="hljs-number"><span class="hljs-number">46</span></span>a3: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.056</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::fe8b:<span class="hljs-number"><span class="hljs-number">97</span></span>ff:fe66:<span class="hljs-number"><span class="hljs-number">9100</span></span>: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.60</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::<span class="hljs-number"><span class="hljs-number">226</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>eff:fe6d:<span class="hljs-number"><span class="hljs-number">22</span></span>a0: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.62</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::f2de:f1ff:fe27:<span class="hljs-number"><span class="hljs-number">3685</span></span>: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">1.70</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::<span class="hljs-number"><span class="hljs-number">62</span></span>a4:<span class="hljs-number"><span class="hljs-number">4</span></span>cff:fe7b:<span class="hljs-number"><span class="hljs-number">1</span></span>c90: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">2.95</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::fac0:<span class="hljs-number"><span class="hljs-number">91</span></span>ff:fe32:<span class="hljs-number"><span class="hljs-number">5</span></span>bbe: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">3.02</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::<span class="hljs-number"><span class="hljs-number">226</span></span>:<span class="hljs-number"><span class="hljs-number">18</span></span>ff:fe9e:<span class="hljs-number"><span class="hljs-number">4</span></span>b3a: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">3.09</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::ba70:f4ff:fe8b:<span class="hljs-number"><span class="hljs-number">8</span></span>dda: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">3.14</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::<span class="hljs-number"><span class="hljs-number">62</span></span>a4:<span class="hljs-number"><span class="hljs-number">4</span></span>cff:fea2:aee0: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">3.27</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::<span class="hljs-number"><span class="hljs-number">224</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span>ff:fedb:d17d: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">3.93</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::<span class="hljs-number"><span class="hljs-number">2</span></span>a1:b0ff:fe40:<span class="hljs-number"><span class="hljs-number">904</span></span>: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">4.21</span></span> ms (DUP!) <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fe80::<span class="hljs-number"><span class="hljs-number">76</span></span>d0:<span class="hljs-number"><span class="hljs-number">2</span></span>bff:fe69:<span class="hljs-number"><span class="hljs-number">31</span></span>d8: icmp_seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">6.09</span></span> ms (DUP!)</code> </pre><br>  As we can see, 11 devices responded.  By the way, this address is very convenient to use if you, for example, have a server configured to receive an address via DHCP, and DHCP has dropped, or if you have directly connected to the server port, and you don‚Äôt want to raise DHCP.  You just have to go to fe80-address via ssh. <br><br>  If you <b>ping the</b> address <b>ff02 :: 2</b> , then all IPv6 routers on the network will respond.  Unfortunately, in my case there were none. <br><br><h4>  We scan routers </h4><br>  I decided to scan these addresses via nmap, and this is what happened: <br><pre> <code class="hljs swift">% nmap -<span class="hljs-number"><span class="hljs-number">6</span></span> -<span class="hljs-type"><span class="hljs-type">T4</span></span> --<span class="hljs-keyword"><span class="hljs-keyword">open</span></span> -n -iL list.txt</code> </pre> <div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs vhdl">Starting Nmap <span class="hljs-number"><span class="hljs-number">6.46</span></span> ( http://nmap.org ) at <span class="hljs-number"><span class="hljs-number">2014</span></span>-<span class="hljs-number"><span class="hljs-number">06</span></span>-<span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span>:<span class="hljs-number"><span class="hljs-number">53</span></span> MSK Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::f2de:f1ff:fe27:<span class="hljs-number"><span class="hljs-number">3685</span></span> Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.0014</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">999</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">53</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> domain Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::fe8b:<span class="hljs-number"><span class="hljs-number">97</span></span>ff:fe66:<span class="hljs-number"><span class="hljs-number">9100</span></span> Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.0012</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">998</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">53</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> domain <span class="hljs-number"><span class="hljs-number">80</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> http Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::<span class="hljs-number"><span class="hljs-number">226</span></span>:<span class="hljs-number"><span class="hljs-number">9</span></span>eff:fe6d:<span class="hljs-number"><span class="hljs-number">22</span></span>a0 Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.0012</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">998</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">53</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> domain <span class="hljs-number"><span class="hljs-number">80</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> http Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::<span class="hljs-number"><span class="hljs-number">62</span></span>a4:<span class="hljs-number"><span class="hljs-number">4</span></span>cff:fea2:aee0 Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.00099</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">999</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">23</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> telnet Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::<span class="hljs-number"><span class="hljs-number">226</span></span>:<span class="hljs-number"><span class="hljs-number">18</span></span>ff:fe9e:<span class="hljs-number"><span class="hljs-number">4</span></span>b3a Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.00094</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">999</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">23</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> telnet Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::<span class="hljs-number"><span class="hljs-number">62</span></span>a4:<span class="hljs-number"><span class="hljs-number">4</span></span>cff:fe7b:<span class="hljs-number"><span class="hljs-number">1</span></span>c90 Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.00085</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">999</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">23</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> telnet Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::<span class="hljs-number"><span class="hljs-number">76</span></span>d0:<span class="hljs-number"><span class="hljs-number">2</span></span>bff:fe69:<span class="hljs-number"><span class="hljs-number">31</span></span>d8 Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.00072</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">999</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">23</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> telnet Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::fac0:<span class="hljs-number"><span class="hljs-number">91</span></span>ff:fe32:<span class="hljs-number"><span class="hljs-number">5</span></span>bbe Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.00037</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">999</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">23</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> telnet Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::ba70:f4ff:fe8b:<span class="hljs-number"><span class="hljs-number">8</span></span>dda Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.00059</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">999</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">23</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> telnet Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::<span class="hljs-number"><span class="hljs-number">2</span></span>a1:b0ff:fe40:<span class="hljs-number"><span class="hljs-number">904</span></span> Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.00077</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">999</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">23</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> telnet Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fe80::<span class="hljs-number"><span class="hljs-number">224</span></span>:<span class="hljs-number"><span class="hljs-number">54</span></span>ff:fedb:d17d Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.0012</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">999</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">23</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> telnet Nmap done: <span class="hljs-number"><span class="hljs-number">11</span></span> IP addresses (<span class="hljs-number"><span class="hljs-number">11</span></span> hosts up) scanned <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">4.04</span></span> seconds</code> </pre> </div></div><br>  For IPv4, all these ports are closed. <br>  As we can see, many routers have Telnet, a web interface and DNS from outside on IPv6. <br>  What does this mean?  It's simple - the developers of the router firmware simply forgot IPv6. <br><br>  Open telnet routers: <br><ul><li>  ASUS RT-N10 (2.0.3.2) </li><li>  ASUS RT-G32 </li><li>  ASUS RT-G32.C1 (2.0.2.6) </li><li>  Upvel UR-312N4G </li></ul><br>  Open web routers: <br><ul><li>  D-Link DIR-615 (E4, 5.11NV) </li><li>  D-Link DIR-615 (E4, 5.11RU) </li></ul><br><br>  Many of them had standard admin / admin passwords. <br>  On most of these routers, ip6tables (iptables for IPv6) was simply missing.  The developers had to either disable the IPv6 support in the kernel altogether, or make sure that the http and telnet demons are listening to <b>0.0.0.0</b> , but not <b>::</b> but, for some reason, they did not do that. <br><br><h4>  What if‚Ä¶? </h4><br>  If IPv6 was somehow configured on the router, and, accordingly, IPv6 packet routing was enabled (net.ipv6.conf.all.forwarding = 1), and ip6tables was either not configured at all or configured incorrectly, then just as in the case of IPv4, route packets through this router. <br><br><h4>  Conclusion </h4><br>  I have already sent emails to some companies about these vulnerabilities, but I have not had time to some.  In any case, the letters will be sent to all. <br>  Use IPv6, do not forget about it. <br><br><h4>  PS </h4><br>  For me it was a surprise that browsers do not know how to open addresses with an indication of the interface.  I didn‚Äôt manage to open the link like http: // [fe80 :: a: b: c: d% enp4s0] in all browsers.  They say that the percent sign needs to be escaped, i.e.  http: // [fe80 :: a: b: c: d% 25enp4s0], but it didn't work out for me.  I had to use port forwarding. </div><p>Source: <a href="https://habr.com/ru/post/225539/">https://habr.com/ru/post/225539/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225529/index.html">ROADAR Personal</a></li>
<li><a href="../225531/index.html">We assemble a laser projector from the parts available</a></li>
<li><a href="../225533/index.html">Samsung Introduces New 845DC EVO SSD Series</a></li>
<li><a href="../225535/index.html">Released record long-term software, created 54 years</a></li>
<li><a href="../225537/index.html">DevConf :: Mobi - as early as next week on June 14, a section program was formed</a></li>
<li><a href="../225543/index.html">How to develop secure applications for Android. Yandex Workshop</a></li>
<li><a href="../225547/index.html">Record video from Google Street View</a></li>
<li><a href="../225549/index.html">On bang to Jupiter</a></li>
<li><a href="../225551/index.html">Updated HTTP / 1.1</a></li>
<li><a href="../225553/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ112 (June 1 - 7, 2014)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>