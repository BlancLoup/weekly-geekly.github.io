<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Visualization of data in the browser using D3.js</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mikhail Dunaev ( war_hol ) 
 We encounter data visualization and various charts every day, these are some Google Analitics, Internet banks, this is Ex...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Visualization of data in the browser using D3.js</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/59a/20f/f33/59a20ff338c07ad706e0e949fd26ebbc.jpg"><br><br><h2>  Mikhail Dunaev ( <a href="https://habrahabr.ru/users/war_hol/" class="user_link">war_hol</a> ) </h2><br>  We encounter data visualization and various charts every day, these are some Google Analitics, Internet banks, this is Excel, etc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d7d/c44/7bf/d7dc447bfc5f7e378fffb0a7915f3ce9.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In fact, charts haunt humanity throughout our history.  One of the first data visualizations is the 10th century AD.  The unknown astronomer depicted the motion of celestial bodies using diagrams: <br><a name="habracut"></a><br><br><img src="https://habrastorage.org/getpro/habr/post_images/951/ed8/f22/951ed8f22e165ec10d8a16eac1643110.png"><br><br>  The following interesting work is the movement of sunspots through the sun, the 17th century: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a6/fc5/532/0a6fc5532847bdc0f7320969f8397e8f.png"><br><br>  There is already visible some timeline, it appears from the birth of infographics. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/151274858" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Following.  In the 18th century, such devices appeared that allowed the creation of a mechanical timeline, i.e.  scrolling the handles left and right, you can turn the scroll to the left and right side, and watch, learning the story from this document.  Such an alternative to the book: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a2/1d3/52c/5a21d352cf48e72d7a22242e3110f5ef.png"><br><br>  At the same time, such a beautiful instance of data visualization appears: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/903/d4b/50d/903d4b50d17c7ae15d75178c3ee749a8.png"><br><br>  This is the story of human empires.  Also timeline, the first quality color timeline, which appeared in humans. <br><br>  And this is the most famous historical infographics: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ea/15b/64a/4ea15b64a8bd94679eb5593348201f52.png"><br><br>  It shows the movement of Napoleon's troops from France to Moscow and back.  Accordingly, the beige color is the movement to Moscow, the black color is the movement back.  The thickness of the lines shows the number of troops at Napoleon.  Marked specifically the river and we can see how when crossing the river Napoleon lost part of his troops.  This kind of data presentation, which allows us to visually "see" the story. <br><br>  This is our time: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f3f/f48/bd1/f3ff48bd166aab41378a7f1c09ef2159.png"><br><br>  This is a visualization that shows the places of birth and death of culture carriers - the place where the person was born, the red color where he died is marked in blue.  This guys have gathered all the historical some important figures for culture, scientists, artists.  And it is clear that the process of urbanization took place during the entire existence of humanity, i.e.  from the earliest times, people-bearers of culture sought in cultural centers, and with all this were born on the outskirts.  Those.  how now from all over Russia people are going to Moscow.  It did not start now, it was always. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a90/4ec/538/a904ec5387f531c4675f0dac7e527f1a.png"><br><br>  Unfortunately, with all the development of modern technologies and the development of infographics, most of the population of our planet uses standard graphics from EXCEL, and no one goes any further. <br><br>  Actually, there are much more graphs, there is such a beautiful diagram that shows which graph you need to choose, depending on your data, i.e.  if you need to show the relationship, distribution, comparison, composition: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0e6/335/11c/0e633511c87549a6f3d8ed3549b2b90a.png"><br><br>  Here is a good example of how you can beautifully present a classic schedule: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d29/34e/f13/d2934ef13c14fee5621ad6c12f5afd89.png"><br><br>  This is no longer Excel.  This is the number of deaths in the war in Iraq - the New York Times shows bar charts with such bruises.  First, it is beautiful, and secondly, it is immediately obvious how many and when people died. <br><br>  In the same way, my former colleagues from the RIA Novosti infographic studio have depicted something here: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a02/65f/62b/a0265f62b36482014e6c7b47e3c6305b.png"><br><br>  It can be seen how beautiful it is.  Those.  if we are not limited to graphs from Excel, then we immediately start to get beautiful and fashionable. <br><br>  Another good example: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bbf/76e/342/bbf76e3422ae46ef39af6483b355f61d.png"><br><br>  This is Florence Nightingale, the founder of the medical movement in the XIX century, depicted the causes of death in the British army.  You see, the XIX century, and already what a beautiful graphics. <br><br>  And this is already our time, the number and popularity of online games: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2d1/961/dd0/2d1961dd0ec8fa181d58a845248c5bb3.png"><br><br>  And my favorite example is my hard drive: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f36/533/043/f36533043e0716bfb6878f8d8adc993d.png"><br><br>  This kind of graph is called treemap.  There is a program for Mac OS and Windows, which shows us the area of ‚Äã‚Äãeach rectangle - the file size.  These are all files on my hard drive.  It can be seen that green is a serial game that I watch, red is the Applications folder, blue is the swap files ... When you see your hard disk in this form, you can immediately understand where your place has gone, which file takes up a lot of space - very convenient and intuitive. <br><br>  This is about how to submit data, and why it is needed.  However, when interactive appears, interactive on the web, the whole thing changes.  The number of graphs and charts has increased dramatically, and they are not amenable to any classification. <br><br>  Here is a good example on D3, several types of diagrams are combined in it at once, and the result is, of course, fantastic: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/271/d63/9de/271d639dee581645187ddb55076993c2.png"><br><br>  In fact, infographics and data visualization for the web has a very short history.  It all started in the 90s with the program "Macromedia Director". <br><br><img src="https://habrastorage.org/getpro/habr/post_images/891/cca/05b/891cca05bc0523481822b49cad467714.png"><br><br>  This is a precursor of the flash, the first some types of data visualization for the web began to appear on it.  Naturally, after the Macromedia Director came to the aid of the Adobe Flash Platform, it was beautiful.  In fact, to visualize data, to cost graphics on a flash, not to invent a better tool. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d1/bfe/859/9d1bfe85933b37c4d172a9b1703016b5.png"><br><br>  RIA Novosti used flash as the main tool for infographics.  Two years ago, they completely abandoned the flash, and until that time they had used it because it was convenient. <br><br>  Naturally, these three guys replaced - html, javascript, css: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f76/10f/54c/f7610f54ca7a62bdfc592bf6d892b366.png"><br><br>  And we brought svg and WebGL, which allowed us to do almost all of the same things under the web as we could on flash. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f84/df8/b38/f84df8b384c9eb42a48c779e4909968b.png"><br><br>  Much allows us to do D3.  In the network, you can find examples of how it works online - everything works quickly (this is a vector), beautifully and without any brakes.  D3 is one of the best libraries currently available for data visualization.  We can see a screenshot from Github: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fd4/fd8/b2f/fd4fd8b2f786e14a42e3ed34d46bb867.png"><br><br>  This library began its development in the 2010th year, it has been dynamically developing for the last five years, but not so much lately, but this is most likely due to the fact that the course has settled down and there are not so many new features to come up with .  We can see that 37 thousand asterisks and almost 10 thousand forks indicate that the library is really good.  It is in the top 20 of the most popular JavaScript libraries for Github. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/527/d43/c45/527d43c45c33b61967f6f02956174345.png"><br><br>  Here is a good example.  Using the D3 library directly in our time.  The New York Times is not important what they show, but how they show it: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/034/4a2/ebb/0344a2ebb67b6a0af29507b81aac9e7c.png"><br><br>  Here, the data-driving approach is very visible - each DOM element stores in itself some element, part of the data, and every time we choose a particular display method, we simply say how we need to display this data.  This data is stored in the element, and you can see how D3 beautifully makes the animation, how it all works qualitatively, quickly and, most importantly, there are no problems in production. <br><br>  Here is also a good example, also D3: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d7d/f10/a81/d7df10a81aa61706542435db5e6cd4e1.png"><br><br>  This is a visualization of the temperature in the United States in different years.  It can be seen that the months are changing, fixated, and you can clearly see clearly what year was the drought, what year there was a lot of rain.  Firstly, it‚Äôs really beautiful, you can just look at it for a long time, stick it, and it works, and it works well. <br><br>  Or a third example: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/46b/522/123/46b522123f63c94297abf23d6e46ffbc.png"><br><br>  This is "Tokyo Wind Speed".  You can find and watch right now in real time - the wind speed in Tokyo is being visualized.  Very beautiful, every time you can see where, how, why ... Very popular service.  We Gismeteo do not know whether it will soon come to such a conclusion. <br><br>  Or here is another example: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c82/1f8/8fe/c821f88fe784e852dab621227f2d1c52.png"><br><br>  This is also the New York Times.  A visualization that is controlled by a scroll, i.e.  at the moment when I was shooting this video, I scrolled with the mouse.  The page is static, but the graphics are changing - everything is clear, beautiful and fast.  This is a way that allows us to get away from stupid Excel-plates, from ordinary graphs and make some kind of project that has a great ‚Äúwow‚Äù effect - the effect when the user looks and thinks: ‚ÄúWow, how cool it is!‚Äù. <br><br>  What do we have in Russia?  In Russia, everything is also quite good. <br><br>  I'll tell you about a few of my projects, and how they are going.  We start the project each time approximately from the following Excel file: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/38d/6dd/1c5/38d6dd1c51ddd5da49052ce89c220b88.png"><br><br>  The editor gives some data, and together with the editor we start to decide what we want to do with this data. <br><br>  What is this data?  This is the population of Russia in different years, which is divided by age, i.e.  Y axis - different years, X axis - age.  Accordingly, at the intersection - how many people of a certain age lived in Russia in different years.  Ultimately, we want to get a chart where the age will be shown along the X axis, and the population along the Y axis. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/285/eb3/2d0/285eb32d03739f57edce650c583263c0.png"><br><br>  In different colors we will "paint" the male and female population.  Already, even on a static slide, not on an interactive one, we can make out a story.  The main thing why doing data visualization is to show people a story that they cannot see in Excel spreadsheets.  Here we already see such a thing as an ‚Äúecho of war‚Äù: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c7/d71/6b1/9c7d716b1c9a5592a7ab9b0401e18749.png"><br><br>  See this failure?  These are children who were not born during the Second World War and, accordingly, the baby boom are children who were born after the Second World War. <br><br>  Also on this chart we have marked the age of the working population, i.e.  from 16 to 55-60 years, and calculated how much per one pensioner is the working population: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26b/8bb/c0d/26b8bbc0d534e95ae3f1f1be54ac737c.png"><br><br>  These are actually very important numbers.  I'll show why they are. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/65b/ac4/a7d/65bac4a7dcac35171e61cc6f30a0a679.png"><br><br>  We see that in 1990, there were three working people per pensioner.  We also added a timeline that you can drag left and right to change the year: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f4/da3/313/5f4da3313e25064fa82324ca58a48f71.png"><br><br>  It works like this: we click on the ‚ÄúPlay‚Äù button, and the years begin to change, D3 animates our schedules.  We see how ‚ÄúEcho of War‚Äù is crawling, retiring, and that we now have about three working people per pensioner.  But what happens behind this?  Behind this, there is such an interesting thing: children who were born during a baby boom, retire and the number of pensioners in Russia increases dramatically, and the number of people working for people per pensioner drops sharply.  In fact, we have such a situation in the country that every working person receives a salary for himself and for one pensioner.  Do you understand that it turns out that in 2025 there will be less than two people per pensioner, and this will be a real pension crisis? <br><br>  This is the kind of thing that shows us how history can be obtained from the data.  For journalism, this is very important. <br><br>  And at first it was just a ‚Äúmess‚Äù of numbers: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fab/f90/a97/fabf90a97bd473b69e9bb84459b1c650.png"><br><br>  Next project  We in the open sources found information about the deputies of the State Duma: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eec/35c/1b7/eec35c1b72908886a5dafaf74c672abd.png"><br><br>  All deputies of the State Duma of all six convocations.  We see the name, surname of the deputy, party affiliation and years - when he came to the State Duma and when he left the State Duma. <br><br>  What can we do with this data?  We will try to visualize them.  First of all, we will take the first convocation, ‚Äúpaint‚Äù all the deputies in the color corresponding to their party affiliation, and build from a smaller party to a larger one: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2eb/e74/cc1/2ebe74cc13d81216df20b3173944cbe2.png"><br><br>  Already beautiful, but something is not right, there is no history.  Let's go further.  We visualize all six convocations: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/648/cb9/b29/648cb9b2967bf6174daec0f4c674331b.png"><br><br>  It's easy enough to do.  Six convocations of the State Duma.  We see how United Russia appeared, and how the Communist Party of the Russian Federation is losing its positions because of this. <br><br>  It is also very interesting, but there is no history of anything.  Let's add a story. <br><br>  We know that the deputies passed from one convocation to another.  Let's draw lines if the deputy has moved from the I-st ‚Äã‚Äãconvocation, for example, to the II-nd, and it turns out we have such a diagram, it is already beautiful: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/653/6c2/2cd/6536c22cd8d1c2047e5e69e217a544e3.png"><br><br>  We see how the deputies passed from convocation to convocation, that, indeed, each convocation is not some new deputies, these are old deputies from previous convocations. <br><br>  Let's add a bit of interactive to this scheme, and we get such a thing, when we can select individual parties, we can poke each deputy, and we can trace the history of some deputy.  The history of the Communist Party, for example, see how people moved from one party to another.  We will be able to see people who have missed some convocations - their line bypasses a particular convocation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/97c/a78/baf/97ca78bafcf25f5c06f8bea7b44cd6a4.png"><br><br>  Already very interesting, the user can go to the site, poke ... It works, this is a vector, it is svg, it works well even on slow browsers.  In fact, we initially wanted to make png-substrates, render them on a fast browser, and then, when I saw how well it works raw in svg, we decided to leave it that way, and I do not regret it at all. <br><br>  What stories can we find here?  Here we can find deputies who were in all six convocations, i.e.  people "with history." <br><br><img src="https://habrastorage.org/getpro/habr/post_images/468/542/dbf/468542dbf96713225c974fbc9a40e46c.png"><br><br>  And we can see that most of these deputies from the Communist Party.  The Communist Party of the Russian Federation "keeps" its people, does not let them go anywhere, because, probably, there are no new ones. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/303/97b/146/30397b146a7f420552df4a1c23ac50c5.png"><br><br>  In the same way, we can single out all the deputies who missed some convocations.  Also interesting, but it is not clear why. <br><br>  But my favorite slide is the deputies who changed their political affiliation four or more times: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ee/d3a/89c/8eed3a89cf0497b9286f940e15308d22.png"><br><br>  These are people who are in the State Duma not for political reasons, but for some other reason.  Because a person cannot change his political convictions four times.  Although, who knows ... <br><br>  More examples can be found on the Mike Bostock website (this is the author of the D3 library): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f3/ba7/09c/6f3ba709caf3e8d7d378b2fb15ab1133.png"><br><br>  I must say that Mike Bostock is a big fan of examples, he collects them in huge numbers, and you scroll through the page with examples, but they don‚Äôt end or end.  I never screwed it up to the "bottom", because there are so many of them ... And there are examples for every day.  Examples with code, and everything is well written, i.e.  You can find everything you need. <br><br>  So, a little code. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c4d/748/2a9/c4d7482a9e40ca4cc5dc6f3c50f7c34d.png"><br><br>  D3 library - like any other library for working with DOM elements.  It all starts with selectors.  Selectors work d3.select (‚Äúdiv‚Äù) or d3.selectAll (‚Äúdiv‚Äù).  You can select only the first element, or all.  Used by the W3C API selector, or Sizzle. <br><br>  Sizzle is an engine selector that uses jQuery, i.e.  if you have jQuery connected in parallel, then the selectors will work faster, or you can simply connect Sizzle separately. <br><br>  Just like in D3, Chaining works, you can call methods in turn. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27a/d6d/d3b/27ad6dd3b985724c6a71d3d15feec2cb.png"><br><br>  Let's do some kind of project, see how it is done, from beginning to end.  Let's return to my beloved deputies.  Why do I love deputies so much?  Not because I am a politically active dude, the State Duma in Russia is just an excellent source of data, because all the data about the deputies are open, and we can find out about each deputy on the State Duma‚Äôs website, his name, party affiliation, salary , real estate in Russia, his wife‚Äôs salary and real estate, cars ‚Äî his and his wife ... We can learn about each deputy up and down. <br><br>  As an example, we can find out the number of speeches of a deputy, the number of bills that this deputy brought to the State Duma.  Very good example: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/411/24d/49c/41124d49c330a98a1d8efab46d7d876c.png"><br><br>  Let's make such an assumption that the more a deputy earns, the less he acts.  And check whether this is true or not. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dad/770/97c/dad77097c425092c2bbb3c33d0e78a8c.png"><br><br>  We will add to our svg in this way each deputy.  Each deputy will be displayed using the square.  Let's paint each deputy in the color of his party.  Imagine that we rassparsili State Duma website. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c85/0d9/c26/c850d9c262fc80f6de0b8ff413b6031f.png"><br><br>  Now I just hammered in hands, the first three deputies, we in Json kept his name, his salary, the number of speeches and party affiliation.  For now, we don't need anything else. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3fb/25a/0d3/3fb25a0d3d6b8eb0cc14c0c8ba8744c3.png"><br><br>  D3 connects like a regular library. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/08d/d32/c64/08dd32c64d0d3f53a9b138f2577bc5fb.png"><br><br>  The first thing we do - we need to download this data.  Anyone who is familiar with jQuery, everything is clear.  d3.json ('datajson) and callback, which handles the error and returns the Json object to work. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/92a/10c/bd7/92a10cbd70a6de0e1c69dea629044a05.png"><br><br>  The next thing we need to create is svg in our DOM tree, we write d3.select ('body'), append ('svg'), nothing new. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/438/ef2/015/438ef2015cbea32cbb8da13bb1da26cb.png"><br><br>  In the same way, we need to set additional attributes for width and height - attr ('width'), attr ('height').  Everything is simple, understandable, familiar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/853/a84/706/853a847060309ea0363719887fa116be.png"><br><br>  And we see that after executing this code, we get an svg element with the attributes we need. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/59b/7ac/b37/59b7acb37d0db5df79a5fd38e7fbb480.png"><br><br>  The next thing we do is very important.  What is the D3 library?  The main task of D3 is data binding.  This is when you bind data to your DOM elements.  This is a type of application, called a data-driven application, that is controlled by incoming data.  What do we need to do?  We need to bind our data to rectangles.  We do svg.selectAll ('rect'), in return, we return an empty array, because we have just created svg, there are no rects, and we are doing such a strange manipulation with respect to our empty D3 array. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/280/63a/f41/28063af4136fd3ab5379d467ca73d8c9.png"><br><br>  This is how D3 works, and when you start working with it for a very long time, this path becomes obvious.  We use the .data method to assign this empty array our data json.deputates.  And it turns out this scheme: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/be0/901/141/be090114189dcdf4fda56b2789010e7c.png"><br><br>  When we have a finished project, we have a data element for each DOM element, and they are connected together.  In our project, now what is there? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b4/58b/fe4/9b458bfe40e4e4dda57915519c3f59a5.png"><br><br>  We have data, but no DOM element is assigned to each of them. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f5/d13/1e5/5f5d131e53168123f63dd0da8ab16f99.png"><br><br>  And we do the following. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec1/a08/a26/ec1a08a26c0734b3135710aa93b9da12.png"><br><br>  We use the .enter () method, it returns data items for which no DOM element is assigned.  All data that does not have a DOM element is returned to us, and it seems to be iterating over these elements.  For them, we call the append ('rect') method.  Those.  we say: "For each data element for which there is no DOM element, assign a new rect element".  He, not only assigns him, binds them together, he also draws it in our DOM tree. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b0/2f7/056/7b02f70569917b7c830b87b738851f5c.png"><br><br>  See, we already have 3 &lt;rect&gt; elements inside svg.  In fact, this is the most important part of the D3 library. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f86/be9/039/f86be90396c5a0a2dab4d6e2ab790c0a.png"><br><br>  If you understand this part, if you understand how it works, everything else works very simply.  And in the same way for each rect, we will set the width and height. <br><br>  What is the meaning of all this?  Why did we all do this? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b7/81b/be3/5b781bbe33e6e71fee34cdbb74275672.png"><br><br>  If we look at it now, we will see on the screen one small black rectangle 10x10 pixels, which consists of three - one on the other.  We need to change each coordinate (X, Y), depending on the salary of the deputy and depending on the number of his speeches. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ba/5dd/eec/6ba5ddeecd9177ab2b51726b582864ba.png"><br><br>  And we take the .attr method and pass the first attribute 'x', and then pass the function in which two parameters will be passed: d is the data element that corresponds to this DOM element, and the second is the iteration number.  The iteration number is almost never needed, but we always need the data item, and in this function we return the processed data in such a way that we need to bind to our 'x' attribute. <br><br>  There is a small reminder of what our data elements look like.  Those.  to 'x' we assign the number of speeches, the number of speeches. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2d4/1b9/293/2d41b92933426fd610a859feda2de812.png"><br><br>  In the same way, we act with the Y coordinate - we bind to it the size of our deputy‚Äôs salary and divide it by 10,000. I took 10,000 abstractly, because, you know, the deputies' salaries are such that they never fit into any screen.  And here we have in the browser three of our magic squares, which we drew with the help of D3.  Nishtyak, very beautiful. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/78b/0b9/8f0/78b0b98f0f4d2675f18653a0e46cc27e.png"><br><br>  Farther.  Naturally, we do not like it.  And if we add a little color?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will ‚Äúpaint‚Äù the deputies in the color of their party, add the fill attribute and to the function based on which party it is in, return this or that color. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/764/10b/62b/76410b62bd9437f2bac96ebf9032eb22.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Everything is elementary. Such a thing we did. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/021/993/a43/021993a43926f2e0ed54be6eb2e0d014.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's imagine that we did write the script in Python normally, went around the entire State Duma website, saved everything from there, and that's what happened: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e13/460/456/e13460456a2fb3b23744c6be42fecc45.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is a real infographic based on real data, just what we did. And we see that on the x-axis we have a salary, on the y-axis we have the number of speeches. This scale is not fair, we do not see it, but it is a logarithmic scale, here from 0 to the first value is so, i.e. it is stretched, and we see that dependence is. The more a deputy earns, the less speeches he has.</font></font> Those.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are, of course, some strange people, but most of the deputies who speak in the State Duma earn not so much, and the part that earns a lot, they just sit and are silent. Catch the mouse, eat slowly ... </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is the basic representation of D3, everything else is trivial. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1a4/85c/56b/1a485c56bb2383a73c69a87778038c07.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Animation is performed using the .transition () method, i.e. Initially, we assign some style, call the .transition () method and the next style. If we run this, then our body will smoothly, by default, be painted from one color to another for one second.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/da5/dd6/16f/da5dd616f69861df7849dadccd3fd6c6.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All traditional easings are supported. </font><font style="vertical-align: inherit;">Easings is how your animation will occur, i.e. </font><font style="vertical-align: inherit;">will it go linearly, or will it go first with deceleration, then with acceleration, or vice versa. </font><font style="vertical-align: inherit;">I strongly advise you to go to this site and see how easings work. </font><font style="vertical-align: inherit;">Easings are such a thing that even the simplest animation, if you add some kind of acceleration or deceleration to it, begins to look rich, beautiful, and so on.</font></font> etc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/620/caa/0aa/620caa0aa9a46751d3ad495bac496268.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Back in D3 there are a large number of layouts. </font><font style="vertical-align: inherit;">Layouts are pre-made templates for basic data visualizations. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I will show my favorite ones. </font><font style="vertical-align: inherit;">Here, let's say, Streamgraph: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b4/755/fa9/3b4755fa9ac46af4e0e0bf18bc9ac14b.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It shows various data in the form of a stream, here they randomly change. </font><font style="vertical-align: inherit;">This is a video from a browser, it works everywhere and like this.</font></font> Those.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It works quickly, efficiently, and I really like it. </font><font style="vertical-align: inherit;">I, as a person who moved to the frontend from a flash, who loves a vector, graphics, that all this works so well, I really liked it. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/0c4/e97/575/0c4e9757596d881c7aacb1a1c2b1f874.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Or, let's say, such a layout, which is mathematically you are tired of calculating how you need to connect all the streams, because they are not easy to narrow, and they are connected into small groups, and you can control this tension. </font><font style="vertical-align: inherit;">In D3, this is by default. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4a8/ff2/2db/4a8ff22db8648c3d00b0bd71f662cf19.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Or my favorite treemap. </font><font style="vertical-align: inherit;">See how beautiful treemap redesigned with easing online in live mode. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total: fast, easy and most importantly, what is beautiful.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/63e/3ce/77a/63e3ce77a1a94c66b2fbf079677c4d1a.png"><br><br><h3>  Contacts </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬ª </font></font><a href="https://habrahabr.ru/users/war_hol/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">War_hol</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬ª </font></font><a href="https://habrahabr.ru/company/rambler-co/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rambler &amp; Co company blog</font></font></a> <br><br><blockquote> <font color="gray">  ‚Äî         - <a href="http://frontendconf.ru/%3Futm_source%3Dhabr%26utm_medium%3Dmedia%26utm_campaign%3Dpast.articles%26utm_content%3Dcommon">FrontendConf</a> . <br><br>         ,          . ,         Frontend Conf ‚Äî    ,    . <br><br>     ‚Äî      " <a href="http://ritfest.ru/"> -</a> ",     ,  <strong>FrontendConf</strong> .</font> </blockquote></div><p>Source: <a href="https://habr.com/ru/post/320874/">https://habr.com/ru/post/320874/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320864/index.html">The book "Programming without fools"</a></li>
<li><a href="../320866/index.html">The logic of consciousness. Part 10. The task of generalization</a></li>
<li><a href="../320868/index.html">PR for a startup: which sites must write about your company</a></li>
<li><a href="../320870/index.html">XELTEK Adapter Cloning Protection Mechanism</a></li>
<li><a href="../320872/index.html">Docker implementation for a small project in Production, part 3</a></li>
<li><a href="../320878/index.html">Master-master replication and scaling of applications between all IoT devices and the cloud</a></li>
<li><a href="../320880/index.html">VPS hosting and cloud hosting: what to choose and what is the difference?</a></li>
<li><a href="../320882/index.html">Off splinters from the brain. 15 stereotypes about CRM-systems</a></li>
<li><a href="../320884/index.html">We set up a private Docker repository</a></li>
<li><a href="../320886/index.html">FlexPod - from theory to practice: the word to engineers (webinar)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>