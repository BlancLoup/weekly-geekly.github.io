<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Python and GUI for Network Security Services command line utilities</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Network Security Services ( NSS ) package is a set of libraries used in the cross-platform development of secure client and server applications. A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Python and GUI for Network Security Services command line utilities</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/208/293/0d1/2082930d18d94d78a0a88261c064ce21.png" align="left" height="57" vspace="5" width="200" alt="image">  The Network Security Services ( <a href="https://geektimes.ru/post/282024/">NSS</a> ) package is a set of libraries used in the cross-platform development of secure client and server applications.  Applications built using NSS can use TLS from v1.0 to TLS v1.3, PKCS # 5, PKCS # 7, CMS, PKCS # 11, PKCS # 12, S / MIME, X.509 v3 certificates, OCSP and other standards security  In its functional capacity in the field of cryptography and PKI, NSS can be compared only with <a href="https://www.openssl.org/">OpenSSL</a> .  But at the same time, the NSS package has one indisputable advantage over OpenSSL, namely, it has a repository that stores root certificates, third-party certificates, information about connected hardware accelerators, tokens, smart cards with <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/FAQ">PKCS # 11</a> interface. <br><br>  Currently the NSS package supports the PKCS # 11 v.2.40 standard. <br><a name="habracut"></a><br>  AOL, Red Hat, Sun Microsystems / Oracle, Google and other companies and individual contributors contributed to the development of NSS.  Mozilla has provided <a href="http://ftp.mozilla.org/pub/security/nss/releases/">storage</a> for source code. <br><br>  The NSS package is widely <a href="http://ru.bmstu.wiki/NSS_(Network_Security_Services)">used</a> , including in <a href="http://soft.lissi.ru/solution/mozilla/">Mozilla</a> products, including the Firefox browser (including on the <a href="http://soft.lissi.ru/solution/android/ff_for_android/">Android</a> platform), the Thunderbird email client, and the integrated Seamonkey package. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The NSS package, like OpenSSL, provides the ability to use command line utilities for implementing various PKI functions (key generation, issuing x509v3 certificates, working with electronic signatures, TLS support, etc.).  Unlike OpenSSL, where PKI functions are implemented by a single openssl utility, the NSS package provides a whole range of utilities.  So <i>, certutil is used</i> to work with <i>certificates</i> , <i>pk12util is</i> used to work with secure PKCS # 12 <i>containers</i> , and <i>p7sign, p7verify, p7content</i> , etc. are used to work with electronic signatures.  If we talk about Linux operating systems, the NSS package is included in the mandatory delivery and all these utilities are preinstalled. <br><br>  As already mentioned, NSS has built-in storage, which includes three databases: <br><br><pre><code class="bash hljs">bash-4.3$ ls -l *.db cert8.db key3.db secmod.db bash-4.3$</code> </pre> <br>  The first database <i>cert8.db</i> stores root certificates and, as a rule, third-party certificates, which are used, for example, to encrypt email or files on the recipient's certificate.  The <i>key3.db</i> stores private keys.  And finally, the <i>secmod.db</i> database stores information about plug-in tokens / smartcards with the PKCS # 11 interface.  The base is managed by the <i>modutil</i> utility, which allows you to add or remove a module PKCS # 11.  A module connection consists in specifying the path to the PKCS # 11 library module and specifying its nickname.  Specifying the path to the directory in which the storage is located is an integral parameter of any NSS utility.  In some utilities, it is specified as ‚Äú <i>-d &lt;NSS storage directory&gt;</i> ‚Äù, in others, as ‚Äú <i>-dbdir &lt;NSS storage directory&gt;</i> ‚Äù.  Created by the modutil utility: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#modutil ‚Äìcreate ‚Äìdbdir &lt;   NSS &gt;</span></span></code> </pre> <br>  Note that such storage is in all projects built on NSS, including Firefox, Thunderbird, Seamonkey. <br><br>  The <a href="https://habrahabr.ru/post/332924/">article</a> expressed a wish to write graphical shells for the command line utilities of OpenSSL and NSS.  And now it is time for NSS.  First question: in what environment to develop?  In previous articles, the development of a user graphical interface in the <a href="https://habrahabr.ru/post/333742/">Tcl / Tk</a> environment was considered using various constructors.  The development of a graphical user interface for the NSS package was decided to be in the Python scripting language.  In order to ensure continuity with the Tk package, the <a href="https://habrahabr.ru/post/133337/">Tkinter</a> package was chosen as a graphic package. <br><br>  Now it was necessary to choose tools for designing a graphical interface.  The first was considered the package <a href="http://www.bitflipper.ca/rapyd/">Rapid-TK</a> : <br><br><img src="https://habrastorage.org/web/fa7/764/0ed/fa77640ed4ba4135843823118f6a1c4b.png" alt="image"><br><br>  In general, the package left a good impression that justifies its name of the package: Rapid - fast.  And yet we note two shortcomings.  The first disagreement is due to the fact that only icons of widgets are placed on the easel, and not the widgets themselves (see the figure).  And to see the real picture, you have to very often carry out the project.  The second drawback is related to the placement of widgets in the window.  In the Rapid-TK, the Packer is used as a packer (placement in directions), which makes it very difficult to align widgets in a window, as opposed to grid packers (on a grid, like sea battle) and place (coordinates).  Although the use of frame allows you to achieve the desired effect: <br><br><img src="https://habrastorage.org/web/ae2/347/1d0/ae23471d04594817a5951eab06a0d560.png" alt="image"><br><br>  However, after the start of design it became clear that the number of widgets and windows in the project is growing and the use of Notebook technology would be optimal (notepad, notebook) <br><br><img src="https://habrastorage.org/web/fa8/f63/3af/fa8f633af2cd40649cf7e7a101cb8be8.png" alt="image"><br><br>  And then an unpleasant surprise awaited: the Rapid-TK designer does not support working with Notebook, although the widget itself is connected.  And then the <a href="http://page.sourceforge.net/">Page</a> constructor was found - an automatic GUI generator for Python.  A completely unexpected and pleasant surprise was that the Page constructor is based on <a href="https://habrahabr.ru/post/333742/">Visual Tcl</a> .  This was the most powerful argument: <br><br><img src="https://habrastorage.org/web/474/ac9/afc/474ac9afcaa24462a5fc562f4900e745.png" alt="image"><br><br>  If you look closely, the Page constructor windows are like the twins of the Visual Tcl constructor windows.  And yet it was not without a trick: the Python script created by the generator did not want to be executed due to the use of the ‚Äúgreat, powerful, truthful and free Russian language!‚Äù (I.S. Turgenev).  But everything was resolved simply, it turned out enough to add the following code to the file gui_pyton_gen.tcl after 418 lines: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- ,</span></span></code> </pre> <br>  Now, if you look at the generated Python code, this directive will be the second line in it: <br><br><pre> <code class="python hljs">! /usr/bin/env python <span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- # # GUI module generated by PAGE version 4.9 # In conjunction with Tcl version 8.6 # Aug 14, 2017 11:39:19 AM import sys try: from Tkinter import * except ImportError: from tkinter import * . . .</span></span></code> </pre> <br>  What else?  The Page Constructor does not assume that the project will be multi-windowed (see above Rapid).  In our case, multiple windows, on the one hand, are replaced by Notebook.  And on the other hand, first of all it concerns the input of a PIN-code or password, we used the Labelframe widget, which was then hidden ( <i>self1.LabelPSW6.place_forget ()</i> ): <br><br><img src="https://habrastorage.org/web/433/fea/03d/433fea03dc7242e383ea81c30a9ca6d0.png" alt="image"><br><br>  It appeared to enter a PIN or password: <br><br><pre> <code class="python hljs">self1.LabelPSW6.place(relx=<span class="hljs-number"><span class="hljs-number">0.05</span></span>, rely=<span class="hljs-number"><span class="hljs-number">0.59</span></span>, relheight=<span class="hljs-number"><span class="hljs-number">0.3</span></span>, relwidth=<span class="hljs-number"><span class="hljs-number">0.88</span></span>)</code> </pre> <br>  However, an additional window was required, for example, to view the contents of a certificate from a database or an electronic signature: <br><br><img src="https://habrastorage.org/web/6be/702/d16/6be702d163924063a6d45301a5d18147.png" alt="image"><br><br>  In this case, the problem is solved simply.  A new project is created in the Page constructor and the resulting code is ‚Äúhandled‚Äù into the main branch.  To see all the intricacies of graphical user interface development for command line utilities in Python on Tkinter, install the <a href="https://sourceforge.net/projects/page/">Page</a> constructor, load <a href="http://soft.lissi.ru/downloads/download_guinss/">the nss_my project</a> and analyze it carefully.  As features of this project, we will give a screenshot of the extraction of the original file from the file with the attached signature (p7content utility): <br><br><img src="https://habrastorage.org/web/5c2/6fd/41e/5c26fd41e97d4184903fe246b42b1fc4.png" alt="image"><br><br>  Finally, we want to get at the output not a Python script, but a binary code.  For this, we used the <a href="http://nuitka.net/">Nuitka</a> project, which the Python script converts to C code and then translates.  The effect exceeded all expectations.  Put the Nuitka package, put two Python scripts nss_my.py and nss_my_support.py generated by the Page constructor into the bin folder and execute the command: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#nuitka ‚Äìrecurse-all nss_my.py</span></span></code> </pre> <br>  As a result, you get a binary module nss_my.exe.  Do not be confused by the ending, feel free to run it.  Binary code can also be downloaded <a href="http://soft.lissi.ru/downloads/download_guinss/">here</a> .  As a plug-in PKCS # 11, at least during the testing phase, it is convenient to use a <a href="https://habrahabr.ru/post/332924/">cloud</a> token. </div><p>Source: <a href="https://habr.com/ru/post/335712/">https://habr.com/ru/post/335712/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335702/index.html">Study of the safety of the transport system of Tbilisi - or how to ride a vehicle and earn money</a></li>
<li><a href="../335704/index.html">Mamba: open-source crypto-fiber</a></li>
<li><a href="../335706/index.html">Reducing prices for local SSD drives in ‚Äúdisplaced‚Äù instances and instances on demand</a></li>
<li><a href="../335708/index.html">5 reasons why you should build a small business - not a startup</a></li>
<li><a href="../335710/index.html">Introduction to the development of smart contracts Ethereum</a></li>
<li><a href="../335716/index.html">Oracle Data Type Mapping with PostgreSQL</a></li>
<li><a href="../335718/index.html">A hackfest on ReactOS started in Cologne</a></li>
<li><a href="../335720/index.html">Techniques for building corporate budgeting systems</a></li>
<li><a href="../335728/index.html">Sosnovkino - the first domestic scam? Or we will collect money faster and more</a></li>
<li><a href="../335730/index.html">To whom life with ISDEF is good</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>