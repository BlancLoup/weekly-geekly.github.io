<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A bit about the Stream API (Java 8)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A small article with examples of using the Stream API in Java8 , which I hope will help novice users to master and use the functionality. 


 Often, t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A bit about the Stream API (Java 8)</h1><div class="post__text post__text-html js-mediator-article"><h6>  A small article with examples of using the <b>Stream API in Java8</b> , which I hope will help novice users to master and use the functionality. </h6><br><img src="https://habrastorage.org/files/a4a/476/028/a4a476028098499ab08b944d4f10f7ad.jpg"><br><a name="habracut"></a><br>  Often, the <b>Stream API in Java8 is</b> used to work with collections, allowing you to write code in a functional style. <br>  Convenience and simplicity of methods contribute to the interest in this functionality among developers since its release. <h6></h6><h6>  So, what is the <b>Stream API</b> in Java8?  "Package java.util.stream" - <em>"Classes to support functional-style operations on streams of elements, such as map-reduce transformations on collections"</em> .  I will try to give my own version of the translation, in fact, this is support for the functional style of operations on streams, such as processing and ‚Äúfolding‚Äù of the processed data. </h6><br><h6>  <em>‚ÄúStream operations are divided into intermediate and terminal operations, and are combined to form stream pipelines.</em>  <em>A stream pipeline consists of a source (such as a collection, an array, a generator function, or an I / O channel);</em>  <em>followed by zero or more intermediate operations such as Stream.filter or Stream.map;</em>  <em>and a terminal operation such as Stream.forEach or Stream.reduce ‚Äù</em> - <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html">description from the site</a> . <br>  Let's try to understand this definition.  The authors tell us about the presence of intermediate and final operations, which are combined in the form of conveyors.  Flow conveyors contain a source (for example, collections, etc.) followed by intermediate and final operations and examples are given.  It is worth noting here that all intermediate operations on streams are lazy (LAZY).  They will not be executed until the terminal (final) operation is called. </h6><br><h6>  Another interesting feature is the presence of <b>parallelStream ()</b> .  I use these capabilities to improve performance when processing large amounts of data.  Parallel threads will speed up the execution of certain types of operations.  I use this opportunity when I know that the collection is large enough to handle it in the ‚ÄúForkJoin‚Äù version.  Read more about <b>ForkJoin</b> in the previous article on this topic - <a href="https://habrahabr.ru/post/272479/">‚ÄúJava 8 in parallel.</a>  <a href="https://habrahabr.ru/post/272479/">We learn to create subtasks and monitor their implementation. "</a> </h6><br>  We finish with the theoretical part and proceed to simple examples. <br>  The example shows finding the maximum and minimum values ‚Äã‚Äãfrom the collection. <br><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  ‚Ññ 1 *      */</span></span> ArrayList&lt;Integer&gt; testValues = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList(); testValues.add(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>); testValues.add(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); testValues.add(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>); testValues.add(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">100</span></span>); testValues.add(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">50</span></span>); Optional&lt;Integer&gt; maxValue = testValues.stream().max(Integer::compareTo); System.out.println(<span class="hljs-string"><span class="hljs-string">"MaxValue="</span></span>+maxValue); Optional&lt;Integer&gt; minValue = testValues.stream().min(Integer::compareTo); System.out.println(<span class="hljs-string"><span class="hljs-string">"MinValue="</span></span>+minValue);</code> </pre> <br>  Let's slightly complicate the example and add exceptions (in the form of null) at the maximum value in example 2. <br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  ‚Ññ 2 *     null  */</span></span> ArrayList&lt;Integer&gt; testValuesNull = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList(); testValuesNull.add(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); testValuesNull.add(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); testValuesNull.add(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>); testValuesNull.add(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">70</span></span>); testValuesNull.add(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">50</span></span>); Optional&lt;Integer&gt; maxValueNotNull = testValuesNull.stream().filter((p) -&gt; p != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>).max(Integer::compareTo); System.out.println(<span class="hljs-string"><span class="hljs-string">"maxValueNotNull="</span></span>+maxValueNotNull);</code> </pre><br>  Let's complicate the examples.  Create a collection of "sports camp", consisting of the fields "Name" and "Number of days in a sports camp."  The very example of creating a class below. <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SportsCamp</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-comment"><span class="hljs-comment">//  private Integer day; //     public SportsCamp(String name, int day) { this.name = name; this.day = day; } public String getName() { return name; } public void setName(String name) { this.name = name; } public Integer getDay() { return day; } public void setDay(Integer day) { this.day = day; } }</span></span></code> </pre><br>  And now examples of working with new data: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Collection; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Start</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ Collection&lt;SportsCamp&gt; sport = Arrays.asList( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SportsCamp(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SportsCamp(<span class="hljs-string"><span class="hljs-string">"Petr"</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SportsCamp(<span class="hljs-string"><span class="hljs-string">"Ira"</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) ); <span class="hljs-comment"><span class="hljs-comment">/** *  3 *          */</span></span> String name = sport.stream().max((p1,p2) -&gt; p1.getDay().compareTo(p2.getDay())).get().getName(); System.out.println(<span class="hljs-string"><span class="hljs-string">"Name="</span></span>+name); } }</code> </pre><br>  In the example, the name was found, Irina, who will be in the camp the longest. <br>  Let's transform an example and create a situation when we have an error crept in, and one of the null entries in the name. <br><pre> <code class="java hljs">Collection&lt;SportsCamp&gt; sport = Arrays.asList( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SportsCamp(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SportsCamp( <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SportsCamp(<span class="hljs-string"><span class="hljs-string">"Petr"</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SportsCamp(<span class="hljs-string"><span class="hljs-string">"Ira"</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) );</code> </pre><br>  In this case, you will get a result equal to "Name = null". Agree that we did not want this. We will slightly change the search in the collection to a new version. <br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  ‚Ññ 4 */</span></span> String nameTest = sport.stream().filter((p) -&gt; p.getName() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>).max((p1, p2) -&gt; p1.getDay().compareTo(p2.getDay())).get().getName();</code> </pre><br>  The result, "Ira" - is true. <br>  The examples show us how to find the minimum and maximum values ‚Äã‚Äãfor collections with small additions as an exception to null values. <br>  As we said, the available methods can be divided into two large groups, intermediate operations and final ones.  Authors may call them differently; for example, the variant names of conveyor and terminal methods are used in literature and articles.  When working with methods, there is one design feature, you can ‚Äúthrow in‚Äù a lot of intermediate operations, at the end making a call to one terminal method. <br>  In the new example, we will add sorting and output of a certain element, for example, add a filter by the names with the encountered ‚ÄúIvan‚Äù and calculate these elements (excluding null values). <br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  ‚Ññ 5 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> countName = sport.stream().filter((p) -&gt; p.getName() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; p.getName().equals(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>)).count(); System.out.println(<span class="hljs-string"><span class="hljs-string">"countName="</span></span>+countName);</code> </pre><br>  Adding new SportsCamp ("Ivan", 17) to the collection, we get the result equal to "countName = 2".  Found two entries. <br>  In these examples, creating a stream from the collection was used, other options are available, for example, creating a stream from the required values, for example, Stream streamFromValues ‚Äã‚Äã= Stream.of ("test1", "test2", "test3"), other options are possible. <br>  As mentioned above, users have the opportunity to use "processing" using parallelStream (). <br>  Slightly changing the example, we get a new version of the implementation: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">long</span></span> countNameParallel = sport.parallelStream().filter((p) -&gt; p.getName() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; p.getName().equals(<span class="hljs-string"><span class="hljs-string">"Ivan"</span></span>)).count(); System.out.println(<span class="hljs-string"><span class="hljs-string">"countNameParallel="</span></span> + countNameParallel);</code> </pre><br>  The peculiarity of this option is the implementation of parallel stream.  I would like to note that parallelStream () is justifiably used on powerful servers (multicore) for large collections.  I do not give a clear definition and exact size of collections, because  a lot of parameters need to be identified and calculated.  Often, only testing can show you an increase in performance. <br><h6>  We got a little acquainted with simple operations, understood the difference between pipeline and terminal operations, tried both.  And now let's look at examples of more complex operations, for example, collect and Map, Flat and Reduce. <br>  Once again, look at the official documentation <a href="http://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html">documentation</a> and try to implement their examples. <br>  In the new example we will try to convert one collection to another, with names starting with ‚ÄúI‚Äù and write it in the List. <br><pre> <code class="java hljs">List&lt;SportsCamp&gt; onlyI = sport.stream().filter(p -&gt; p.getName() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; p.getName().startsWith(<span class="hljs-string"><span class="hljs-string">"I"</span></span>)).collect(Collectors.toList()); System.out.println(<span class="hljs-string"><span class="hljs-string">"SIZE="</span></span>+onlyI.size());</code> </pre><br>  The result will be three.  It should be noted here that the order of specifying the exclusion of null elements is significant. <br>  Please note that Collectors has a ton of features, including the derivation of a mean value or information with statistics.  As an example, let's try to connect the data, like this: <br><pre> <code class="java hljs">String campPeople = sport.stream().filter(p -&gt; p.getName() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>).map(SportsCamp::getName).collect(Collectors.joining(<span class="hljs-string"><span class="hljs-string">" and "</span></span>,<span class="hljs-string"><span class="hljs-string">"In camp "</span></span>,<span class="hljs-string"><span class="hljs-string">" rest all days."</span></span>)); System.out.println(campPeople);</code> </pre><br></h6><h6>  Result: "In camp Ivan and Petr and Ivan rest all days".  There are several options for using Collectors.joining. </h6><br><h6>  From Map, Flat, and Reduce, consider the example with reduce.  Map and flat-map will be discussed in the following articles. <br>  Reduce is used to ‚Äúassemble‚Äù elements, in simple language, if you want to create a new instance of an object with aggregating indicators of other elements in the stream, then reduce will work for you.  There are several uses.  Consider one of them, for example, let's sum up the data for all days in a sports camp. <br><pre> <code class="java hljs">Integer daySum = sport.stream().reduce(<span class="hljs-number"><span class="hljs-number">0</span></span>, (sum, p) -&gt; sum += p.getDay(), (sum1, sum2) -&gt; sum1 + sum2); System.out.println(<span class="hljs-string"><span class="hljs-string">"DaySize="</span></span> + daySum);</code> </pre><br></h6><h6>  In this version, reduce takes three values, the first - the identifier, the second - the battery, and the third is actually a ‚Äúmerge‚Äù.  There are several other options. </h6><br><h6>  The article describes only a small part of the methods, perhaps they will interest many and appear in new projects.  In the aggregate, the lambda functional becomes an excellent tool for writing short and fast-executable code.  Good luck to all. </h6></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/302628/">https://habr.com/ru/post/302628/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../302614/index.html">The fight for the regions: How to online store to win against an offline retailer</a></li>
<li><a href="../302616/index.html">The digest of interesting materials for the mobile developer # 156 (May 30 - June 5)</a></li>
<li><a href="../302620/index.html">Watching the user - two types of timestamp</a></li>
<li><a href="../302624/index.html">The best packages for working with data in R, part 2</a></li>
<li><a href="../302626/index.html">Artificial Intelligence is changing SEO faster than you think.</a></li>
<li><a href="../302630/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ214 (May 30 - June 5, 2016)</a></li>
<li><a href="../302632/index.html">Digest of grocery design, May 2016</a></li>
<li><a href="../302634/index.html">Simultaneously Mounting Encrypted Folders in Synology DSM</a></li>
<li><a href="../302638/index.html">Fountain codes</a></li>
<li><a href="../302642/index.html">How to raise CI for iOS developers in a day. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>