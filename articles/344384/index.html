<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Authentication and authorization in Ember, Part 1: ember library simple auth</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Subsystems of registration, authentication and authorization of users need almost any web project. The creation of such subsystems can be approached f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Authentication and authorization in Ember, Part 1: ember library simple auth</h1><div class="post__text post__text-html js-mediator-article">  Subsystems of registration, authentication and authorization of users need almost any web project.  The creation of such subsystems can be approached from different sides.  For example - use specialized libraries.  Today we want to share with you a translation of an article by Alvin Crespo, a programmer from Echobind, who talks about the <a href="https://github.com/simplabs/ember-simple-auth">ember-simple-auth</a> library. <br><br> <a href="https://habrahabr.ru/company/ruvds/blog/344384/"><img src="https://habrastorage.org/getpro/habr/post_images/dcb/0a8/e5b/dcb0a8e5b1bd862ec1c5d5e0e2fd326f.png"></a> <br><br>  According to him, this library, designed to organize authentication and authorization, occupies a worthy place in the arsenal of tools that the company uses to develop web-based systems based on Ember.  In this article, Alvin talks about how to integrate the library into a project and create a subsystem for registering users of the site. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Install ember-simple-auth</font> </h2><br>  First, create a new Ember application: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs cs">ember <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> auth-example-frontend</code> </pre> <br>  After executing this command, you should see the following: <br><br><pre> <code class="hljs pgsql">‚ûú  ember <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> auth-example-frontend installing app <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> .editorconfig <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> .ember-cli <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> .eslintrc.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> .travis.yml <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> .watchmanconfig <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> README.md <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/app.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/components/.gitkeep <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/controllers/.gitkeep <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/helpers/.gitkeep <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.html <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/models/.gitkeep <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/resolver.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/router.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/routes/.gitkeep <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/styles/app.css <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/templates/application.hbs <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/templates/components/.gitkeep <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> config/environment.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> config/targets.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> ember-cli-build.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> .gitignore <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> package.json <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span>/crossdomain.xml <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span>/robots.txt <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> testem.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/.eslintrc.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/helpers/destroy-app.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/helpers/module-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-acceptance.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/helpers/resolver.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/helpers/<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>-app.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.html <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/integration/.gitkeep <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/test-helper.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/unit/.gitkeep <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vendor/.gitkeep NPM: Installed dependencies</code> </pre> <br>  As you can see, I use NPM, everything works as it should, so please do not criticize me for this. <br><br>  Go to the directory of the new application: <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> auth-example-frontend</code> </pre> <br>  Install <code>ember-simple-auth</code> : <br><br><pre> <code class="hljs sql">ember <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> ember-simple-auth</code> </pre> <br>  After executing this command, the system should report the successful installation of the library <br><br><pre> <code class="hljs scala">‚ûú  ember install ember-simple-auth <span class="hljs-type"><span class="hljs-type">NPM</span></span>: <span class="hljs-type"><span class="hljs-type">Installed</span></span> ember-simple-auth <span class="hljs-type"><span class="hljs-type">Installed</span></span> addon <span class="hljs-keyword"><span class="hljs-keyword">package</span></span>.</code> </pre> <br>  With the installation, we figured out, as you see, there are no difficulties.  Now let's do the application setup. <br><br><h2>  <font color="#3AC1EF">Adapter setup</font> </h2><br>  First, create an application adapter: <br><br><pre> <code class="hljs sql">‚ûú  ember g adapter application installing adapter <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/adapters/application.js installing adapter-<span class="hljs-keyword"><span class="hljs-keyword">test</span></span> <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/unit/adapters/application-test.js</code> </pre> <br>  Here we used the generator to create the default application level adapter.  As a result, the following file will be created: <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> auth-example-frontend/app/adapters/application.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DS <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ember-data'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> DS.JSONAPIAdapter.extend({ });</code> </pre> <br>  Here we need to make some changes, bringing this file to the following form: <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> auth-example-frontend/app/adapters/application.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> JSONAPIAdapter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ember-data/adapters/json-api'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DataAdapterMixin <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ember-simple-auth/mixins/data-adapter-mixin'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> config <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'my-app/config/environment'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> JSONAPIAdapter.extend(DataAdapterMixin, { host: config.apiUrl, namespace: config.apiNamespace, authorizer: <span class="hljs-string"><span class="hljs-string">'authorizer:application'</span></span> });</code> </pre> <br>  Here we imported the <code>JSONAPIAdapter</code> adapter, extended it using <code>DataAdapterMixin</code> and added several properties.  In particular, the values ‚Äã‚Äãthat are written to the <code>host</code> and <code>namespace</code> are stored in the <code>config/environment.js</code> file, which we also import.  It has the following code responsible for the values ‚Äã‚Äãof interest: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> ENV = { ... apiNamespace: <span class="hljs-string"><span class="hljs-string">'api'</span></span>, apiUrl: <span class="hljs-literal"><span class="hljs-literal">null</span></span> };</code> </pre> <br>  Here, firstly, <code>apiNamespace</code> is the string <code>api</code> , which affects the formation of the paths <code>http://localhost:4000/api/users</code> .  In this <code>apiURL</code> we will set <code>apiURL</code> using the <code>proxy</code> option in <code>ember-cli</code> , for example, like this: <br><br><pre> <code class="hljs objectivec">ember s --proxy http:<span class="hljs-comment"><span class="hljs-comment">//localhost:4000</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">Configuring Authenticator</font> </h2><br>  <i>The authenticator authenticates the session.</i>  <i>This can be used, for example, by sending a set of credentials to the server and getting an access token from it, or initiating authentication using an external provider like Facebook.</i> <br><br>  If in a nutshell, the authenticator is used to authenticate the session using the credentials passed to it.  Here we will use <a href="http://ember-simple-auth.com/api/classes/OAuth2PasswordGrantAuthenticator.html">OAuth2PasswordGrantAuthenticator</a> , which makes it possible to perform authentication using an identifier (user name, email address, and so on) and a password. <br><br>  To create an authenticator, use the following command: <br><br><pre> <code class="hljs cs">ember g authenticator oauth2 --<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=oauth2</code> </pre> <br>  In response, the system displays the following: <br><br><pre> <code class="hljs cs">‚ûú  ember g authenticator oauth2 --<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=oauth2 installing authenticator create app/authenticators/oauth2.js</code> </pre> <br>  During the execution of the above command, the <code>oauth2.js</code> file will be created: <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> auth-example-frontend/app/authenticators/oauth2.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> OAuth2PasswordGrant <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ember-simple-auth/authenticators/oauth2-password-grant'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> OAuth2PasswordGrant.extend({ });</code> </pre> <br>  Now we need to set the <a href="http://ember-simple-auth.com/api/classes/OAuth2PasswordGrantAuthenticator.html">serverTokenEndpoint</a> property.  What role does it play? <br><br>  This is the endpoint on the server to which authentication and update requests are sent. <br><br>  Set up the endpoint in the same <code>oauth2.js</code> file: <br><br><pre> <code class="hljs pgsql">// auth-example-frontend/app/authenticators/oauth2.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> OAuth2PasswordGrant <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ember-simple-auth/authenticators/oauth2-password-grant'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> config <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'my-app/config/environment'</span></span>; const host = config.apiUrl || <span class="hljs-string"><span class="hljs-string">''</span></span>; const namespace = config.apiNamespace; const serverTokenEndpoint = [ host, namespace, <span class="hljs-string"><span class="hljs-string">'token'</span></span> ]; export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> OAuth2PasswordGrant.extend({ serverTokenEndpoint: serverTokenEndpoint.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(<span class="hljs-string"><span class="hljs-string">'/'</span></span>) });</code> </pre> <br>  Here we form the <code>serverTokenEndpoint</code> property we need by combining the <code>host</code> and <code>namespace</code> string constants with the string <code>token</code> .  As a result, for example, if we have the following: <br><br><pre> <code class="hljs cs">host = <span class="hljs-string"><span class="hljs-string">'http://localhost:4000'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> = <span class="hljs-string"><span class="hljs-string">'api'</span></span> token = <span class="hljs-string"><span class="hljs-string">'token'</span></span></code> </pre> <br>  The <code>serverTokenEndpoint</code> will have the following string: <br><br><pre> <code class="hljs objectivec">http:<span class="hljs-comment"><span class="hljs-comment">//localhost:4000/api/token</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">Configure the authorizer</font> </h2><br>  <i>Authorizers use session data received by the authenticator during session authentication to generate authorization data, which can then, for example, be embedded in subsequent network requests.</i> <br><br>  The point of all this is that after the authentication is completed, the authorizer uses the session data to generate the authorization data used in the requests.  In our example, this will lead to the formation of such a header: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Authorization</span></span>: Bearer s0m3tok3n1</code> </pre> <br>  Fortunately, the <code>ember-simple-auth</code> library makes it easy to set it up.  We will use the <a href="http://ember-simple-auth.com/api/classes/OAuth2BearerAuthorizer.html">OAuth2BearerAuthorizer</a> class, since it, with little effort on our part, allows us to form the above header. <br><br>  We just need to execute the following command: <br><br><pre> <code class="hljs cs">ember g authorizer application --<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=oauth2</code> </pre> <br>  After executing the command, we will see the following: <br><br><pre> <code class="hljs cs">‚ûú  ember g authorizer application --<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=oauth2 installing authorizer create app/authorizers/application.js</code> </pre> <br>  This will create a file located at <code>app/authorizers/application.js</code> : <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> auth-example-frontend/app/authorizers/application.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> OAuth2Bearer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ember-simple-auth/authorizers/oauth2-bearer'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> OAuth2Bearer.extend({ });</code> </pre> <br><h2>  <font color="#3AC1EF">Connecting ember simple auth to the application</font> </h2><br>  After the configuration of the authentication and authorization subsystems is completed, you can use all of this in the application. <br><br><h3>  <font color="#3AC1EF">‚ñç Create a route for registration in the system</font> </h3><br>  First you need to create a route that provides registration in the system: <br><br><pre> <code class="hljs matlab">ember g route <span class="hljs-built_in"><span class="hljs-built_in">sign</span></span>-up</code> </pre> <br>  In response to this command, the following will be issued: <br><br><pre> <code class="hljs sql">‚ûú  ember g route sign-up installing route <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/routes/<span class="hljs-keyword"><span class="hljs-keyword">sign</span></span>-up.js <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/templates/<span class="hljs-keyword"><span class="hljs-keyword">sign</span></span>-up.hbs updating router <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> route <span class="hljs-keyword"><span class="hljs-keyword">sign</span></span>-up installing route-<span class="hljs-keyword"><span class="hljs-keyword">test</span></span> <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/unit/routes/<span class="hljs-keyword"><span class="hljs-keyword">sign</span></span>-up-test.js</code> </pre> <br>  Let's open the created registration form template ( <code>sign-up.hbs</code> ) and bring it to this form: <br><br><pre> <code class="hljs django"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{action "onSignUp" email password on="submit"}}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">   </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Email</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">   </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{input type="email" value=email}}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">   </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Password</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">   </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{input type="password" value=password}}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Sign Up</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  There is a simple form with <code>email</code> and <code>password</code> fields.  When a user clicks the <code>Sign Up ‚Äî</code> button <code>Sign Up ‚Äî</code> we <code>onSignUp</code> action, passing him the entered email address and password.  We define this action: <br><br><pre> <code class="hljs pgsql">// auth-example-frontend/routes/sign-up.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Route <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@ember/routing/route'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { inject <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> service } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@ember/service'</span></span>; const AUTHENTICATOR = <span class="hljs-string"><span class="hljs-string">'authenticator:oauth2'</span></span>; export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> Route.extend({ <span class="hljs-keyword"><span class="hljs-keyword">session</span></span>: service(),  actions: {    async onSignUp(email, <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>) {      let attrs = { email, <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> };      let <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = this.store.createRecord(<span class="hljs-string"><span class="hljs-string">'user'</span></span>, attrs);      await <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>.save();      let <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> = this.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-string"><span class="hljs-string">'session'</span></span>);      await <span class="hljs-keyword"><span class="hljs-keyword">session</span></span>.authenticate(AUTHENTICATOR, email, <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>);   } } });</code> </pre> <br>  Above, we just added an <code>onSignUp</code> action to the route.  If you are not familiar with how events work in Ember, then keep in mind that the <code>onSignUp</code> action triggered in the template will involve the controller and then the route.  Since we do not define an action in the controller, the route will process it. <br><br>  In the <code>onSignUp</code> action <code>onSignUp</code> we get <code>email</code> and <code>password</code> , so we use this data to create a user account.  Then save this account and get the session service.  The session service is part of <code>ember-simple-auth</code> , here is its description: <br><br>  <i>The session service provides access to the current session, as well as methods for its authentication, invalidation, and so on.</i>  <i>This is the main interface to the Ember Simple Auth functionality that applications can use.</i> <br><br>  Given this, then we call the <a href="http://ember-simple-auth.com/api/classes/SessionService.html">authenticate</a> method.  We pass to this method the authenticator that we want to use, in our case, the <code>authenticator:oauth2</code> , as well as, as separate arguments, the password and email address. <br><br>  Please note that if you did not use the <code>async/await</code> construct in your project, then it is quite possible to work without it.  You can easily remove <code>async/await</code> from the above code and use the <code>then/catch/finally</code> to resolve promises.  If you are interested in learning more about using <code>async/await</code> in your projects, take a look at <a href="http://rwjblue.com/2017/10/30/async-await-configuration-adventure/">this material</a> . <br><br>  Now we just have to define the <code>user</code> model.  If this is not done, we will encounter the following unpleasant error: <br><br>  source This is unlikely to please anyone, so let's do a model. <br><br><h3>  <font color="#3AC1EF">‚ñç Definition of the user model</font> </h3><br>  We will create a fairly simple <code>user</code> model.  It will contain only an email address and password.  Create it by running the following generator: <br><br><pre> <code class="hljs cs">ember g model user email:<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> password:<span class="hljs-keyword"><span class="hljs-keyword">string</span></span></code> </pre> <br>  Having executed this command, we will see the following: <br><br><pre> <code class="hljs pgsql">‚ûú ember g model <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> email:string <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>:string installing model <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> app/models/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>.js installing model-test <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> tests/unit/models/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>-test.js</code> </pre> <br>  The <code>user.js</code> model file created by this command should be <code>user.js</code> to the following form: <br><br><pre> <code class="hljs pgsql">// auth-example-frontend/models/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DS <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ember-data'</span></span>; export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> DS.Model.extend({ email: DS.attr(<span class="hljs-string"><span class="hljs-string">'string'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>: DS.attr(<span class="hljs-string"><span class="hljs-string">'string'</span></span>) });</code> </pre> <br>  Now everything is ready for testing. <br><br><h2>  <font color="#3AC1EF">Authentication Testing</font> </h2><br>  In order to look at what we have just done, in action, you need to run the application.  But before you do this, remove the standard welcome page.  Open the <code>package.json</code> file and remove the following from it: <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"ember-welcome-page"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.0.0"</span></span>,</code> </pre> <br>  Now start the server: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">ember</span></span> s</code> </pre> <br>  After that, go to <code>http://localhost:4200/sign-up</code> . <br><br>  Here is an example of working with the newly created client part of the authentication system: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/25a/7fc/570/25a7fc5707310755d5360d7206a0d485.gif"></div><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  In this material, we have integrated into the Ember application the client part of the system of registration, authentication and authorization of users.  Now it remains only to connect all this to the API.  Alternatively, you can simulate the end point in <a href="http://www.ember-cli-mirage.com/">ember-cli-mirage</a> .  However, we are going to go on a really working web application, so the next time we‚Äôll continue to work on the project using <a href="http://phoenixframework.org/">Elixir / Phoenix</a> and <a href="https://github.com/ueberauth/guardian">Guardian</a> . <br><br>  <b>Dear readers!</b>  How do you create authentication subsystems for web applications? </div><p>Source: <a href="https://habr.com/ru/post/344384/">https://habr.com/ru/post/344384/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344374/index.html">Case SMS working on customer loyalty</a></li>
<li><a href="../344376/index.html">Vulnerability found in all versions of Windows, which does not close any antivirus</a></li>
<li><a href="../344378/index.html">The fastest and most energy-efficient implementation of the BFS algorithm on various parallel architectures</a></li>
<li><a href="../344380/index.html">Introducing dependencies in .Net Mark Siman 2 - Implementing a constructor, lifetime</a></li>
<li><a href="../344382/index.html">How we created a password manager with strong cryptography and a master password. Experience team Yandex. Browser</a></li>
<li><a href="../344386/index.html">Formula 1 for drones: ITMO University team ranked first at Robotex-2017</a></li>
<li><a href="../344388/index.html">ASO Monthly # 19 November 2017</a></li>
<li><a href="../344390/index.html">How to check a car before you buy: we use databases and logic available on the Internet</a></li>
<li><a href="../344392/index.html">Conveyor of games for stores from sophomores with love</a></li>
<li><a href="../344394/index.html">Tutorial on the Unreal Engine. Part 1: familiarity with the engine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>