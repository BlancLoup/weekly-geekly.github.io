<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TFS Aggregator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="... Or how to automate some actions in TFS 2010. 

 I‚Äôll say right away that for TFS 2012, the author promises to quickly release an updated version, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>TFS Aggregator</h1><div class="post__text post__text-html js-mediator-article">  ... Or how to automate some actions in TFS 2010. <br><br>  I‚Äôll say right away that for TFS 2012, the author promises to quickly release an updated version, however, in my opinion, given that the API has not changed or little has changed, then this small project may well start on the new TFS 2012 RC. <br><h1>  Idea </h1><br>  My last articles ( <a href="http://habrahabr.ru/post/147294/">one</a> , <a href="http://habrahabr.ru/post/147295/">two</a> ) tell about setting up process templates for TFS, but these templates are separated from each other, in fact, although they are connected in work by relationships like: Child, Parent, Related To and so on.  It would be logical to use this connection, to add interactivity to the whole scheme, so that the elements are really connected, so that they really react to each other's state depending on the type of connection and state.  So that you can do some accumulative calculations in the metrics, because all this data is available and can be used in automatic mode, reducing the time of routine actions. <br><br>  You can come up with a lot of scenarios when automating the change of states in related elements would save time.  In the standard scheme, when changing the state, it is possible to change the fields belonging to the same work item, but this is not enough. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For example, imagine a situation where a user story has a full set of artifacts and is ready for work, specific tasks have been created to implement this story.  In this situation, the story is in the <strong>Ready For Development</strong> state, and all tasks are in the <strong>Proposed</strong> state.  The developer takes the task to work, changes its state to <strong>Active</strong> .  Next, it should change the state of the history to <strong>WIP</strong> (Work In Progress).  However, this step can be automated!  And automation, in turn, leads to greater order and beauty.  Those.  as soon as the developer took the task to work, the state of the whole history changed <em>automatically</em> ! <br><br>  Or another example, for example, it was decided to suspend the work on the whole story, as it was suddenly revealed new circumstances of the work of any component.  In the work there are several tasks, some have not started yet, some have been completed.  When transferring history to the <strong>Hold</strong> status, in a good way, all active tasks must be transferred to the <strong>Hold</strong> status.  Manually doing this would be somewhat tedious - it can also be automated.  Or the opposite situation, when one task is put on <strong>Hold</strong> , and the whole story is put in a waiting state. <br><br><a name="habracut"></a><br><br>  It would also be useful functionality when all tasks are solved, the status of the history automatically switches to the <strong>Resolved</strong> state. <br><br>  It would also be nice to automatically calculate different metric data from the child elements to the parent elements.  For example, the remaining work done.  Or if there are various fields for evaluating work for testing and development, then you can automatically calculate the value of the field for the overall work. <br><h1>  Implementation </h1><br>  Yes, as you can already guess, for these purposes, you can use the server add-on for TFS 2010 - <a href="http://tfsaggregator.codeplex.com/">TFS Aggregator</a> .  Since this add-on works on the server side, the implementation of various rules will occur very quickly.  The very first processing, of course, will take 7-10 seconds, since the connection will be established and cached.  The rest of the updates are usually faster than you can upgrade your client. <br><h2>  Installation </h2><br>  TFS Aggregator consists of only two files: a task library and an XML configuration file. <br><br>  After you download the add-on and unzip it, both files must be transferred to the TFS add-ons directory.  It is usually located at: C: \ Program Files \ Microsoft Team Foundation Server 2010 \ Application Tier \ Web Services \ bin \ Plugins. <br><br>  That's all.  TFS keeps track of the specified directory, and when the file is copied, the server loads it into memory. <br><h2>  Customization </h2><br>  All settings are contained in the AggregatorItems.xml file.  This file contains information about the connection and all the rules that will be applied in the process. <br><br>  So, consider the main components of the AggregatorItems.xml file: <br><pre>  &lt;? xml version = "1.0" encoding = "utf-8"?&gt; </pre><br>  The title of the file is not worth touching and changing. <br><pre>  &lt;AggregatorItems tfsServerUrl = "http: // tfs2010dev: 8080 / tfs"&gt; </pre><br>  <strong>AggregatorItems</strong> : main element for configuration, root element. <br>  <strong>tfsServerUrl:</strong> address to the TFS server. <br><br>  This line sets the address to the TFS server.  Instead of <strong>tfs2010</strong> <strong>dev</strong> you need to write the address to your server.  At the same time there is another nuance: the address must lead to any collection of projects.  If your project is not in the default collection, which is called <strong>DefaultCollection</strong> , then you must specify the name of the collection.  For example, in my case, the project is in the MigrationProject collection, so the line will look like: <br><pre>  &lt;AggregatorItems tfsServerUrl = "http: // violet-tape-tfs: 8080 / tfs / MigrationProject"&gt; </pre><br>  The name of the collection can be found in the studio when you choose your project.  For example: <br> <a href=""><img title="01" src="https://habrastorage.org/getpro/habr/post_images/a47/d9f/b9b/a47d9fb9bb8e9c732d3c693843ed8736.png" width="267" height="207"></a> <br><pre>  &lt;AggregatorItem operationType = "Numeric" operation = "Sum" linkType = "Parent" linkLevel = "2" workItemType = "Task"&gt; </pre><br>  <strong>AggregatorItem</strong> : Indicates a rule for aggregation. <br>  <strong>operationType</strong> : Determines whether the mathematical operation will be performed or whether it will work with text variables.  Currently only two values ‚Äã‚Äãare available: Numeric or String.  Numeric is set by default.  If the type is Numeric, then the working fields must be of type double or integer. <br>  <strong>operation</strong> : Specifies which mathematical operation will be applied to the participating fields.  Currently, only addition, subtraction, multiplication, division are supported (Sum, Subtract, Multiply, Divide).  The default is to add. <br>  <strong>linkType</strong> : indicates the type of link is whether the target of the aggregation is the parent or the same element.  Respectively possible values: Self, Parent.  The default will be Self. <br>  <strong>linkLevel</strong> : If linkType is specified as Parent, then this parameter indicates how many parents go up.  The default value is one. <br>  <strong>workItemType</strong> : The name of the work item (Task, Bug, etc.) to which the rule will be applied. <br><br><pre>  &lt;TargetItem name = "Total Estimate" /&gt; </pre><br>  <strong>TargetItem</strong> : Indicates the TFS field to be updated.  In a single copy can be in the rule. <br>  <strong>name</strong> : The name of the field in TFS that is intended for the result of the aggregation. <br><br><pre>  &lt;SourceItem name = "Estimated Dev Work" /&gt; </pre><br>  <strong>SourceItem</strong> : Indicates a field in TFS that will act as a data source.  Can be used several times. <br>  <strong>name</strong> : The name of the field in the TFS from which the data will be taken. <br><br><pre>  &lt;Conditions&gt; </pre><br>  <strong>Conditions</strong> : Define conditions that must be met when an aggregation is triggered.  Optional field. <br><br><pre>  &lt;Condition leftField = "Finish Date" operator = "GreaterThan" rightValue = "$ NOW $" /&gt; </pre><br>  <strong>Condition</strong> : Specifies the condition under which the aggregation will be performed. <br>  <strong>leftField</strong> : The left operand of an expression.  The field must be of the type specified in the Target Work Item.  It is specified in the workItemType property. <br>  <strong>operator</strong> : Comparison operator.  Two EqualTo, NotEqualTo, operators are defined for strings.  Additional operators are defined for numbers: LessThan, GreaterThan, LessThanOrEqualTo, GreaterThanOrEqualTo.  EqualTo will be used by default. <br>  <strong>rightValue</strong> : The value with which the data from the leftFiled will be compared.  Either this property or rightField must be defined.  As possible macros the values ‚Äã‚Äãof $ NOW $ and $ NULL $ are defined. <br>  <strong>rightField</strong> : The field must be of the type specified in the Target Work Item.  Compares with the left operand.  Will not be used if rightValue is defined. <br><br><pre>  &lt;Mappings&gt; </pre><br>  <strong>Mappings</strong> : provides a list of values ‚Äã‚Äãfor string aggregations. <br><br><pre>  &lt;Mapping targetValue = "Done" inclusive = "And"&gt; </pre><br>  <strong>Mapping</strong> : represents a single element of a possible aggregation.  If the condition succeeds, the result of the mapping will be the entry of the value from the targetValue to the TargetItem for the AggregationItem. <br>  <strong>targetValue</strong> : The value to be used for the replacement. <br>  <strong>Inclusive</strong> : This parameter is responsible for whether all (And) or any one (Or) value should be met from the SourceValue set in order for the mapping to work. <br><br><pre>  &lt;SourceValue&gt; Removed &lt;/ SourceValue&gt; </pre><br>  <strong>SourceValue</strong> : possible values ‚Äã‚Äãthat the mapping must satisfy to trigger. <br><br><br>  It should be noted here that when mentioning the field name from the work item, it is necessary to write just the short name, and not with the namespace. <br><br>  This definition is complete, and we can consider specific examples. <br><h1>  Examples </h1><br>  You can start with an example about switching history to WIP.  The example is based on a diagram from recent articles. <br><pre>  &lt;AggregatorItem operationType = "String" linkType = "Parent" linkLevel = "1" workItemType = "Task"&gt;
    &lt;TargetItem name = "State" /&gt;
    &lt;SourceItem name = "State" /&gt;
    &lt;Mappings&gt;
       &lt;Mapping targetValue = "WIP" inclusive = "Or"&gt;
          &lt;SourceValue&gt; Active &lt;/ SourceValue&gt;
       &lt;/ Mapping&gt;
    &lt;/ Mappings&gt;
 &lt;/ AggregatorItem&gt; </pre><br>  It indicates that the work will be done with strings, with the parent element, the changes will begin at the Task level.  The source of data for analyzing the changes will be the State ( <em>SourceItem</em> ) field of the Task item ( <em>workItemType</em> ), the assignment is also the State field ( <em>TargetItem</em> ), but the parent element ( <em>linkType</em> ).  In this case, the parents can be either UserStory, or Bug, or some other element.  The mapping section describes that the value should change to <strong>WIP</strong> ( <em>targetValue</em> ) if the value in the resource has become <strong>Acitve.</strong> <br><br>  It is important to understand that the conditions of the state transition will still be checked by internal TFS tools.  It will not be possible to go from one state to another if such a transition is not described in the scheme.  You cannot move from one state to another unless the conditions for the transition are not met, such as the filled Description field or the Story Points.  Those.  it does not overdrive and overwrite workflow conditions.  The final state should be achievable from the specified, taking into account all the rules. <br><br>  Honestly, with this particular transition, I reset the value of the AssignedTo field to NETWORK SERVICE, but with other automated transitions this does not happen.  Miracles!  I hope that the developers will help me in this problem, and I will tell you what was wrong. <br><br>  Another example is the transition of a story to the Resloved state when all tasks have been completed. <br><pre>&nbsp;

 &lt;AggregatorItem operationType = "String" linkType = "Parent" linkLevel = "1" workItemType = "Task"&gt;
    &lt;TargetItem name = "State" /&gt;
    &lt;SourceItem name = "State" /&gt;
    &lt;Mappings&gt;
       &lt;Mapping targetValue = "Resolved" inclusive = "And"&gt;
          &lt;SourceValue&gt; Resolved &lt;/ SourceValue&gt;
          &lt;SourceValue&gt; Closed &lt;/ SourceValue&gt;
          &lt;SourceValue&gt; Abandoned &lt;/ SourceValue&gt;
       &lt;/ Mapping&gt;
    &lt;/ Mappings&gt;
 &lt;/ AggregatorItem&gt; </pre><br>  It indicates that the work will be done with strings, with the parent element, the changes will begin at the Task level.  The source of data for analyzing the changes will be the State (SourceItem) field of the Task item (workItemType), the assignment is also the State field (TargetItem), but the parent element (linkType).  The mapping section describes that the value should change to Resolved (targetValue) if the value in the resource has become <em>either</em> Resolved, Closed, <em>or</em> Abandoned. <br><br>  These examples have been earned by me with a bang, and it is very nice that they are, fewer actions will now have to be performed when working with tasks. <br><br>  I did not check the following group of examples, but there are no particular doubts about their performance. <br><br>  The following example automatically calculates the total estimated work of developers and testers.  The result is recorded in the Estimated Work field in the very element of the Task type. <br><pre>  &lt;AggregatorItem operationType = "Numeric" operation = "Sum" linkType = "Self" workItemType = "Task"&gt;
    &lt;TargetItem name = "Estimated Work" /&gt;
    &lt;SourceItem name = "Estimated Dev Work" /&gt;
    &lt;SourceItem name = "Estimated Test Work" /&gt;
 &lt;/ AggregatorItem&gt; </pre><br>  More examples on the developers page, but they are all in the same spirit. <br><h1>  In the plans </h1><br>  Plans for developers as great, although the project is done in his spare time.  So, in the near future plans to make the possibility of aggregation from parent to descendants.  In this situation it will be, for example, easier to change the IterationPath and other things that are inherited / copied from the parent when created. <br><br>  Consider the option of creating the AggregatorItems file editor. <br><br>  Also in the plans to make it possible to specify more than one item for workItemType. <br><br>  Make it possible to use the difference of values ‚Äã‚Äãin conditions, for example Today - 5 days.  The same plan includes the possibility of using arbitrary coefficients in formulas.  At the moment this is not possible, since the plugin code will search for fields with the name of the coefficient value. <br><br>  Find a good way to not re-run the conditions from the AggregatorItems file.  Suppose some rule worked successfully, which resulted in changes that trigger the rule again.  This time the change is no longer happening and everything is fine.  This is certainly not fatal, since the result is still true, but unnecessary actions are straining. <br><h1>  If not earned plugin </h1><br>  You have successfully unpacked everything, installed it in the correct directory, edited the settings file as necessary and did not work ... <br><br>  Well, below is a small checklist to check if everything is actually done correctly: <br><ul><li>  You are using TFS 2010. </li><li>  Are all elements mentioned in the aggregation rules containing Parent-Child links? </li><li>  You have updated the item that requires the rule to be executed.  TFS Aggregation is triggered only when the element has been updated and the rule has been able to determine this and all conditions have worked.  In the future, perhaps this behavior will change. </li><li>  You updated the AggregatorItems.xml file and set the correct address to your server.  In this case, do not forget about the name of the collection of projects. </li><li>  You copied both the dll and AggregatorItems.xml file into the plug-in directory for TFS. </li><li>  You have specified the correct names of the elements, sources, and data sinks. </li><li>  Settings file saved in utf-8 encoding.  Notepad ++ calls her "utf-8 without BOM".  This in general should not be critical, but nonetheless. </li></ul><br>  In any case, if nothing works at all, make some simple rules file and try again. <br><br>  If it does not work in this case, it is recommended that you export the settings for the work items and the AggregatorItems.xml file to the developers at <a href="">TFSAggregatorIssues@spamex.com</a> . <br><h1>  Total </h1><br>  I really liked the plugin, I set it up for my needs and now I am happy with the way it works.  It remains only to receive information from the developers about the change of the field AssignedTo and everything will be very good. </div><p>Source: <a href="https://habr.com/ru/post/147640/">https://habr.com/ru/post/147640/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../147634/index.html">Mysterious case in the New York subway</a></li>
<li><a href="../147635/index.html">Interview with the owner of the botnet</a></li>
<li><a href="../147636/index.html">Social Engineering at PHDays 2012</a></li>
<li><a href="../147638/index.html">RIM CEO: BlackBerry 10 porting is good</a></li>
<li><a href="../147639/index.html">Enterprise 2.0 for Dummies</a></li>
<li><a href="../147641/index.html">Compaq Descpro and NetBSD 1.6.1</a></li>
<li><a href="../147643/index.html">Yahoo passwords have leaked to the network</a></li>
<li><a href="../147644/index.html">Law 89417-6: Get a public base of illegal content?</a></li>
<li><a href="../147645/index.html">2GIS +1: data and functions in exchange for an audience</a></li>
<li><a href="../147647/index.html">20 things I should have known at 20</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>