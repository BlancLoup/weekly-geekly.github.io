<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learn PowerShell to talk</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In many science fiction films, people interact with computers using voice commands. For example, a person enters a room and it is dark there. ‚ÄúCompute...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learn PowerShell to talk</h1><div class="post__text post__text-html js-mediator-article">  In many science fiction films, people interact with computers using voice commands.  For example, a person enters a room and it is dark there.  ‚ÄúComputer, light 50%!‚Äù He says.  ‚ÄúThere is a light of 50%!‚Äù - responds with a pleasant female contralto computer and takes under the visor, including dim light.  Who did not want this?  But if the very idea of ‚Äã‚Äãsuch an interaction was born a long time ago, wandering through the pages of fantastic books and frames of films, now everything has changed: the availability of high technologies at hand has made a lot possible.  In Robert Heinlein's novel The Moon is a Severe Mistress (1966), Mike could speak freely, but he occupied a huge amount of space and, of course, was not mobile.  The hero of my story can not boast the perfect pronunciation or the ability to maintain a dialogue, but, for its size, it is very capable.  Of course, I'm talking about the Asus EeePC 1000 netbook. <br><a name="habracut"></a><br>  Not so long ago I installed a new MS Windows 7 RC operating system on it and could not get acquainted with what was offered in the kit.  My biggest interest was the PowerShell command line and PowerShell ISE.  Somewhere on the Internet there are a variety of cmdlets to perform almost any task, including speech reproduction.  But I wanted to implement everything through a normal function, so as not to be dependent on the installed cmdlets.  They, in the end, may not be on a specific computer, and copying a profile is a matter of minutes.  In addition, the recent disappearance story in the new build, for example, the Get-Clipboard cmdlet for working with the clipboard, is alarming about the excessive use of rare cmdlets.  But the .NET classes are not going anywhere, although access to them may not be the easiest either: in this case you have to start the console in -sta mode in order to be able to work with the clipboard. <br><br>  I use the function name prefix from one of my nicknames in order to be able to auto-complete quickly to get to the self-written functions by entering just three characters: they are not found anywhere else in PowerShell commands. <br><br>  <strong>Well, actually, the implementation itself:</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">function astSpeak([ <font color="#0000ff">string</font> ]$inputString, [ <font color="#0000ff">int</font> ]$speed = -2, <br> [ <font color="#0000ff">int</font> ]$engine = 0, [ <font color="#0000ff">switch</font> ]$file, <br> [ <font color="#0000ff">switch</font> ]$list, [ <font color="#0000ff">switch</font> ]$buffer, <br> [ <font color="#0000ff">int</font> ]$volume = 85) <br> { <br> #   <br> $oVoice = New-Object -com <font color="#A31515">"SAPI.spvoice"</font> <br> <br> #      <br> <font color="#0000ff">if</font> ($list) <br> { <br> Write-Output <font color="#A31515">"   : "</font> <br> $i = 0 <br> Foreach ($Token <font color="#0000ff">in</font> $oVoice.getvoices()) <br> { <br> Write-Host $i - $Token.getdescription() <br> $i++ <br> } <br> } <br> #    <br> <font color="#0000ff">else</font> <br> { <br> #    ,    <br> <font color="#0000ff">if</font> ($file){ $toSpeechText = Get-Content $inputString} <br> #      (  sta) <br> elseif($buffer){ <br> $ <font color="#0000ff">null</font> = [reflection. <font color="#2B91AF">Assembly</font> ]::LoadWithPartialName( <font color="#A31515">"System.Windows.Forms"</font> ) <br> $toSpeechText = [Windows.Forms.Clipboard]::GetText() } <br> #   ,     <br> <font color="#0000ff">else</font> { $toSpeechText = $inputString} <br> <br> #  <br> $oVoice.rate = $speed <br> $oVoice.volume = $volume <br> $oVoice.voice = $oVoice.getvoices().item($engine) <br> $oVoice.Speak($toSpeechText) <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  <strong>What can function?</strong> <br><br>  You can display a list of votes set in the system.  There is a fairly large number of various voices, including those who can read the Russian text.  I have the voice of Alena as the main one, who quite successfully passed the test by reading articles from Wikipedia and fiction.  For the latter, Harry Harrison‚Äôs short, ironic story Absolute Weapon, taken at the Moshkov Library, was used.  Thanks to the voice, it was immediately possible to find a few typos in the text and understand the necessity of placing the letter ‚Äúe‚Äù, otherwise the reading was impressive.  So, to get a list of voice engines, you need to call: <br><br>  <em><font color="#ff0000">astSpeak -l</font></em> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a2/401/9f8/5a24019f8500d7ad3e8bd8be6e5b68c4.jpg" alt="image"><br><br>  You can read any given text, well, this is the simplest. <br><br>  <em><font color="#ff0000">astSpeak "Hi!</font></em>  <em><font color="#ff0000">My name is Alena, I am the voice of your computer! ‚Äù</font></em> <br><br>  Can read text file.  To do this, specify the appropriate key and the path to the desired file.  For example: <br><br>  <em><font color="#ff0000">astSpeak -f "D: \ Library \ Redyard Kipling \ Commandment.txt"</font></em> <br><br>  Yes ... I guess, we won't trust Alena anymore :) <br><br>  You can read the text contained in the clipboard.  With the implementation of this, there are some difficulties, since the special cmdlet was excluded from the PowerShell delivery package, and you can access the buffer using .NET only in the sta (Single Threading Apartment) mode, and the PowerShell console starts in mta mode by default.  In mta mode, the default ise.  But this is not a problem, it is enough to register the corresponding key in the properties of the console shortcut: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cdf/b38/13c/cdfb3813cadcb2075c0092cb94abf79a.jpg" alt="image"><br><br>  So, if the console mode allows, it will look like this: <br><br>  <em><font color="#ff0000">astSpeak -b</font></em> <br><br>  The worst thing is if there was a URL. <br><br>  When you call any mode that involves the reproduction of speech (well, that is, in addition to the enumeration of voice engines), you can also set the speed of speech, voice volume and the number of the sound engine.  For example, to hear the word ‚Äúhello‚Äù by Katerina (engine number 1), the volume set to 85/100 and with a slightly increased speed, you need to enter the following command. <br><br>  <em><font color="#ff0000">astSpeak -e 1 -v 85 -s 3 "Hi"</font></em> <br><br>  In general, everything is really simple!  If you have any comments, tips or you know how to improve it all, I will be very happy to hear from you.  And ... with the first topic on me!  :) <br></div><p>Source: <a href="https://habr.com/ru/post/60965/">https://habr.com/ru/post/60965/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../60956/index.html">Deferred for Javascript (Prototype)</a></li>
<li><a href="../60957/index.html">Optimization micropatterns in Javascript: debouncing and throttling function decorators</a></li>
<li><a href="../60960/index.html">Blocking unnecessary people using the site</a></li>
<li><a href="../60961/index.html">Wiki tutorial on web technologies</a></li>
<li><a href="../60962/index.html">How many seats in the European Parliament can get The Pirate Party?</a></li>
<li><a href="../60966/index.html">Presentations</a></li>
<li><a href="../60969/index.html">A couple of differences between the data object field and the Java Bean property</a></li>
<li><a href="../60972/index.html">Applications for Windows7. Gmail Notifier Plus 1.2</a></li>
<li><a href="../60974/index.html">HA cluster, file systems replicated over the network</a></li>
<li><a href="../60976/index.html">Yandex now shows bad sites!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>