<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Features of national automation MS Excel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is not a secret for anyone that there are programs that work well with the English ‚Äúculture‚Äù and start ‚Äúbuggy‚Äù when it comes to national ‚Äúcultures‚Äù...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Features of national automation MS Excel</h1><div class="post__text post__text-html js-mediator-article">  It is not a secret for anyone that there are programs that work well with the English ‚Äúculture‚Äù and start ‚Äúbuggy‚Äù when it comes to national ‚Äúcultures‚Äù.  Upon closer examination, it turned out that MS Excel office software is just one of these numbers.  How to bypass some of the "features" of MS Excel and will be discussed in this article. <br><a name="habracut"></a><br><h5>  Formulation of the problem </h5>  There is a Windows 7 operating system with Russian regional settings and an English-language MS Office 2010. It is required to collect information about the currently running system processes and create an Excel table based on them.  And for greater clarity, and even build a pie chart.  We will solve the problem using MS PowerShell. <br><br><h5>  Decision </h5>  So let's start first with collecting information about the OS processes and creating an Excel.Application object: <br><blockquote>  <font color="#000088">$ processes</font> <font color="#339933">=</font> Get <font color="#339933">-</font> WmiObject <font color="#339933">-</font> <font color="#000000">Class</font> Win32_Process <font color="#666666"># List of running processes</font> <font color="#666666"><br></font>  <font color="#000088">$ excel</font> <font color="#339933">=</font> New <font color="#339933">-</font> Object <font color="#339933">-</font> ComObject Excel <font color="#339933">.</font>  Application <br>  <font color="#000088">$ excel</font> <font color="#339933">.</font>  SheetsInNewWorkbook <font color="#339933">=</font> <font color="#cc66cc">1</font> <font color="#666666"># The number of sheets in the newly created Excel workbook (default 3)</font> </blockquote><br>  If you now run these three lines, then, due to the discrepancy between the regional settings of the OS and MS Office, a ‚Äúmysterious‚Äù message will appear on the screen: ‚ÄúException setting‚Äú SheetsInNewWorkbook ‚Äù:‚Äú Old format or invalid type library.  (Exception from HRESULT: 0x80028018 (TYPE_E_INVDATAREAD)) "".  This is solved simply - the current regional settings should be set to en-US: <br><blockquote>  <font color="#666666"># Save the previous value of the regional settings</font> <font color="#666666"><br></font>  <font color="#000088">$ OldCulture</font> <font color="#339933">=</font> <font color="#009900">[</font> <font color="#990000">System</font> <font color="#339933">.</font>  Threading  Thread <font color="#009900">]</font> <font color="#339933">::</font> <font color="#004000">CurrentThread</font> <font color="#339933">.</font>  CurrentCulture <br>  <font color="#000088">$ culture</font> <font color="#339933">=</font> <font color="#009900">[</font> <font color="#990000">System</font> <font color="#339933">.</font>  Globalization <font color="#339933">.</font>  CultureInfo <font color="#009900">]</font> <font color="#0000ff">"en-US"</font> <font color="#666666"># Setting the regional settings en-US</font> <font color="#666666"><br></font>  <font color="#666666"># Block that will be executed if an error occurs somewhere in this script</font> <font color="#666666"><br></font>  trap <br>  <font color="#009900">{</font> <br>  <font color="#666666">************************************************* *******************************</font> <font color="#666666"><br></font>  <font color="#666666"># **** Here will be the code necessary for the correct completion of the script ***</font> <font color="#666666"><br></font>  <font color="#666666">************************************************* *******************************</font> <font color="#666666"><br></font>  <font color="#666666"># Restore the previous regional settings and finish the script</font> <font color="#666666"><br></font>  <font color="#009900">[</font> <font color="#990000">System</font> <font color="#339933">.</font>  Threading  Thread <font color="#009900">]</font> <font color="#339933">::</font> <font color="#004000">CurrentThread</font> <font color="#339933">.</font>  CurrentCulture <font color="#339933">=</font> <font color="#000088">$ OldCulture</font> <font color="#339933">;</font>  <font color="#b1b100">break</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">[</font> <font color="#990000">System</font> <font color="#339933">.</font>  Threading  Thread <font color="#009900">]</font> <font color="#339933">::</font> <font color="#004000">CurrentThread</font> <font color="#339933">.</font>  CurrentCulture <font color="#339933">=</font> <font color="#000088">$ culture</font> <font color="#666666"># Applying new regional settings</font> </blockquote><br>  After that, we write the previous three commands, make the created instance of Excel visible, create a new workbook: <br><blockquote>  <font color="#000088">$ excel</font> <font color="#339933">.</font>  visible <font color="#339933">=</font> <font color="#000088">$ true</font> <br>  <font color="#000088">$ workbook</font> <font color="#339933">=</font> <font color="#000088">$ excel</font> <font color="#339933">.</font>  workbooks <font color="#339933">.</font>  add <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#000088">$ workbook</font> <font color="#339933">.</font>  worksheets <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#cc66cc">1</font> <font color="#009900">)</font> <font color="#339933">.</font>  Name <font color="#339933">=</font> <font color="#0000ff">"Processes"</font> <font color="#666666"># Rename the single table for convenience</font> <font color="#666666"><br></font>  <font color="#000088">$ sheet</font> <font color="#339933">=</font> <font color="#000088">$ workbook</font> <font color="#339933">.</font>  worksheets <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#0000ff">"Processes"</font> <font color="#009900">)</font> <font color="#666666"># Select the table ‚ÄúProcesses‚Äù (we get a link to it)</font> </blockquote><br>  The necessary table is created, now we will be engaged in its registration.  The first line of the table will contain the heading.  To visually separate it from the rest of the table, select the property names in bold and draw a header frame.  For this purpose we will use the xLineStyle, xlColorIndex and xlBorderWeight enumerations.  We need the xlChartType enumeration to form a pie chart.  To further simplify your life, create pseudonyms for each of the four types of enumerations used.  To do this, convert the string, which is the name of the enumeration type, to type ([type]): <br><blockquote>  <font color="#000088">$ row</font> <font color="#339933">=</font> <font color="#cc66cc">2</font> <font color="#666666"># The first row of the table is busy, so the data will be written from the second row</font> <font color="#666666"><br></font> <br>  <font color="#000088">$ lineStyle</font> <font color="#339933">=</font> <font color="#0000ff">"microsoft.office.interop.excel.xlLineStyle"</font> <font color="#339933">-</font> <font color="#b1b100">as</font> <font color="#009900">[</font> type <font color="#009900">]</font> <br>  <font color="#000088">$ colorIndex</font> <font color="#339933">=</font> <font color="#0000ff">"microsoft.office.interop.excel.xlColorIndex"</font> <font color="#339933">-</font> <font color="#b1b100">as</font> <font color="#009900">[</font> type <font color="#009900">]</font> <br>  <font color="#000088">$ borderWeight</font> <font color="#339933">=</font> <font color="#0000ff">"microsoft.office.interop.excel.xlBorderWeight"</font> <font color="#339933">-</font> <font color="#b1b100">as</font> <font color="#009900">[</font> type <font color="#009900">]</font> <br>  <font color="#000088">$ chartType</font> <font color="#339933">=</font> <font color="#0000ff">"microsoft.office.interop.excel.xlChartType"</font> <font color="#339933">-</font> <font color="#b1b100">as</font> <font color="#009900">[</font> type <font color="#009900">]</font> </blockquote><br>  Format the first row of the table: <br><blockquote>  <font color="#b1b100">for</font> <font color="#009900">(</font> <font color="#000088">$ b</font> <font color="#339933">=</font> <font color="#cc66cc">1</font> <font color="#339933">;</font> <font color="#000088">$ b</font> <font color="#339933">-</font> le <font color="#cc66cc">2</font> <font color="#339933">;</font> <font color="#000088">$ b</font> <font color="#339933">++</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  <font color="#000088">$ sheet</font> <font color="#339933">.</font>  cells <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#cc66cc">1</font> <font color="#339933">,</font> <font color="#000088">$ b</font> <font color="#009900">)</font> <font color="#339933">.</font>  font <font color="#339933">.</font>  bold <font color="#339933">=</font> <font color="#000088">$ true</font> <br>  <font color="#000088">$ sheet</font> <font color="#339933">.</font>  cells <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#cc66cc">1</font> <font color="#339933">,</font> <font color="#000088">$ b</font> <font color="#009900">)</font> <font color="#339933">.</font>  borders <font color="#339933">.</font>  LineStyle <font color="#339933">=</font> <font color="#000088">$ lineStyle</font> <font color="#339933">::</font> <font color="#004000">xlDashDot</font> <br>  <font color="#000088">$ sheet</font> <font color="#339933">.</font>  cells <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#cc66cc">1</font> <font color="#339933">,</font> <font color="#000088">$ b</font> <font color="#009900">)</font> <font color="#339933">.</font>  borders <font color="#339933">.</font>  ColorIndex <font color="#339933">=</font> <font color="#000088">$ colorIndex</font> <font color="#339933">::</font> <font color="#004000">xlColorIndexAutomatic</font> <br>  <font color="#000088">$ sheet</font> <font color="#339933">.</font>  cells <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#cc66cc">1</font> <font color="#339933">,</font> <font color="#000088">$ b</font> <font color="#009900">)</font> <font color="#339933">.</font>  borders <font color="#339933">.</font>  weight <font color="#339933">=</font> <font color="#000088">$ borderWeight</font> <font color="#339933">::</font> <font color="#004000">xlMedium</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#666666"># Let's give meaningful names to table columns</font> <font color="#666666"><br></font>  <font color="#000088">$ sheet</font> <font color="#339933">.</font>  cells <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#cc66cc">1</font> <font color="#339933">,</font> <font color="#cc66cc">1</font> <font color="#009900">)</font> <font color="#339933">=</font> <font color="#0000ff">"Name of Process"</font> <br>  <font color="#000088">$ sheet</font> <font color="#339933">.</font>  cells <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#cc66cc">1</font> <font color="#339933">,</font> <font color="#cc66cc">2</font> <font color="#009900">)</font> <font color="#339933">=</font> <font color="#0000ff">"Working Set Size"</font> </blockquote><br>  Now we will place the information about the processes stored in the $ processes variable into the corresponding cells of the table.  Arrange a loop to bypass the collection of process information.  The $ process loop variable will store the current item in the collection.  From it in the first column we place the name of the process, and in the second - the value of the property workingSetSize. <br><blockquote>  <font color="#b1b100">foreach</font> <font color="#009900">(</font> <font color="#000088">$ process</font> in <font color="#000088">$ processes</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  <font color="#000088">$ sheet</font> <font color="#339933">.</font>  cells <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#000088">$ row</font> <font color="#339933">,</font> <font color="#cc66cc">1</font> <font color="#009900">)</font> <font color="#339933">=</font> <font color="#000088">$ process</font> <font color="#339933">.</font>  name <br>  <font color="#000088">$ sheet</font> <font color="#339933">.</font>  cells <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#000088">$ row</font> <font color="#339933">,</font> <font color="#cc66cc">2</font> <font color="#009900">)</font> <font color="#339933">=</font> <font color="#000088">$ process</font> <font color="#339933">.</font>  workingSetSize 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <font color="#000088">$ x</font> <font color="#339933">++</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#666666"># Adjust the width of the columns according to the content</font> <font color="#666666"><br></font>  <font color="#000088">$ range</font> <font color="#339933">=</font> <font color="#000088">$ sheet</font> <font color="#339933">.</font>  usedRange <br>  <font color="#000088">$ range</font> <font color="#339933">.</font>  EntireColumn <font color="#339933">.</font>  AutoFit <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">|</font>  Out <font color="#339933">-</font> <font color="#009900">Null</font> </blockquote><br>  It's time to add a chart to the workbook.  The workbook function ‚Äúcharts.add ()‚Äù will add a bar chart by default.  And in order to get the diagram of the desired type, you need to set the value of the enumeration that determines the type of diagram.  Choose one of the possible values ‚Äã‚Äãof the $ chartType type - xl3DPieExploded (three-dimensional split pie chart).  As the data source for the chart, set the range defined in the $ range variable. <br><blockquote>  <font color="#000088">$ workbook</font> <font color="#339933">.</font>  charts <font color="#339933">.</font>  add <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">|</font>  Out <font color="#339933">-</font> <font color="#009900">Null</font> <br>  <font color="#000088">$ workbook</font> <font color="#339933">.</font>  charts <font color="#339933">.</font>  item <font color="#009900">(</font> <font color="#cc66cc">1</font> <font color="#009900">)</font> <font color="#339933">.</font>  Name <font color="#339933">=</font> <font color="#0000ff">"Working Set Size"</font> <br>  <font color="#000088">$ workbook</font> <font color="#339933">.</font>  ActiveChart <font color="#339933">.</font>  chartType <font color="#339933">=</font> <font color="#000088">$ chartType</font> <font color="#339933">::</font> <font color="#004000">xl3DPieExploded</font> <br>  <font color="#000088">$ workbook</font> <font color="#339933">.</font>  ActiveChart <font color="#339933">.</font>  SetSourceData <font color="#009900">(</font> <font color="#000088">$ range</font> <font color="#009900">)</font> </blockquote><br>  Now, for more effect, let's twist the created diagram by 360 degrees in increments of 15 degrees: <br><blockquote>  <font color="#b1b100">for</font> <font color="#009900">(</font> <font color="#000088">$ i</font> <font color="#339933">=</font> <font color="#cc66cc">1</font> <font color="#339933">;</font> <font color="#000088">$ i</font> <font color="#339933">-</font> le <font color="#cc66cc">360</font> <font color="#339933">;</font> <font color="#000088">$ i</font> <font color="#339933">+ =</font> <font color="#cc66cc">15</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  <font color="#000088">$ workbook</font> <font color="#339933">.</font>  ActiveChart <font color="#339933">.</font>  rotation <font color="#339933">=</font> <font color="#000088">$ i</font> <br>  <font color="#009900">}</font> </blockquote><br>  In order that all this beauty is not lost, you need to save the created book.  First, check for the presence of a table with the same name using the Test-Path cmdlet.  If we find such a table, we will delete the old file using a Remove-Item, and then we will save the current workbook where the $ strPath variable points. <br><blockquote>  <font color="#000088">$ strPath</font> <font color="#339933">=</font> <font color="#0000ff">"path <font color="#000099">\ t</font> o <font color="#000099">\ f</font> ile <font color="#000099">\ f</font> ile_name.xlsx"</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> Test <font color="#339933">-</font> Path <font color="#000088">$ strPath</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  Remove <font color="#339933">-</font> Item <font color="#000088">$ strPath</font> <br>  <font color="#009900">}</font> <br>  <font color="#000088">$ excel</font> <font color="#339933">.</font>  ActiveWorkbook <font color="#339933">.</font>  SaveAs <font color="#009900">(</font> <font color="#000088">$ strPath</font> <font color="#009900">)</font> </blockquote><br>  Now Excel needs to close.  To do this, first free the occupied resources ($ sheet, $ range), close the workbook, and then Excel itself. <br><blockquote>  <font color="#000088">$ sheet</font> <font color="#339933">=</font> <font color="#000088">$ null</font> <br>  <font color="#000088">$ range</font> <font color="#339933">=</font> <font color="#000088">$ null</font> <br><br>  <font color="#000088">$ workbook</font> <font color="#339933">.</font>  Close <font color="#009900">(</font> <font color="#000088">$ false</font> <font color="#009900">)</font> <br>  <font color="#000088">$ excel</font> <font color="#339933">.</font>  Quit <font color="#009900">(</font> <font color="#009900">)</font> </blockquote><br>  And everything would be fine, but if you now look in the task manager, you will see that the Excel process is still ‚Äúhanging out‚Äù there.  It is at least not beautiful.  To prevent this, we will force the garbage collector to force, having previously reset the $ excel variable.  And, of course, we will restore the old regional settings. <br><blockquote>  <font color="#000088">$ excel</font> <font color="#339933">=</font> <font color="#000088">$ null</font> <br>  <font color="#009900">[</font> GC <font color="#009900">]</font> <font color="#339933">::</font> <font color="#004000">Collect</font> <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#009900">[</font> GC <font color="#009900">]</font> <font color="#339933">::</font> <font color="#004000">WaitForPendingFinalizers</font> <font color="#009900">(</font> <font color="#009900">)</font> <br><br>  <font color="#666666"># Restoring previous regional settings</font> <font color="#666666"><br></font>  <font color="#009900">[</font> <font color="#990000">System</font> <font color="#339933">.</font>  Threading  Thread <font color="#009900">]</font> <font color="#339933">::</font> <font color="#004000">CurrentThread</font> <font color="#339933">.</font>  CurrentCulture <font color="#339933">=</font> <font color="#000088">$ OldCulture</font> </blockquote><br>  For more convenience, you can make $ strPath a parameter, and copy everything (with lyrical digressions) into one ps1 file.  So, copied and ... run!  And it works!  Yes, and as expected!  But only until such time as an error pops up somewhere inside this file ... <br>  The office will go to the ‚Äútrap‚Äù block, and there, for the time being, apart from the return of the previous regional settings, there is nothing.  Therefore, an unfinished Excel book will remain on the screen after a crash, and when it closes, Excel will remain in the list of running processes.  Not a very bright prospect, is it? <br>  So, to avoid this, add the following trap to the block (instead of the comment with the line ‚ÄúThere will be ...‚Äù): <br><blockquote> <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#000088">$ workbook</font> <font color="#339933">-</font> ne <font color="#000088">$ null</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  <font color="#000088">$ sheet</font> <font color="#339933">=</font> <font color="#000088">$ null</font> <br>  <font color="#000088">$ range</font> <font color="#339933">=</font> <font color="#000088">$ null</font> <br><br>  <font color="#000088">$ workbook</font> <font color="#339933">.</font>  Close <font color="#009900">(</font> <font color="#000088">$ false</font> <font color="#009900">)</font> <br>  <font color="#009900">}</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#000088">$ excel</font> <font color="#339933">-</font> ne <font color="#000088">$ null</font> <font color="#009900">)</font> <br>  <font color="#009900">{</font> <br>  <font color="#000088">$ excel</font> <font color="#339933">.</font>  Quit <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#000088">$ excel</font> <font color="#339933">=</font> <font color="#000088">$ null</font> <br>  <font color="#009900">[</font> GC <font color="#009900">]</font> <font color="#339933">::</font> <font color="#004000">Collect</font> <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#009900">[</font> GC <font color="#009900">]</font> <font color="#339933">::</font> <font color="#004000">WaitForPendingFinalizers</font> <font color="#009900">(</font> <font color="#009900">)</font> <br>  <font color="#009900">}</font> </blockquote></div><p>Source: <a href="https://habr.com/ru/post/120383/">https://habr.com/ru/post/120383/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../120375/index.html">Patterns of Command and Strategy in terms of functional programming</a></li>
<li><a href="../120377/index.html">New in Windows Azure Development Center on MSDN</a></li>
<li><a href="../120378/index.html">Dropbox - we get an additional 9 GB in one day</a></li>
<li><a href="../120380/index.html">Password protection for transmission over an open channel (part 1)</a></li>
<li><a href="../120382/index.html">Social Media Monitoring</a></li>
<li><a href="../120384/index.html">3D illusions</a></li>
<li><a href="../120386/index.html">Blackberry Playbook interaction with Blackberry phone</a></li>
<li><a href="../120387/index.html">Application of SharePoint in the Russian web development market</a></li>
<li><a href="../120388/index.html">PDF generation with Prawn</a></li>
<li><a href="../120389/index.html">The hard life of anti-spam or as it actually happens</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>