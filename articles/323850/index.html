<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to add reference tables in the Advanced Reporting Tool</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Simplified SIEM-system Advanced Reporting Tool allows you to add custom reference tables for customizing reports in accordance with the needs of the e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to add reference tables in the Advanced Reporting Tool</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/b1b/78d/4a2/b1b78d4a24ec4a4d883816dbd2aa3347.jpg"><br><br>  Simplified SIEM-system Advanced Reporting Tool allows you to add custom reference tables for customizing reports in accordance with the needs of the enterprise.  Consider how this can be done. <a name="habracut"></a><br><br>  Today we will talk in detail about how you can customize reports in the simplified SIEM-system <a href="https://habrahabr.ru/company/panda/blog/312544/">Advanced Reporting Tool (ART)</a> using reference tables.  This may be required when you need to add certain characteristics of the analyzed corporate network, for example: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ‚Ä¢ Link IP addresses to business units and remote offices or geographic location <br>  ‚Ä¢ Highlight corporate and non-corporate applications <br>  ‚Ä¢ Specify the end points of VIP employees (management, accounting, etc.) <br><br>  To do this, we need to provide the SIEM system with a user reference table prepared with the following aspects in mind: <br><br>  ‚Ä¢ File format: comma-delimited CSV <br>  ‚Ä¢ No special characters <br>  ‚Ä¢ First row with column names in English <br>  ‚Ä¢ Maximum size: 2 GB <br>  ‚Ä¢ Primary key column <br>  ‚Ä¢ Additional columns allowed <br><br>  As an example, consider the situation when we decided to organize all executable files into categories with reference to the manufacturer.  For this we will use the file <a href="https://pandasecurity.bitrix24.ru/~3mSiS">Executable_Category.csv</a> .  Below is a fragment of the contents of this file: <br><br><img src="https://habrastorage.org/files/755/728/6a2/7557286a2fb34b889f2abc906eb4ac86.JPG"><br><br>  The <b>Service</b> column will play the role of a primary key column. <br><br>  So let's get started. <br><br>  If you want to simultaneously perform these actions in parallel, then you can do it in the demo console of the product, which requires only the Google Chrome or Mozilla Firefox browser to be used. <br><br>  URL: <a href="http://demologin.pandasecurity.com/">demologin.pandasecurity.com</a> <br>  Login: DRUSSIAN_FEDERATION_C16@panda.com <br>  Password: DRUSSIAN # 123 <br><br>  After entering the Panda Adaptive Defense product demo console, at the top of the console you need to click on the <b>Advanced Search</b> button to switch to the Advanced Reporting Tool SIEM system. <br><br>  Entering the ART interface, click on the <b>Search</b> icon, and on the page that opens, click on the <b>Lookup Management</b> tab. <br><br><img src="https://habrastorage.org/files/745/7e2/953/7457e295358b4ed285fe07da784db84d.jpg"><br><br>  The page that opens will display a list of user reference tables (perhaps it will be empty).  In the upper right corner, click on the <b>New Lookup</b> button to load our table. <br><br><img src="https://habrastorage.org/files/ed8/9ee/da4/ed89eeda46a643a4a7616b322aa21cea.jpg"><br><br>  In the form that appears, specify the name of the table ( <b>Table name</b> ) and select the file ( <b>Choose File</b> ).  After checking the file, a list of file columns will appear, in which you need to check that the <b>Is Key</b> label is specified for the <b>Service</b> column.  Click the <b>Upload</b> button. <br><br><img src="https://habrastorage.org/files/f82/677/f30/f82677f309574a309a040d54c3175348.jpg"><br><br>  Click the <b>Upload</b> button and wait for about 10 minutes to refresh the table with the reference tables. <br><br><img src="https://habrastorage.org/files/810/33e/e33/81033ee33ba9429dabfc80fbff85f2a5.jpg"><br><br>  To download an updated version of this table, delete it, or check its structure, you can click on the options button (...). <br><br><img src="https://habrastorage.org/files/4d2/3d8/8d3/4d23d88d3e3c410b91e7674207f7ee02.jpg"><br><br>  Now let's go to the Ops table in ART: click on the <b>Search</b> icon <img src="https://habrastorage.org/files/36d/5fe/b9f/36d5feb9f81f4464a50f27cd158c0984.jpg"><br><br>  In the right section, click on <b>Ops.</b> <br><br><img src="https://habrastorage.org/files/752/5aa/f0e/7525aaf0ef0a4b778d402cd2273774ae.jpg"><br><br>  On the page that opens in the control panel above, click on the <b>Create Column</b> icon: <br><br><img src="https://habrastorage.org/files/050/f18/907/050f18907c0d4c1085b00d6e7b33aaeb.jpg">  and select the <b>Filter Data</b> tab. <br><br>  Now let's select those entries that end in <b>.exe</b> in the <b>ParentPath</b> field.  To do this, follow these steps: <br><br>  ‚Ä¢ in the <b>Operation</b> drop-down list select <b>Ends with</b> <br>  ‚Ä¢ press the <b>New argument</b> button <br>  ‚Ä¢ in the <b>String</b> drop-down list, select the value of <b>parentPath</b> <br>  ‚Ä¢ press the <b>New argument</b> button again <br>  ‚Ä¢ at the <b>Sufix</b> argument <b>,</b> click the icon on the right to edit the entry and enter the value <b>.exe</b> <br><br><img src="https://habrastorage.org/files/c42/0ee/eef/c420eeeef9f9419fb16ffae135896baa.jpg"><br><br>  Now we need to extract the name of the executable file in <b>ParentPath</b> into a new column called <b>ExecutableName</b> . <br><br>  To do this, click on the <b>Create Column</b> icon. <img src="https://habrastorage.org/files/050/f18/907/050f18907c0d4c1085b00d6e7b33aaeb.jpg">  fill out the form as follows: <br><br>  ‚Ä¢ Enter the field name. <br>  ‚Ä¢ Select <b>Substitute</b> function. <br>  ‚Ä¢ Add an argument: the <b>parentPath</b> field <br>  ‚Ä¢ Add an argument: the regular expression <b>(. * \\) (? =. * (\. \ W *) $ | (\ w +) $)</b> . <br>  For example, this regular expression retrieves <b>‚Äúchrome.exe‚Äù</b> from <b>‚ÄúPROGRAM_FILESX86 | \ Google \ Chrome \ Application \ chrome.exe‚Äù</b> into the ExecutableName column. <br>  ‚Ä¢ Click on the <b>Create column</b> button. <br><br><img src="https://habrastorage.org/files/0e4/9a9/6ac/0e49a96ac4ae4aa288a98b3f7e6f972c.jpg"><br><br>  And now let's create another <b>ExecutableName2Lower</b> field, since  the query we want to make is case sensitive.  To do this, specify the following parameters in the form for adding a column: <br><br>  ‚Ä¢ Field name <br>  ‚Ä¢ Select the function <b>Lower case</b> <br>  ‚Ä¢ Add an argument and select <b>ExecutableName</b> in the drop-down list. <br>  ‚Ä¢ Click <b>Create column</b> <br><br><img src="https://habrastorage.org/files/b11/8cc/5af/b118cc5af2c74d0cb36b06feea83fcc5.jpg"><br><br>  As a result, you should see something like this: <br><br><img src="https://habrastorage.org/files/c2a/5fc/9f0/c2a5fc9f03c9495a9296e29bef976e56.jpg"><br><br>  If the process described above seems somewhat cumbersome to you, then you can click on the <b>Toggle Query Editor</b> icon <img src="https://habrastorage.org/files/5bc/897/5f9/5bc8975f9d514d92bed93ba5232bc033.jpg">  and write the following query in the query editor: <br><br>  <i>from oem.panda.paps.ops</i> <i><br></i>  <i>where endswith (parentPath, ".exe")</i> <i><br></i>  <i>select subs (parentPath, re ("(. * \\\\) (? =. * (\\. \\ w *) $ | (\\ w +) $)"), template ("")) as ExecutableName ,</i> <i><br></i>  <i>lower (ExecutableName) as ExecutableName2Lower</i> <br><br><img src="https://habrastorage.org/files/026/5a5/6b5/0265a56b5c1d4a47ad6398f985d74000.jpg"><br><br>  As a result, you will get the same result, provided that you correctly loaded the reference table (which we spoke about at the very beginning). <br><br>  Click the <b>Create Column</b> icon again: <br><br><img src="https://habrastorage.org/files/050/f18/907/050f18907c0d4c1085b00d6e7b33aaeb.jpg"><br><br>  Now we will insert the <b>Category</b> field from our reference table for those records for which the value of the <b>Executable2Lower</b> field is equal to the corresponding value of the <b>Service</b> field in the reference table in a new column called <b>Software Category</b> . <br><br><img src="https://habrastorage.org/files/05a/5c1/d6c/05a5c1d6ccc74874a8aecb6bd3f70343.jpg"><br><br>  You will now see the new column in the query results: <br><br><img src="https://habrastorage.org/files/b2e/983/228/b2e98322889e4928850b5202f7bd876c.jpg"><br><br>  In addition to this new column, you can use the <b>Data Extract</b> function to see the total distribution of the results by category.  To do this, move the mouse over the down arrow icon in the upper right corner of the title of the <b>Software Category</b> column.  A value of <b>Null</b> indicates that this entry was not found in the reference table. <br><br><img src="https://habrastorage.org/files/75e/444/5ad/75e4445ad23544d89f90f9f527649b9d.jpg"><br><br>  Now we group the <b>Software Category</b> and <b>ExecutableName</b> .  To do this, follow these steps: <br><br>  ‚Ä¢ Highlight these columns. <br>  ‚Ä¢ In the control panel, click on the <b>Group</b> button. <img src="https://habrastorage.org/files/746/391/97f/74639197fd194541816eee58ca7d58d2.jpg"><br><br><img src="https://habrastorage.org/files/290/a4d/375/290a4d3751dc40f4907b7f006dcad149.jpg"><br><br>  After that, add a column using the appropriate button in the control panel and the <b>Aggregate function</b> tab in the form that opens: <br><br><img src="https://habrastorage.org/files/734/380/44e/73438044ef344de39a6fd51eafdc9895.jpg"><br><br>  As a result of these actions, you should get something like the following: <br><br><img src="https://habrastorage.org/files/bda/b69/74e/bdab6974e7ee470ebb4e4cf6853c7efd.jpg"><br><br>  If the process described above seems somewhat cumbersome to you, then you can click on the Toggle Query Editor icon <img src="https://habrastorage.org/files/5bc/897/5f9/5bc8975f9d514d92bed93ba5232bc033.jpg">  and write the following query in the query editor: <br><br>  <i>from oem.panda.paps.ops</i> <i><br></i>  <i>where endswith (parentPath, ".exe")</i> <i><br></i>  <i>select subs (parentPath, re ("(. * \\\\) (? =. * (\\. \\ w *) $ | (\\ w +) $)"), template ("")) as ExecutableName ,</i> <i><br></i>  <i>lower (ExecutableName) as ExecutableName2Lower</i> <i><br></i>  <i>select `lu / Executable_Category / Category` (ExecutableName2Lower) as` Software Category`</i> <i><br></i>  <i>group every 15s by `Software Category`, ExecutableName</i> <i><br></i>  <i>every 0</i> <i><br></i>  <i>select count () as count</i> <br><br><img src="https://habrastorage.org/files/c2e/133/980/c2e13398051a47c49335a021b63156d9.jpg"><br><br>  And finally, with this newly added counter, we can do something more visual: for example, the Voronoi diagram.  Click the <b>Setup</b> button on the control panel. <img src="https://habrastorage.org/files/b30/cb7/263/b30cb726380f41a8915497c127e5d94f.jpg">  and select <b>Charts ‚Üí Diagrams ‚Üí Voronoi tree map</b> <br><br><img src="https://habrastorage.org/files/df9/5cf/f48/df95cff487214a7ea5c17fb4fff5b46a.jpg"><br><br>  Now drag the <b>Sofware Category</b> and <b>ExecutableName</b> to the <b>SIGNALS</b> panel in the Voronoi diagram settings. <br><br><img src="https://habrastorage.org/files/d8f/ec8/681/d8fec86810af48128b86dc8ce7256550.jpg"><br><br>  Also drag <b>count</b> to the <b>VALUE</b> panel. <br><br>  And ... done! <br><br><img src="https://habrastorage.org/files/b1b/78d/4a2/b1b78d4a24ec4a4d883816dbd2aa3347.jpg"><br><br>  We hope that this will help you to more flexibly customize our simplified Advanced Reporting Tool SIEM system to the specific needs of your enterprise. </div><p>Source: <a href="https://habr.com/ru/post/323850/">https://habr.com/ru/post/323850/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323838/index.html">Pink spacesuit, cryptocurrency and genetically modified iOS: tasks of the online-stage NeoQUEST-2017 and some statistics</a></li>
<li><a href="../323840/index.html">Webinar: Julia - A fresh approach to numerical computing and data science</a></li>
<li><a href="../323842/index.html">Prime investor Runet and its packages</a></li>
<li><a href="../323846/index.html">Create React App (aka React Scripts) and server rendering with Redux and Router</a></li>
<li><a href="../323848/index.html">Again asynchronous on callbacks. In arrays</a></li>
<li><a href="../323852/index.html">What was at the ISE-2017 exhibition (displays, LEDs, software for screens)</a></li>
<li><a href="../323854/index.html">Fresh KDE from developers plus stability Ubuntu 16.04 -> KDE Neon</a></li>
<li><a href="../323856/index.html">The story of how I am a master parser for the diary</a></li>
<li><a href="../323858/index.html">Overview of the HPE Aruba Switch Family, ArubaOS 16.X New Features</a></li>
<li><a href="../323860/index.html">Turning Ubuntu Server into a domain controller using samba-tool</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>