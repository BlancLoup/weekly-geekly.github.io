<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Magic Chocolatey: apt-get and yum for Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I will tell you about magic. And this magic can change the life of the Windows system administrator once and for all. 

 Nowadays there are fewe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Magic Chocolatey: apt-get and yum for Windows</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/getpro/habr/post_images/38e/272/38b/38e27238bfd7d65b36878c99eeecb004.png"><br>  Today I will tell you about magic.  And this magic can change the life of the Windows system administrator once and for all. <br><br>  Nowadays there are fewer and fewer people who have not installed software in the Linux environment at least once.  It's incredibly simple: to install midnight commander (mc), in the RH environment (RedHat Enterprise, CentOS, Fedora, etc.) we just need a couple of ‚Äúmagic‚Äù commands: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># yum install mc</span></span></code> </pre> <br>  The package manager yum will make sure that the latest version of <i>mc is</i> installed, as well as the dependencies of the package, if any.  But what to do if Windows is at our disposal, and we want something like that?  Right, go to Linux or read on! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Under my ‚Äúguardianship‚Äù there is a heterogeneous network of Windows and Linux machines (easier to say, a zoo), and for about two years now I have been using Chocolatey to install software under Win *.  Chocolatey ( <a href="http://chocolatey.org/">chocolatey.org</a> , <a href="https://github.com/chocolatey/chocolatey">github.com/chocolatey</a> ) is a package management system, much like apt-get or yum, but only for Windows. <br><br>  On Habr√© already touched the theme Chocolatey in the context of the developer, today I want to look at this wonderful tool from the point of view of the system administrator.  Chocolatey works on the basis of NuGet technology (it is actively used by software developers under Windows), and the main feature of Chocolatey is that the packages most often <b>do not</b> contain installation files (setup.msi, setup.exe, etc ...).  It works as follows: the package contains a script installer for powershell, which downloads and installs the correct version of the installation file from the right place on the Internet, and you just have to enjoy the ease of installation. <br><a name="habracut"></a><br><h2>  Chocolatey installation </h2><br>  Before being able to use Chocolate Chocolate magic, we need to install its core.  To do this, run the command line: <br><br><pre> <code class="bash hljs">@powershell -NoProfile -ExecutionPolicy unrestricted -Command <span class="hljs-string"><span class="hljs-string">"iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1'))"</span></span> &amp;&amp; SET PATH=%PATH%;%systemdrive%\chocolatey\bin</code> </pre><br>  This command will download and run the main installation script for <i><a href="">chocolatey.org/install.ps1</a></i> , as well as set the required environment variables.  Now that we have everything we need, let's test the package management system and install Nodepad ++.  Just run the following command: <br><br><pre> <code class="dos hljs">cinst notepadplusplus</code> </pre><br><h2>  What other packages are there and where do they come from? </h2><br>  Like NuGet, Chocolatey has an impressive list of packages, which is located in the repository, also <a href="http://chocolatey.org/packages">known as the package library</a> .  Here are just some of them: <br><br><div class="spoiler">  <b class="spoiler_title">Top 10 most popular packages on chocolatey.org</b> <div class="spoiler_text"><ul><li>  Git - 51191 downloads </li><li>  Notepad ++ - 37533 downloads </li><li>  7Zip - 37802 downloads </li><li>  Google Chrome - 25960 downloads </li><li>  Java Runtime - 25699 downloads </li><li>  NodeJS - 25542 downloads </li><li>  Mozilla Firefox - 20747 downloads </li><li>  Adobe Flash Player - 20660 downloads </li><li>  VLC Player - 20419 downloads </li><li>  Ruby 2.0 - 19587 downloads </li></ul><br></div></div><br>  Packages are added every day, because anyone can add their pack on chocolatey.org, the main thing is that it <a href="https://github.com/chocolatey/chocolatey/wiki/CreatePackages">meets the requirements</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Requirements for publishing packages</b> <div class="spoiler_text"><ul><li>  <b>Do not publish illegal programs</b> .  Programs that are illegal in most countries of the world are also banned from being hosted on Chocolatey.org.  This also applies to programs that violate copyrights, pirated programs and "crack".  Remember that this also applies to programs that are used for piracy. </li><li>  <b>Do not pack the program in chocolatey for which you do not have distribution rights</b> .  Please specify the software distribution rules and do not violate them. </li><li>  <b>Do not publish viruses or any other harmful programs</b> . </li><li>  <b>Publish only those programs that will be useful to others.</b>  If your package does not fall into this category - do not publish it. </li><li>  <b>Do not publish spyware or adware.</b>  Programs that come with embedded adware or spyware or any other irrelevant programs are not allowed to be published.  Usually, all irrelevant programs can be excluded from installation using installer keys.  Examples of such programs are <a href="https://github.com/stack72/MyChocolateyPackages/tree/master/PDFCreator">PDFCreator</a> and <a href="https://github.com/tonigellida/chocolateyautomaticpackages/tree/master/ccleaner">CCleaner</a> . </li><li>  <b>Do not publish programs that are already published.</b>  Use the search on <a href="http://chocolate.org/">Chocolatey.org</a> .  If you want to improve an existing package, contact the person who supports the package or send a pull-request to its repository. </li><li>  <b>Do not include other programs in your package if they already have their own package</b> .  If your package requires certain programs, the existing package should be included by you as a dependency. </li><li>  <b>Split dependencies into multiple packages</b> .  Try to split the package into as many packages as possible.  For example, the program comes with optional modules.  Create additional packages for modules, instead of including them in the general package.  This idea has long been used in Linux packages for the reason that it allows you to create lightweight packages and minimizes the chance of conflict. </li></ul><br></div></div><br><h5>  How it works? </h5><br>  I would like to take a closer look at the contents of the Chocolatey packages using the example of <a href="http://chocolatey.org/packages/logstash">logstash</a> , which I created specifically for deploying the logstash agent on a Windows server: <br><br><pre> <code class="hljs css">\<span class="hljs-selector-tag"><span class="hljs-selector-tag">logstash</span></span> \<span class="hljs-selector-tag"><span class="hljs-selector-tag">tools</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">chocolateyInstall</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ps1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">logstash</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.nuspec</span></span></code> </pre><br>  Here you can see that there are only 2 files in the package: logstash.nuspec and chocolateyInstall.ps1. <br><br><div class="spoiler">  <b class="spoiler_title">logstash.nuspec - file that describes package meta-information</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">package</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/packaging/2010/07/nuspec.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">metadata</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>logstash<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.2.1.2013101701<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>logstash<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authors</span></span></span><span class="hljs-tag">&gt;</span></span>kireevco<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authors</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">owners</span></span></span><span class="hljs-tag">&gt;</span></span>http://chocolatey.org/profiles/kireevco<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">owners</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">projectUrl</span></span></span><span class="hljs-tag">&gt;</span></span>https://github.com/kireevco/chocolatey-packages<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">projectUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copyright</span></span></span><span class="hljs-tag">&gt;</span></span>http://logstash.net<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copyright</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iconUrl</span></span></span><span class="hljs-tag">&gt;</span></span>http://logstash.net/images/logstash.png<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iconUrl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">requireLicenseAcceptance</span></span></span><span class="hljs-tag">&gt;</span></span>false<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">requireLicenseAcceptance</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Logstash is a tool for managing events and logs. You can use it to collect logs, parse them, and store them for later use (like, for searching). Speaking of searching, logstash comes with a web interface for searching and drilling into all of your logs. This package installs logstash flat jar as an agent service via nssm. All you need to do - is to configure your logstash.conf and start logstash service. Service is installed with these parameters: "java.exe -Xmx512M -jar logstash.jar agent --config logstash.conf --log logstash.log "<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">summary</span></span></span><span class="hljs-tag">&gt;</span></span>Logstash Agent package<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">summary</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tags</span></span></span><span class="hljs-tag">&gt;</span></span>logstash, logging<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tags</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javaruntime"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"7.0.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NSSM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.16.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Chocolatey"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.9.8.20"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">metadata</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">package</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  In this file it will be interesting to parse the <i>dependencies</i> section, in which we indicate that our package requires 3 other packages of certain versions, namely <a href="http://chocolatey.org/packages/javaruntime">javaruntime</a> , <a href="http://chocolatey.org/packages/NSSM">NSSM</a> (allows you to install our .jar file as a Windows service), as well as Chocolatey of a certain version.  If any of the required packages is missing, or its version does not match the required one, the dependency system will resolve the situation and lead everything to the required form.  It should be noted that <a href="http://docs.nuget.org/docs/reference/versioning">nuget is</a> used to indicate versions. <br><br><div class="spoiler">  <b class="spoiler_title">Powershell script chocolateyInstall.ps1</b> <div class="spoiler_text"><pre> <code class="hljs smalltalk">#   jar  <span class="hljs-string"><span class="hljs-string">$u</span></span>rl=<span class="hljs-string"><span class="hljs-string">'https://download.elasticsearch.org/logstash/logstash/logstash-1.2.1-flatjar.jar'</span></span> #      cmd  <span class="hljs-string"><span class="hljs-string">$c</span></span>mdfile=<span class="hljs-string"><span class="hljs-string">'c:/logstash/logstash.cmd'</span></span> #     <span class="hljs-string"><span class="hljs-string">$c</span></span>onfile = <span class="hljs-string"><span class="hljs-string">'c:/logstash/logstash.conf.sample'</span></span> <span class="hljs-string"><span class="hljs-string">$d</span></span>ir=<span class="hljs-string"><span class="hljs-string">'c:/logstash'</span></span> if (!(<span class="hljs-type"><span class="hljs-type">Test</span></span>-<span class="hljs-type"><span class="hljs-type">Path</span></span> -path <span class="hljs-string"><span class="hljs-string">$d</span></span>ir)) {<span class="hljs-type"><span class="hljs-type">New</span></span>-<span class="hljs-type"><span class="hljs-type">Item</span></span> <span class="hljs-string"><span class="hljs-string">$d</span></span>ir -<span class="hljs-type"><span class="hljs-type">Type</span></span> <span class="hljs-type"><span class="hljs-type">Directory</span></span>} <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ChocolateyWebFile</span></span> <span class="hljs-string"><span class="hljs-string">'logstash'</span></span> <span class="hljs-string"><span class="hljs-string">'c:/logstash/logstash.jar'</span></span> <span class="hljs-string"><span class="hljs-string">$u</span></span>rl <span class="hljs-string"><span class="hljs-string">$u</span></span>rl <span class="hljs-string"><span class="hljs-string">$c</span></span>mdcontent = @<span class="hljs-comment"><span class="hljs-comment">" set HOME=c:/logstash/sincedb cd /dc:\logstash java.exe -Xmx512M -jar logstash.jar agent --config logstash.conf --log logstash.log "</span></span>@ <span class="hljs-type"><span class="hljs-type">Set</span></span>-<span class="hljs-type"><span class="hljs-type">Content</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>mdfile <span class="hljs-string"><span class="hljs-string">$c</span></span>mdcontent -<span class="hljs-type"><span class="hljs-type">Encoding</span></span> <span class="hljs-type"><span class="hljs-type">ASCII</span></span> #   <span class="hljs-string"><span class="hljs-string">$c</span></span>onfcontent = @<span class="hljs-comment"><span class="hljs-comment">" input { stdin {} } output { stdout {} } "</span></span>@ <span class="hljs-type"><span class="hljs-type">Set</span></span>-<span class="hljs-type"><span class="hljs-type">Content</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>onfile <span class="hljs-string"><span class="hljs-string">$c</span></span>onfcontent -<span class="hljs-type"><span class="hljs-type">Encoding</span></span> <span class="hljs-type"><span class="hljs-type">ASCII</span></span> if (<span class="hljs-string"><span class="hljs-string">$s</span></span>erviceinfo = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Service</span></span> <span class="hljs-comment"><span class="hljs-comment">"Logstash"</span></span> -<span class="hljs-type"><span class="hljs-type">ErrorAction</span></span> <span class="hljs-type"><span class="hljs-type">SilentlyContinue</span></span>) { if (<span class="hljs-string"><span class="hljs-string">$s</span></span>erviceinfo.status -ne <span class="hljs-string"><span class="hljs-string">'Running'</span></span>) { if (<span class="hljs-string"><span class="hljs-string">$s</span></span>erviceinfo.status -eq <span class="hljs-string"><span class="hljs-string">'Stopped'</span></span>) { echo <span class="hljs-comment"><span class="hljs-comment">"Service found and is stopped. Deleting."</span></span> echo <span class="hljs-comment"><span class="hljs-comment">"Delete Service"</span></span> sc.exe \\localhost delete <span class="hljs-comment"><span class="hljs-comment">"Logstash"</span></span> nssm install <span class="hljs-comment"><span class="hljs-comment">"Logstash"</span></span> <span class="hljs-type"><span class="hljs-type">C</span></span>:\logstash\logstash.cmd } } else { echo <span class="hljs-comment"><span class="hljs-comment">"Stop Service"</span></span> sc.exe \\localhost stop <span class="hljs-comment"><span class="hljs-comment">"Logstash"</span></span> echo <span class="hljs-comment"><span class="hljs-comment">"Delete Service"</span></span> sc.exe \\localhost delete <span class="hljs-comment"><span class="hljs-comment">"Logstash"</span></span> echo <span class="hljs-comment"><span class="hljs-comment">"Installing Service"</span></span> nssm install <span class="hljs-comment"><span class="hljs-comment">"Logstash"</span></span> <span class="hljs-type"><span class="hljs-type">C</span></span>:\logstash\logstash.cmd } } else { #   nssm echo <span class="hljs-comment"><span class="hljs-comment">"Installing Logstash Service"</span></span> nssm install <span class="hljs-comment"><span class="hljs-comment">"Logstash"</span></span> <span class="hljs-type"><span class="hljs-type">C</span></span>:\logstash\logstash.cmd }</code> </pre><br></div></div><br><h2>  Application: </h2><br>  Many admins probably ran to test the functionality - it‚Äôs right, because there‚Äôs nothing difficult to use with Chocolatey - this is what Chocolatey‚Äôs sweetness is about.  Nevertheless, I would like to suggest several scenarios for using this package manager for Windows. <br><br><h4>  Cmd and Powershell scripts </h4><br>  We all use the simplest scripts in our work, and chocolatey is perfectly integrated into this process.  The simplest script for a regular client machine might look like this: <br><br><pre> <code class="dos hljs">cinst flashplayerplugin cinst flashplayeractivex cinst notepadplusplus cinst sublimetext2 cinst <span class="hljs-number"><span class="hljs-number">7</span></span>zip cinst GoogleChrome cinst javaruntime cinst Firefox cinst flashplayerplugin cinst adobereader cinst ccleaner cinst sysinternals cinst putty cinst filezilla cinst dropbox cinst skype cinst paint.<span class="hljs-built_in"><span class="hljs-built_in">net</span></span> cinst virtualbox cinst DotNet4.<span class="hljs-number"><span class="hljs-number">5</span></span> cinst Wget cinst ConEmu cinst libreoffice cinst PDFCreator cinst teamviewer cinst wuinstall.run</code> </pre><br>  Imagine how much time it saves you? <br><br><h4>  Puppet </h4><br>  I use Puppet to manage the configuration of my infrastructure, which saves me a lot of time and nerves.  Puppet has a wonderful concept of resources, as well as a declarative style, which in a compartment helps to think abstractly, at the level ‚ÄúWhich program should be on a particular server‚Äù, and not at the level ‚ÄúWhich commands should I run on Windows and which ones on Linux ".  For Puppet, there is a <a href="http://forge.puppetlabs.com/rismoney/chocolatey">Chocolatey provider</a> that allows us to do the following: <br><br><pre> <code class="ruby hljs">package { <span class="hljs-string"><span class="hljs-string">"7zip"</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">ensure</span></span> =&gt; installed, }</code> </pre><br>  or <br><br><pre> <code class="ruby hljs">package { <span class="hljs-string"><span class="hljs-string">"notepadplusplus"</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">ensure</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1.0</span></span>, }</code> </pre><br>  Puppet and Chocolatey will take care of the rest.  Believe me, it is much more convenient than installing from the msi file, which you need somewhere else, and also to make sure that when you update the version (which still needs to be done), the old versions are also preserved and nothing will break. <br><br><h4>  Chocolatey and Desktop </h4><br>  I propose to consider two ways to use Chocolatey for the administration of workstations. <br><br><div class="spoiler">  <b class="spoiler_title">Chocolatey GUI</b> <div class="spoiler_text">  <a href="https://github.com/chocolatey/ChocolateyGUI">ChocolateyGUI</a> is a graphical interface for the Chocolatey package management system.  A convenient way to review the current state of the repository, as well as the state of locally installed packages.  For some reason, I was very much reminded of the early version of synaptic or even aptitude.  It works quite well.  By the way, you can install it from the command line: <br><br><pre> <code class="bash hljs">cinst ChocolateyGUI</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/217/6f0/099/2176f009962c386c64d9f7584cc7be8f.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Windows Post Install (WPI)</b> <div class="spoiler_text">  You can go even further, use the <a href="http://www.wpiw.net/">WPI</a> interface for convenient selection of packages, in which Chocolatey commands will be executed.  With WPI, you can conveniently group programs into categories, as well as create templates and installation sets. <br>  The solution may not always be an absolute alternative to using USB-HDD as a source, but replacing all possible components with similar ones from the Chocolatey repository you will save yourself from the painful copy of the image (folder) with a full set of software (Photoshop, Office, 3D Max with Archicad, which is there more?) and the WPI shell (and all in order to install "light" programs like Google Chrome, Notepad ++, Avast, etc.). <br><br>  For example, for incoming administrators who maintain a scattered fleet of cars without centralized storage, it is convenient to have something like this list of templates: <br><ul><li>  Business </li><li>  Accountant </li><li>  Development </li><li>  Home user </li><li>  Media Station </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/038/30d/588/03830d588fd96d8853fe9d324d1ceccb.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/bdd/242/fc1/bdd242fc109f32fad5a0671be2b20592.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/955/bce/902/955bce902d302cbe036ae74d7dec59d4.jpg"><br>  Thus, WPI is just a shell for running Chocolatey commands, which allows you to reduce the total volume of the distribution.  Of course, with this approach, the client machine should already have a working Internet connection, which today is not a problem, except in some cases. <br>  Returning to programs that are not in the Chocolatey.org repository, it is worth mentioning that Chocolatey supports any NuGet feeds, not just chocolatey.org offered by default.  We upload important files to DropBox and create our package somewhere on <a href="http://www.myget.org/">www.myget.org</a> - it's very easy! <br></div></div><br>  If anyone is interested, I can tell in detail (in the form of a separate post) how to create my package and how to download it to the chocolatey.org repository, and how I taught Windows to install all updates without my participation (with reboots and licenses), I update the maxmind.dat database automatically, as I use logstash and much more, and all this is not without the help of chocolatey and puppet! <br><br>  In conclusion, I would say that in my opinion, the idea of ‚Äã‚Äãa decentralized package management system for Windows and its implementation is another way to make sure that today opensource and the discovery of technology is no less qualitative and applicable to the realities of system administration.  Closed code is becoming less and less the market advantage of a community / company, while implementation and support play a huge role.  Imagine that a decade ago, an open project created by one person could create such a resonance in wide circles, and even Windows circles - is unrealistic, but today Chocolatey is another chance to plunge into the opensource community and see the open possibility to contribute to the general idea . <br><br>  For any errors and inaccuracies, please indicate in the comments, I will gladly correct and supplement the material. <br><br>  And finally, a short survey: </div><p>Source: <a href="https://habr.com/ru/post/210626/">https://habr.com/ru/post/210626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210614/index.html">Generating trees on HTML5 Canvas</a></li>
<li><a href="../210616/index.html">What is faster? foreach vs. List.ForEach vs. for-loop</a></li>
<li><a href="../210618/index.html">Masyanya: crowdfunding returns</a></li>
<li><a href="../210620/index.html">For the first time in history, scientists managed to shoot a fireball on video and study its spectrum.</a></li>
<li><a href="../210622/index.html">Spacecraft Generator from Rebar</a></li>
<li><a href="../210628/index.html">KolibriOS Digest # 2: what February brought to us</a></li>
<li><a href="../210630/index.html">Alleged SpyEye author arrested in USA</a></li>
<li><a href="../210632/index.html">Promotion of Android applications, rankings and ranking in the tops of Google Play</a></li>
<li><a href="../210634/index.html">The book ‚ÄúHow Google Tests Software‚Äù is now in Russian!</a></li>
<li><a href="../210636/index.html">Fully anonymous blog</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>