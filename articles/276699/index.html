<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experience lectures on the introduction of design patterns</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Allow a small preface - I will mark in it the purpose of the article. 
 I teach junior undergraduates an introduction to design patterns on Saturdays....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experience lectures on the introduction of design patterns</h1><div class="post__text post__text-html js-mediator-article">  Allow a small preface - I will mark in it the purpose of the article. <br>  I teach junior undergraduates an introduction to design patterns on Saturdays.  Here, I want to share my experience, describe the plan of the first few lectures.  Most of the readers, I believe, the material I have presented myself has been familiar for a long time, but perhaps the order and manner of presentation will seem curious. <br>  Too often, alas, they tell us something, but they don‚Äôt say why they need it, or they even say it, but as if in passing.  Say, usually speaking about C #, they will tell you what the base class and interface are, what syntax you need to use to write them, give an example where the base will be the Bird class and the Duck and Eagle heirs, but why? it is necessary, what a benefit from the whole - potentially complex - hierarchy of classes is achieved, they do not say: it is as if in the shadows, implied by itself.  And that is why many students, who have not yet had time to fill their cones, have an inverted picture of the world in their heads - they have a good idea of ‚Äã‚Äãwhat tools they have in their hands, but understand why they are invented and what they are applicable to. <br>  That is why I have compiled several case studies on which one can show why some approaches are needed.  True, it is necessary to accept convention - we will beat from a cannon on sparrows, and even on imaginary targets.  But we will shoot and we will precisely get into the enemy parapet, happen what. <br>  I‚Äôll say right away that we will quickly move from very simple questions to quite complex ones (let's say, to the linker), so read to the end, if not from the beginning. <br><a name="habracut"></a><br><br>  Let's start with the fact that we solve the simplest way to any puzzle.  Well, let's say we display <b>n</b> first prime numbers.  We will act completely straightforward - we now have nothing to do with optimal algorithms. <br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Input n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse(Console.ReadLine()); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> primeNumbers = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> current = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (primeNumbers.Count != n) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (primeNumbers.All(x =&gt; current % x != <span class="hljs-number"><span class="hljs-number">0</span></span>)) { primeNumbers.Add(current); Console.WriteLine(current); } current++; } }</code> </pre> <br><br>  Well, great.  The program works.  What's next?  Well, let's say we publish it - let people use our module to calculate primes.  We will gradually develop, improve, hone - and we are pleased, and people benefit. <br>  True, then the question arises - will we give people the use of an exe-file that requires keyboard input?  Usually, modules are drawn up in the library, hiding the unnecessary and exposing only the method the user needs.  Let‚Äôs estimate his signature: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPrimeNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { ... }</code> </pre><br><br>  Suppose so.  True, this is not exactly what we did before.  We deduced <b>n</b> numbers, and here only the last.  Well, add another method, now we have two of them.  Immediately put them in a new class - just to lay together and contact them was convenient. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PrimeNumberCalculator</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPrimeNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { ... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPrimeNumbers</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { ... } }</code> </pre><br><br>  Module module, however, can not forget about our program.  It should work no worse than before.  Let's do the mess: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PrimeNumberCalculator</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPrimeNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetPrimeNumbers(n).Last(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPrimeNumbers</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> primeNumbers = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> current = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (primeNumbers.Count != n) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (primeNumbers.All(x =&gt; current % x != <span class="hljs-number"><span class="hljs-number">0</span></span>)) { primeNumbers.Add(current); Console.WriteLine(current); } current++; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> primeNumbers.ToArray(); } } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Input n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse(Console.ReadLine()); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PrimeNumberCalculator().GetPrimeNumbers(n); } }</code> </pre><br><br>  Everything seems to be good.  But our <b>PrimeNumberCalculator</b> class depends on the <b>Console</b> .  What does it mean, generally speaking, depends?  That means it uses.  Our class, if we suddenly assume that the console stops working, will not work either.  He requires it as a prerequisite.  Dependence on the class Console is not very visible now, because the Console is a static class.  We do not create an instance of it explicitly through <b>new</b> , but use it almost as a namespace.  But still there is a dependency, you must remember about it. <br>  We emphasize it.  Create a new class that will simply invoke the functionality of the <b>Console</b> , but it will not be static itself.  There is not much sense in this yet - we just want to emphasize the dependencies of the class <b>Calculator</b> <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyConsole</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ,        ,       public void WriteLine(string value) { Console.WriteLine(value); } } public class PrimeNumberCalculator { .... public int[] GetPrimeNumbers(int n) { .... new MyConsole().WriteLine(current.ToString()); .... } }</span></span></code> </pre><br><br>  When we write a <b>new MyConsole</b> , we resolve the dependency - we get at our disposal the object we need to work.  Generally speaking, it is considered bad form to resolve dependencies like this, directly creating the desired object.  Soon we will talk about why.  But first another question. <br><br>  Suppose that the user to whom we provided our published module (which would consist of only one class so far) wants to write a program very similar to ours - he also wants to bring a sequence of prime numbers somewhere.  One problem - it works on the web.  He has no console at all. <br>  Well, then why would he not take the ready-made array compiled by the <b>GetPrimeNumbers</b> method and not print where he wants?  Although the file, at least in the html-markup.  Is this possible?  It is possible, but then the behavior changes - we get the number on the screen as soon as it is calculated, and our user will be forced to spend time on calculating all the numbers first, and only then typing.  Not the same thing - especially if you ask the program to give out a 100-thousand prime number. <br>  I will not distract the reader with a specific implementation of the output "somewhere, but not in the console."  The simplest is to print to a file.  So let's assume that the user of our module wants to print to a file. <br>  What do we do? <br><br>  There is a small digression: many of the readers probably got so sick with the PLO that they hardly remember, as they thought before.  And the most frequent, the most straightforward solution that students offer me is to simply create a new method, something like ‚Äútake the first en primes, typing to a file‚Äù.  Moreover, the logic of output to the file and the logic of counting are mixed in one method. <br><br>  A new step is to create some ‚Äúwriter to file‚Äù, which will be very similar to the previous ‚Äúwriter on the console‚Äù, and its goal in life will be to disconnect the output logic from the prime number counting algorithm.  So, suppose we have: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">FileWriter</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      } }</span></span></code> </pre><br><br>  Then the frontal solution looks like this: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PrimeNumberCalculator</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPrimeNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetPrimeNumbers(n).Last(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPrimeNumbers</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> primeNumbers = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> current = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (primeNumbers.Count != n) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (primeNumbers.All(x =&gt; current % x != <span class="hljs-number"><span class="hljs-number">0</span></span>)) { primeNumbers.Add(current); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyConsole().WriteLine(current.ToString()); } current++; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> primeNumbers.ToArray(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetPrimeNumbersToFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> primeNumbers = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> current = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (primeNumbers.Count != n) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (primeNumbers.All(x =&gt; current % x != <span class="hljs-number"><span class="hljs-number">0</span></span>)) { primeNumbers.Add(current); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileWriter().WriteLine(current.ToString()); } current++; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> primeNumbers.ToArray(); } }</code> </pre><br><br>  It is clear that it is impossible to live like this: at least for two reasons.  The first is that we shamelessly duplicate the code.  If we come up with a better algorithm, we‚Äôll have to edit in two places.  If we find and correct the error, we will fix it, probably in one place, and in the second we will forget.  In a word, duplicate code is so-so occupation.  The second reason is that we allow the user to output only to the console and to a file.  And if he wants to go somewhere else?  We have to change our code, compile and upload a new version, so what?  We will satisfy all the whims of all users and create a class with two hundred methods that can print anywhere?  Nonsense, rubbish.  You can not do it this way. <br>  The question arises - what to do.  But in general - what would we like?  Write a counting algorithm, which at the right time pulls some writer.  And any.  Whatever.  Although the writer in the file, even though the writer on the console, even though the <s>informer in the KGB</s> . <br>  Well and - hurray!  - we have a solution.  Even a few (base class, abstract class, interface).  I, in such cases, prefer the interface, understanding it as a contract.  The class performing the interface undertakes to comply with the terms of the contract (contract), and I, the user, no matter who exactly executes the contract, if only the work was done. <br>  So, let's go: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IWriter</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ConsoleWriter</span></span> : <span class="hljs-title"><span class="hljs-title">IWriter</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { Console.WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">FileWriter</span></span> : <span class="hljs-title"><span class="hljs-title">IWriter</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      } } public class PrimeNumberCalculator { public int GetPrimeNumber(int n, IWriter writer) { return GetPrimeNumbers(n, writer).Last(); } public int[] GetPrimeNumbers(int n, IWriter writer) { var primeNumbers = new List&lt;int&gt;(); int current = 2; while (primeNumbers.Count != n) { if (primeNumbers.All(x =&gt; current % x != 0)) { primeNumbers.Add(current); writer.WriteLine(current.ToString()); } current++; } return primeNumbers.ToArray(); } } class Program { static void Main() { Console.WriteLine("Input n"); var n = int.Parse(Console.ReadLine()); var writer = new ConsoleWriter(); new PrimeNumberCalculator().GetPrimeNumbers(n, writer); } }</span></span></code> </pre><br><br>  Well?  We almost reached our goals.  The user can choose from a set of writers that we have provided him or create a new one, specifying that the ‚Äúwriter‚Äù interface performs.  By the way, note how we allow dependency on the writer ‚Äî passing the object into the method.  It would be possible, for example, to transfer to the class constructor, but this is a matter of taste and expediency. <br><br>  But this is another question.  Suppose we want to combine the functionality of several writers.  Let's say I need a "writer on the console and in the file."  Or "the writer on the console and in the file, and in the web (whatever that means)".  What to do? <br>  The first impulse is obvious: let's create this new writer, and let him write to all three sources.  One problem - we are again duplicating the code.  That is, we have already written all three separately, and now we will mix logic.  Well, this is solved as follows: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WriterToConsoleAndFile</span></span> : <span class="hljs-title"><span class="hljs-title">IWriter</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConsoleWriter(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileWriter(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } }</code> </pre><br><br>  Everything works, but there are drawbacks.  We have already said that resolving dependencies by simply creating an object is a bad form.  What's wrong with that? <br>  Yes, look.  When we wrote ‚Äúa new writer to the console,‚Äù we clarified that it was in the console, but not anywhere.  It could not be noticed by another one without changing our code, we were strictly dependent on the writer in the console.  Moreover, from the writer to the console created in this way.  Maybe I want to create the same class, but to change its settings - by default I‚Äôll make a blue background and yellow letters.  That is, I do not even use polymorphism (that is, I don‚Äôt pass the writer through the interface / base class), but I still get more freedom of choice, I‚Äôm giving more options to the user.  Let him create the object himself and set it up at his own discretion.  My job is to use the received tool.  So, from the words - to the case. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WriterToConsoleAndFile</span></span> : <span class="hljs-title"><span class="hljs-title">IWriter</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ConsoleWriter _consoleWriter; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FileWriter _fileWriter; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriterToConsoleAndFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> ConsoleWriter consoleWriter, FileWriter fileWriter</span></span></span><span class="hljs-function">)</span></span> { _consoleWriter = consoleWriter; _fileWriter = fileWriter; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { _consoleWriter.WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); _fileWriter.WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } }</code> </pre><br><br>  Now it remains to be noted that we do not use the special properties of the ‚Äúwriter to console‚Äù or ‚Äúwriter to file‚Äù at all.  We have no need to change the path to the file and generally know about its existence.  We do not want to change the font color of the console - it was not we who did this, but the one who created the <b>ConsoleWriter</b> instance.  This means that <b>IWriter is</b> enough for <b>us</b> .  We will not ask more than you need.  Here is: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WriterToConsoleAndFile</span></span> : <span class="hljs-title"><span class="hljs-title">IWriter</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IWriter _consoleWriter; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IWriter _fileWriter; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriterToConsoleAndFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IWriter consoleWriter, IWriter fileWriter</span></span></span><span class="hljs-function">)</span></span> { _consoleWriter = consoleWriter; _fileWriter = fileWriter; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { _consoleWriter.WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); _fileWriter.WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } }</code> </pre><br><br>  But now, after all, other writers can transfer us to the designer.  Not "in the file" and "in the console", but whatever.  Well, that's good for our purposes.  We have just created a class that can unite any two writers.  Where there RSP! <br>  Now there is only one step left: from two to an arbitrary number.  Here he is: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ManyWriters</span></span> : <span class="hljs-title"><span class="hljs-title">IWriter</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IWriter[] _writers; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ManyWriters</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IWriter[] writers</span></span></span><span class="hljs-function">)</span></span> { _writers = writers; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> writer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _writers) { writer.WriteLine(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } } }</code> </pre><br><br>  Hurray, we got a linker. <br>  What else?  Still not enough?  Yes, not bad, but one thing.  Now it may not be so easy for us to assemble a writer.  Create and customize one, create and customize another, then combine them with the help of the linker ... Difficult, right?  You can exercise for the sake of creating a file with the settings, where it will be written, what writers we want to use. <br>  And our new class will do what reads the settings file, creates the necessary writers, sets up the settings, puts them in one ManyWriters, closes the IWriter interface so that nobody else knows what program we know exactly which writer we use, and pass its on the way out ... And it will be a factory. </div><p>Source: <a href="https://habr.com/ru/post/276699/">https://habr.com/ru/post/276699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276683/index.html">Conversion design: creating online services that users truly love</a></li>
<li><a href="../276685/index.html">Photoshop, Sketch UI / UX designers toolkit: what to choose for developing interfaces?</a></li>
<li><a href="../276687/index.html">How to use IPP FIR filters in applications as efficiently as possible</a></li>
<li><a href="../276695/index.html">How to make commits, so that later it does not hurt</a></li>
<li><a href="../276697/index.html">Hacker Christmas Tree, or How to spend Children's Day in a non-children's company</a></li>
<li><a href="../276701/index.html">Meeting with Eugene Burmaco: Macros in Scala</a></li>
<li><a href="../276705/index.html">Testing and graph theory: installer</a></li>
<li><a href="../276707/index.html">Analysis of user and developer activity</a></li>
<li><a href="../276709/index.html">Linux demon on PHP5</a></li>
<li><a href="../276711/index.html">SQLite Query Profiling for Qt Applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>