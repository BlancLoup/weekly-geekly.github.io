<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Better to lose a day, and then teleport wherever you want and how much you want</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Do you use SecureCRT in your work? Many times a day do you have to go to different equipment in one or several spaces of IP addresses that differ only...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Better to lose a day, and then teleport wherever you want and how much you want</h1><div class="post__text post__text-html js-mediator-article">  Do you use SecureCRT in your work?  Many times a day do you have to go to different equipment in one or several spaces of IP addresses that differ only in one or two terminal octets and perform typical tasks on them?  Login password to access the equipment in your network represented by one or two combinations?  Have you thought a lot about how to make it all happen on your own, but were afraid to ask?  Or just want to briefly find out what, in principle, can be made a script on SecureCRT?  And so, SecureCRT + VBScript or "creativity in the routine."  Welcome under cat. <br><a name="habracut"></a><br><h4>  Who i am and what i do </h4><br>  I am a junior in a provider company, my duties include helpdesc second line and many routine tasks like pushing Vlan from port to port through the entire network, or supplying other services to the end port of the subscriber, setting up different pieces of hardware aggregation and distribution for placing on the network.  But whatever routine tasks of organizing new channels or setting up pieces of iron are the most inconvenient and distracting routine, these are contacts with helpdesk, which are always reduced to viewing port status, the presence of poppy on it, and the necessary Vlan, number of errors and history of UP / Down from equipment logs in rare cases. <br><br><h4>  How it all began </h4><br>  The more time passed from the moment of my employment, the faster my routine tasks were solved by me and the more they bored me.  And at a certain moment I decided to try to simplify my life and throw off the routine of the algorithms.  As a result, somewhere in half a year of unhurried work, I had several scripts, which I would like to share with you.  In addition, I searched for Habra and Stack Overflow and came to the conclusion that nowhere else such a topic has been raised.  Taking into account how much profit my workload brings me daily (saving time from a minute to 15 for an application from helpdesk) it seemed to me very strange. <br><br><h4>  What I want to share </h4><br>  In this post we will discuss the most recent of my creation.  It is written as competently as possible and with an eye for easy finishing, it is easy to understand and change to fit your needs.  The fact is that, not being a programmer, I wrote everything solely on the principle of ‚Äúif only it worked‚Äù and only with time as I wrote I learned (or are just beginning to ‚Äúlearn‚Äù) to write programs at least a little bit correctly. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Description of work: </h4><br>  This script requires you to enter a part of the IP address of the equipment (for example, in my network all devices have an address of 10.150.XX.XXX or 172.100.100.XXX) and a port. <br><ul><li>  Opens a new tab in SecureCrt or uses the current one if you put a minus "-" in front of the IP address.  If you put a "+" then you need to enter only the last octet of the IP address, a new tab will open, which will await authorization manually. </li></ul><br><ul><li>  The script contains two authorization combinations Login1 Pass1 and Login2 Pass2.  Using them, he logs in to the equipment on the principle if the first fails - try the second. </li></ul><br><ul><li>  After authorization, it reads the name of the device, adds the IP address entered by the user to its beginning and changes the tab title to the resulting Description. </li></ul><br><h5>  Thus, there is no need to remember what is behind a dozen open tabs, because there is now not just an IP address, but also a device name. </h5><br><ul><li>  If the user has entered the port number, then the script will know on which device it is located </li></ul><ul><li>  what UpTime it has (very nice that all manufacturers have this Show | display version command) </li></ul><ul><li>  and then, starting from the vendor, it uses the commands known to it in order to show the configuration of the required port </li></ul><ul><li>  his condition </li></ul><ul><li>  address poppy </li></ul><ul><li>  if there is a description, it changes the name of the tab to it. </li></ul><br>  At the end, he displays a message with everything he learned. <br><br><h5>  List and types of equipment with which the script works: |  ZTE |  HP |  QTECH |  H3C |  Quidway-EA |  Quidway-EI | </h5><br><br><h4>  Pro updates </h4><br>  Since my colleagues also use my work, and I often add or improve it, I also wrote a small update module that should be located in an accessible network location next to the new version of this script.  The path to the update module is specified in the script header itself in the UpdateEngine variable.  The same path is the path to the new version. <br>  The update occurs when the Update command is entered in the IP address field.  If you enter Upload, the new version will be shipped from the local computer to the server. <br><br><h4>  Almost end </h4><br>  In the process of writing, I encountered several unobvious difficulties, so if you have any questions, ask. <br>  Further, the actual code of both scripts.  Please use, change to fit your needs.  Perhaps for someone my experience will serve as the initial impulse to automate my own routine.  Someone will see examples of the use of VBScript in SecureCRT, someone will raise the CSW, noticing the dampness in the code.  In any case, I am sure that the topic will be useful to many. <br>  I advise you to edit the script in Notepad ++.  it uses such formatting that allows Notepad ++ to collapse individual modules (hide lines) so as to facilitate navigation through the code.  Unneeded at the moment modules can be minimized to two lines - the beginning and the end. <br>  I do not pretend to be the programmer of the year, so for dampness and bearish moves (inelegant solutions), please do not kick, but I will be happy for future tips. <br>  Code relevant for SecureCRT ver 7.0.1 <br><br>  Almost 300 lines of the first script: <br><div class="spoiler">  <b class="spoiler_title">Script</b> <div class="spoiler_text"><pre><code class="vbscript hljs">#$language = <span class="hljs-string"><span class="hljs-string">"VBScript"</span></span> #$interface = <span class="hljs-string"><span class="hljs-string">"1.0"</span></span> crt.Screen.Synchronous = <span class="hljs-literal"><span class="hljs-literal">True</span></span> crt.screen.IgnoreEscape = <span class="hljs-literal"><span class="hljs-literal">True</span></span> scr_ver = <span class="hljs-string"><span class="hljs-string">"0,55"</span></span> Developer = <span class="hljs-literal"><span class="hljs-literal">False</span></span> UpdateEngine = <span class="hljs-string"><span class="hljs-string">"\\SERVER\Script\Script_Update.vbs"</span></span> <span class="hljs-comment"><span class="hljs-comment">' Change Log: ' v0.1 The very beggining. Here where it starts. ' v0.2 16.01.14   Login2  ZTE ' v0.3 16.01.14       ' v0.4 20.01.14       Description '---v0.5 22.01.14   ,  IP  Caption . ' v0.51 24.01.14  +IP -    . ' v0.53 24.01.14     . ' v0.54 24.01.14        "-" ' v0.55 24.01.14     Dim ip 'IP   'ip = "10.150.127.245" 'H3C S3100-8TP-EI  Description        'ip = "10.150.226.246" 'H3C S3100-26TP-EI 1/0/1 'ip = "10.150.210.26" 'Quidway S2016TP-EA 'ip = "10.150.119.69" '[Quidway S2309TP-EI] 0/0/1 ---------------------------------------------- 'ip = "10.150.218.16" '[Quidway S2309TP-EI] 0/0/1 'ip = "10.150.226.33" 'ZTE ZXR10 2928E 'ip = "10.150.211.224" 'Qtech Dim Login Dim Passw Dim SW_Name Dim Port 'Port = "1" Dim Port_State Port_State = "UP" Dim Port_Description Dim Mac Dim exit_ '   "1"     Dim Equipment_ID '   | ZTE | QTECH | H3C | Quidway-EA | Quidway-EI | Dim Uptime Dim Oblast Oblast = False Dim var, var2, test Dim objCurrentTab, Tab Sub Update(file) Dim fso, f Set fso = CreateObject("Scripting.FileSystemObject") Set f = fso.OpenTextFile(file, 1) str = f.ReadAll f.Close ExecuteGlobal(str) End Sub Sub User() '   - Login1 Login2 'if objCurrentTab.Dialog.MessageBox (var,"Login1", 32 Or 4 Or 0 ) = 6 then ' 6  Login1, 7  Login2 Login = "Login1" Passw = "Pass1" 'else ' Login = "Login2" ' Passw = "Pass2" 'end if End sub Sub Connect() ' ,     ,    ,   IP = crt.Dialog.Prompt(" IP  10.150.", "sublime habr_script ver_" &amp; scr_ver, "", False) '  IP  if ip = "Update" then call Update (UpdateEngine) msgbox "    ." , 0 , "sublime habr_script ver_" &amp; scr_ver exit sub elseif ip = "Upload" then Developer = True call Update (UpdateEngine) msgbox "  ,  ", 0 , "sublime habr_script ver_" &amp; scr_ver exit sub elseif ip = "" then msgbox "IP   " , 0 , "sublime habr_script ver_" &amp; scr_ver exit_ = 1 exit sub end if Port = crt.Dialog.Prompt("  ", "sublime habr_script ver_" &amp; scr_ver, "", False) '    If Left(IP, 1) = "-" and Left(IP, 1) &lt;&gt; "" then ' .     IP = Mid(IP, 2, Len(IP)) if crt.Session.Connected then crt.Session.Disconnect '    -  crt.session.Connect "/telnet " &amp; chr(34) &amp; "10.150." &amp; ip &amp; chr(34) &amp; " 23" , , true '  Set objCurrentTab = crt.GetScriptTab if not objCurrentTab.Session.Connected then msgbox "  " exit_ = 1 exit sub else 'msgbox " " end if elseif Left(IP, 1) = "+" and Left(IP, 1) &lt;&gt; "" then ' +    Oblast = true IP = Mid(IP, 2, Len(IP)) set Tab = crt.session.ConnectInTab ("/telnet " &amp; chr(34) &amp; "172.100.100." &amp; ip &amp; chr(34) &amp; " 23" , , true ) '  tab.Screen.Synchronous = True ' , ! tab.screen.IgnoreEscape = True ' , ! 'msgbox "before Set objCurrentTab = crt.GetTab(tab.Index)" Set objCurrentTab = crt.GetTab(tab.Index) if not objCurrentTab.Session.Connected then msgbox "  " exit_ = 1 exit sub else 'msgbox " " &amp; exit_ end if else '     . 'msgbox "before set Tab = crt.session.ConnectInTab" set Tab = crt.session.ConnectInTab ("/telnet " &amp; chr(34) &amp; "10.150." &amp; ip &amp; chr(34) &amp; " 23" , , true ) '  tab.Screen.Synchronous = True ' , ! tab.screen.IgnoreEscape = True ' , ! 'msgbox "before Set objCurrentTab = crt.GetTab(tab.Index)" Set objCurrentTab = crt.GetTab(tab.Index) if not objCurrentTab.Session.Connected then msgbox "  " exit_ = 1 exit sub else 'msgbox " " &amp; exit_ end if end if objCurrentTab.Screen.Synchronous = True objCurrentTab.screen.IgnoreEscape = True End Sub Sub LogOn() '  objCurrentTab.Screen.WaitForStrings "Username:", "login", 10 if Oblast = False then objCurrentTab.Screen.Send "Login1" + chr(13) end if objCurrentTab.Screen.WaitForString "assword:", 10 if Oblast = False then objCurrentTab.Screen.Send "Pass1" + chr(13) end if var = CStr(objCurrentTab.screen.WaitForStrings("&gt;", "#", "Username:", "login", 10)) 'msgbox var if var = 0 then msgbox " " exit_ = 1 exit sub elseif ((var = 3) or (var = 4)) and (Oblast = false) then if objCurrentTab.Screen.WaitForString ("authentication success", 1) = false then '   zte 'msgbox "ZTE" objCurrentTab.Screen.Send "Login2" + chr(13) objCurrentTab.Screen.WaitForString "assword:" objCurrentTab.Screen.Send "Pass2" + chr(13) end if elseif (var = 3 or var = 4) and Oblast = true then objCurrentTab.Screen.WaitForString "assword:", 10 end if objCurrentTab.Screen.Send chr(13) if CStr(objCurrentTab.screen.WaitForStrings("&gt;", "#", 2)) = 0 then msgbox " " exit_ = 1 exit sub end if End sub Sub Equipment() ' ,    objCurrentTab.Screen.Send " " &amp; chr(13) objCurrentTab.screen.WaitForString chr(10) SW_Name = objCurrentTab.Screen.ReadString ("&gt;", "#", 1) if SW_Name &lt;&gt; "" then '     SW_Name if left(SW_Name,1) = "&lt;" then SW_Name = Mid(SW_Name, 2, Len(SW_Name)) end if objCurrentTab.Caption = IP &amp; "_" &amp; SW_Name end if if Oblast = true then '        172.100.100. exit_ = 1 exit sub end if if port &lt;&gt; "" then objCurrentTab.Screen.Send "display version" &amp; chr(13) ' 1 2 3 4 5 6 0 var = CStr(objCurrentTab.screen.WaitForStrings("Quidway", "H3C", "HP", "QTECH", "Invalid", "ommand", 2)) if var = 0 then msgbox "   . ." exit_ = 1 exit sub elseif (var = 5 or var = 6) then objCurrentTab.Screen.Send "show version" &amp; chr(13) ' 1 2 3 4 0 var = CStr(objCurrentTab.screen.WaitForStrings("ZTE", "QTECH", "Invalid", "ommand", 1)) if (var = 0) or (var = 3) or (var = 4) then msgbox "   . ." exit_ = 1 exit sub elseif var = 1 then Equipment_ID = "ZTE" elseif var = 2 then Equipment_ID = "QTECH" Port = "1/" &amp; Port end if elseif (var = 2) or (var = 3) then Equipment_ID = "H3C" Port = "1/0/" &amp; Port elseif var = 1 then objCurrentTab.screen.WaitForString " " var = CStr(objCurrentTab.screen.WaitForStrings("-EA", "-EI", 2)) if var = 0 then msgbox "   . ." exit_ = 1 exit sub elseif (var = 1) then Equipment_ID = "Quidway-EA" Port = "1/0/" &amp; Port elseif (var = 2) then Equipment_ID = "Quidway-EI" Port = "0/0/" &amp; Port end if end if objCurrentTab.screen.WaitForString "ptime" Uptime = objCurrentTab.Screen.ReadString(chr(13) , 1) objCurrentTab.screen.WaitForStrings "&gt;", "#", 1 end if End sub Sub Port_Information() '    - State, Description if Equipment_ID = "ZTE" then ' ZTE objCurrentTab.Screen.Send chr(13) objCurrentTab.screen.WaitForString "&gt;" objCurrentTab.Screen.Send "show port " &amp; Port &amp; " brief" &amp; chr(13) var = CStr(objCurrentTab.screen.WaitForStrings("up", "down", 2)) if var = 0 then msgbox "   . ." exit_ = 1 exit sub elseif (var = 1) then Port_State = "UP" elseif (var = 2) then Port_State = "DOWN" end if Port_Description = Trim(objCurrentTab.Screen.ReadString(chr(13) , 2)) end if '/ZTE '-------------------------------------------------------------------- if Equipment_ID = "H3C" or Equipment_ID = "Quidway-EA" or Equipment_ID = "Quidway-EI" then ' H3C or Quidway-EA or Quidway-EI objCurrentTab.Screen.Send chr(13) objCurrentTab.screen.WaitForString "&gt;" objCurrentTab.Screen.Send "display interface Ethernet " &amp; Port &amp; chr(13) var = CStr(objCurrentTab.screen.WaitForStrings("UP", "DOWN", 2)) if var = 0 then msgbox "   . ." exit_ = 1 exit sub elseif (var = 1) then Port_State = "UP" elseif (var = 2) then Port_State = "DOWN" end if objCurrentTab.Screen.Send " " &amp; chr(13) objCurrentTab.screen.WaitForString "&gt;", 1 objCurrentTab.Screen.Send " " &amp; chr(13) objCurrentTab.screen.WaitForString "&gt;", 1 objCurrentTab.Screen.Send "display current-configuration interface Ethernet " &amp; Port &amp; chr(13) objCurrentTab.screen.WaitForString "description", 1 Port_Description = Trim(objCurrentTab.Screen.ReadString(chr(13) , 2)) end if '/H3C or Quidway-EA or Quidway-EI '-------------------------------------------------------------------- if Equipment_ID = "QTECH" then ' QTECH objCurrentTab.Screen.Send chr(13) objCurrentTab.screen.WaitForString "#" objCurrentTab.Screen.Send "show interface ethernet " &amp; Port &amp; chr(13) var = CStr(objCurrentTab.screen.WaitForStrings("up", "down", 2)) if var = 0 then msgbox "   . ." exit_ = 1 exit sub elseif (var = 1) then Port_State = "UP" elseif (var = 2) then Port_State = "DOWN" end if objCurrentTab.Screen.Send " " &amp; chr(13) objCurrentTab.screen.WaitForString "#" objCurrentTab.Screen.Send "show running-config interface ethernet " &amp;Port &amp; chr(13) objCurrentTab.screen.WaitForString "description", 1 Port_Description = Trim(objCurrentTab.Screen.ReadString(chr(13) , 2)) end if '/QTECH if Port_Description &lt;&gt; "" then '     Port_Description objCurrentTab.Caption = IP &amp; "_" &amp; Port_Description end if End sub Sub MacInformation() '   if Equipment_ID = "ZTE" then ' ZTE objCurrentTab.Screen.Send chr(13) objCurrentTab.screen.WaitForString "&gt;" objCurrentTab.Screen.Send "show mac dynamic port " &amp; Port &amp; chr(13) objCurrentTab.screen.WaitForString "---" &amp; chr(13) , 3 '     While var2 &lt;&gt; "stop" var = CStr(objCurrentTab.screen.WaitForStrings ("No MAC", chr(10), "Press", "&gt;", 1)) 'msgbox var if var = 1 then Mac = "No Mac" elseif var = 2 then Mac = Mac &amp; chr(13) &amp; objCurrentTab.Screen.ReadString(" ", 1) Elseif var = 3 then objCurrentTab.Screen.Send " " for i = 1 to 98 objCurrentTab.screen.WaitForString chr(8), 1 next Mac = Mac &amp; chr(13) &amp; objCurrentTab.Screen.ReadString(" ", 1) Elseif var = 4 then var2 = "stop" Elseif var = 0 then var2 = "stop" end if objCurrentTab.screen.WaitForStrings chr(13), " ", 1 'var2 = objCurrentTab.Screen.ReadString(".", 1) ' var = "" ' for i = 1 to len(var2) ' test = Mid(var2, i, 1) ' 'msgbox test ' var = var &amp; "|" &amp; Asc(test) ' next ' msgbox "_..." &amp; var &amp; "..._" &amp; "i= " &amp; i &amp; chr(13) &amp; var2 wend end if '/ZTE if Equipment_ID = "H3C" or Equipment_ID = "Quidway-EA" then ' H3C or Quidway-EA objCurrentTab.Screen.Send chr(13) objCurrentTab.screen.WaitForString "&gt;" objCurrentTab.Screen.Send "displ mac-address interface Ethernet " &amp; port &amp; chr(13) objCurrentTab.screen.WaitForString "TIME(s)", 1 While var2 &lt;&gt; "stop" var = CStr(objCurrentTab.screen.WaitForStrings ("No MAC", chr(10), "found", 1)) if var = 1 then Mac = "No Mac" elseif var = 2 then Mac = Mac &amp; chr(13) &amp; objCurrentTab.Screen.ReadString(" ", 1) elseif var = 3 then var2 = "stop" Elseif var = 0 then Mac = Mac &amp; chr(13) &amp; "more..." var2 = "stop" end if wend end if '/H3C or Quidway-EA if Equipment_ID = "Quidway-EI" then ' Quidway-EI objCurrentTab.Screen.Send chr(13) objCurrentTab.screen.WaitForString "&gt;" objCurrentTab.Screen.Send "display mac-address dynamic Ethernet " &amp; port &amp; chr(13) objCurrentTab.screen.WaitForStrings "Lsp", "MAC-Tunnel", 5 objCurrentTab.screen.WaitForString "------------------------------------------------------" &amp; chr(13), 3 While var2 &lt;&gt; "stop" var = CStr(objCurrentTab.screen.WaitForStrings ("displayed = 0", chr(10), "Total", 1)) if var = 1 then Mac = "No Mac" var2 = "stop" elseif var = 2 then var = objCurrentTab.Screen.ReadString(" ", 1) 'msgbox "_" &amp; var &amp; "_" if (var = chr(13) &amp; chr(10) &amp; "Total") or (var = chr(13) &amp; chr(10) &amp; "-------------------------------------------------------------------------------" &amp; chr(13) &amp; chr(10) &amp; "Total") then var2 = "stop" else Mac = Mac &amp; var &amp; chr(13) end if objCurrentTab.screen.WaitForString chr(13), 1 elseif var = 3 then var2 = "stop" Elseif var = 0 then Mac = Mac &amp; chr(13) &amp; "more..." var2 = "stop" end if wend end if '/Quidway-EI if Equipment_ID = "QTECH" then ' QTECH objCurrentTab.Screen.Send chr(13) objCurrentTab.Screen.Send "show mac-address-table interface ethernet " &amp; port &amp; chr(13) objCurrentTab.screen.WaitForString "Read mac address table...." var = CStr(objCurrentTab.screen.WaitForStrings ("No mac", "---" &amp; chr(13), 1)) if var = 1 then var2 = "stop" Mac = "No Mac" end if While var2 &lt;&gt; "stop" var = CStr(objCurrentTab.screen.WaitForStrings ( " ", SW_name, 1)) if var = 1 then Mac = Mac &amp; chr(13) &amp; Trim(objCurrentTab.Screen.ReadString(" ", 1)) objCurrentTab.screen.WaitForString chr(13) elseif var = 2 then var2 = "stop" Elseif var = 0 then Mac = Mac &amp; chr(13) &amp; "more..." var2 = "stop" end if wend end if End sub if exit_ &lt;&gt; 1 then Call User if exit_ &lt;&gt; 1 then Call Connect if exit_ &lt;&gt; 1 then Call LogOn if exit_ &lt;&gt; 1 then Call Equipment if exit_ &lt;&gt; 1 and Port &lt;&gt; "" then Call Port_Information if exit_ &lt;&gt; 1 and Port &lt;&gt; "" and Port_State = "UP" then Call MacInformation 'and Port_State = "UP" var = "  " &amp; Equipment_ID &amp; chr(13) &amp; "Uptime " &amp; Uptime &amp; chr(13) var = var &amp; " " &amp; " = " &amp; SW_Name &amp; chr(13) var = var &amp; "  " &amp; Port &amp; " = " &amp; Port_State &amp; chr(13) var = var &amp; "  " &amp; Port &amp; " = " &amp; Port_Description &amp; chr(13) var = var &amp; " : " &amp; chr(13) &amp; Mac &amp; chr(13) var = var &amp; "  " if Port &lt;&gt; "" then msgbox var end if</span></span></code> </pre> <br></div></div><br>  And update script <br><div class="spoiler">  <b class="spoiler_title">Updateengine</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">'#$language = "VBScript" '#$interface = "1.0" crt.Screen.Synchronous = True crt.screen.IgnoreEscape = True scr_vers = "0,1" ' Change Log: ' v0.1 21.01.14 The very beggining. Here where it starts. Dim cur_scr_path, cur_scr_Name, cur_scr_ver, cur_scr_file Dim ser_scr_path, ser_scr_Name, ser_scr_ver, ser_scr_file Sub CurrentScript() '   ,     cur_scr_path = crt.ScriptFullName For i = 1 to 10 if InStr(cur_scr_path,"\") = 0 then Exit for end if cur_scr_path = Right(cur_scr_path, Len(cur_scr_path) - InStr(cur_scr_path,"\")) next cur_scr_Name = cur_scr_path 'msgbox cur_scr_Name cur_scr_path = crt.ScriptFullName Set cur_scr_file = CreateObject("Scripting.FileSystemObject").OpenTextFile(cur_scr_path,1) ' 1 - for reading do while not cur_scr_file.AtEndOfStream cur_scr_ver = cur_scr_file.ReadLine cur_scr_ver = trim(cur_scr_ver) if left(cur_scr_ver, 10) = "scr_ver = " then cur_scr_ver = Mid (cur_scr_ver, 12, Len(cur_scr_ver) - 12)'Mid(cur_scr_ver, 11,InStr(cur_scr_ver," ")) 'msgbox cur_scr_ver = " &amp; cur_scr_ver Exit do end if loop cur_scr_file.Close end sub Sub ServerScript() '   ,  ser_scr_path = "\\SERVER\Script" &amp; "\" &amp;cur_scr_Name 'msgbox ser_scr_path Set ser_scr_file = CreateObject("Scripting.FileSystemObject").OpenTextFile(ser_scr_path,1) ' 1 - for reading do while not ser_scr_file.AtEndOfStream ser_scr_ver = ser_scr_file.ReadLine ser_scr_ver = trim(ser_scr_ver) 'msgbox ser_scr_ver if left(ser_scr_ver, 10) = "scr_ver = " then ser_scr_ver = Mid (ser_scr_ver, 12, Len(ser_scr_ver) - 12) 'msgbox "ser_scr_ver = " &amp; ser_scr_ver Exit do end if loop ser_scr_file.Close End sub Sub Comparisson() '  ,     . Const OverwriteExisting = True 'msgbox "_" &amp; cur_scr_ver &amp; "_" &amp; ser_scr_ver&amp; "_" 'MsgBox (TypeName(cur_scr_ver)) &amp; "_" &amp; (TypeName(ser_scr_ver)) If Developer = true then If CDbl(cur_scr_ver) &lt; CDbl(ser_scr_ver) then '      msgbox "   . WTF?!",0 , "God mode ON." elseif CDbl(cur_scr_ver) = CDbl(ser_scr_ver) then '      msgbox "Version equals, nothing to do" ,0 , "God mode ON." elseif CDbl(cur_scr_ver) &gt; CDbl(ser_scr_ver) then '        .   msgbox "Version difference, Uploading new version to the server. Press ok to begin" ,0 , "God mode ON." Set objFSO = CreateObject("Scripting.FileSystemObject") objFSO.CopyFile cur_scr_path , ser_scr_path, OverwriteExisting end if elseif Developer = false then If CDbl(cur_scr_ver) &lt; CDbl(ser_scr_ver) then '     .  . msgbox "  .  ." , 0 , "UpdateEngine" Set objFSO = CreateObject("Scripting.FileSystemObject") objFSO.CopyFile ser_scr_path, cur_scr_path, OverwriteExisting elseif CDbl(cur_scr_ver) = CDbl(ser_scr_ver) then '      msgbox " .", 0 , "UpdateEngine" elseif CDbl(cur_scr_ver) &gt; CDbl(ser_scr_ver) then '        . msgbox "   .", 0 , "UpdateEngine" end if end if Developer = false exit_ = 1 End sub Call CurrentScript() Call ServerScript() Call Comparisson()</span></span></code> </pre><br></div></div><br><br><h4>  At last </h4><br><br>  I have another very useful script for GPON MA5680T hardware.  Who faced, he knows how difficult it is to add services or to understand the current configuration of the terminal terminal, the so-called.  "Ponky."  I wrote a script that allows you to add services, display a list of services or parse a ponk from the GPONa configuration.  The final table formed by the script looks like this <br><br><div class="spoiler">  <b class="spoiler_title">GPON</b> <div class="spoiler_text"><pre> <code class="bash hljs">: (6-0/1/1-2) ONT_name : UP : 92 C: 32303131B881F241 (2011-B881F241) __________________________ Service Port summury: ========================================================= |S*P | |Vlan| |Gem | |UV | |RTx | || Vlan desc --------------------------------------------------------- |5 | | 600| |130 | |2 | |5 | || Chanel1_name |38 | |1203| |136 | |3 | |7 | || |180 | |3563| |213 | |6 | |2 | || Chanel2_name |143 | |3786| |304 | |4 | |2 | || Chanel3_name |573 | | 598| |390 | |7 | |7 | || =========================================================  (O = UP; X = Down): ---------------------- [O] - Port 1 : 1,[2], [O] - Port 2 : 1,[3], [O] - Port 3 : 1,[4], [O] - Port 4 : 1,[6], [X] - Port 5 : 1,[7], ---------------------- ---------------------- Tcont_id 0.......1 Tcont_id 1.......12 Tcont_id 2.......5 Tcont_id 3.......57 Tcont : 4 ----------------------</code> </pre><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/210822/">https://habr.com/ru/post/210822/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210812/index.html">Method of comparing algorithms and for what it may still be useful</a></li>
<li><a href="../210814/index.html">We do automatic watering of a room flower on Arduino in 15 minutes</a></li>
<li><a href="../210816/index.html">Creating and using Matlab clusters</a></li>
<li><a href="../210818/index.html">Resurrection Sharepoint or how not to burn at the stake of the Inquisition</a></li>
<li><a href="../210820/index.html">About using $ .Deferred to work with asynchronous tasks</a></li>
<li><a href="../210824/index.html">Splitting web pages into semantic blocks</a></li>
<li><a href="../210826/index.html">About comparing and optimizing keyboard layouts</a></li>
<li><a href="../210828/index.html">Nanex: A Nightmare on Elm Street for High-Speed ‚Äã‚ÄãTrading, Part 4</a></li>
<li><a href="../210830/index.html">The controller is a central home, all-powerful KCD-V-2-12</a></li>
<li><a href="../210832/index.html">How we ported OpenCV to WindowsRT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>