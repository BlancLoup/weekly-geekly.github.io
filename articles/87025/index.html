<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zeus trojan first acquaintance</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 
 Here I saw a ‚Äúwave‚Äù of articles about hacks, nepoheki, 1337 h4x0rz ... etc. And then I thought that Habra would be interested in reading a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zeus trojan first acquaintance</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr! <br>  Here I saw a ‚Äúwave‚Äù of articles about hacks, nepoheki, 1337 h4x0rz ... etc.  And then I thought that Habra would be interested in reading about the hardware and how it works not from the crossposting of news, but so to speak from the hands that worked with it. <br><br>  <u>Immediately read this:</u> <br><h6>  All information in this article is provided purely for information and is designed primarily to indicate errors in security systems. </h6><br><br>  In most cases, the antivirus (hereinafter AV) coped with all the harmful little animals, but one fine sunny day :) I had to climb, so to speak, under the hood of one of these "little animals." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It was in August of the <s>44th of</s> 2008.  At that time I was a little technically and practically grounded in terms of dealing with all kinds of hardware and so on. <br><br>  So, climbing the sites of dubious nature, to which the search engine directed me in search of the software I needed, nod32 suddenly shouted that I was trying to feed something Trojan-Spy.Win32.Zbot (hereinafter zeus \ zbot \ Zeus).  I have no idea what happened to my head, but I really wanted to study this beast. <br><br>  About how I watched Zeus, went to his command center and got access to it, under the cut. <br><a name="habracut"></a><br><h6>  In this article I will tell superficially about the Trojan, which sucked me into a ‚Äútheme‚Äù with hardware and so on ... further, if Habarusers are interested, I will tell you about other fascinating cases of working with hardware, articles about work and neutralizing interesting specimens. </h6><br><br><h3>  Hi Zeus! </h3><br>  First of all, I got into google and found out what the beauty was trying to settle with me, the search engine did not particularly resist and told me the URLs with the description. <br><br>  So, what I found out is key: <br><ul><li>  What is it and what can it do? <ul><li>  Troyan formgrabber 1 pc.  (Later the next version will be released where the injection system will be supported) </li><li>  Internet Explorer can only rob the forms up to version 7 inclusive (later the next version with modules support will be released; one of the modules will allow the Trojan to rob the forms of the FireFox browser) </li><li>  Rob cookies and saved form data </li><li>  It can make a socks5 proxy server from an infected PC if it is outside NAT, that is, it has a real \ white ip address (later a backconnetc module will be released, which will allow to bypass the restriction related to the fact that the PC may be behind NAT) </li><li>  Kill the system </li><li>  Grabber certificates and sol </li><li>  It feeds fake pages to users of an infected PC. </li><li>  Search and delete or upload files to a remote server </li><li>  and other things characteristic of this kind of Malvarim ... </li></ul></li><li>  Where does it live and what is it from? <ul><li>  OS Windows XP x32 </li><li>  It works both under the admin account, and under the user account, and even under the guest account. </li><li>  The bot is completely based on WinAPI interception in UserMode (Ring3), this means that the bot does not use <br>  any drivers and references in Ring0. </li><li>  Written in Visual C ++ version 9.0+, with no additional libraries being used. <br>  such as msvcrt, ATL, MFC, QT, etc. </li><li>  and other features ... </li></ul></li></ul><br><h6>  In cl.  there will be more articles about this troj, since this article deals with the bot of the old version, I decided not to succeed in the details of its functionality and capabilities. </h6><br><br>  Next, I learned about how interesting it infects a PC.  It turned out that the bot consists of 3 key things: <br>  1. The bot itself. <br>  2. Configuration file. <br>  3. Gate \ admin panel. <br><br>  After infecting the PC, he downloaded the configuration file, where his settings and addresses were specified to the gate, where he should send the loot.  That is, in theory, if you run it on a PC without the Internet, nothing bad will happen, since he will not know where to send reports with stolen good. <br><br>  Having put myself VirtualBox, and Win XP on it, I got into the AV logs and extracted the URL on which I found a Trojan. <br>  Having downloaded the trojan on the virtual machine, I did not hurry to launch it there.  I downloaded the Wireshark packet sniffer and launched it, chopped off the access to the virtual machine from a real machine, and then launched the trojan on the virtual machine ... <br><br>  And then I saw how Troy started the het with a request to try to pick up his config, copying the URL to the configuration and downloading it, it was found that he was encrypted and just did not know what was there.  Since it was a virtual machine, I was not sorry for the system :) and I returned access to the virtual network, continuing to look at the sniffer log. <br><br>  After the config jump, he began to receive to his gate, the bot received and sent information from the gate using the http protocol post and get requests. <br><br>  Having opened IE, I climbed the sites, poked the data in some forms, saved the passwords where I suggested it and so on. <br>  Having opened the sniffer log again and filtering my adventures on the Internet, I saw that the bot sends information with each of my post requests, that is, the Trojan actually sent all my activity data in IE. <br><br>  I couldn‚Äôt find out more at that time and didn‚Äôt want to stop my interest. <br><br>  I started closing tabs with search queries for Zeus and then I saw in one of the tabs ‚ÄúFill in went to the Zeus admin panel‚Äù, so I became interested and woke up again. <br><br>  <strong>To be continued...</strong> <br><h6>  How I got access to the server on which was the command center Zeus (it is also a gate, admin panel and so on), correspondence with the owner of the botnet in txt file on the server, control the botnet. <br></h6><br><br>  PS: I will be happy to answer your questions. <br><br>  <u><b>UPD: <a href="http://bzzz.habrahabr.ru/blog/87217/">Part Two - Hello, Trojan-Spy.Win32.Zbot !!!</a></b></u>  <u><b><a href="http://bzzz.habrahabr.ru/blog/87217/">part two ... about shells, rootkits, eskploity and chat in txt file</a></b></u> </div><p>Source: <a href="https://habr.com/ru/post/87025/">https://habr.com/ru/post/87025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../87016/index.html">Creation of compact applications on VC ++</a></li>
<li><a href="../87018/index.html">Improving the quality of search or the subjectivity of Yandex?</a></li>
<li><a href="../87021/index.html">Low cost writing board with marker (Glass WhiteBoard)</a></li>
<li><a href="../87023/index.html">Copyright Funeral</a></li>
<li><a href="../87024/index.html">What Sql Injection May Cause</a></li>
<li><a href="../87028/index.html">Thunderbird 3.1 Beta 1 released</a></li>
<li><a href="../87033/index.html">Drill with Shell</a></li>
<li><a href="../87034/index.html">Hard drive is dead - now it works like a clock</a></li>
<li><a href="../87035/index.html">Manual testing process: What would we do to automate this?</a></li>
<li><a href="../87039/index.html">A little bit about the architecture of the ARM7TDMI processors</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>