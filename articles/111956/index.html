<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Media Magic: Customization</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Article on setting up Mediasika. What is it - you can read here 


 Details under the cut. 


 1. Install the torrent client rtorrent 
 There are seve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Media Magic: Customization</h1><div class="post__text post__text-html js-mediator-article">  Article on setting up Mediasika.  What is it - you can read <a href="http://habrahabr.ru/blogs/DIY/111954/">here</a> <br><img src="https://habrastorage.org/storage/habraeffect/92/b0/92b0a591282e40ce0fa249fc1a94329f.jpg" alt="image"><br><br>  Details under the cut. <br><a name="habracut"></a><br><br>  1. Install the torrent client rtorrent <br>  There are several ways to install applications in Ubuntu.  For example, you can use the Synaptic graphical client, or you can start the installation process from the console.  We will go the second way, because, firstly, it is easier to describe, and secondly, it is always useful to be able to use the console.  Moreover, we will have to contact her more than once (we're in Linux, whatever one may say). <br>  To start, start the terminal, if it is not already running.  And copy this line there: <pre><code class="bash hljs">sudo apt-get install rtorrent</code> </pre> <br>  For beginners in brief explain what it means.  "Sudo" means that the command needs to be run with administrator privileges.  "Apt-get" is a console client for installing applications.  ‚ÄúInstall‚Äù is a command to the ‚Äúapt-get‚Äù client, reporting the need to ‚Äúinstall‚Äù an application.  rtorrent, respectively, the name of the application that we install. <br>  Another little advice for those who are just starting to deal with Linux - in the console it is very convenient to use the TAB button, which ‚Äúappends‚Äù commands / paths / etc and displays their list if there is more than one option for writing.  For example, you can type the command like this: sudo apt-g [TAB] i [TAB] rto [TAB] <br>  Ok, typed the command, entered the password, the installation started.  Apt-get will ask if you are sure of what you are doing.  Click "D" (or just Enter) and the installation will go on.  Ok, we installed the app.  To check in the console, we write: <code>rtorrent</code> <br>  press Enter and the rtorrent interface should appear in front of us. <br>  Ok super.  Everything is working.  Press Ctrl + q to exit the application. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      2. We configure rtorrent <br>  In the beginning we will create directories with which we will work.  In the console, this is done with the mkdir command and specifying the directory we want to create. <br>  Accordingly, we write in the console: <br><pre> <code class="bash hljs">mkdir ~/torrents mkdir ~/.rtorrent-session mkdir /var/lib/mythtv/videos/downloads</code> </pre> <br>  "~" Is an abbreviation in Linux, indicating the path to your home directory. <br>  So, we created a ‚Äútorrents‚Äù directory in which we will have torrent files, a ‚Äú.rtorrent-session‚Äù directory in which rtorrent will store its session and a ‚Äúdownloads‚Äù directory in which rtorrent will download movies. <br>  The rtorrent settings are stored in a file called .rtorrent.rc, which is stored in your home directory.  But when you install the application, such a file is not created, so first we have to create it.  We write in the console: <code>nano ~/.rtorrent.rc</code> <br>  a console text editor opens with empty content. <br>  Insert the following lines there: <code>download_rate = 1000 <br> upload_rate = 100 <br> <br> directory=/var/lib/mythtv/videos/downloads <br> session=/home//.rtorrent-session <br> <br> schedule = u_night_mode,02:00:00,24:00:00,upload_rate=0 <br> schedule = u_day_mode,07:00:00,24:00:00,upload_rate=100 <br> schedule = d_night_mode,02:00:00,24:00:00,download_rate=0 <br> schedule = d_day_mode,07:00:00,24:00:00,download_rate=1000 <br> schedule = low_diskspace,5,60,close_low_diskspace=100M <br> <br> schedule = watch_directory,10,10,load_start=/home//torrents/*.torrent <br> <br> schedule = tied_directory,10,10,start_tied= <br> schedule = untied_directory,10,10,stop_untied= <br> <br> schedule = ratio,60,60,"stop_on_ratio=200,200M,2000" <br> <br> # Maximum and minimum number of peers to connect to per torrent <br> min_peers = 20 <br> max_peers = 40 <br> <br> # Maximum number of simultanious uploads per torrent <br> max_uploads = 5 <br> <br> encryption = allow_incoming,enable_retry,prefer_plaintext <br> port_range = 55558-55558 <br> <br> scgi_port = :5000 <br> encoding_list = UTF-8 <br> umask = 0000</code> <code>download_rate = 1000 <br> upload_rate = 100 <br> <br> directory=/var/lib/mythtv/videos/downloads <br> session=/home//.rtorrent-session <br> <br> schedule = u_night_mode,02:00:00,24:00:00,upload_rate=0 <br> schedule = u_day_mode,07:00:00,24:00:00,upload_rate=100 <br> schedule = d_night_mode,02:00:00,24:00:00,download_rate=0 <br> schedule = d_day_mode,07:00:00,24:00:00,download_rate=1000 <br> schedule = low_diskspace,5,60,close_low_diskspace=100M <br> <br> schedule = watch_directory,10,10,load_start=/home//torrents/*.torrent <br> <br> schedule = tied_directory,10,10,start_tied= <br> schedule = untied_directory,10,10,stop_untied= <br> <br> schedule = ratio,60,60,"stop_on_ratio=200,200M,2000" <br> <br> # Maximum and minimum number of peers to connect to per torrent <br> min_peers = 20 <br> max_peers = 40 <br> <br> # Maximum number of simultanious uploads per torrent <br> max_uploads = 5 <br> <br> encryption = allow_incoming,enable_retry,prefer_plaintext <br> port_range = 55558-55558 <br> <br> scgi_port = :5000 <br> encoding_list = UTF-8 <br> umask = 0000</code> <br> <br>  Do not forget in two places to replace ‚Äúyour name‚Äù with your name in the system (that is, the path to your home directory) <br><br>  Now I will describe what all these settings mean: <br>  download_rate, upload_rate - limit the speed of downlower and applode, respectively.  In kilobytes. <br>  directory - directory for saving downloaded files <br>  session - directory needed by rtorrent to save download sessions <br><br>  schedule = u_night_mode, 02: 00: 00,24: 00: 00, upload_rate = 0 <br>  schedule = u_day_mode, 07: 00: 00,24: 00: 00, upload_rate = 100 <br>  schedule = d_night_mode, 02: 00: 00,24: 00: 00, download_rate = 0 <br>  schedule = d_day_mode, 07: 00: 00,24: 00: 00, download_rate = 1000 <br>  These four lines say that from 7 am to 2 nights you need to limit the speed to 1000/100 kbps (down / up), and from 2 nights to 7 am to work without speed limits. <br><br>  schedule = low_diskspace, 5.60, close_low_diskspace = 100M <br>  This means that once a minute you need to check if the place on the hard drive is running out and stop all downloads if less than 100 megabytes are left. <br><br>  schedule = watch_directory, 10,10, load_start = / home / yourname / torrents / *. torrent <br>  every 10 seconds check if new torrent files appeared in this directory <br><br>  schedule = tied_directory, 10,10, start_tied = <br>  Start download if a new torrent file has appeared <br><br>  schedule = untied_directory, 10,10, stop_untied = <br>  Stop the download if the torrent file is deleted <br><br>  schedule = ratio, 60,60, "stop_on_ratio = 200,200M, 2000" <br>  Stop the download if its rating is&gt; = 2.00, while more than 200Mb have been added OR rating&gt; = 20.00 <br><br>  min_peers, max_peers - the minimum and maximum number of peers per torrent.  To be honest, I don‚Äôt understand what ‚Äúmin peers‚Äù means <br>  max_uploads - the maximum number of applause per torrent <br>  encryption <br>  port_range - port.  do not forget to forward the port on the DSL modem / router, by the way. <br><br>  scgi_port - the port on which the web client (which we later deliver) will work with rtorrent <br>  encoding_list - encoding <br>  umask - default rights mask <br><br>  More information about these or other settings can be read on the website rtorrent <br><br>  And we save the file (Ctrl + o, Enter) and exit the editor (Ctrl + x) <br><br>  we start rtorrent, we throw some torrent file in the ~ / torrents / directory, we check that everything works.  The download should start and the download file will appear in the videos / downloads directory.  Hooray. <br><br>  3. We learn rtorrent to work in the background and start automatically. <br>  At the same time let's overcome one bug with hanging up the rtorrent. <br>  At the beginning we put the screen: <br><pre> <code class="bash hljs">sudo apt-get install screen</code> </pre> <br><br>  Next, create a directory and scripts to run: <br><pre> <code class="bash hljs">mkdir ~/bin nano ~/bin/myrtorrent.sh</code> </pre> <br><br>  Inside we write <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash PROGRAM="/usr/bin/rtorrent" GRACE_DELAY=15 while true; do "$PROGRAM" RETURNED=$? if [ $RETURNED -ne 0 ] then echo "$PROGRAM did not exit cleanly with status code $RETURNED" echo "pausing for $GRACE_DELAY seconds before restarting $PROGRAM" sleep $GRACE_DELAY; else echo "$PROGRAM exited cleanly. It will not be restarted automatically" exit 0 fi done</span></span></code> </pre> <br>  save, exit (ctrl + o, Enter, ctrl + x) <br>  we write in the console <br><pre> <code class="bash hljs">&gt;nano ~/bin/checkrtorrent.sh</code> </pre> <br>  In the editor we write: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh if [ `pgrep myrtorrent|wc -l` -lt 1 ]; then if [ ! "$(pidof rtorrent)" ] then echo "Not running. Starting\n" /usr/bin/screen -fa -d -m -S rtorrent /home//bin/myrtorrent.sh fi fi</span></span></code> </pre> <br><br>  <b>do not forget</b> to change "your name" to your name in the system.  Save, exit. <br><br>  Thus, we have created several scripts that run rtorrent in the background and make sure that it starts successfully. <br><br>  Now we will make these scripts run.  First, let's make them "runnable" <br><pre> <code class="bash hljs">chmod +x ~/bin/checkrtorrent.sh chmod +x ~/bin/myrtorrent.sh</code> </pre> <br>  we put scripts in the task scheduler <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">crontab</span></span> -e</code> </pre> <br><br>  crontab is an application that starts other applications at a certain point.  When you first start, he will ask what text editor we want to use.  "3 - nano", of course, we will answer.  OK.  See the nano with the following content: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># mh dom mon dow command</span></span></code> </pre> <br>  Very good.  Now we enter the text we need in the line below. <br><pre> <code class="bash hljs">*/10 * * * * /home//bin/checkrtorrent.sh</code> </pre> <br>  just do not forget to replace your name with your name in the system. <br>  Ctrl + o, Enter, Ctrl + x.  You can reboot the system to check that everything is working. <br>  To do this, after a reboot, we wait a few minutes (the script is triggered once every 10 minutes) and type in the console <br><pre> <code class="bash hljs">screen -r</code> </pre> <br>  after that the rtorrent interface should appear.  To exit rtorrent, but leave it running in the background DO NOT CLICK ON Ctrl + q, but instead press "Ctrl + a" and then "d".  the program will continue to work. <br>  At any time you can see what is happening with you by typing ‚Äúscreen -r‚Äù and exit by pressing ‚Äúctrl + a, d‚Äù <br><br>  4. Install the necessary Mediagic scripts for the scripts. <br>  we write in the console <br><pre> <code class="bash hljs">sudo apt-get install php5-cli php5-curl php5-gd php5-imap</code> </pre> <br><br>  5. Install the scripts themselves. Fix config.xml <br><br>  Download the archive with the scripts and unzip it on your computer with Windows (or whatever you have).  I propose to edit it on your computer, and not on the media center, because it‚Äôs so faster <br>  Open and see several folders and files.  Open the config.xml file from the root. <br>  Begin to carefully fill in the values. <br>  Leave the verbose, system_encoding values ‚Äã‚Äãas they are <br>  We reach the group of parameters <br><pre> <code class="bash hljs">&lt;mediagic_db&gt; &lt;server&gt;localhost&lt;/server&gt; &lt;username&gt;mythtv&lt;/username&gt; &lt;password&gt;__&lt;/password&gt; &lt;db_name&gt;mediagic&lt;/db_name&gt; &lt;/mediagic_db&gt;</code> </pre> <br>  Open the console on the media center.  Typing <br><pre> <code class="bash hljs">cat /etc/mythtv/mysql.txt|grep DBPassword</code> </pre> <br>  This tricky command will allow us to see the generated password from the MythTV database.  Enter this password in the password field. <br><br>  The next parameter we are interested in is called user_agent. <br>  Previously, it was possible to do without this parameter.  user_agent is the name of your browser in which you are authorized on the tracker.  We need a browser name and cookies.  In order to rip out the value of cookies, I recommend using the Opera browser (for sure, the value of cookies can be viewed in other browsers, but I don‚Äôt know how, because I use Opera). <br>  So we go to the tracker from the opera, enter the login-password (if not yet authorized), then go to the website <a href="http://whatsmyuseragent.com/">whatsmyuseragent.com</a> (you will need the Internet). <br>  All this can be done from your desktop computer, and not from the media center. <br>  The site will show us some amount of information, at the very beginning you can read: <br>  Your User Agent is: <br>  Opera / 9.80 (Macintosh; Intel Mac OS X; U; en) Presto / 2.2.15 Version / 10.00 <br>  or something like that.  Most likely you will have Opera / 9.80 written (Windows; something there) <br>  Copy the contents of the line (starting with the word Opera) into the buffer and paste it into the xml file instead of the value specified there. <br>  The next parameter we are interested in is called "coverarts" <br>  Open the console on the media server and write: <br><pre> <code class="bash hljs">mkdir ~/.mythtv/MythVideo/</code> </pre> <br>  Go back to the configuration file and write: <br><pre> <code class="bash hljs">&lt;coverarts&gt;/home//.mythtv/MythVideo/&lt;/coverarts&gt;</code> </pre> <br>  Of course, <b>replacing</b> "yourname" in your name in the system. <br>  look further.  trash.  Ok, I suggest using a system basket for this, but you can also use any other folder.  The system basket is here. <br><pre> <code class="bash hljs">&lt;trash&gt;/home//.<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/share/Trash/files/&lt;/trash&gt;</code> </pre> <br>  as always, <b>replacing</b> your name with your name in the system. <br>  The next group of values ‚Äã‚Äãthat interests us is called mythtv <br>  We do not change anything here, just write the same password that we wrote in the mediagic_db / password field above. <br><br>  Next comes the email setup block, but I suggest not to touch it and configure it later. <br><br>  6. Edit trackers / tracker. * Tracker name * .xml <br><br>  Open the file. <br>  Open Opera.  Open your favorite tracker in the opera.  Click the right button and select "Edit Site Preferences / Site Settings."  Select the "Cookies" tab.  Below is a list of variables and values.  By double-clicking on each of the values, you can open it in a new window and copy it.  Gently fill all the parameters from the xml-file to get something like <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cookies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phpbb3_cqeo2_u</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phpbb3_cqeo2_u</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phpbb3_cqeo2_k</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phpbb3_cqeo2_k</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phpbb3_cqeo2_sid</span></span></span><span class="hljs-tag">&gt;</span></span>a3ac2ae1232c43237eac4183726370ac<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">phpbb3_cqeo2_sid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uid</span></span></span><span class="hljs-tag">&gt;</span></span>1234<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span>2abc8bf34fb7b2948dc38749cc2cacbc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PHPSESSID</span></span></span><span class="hljs-tag">&gt;</span></span>b55476116f38bcd5a91e22dc6280e4ee<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PHPSESSID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">session</span></span></span><span class="hljs-tag">&gt;</span></span>a3f616f38bcd58ab16f8bcd54916f8bc563<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">session</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mybbuser</span></span></span><span class="hljs-tag">&gt;</span></span>1234_iUn9kednIu8Jd7wOjw09JHw672lJkwdjhfwJhdeU63Jdg22hsdjciIh7HdgeY7t<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mybbuser</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hsdn_top</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hsdn_top</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cookies</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  Next, change the value of minimum_number_of_seeds to the one that interests us. <br>  We put in filters / decline filters that we don‚Äôt want to download under any circumstances. <br>  Specify max_size and min_size. <br>  Change directories / torrents_dir to the value we need <br><pre> <code class="xml hljs">/home//torrents/</code> </pre> <br>  <b>Do not forget</b> to replace your name, then change the value of directories / datafiles_dir to <br><pre> <code class="xml hljs">var/lib/mythtv/videos/downloads/</code> </pre> <br>  As a result, it looks like this for me: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directories</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ,     ---&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ! -       -   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">torrents_dir</span></span></span><span class="hljs-tag">&gt;</span></span>/home/vadim/torrents/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">torrents_dir</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ,   -  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">datafiles_dir</span></span></span><span class="hljs-tag">&gt;</span></span>/var/lib/mythtv/videos/downloads/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">datafiles_dir</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directories</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">code</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  7. Edit scrubbers / scrubber * tracker name * .xml. <br><br>  Copy the entire block of cookies from the previous file and paste it in the appropriate place here. <br>  Despite the fact that it may seem folly to write 2 times the same thing in different places, this has a definite meaning.  Let me briefly tell you how it all works and what the files listed above are responsible for. <br>  Files located in trackers / are responsible for working with trackers.  You can create the file trackers / torrents.ru.xml, prescribe the necessary values ‚Äã‚Äãthere and Mediagik will work also with torrents.ru. <br>  Files lying in scrubbers / are responsible for downloading information about the film.  Since in the case of a local tracker we take the information directly from the torrent description, it turns out that the place where we download the torrent files and where we get the information is the same site.  But it may turn out that we want to download movies with PirateBay or torrents.ru, and take information about them from film searches or from the same local torrents.  Or, on the contrary, somehow it turns out that the place from where we download movies and the place from which we take information is not always the same, just in our particular case it is the same site. <br><br>  8. Install the scripts and deploy the base. <br>  Copy the entire mediagic folder with all the corrected config files to the media server.  I recommend copying them to / var / www.  To do this, first copy the folder to anywhere, for example, in your home directory, and then write from the console <br><pre> <code class="bash hljs">sudo mv ~/mediagic /var/www/</code> </pre> <br>  We type the password and the vulya are the scripts there. <br>  Now let's create a database. <br>  typing in the console <br><br><pre> <code class="bash hljs">mysql -u root -p</code> </pre> <br>  enter your password and get inside MySQL. <br><pre> <code class="bash hljs">vadim@vadim-vmware:~$ mysql -u root -p Enter password: Welcome to the MySQL monitor. Commands end with ; or \g. Your MySQL connection id is 135 Server version: 5.0.75-0ubuntu10.2 (Ubuntu) Type <span class="hljs-string"><span class="hljs-string">'help;'</span></span> or <span class="hljs-string"><span class="hljs-string">'\h'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">help</span></span>. Type <span class="hljs-string"><span class="hljs-string">'\c'</span></span> to clear the buffer. mysql&gt;</code> </pre> <br><br>  We write the following: <br><pre> <code class="bash hljs">GRANT ALL ON *.* TO <span class="hljs-string"><span class="hljs-string">'mythtv'</span></span>@<span class="hljs-string"><span class="hljs-string">'localhost'</span></span>;</code> </pre> <br><br>  We return to the standard console. <br>  For further work, we will need a password, which we found out when config.xml was ruled. <br>  recruit <br><pre> <code class="bash hljs">mysql -u mythtv -p</code> </pre> <br>  and enter this generated password from the database.  We fall back into mysql but already under the user "mythtv".  We write: <br><pre> <code class="bash hljs"> create database mediagic; SHOW DATABASES;</code> </pre> <br><br>  as a result, we should see 4 databases <br><pre> <code class="bash hljs">mysql&gt; create database mediagic; Query OK, 1 row affected (0.00 sec) mysql&gt; SHOW DATABASES; +--------------------+ | Database | +--------------------+ | information_schema | | mediagic | | mysql | | mythconverg |</code> </pre> <br>  we write exit and we quit MySQL. <br>  We write in the console: <br><pre> <code class="bash hljs">mysql --user=mythtv --password= mediagic &lt; /var/www/mediagic/mediagic.sql</code> </pre> <br><br>  replacing the ‚Äúpassword‚Äù with the generated password from config.xml <br>  Hooray.  Database created. <br><br>  9. Check that everything works <br>  typing in the console <br><pre> <code class="bash hljs">php /var/www/mediagic/autodownload.php</code> </pre> <br>  And carefully look at what the script produces.  If everything is done correctly, then he will not give out any errors, but successfully download and write everything to the database.  According to the results of the script, several new (but not yet downloaded) films should appear in Mythtv and new downloads in rtorrent. <br>  I remind you that rtorrent can be viewed in the console by typing "screen -r" and exiting it by typing "Ctrl + a, d".  To delete a download in rtorrent, select it with the buttons up and down and press 2 times Ctrl + d (the download will stop, but the partially downloaded file will remain). <br>  MythTV can be run through Applications-&gt; Audio and Video-&gt; MythTV Frontend. <br>  ten. <br>  write in the terminal <br><br><pre> <code class="bash hljs">sudo touch /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/updatetorrents.log sudo chmod 777 /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/updatetorrents.log crontab -e</code> </pre> <br>  and add another line to the bottom <br><br><pre> <code class="bash hljs">0 * * * * /usr/bin/php /var/www/mediagic/autodownload.php &gt; /var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/updatetorrents.log</code> </pre> <br><br>  Now, once an hour, the media head will check whether new films have appeared, download them and save information to the MythTV database. <br><br>  That's all for today.  Next time, we will fight drivers and codecs, make MythTV beautiful, work with rtorrent through a beautiful web interface, screw the console, teach Mediagic to write and read mail, and also download TV shows that interest us into separate directories immediately after the appearance of at least one Sid on the tracker.  In addition, the same Makar we will teach Mediagic download the expected releases as soon as they appear. <br><br>  If you could not get something - write, let's figure it out.  If you did everything exactly as I described - then there should be no problems, unless, of course, I have not described <br><habracut></habracut></div><p>Source: <a href="https://habr.com/ru/post/111956/">https://habr.com/ru/post/111956/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111947/index.html">The jQuery 1.5 beta 1 release is available for testing.</a></li>
<li><a href="../111948/index.html">Learn more about changing the HTML video codec in Chrome.</a></li>
<li><a href="../111950/index.html">A / B Experience Test Download Page</a></li>
<li><a href="../111951/index.html">3D without glasses</a></li>
<li><a href="../111954/index.html">Mediamagiya: Come home, take the remote and choose to watch from the tracker</a></li>
<li><a href="../111957/index.html">Idea for a startup: the best technique in its niche</a></li>
<li><a href="../111958/index.html">3D printer, printing the cheapest consumables</a></li>
<li><a href="../111959/index.html">Introducing Kohana 3.0 - Part 5</a></li>
<li><a href="../111961/index.html">Use Android Search Dialog. Part 3 - Custom Suggestions</a></li>
<li><a href="../111963/index.html">Another industrial video</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>