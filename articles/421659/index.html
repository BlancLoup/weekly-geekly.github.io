<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How Microsoft forgot about half the world or read error messages</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No, this article is not about how huge and angry monster is Microsoft. And how it offends users again. And how to fix the annoying flaw that appeared ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How Microsoft forgot about half the world or read error messages</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vv/dn/d-/vvdnd-jg8bvp3c9k8rxvlubwdq8.png"></div><br>  No, this article is not about how huge and angry monster is Microsoft.  And how it offends users again.  And how to fix the annoying flaw that appeared with the latest, August update of <b>Power BI Desktop</b> with the included support for <b>Python</b> , namely, problems with visualization in localized versions of PBI, in particular <b><a href="https://ru.wikipedia.org/wiki/Matplotlib">matplotlib</a></b> . <br><br>  In the first decade of August, Microsoft released the long-awaited and anticipated release of its truly remarkable BI product with <a href="https://ru.wikipedia.org/wiki/Python">Python</a> language support.  At the time of this writing, this functionality is in the advanced features section (i.e. just a beta version). <br><a name="habracut"></a><br>  I have been using Power BI in my work for a long time and with pleasure (both as a data analyst and a BI developer).  I always try to try new features that are generously announced in the preview section.  And, we must pay tribute to the Microsoft development team, it is almost always solid, usable versions of features, options and visualizations. <br>  Particularly expected by the BI community is the inclusion of Python support in Power BI.  Not that the integrated functionality of Power BI is not enough for the implementation of the most intricate tasks solved by BI-systems.  About 250 functions of the built-in <a href="https://ru.wikipedia.org/wiki/DAX_(%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA_%25D0%25B7%25D0%25B0%25D0%25BF%25D1%2580%25D0%25BE%25D1%2581%25D0%25BE%25D0%25B2)">DAX</a> query language and even more than seven hundred Power Query functions made it possible to solve almost any BI task, from obtaining data from various sources, building a data model, and supporting visualizations and reports.  Last year, support for the R language was added, which dramatically expanded the capabilities of Power BI in terms of performing scientific calculations, new visualizations, and even machine learning. <br>  However, it is no secret that today Python is the leader among the programming languages ‚Äã‚Äãamong Data Science.  And the inclusion of this language in the BI-ecosystem Microsoft turns Power BI into a kind of Swiss knife for the preparation, analysis and final presentation of data.  With full support for four specialized languages ‚Äã‚Äã(DAX, Power Query / M, R, Python) and limited, within the required functionality of SQL and MDX.  Some geeks fasten more JavaScript, but this is a separate conversation. <br><br>  Not being a practicing Python developer, I still eagerly turned on experimental Python support to test new, opening horizons.  Ticked the menu of the latest release of PBI and rebooted the application.  You can read more about the connection and setup in the <a href="https://powerbi.microsoft.com/en-us/blog/pythonblogepisode1/">Microsoft blog</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I already had a previous version of Python installed and I decided to take a chance and not bother with installing a new one.  As a result, a new connector appeared in the data sources - the Pyton Script, and a new [ <b>Py</b> ] icon appeared on the visualization panel. <br><br>  However, at this stage the Python code was not executed.  I will not describe all peripetias connected with attempt to start in an environment familiar to me and Power BI unfamiliar (almost) Python. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iz/fd/zf/izfdzf25eygkhb_ew7dcol6qeey.png" alt="Visualization problems" width="50%"></div><br>  Anyway, even a clean installation of the Anaconda assembly with a huge number of pre-installed libraries, an advanced package manager, etc., didn‚Äôt move me to the cherished  pictures ‚Äô.  Different versions of Python gave different error messages to my test code, and I was a little discouraged.  Google search on these posts also did not give adequate results.  The Danish user‚Äôs request for a similar problem recently appeared on the portal in the Power BI community ( <a href="https://community.powerbi.com/">https://community.powerbi.com</a> ) prompted a long-standing thought - it‚Äôs not my configuration of the computer with the explosive mixture of installed software (and I checked it on various machines, but on them everywhere - an explosive mixture, only different).  The point is localization. <br>  When it became clear which way to look, more meaningful answers from search engines began to appear on refined requests.  But the meaning was the same everywhere: ‚ÄúIn the current version of Power BI you cannot use the format of numbers with a decimal point, but only with a decimal point, in conjunction with Python.  Wait for the updated version or change the format of the numbers. " <br><br>  In Power BI, you can change the format of a number in a couple of seconds through the menu, but what to do with tons of ready-made reports and source data?  The game was not worth the time here. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vr/ui/ez/vruiezaedw66na3176iecgffphm.png" alt="PBI Python set up" width="80%"></div><br>  At this moment, all the suffering "python under power bi" divided into two camps: the Americans and the British with a decimal point and all the rest.  A part of the ones "left overboard the current version" quickly went over to the first group, setting the period as the standard separator.  The rest of the duel began to wait for the corrected release.  But since  this is a beta version and translation into grocery functionality may take two months and six months, it was definitely not worth waiting for changes from day to day. <br><br>  And at that moment I decided to read the error message more closely: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rj/3p/uv/rj3puvaexotrgi-kmg2xonkj80a.jpeg" alt="Mistake" width="80%"></div><br>  More closely, because the error was not related to my code, which in <a href="https://ru.wikipedia.org/wiki/IPython">Jypyter was</a> executed just without errors and displayed all visual elements without any problems.  The problem was caused by additional code that Microsoft implemented to integrate Python with Power BI.  Namely, calling the library matplotlib ( <a href="https://ru.wikipedia.org/wiki/Matplotlib">https://ru.wikipedia.org/wiki/Matplotlib</a> ) and specifically the function pyplot (file pyplot.py). <br><br>  But then open source software to run their playful little hands into it.  Without thinking twice, opening a hundred and thirty kilobyte function code using the address given in the error text found that a failure occurs during the initialization of figManager. <br><br>  In the source code of the library, this Python code looks like this: <br><br><pre><code class="python hljs">figManager = new_figure_manager(num, figsize=figsize, dpi=dpi, facecolor=facecolor, edgecolor=edgecolor, frameon=frameon, FigureClass=FigureClass, **kwargs)</code> </pre> <br>  Observing respect for such an important library, I simply commented out the code for calling the <b>figsize</b> problem parameter, in which Microsoft sends four arguments from Poiwer BI instead of two to localized versions, and passed this value to the default size of the visualization. <br><br>  Now this code looks like this: <br><br><pre> <code class="python hljs">figManager = new_figure_manager(num, figsize=rcParams[<span class="hljs-string"><span class="hljs-string">'figure.figsize'</span></span>], <span class="hljs-comment"><span class="hljs-comment">#figsize=figsize, dpi=dpi, facecolor=facecolor, edgecolor=edgecolor, frameon=frameon, FigureClass=FigureClass, **kwargs)</span></span></code> </pre> <br>  In the current Anaconda assembly, this is 542-549 lines.  If you have a different version of the library, simply search for the ‚ÄúfigManager‚Äù entry and make the necessary changes and save the corrected library under the same name (you will need administrator rights to do this). <br><br>  After that, just restart the visualization code for execution and enjoy the result ... Well, or wait until the mountain comes to Mahomet, or rather Microsoft to Python. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3f/bt/6f/3fbt6fpa984gw7jniwutnxl2cw4.png" alt="result" width="90%"></div><br>  Yuri Kolmakov ( <a href="https://habr.com/users/mccow/" class="user_link">McCow</a> ) </div><p>Source: <a href="https://habr.com/ru/post/421659/">https://habr.com/ru/post/421659/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../421647/index.html">Convenient way to test React components</a></li>
<li><a href="../421649/index.html">‚ÄúTop 3D Expo. Digital Education 2018 ‚ÄùSeptember 21 in Technopolis Moscow</a></li>
<li><a href="../421653/index.html">Overview and design of modern electricity meters</a></li>
<li><a href="../421655/index.html">Engineers jetpack: Alexander Fedorovich Andreev</a></li>
<li><a href="../421657/index.html">JSON continuous growth</a></li>
<li><a href="../421663/index.html">Adult Containers (Part 03): 10 Things You Should Not Do with Containers</a></li>
<li><a href="../421665/index.html">Android Jetpack: turn applications into rockets</a></li>
<li><a href="../421667/index.html">CJM Meetup at MegaFon - how it was and what we talked about (video reports)</a></li>
<li><a href="../421669/index.html">The court banned the free distribution of weapons CAD-files, so the creator began to sell them</a></li>
<li><a href="../421671/index.html">Five nanotechnologies from nature that can inspire us to new developments</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>