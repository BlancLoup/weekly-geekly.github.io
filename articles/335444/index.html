<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We teach the robot to cook pizza. Part 1: Getting the Data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Image By: Chuchilko 


 Not so long ago, after the completion of the next contest for Kaggle, an idea arose to try to make a test ML application. 
 Fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We teach the robot to cook pizza. Part 1: Getting the Data</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/web/bf8/697/a4c/bf8697a4c0e2493e9b6fc7009bb4b83d.png"><br>  <em>Image By: Chuchilko</em> </p><br><p>  Not so long ago, after the completion of the next contest for Kaggle, an idea arose to try to make a test ML application. <br>  For example, this: <em>"help the robot to make a pizza</em> . <em>"</em> </p><br><p>  Of course, the main purpose of this is exactly the same - the study of the new. </p><br><p>  I wanted to understand how Generative Adversarial Networks (GAN) work. </p><br><p>  The key idea was to train the GAN, which on the selected ingredients itself collects a picture of a pizza. </p><br><p>  Well, let's get started. </p><a name="habracut"></a><br><h3 id="nachalo">  Start </h3><br><p>  Of course, to train any machine learning algorithm, we first need data. <br>  In our case, there are not so many options - either to find a ready dataset, or to pull data from the Internet independently. </p><br><p>  And then I thought - why not pull the data from the site Dodo-pizza. </p><br><div class="spoiler">  <b class="spoiler_title">Disclaimer</b> <div class="spoiler_text"><p>  I have nothing to do with this pizzeria chain. <br>  Honestly, I don‚Äôt particularly like their pizza - especially at a price (and size), in my city (Kaliningrad) there are more attractive pizzerias. </p></div></div><br><p>  So, in the first paragraph of the action plan appeared: </p><br><ol><li>  get the data from the site </li></ol><br><h3 id="zagruzka-dannyh">  Data loading </h3><br><p>  Since all the information we need is available on the Dodo-Pizza website, we apply the so-called parsing of sites (also known as Web Scraping). </p><br><p>  This is where the article: <a href="https://habrahabr.ru/post/280238/">Web Scraping with python</a> will help us. </p><br><p>  And only two libraries: </p><br><pre><code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> bs4</code> </pre> <br><p>  Open the dodo-pizza site, click on the <em>"View Code"</em> browser and find the element with the necessary data. <br><img src="https://habrastorage.org/web/d63/fd6/0da/d63fd60dae3046b89f69fbd3e8381b08.png"></p><br><p>  On the main page you can get only a basic list of pizzas and their composition. <br>  More information can be obtained by clicking on the product you like.  A pop-up window will then appear, with detailed information and beautiful pizza pictures. <br><img src="https://habrastorage.org/web/cf8/e4f/d9b/cf8e4fd9b3bb4fe5a1c15c47e2b97104.png"><br>  This window appears as a result of a GET request, which can be emulated by passing the necessary headers: </p><br><pre> <code class="hljs cs">headers = { <span class="hljs-string"><span class="hljs-string">'user-agent'</span></span>: <span class="hljs-string"><span class="hljs-string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36'</span></span>, <span class="hljs-string"><span class="hljs-string">'Referer'</span></span>: siteurl, <span class="hljs-string"><span class="hljs-string">'x-requested-with'</span></span>: <span class="hljs-string"><span class="hljs-string">'XMLHttpRequest'</span></span> } res = requests.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(siteurl, headers = headers)</code> </pre> <br><p>  in response, we get a piece of html-code that can already be parsed. </p><br><p>  Immediately, you can note that static content is distributed via akamaihd.net <strong>CDN</strong> </p><br><p>  After a short experiment - it turned out the <a href="https://github.com/noonv/dodorobot/blob/master/dodo_scrapping.py">dodo_scrapping.py</a> script, which receives the name of the pizzas from their dodo-pizza site, their composition, and also stores three pizza photos in separate directories. </p><br><p>  The output of the script is several csv-files and directories with photos. <br>  For this, the following actions are performed: </p><br><ul><li>  getting a list of cities (at that time - 146) </li><li>  getting a list of pizzas (for the City) </li><li>  getting pizza info </li><li>  loading pizza pictures </li></ul><br><p>  Information about the pizza is stored in the form of the form: <br>  city, city URL, name, title ENG, pizza URL, content, price, calories, carbohydrates, proteins, fats, diameter, weight </p><br><p>  What is good about programming automation scripts is that you can start them and lean back on the chair list to watch them work ... </p><br><p>  The output turned out only 20 pizzas. <br>  For each pizza you get 3 pictures.  We are only interested in the third picture, which has a type of pizza on top. </p><br><p>  Of course, after receiving the pictures, they need to be further processed - cut and center the pizza. <br>  I think this should not be a particular problem, since all the pictures are the same - 710x380. </p><br><h3 id="obrabotka-dannyh">  Data processing </h3><br><p>  After the scraping of the site, we got the kaggle familiar with the csv file with the data (and the directories with pictures). <br>  It is time to explore the pizza. </p><br><p>  We connect the necessary libraries. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt %matplotlib inline <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns np.random.seed(<span class="hljs-number"><span class="hljs-number">42</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys</code> </pre> <br><pre> <code class="python hljs">df = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'pizzas.csv'</span></span>, encoding=<span class="hljs-string"><span class="hljs-string">'cp1251'</span></span>) print(df.shape)</code> </pre> <br><pre> <code class="hljs lisp">(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>)</code> </pre> <br><pre> <code class="python hljs">df.info()</code> </pre> <br><pre> <code class="hljs pgsql">&lt;<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-string"><span class="hljs-string">'pandas.core.frame.DataFrame'</span></span>&gt; Range<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> entries, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span> Data <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> (total <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>): city_name <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> city_url <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_name <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_eng_name <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_url <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_contain <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_price <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 kiloCalories <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> carbohydrates <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> proteins <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> fats <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> size <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> int64 weight <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> dtypes: int64(<span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) memory <span class="hljs-keyword"><span class="hljs-keyword">usage</span></span>: <span class="hljs-number"><span class="hljs-number">2.1</span></span>+ KB</code> </pre> <br><pre> <code class="python hljs">df.head()</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  city_name </th><th>  city_url </th><th>  pizza_name </th><th>  pizza_eng_name </th><th>  pizza_url </th><th>  pizza_contain </th><th>  pizza_price </th><th>  kiloCalories </th><th>  carbohydrates </th><th>  proteins </th><th>  fats </th><th>  size </th><th>  weight </th></tr></thead><tbody><tr><th>  0 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Double pepperoni </td><td>  double-pepperoni </td><td>  https: //dodopizza.ru/Kaliningrad/Product/doubl ... </td><td>  Tomato sauce, a double portion of pepperoni and ... </td><td>  395 </td><td>  257.52 </td><td>  26.04 </td><td>  10.77 </td><td>  12.11 </td><td>  25 </td><td>  470 ¬± 50 </td></tr><tr><th>  one </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Crazy Pizza </td><td>  crazy-pizza </td><td>  https: //dodopizza.ru/Kaliningrad/Product/crazy ... </td><td>  Tomato sauce, increased portions of chicken and ... </td><td>  395 </td><td>  232.37 </td><td>  31.33 </td><td>  9.08 </td><td>  7.64 </td><td>  25 </td><td>  410 ¬± 50 </td></tr><tr><th>  2 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Don Bacon </td><td>  pizza-don-bekon </td><td>  https: //dodopizza.ru/Kaliningrad/Product/pizza ... </td><td>  Tomato sauce, bacon, pepperoni, chicken, cur ... </td><td>  395 </td><td>  274 </td><td>  25.2 </td><td>  9.8 </td><td>  14.8 </td><td>  25 </td><td>  454 ¬± 50 </td></tr><tr><th>  3 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Mushrooms and ham </td><td>  gribvetchina </td><td>  https: //dodopizza.ru/Kaliningrad/Product/gribv ... </td><td>  Tomato sauce, ham, mushrooms, mozzarella </td><td>  315 </td><td>  189 </td><td>  23.9 </td><td>  9.3 </td><td>  6.1 </td><td>  25 </td><td>  370 ¬± 50 </td></tr><tr><th>  four </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Pizza pie </td><td>  pizza-pirog </td><td>  https: //dodopizza.ru/Kaliningrad/Product/pizza ... </td><td>  Condensed milk, cranberries, pineapples </td><td>  315 </td><td>  144.9 </td><td>  29.8 </td><td>  2.9 </td><td>  2.7 </td><td>  25 </td><td>  420 ¬± 50 </td></tr></tbody></table><br><br><h3 id="privedyom-dannye-k-bolee-udobnomu-vidu">  We give data to a more convenient form. </h3><br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'kiloCalories'</span></span>] = df.kiloCalories.apply(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x.replace(<span class="hljs-string"><span class="hljs-string">','</span></span>,<span class="hljs-string"><span class="hljs-string">'.'</span></span>)) df[<span class="hljs-string"><span class="hljs-string">'carbohydrates'</span></span>] = df.carbohydrates.apply(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x.replace(<span class="hljs-string"><span class="hljs-string">','</span></span>,<span class="hljs-string"><span class="hljs-string">'.'</span></span>)) df[<span class="hljs-string"><span class="hljs-string">'proteins'</span></span>] = df.proteins.apply(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x.replace(<span class="hljs-string"><span class="hljs-string">','</span></span>,<span class="hljs-string"><span class="hljs-string">'.'</span></span>)) df[<span class="hljs-string"><span class="hljs-string">'fats'</span></span>] = df.fats.apply(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x.replace(<span class="hljs-string"><span class="hljs-string">','</span></span>,<span class="hljs-string"><span class="hljs-string">'.'</span></span>)) df[<span class="hljs-string"><span class="hljs-string">'weight'</span></span>], df[<span class="hljs-string"><span class="hljs-string">'weight_err'</span></span>] = df[<span class="hljs-string"><span class="hljs-string">'weight'</span></span>].str.split(<span class="hljs-string"><span class="hljs-string">'¬±'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).str</code> </pre> <br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'kiloCalories'</span></span>] = df.kiloCalories.astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) df[<span class="hljs-string"><span class="hljs-string">'carbohydrates'</span></span>] = df.carbohydrates.astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) df[<span class="hljs-string"><span class="hljs-string">'proteins'</span></span>] = df.proteins.astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) df[<span class="hljs-string"><span class="hljs-string">'fats'</span></span>] = df.fats.astype(<span class="hljs-string"><span class="hljs-string">'float32'</span></span>) df[<span class="hljs-string"><span class="hljs-string">'weight'</span></span>] = df.weight.astype(<span class="hljs-string"><span class="hljs-string">'int64'</span></span>) df[<span class="hljs-string"><span class="hljs-string">'weight_err'</span></span>] = df.weight_err.astype(<span class="hljs-string"><span class="hljs-string">'int64'</span></span>)</code> </pre> <br><pre> <code class="python hljs">df.head()</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <table border="1"><thead><tr><th></th><th>  city_name </th><th>  city_url </th><th>  pizza_name </th><th>  pizza_eng_name </th><th>  pizza_url </th><th>  pizza_contain </th><th>  pizza_price </th><th>  kiloCalories </th><th>  carbohydrates </th><th>  proteins </th><th>  fats </th><th>  size </th><th>  weight </th><th>  weight_err </th></tr></thead><tbody><tr><th>  0 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Double pepperoni </td><td>  double-pepperoni </td><td>  https: //dodopizza.ru/Kaliningrad/Product/doubl ... </td><td>  Tomato sauce, a double portion of pepperoni and ... </td><td>  395 </td><td>  257.519989 </td><td>  04/26/2001 </td><td>  10.77 </td><td>  12.11 </td><td>  25 </td><td>  470 </td><td>  50 </td></tr><tr><th>  one </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Crazy Pizza </td><td>  crazy-pizza </td><td>  https: //dodopizza.ru/Kaliningrad/Product/crazy ... </td><td>  Tomato sauce, increased portions of chicken and ... </td><td>  395 </td><td>  232.369995 </td><td>  31.330000 </td><td>  9.08 </td><td>  7.64 </td><td>  25 </td><td>  410 </td><td>  50 </td></tr><tr><th>  2 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Don Bacon </td><td>  pizza-don-bekon </td><td>  https: //dodopizza.ru/Kaliningrad/Product/pizza ... </td><td>  Tomato sauce, bacon, pepperoni, chicken, cur ... </td><td>  395 </td><td>  274.000000 </td><td>  25.200001 </td><td>  9.80 </td><td>  14.80 </td><td>  25 </td><td>  454 </td><td>  50 </td></tr><tr><th>  3 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Mushrooms and ham </td><td>  gribvetchina </td><td>  https: //dodopizza.ru/Kaliningrad/Product/gribv ... </td><td>  Tomato sauce, ham, mushrooms, mozzarella </td><td>  315 </td><td>  189.000000 </td><td>  23.900000 </td><td>  9.30 </td><td>  6.10 </td><td>  25 </td><td>  370 </td><td>  50 </td></tr><tr><th>  four </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Pizza pie </td><td>  pizza-pirog </td><td>  https: //dodopizza.ru/Kaliningrad/Product/pizza ... </td><td>  Condensed milk, cranberries, pineapples </td><td>  315 </td><td>  144.899994 </td><td>  29.799999 </td><td>  2.90 </td><td>  2.70 </td><td>  25 </td><td>  420 </td><td>  50 </td></tr></tbody></table><br><br><p>  Given that the nutritional value of the product is calculated per 100 grams, then for a better understanding, we multiply them by the mass of pizza. </p><br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'pizza_kiloCalories'</span></span>] = df.kiloCalories * df.weight / <span class="hljs-number"><span class="hljs-number">100</span></span> df[<span class="hljs-string"><span class="hljs-string">'pizza_carbohydrates'</span></span>] = df.carbohydrates * df.weight / <span class="hljs-number"><span class="hljs-number">100</span></span> df[<span class="hljs-string"><span class="hljs-string">'pizza_proteins'</span></span>] = df.proteins * df.weight / <span class="hljs-number"><span class="hljs-number">100</span></span> df[<span class="hljs-string"><span class="hljs-string">'pizza_fats'</span></span>] = df.fats * df.weight / <span class="hljs-number"><span class="hljs-number">100</span></span></code> </pre> <br><pre> <code class="python hljs">df.describe()</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  pizza_price </th><th>  kiloCalories </th><th>  carbohydrates </th><th>  proteins </th><th>  fats </th><th>  size </th><th>  weight </th><th>  weight_err </th><th>  pizza_kiloCalories </th><th>  pizza_carbohydrates </th><th>  pizza_proteins </th><th>  pizza_fats </th></tr></thead><tbody><tr><th>  count </th><td>  20.00000 </td><td>  20.000000 </td><td>  20.000000 </td><td>  20.000000 </td><td>  20.00000 </td><td>  20.0 </td><td>  20.000000 </td><td>  20.0 </td><td>  20.000000 </td><td>  20.000000 </td><td>  20.000000 </td><td>  20.000000 </td></tr><tr><th>  mean </th><td>  370.50000 </td><td>  212.134491 </td><td>  25.443501 </td><td>  8.692500 </td><td>  8.44250 </td><td>  25.0 </td><td>  457.700000 </td><td>  50.0 </td><td>  969.942043 </td><td>  115.867950 </td><td>  39.857950 </td><td>  38.736650 </td></tr><tr><th>  std </th><td>  33.16228 </td><td>  34.959122 </td><td>  2.204143 </td><td>  1.976283 </td><td>  3.20358 </td><td>  0.0 </td><td>  43.727746 </td><td>  0.0 </td><td>  175.835991 </td><td>  8.295421 </td><td>  9.989803 </td><td>  15.206275 </td></tr><tr><th>  min </th><td>  315.00000 </td><td>  144.899994 </td><td>  22.100000 </td><td>  2,900,000 </td><td>  2,70000 </td><td>  25.0 </td><td>  370.000000 </td><td>  50.0 </td><td>  608.579974 </td><td>  88.429999 </td><td>  12.180000 </td><td>  11.340000 </td></tr><tr><th>  25% </th><td>  367.50000 </td><td>  188.250000 </td><td>  23.975000 </td><td>  7.975000 </td><td>  05.05000 </td><td>  25.0 </td><td>  420.000000 </td><td>  50.0 </td><td>  858.525000 </td><td>  113.010003 </td><td>  35.625000 </td><td>  28.159999 </td></tr><tr><th>  50% </th><td>  385.00000 </td><td>  212.500000 </td><td>  24.950000 </td><td>  9.090000 </td><td>  8.20000 </td><td>  25.0 </td><td>  460.000000 </td><td>  50.0 </td><td>  966.358490 </td><td>  114.779002 </td><td>  39.580000 </td><td>  35.930001 </td></tr><tr><th>  75% </th><td>  395.00000 </td><td>  235.527496 </td><td>  26.280001 </td><td>  9.800000 </td><td>  9.77500 </td><td>  25.0 </td><td>  485.000000 </td><td>  50.0 </td><td>  1095.459991 </td><td>  120.597001 </td><td>  45.707500 </td><td>  47.020001 </td></tr><tr><th>  max </th><td>  395.00000 </td><td>  274.000000 </td><td>  31.330000 </td><td>  12.200000 </td><td>  14,80000 </td><td>  25.0 </td><td>  560.000000 </td><td>  50.0 </td><td>  1243.960000 </td><td>  128.453000 </td><td>  60.999999 </td><td>  68.080001 </td></tr></tbody></table><br><br><h3 id="nastala-pora-uznat-kakie-zhe-piccy-samye-samye">  It is time to find out what the most-most pizzas ... </h3><br><p>  So, the most high-calorie pizza </p><br><pre> <code class="python hljs">df[df.pizza_kiloCalories == np.max(df.pizza_kiloCalories)]</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  city_name </th><th>  city_url </th><th>  pizza_name </th><th>  pizza_eng_name </th><th>  pizza_url </th><th>  pizza_contain </th><th>  pizza_price </th><th>  kiloCalories </th><th>  carbohydrates </th><th>  proteins </th><th>  fats </th><th>  size </th><th>  weight </th><th>  weight_err </th><th>  pizza_kiloCalories </th><th>  pizza_carbohydrates </th><th>  pizza_proteins </th><th>  pizza_fats </th></tr></thead><tbody><tr><th>  2 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Don Bacon </td><td>  pizza-don-bekon </td><td>  https: //dodopizza.ru/Kaliningrad/Product/pizza ... </td><td>  Tomato sauce, bacon, pepperoni, chicken, cur ... </td><td>  395 </td><td>  274.0 </td><td>  25.200001 </td><td>  9.8 </td><td>  14.8 </td><td>  25 </td><td>  454 </td><td>  50 </td><td>  1243.96 </td><td>  114.408003 </td><td>  44.492001 </td><td>  67.192001 </td></tr></tbody></table><br><br><p>  The fattest pizza: </p><br><pre> <code class="python hljs">df[df.pizza_fats == np.max(df.pizza_fats)]</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  city_name </th><th>  city_url </th><th>  pizza_name </th><th>  pizza_eng_name </th><th>  pizza_url </th><th>  pizza_contain </th><th>  pizza_price </th><th>  kiloCalories </th><th>  carbohydrates </th><th>  proteins </th><th>  fats </th><th>  size </th><th>  weight </th><th>  weight_err </th><th>  pizza_kiloCalories </th><th>  pizza_carbohydrates </th><th>  pizza_proteins </th><th>  pizza_fats </th></tr></thead><tbody><tr><th>  14 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Meat </td><td>  myasnaya-pizza </td><td>  https: //dodopizza.ru/Kaliningrad/Product/myasn ... </td><td>  Tomato sauce, hunting sausages, bacon, ham ... </td><td>  395 </td><td>  268.0 </td><td>  24.200001 </td><td>  9.1 </td><td>  14.8 </td><td>  25 </td><td>  460 </td><td>  50 </td><td>  1232.8 </td><td>  111.320004 </td><td>  41.860002 </td><td>  68.080001 </td></tr></tbody></table><br><br><p>  The richest in carbohydrates: </p><br><pre> <code class="python hljs">df[df.pizza_carbohydrates == np.max(df.pizza_carbohydrates)]</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  city_name </th><th>  city_url </th><th>  pizza_name </th><th>  pizza_eng_name </th><th>  pizza_url </th><th>  pizza_contain </th><th>  pizza_price </th><th>  kiloCalories </th><th>  carbohydrates </th><th>  proteins </th><th>  fats </th><th>  size </th><th>  weight </th><th>  weight_err </th><th>  pizza_kiloCalories </th><th>  pizza_carbohydrates </th><th>  pizza_proteins </th><th>  pizza_fats </th></tr></thead><tbody><tr><th>  one </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Crazy Pizza </td><td>  crazy-pizza </td><td>  https: //dodopizza.ru/Kaliningrad/Product/crazy ... </td><td>  Tomato sauce, increased portions of chicken and ... </td><td>  395 </td><td>  232.369995 </td><td>  31.33 </td><td>  9.08 </td><td>  7.64 </td><td>  25 </td><td>  410 </td><td>  50 </td><td>  952.71698 </td><td>  128.453 </td><td>  37.228 </td><td>  31.323999 </td></tr></tbody></table><br><br><p>  The richest in proteins: </p><br><pre> <code class="python hljs">df[df.pizza_proteins == np.max(df.pizza_proteins)]</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  city_name </th><th>  city_url </th><th>  pizza_name </th><th>  pizza_eng_name </th><th>  pizza_url </th><th>  pizza_contain </th><th>  pizza_price </th><th>  kiloCalories </th><th>  carbohydrates </th><th>  proteins </th><th>  fats </th><th>  size </th><th>  weight </th><th>  weight_err </th><th>  pizza_kiloCalories </th><th>  pizza_carbohydrates </th><th>  pizza_proteins </th><th>  pizza_fats </th></tr></thead><tbody><tr><th>  7 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Hawaiian </td><td>  gavayskaya-pizza </td><td>  https: //dodopizza.ru/Kaliningrad/Product/gavay ... </td><td>  Tomato sauce, pineapples, chicken, mozzarella </td><td>  315 </td><td>  216.0 </td><td>  25.0 </td><td>  12.2 </td><td>  7.4 </td><td>  25 </td><td>  500 </td><td>  50 </td><td>  1080.0 </td><td>  125.0 </td><td>  60.999999 </td><td>  37.0 </td></tr></tbody></table><br><br><p>  The heaviest pizza by weight: </p><br><pre> <code class="python hljs">df[df.weight == np.max(df.weight)]</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  city_name </th><th>  city_url </th><th>  pizza_name </th><th>  pizza_eng_name </th><th>  pizza_url </th><th>  pizza_contain </th><th>  pizza_price </th><th>  kiloCalories </th><th>  carbohydrates </th><th>  proteins </th><th>  fats </th><th>  size </th><th>  weight </th><th>  weight_err </th><th>  pizza_kiloCalories </th><th>  pizza_carbohydrates </th><th>  pizza_proteins </th><th>  pizza_fats </th></tr></thead><tbody><tr><th>  eight </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Dodo </td><td>  pizza-dodo </td><td>  https: //dodopizza.ru/Kaliningrad/Product/pizza ... </td><td>  Tomato sauce, beef (minced meat), ham, peppa ... </td><td>  395 </td><td>  203.899994 </td><td>  22.1 </td><td>  8.6 </td><td>  8.9 </td><td>  25 </td><td>  560 </td><td>  50 </td><td>  1141.839966 </td><td>  123.760002 </td><td>  48.160002 </td><td>  49.839998 </td></tr></tbody></table><br><br><p>  The easiest pizza by weight: </p><br><pre> <code class="python hljs">df[df.weight == np.min(df.weight)]</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  city_name </th><th>  city_url </th><th>  pizza_name </th><th>  pizza_eng_name </th><th>  pizza_url </th><th>  pizza_contain </th><th>  pizza_price </th><th>  kiloCalories </th><th>  carbohydrates </th><th>  proteins </th><th>  fats </th><th>  size </th><th>  weight </th><th>  weight_err </th><th>  pizza_kiloCalories </th><th>  pizza_carbohydrates </th><th>  pizza_proteins </th><th>  pizza_fats </th></tr></thead><tbody><tr><th>  3 </th><td>  Kaliningrad </td><td>  / Kaliningrad </td><td>  Mushrooms and ham </td><td>  gribvetchina </td><td>  https: //dodopizza.ru/Kaliningrad/Product/gribv ... </td><td>  Tomato sauce, ham, mushrooms, mozzarella </td><td>  315 </td><td>  189.0 </td><td>  23.9 </td><td>  9.3 </td><td>  6.1 </td><td>  25 </td><td>  370 </td><td>  50 </td><td>  699.3 </td><td>  88.429999 </td><td>  34.410001 </td><td>  22.57 </td></tr></tbody></table><br><br><h3 id="poluchaem-nazvaniya-picc">  Get pizza names </h3><br><pre> <code class="python hljs">pizza_names = df[<span class="hljs-string"><span class="hljs-string">'pizza_name'</span></span>].tolist() pizza_eng_names = df[<span class="hljs-string"><span class="hljs-string">'pizza_eng_name'</span></span>].tolist() print( pizza_eng_names )</code> </pre> <br><pre> <code class="hljs json">['double-pepperoni', 'crazy-pizza', 'pizza-don-bekon', 'gribvetchina', 'pizza-pirog', 'pizza-margarita', 'syrnaya-pizza', 'gavayskaya-pizza', 'pizza-dodo', 'pizza-chetyre-sezona', 'ovoshi-i-griby', 'italyanskaya-pizza', 'meksikanskaya-pizza', 'morskaya-pizza', 'myasnaya-pizza', 'pizza-pepperoni', 'ranch-pizza', 'pizza-syrnyi-cyplenok', 'pizza-cyplenok-barbekyu', 'chizburger-pizza']</code> </pre> <br><h3 id="poluchaem-put-do-kartinok---nas-interesuet-3-ya-kartinka-vid-sverhu">  We get the way to the pictures - we are interested in the 3rd picture (top view) </h3><br><pre> <code class="python hljs">image_paths = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> pizza_eng_names: path = os.path.join(name, name+<span class="hljs-string"><span class="hljs-string">'3.jpg'</span></span>) image_paths.append(path) print(image_paths)</code> </pre> <br><pre> <code class="hljs json">['double-pepperoni\\double-pepperoni3.jpg', 'crazy-pizza\\crazy-pizza3.jpg', 'pizza-don-bekon\\pizza-don-bekon3.jpg', 'gribvetchina\\gribvetchina3.jpg', 'pizza-pirog\\pizza-pirog3.jpg', 'pizza-margarita\\pizza-margarita3.jpg', 'syrnaya-pizza\\syrnaya-pizza3.jpg', 'gavayskaya-pizza\\gavayskaya-pizza3.jpg', 'pizza-dodo\\pizza-dodo3.jpg', 'pizza-chetyre-sezona\\pizza-chetyre-sezona3.jpg', 'ovoshi-i-griby\\ovoshi-i-griby3.jpg', 'italyanskaya-pizza\\italyanskaya-pizza3.jpg', 'meksikanskaya-pizza\\meksikanskaya-pizza3.jpg', 'morskaya-pizza\\morskaya-pizza3.jpg', 'myasnaya-pizza\\myasnaya-pizza3.jpg', 'pizza-pepperoni\\pizza-pepperoni3.jpg', 'ranch-pizza\\ranch-pizza3.jpg', 'pizza-syrnyi-cyplenok\\pizza-syrnyi-cyplenok3.jpg', 'pizza-cyplenok-barbekyu\\pizza-cyplenok-barbekyu3.jpg', 'chizburger-pizza\\chizburger-pizza3.jpg']</code> </pre> <br><h3 id="zagruzhaem-kartinki">  Loading pictures </h3><br><pre> <code class="python hljs">images = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> path <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> image_paths: print(<span class="hljs-string"><span class="hljs-string">'Load image:'</span></span>, path) image = cv2.imread(path) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> image <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: images.append(image) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print(<span class="hljs-string"><span class="hljs-string">'Error read image:'</span></span>, path)</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: <span class="hljs-type"><span class="hljs-type">double</span></span>-pepperoni\<span class="hljs-type"><span class="hljs-type">double</span></span>-pepperoni3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: crazy-pizza\crazy-pizza3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: pizza-don-bekon\pizza-don-bekon3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: gribvetchina\gribvetchina3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: pizza-pirog\pizza-pirog3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: pizza-margarita\pizza-margarita3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: syrnaya-pizza\syrnaya-pizza3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: gavayskaya-pizza\gavayskaya-pizza3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: pizza-dodo\pizza-dodo3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: pizza-chetyre-sezona\pizza-chetyre-sezona3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: ovoshi-i-griby\ovoshi-i-griby3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: italyanskaya-pizza\italyanskaya-pizza3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: meksikanskaya-pizza\meksikanskaya-pizza3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: morskaya-pizza\morskaya-pizza3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: myasnaya-pizza\myasnaya-pizza3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: pizza-pepperoni\pizza-pepperoni3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: ranch-pizza\ranch-pizza3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: pizza-syrnyi-cyplenok\pizza-syrnyi-cyplenok3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: pizza-cyplenok-barbekyu\pizza-cyplenok-barbekyu3.jpg <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> image: chizburger-pizza\chizburger-pizza3.jpg</code> </pre> <br><h3 id="posmotrim-na-kartinku">  Look at the picture </h3><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot_img</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(img)</span></span></span><span class="hljs-function">:</span></span> img_rgb = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) plt.imshow(img_rgb) print(images[<span class="hljs-number"><span class="hljs-number">0</span></span>].shape) plot_img(images[<span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre> <br><pre> <code class="hljs lisp">(<span class="hljs-number"><span class="hljs-number">380</span></span>, <span class="hljs-number"><span class="hljs-number">710</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/web/dc2/ccb/f42/dc2ccbf42129472f82f364f52db3d0ec.png"></p><br><h3 id="piccy-raspolagayutsya-v-odnoy-i-toy-zhe-oblasti---vyrezaem">  Pizza are located in the same area - cut out </h3><br><pre> <code class="python hljs">pizza_imgs = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> img <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> images: y, x, height, width = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">165</span></span>, <span class="hljs-number"><span class="hljs-number">380</span></span>, <span class="hljs-number"><span class="hljs-number">380</span></span> pizza_crop = img[y:y+height, x:x+width] pizza_imgs.append(pizza_crop) print(pizza_imgs[<span class="hljs-number"><span class="hljs-number">0</span></span>].shape) print(len(pizza_imgs)) plot_img(pizza_imgs[<span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre> <br><pre> <code class="hljs lisp">(<span class="hljs-number"><span class="hljs-number">380</span></span>, <span class="hljs-number"><span class="hljs-number">380</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-number"><span class="hljs-number">20</span></span></code> </pre> <br><p><img src="https://habrastorage.org/web/531/2ee/4c9/5312ee4c9f7e4eeea73596c4900f34bc.png"></p><br><h3 id="posmotrim-vse-fotografii">  See all the pictures </h3><br><pre> <code class="python hljs">fig = plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, len(pizza_imgs)): fig.add_subplot(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,i+<span class="hljs-number"><span class="hljs-number">1</span></span>) plot_img(pizza_imgs[i])</code> </pre><br><p><img src="https://habrastorage.org/web/566/dff/4b4/566dff4b44924199a39686f8af56f441.png"></p><br><p>  Pizza four seasons clearly stands out in its structure, since, in fact, consists of four different pizzas. </p><br><h3 id="izuchim-ingredienty">  Learn the ingredients </h3><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">split_contain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(contain)</span></span></span><span class="hljs-function">:</span></span> lst = contain.split(<span class="hljs-string"><span class="hljs-string">','</span></span>) print(len(lst),<span class="hljs-string"><span class="hljs-string">':'</span></span>, lst) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> df.iterrows(): split_contain(row.pizza_contain)</code> </pre> <br><pre> <code class="hljs cs"><span class="hljs-number"><span class="hljs-number">2</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'       '</span></span>] <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'     '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' - '</span></span>] <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">3</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'   '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'    '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">9</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  ()'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">8</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">9</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">8</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">5</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">3</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'   '</span></span>] <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>] <span class="hljs-number"><span class="hljs-number">7</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>]</code> </pre> <br><p>  The problem is that in several pizzas the following modifiers are indicated: </p><br><ul><li>  "double portion" </li><li>  "increased portion" </li></ul><br><p>  At the same time, after the modifiers, there may be a list of ingredients through the union I. </p><br><p>  Hypotheses: </p><br><ul><li>  modifier double portion can be replaced by specifying the desired ingredient twice. </li><li>  the modifier may be omitted the increased portion (as the difference is not noticeable in the photos) </li></ul><br><p>  We see that the modifier "increased portion" refers only to mozzarella cheese. <br>  It also occurs once: <br>  "increased portion of mozzarella cheese" </p><br><p>  By the way, it immediately catches the eye that the main sauce used is tomato, and cheese is mozzarella. </p><br><h3 id="pochistim-ingedienty-chtoby-privesti-k-normalnomu-vidu">  Clean the ingredients to normal </h3><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">split_contain2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(contain)</span></span></span><span class="hljs-function">:</span></span> lst = contain.split(<span class="hljs-string"><span class="hljs-string">','</span></span>) <span class="hljs-comment"><span class="hljs-comment">#print(len(lst),':', lst) for i in range(len(lst)): item = lst[i] item = item.replace(' ', '') item = item.replace(' ', '') item = item.replace(' ', '') item = item.replace('', '') item = item.replace('', '') and_pl = item.find('  ') if and_pl != -1: item1 = item[0:and_pl] item2 = item[and_pl+3:] item = item1 lst.insert(i+1, item2.strip()) double_pl = item.find('  ') if double_pl != -1: item = item[double_pl+15:] lst.insert(i+1, item.strip()) lst[i] = item.strip() # last one for i in range(len(lst)): lst[i] = lst[i].strip() print(len(lst),':', lst) return lst ingredients = [] ingredients_count = [] for i, row in df.iterrows(): print(row.pizza_name) lst = split_contain2(row.pizza_contain) ingredients.append(lst) ingredients_count.append(len(lst)) ingredients_count</span></span></code> </pre> <br><pre> <code class="hljs cs">  <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]   <span class="hljs-number"><span class="hljs-number">5</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'- '</span></span>]   <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]    <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>] - <span class="hljs-number"><span class="hljs-number">3</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]  <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]  <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]  <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]  <span class="hljs-number"><span class="hljs-number">9</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' ()'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]   <span class="hljs-number"><span class="hljs-number">8</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]    <span class="hljs-number"><span class="hljs-number">9</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]  <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]  <span class="hljs-number"><span class="hljs-number">8</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]  <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]  <span class="hljs-number"><span class="hljs-number">5</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]  <span class="hljs-number"><span class="hljs-number">3</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]   <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]   <span class="hljs-number"><span class="hljs-number">4</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>]   <span class="hljs-number"><span class="hljs-number">6</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>] - <span class="hljs-number"><span class="hljs-number">7</span></span> : [<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>] [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>]</code> </pre> <br><h3 id="posmotrim-minimalnoe-i-maksimalnoe-kolichestvo-ingredientov">  Let's look at the minimum and maximum number of ingredients. </h3><br><pre> <code class="python hljs">min_count = np.min(ingredients_count) print(<span class="hljs-string"><span class="hljs-string">'min:'</span></span>, min_count) max_count = np.max(ingredients_count) print(<span class="hljs-string"><span class="hljs-string">'max:'</span></span>, max_count)</code> </pre> <br><pre> <code class="hljs swift"><span class="hljs-built_in"><span class="hljs-built_in">min</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-built_in"><span class="hljs-built_in">max</span></span>: <span class="hljs-number"><span class="hljs-number">9</span></span></code> </pre> <br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">'min:'</span></span>, np.array(pizza_names)[ingredients_count == min_count] ) print(<span class="hljs-string"><span class="hljs-string">'max:'</span></span>, np.array(pizza_names)[ingredients_count == max_count] )</code> </pre> <br><pre> <code class="hljs matlab"><span class="hljs-built_in"><span class="hljs-built_in">min</span></span>: [<span class="hljs-string"><span class="hljs-string">'-'</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">max</span></span>: [<span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-string"><span class="hljs-string">'  '</span></span>]</code> </pre> <br><p>  Interestingly, the most ingredients (9 pieces) in pizza: <strong>Dodo</strong> and <strong>Vegetables and mushrooms</strong> . </p><br><h3 id="zapolnim-tablichku-ingredientov">  Fill the label of ingredients. </h3><br><pre> <code class="python hljs">df_ingredients = pd.DataFrame(ingredients) df_ingredients.fillna(value=<span class="hljs-string"><span class="hljs-string">'0'</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df_ingredients</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  0 </th><th>  one </th><th>  2 </th><th>  3 </th><th>  four </th><th>  five </th><th>  6 </th><th>  7 </th><th>  eight </th></tr></thead><tbody><tr><th>  0 </th><td>  Tomato sauce </td><td>  pepperoni </td><td>  pepperoni </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  one </th><td>  Tomato sauce </td><td>  chick </td><td>  pepperoni </td><td>  Mozzarella </td><td>  sweet and sour sauce </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  2 </th><td>  Tomato sauce </td><td>  bacon </td><td>  pepperoni </td><td>  chick </td><td>  Red onion </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  3 </th><td>  Tomato sauce </td><td>  ham </td><td>  Champignon </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  four </th><td>  Condensed milk </td><td>  cowberry </td><td>  pineapples </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  five </th><td>  Tomato sauce </td><td>  tomatoes </td><td>  Mozzarella </td><td>  oregano </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  6 </th><td>  Tomato sauce </td><td>  white cheese </td><td>  Mozzarella </td><td>  oregano </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  7 </th><td>  Tomato sauce </td><td>  pineapples </td><td>  chick </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  eight </th><td>  Tomato sauce </td><td>  beef (mince) </td><td>  ham </td><td>  pepperoni </td><td>  Red onion </td><td>  olives </td><td>  Bell pepper </td><td>  Champignon </td><td>  Mozzarella </td></tr><tr><th>  9 </th><td>  Tomato sauce </td><td>  pepperoni </td><td>  ham </td><td>  white cheese </td><td>  tomatoes </td><td>  Champignon </td><td>  Mozzarella </td><td>  oregano </td><td>  0 </td></tr><tr><th>  ten </th><td>  Tomato sauce </td><td>  white cheese </td><td>  olives </td><td>  Bell pepper </td><td>  tomatoes </td><td>  Champignon </td><td>  Red onion </td><td>  Mozzarella </td><td>  basil </td></tr><tr><th>  eleven </th><td>  Tomato sauce </td><td>  pepperoni </td><td>  olives </td><td>  Champignon </td><td>  Mozzarella </td><td>  oregano </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  12 </th><td>  Tomato sauce </td><td>  jalapeno </td><td>  Bell pepper </td><td>  chick </td><td>  tomatoes </td><td>  Champignon </td><td>  Red onion </td><td>  Mozzarella </td><td>  0 </td></tr><tr><th>  13 </th><td>  Tomato sauce </td><td>  shrimp </td><td>  olives </td><td>  Bell pepper </td><td>  Red onion </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  14 </th><td>  Tomato sauce </td><td>  hunting sausages </td><td>  bacon </td><td>  ham </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  15 </th><td>  Tomato sauce </td><td>  pepperoni </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  sixteen </th><td>  Ranch Sauce </td><td>  chick </td><td>  ham </td><td>  tomatoes </td><td>  garlic </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  17 </th><td>  Cheese sauce </td><td>  chick </td><td>  tomatoes </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  18 </th><td>  Tomato sauce </td><td>  chick </td><td>  bacon </td><td>  Red onion </td><td>  Mozzarella </td><td>  barbecue sauce </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  nineteen </th><td>  Cheese sauce </td><td>  beef </td><td>  bacon </td><td>  salted cucumbers </td><td>  tomatoes </td><td>  Red onion </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td></tr></tbody></table><br><br><pre> <code class="python hljs">df_ingredients.describe()</code> </pre> <br><br><table border="1"><thead><tr><th></th><th>  0 </th><th>  one </th><th>  2 </th><th>  3 </th><th>  four </th><th>  five </th><th>  6 </th><th>  7 </th><th>  eight </th></tr></thead><tbody><tr><th>  count </th><td>  20 </td><td>  20 </td><td>  20 </td><td>  20 </td><td>  20 </td><td>  20 </td><td>  20 </td><td>  20 </td><td>  20 </td></tr><tr><th>  unique </th><td>  four </td><td>  13 </td><td>  ten </td><td>  12 </td><td>  6 </td><td>  7 </td><td>  four </td><td>  four </td><td>  3 </td></tr><tr><th>  top </th><td>  Tomato sauce </td><td>  pepperoni </td><td>  pepperoni </td><td>  Mozzarella </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><th>  freq </th><td>  sixteen </td><td>  four </td><td>  3 </td><td>  five </td><td>  eight </td><td>  ten </td><td>  15 </td><td>  sixteen </td><td>  18 </td></tr></tbody></table><br><br><p>  As expected - the most used sauce is tomato.  Standard recipe - consists of 4 ingredients. </p><br><p>  It's funny that a <strong>new recipe for pizza was formed</strong> . </p><br><p>  Let's see how many times a particular ingredient occurs: </p><br><pre> <code class="python hljs">df_ingredients.stack().value_counts()</code> </pre> <br><pre> <code class="hljs go"><span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">69</span></span>  <span class="hljs-number"><span class="hljs-number">19</span></span>   <span class="hljs-number"><span class="hljs-number">16</span></span>  <span class="hljs-number"><span class="hljs-number">8</span></span>  <span class="hljs-number"><span class="hljs-number">7</span></span>  <span class="hljs-number"><span class="hljs-number">7</span></span>   <span class="hljs-number"><span class="hljs-number">7</span></span>  <span class="hljs-number"><span class="hljs-number">6</span></span>  <span class="hljs-number"><span class="hljs-number">5</span></span>   <span class="hljs-number"><span class="hljs-number">4</span></span>  <span class="hljs-number"><span class="hljs-number">4</span></span>  <span class="hljs-number"><span class="hljs-number">4</span></span>  <span class="hljs-number"><span class="hljs-number">4</span></span>  <span class="hljs-number"><span class="hljs-number">3</span></span>  <span class="hljs-number"><span class="hljs-number">2</span></span>   <span class="hljs-number"><span class="hljs-number">2</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span> -  <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span>  () <span class="hljs-number"><span class="hljs-number">1</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">1</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span> dtype: <span class="hljs-keyword"><span class="hljs-keyword">int64</span></span></code> </pre> <br><p>  Again: mozzarella, tomato sauce, pepperoni. </p><br><pre> <code class="python hljs">df_ingredients.stack().value_counts().drop(<span class="hljs-string"><span class="hljs-string">'0'</span></span>).plot.pie()</code> </pre> <br><pre> <code class="hljs css">&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">matplotlib</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.axes</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">._subplots</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.AxesSubplot</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">at</span></span> 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">xea8d358</span></span>&gt;</code> </pre> <br><p><img src="https://habrastorage.org/web/31a/77d/de5/31a77dde517b44bc8a7bdce561e6d498.png"></p><br><h3 id="teper-zakodiruem-ingredienty">  Now encode the ingredients. </h3><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LabelEncoder <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> OneHotEncoder ingredients_full = df_ingredients.values.tolist() <span class="hljs-comment"><span class="hljs-comment"># flatten lists flat_ingredients = [item for sublist in ingredients_full for item in sublist] print(flat_ingredients) print(len(flat_ingredients)) np_ingredients = np.array(flat_ingredients) #print(np_ingredients) labelencoder = LabelEncoder() ingredients_encoded = labelencoder.fit_transform(np_ingredients) print(ingredients_encoded) label_max = np.max(ingredients_encoded) print('max:', label_max)</span></span></code> </pre> <br><pre> <code class="hljs matlab">[<span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'- '</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' ()'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>] <span class="hljs-number"><span class="hljs-number">180</span></span> [ <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">25</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">27</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">max</span></span>: <span class="hljs-number"><span class="hljs-number">28</span></span></code> </pre> <br><p>  It turns out that for cooking, as many as 27 ingredients are used. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> label <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(label_max): print(label, labelencoder.inverse_transform(label))</code> </pre> <br><pre> <code class="hljs">0 0 1   2   3   4   5  6  7  8  9  10  11  12  () 13 -  14   15  16  17  18  19   20  21   22   23   24  25  26  27 </code> </pre> <br><pre> <code class="python hljs">lb_ingredients = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> lst <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ingredients_full: lb_ingredients.append(labelencoder.transform(lst).tolist()) <span class="hljs-comment"><span class="hljs-comment">#lb_ingredients = np.array(lb_ingredients) lb_ingredients</span></span></code> </pre> <br><pre> <code class="hljs json">[[<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">26</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]]</code> </pre> <br><pre> <code class="python hljs">onehotencoder = OneHotEncoder(sparse=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) ingredients_onehotencoded = onehotencoder.fit_transform(ingredients_encoded.reshape(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)) print(ingredients_onehotencoded.shape) ingredients_onehotencoded[<span class="hljs-number"><span class="hljs-number">0</span></span>]</code> </pre> <br><pre> <code class="hljs lisp">(<span class="hljs-number"><span class="hljs-number">180</span></span>, <span class="hljs-number"><span class="hljs-number">29</span></span>) array([ <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">1</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>., <span class="hljs-number"><span class="hljs-number">0</span></span>.])</code> </pre> <br><p>  Now we have data with which we can work. </p><br><h3 id="avtoenkoder">  Autoencoder </h3><br><p>  Let's try uploading pizza photos (top view) and try to train a simple compressing autoencoder. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt %matplotlib inline <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns np.random.seed(<span class="hljs-number"><span class="hljs-number">42</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_data <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> prepare_images</code> </pre> <br><h3 id="zagruzhaem-fotografii-picc">    </h3><br><pre> <code class="python hljs">pizza_eng_names, pizza_imgs = prepare_images.load_photos()</code> </pre> <br><pre> <code class="hljs kotlin">Read csv... (<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>) &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">pandas</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">core</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">frame</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataFrame</span></span></span><span class="hljs-class">'&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RangeIndex</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">20 entries</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">0 to 19 Data columns </span></span></span></span>(total <span class="hljs-number"><span class="hljs-number">13</span></span> columns): city_name <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> city_url <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_name <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_eng_name <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_url <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_contain <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> pizza_price <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> int64 kiloCalories <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> carbohydrates <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> proteins <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> fats <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> size <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> int64 weight <span class="hljs-number"><span class="hljs-number">20</span></span> non-<span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> dtypes: int64(<span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) memory usage: <span class="hljs-number"><span class="hljs-number">2.1</span></span>+ KB None [<span class="hljs-string"><span class="hljs-string">'double-pepperoni'</span></span>, <span class="hljs-string"><span class="hljs-string">'crazy-pizza'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-don-bekon'</span></span>, <span class="hljs-string"><span class="hljs-string">'gribvetchina'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-pirog'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-margarita'</span></span>, <span class="hljs-string"><span class="hljs-string">'syrnaya-pizza'</span></span>, <span class="hljs-string"><span class="hljs-string">'gavayskaya-pizza'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-dodo'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-chetyre-sezona'</span></span>, <span class="hljs-string"><span class="hljs-string">'ovoshi-i-griby'</span></span>, <span class="hljs-string"><span class="hljs-string">'italyanskaya-pizza'</span></span>, <span class="hljs-string"><span class="hljs-string">'meksikanskaya-pizza'</span></span>, <span class="hljs-string"><span class="hljs-string">'morskaya-pizza'</span></span>, <span class="hljs-string"><span class="hljs-string">'myasnaya-pizza'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-pepperoni'</span></span>, <span class="hljs-string"><span class="hljs-string">'ranch-pizza'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-syrnyi-cyplenok'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-cyplenok-barbekyu'</span></span>, <span class="hljs-string"><span class="hljs-string">'chizburger-pizza'</span></span>] [<span class="hljs-string"><span class="hljs-string">'double-pepperoni\\double-pepperoni3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'crazy-pizza\\crazy-pizza3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-don-bekon\\pizza-don-bekon3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'gribvetchina\\gribvetchina3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-pirog\\pizza-pirog3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-margarita\\pizza-margarita3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'syrnaya-pizza\\syrnaya-pizza3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'gavayskaya-pizza\\gavayskaya-pizza3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-dodo\\pizza-dodo3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-chetyre-sezona\\pizza-chetyre-sezona3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'ovoshi-i-griby\\ovoshi-i-griby3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'italyanskaya-pizza\\italyanskaya-pizza3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'meksikanskaya-pizza\\meksikanskaya-pizza3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'morskaya-pizza\\morskaya-pizza3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'myasnaya-pizza\\myasnaya-pizza3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-pepperoni\\pizza-pepperoni3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'ranch-pizza\\ranch-pizza3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-syrnyi-cyplenok\\pizza-syrnyi-cyplenok3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'pizza-cyplenok-barbekyu\\pizza-cyplenok-barbekyu3.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'chizburger-pizza\\chizburger-pizza3.jpg'</span></span>] Load images... Load image: double-pepperoni\double-pepperoni3.jpg Load image: crazy-pizza\crazy-pizza3.jpg Load image: pizza-don-bekon\pizza-don-bekon3.jpg Load image: gribvetchina\gribvetchina3.jpg Load image: pizza-pirog\pizza-pirog3.jpg Load image: pizza-margarita\pizza-margarita3.jpg Load image: syrnaya-pizza\syrnaya-pizza3.jpg Load image: gavayskaya-pizza\gavayskaya-pizza3.jpg Load image: pizza-dodo\pizza-dodo3.jpg Load image: pizza-chetyre-sezona\pizza-chetyre-sezona3.jpg Load image: ovoshi-i-griby\ovoshi-i-griby3.jpg Load image: italyanskaya-pizza\italyanskaya-pizza3.jpg Load image: meksikanskaya-pizza\meksikanskaya-pizza3.jpg Load image: morskaya-pizza\morskaya-pizza3.jpg Load image: myasnaya-pizza\myasnaya-pizza3.jpg Load image: pizza-pepperoni\pizza-pepperoni3.jpg Load image: ranch-pizza\ranch-pizza3.jpg Load image: pizza-syrnyi-cyplenok\pizza-syrnyi-cyplenok3.jpg Load image: pizza-cyplenok-barbekyu\pizza-cyplenok-barbekyu3.jpg Load image: chizburger-pizza\chizburger-pizza3.jpg Cut pizza from images... (<span class="hljs-number"><span class="hljs-number">380</span></span>, <span class="hljs-number"><span class="hljs-number">380</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-number"><span class="hljs-number">20</span></span></code> </pre> <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot_img</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(img)</span></span></span><span class="hljs-function">:</span></span> img_rgb = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) plt.imshow(img_rgb) plot_img(pizza_imgs[<span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre> <br><p><img src="https://habrastorage.org/web/531/2ee/4c9/5312ee4c9f7e4eeea73596c4900f34bc.png"></p><br><p> ,      ‚Äî  ,      ,      . </p><br><pre> <code class="python hljs">img_flipy = cv2.flip(pizza_imgs[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-number"><span class="hljs-number">1</span></span>) plot_img(img_flipy)</code> </pre> <br><p><img src="https://habrastorage.org/web/f62/a61/dcb/f62a61dcbcb645ebbdf113aaffaaa3e0.png"></p><br><p>      15 : </p><br><pre> <code class="python hljs">img_rot15 = load_data.rotate(pizza_imgs[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-number"><span class="hljs-number">15</span></span>) plot_img(img_rot15)</code> </pre> <br><p><img src="https://habrastorage.org/web/2c2/f68/651/2c2f68651dc8486fa8f26ec90fbed145.png"></p><br><p>        (   : 56  56) ‚Äî     360     1     . </p><br><pre> <code class="python hljs">channels, height, width = <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">56</span></span>, <span class="hljs-number"><span class="hljs-number">56</span></span> lst0 = load_data.resize_rotate_flip(pizza_imgs[<span class="hljs-number"><span class="hljs-number">0</span></span>], (height, width)) print(len(lst0))</code> </pre> <br><pre> <code class="hljs">720</code> </pre> <br><pre> <code class="python hljs">plot_img(lst0[<span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre> <br><p><img src="https://habrastorage.org/web/c8e/016/7c3/c8e0167c3df1490083dabb7aac170ef2.png"></p><br><h3 id="poprobuem-avtoenkoder">   </h3><br><p>               . </p><br><pre> <code class="python hljs">image_list = lst0 image_list = np.array(image_list, dtype=np.float32) image_list = image_list.transpose((<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)) image_list /= <span class="hljs-number"><span class="hljs-number">255.0</span></span> print(image_list.shape)</code> </pre> <br><pre> <code class="hljs lisp">(<span class="hljs-number"><span class="hljs-number">720</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">56</span></span>, <span class="hljs-number"><span class="hljs-number">56</span></span>)</code> </pre> <br><pre> <code class="python hljs">x_train = image_list[:<span class="hljs-number"><span class="hljs-number">600</span></span>] x_test = image_list[<span class="hljs-number"><span class="hljs-number">600</span></span>:] print(x_train.shape, x_test.shape)</code> </pre> <br><pre> <code class="hljs lisp">(<span class="hljs-number"><span class="hljs-number">600</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">56</span></span>, <span class="hljs-number"><span class="hljs-number">56</span></span>) (<span class="hljs-number"><span class="hljs-number">120</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">56</span></span>, <span class="hljs-number"><span class="hljs-number">56</span></span>)</code> </pre> <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Model <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.layers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Input, Dense, Flatten, Reshape <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.layers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Conv2D, MaxPooling2D, UpSampling2D <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> backend <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> K <span class="hljs-comment"><span class="hljs-comment">#For 2D data (eg image), "channels_last" assumes (rows, cols, channels) while "channels_first" assumes (channels, rows, cols). K.set_image_data_format('channels_first')</span></span></code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Using</span></span> Theano backend.</code> </pre> <br><h3 id="sozdayom-avtoenkoder">   </h3><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_deep_conv_ae</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(channels, height, width)</span></span></span><span class="hljs-function">:</span></span> input_img = Input(shape=(channels, height, width)) x = Conv2D(<span class="hljs-number"><span class="hljs-number">16</span></span>, (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'same'</span></span>)(input_img) x = MaxPooling2D(pool_size=(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), padding=<span class="hljs-string"><span class="hljs-string">'same'</span></span>)(x) x = Conv2D(<span class="hljs-number"><span class="hljs-number">8</span></span>, (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>, padding=<span class="hljs-string"><span class="hljs-string">'same'</span></span>)(x) encoded = MaxPooling2D(pool_size=(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), padding=<span class="hljs-string"><span class="hljs-string">'same'</span></span>)(x) <span class="hljs-comment"><span class="hljs-comment"># at this point the representation is (8, 14, 14) input_encoded = Input(shape=(8, 14, 14)) x = Conv2D(8, (3, 3), activation='relu', padding='same')(input_encoded) x = UpSampling2D((2, 2))(x) x = Conv2D(16, (3, 3), activation='relu', padding='same')(x) x = UpSampling2D((2, 2))(x) decoded = Conv2D(channels, (3, 3), activation='sigmoid', padding='same')(x) # Models encoder = Model(input_img, encoded, name="encoder") decoder = Model(input_encoded, decoded, name="decoder") autoencoder = Model(input_img, decoder(encoder(input_img)), name="autoencoder") return encoder, decoder, autoencoder c_encoder, c_decoder, c_autoencoder = create_deep_conv_ae(channels, height, width) c_autoencoder.compile(optimizer='adam', loss='binary_crossentropy') c_encoder.summary() c_decoder.summary() c_autoencoder.summary()</span></span></code> </pre> <br><pre> <code class="hljs markdown"><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span> Layer (type) Output Shape Param # ================================================================= input<span class="hljs-emphasis"><span class="hljs-emphasis">_1 (InputLayer) (None, 3, 56, 56) 0 _</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">____ conv2d_1 (Conv2D) (None, 16, 56, 56) 448 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ max_pooling2d_1 (MaxPooling2 (None, 16, 28, 28) 0 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ conv2d_2 (Conv2D) (None, 8, 28, 28) 1160 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ max_pooling2d_2 (MaxPooling2 (None, 8, 14, 14) 0 ================================================================= Total params: 1,608 Trainable params: 1,608 Non-trainable params: 0 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ Layer (type) Output Shape Param # ================================================================= input_2 (InputLayer) (None, 8, 14, 14) 0 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ conv2d_3 (Conv2D) (None, 8, 14, 14) 584 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ up_sampling2d_1 (UpSampling2 (None, 8, 28, 28) 0 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ conv2d_4 (Conv2D) (None, 16, 28, 28) 1168 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ up_sampling2d_2 (UpSampling2 (None, 16, 56, 56) 0 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ conv2d_5 (Conv2D) (None, 3, 56, 56) 435 ================================================================= Total params: 2,187 Trainable params: 2,187 Non-trainable params: 0 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ Layer (type) Output Shape Param # ================================================================= input_1 (InputLayer) (None, 3, 56, 56) 0 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ encoder (Model) (None, 8, 14, 14) 1608 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">___ decoder (Model) (None, 3, 56, 56) 2187 ================================================================= Total params: 3,795 Trainable params: 3,795 Non-trainable params: 0 __</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-strong"><span class="hljs-strong">_____</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">___</span></span></code> </pre> <br><pre> <code class="python hljs">c_autoencoder.fit(x_train, x_train, epochs=<span class="hljs-number"><span class="hljs-number">20</span></span>, batch_size=<span class="hljs-number"><span class="hljs-number">16</span></span>, shuffle=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, verbose=<span class="hljs-number"><span class="hljs-number">2</span></span>, validation_data=(x_test, x_test))</code> </pre> <br><pre> <code class="hljs go">Train on <span class="hljs-number"><span class="hljs-number">600</span></span> samples, validate on <span class="hljs-number"><span class="hljs-number">120</span></span> samples Epoch <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">10s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.5840</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.5305</span></span> Epoch <span class="hljs-number"><span class="hljs-number">2</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">10s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.4571</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.4162</span></span> Epoch <span class="hljs-number"><span class="hljs-number">3</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">9s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.4032</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3956</span></span> Epoch <span class="hljs-number"><span class="hljs-number">4</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">8s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3884</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3855</span></span> Epoch <span class="hljs-number"><span class="hljs-number">5</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">10s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3829</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3829</span></span> Epoch <span class="hljs-number"><span class="hljs-number">6</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">11s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3808</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3815</span></span> Epoch <span class="hljs-number"><span class="hljs-number">7</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">9s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3795</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3804</span></span> Epoch <span class="hljs-number"><span class="hljs-number">8</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">8s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3785</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3797</span></span> Epoch <span class="hljs-number"><span class="hljs-number">9</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">10s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3778</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3787</span></span> Epoch <span class="hljs-number"><span class="hljs-number">10</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">10s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3771</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3781</span></span> Epoch <span class="hljs-number"><span class="hljs-number">11</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">9s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3764</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3779</span></span> Epoch <span class="hljs-number"><span class="hljs-number">12</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">8s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3760</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3773</span></span> Epoch <span class="hljs-number"><span class="hljs-number">13</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">9s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3756</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3768</span></span> Epoch <span class="hljs-number"><span class="hljs-number">14</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">10s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3751</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3766</span></span> Epoch <span class="hljs-number"><span class="hljs-number">15</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">10s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3748</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3768</span></span> Epoch <span class="hljs-number"><span class="hljs-number">16</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">9s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3745</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3762</span></span> Epoch <span class="hljs-number"><span class="hljs-number">17</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">10s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3741</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3755</span></span> Epoch <span class="hljs-number"><span class="hljs-number">18</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">9s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3738</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3754</span></span> Epoch <span class="hljs-number"><span class="hljs-number">19</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">11s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3735</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3752</span></span> Epoch <span class="hljs-number"><span class="hljs-number">20</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">8s</span></span> - loss: <span class="hljs-number"><span class="hljs-number">0.3733</span></span> - val_loss: <span class="hljs-number"><span class="hljs-number">0.3748</span></span> &lt;keras.callbacks.History at <span class="hljs-number"><span class="hljs-number">0x262d</span></span>b6a0&gt;</code> </pre> <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#c_autoencoder.save_weights('c_autoencoder_weights.h5') #c_autoencoder.load_weights('c_autoencoder_weights.h5')</span></span></code> </pre> <br><h3 id="posmotrim-na-rezultaty-raboty-avtoenkodera">      </h3><br><pre> <code class="python hljs">n = <span class="hljs-number"><span class="hljs-number">5</span></span> imgs = x_test[:n] encoded_imgs = c_encoder.predict(imgs, batch_size=n) decoded_imgs = c_decoder.predict(encoded_imgs, batch_size=n) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_image_from_net_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> res = data.transpose((<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)) res *= <span class="hljs-number"><span class="hljs-number">255.0</span></span> res = np.array(res, dtype=np.uint8) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res <span class="hljs-comment"><span class="hljs-comment">#image0 = get_image_from_net_data(decoded_imgs[0]) #plot_img(image0)</span></span></code> </pre> <br><pre> <code class="python hljs">fig = plt.figure() j = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, len(imgs)): j += <span class="hljs-number"><span class="hljs-number">1</span></span> fig.add_subplot(n,<span class="hljs-number"><span class="hljs-number">2</span></span>,j) plot_img( get_image_from_net_data(imgs[i]) ) j += <span class="hljs-number"><span class="hljs-number">1</span></span> fig.add_subplot(n,<span class="hljs-number"><span class="hljs-number">2</span></span>,j) plot_img( get_image_from_net_data(decoded_imgs[i]) )</code> </pre> <br><p><img src="https://habrastorage.org/web/c67/4a3/2ad/c674a32add164d04860c05982ccd4ab8.png"></p><br><p> : <a href="https://habrahabr.ru/post/337398/"> 2:   </a> </p><br><h3 id="ssylki">  Links </h3><br><ul><li> <a href="https://automatetheboringstuff.com/chapter11/">Web Scraping</a> </li><li> <a href="https://habrahabr.ru/post/280238/">Web Scraping   python</a> </li><li> <a href="https://github.com/noonv/dodorobot/blob/master/dodo_scrapping.py">dodo_scrapping.py</a> </li><li> <a href="https://habrahabr.ru/post/331382/">  Keras,  1: </a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/335444/">https://habr.com/ru/post/335444/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335434/index.html">Authentication in Node.js. Tutorials and possible mistakes</a></li>
<li><a href="../335436/index.html">Autonomous way to bypass DPI and effective way to bypass site blocking by IP address</a></li>
<li><a href="../335438/index.html">Digest MBLTdev - fresh for iOS developers</a></li>
<li><a href="../335440/index.html">Backup mysql database and files to remote FTP - Python 3</a></li>
<li><a href="../335442/index.html">How to make websites more accessible for users with visual impairments</a></li>
<li><a href="../335446/index.html">How to set up teamwork and keep calm in the Telegram chat rooms, if everything is burning, and everything is in hell</a></li>
<li><a href="../335448/index.html">Blocking operations as malware protection</a></li>
<li><a href="../335450/index.html">What can you learn about the apartment from the open directories</a></li>
<li><a href="../335452/index.html">Tutorial: ToDo Spring and ReactJS web apps</a></li>
<li><a href="../335454/index.html">Reducing the size of the Android build file in Unity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>