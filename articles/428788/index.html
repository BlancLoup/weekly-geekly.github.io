<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Under the hood of Bitfury Clarke - how our new mining chip works</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In late September, we presented a new ASIC chip, designed specifically for SHA256 mining in the Bitcoin network. Today will tell what's inside. 

  
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Under the hood of Bitfury Clarke - how our new mining chip works</h1><div class="post__text post__text-html js-mediator-article">  In late September, <a href="https://medium.com/meetbitfury/bitfury-launches-new-suite-of-bitcoin-mining-hardware-cba838cd660f">we presented a</a> new ASIC chip, designed specifically for SHA256 mining in the Bitcoin network.  Today will tell what's inside. <br><br> <a href="https://habr.com/company/bitfury/blog/428788/"><img src="https://habrastorage.org/webt/us/3b/1b/us3b1bjmsdjadm4chzd_42wmz88.png"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>Image: Bitfury Group</i></font> <br><br><h2>  A couple of words about bitcoin mining </h2><br>  The purpose of mining is to protect the blockchain network.  Miners use their hardware to solve complex computational problems that ensure the integrity of transactions in the network and eliminate <a href="https://habr.com/company/bitfury/blog/346656/">double-spending attacks</a> .  In parallel, mining acts as a cryptocurrency generation mechanism, which miners receive as a reward (now - <a href="http://www.bitcoinblockhalf.com/">12.5 bitcoins</a> per block). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The computational tasks in question are related to the selection of a hash that matches the transactions in the block.  The sought value is based on the hash of the previous block, a random number (called nonce), and the sum of the transaction hashes for the last ten minutes.  In this case, two conditions must be fulfilled: the hash must correspond to the declared complexity of mining and have a strictly defined number of zero bits at the beginning.  To assess the complexity of the <a href="https://en.bitcoin.it/wiki/Difficulty">use of</a> decomposition in a modified Taylor series. <br><br>  Hashes in the bitcoin blockchain are calculated using the SHA256 algorithm.  It includes 64 iterations, during which there is a "mixing" of the transaction bits in the block using the shift and "modulo 2 addition" operations.  The result of using the SHA256 function is considered irreversible; for this reason, the target hash is found by brute force.  In more detail about mining and mining pools, in which participants of blockchain-networks are united in order to speed up the decision of the blocks, <a href="https://habr.com/company/bitfury/blog/348822/">we wrote in our blog</a> . <br><br>  Previously, CPUs and GPUs were used to iterate over nonce values ‚Äã‚Äãand hash selection, but over time, due to the ever increasing complexity of mining (it varies depending on the total computing power of all participants in the bitcoin network), specialized <a href="https://en.bitcoin.it/wiki/ASIC">ASIC</a> integrated circuits were designed. <br><blockquote>  We at Bitfury are also developing such solutions.  In total, we have created five generations of mining chips, and in September we <a href="https://medium.com/meetbitfury/bitfury-launches-new-suite-of-bitcoin-mining-hardware-cba838cd660f">presented the sixth one</a> - a speech about ASIC Clarke, sharpened specifically for solving SHA256 hashes. </blockquote><br><h2>  How does Clarke work? </h2><br>  Clarke is made on 14-nm process technology and is implemented in the form factor <a href="https://en.wikipedia.org/wiki/Flip_chip">FC-</a> LGA 35L size 6x6 mm.  The second case has more efficient wiring of power circuits on the board.  The chip solves 120 gigabytes per second, but <a href="https://www.finder.com.au/bitfury-clarke-a-new-generation-of-sha-256-crypto-mining-chip">it gives the opportunity to</a> adjust the performance depending on what the miner needs now - a larger hashrate or low power consumption.  In particular, it is possible to achieve an energy efficiency ratio of 55 mJ / gigahesh, since 0.3 volts is enough to power the chip.  The structure of Clarke looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9b/tf/ij/9btfij_i93ma3mohhui8_3ttttk.png" width="550"></div><br>  <b>Clock Generator.</b>  He sets the clock for the chip.  <a href="https://ru.stackoverflow.com/questions/609539/%25D0%2592-%25D1%2587%25D0%25B5%25D0%25BC-%25D1%2580%25D0%25B0%25D0%25B7%25D0%25BD%25D0%25B8%25D1%2586%25D0%25B0-%25D0%25BC%25D0%25B5%25D0%25B6%25D0%25B4%25D1%2583-vcc-vdd-vee-%25D0%25B8-vss">Voltage levels</a> : VSS = 0, VDD = 1. <br><br>  <b>A serial control interface</b> connected to an external serial bus controller.  It is similar to <a href="https://ru.wikipedia.org/wiki/Serial_Peripheral_Interface">the SPI bus</a> with MOSI and MISO data contacts (used to transfer data from the master to the slave and vice versa) connected by the SDATA line. <br><br>  The interface is responsible for transmitting commands.  Here are some of them: task write to write a new task, force task switch to force buffer switching, read nonces to read nonce values, etc. All commands have one pattern and contain code, length, data field, chip status byte, data from buffer nonce and checksums. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-f/zn/gq/-fzngq1_5ehfe8hafeyhmjq3t7o.png" width="550"></div><br>  Checksums are the arithmetic sum of bytes, starting with zero.  <i>For example, the checksum of the command 04 03 03 8c 18 00 will be AE.</i> <br><br>  <b>Control system nonce.</b>  Manages the process of calculating the hash based on the mask.  The mask ‚Äúlies‚Äù in the task buffer and is used to set the range of calculations.  It defines bits in the nonce that will remain unchanged when searching for a new value. <br><br>  <b>Task buffers</b>  Needed to calculate hashes (their length is 20 double words).  There are two buffers in total, which allows you to quickly switch between tasks.  While the first buffer is occupied by the hash solution, data is written to the second for the following calculations. <br><br>  <b>8154 kernel ring hash.</b>  They use the double SHA256 algorithm. <br><br>  <b>Nonce buffer.</b>  This is a circular buffer with a length of 12 double words, where hash solutions are written.  For <a href="https://bitfury.com/content/downloads/clarke_datasheet.pdf">example,</a> we led the process of data exchange in the chip, which occurs during the calculation of hashes (in the spoiler below): <br><br><div class="spoiler">  <b class="spoiler_title">Chip data exchange (in English)</b> <div class="spoiler_text">  <sub>// Program clock generator to value 0x20 and prescaler = 1 (disabled) Send: 0803038c1800</sub> <sub><br></sub>  <sub>Recv: f0b200b2</sub> <sub><br></sub>  <sub>// Set nonce mask to 0x00000000</sub> <sub><br></sub>  <sub>Send: 2003000000 Recv: f0230023</sub> <sub><br></sub>  <sub>// Force task switch Send: 020000</sub> <sub><br></sub>  <sub>Recv: f0020002</sub> <sub><br></sub>  <sub>// Send task</sub> <sub><br></sub>  <sub>Wi 0 = CD3F992C 1 = 037F8197 2 = A58E091A</sub> <sub><br></sub>  <sub>MS0 A = 0CAD7CD1 B = CBE38FD9 C = D14DC164 D = F90EB10B E = 819621CF F = 358D45CD NONCE = D5D0E8B9</sub> <sub><br></sub>  <sub>Send: _014fa607d67b614925737be76bce53a41ba12b3c8b659f27ef6726be6049f924522d2b3c8b659c78616c779 a13c81a609</sub> <sub><br></sub>  <sub>35067953386a9d52b3d0f24a3b0a607d67bb2a8cc5326708e0ef55b267700000000 Recv: 0fb200b2</sub> <sub><br></sub>  <sub>// Force task switch</sub> <sub><br></sub>  <sub>Send: 020000</sub> <sub><br></sub>  <sub>Recv: 0f020002</sub> <sub><br></sub>  <sub>// Read nonce buffer</sub> <sub><br></sub>  <sub>Send: 040000 Recv: _0f0400000000000000000000000000000000000000000000000000003ffffffc7f7a42132ffffffc 1ffffffc0001ffbf8c</sub> <sub><br></sub>  <sub>FIFO [0] = aaaaaaaa</sub> <sub><br></sub>  <sub>FIFO [1] = aaaaaaaa</sub> <sub><br></sub>  <sub>FIFO [2] = aaaaaaaa</sub> <sub><br></sub>  <sub>FIFO [3] = aaaaaaaa</sub> <sub><br></sub>  <sub>FIFO [4] = aaaaaaaa</sub> <sub><br></sub>  <sub>FIFO [5] = aaaaaaaa</sub> <sub><br></sub>  <sub>FIFO [6] = aaaaaaaa</sub> <sub><br></sub>  <sub>FIFO [7] = 3ffffffc</sub> <sub><br></sub>  <sub>FIFO [8] = d5d0e8b9 &lt;- nonce value</sub> <sub><br></sub>  <sub>FIFO [9] = 2ffffffc &lt;- task switch marker</sub> <sub><br></sub>  <sub>FIFO [A] = 1ffffffc &lt;- task switch marker</sub> <sub><br></sub>  <sub>FIFO [B] = aaab5515</sub> <sub><br></sub> </div></div><br><hr><br><h2>  Where will the chip be used </h2><br>  Now we are installing new devices into our own mining servers and <a href="https://bitfury.com/hardware/blockbox">BlockBox</a> mobile data centers.  We also modify bitcoin farms in Canada, Iceland, Georgia and Norway ( <a href="https://bitcoinmagazine.com/articles/bitfury-expands-norway-35-million-bitcoin-data-center/">launched at the beginning of the year</a> ). <br><br>  Clarke chips will be available as a commercial product.  In particular, they come with <a href="https://bitcoinexchangeguide.com/bitfury-tardis-new-enterprise-grade-b8-bitcoin-miner-server-launches-using-clarke-asic-chips/">Bitfury Tardis miners</a> , designed for large organizations.  In Tardis, there are 5‚Äì8 boards that can calculate up to 80 terahesh per second.  This miner can be upgraded - in the future, the ASIC Clarke installed in it will be replaced with new chips. <br><br><hr><br>  This is our short video introducing the concept of a new chip: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/r60CQPgl4Lw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/428788/">https://habr.com/ru/post/428788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../428776/index.html">New realization of curiosity in AI. Training with a reward that depends on the difficulty of predicting the outcome</a></li>
<li><a href="../428778/index.html">See invisible. Near infrared range (0.9-1.7¬µm)</a></li>
<li><a href="../428782/index.html">Microsoft has released a Linux version of the utility ProcDump</a></li>
<li><a href="../428784/index.html">The Ministry of Communications proposed to create alternative social networks and instant messengers</a></li>
<li><a href="../428786/index.html">Quantum processor based on spin resonance and manipulations with singlet-triplet system</a></li>
<li><a href="../428790/index.html">We write chat bot for VKontakte on python using longpoll. Part two. Double cycles, exceptions and other heresy</a></li>
<li><a href="../428792/index.html">The new Apple T2 chip makes it difficult to audition through the built-in laptop microphone</a></li>
<li><a href="../428794/index.html">Overview of the main mathematical optimization methods for problems with constraints</a></li>
<li><a href="../428796/index.html">Real-time mesh manipulation on Unity</a></li>
<li><a href="../428798/index.html">How to survive indie developer. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>