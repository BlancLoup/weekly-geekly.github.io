<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Extortionist Android / Lockerpin.A attacks US users</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, our analysts have recorded another surge in the activity of attackers, who distributed one of the modifications of the extortionist for Andr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Extortionist Android / Lockerpin.A attacks US users</h1><div class="post__text post__text-html js-mediator-article">  Recently, our analysts have recorded another surge in the activity of attackers, who distributed one of the modifications of the extortionist for Android.  Earlier, we already observed families of ransomware who also combined the functions of a fake antivirus (Fake AV) and could block the screen of a user's device (for example, Android Defender).  Last year, we also <a href="http://habrahabr.ru/company/eset/blog/230995/">wrote</a> about the extortionist Simplocker, which is the first malicious program, the extortioner for Android, which contained the ability to encrypt files. <br><br><img src="https://habrastorage.org/files/bcc/a9c/5b8/bcca9c5b845b4e4988c3bbb512174bfe.jpeg"><br><br>  In previous versions of the ransomware for Android, such as LockScreen, the screen lock mechanism was usually implemented by constantly drawing the ransomware window in the foreground, and such an operation was performed in an infinite loop so that no one could interrupt it.  On the other hand, overcoming such a mechanism of self-defense was not difficult for an experienced user, he could use the Android Debug Bridge (ADB) mechanism to unlock or disable Administrator rights, and also remove malware in Safe Mode. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  In the new version of the ransomware family for Android, which is detected by ESET antivirus products like <b>Android / Lockerpin.A</b> , users are deprived of any way to restore lost control over their device without having root rights or without an installed security product on the device.  This eliminates the obvious way hard reset, which helps to return the device to the factory settings and remove all data from it. <br><br>  In addition, the extortioner also uses a special method to obtain and maintain Administrator rights (Device Administrator) on the device to prevent its deletion.  This is the first case of this behavior of Android malware from those we have observed earlier. <br><br>  <b>Analysis</b> <br><br>  After successful installation on the device, Android / Lockerpin.A tries to get device administrator privileges on the system.  This method is used by the authors of malware for Android more and more often and significantly complicates their removal from the system.  Earlier versions of the Android / Locker family also relied on it. <br><br>  In recent versions, however, the extortioner gets administrative rights more secretively than in previous ones.  A special activation window with the special name ‚ÄúUpdate patch installation‚Äù covers the main window of the ransomware lockout.  When a user clicks on the control of this window to ‚Äúinstall an update‚Äù, he activates device administrator privileges, giving them to the malicious program. <br><br><img src="https://habrastorage.org/files/bdd/728/23f/bdd72823f5e746f9b02828027e134343.png"><br>  Fig.  Window for secret activation of the device administrator mode. <br><br>  After clicking on the button, the user's device will be at the complete disposal of the extortioner: the malicious code receives administrator rights and can block the device, as well as set a new PIN code to unlock it.  After this operation, the user will be asked to pay a ransom of $ 500 for viewing and storing prohibited pornographic materials. <br><br><img src="https://habrastorage.org/files/3fa/550/306/3fa55030687e45e5b8387829e2368c96.png"><br>  Fig.  Redemption window. <br><br>  After displaying this warning, the screen of the device is blocked in the style typical for this kind of ransomware.  In the simplest case, you can close the ransom window and remove the malware from the system by downloading in safe mode or using the Android Debug Bridge (ADB) mode.  However, after displaying a warning message, Android / Lockerpin.A blocks the device with a new PIN code, and the new PIN code is unknown to both the owner and the attackers themselves.  The only way to unlock the device is to reset it to the factory settings or to get root privileges in the system. <br><br><img src="https://habrastorage.org/files/7c6/2ca/a48/7c62caa48b56422f89159dcfb6bbf5d6.png"><br>  Fig.  Extortion device unlock screen. <br><br>  <b>Extortionist self-defense mechanisms</b> <br><br>  The extortioner Android / Lockerpin.A not only obtains the rights of the device administrator, it also uses a kind of aggressive self-defense mechanisms to support them.  In the event that a user wants to deactivate the device administrator mode for a malicious program, he will not be able to perform such an operation, since the malicious program registers a callback function to reactivate elevated privileges in case of an attempt to remove them.  When a user tries to disable this elevated mode, it displays a fake window, which is shown in Fig.  4. Pressing the ‚ÄúContinue‚Äù button re-activates the administrator mode. <br><br><img src="https://habrastorage.org/files/91b/75e/d9c/91b75ed9c1ac4ac6b872225625f3b083.png"><br>  Fig.  A warning message about disabling the device administrator mode. <br><br>  Lockerpin self-defense includes mechanisms for forcing the anti-virus product processes on a system when a user tries to disable administrator privileges.  The list of anti-virus products includes ESET Mobile Security, Avast and Dr.Web. <br><br><img src="https://habrastorage.org/files/6f1/e24/7b3/6f1e247b3bd54c4299af9ea2344bf9cd.png"><br>  Fig.  The function of forcing the completion of running processes. <br><br>  Tracking the actions of the <i>com.android.settings</i> process is an attempt to prevent malware from being removed from the system through the application manager built into Android.  The self-defense mechanisms of our anti-virus product, ESET Mobile Security, do not allow us to forcibly terminate its processes. <br><br>  <b>Ways to spread</b> <br><br>  The attackers chose social engineering methods to lure the user to install a malicious program.  For this, it is offered as an adult video, as well as an application for viewing this kind of content.  In all such cases, the application was called ‚ÄúPorn Droid‚Äù. <br><br>  Statistics obtained using our cloud technology ESET LiveGrid shows that the largest number of infected devices is in the US (more than 75% of the total number of infections).  Such a geography of distribution is not customary for us, since those extortioners that we recorded earlier were mainly used to compromise users in Russia and Ukraine.  Obviously, in the US, attackers can benefit more from user compromise than in the above-mentioned countries. <br><br><img src="https://habrastorage.org/files/9ad/d58/71e/9add5871e9ed43b8bcda95e720e06eb1.png"><br>  Fig.  The geography of the spread of Android / Lockerpin.A. <br><br>  <b>Unlock device</b> <br><br>  As we mentioned earlier, the only solution that can be used to remove the screen with the PIN code request, without returning the device to factory settings, is to obtain root rights or use the functions of an already installed security software.  In the case of obtaining root rights, the user can use the ADB tool to connect the device to the PC and delete the file with the PIN code of the malicious program.  To perform such an operation, the device must have the debugging feature enabled (Settings -&gt; Developer options -&gt; USB Debugging).  The user can use the following set of commands to unlock the device. <br><br>  &gt; adb shell <br>  &gt; su <br>  &gt; rm /data/system/password.key <br><br>  After executing the above commands, the PIN request screen will be deleted, and the user will gain access to the device.  In some cases, after the operations, the device needs to be rebooted. <br><br>  <b>Conclusion</b> <br><br>  Fortunately, the user cannot download the malicious Android / Lockerpin.A application from the Google Play Store.  The malicious program can get on the user's device through third-party application stores, pirated software websites or torrents.  The most effective way to avoid infection and blocking the device is to use proactive means of protection.  We strongly recommend timely update antivirus.  Antivirus product <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.eset.ems2.gp">ESET Mobile Security</a> detects this threat as <b>Android / Lockerpin.A</b> . </div><p>Source: <a href="https://habr.com/ru/post/266431/">https://habr.com/ru/post/266431/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266419/index.html">Organization of monitoring the work of employees in a small office</a></li>
<li><a href="../266421/index.html">How a month to get a lot of pumping in Data Science</a></li>
<li><a href="../266425/index.html">Magnetic core memory module in an IBM 1401 vintage mainframe</a></li>
<li><a href="../266427/index.html">Implementation of multi-threaded game engine architecture</a></li>
<li><a href="../266429/index.html">Joint editing. Part 2</a></li>
<li><a href="../266433/index.html">Developing a metamodel using the Eclipse Modeling Framework (and a little about data modeling)</a></li>
<li><a href="../266435/index.html">How to learn to make games: useful resources</a></li>
<li><a href="../266437/index.html">Says Gartner: Overheated IoT and Practical Clouds</a></li>
<li><a href="../266441/index.html">Assistant program for mastering blind typing on a keyboard in Linux</a></li>
<li><a href="../266443/index.html">How do closures (under the hood) in JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>