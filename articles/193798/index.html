<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>UNIX¬Æ on the Game Boy Advance Console</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In this publication, I talk about gbaunix, an amusing experiment, during which I launched an ancient version of the UNIX operating syst...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>UNIX¬Æ on the Game Boy Advance Console</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  In this publication, I talk about gbaunix, an amusing experiment, during which I launched an ancient version of the UNIX operating system in a simulator on the popular <i>(at the time of publication, in 2004, a comment of the</i> portable console <i>)</i> portable console.  Namely, UNIX 5th edition (released in 1974, 39 years ago) on the Nintendo Game Boy Advance.  This may be of interest to homebrew developers for Gameboy, IT students with specialization in operating systems, emulators or compilers, and geeks-unicsoids. <br><img src="https://habrastorage.org/getpro/habr/post_images/4cc/f91/69d/4ccf9169d8276719bcd9d3a49bb5a08f.gif" alt="image"><br><a name="habracut"></a><br>  Nintendo has been on the gaming market since 1889 (sic!).  Gameboy is a brand of a whole line of portable consoles, which is very successfully sold to this day.  Since its release in 1989, 175 million units have been sold.  This article discusses the Game Boy Advance, abbreviated GBA, and its equivalent GBA SP. <br><br><h4>  Iron: </h4><br><ul><li>  32-bit ARM processor (RISC), clocked at 16.78 MHz </li><li>  32-bit ARM processor (RISC), clocked at 16.78 MHz </li><li>  8-bit processor Z80 (CISC), the frequency of 4.2 or 8.4 MHz.  Added for compatibility with old Gameboys, it had a central processor </li><li>  4 16-bit timers </li><li>  4 DMA channels </li><li>  Color TFT screen, resolution 240x160 </li><li>  Stereo sound through headphones </li><li>  10 buttons </li><li>  Serial port </li><li>  Interface for GamePak Cartridge </li></ul><br><br>  There are several memory blocks in the console: <br><ul><li>  16 KB BIOS ROM </li><li>  256 KB external RAM soldered to PCB (EWRAM) </li><li>  32 KB internal RAM, on-chip CPU (IWRAM) </li><li>  1 KB RAM for background and sprites palette </li><li>  96 KB Video RAM </li><li>  1 KB RAM for object attributes </li><li>  Up to 32 MB ROM cartridge </li><li>  Up to 64 KB SRAM cartridge, optional </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It should be noted that the ROM cartridge has two additional displays in the address space of the console.  In addition, the cartridge may contain several banks of memory with different volume or timings. <br><br>  GBA can be loaded from a regular cartridge, a rewritable flash cartridge, another GBA in master mode, or even from a computer via cable.  This functionality is wired in the BIOS. <br><br>  Console iron is mostly available through a well-documented address space.  Different I / O registers are mapped to memory addresses.  In addition to this, the BIOS contains many functions available through software interrupts. <br><br><div class="spoiler">  <b class="spoiler_title">Lyrical digression about ARM architecture</b> <div class="spoiler_text"><h5>  ARM </h5><br>  Nintendo is the market leader in consoles, and ARM is the market leader in RISC processors.  Now ARMs are present in almost all electronics.  Intel drives on desktops, yes.  But processors for the PC make up a very small fraction of the total production.  In 2003, 782 million devices were produced at the AWP.  In general, the share of this architecture is around 75%. <br><br>  Most often, AWPs are used in the same sentence with the words ‚Äúbuilt-in‚Äù, ‚Äúproductive‚Äù, ‚Äúcheap‚Äù, ‚Äúlow-roughing‚Äù, ‚ÄúRISC‚Äù.  AWS licenses the architecture directly to processor manufacturers, including as large as Intel, Apple, Samsung. <br><br>  The first AWP was developed at Acorn Computers Limited in the mid-80s.  Then it was deciphered as "Acorn RISC Machine".  The very first version of the ARM architecture, ARMv1, supported 26-bit addressing and was very slow.  The first processor of this architecture, ARM1, was a peripheral processor in the Air Force microcomputer and the prototype Archimedes workstation.  And it was one of the first processors of the RISC architecture.  Main features: deferred branching, register windows, each instruction is executed in one clock cycle. <br><br>  Apple tried to use the automated workplace in the early 90s.  In collaboration with Acorn, they launched a new company, Advanced RISC Machines, Limited.  VLSI Technology was another accomplice.  The abbreviation has changed.  The new processor was called ARM6, architecture - ARMv3.  There is a full 32-bit addressing.  This processor was used in the Apple Newton. <br><br>  Gameboy uses the ARM7TDMI processor, an ARMv4T version architecture. <br><br><h5>  ARM in Geymboe </h5><br><br>  ARM7TDMI is a popular embedded 32-bit processor with slightly limited functionality.  It does not have a cache and MMU.  The designation stands for: <br>  <b>ARM7 processor</b> <br>  Supports a set of 16-bit instructions <b>T</b> humb <br>  Supports <b>D</b> ebug right in the hardware <br>  It has a built-in 32-bit block at the <b>M</b> hopping, the result is 64-bit <br>  There are Embedded <b>I</b> CE for debugging <br><br>  The ARM7TDMI core has one 32-bit bus for data and instructions.  The data can be 8, 16, 32 bits.  Only loading, saving, and sharing instructions can access memory.  There are 31 32-bit general-purpose registers, 6 status registers, a shift register, arithmetic and multiplication blocks.  Not all registers are available at the same time.  For example, in ARM mode, 16 common and 1 or 2 status registers are available.  There are 7 modes of operation of the processor: normal for program execution, and 6 special ones.  These are quick interrupt, interrupt, supervisor, stop, undefined state and system mode.  Also supported are two sets of instructions - ARM and Thumb. <br><br>  Gameboy supports 4 DMA channels.  The processor can do two types of interrupts - regular IRQs and fast FIQs, but only normal ones are used in the console. <br><br>  ARM7 has a simple three-stage pipeline: <br>  The command is retrieved from memory and placed in a queue. <br>  Command decoded <br>  The command is executed.  When this happens, reading from registers, calculating results and writing from to registers takes place. <br><br>  Thus, at any time one command is executed, the next one is decoded, and one command is retrieved. <br><br><h5>  Thumb </h5><br>  The relative disadvantage of RISC processors is a relatively large code.  This increases the volume of the program and leads to loss of cache efficiency, excessive memory traffic and energy consumption.  For embedded applications, this is especially bad.  To compact the code we developed the architecture of Thumb. <br><br>  Thumb is a system of 32-bit ARM commands compressed to 16 bits.  A set of the most popular instructions is supported.  They work with the same 32-bit registers.  Processors with Thumb support are equipped with a decoder in the pipeline that converts them into ordinary ARM instructions.  The difference is like this: <br><ul><li>  35% of the code is saved </li><li>  It takes 40% more teams </li><li>  Code is 40% slower for 32-bit memory </li><li>  But 60% faster for 16-bit </li><li>  30% less power consumption </li></ul><br><br>  A mixture of ARM and Thumb commands is commonly used.  The type of command being executed is indicated by a special flag.  In Geymboe there are 32 KB of fast memory right on the chip.  Normally, a speed-critical code is executed from there.  Everything else is appropriate to compile into Thumb and run from the slow memory of the cartridge. <br><br>  <i><a href="http://habrahabr.ru/post/92494/">habrahabr.ru/post/92494</a> - useful reading matter in general about ARM.</i>  <i>- approx.</i>  <i>trans.</i> <br></div></div><br><br><h4>  Gbaunix high-level architecture </h4><br>  gbaunix is ‚Äã‚Äãa UNIX 5 edition running on Gameboe.  SIMH is used for this, a simulator of various antique computers written in C. SIMH can emulate a lot more, but only PDP-11 is used here.  For Gameboy, there are several tulcheynov C, so it turned out a little blood to port SIMH to Gameboy.  The architecture of the resulting system is shown below: <br><img src="https://habrastorage.org/getpro/habr/post_images/aed/81b/bb5/aed81bbb57123b0f14935e2c4b6e7725.gif" alt="image"><br><br>  The gbaunix cartridge is a concatenation of the simulator runtime and the OS disk image.  The rest of the place can be left empty, or take something useful. <br><br>  The simulator is a minimally modified SIMH.  Gameboy-specific features are implemented in a separate level of abstraction. <br><br><h6>  Tty output </h6><br>  gbaunix simulates a text terminal for SIMH.  The output is redirected to a procedure executed on Gameboy, which formats it and displays it on the screen.  Supported scrolling.  <code>printf()</code> split into <code>sprintf()</code> into a buffer and display it on the screen. <br><br><h6>  Tty input. </h6><br>  Now there is no sane input support at all.  You can only execute a sequence of shell commands defined upon compilation.  It is set in the <code>gba/gba_kbd.h</code> .  When UNIX is running, the Start button gives the following command from the list for execution.  It is possible to monitor button presses, polling, or through an interrupt.  Example: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* gba/gba_kbd.h */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *gba_kbdinput[] = { <span class="hljs-string"><span class="hljs-string">"unix\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"root\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"chdir /work\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"ls -l\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"./fact 100\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"cat hanoi.c\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"./hanoi\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"./hanoi 3\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"chdir /tmp\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"echo 'main() { printf(\"Hello, World!\\n\"); }' \ &gt; hello.c\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"cc hello.c\r"</span></span>, <span class="hljs-string"><span class="hljs-string">"./a.out\r"</span></span>, ... <span class="hljs-comment"><span class="hljs-comment">/* more commands */</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, };</code> </pre><br><br><h6>  File system. </h6><br>  The disk image takes 2.5 MB, it fits only in the ROM cartridge.  Although this memory is read-only, it is necessary to somehow handle the write to it.  To do this, each write operation creates a buffer in RAM.  All read and write operations are first checked for a buffer.  As the number of such buffers grows, they merge.  Simulator slips virtual stdio. <br><br><h6>  Memory. </h6><br>  The simulated PDP-11 is available 128 KB of memory available in hardware 256 KB EWRAM.  There is some memory optimization like using DMA. <br><br><h6>  Other </h6><br>  Here any code like initialization of the execution environment, TTY, interrupts, file system, etc. <br><br><h5>  Development </h5><br>  gbaunix works on both the Gameboy emulator and the iron console.  To run in the gland you will need a flash cartridge and a programmer for it. <br>  It is much more convenient to use the Gemiboy emulator, especially if you want to tinker with the source code.  gbaunix is ‚Äã‚Äãvery conditionally optimized for the time being, and it works very slowly on the iron console.  The emulator will allow you to work with the maximum available speed, and this will save a lot of nerves. <br><br>  My development environment is deployed under Mac OS X. It uses the Boycott Advance emulator and devkitARM toolchain compiled from raw materials.  Checked on a real console with a flash cartridge. <br><br><h4>  Lyrical digression about the history of UNIX </h4><br><br>  Here was a large text that had no direct relation to the subject of the article, but was too curious to get rid of it.  Delivered to a separate post - <a href="http://habrahabr.ru/post/194160/">habrahabr.ru/post/194160</a> <br><br><h4>  Demonstration of work gbaunix, with comments </h4><br><h5>  Fifth Edition, June 1974 </h5><br><br>  I use the fifth edition because it is the oldest version for which there are electronically downloadable images of the system and kernel source code.  We will try to recompile it, because it is true. <br><br>  When you turn on the power, gbaunix will show some information about the PDP-11 hardware and the bootloader prompt - <code>@</code> .  If you click <code>Start</code> , the command queue will give the name of the kernel to boot - <code>unix</code> .  Loading on the iron Geimboe takes about two minutes.  After downloading, you are prompted to login. <br><img src="https://habrastorage.org/getpro/habr/post_images/5a0/b57/268/5a0b5726850370c61d6d2e8ba28db42b.gif" alt="image"><br><br>  The semicolon in the invitation ( <a href="https://www.usenix.org/publications/login/">; login</a> is also a paper magazine issued by the USENIX Association) is necessary for the <code>Teletype model 37</code> terminal, <code>Teletype model 37</code> popular in the early 1970s.  It translates it into full duplex mode.  All other terminals, including our GBA TTY, simply display the symbol on the screen. <br><br>  Even such an early version of UNIX has block and character device files.  <code>RK0</code> is the first disk, <code>/dev/mem</code> - mapping system memory for debugging with debugger and patching hot. <br><img src="https://habrastorage.org/getpro/habr/post_images/a8b/411/334/a8b41133499d98879a5dcff36ee83129.gif" alt="image"><br><br>  <code>glob</code> , short for <code>global</code> , is a command external to the shell for expanding the metacharacters <code>*</code> and <code>?</code>  in command arguments.  <code>glob</code> opens metacharacters and invokes the desired command.  If there is no match, the traditional error <code>No match</code> is issued. <br><img src="https://habrastorage.org/getpro/habr/post_images/d17/843/23b/d1784323b41e5947d32396cbd653dc4d.gif" alt="image"><br><br>  It is curious that some commands like <code>mkfs</code> hidden in <code>/etc</code> , away from a random call with curved hands. <br><br>  <code>dc</code> is a calculator with reverse Polish notation.  This is the first program running on the PDP-11, even before the creation of a UNIX version for this computer. <br><br>  The typical core of the fifth edition is less than 26 Kb.  Shell occupies 5738 bytes, and <code>/init</code> - only 1972 bytes.  There is also a minimally decent script <code>/etc/rc</code> .  <code>/etc/update</code> updates the file system superblock every 30 seconds, to reduce crash losses.  The detailed output of the <code>ls</code> includes access rights, the number of links, the owner, the size in bytes, the last modification time, and the name. <br><img src="https://habrastorage.org/getpro/habr/post_images/c51/487/2ab/c514872ab71b4eb7332cc8b9eaf3ee7a.gif" alt="image"><br><br>  By the era of the fifth edition, a rich development infrastructure had already been created with support for many programming languages.  For example, Algol-68, APL, Assembler, BASIC, C, FORTRAN, M6, PASCAL, Snobol, TMG.  In principle, gbaunix allows programming in several languages ‚Äã‚Äãdirectly on Gamemboe (this is in theory, in reality it is at least inconvenient due to the lack of a keyboard).  The package includes compilers / interpreters for C, PDP-11 assembler, BASIC, shell and Fortran.  I also tried algol, but did not add it to the disk image.  For example, showing the towers of Hanoi. <br><img src="https://habrastorage.org/getpro/habr/post_images/e0c/3b5/600/e0c3b560072f223e0c3978ad729596b2.gif" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7bd/625/bc0/7bd625bc0a4dccad531398bae51cbc38.gif" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/acf/f77/a12/acff77a12e5b7a4f5ccac698a499da41.gif" alt="image"><br>  More screenshots can be viewed on a <a href="http://www.kernelthread.com/publications/gbaunix/so.html">special page with screenshots.</a> <br><br><h5>  Subsequent editions </h5><br>  The sixth edition (May 1975) left its mark on history, because BSD and Xenix originated from it.  John Lyons wrote his famous " <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25BC%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B0%25D1%2580%25D0%25B8%25D0%25B8_%25D0%259B%25D0%25B0%25D0%25B9%25D0%25BE%25D0%25BD%25D0%25B0_%25D0%25BA_6-%25D0%25B9_%25D0%25B2%25D0%25B5%25D1%2580%25D1%2581%25D0%25B8%25D0%25B8_UNIX,_%25D1%2581_%25D0%25B8%25D1%2581%25D1%2585%25D0%25BE%25D0%25B4%25D0%25BD%25D1%258B%25D0%25BC_%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25BE%25D0%25BC">Lyons Comments on UNIX Version 6, with Source Code</a> ."  It is also the earliest fully preserved version of UNIX.  Documentation for the fifth edition is lost, from the fourth and earlier there is almost nothing.  Since the sixth edition, the development of UNIX-systems has noticeably quickened.  Then there were the seventh edition in January 1979, the eighth in February 1985, the ninth in September 1986, and the tenth in October 1989. <br><br><h4>  BSD </h4><br><br>  You can run several more systems supported by SIMH on Gameboy.  But it is more and more difficult, and rests on the available RAM.  A couple of screenshots from BSD 2.9: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c5/074/d49/9c5074d492a1ce85e2a8203f32bf91ad.gif" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/262/7df/dd7/2627dfdd77eb6801ce2ad1f400bd4218.gif" alt="image"><br><br><h4>  Gbaunix optimization </h4><br>  Gbaunix has prerequisites for experiments that affect the speed of work.  But this will require recompilation. <br><br><h5>  Credit Code in IWRAM </h5><br>  In gbaunix, there are examples of compiling code for ARM and storing it in IWRAM.  This will probably be most useful for the processor simulation code. <br><br><h5>  DMA </h5><br>  Gameboy allows you to work with memory in several ways, with different performance and limitations.  gbaunix uses DMA3 (general purpose) for <code>memcpy()</code> and <code>memset()</code> functions.  Moreover, the BIOS contains functions for copying and filling memory through software interrupts.  In general, gbaunix supports fine tuning of work with memory. <br><br><h5>  Caching </h5><br>  As I said, gbaunix emulates stdio and a virtual disk, representing the cartridge memory as a UNIX file.  Since iron does not allow writing to ROM, it is necessary to get by with buffers, as mentioned above.  gbaunix can preload disk fragments into buffers.  This allows you to significantly speed up the boot system. <br><br><h4>  Recompiling the UNIX kernel </h4><br>  Recompiling the kernel does not give any noticeable advantages for gbaunix, but this is interesting in any case.  At least for comparison with the same procedure for modern systems.  We can limit iron support to the core and thereby save some space. <br><br>  Estimate the size of the source code of the fifth edition. <br>  Headers: 418 lines in 13 files <br>  C: 7222 lines in 43 files (including drivers for peripherals) <br>  Assembler: 1080 lines in 2 files <br><br>  I didn‚Äôt even try to compile the kernel directly on Gameboe.  It will take an indefinite long time, and we will run out of memory for buffers.  And in general, the equipment for such a task is too weak. <br><br>  The next sequence of commands assumes that there is a working installation of the fifth edition, on real hardware or on the simulator, and the kernel source in the default directory is <code>/usr/sys</code> <br><br>  Remove libraries, possibly remaining from the previous compilation: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># chdir /usr/sys # rm -f lib1 # rm -f lib2</span></span></code> </pre><br><br>  Before starting the compilation, it is necessary to study and correctly specify the parameters in the <code>/usr/sys/param.h</code> file. <br><br>  If the compiler produces the error " <code>undefined KISA0</code> ", add the definition to <code>/usr/sys/seg.h</code> : <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># echo '\#define KISA 0172340' &gt;&gt; /usr/sys/seg.h</span></span></code> </pre><br><br>  Actually compilation: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># chdir ken # cc -c -O *.c ... # ar vr ../lib1 main.o alloc.o iget.o prf.o rdwri.o \ slp.o subr.o text.o trap.o sig.o sysent.o clock.o fio.o \ malloc.o nami.o pipe.o sys1.o sys2.o sys3.o sys4.o ...</span></span></code> </pre><br><br>  Compiling drivers and other things.  You can partially disable: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># chdir ../dmr # cc -c -O *.c ... # ar vr ../lib2 *.o</span></span></code> </pre><br><br>  System configuration and linking.  The output is a kernel binary: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># chdir ../conf # cc mkconf.c # mv a.out mkconf # echo rk | ./mkconf # cc -c cc # as ls # mv a.out lo # as mch.s # mv a.out mch.o # ld -x lo mch.o co ../lib1 ../lib2 # mv a.out rkunix</span></span></code> </pre><br><br>  <code>rkunix</code> is the <code>rkunix</code> kernel.  If you put it in the root directory <code>/rkunix</code> , and when booting give the command <code>rkunix</code> instead of <code>unix</code> , then it will load. <br><br><h4>  Ideas and suggestions </h4><br>  A short list of promising ideas.  Interest is mostly academic <br><br><h5>  Native UNIX port on Gameboy </h5><br>  Porting UNIX to Gameboy would be a good exercise for students in a course on operating systems.  Productivity should increase dramatically.  Ancient operating systems are small enough to fit in the head of one person.  The sixth edition consists of 44 files: <br>  14 C headings <br>  28 files with C code <br>  2 files with assembler. <br><br>  All together contains less than 9000 lines of code.  This is with device drivers.  Assembler there is about 10%. <br><br>  In my opinion, the task is quite feasible.  There may be difficulties with assembly code and compiler porting. <br><br><h5>  Performance improvement </h5><br>  Although I tried to speed up work where it is possible, but it is still far from a final solution to the issue.  You can start with the processor simulation code ( <code>pdp11_cpu.c</code> ) - it runs the largest fraction of the time. <br><br><h5>  Input mechanism </h5><br>  Now gbaunix simply executes the command queue sewn up when compiled.  To get closer to reality, a user input method is required.  Alternatively, you can offer a virtual keyboard that normally works with the terminal. <br><br><h5>  Emulation of the original Macintosh on Gameboe </h5><br>  The first Macintosh was not very advanced iron: 8-MHz 16-bit processor, 128 KB RAM, 64 KB ROM, no cache, no interrupts, 400 KB floppy disk, monochrome screen with 512x342 resolution.  For Gameboy, iron is still more powerful than the screen.  In principle, you can create or port a lightweight Macintosh emulator.  The lack of screen can be compensated by scrolling, simulate writing to disk by buffers, etc. <br><br>  Another option is to port the 8088 emulator to run the old version of DOS. <br><br><h4>  Where can I download </h4><br>  <a href="">gbaunix-0.0.tar.bz2</a> <br><br>  It should be noted that to run, you must have a disk image RK05.  It is not included in the kit, but you can download it from the PDP Unix Preservation Society website, if you accept the terms of the license agreement. <br><br>  <a href="http://minnie.tuhs.org/PUPS/">http://minnie.tuhs.org/PUPS/</a> <br><br><h4>  Using </h4><br>  If you just want to see, you can do without recompiling and stitching the runtime simulator and disk image into one heap: <br><br><pre> <code class="bash hljs">% cat unixv5.tmp disks/unixv5.dsk &gt; unixv5.gba</code> </pre><br><br>  <code>unixv5.gba</code> is a ready-to-run image of a cartridge.  It can be used with an emulator, and with an iron console. <br><br>  If you want to recompile gbaunix (highly recommended, this is actually the only way to get fun from the process), then you will need a cross-compilation environment for the ARM architecture.  You may need to fix the Makefile.  The RK05 image should be named <code>disks/unixv5.dsk</code> .  After that, theoretically, a <code>make</code> command should suffice. <br><br><h4>  What else to read on this topic </h4><br>  Sources, binaries and documentation for older UNIX versions <br>  Texts by Dennis Ritchie <br>  SIMH documentation </div><p>Source: <a href="https://habr.com/ru/post/193798/">https://habr.com/ru/post/193798/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../193780/index.html">While Elon Musk is dreaming, Japan makes the fastest train in the world.</a></li>
<li><a href="../193784/index.html">KickSat Microsatellite</a></li>
<li><a href="../193790/index.html">Layout letters and email newsletters. Bit of gmail magic</a></li>
<li><a href="../193792/index.html">The digest of news from the world of mobile development in the last week ‚Ññ24 (September 9‚Äî15, 2013)</a></li>
<li><a href="../193796/index.html">ECG lighting workplace</a></li>
<li><a href="../193802/index.html">27 things that only developers will find fun</a></li>
<li><a href="../193810/index.html">Soft landing system for the first stage of the launch vehicle</a></li>
<li><a href="../193812/index.html">Robotic worm will be able to remove brain tumors</a></li>
<li><a href="../193814/index.html">Robozzle</a></li>
<li><a href="../193820/index.html">Neurointerface Emotiv Insight - collected $ 1,500,000 on Kickstarter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>