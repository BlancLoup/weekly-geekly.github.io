<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>GPS tracker on arduino do it yourself</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After several experiments with Arduina, I decided to make a simple and not very expensive GPS tracker with sending coordinates via GPRS to the server....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>GPS tracker on arduino do it yourself</h1><div class="post__text post__text-html js-mediator-article">  After several experiments with Arduina, I decided to make a simple and not very expensive GPS tracker with sending coordinates via GPRS to the server. <br>  The Arduino Mega 2560 (Arduino Uno) is used, the SIM900 is a GSM / GPRS module (to send information to the server), a SKM53 GPS receiver. <br><a name="habracut"></a><br>  Everything was purchased on ebay.com, in the amount of about 1500 r (about 500r arduin, a little less - GSM module, a little more - GPS). <br><br><h4>  GPS receiver </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/f23/387/179/f233871795aa2409154fb1fe0212846a.jpg" alt="GPS reciever"><br><br>  First you need to deal with work with GPS.  The selected module is one of the cheapest and simplest.  Nevertheless, the manufacturer promises the presence of a battery for storing satellite data.  According to the datasheet, the cold start should take 36 seconds, however, in my conditions (10th floor from the window sill, there are no buildings close) it took as much as 20 minutes.  The next start, however, is already 2 minutes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An important parameter of devices connected to the Arduin - power consumption.  If you overload the Arduin converter, it may burn.  For the receiver used, the maximum power consumption is 45mA @ 3.3v.  Why in the specification to indicate the current strength on a voltage different from the required (5V) is a mystery to me.  However, the 45 mA arduine converter will survive. <br><br><h5>  Connection </h5><br>  GPS is not controlled, although it has an RX pin.  For what is unknown.  The main thing you can do with this receiver is to read the NMEA data from the TX pin.  Levels - 5V, just for Arduin, speed - 9600 baud.  I connect the VIN to the VCC arduine, GND to GND, TX to RX of the corresponding serial.  I read the data first manually, then using the TinyGPS library.  Surprisingly, everything is read.  After switching to Uno, I had to use SoftwareSerial, and then the problems started - some of the message characters were lost.  This is not very critical, since TinyGPS cuts out invalid messages, but rather unpleasantly: you can forget about the frequency in 1 Hz. <br><br>  A small note about SoftwareSerial: there are no hardware ports on Uno (except connected to USB Serial), so you have to use software.  So, he can only receive data on the pin on which the board supports interrupts.  In the case of Uno, these are 2 and 3. Moreover, only one such port can receive data at a time. <br><br>  This is what a ‚Äútest stand‚Äù looks like. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cae/f72/741/caef72741c701d2a6691a402166e0733.jpg" alt="Test stand"><br><br><h4>  GSM receiver / transmitter </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/162/da3/ab5/162da3ab5e84b80e39db1b97b0b839cd.jpg" alt="GSM Shield"><br><br>  Now the more interesting part begins.  GSM module - SIM900.  It supports GSM and GPRS.  Neither EDGE, nor even 3G, are supported.  This is probably good for transferring coordinate data - there will be no delays and problems when switching between modes, plus GPRS is almost everywhere now.  However, for some more complex applications this may not be enough. <br><br><h5>  Connection </h5><br>  The module is also controlled by a serial port, with the same level - 5V.  And here we will need both RX and TX.  The module is a shield, that is, it is installed on the arduin.  And it is compatible with both mega and uno.  The default speed is 115200. <br><br>  We are going to Mega, and here we are waiting for the first unpleasant surprise: the TX pin of the module falls on the 7th pin of mega.  At the 7m pin of the mega, interrupts are not available, which means you have to connect the 7th pin, say, to 6m, at which interruptions are possible.  Thus, we will spend one pin of arduin for nothing.  Well, for mega it's not very scary - still enough pins.  But for Uno it is more difficult (remember, there are only 2 pins supporting interrupts - 2 and 3).  As a solution to this problem, it is possible not to install the module on the arduin, but to connect it with wires.  Then you can use Serial1. <br><br>  After connecting, we are trying to ‚Äútalk‚Äù with the module (do not forget to enable it).  We select the port speed - 115200, while it‚Äôs good if all the built-in serial ports (4 on mega, 1 on uno) and all software work at the same speed.  So you can achieve a more sustainable data transfer.  Why - I do not know, although I guess. <br><br>  So, we write a primitive code for transferring data between serial ports, send atz, in response to silence.  What?  And, case sensitive.  ATZ, we get OK.  Hurray, the module hears us.  And do not call us for the sake of interest?  ATD + 7499 ... The city telephone rings, the smoke comes from the arduine, the laptop is cut down.  Arduino converter burned out.  It was a bad idea to feed him with 19 volts, although it is written that he can work from 6 to 20V, recommend 7-12V.  The datasheet on the GSM module does not say anywhere about the power consumption under load.  Well, Mega is sent to the spare parts warehouse.  With a sinking heart, I turn on the laptop, which received + 19V over a + 5V line from USB.  It works, and even USB is not burned out.  Thank you Lenovo for the protection. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bdb/105/3b0/bdb1053b0544de99c8103abd4b996967.jpg" alt="Burned down converter"><br><br>  After the converter burnout, I looked for the current consumed.  So, the peak - 2A, typical - 0.5A.  This is clearly not the strength of the Arduin converter.  Need a separate power. <br><br><h5>  Programming </h5><br>  The module provides extensive data transfer capabilities.  Starting from voice calls and SMS and ending, in fact, GPRS.  And for the latter it is possible to perform an HTTP request using AT commands.  We'll have to send a few, but it's worth it: you don't really want to form a request manually.  There are a couple of nuances with the opening of the data transmission channel via GPRS - remember the classic AT + CGDCONT = 1, ‚ÄúIP‚Äù, ‚Äúapn‚Äù?  So, here the same thing is needed, but slightly more cunning. <br><br>  To get the page at a specific URL, you need to send the following commands: <br><pre><code class="cpp hljs">AT+SAPBR=<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">//  (Carrier) AT+SAPBR=3,1,"CONTYPE","GPRS" //  - GPRS AT+SAPBR=3,1,"APN","internet" //APN,   - internet AT+HTTPINIT // HTTP AT+HTTPPARA="CID",1 //Carrier ID  . AT+HTTPPARA="URL","http://www.example.com/GpsTracking/record.php?Lat=%ld&amp;Lng=%ld" // URL,  sprintf   AT+HTTPACTION=0 //   GET //  AT+HTTPTERM // HTTP</span></span></code> </pre> <br><br>  As a result, if there is a connection, we will receive a response from the server.  That is, in fact, we already know how to send coordinate data if the server accepts it via GET. <br><br><h5>  Nutrition </h5><br>  As I found out to feed the GSM module from the Arduino converter a bad idea, it was decided to buy a 12v-&gt; 5v, 3A converter, on the same ebay.  However, the module does not like power in 5V.  We go to the hack: we connect 5V to the pin, from which comes 5V from the arduin.  Then the built-in converter of the module (significantly more powerful than the converter of the Arduin, MIC 29302WU) makes 5V of what the module needs. <br><br><h4>  Server </h4><br>  The server wrote a primitive - storing coordinates and drawing on Yandex.cards.  In the future, it is possible to add various features, including support for many users, the status of "armed / not armed," the state of the vehicle systems (ignition, headlights, etc.), it is even possible to control the vehicle systems.  Of course, with the appropriate support for the tracker, smoothly turning into a full-fledged alarm. <br><br><h4>  Field trials </h4><br>  Here is the assembled device, without the case: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b86/b09/b88/b86b09b8857439c80d3d3db584e60001.jpg" alt="Assembled device"><br><br>  After installing the power converter and placing it in the case of a dead DSL modem, the system looks like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/bad/18d/da8/bad18dda838b82e94dde63a663ddf283.jpg" alt="In the case"><br><br>  I soldered the wires, took out several contacts from the arduin's pads.  Look like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/464/49a/40d/46449a40d649cf1934477706be5b8f42.jpg" alt="image"><br><br>  I connected 12V in the car, drove around Moscow, got a track: <br><img src="https://habrastorage.org/getpro/habr/post_images/737/0f5/496/7370f5496c310f12c043f45ac384734c.png" alt="Track"><br>  The track points are far enough apart.  The reason is that sending data via GPRS takes a relatively long time, and at this time the coordinates are not read.  This is a clear programming error.  It is treated first, by sending immediately a bundle of coordinates with time, and secondly, by asynchronous work with the GPRS module. <br><br>  The search time for satellites in the passenger seat of the car is a couple of minutes. <br><br><h4>  findings </h4><br>  Creating a GPS tracker on arduino with your own hands is possible, although it is not a trivial task.  The main question now is how to hide the device in the car so that it is not exposed to harmful factors (water, temperature), was not covered by metal (GPS and GPRS will be shielded) and was not particularly noticeable.  While just lying in the cabin and connects to the cigarette lighter socket. <br><br>  Well, and still need to correct the code for a smoother track, although the main task tracker and so does. <br><br><h4>  Used devices </h4><br><ul><li>  Arduino Mega 2560 [compatible] </li><li>  Arduino Uno [compatible] </li><li>  GPS SkyLab SKM53 </li><li>  SIM900 based GSM / GPRS Shield </li><li>  DC-DC 12v-&gt; 5v 3A converter </li></ul><br><br><h4>  Literature </h4><br><ol><li>  <a href="http://arduino.cc/">Of</a>  <a href="http://arduino.cc/">Arduino site</a> (contains detailed information about boards and their programming) </li><li>  <a href="http://arduiniana.org/libraries/tinygps/">TinyGPS</a> (download link in the middle of the page) </li><li>  <a href="http://www.nooelec.com/files/SKM53_Datasheet.pdf">GPS SKM53 Datasheet</a> </li><li>  <a href="http://www.geeetech.com/wiki/index.php/Arduino_GPRS_Shield">GSM / GPRS Shield description on SIM900</a> </li><li>  <a href="http://www.geeetech.com/Documents/SIM900_AT_Command_Manual_V1.03.pdf">SIM900 AT Commands</a> </li><li>  <a href="">Yandex.Cards documentation</a> </li></ol><br><br><h4>  Code </h4><br>  The published code can be used for any purposes permitted by law by any persons.  The quality of the code is terrible, because it is still a test case.  When I add to something more beautiful, update. <br><br>  To compile the code for Arduino, you need to import the tinygps library. <br><br>  <b>UPD</b> Code: <a href="https://drive.google.com/file/d/0B_bMfbqH37bAV1lGQUZRVFJqYzA/view">GDrive</a> <br>  <a href="https://drive.google.com/file/d/0B_bMfbqH37bAZU9ud2o3bGpubDQ/view%3Fusp%3Dsharing">Sketch</a> </div><p>Source: <a href="https://habr.com/ru/post/196150/">https://habr.com/ru/post/196150/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../196136/index.html">Initial setup of Tomcat and its registration with NetBeans</a></li>
<li><a href="../196138/index.html">Explanatory head phraseological dictionary - with explanations</a></li>
<li><a href="../196140/index.html">Game Maker AI - How to start?</a></li>
<li><a href="../196144/index.html">Derby.js materials</a></li>
<li><a href="../196146/index.html">(Archive) Matreshka.js - Introduction</a></li>
<li><a href="../196152/index.html">The Tale of Selenium Testing</a></li>
<li><a href="../196154/index.html">Closes the project WebHostingHub Glyphs</a></li>
<li><a href="../196156/index.html">The company Bathys Hawaii presented the world's first atomic wristwatch</a></li>
<li><a href="../196158/index.html">Voice search "in Russian"</a></li>
<li><a href="../196160/index.html">"Wizard of the Emerald City" on the iPad? Are all projects good for crowdfunding?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>