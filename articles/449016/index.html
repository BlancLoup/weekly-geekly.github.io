<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Optical file system steganography</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Being in search of interesting information about steganography, I came across an interesting article about steganography in the file system , and afte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Optical file system steganography</h1><div class="post__text post__text-html js-mediator-article">  Being in search of interesting information about steganography, I came across an interesting article about <a href="https://habr.com/ru/post/347604/">steganography in the file system</a> , and after some time, she suggested me the idea of ‚Äã‚Äãcreating steganography in the optical disk file system. <br><br>  Probably, nowadays, there are almost no people left who would use discs in everyday life, because they were replaced by a more worthy option in the face of <b>flash drives</b> . <br><br>  After some thought, I decided that the disks could still be used for some time, for example, inside their file system, you could hide some secret information and then transfer it to another so that no one suspected anything. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is what we are going to do, namely: we will use the python library, which will help us encode information from a text file, and then hide it in the depths of our disk. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/235/4b3/b31/2354b3b3162bfeacfb70a03795e8dd27.jpg" alt="image"><br><a name="habracut"></a><br>  But before we begin, let's first analyze some little things, as well as define the concept of an optical disk. <br><br><h2>  What is an optical disk </h2><br>  Optical disc (optical disc) is a collective name for information carriers made in the form of discs, which are read using optical (laser) radiation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9a3/73d/c86/9a373dc86452a23bb25d7a0e3c28a1cc.jpg" alt="image"><br><br>  Each disk on a computer is represented in a specific format as an <b>image</b> , which contains all the information and the disk structure, and is used to work with information without optical media, as well as archiving data on solid media. <br>  The standard format for optical disks is <a href="https://ru.wikipedia.org/wiki/ISO_9660">iso9660</a> , but there is <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B7_%25D0%25BE%25D0%25BF%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25B4%25D0%25B8%25D1%2581%25D0%25BA%25D0%25B0">still</a> <br>  Keep in mind that the image contains less information than the original CD.  The disc contains service information, which can, in particular, be used for <a href="http://www.wikiwand.com/ru/%25D0%2597%25D0%25B0%25D1%2589%25D0%25B8%25D1%2582%25D0%25B0_%25D0%25BE%25D1%2582_%25D0%25BD%25D0%25B5%25D1%2581%25D0%25B0%25D0%25BD%25D0%25BA%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25BA%25D0%25BE%25D0%25BF%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F">copy protection.</a>  We will work with ISO9660. <br><br><h2>  Inside view </h2><br>  And now let's look at the structure of iso9660 from the inside, you can find detailed information <a href="https://studopedia.su/7_28832_faylovaya-sistema-ISO-.html">here</a> , <a href="https://ru.bmstu.wiki/ISO_9660">here</a> and <a href="http://perscom.ru/2012-03-09-17-36-49/77-cd-rom/435-iso-9660">here</a> , and for those who know English, also <a href="http://www.cdfs.com/cdfs-iso-primary.html">here</a> .  From myself I‚Äôll just say that basically it consists of 2 descriptors: <b>Boot Record</b> and <b>Primary Volume Descriptor (PVD)</b> , you can open any iso in <a href="https://www.sweetscape.com/010editor/">010editor</a> and see for yourself. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/197/2c7/f30/1972c7f306073dcc711b21f9702d0015.jpg" alt="image"><br><br>  Boot Record can be used by systems that need to initialize many types of data before making the disk available, although ISO 9660 does not indicate what information in Boot Record or how to use it at all. <br><br>  PVD is the starting point in the identification of <b>iso9660,</b> it looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/46e/a3e/f1d/46ea3ef1d9067a92e43cd7d47291eda4.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/01b/0f3/68e/01b0f368efe93102fe37e854b684edba.jpg" alt="image"><br><br>  For lovers of schemes: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cee/15e/6e5/cee15e6e544dc026f0c577e6cc60ee4c.png" alt="image"><br><br>  More information can be found <a href="https://www.cdroller.com/htm/readdata.html">here.</a> <br><br>  And we move on. <br><br><h2>  ISO initialization </h2><br>  We will work with the root directory, we will create our own directories in it and add the necessary files. <br><br>  For this we will use the <b>pycdlib</b> library, you can read it well by <a href="https://clalancette.github.io/pycdlib/">following the</a> link. <br><br>  Let's go over to writing the program, but who does not want to go step by step, you will find the source code via the link to <a href="https://github.com/ulmee/stegiso">my repository</a> in the githab: <br><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     import base64 import pycdlib</span></span></code> </pre> <br><h2>  Preparing text files </h2><br>  Now we need to prepare our files, which we drop into the structure of our iso. <br><br>  The course of action is as follows: <br><br><ol><li>  We take the source text in certain files and read it into variables; nothing prevents us from taking a lot of text, but for the demonstration I took only a couple of sentences in each file; we will continue to manipulate these variables </li><li>  After we read the sentences, we need to encode the contents. We will encode using <b><a href="https://ru.wikipedia.org/wiki/Base64">base64</a></b> </li><li>  We write the encoded content into new files called <b>UP</b> and <b>DOWN</b> .  Files are so called because I decided to make a permutation so that 1 part of 1st file and 1 part of 2nd file (ie upper parts) are recorded in <b>UP</b> , and in <b>DOWN</b> 2 part of 1st file and 2 part of 2nd file ( Ie the lower parts) </li></ol><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'/home/ul/stegist1.txt'</span></span>,<span class="hljs-string"><span class="hljs-string">'rb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> stegist1:<span class="hljs-comment"><span class="hljs-comment">#   for line1 in stegist1.readlines(2): print(line1)#   1  for line2 in stegist1.readlines(2): print(line2)#   1  stegist1.close() enc_line1=base64.b64encode(line1)#     base64 enc_line2=base64.b64encode(line2) with open('/home/ul/stegist2.txt','rb') as stegist2: for line3 in stegist2.readlines(2):#   2  print(line3) for line4 in stegist2.readlines(2):#   2  print(line4) stegist2.close() enc_line3=base64.b64encode(line3)#   print(enc_line3) enc_line4=base64.b64encode(line4) print(enc_line4) with open('/home/ul/UP.txt','ab') as up:#  UP    up.write(enc_line1) up.write(enc_line3) with open('/home/ul/DOWN.txt','ab') as down:#  DOWN    down.write(enc_line2) down.write(enc_line4)</span></span></code> </pre><br><h2>  Concealment </h2><br>  It's time to go to the same pycdlib library, which I spoke about at the beginning.  It‚Äôs not difficult to work with it: we create an object through which we further add various files and directories inside. <br><br><pre> <code class="python hljs">iso=pycdlib.PyCdlib() <span class="hljs-comment"><span class="hljs-comment">#   PyCdlib iso.new(rock_ridge='1.09')#  rockridge(    iso   ) iso.add_directory(iso_path='/A1',rr_name='a1')#  (  ) iso.add_directory(iso_path='/B1',rr_name='b1') iso.add_directory(iso_path='/B1/B2',rr_name='b1b2') iso.add_directory(iso_path='/A1/A2',rr_name='a1a2') iso.add_file('/home/ul/stegistup.txt', iso_path='/A',rr_name='a')#   up iso.add_file('/home/ul/stegistdown.txt', iso_path='/B',rr_name='b')#   down iso.write('papastegisto.iso')#  iso ()</span></span></code> </pre> <br>  As we can see, our text successfully recorded <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c92/800/103/c928001039c9e928bfa46616fbaa0810.jpg" alt="image"><br><br>  I want to notice that we can create a certain path, for example <b>/ A</b> , either a file or a folder. <br><br>  If we first specify the creation of a directory in <b>/ A</b> , and then specify the creation of a file in <b>/ A,</b> an error message is displayed, it doesn‚Äôt matter that we put the file in a folder. <br><br><h2>  ISO9660 File System Extensions </h2><br>  There are 2 main <b>extensions</b> for the iso file system, these are: <b>RockRidge and Joilet</b> . <br><br><h3>  Rockidge </h3><br>  This is an ISO 9660 file system extension designed to store file attributes used in POSIX operating systems (ie, Unix-compatible). <br><br>  Rock Ridge extensions are written on top of the ISO 9660 file system so that an optical disc with Rock Ridge can be read by software designed to work with ISO 9660. <br><br><div class="spoiler">  <b class="spoiler_title">Read more</b> <div class="spoiler_text">  Rock Ridge can store the following additional information about the contents of the disc: <br><br><ul><li>  long file names (up to 255 characters); </li><li>  fewer restrictions on the use of characters in file names; </li><li>  directory structure of arbitrary nesting. </li><li>  attributes are written for each file: </li><li>  file permissions, including the uid and gid fields; </li><li>  the number of hard links to the file; </li><li>  times of creation, modification, access, attribute changes, etc. </li><li>  special files are supported: </li><li>  sparse files; </li><li>  symbolic links; </li><li>  device files; </li><li>  socket files; </li><li>  FIFO files. </li></ul><br>  These data are recorded in special directories whose names are usually hidden. </div></div><br><h3>  Joilet </h3><br>  This is an extension of the ISO 9660 file system, created to relax restrictions on the file name imposed in ISO 9660. The specification was developed by Microsoft and supported by all versions of Microsoft Windows since Windows 95 and Windows NT 4.0. <br>  The default is used on all CD-ROMs with data released after 1995. <br><br><div class="spoiler">  <b class="spoiler_title">Read more</b> <div class="spoiler_text">  Joliet introduces an extra set of file names.  Names are up to 64 Unicode characters and are stored in UCS-2 encoding.  To store them, a special additional header is used (Supplementary Volume Descriptor, SVD), which is absolutely ignored by ISO 9660-compatible programs, thus ensuring backward compatibility. <br><br>  Most existing software platforms, including Microsoft Windows, Linux, Mac OS X, and FreeBSD, are capable of reading storage media with the Joliet file system extension, which allows files to be exchanged between these operating systems even using non-Latin alphabets (such as Arabic, Japanese, Cyrillic) which was not possible with the usual ISO 9660. <br></div></div><br>  In fact, there is also a 3 extension for the iso file system, it is called <b>Romeo</b> . <br><br>  This is an extension of ISO 9660 for MS Windows 95, there is little information on it on the Internet, and, most likely, this extension is not used anywhere else. <br><br>  <b>More information</b> on extensions and file systems for CD / DVD can be found <a href="http://www.bog.pp.ru/work/cdfs.html">here</a> , and now let's go back to our program. <br><br>  The resulting code to encode information from a file and place files with encoded information in iso looks like this: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     import base64 import pycdlib #   with open('/home/ul/stegist1.txt','rb') as stegist1: #  for line1 in stegist1.readlines(2): print(line1) #  for line2 in stegist1.readlines(2): print(line2) #  enc_line1=base64.b64encode(line1) print(enc_line1) enc_line2=base64.b64encode(line2) print(enc_line2) with open('/home/ul/stegist2.txt','rb') as stegist2: #  for line3 in stegist2.readlines(2): #  print(line3) for line4 in stegist2.readlines(2): #  print(line4) enc_line3=base64.b64encode(line3) #  print(enc_line3) enc_line4=base64.b64encode(line4) print(enc_line4) with open('/home/ul/UP.txt','ab') as up: #  UP    up.write(enc_line1) up.write(enc_line3) with open('/home/ul/DOWN.txt','ab') as down: #  DOWN    down.write(enc_line2) down.write(enc_line4) #   iso iso=pycdlib.PyCdlib() iso.new(rock_ridge='1.09') iso.add_directory(iso_path='/A1',rr_name='a1') iso.add_directory(iso_path='/B1',rr_name='b1') iso.add_directory(iso_path='/B1/B2',rr_name='b1b2') iso.add_directory(iso_path='/A1/A2',rr_name='a1a2') iso.add_file('/home/ul/stegistup.txt', iso_path='/A',rr_name='a') iso.add_file('/home/ul/stegistdown.txt', iso_path='/B',rr_name='b') iso.write('papastegisto.iso')</span></span></code> </pre> <br>  And I remind you that the full code is also on the link to the <a href="https://github.com/ulmee/stegiso">githab</a> <br>  Now let's get to the final part - we write our resulting iso to disk <br>  You can record what you want, but I will use <a href="https://ru.wikipedia.org/wiki/Nero">Nero 7</a> <br>  We will use <b>CD-R</b> <br><div class="spoiler">  <b class="spoiler_title">CD-ROM, CD-R and CD-RW</b> <div class="spoiler_text">  They differ in that a CD-ROM is a disk for reading data only; nothing can be written there.  CD-R and CD-RW are recordable discs.  CD-R allows you to write once to disk, CD-RW - repeatedly. <br><br>  <b>What about the DVD?</b> <br><br>  The main difference from CD-R / RW is the amount of data that can be burned to a 4.7 GB DVD-ROM against 650,700 MB.  Some DVD formats support up to 13 and even 17 GB <br>  <a href="http://old.ci.ru/inform09_04/p_22.htm">More disc information</a> <br></div></div><br>  As we can see, the program has successfully written to disk. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ac1/e63/c0e/ac1e63c0ea8567722796af3b92bf6bcd.jpg" alt="image"><br><br>  Now we can transfer it to the disk to the people we want. <br><br><h2>  Decoding </h2><br>  Why should we do all this if the information cannot be decoded back, right? <br><br>  If you are interested in the method, you can write a program that will withdraw and decode the attached files, it will be used by ‚Äúyour people‚Äù. <br><br>  And that is all.  My task was to demonstrate one of the possible ways of hiding information, using disks, which, it would seem, have sunk into oblivion. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f23/0c2/38d/f230c238d56aec56099fbc8955e596f5.jpg" alt="image"><br><br>  I would be glad to see your suggestions, additions, corrections and other feedback. <br><br>  PS I want to express special thanks to <a href="https://habr.com/ru/users/PavelMSTU/">@PavelMSTU</a> for advice and motivational kicks. </div><p>Source: <a href="https://habr.com/ru/post/449016/">https://habr.com/ru/post/449016/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449002/index.html">Formal verification using the wolf, goat and cabbage problem</a></li>
<li><a href="../449004/index.html">New in certification of information security tools</a></li>
<li><a href="../449006/index.html">Hidden complexity of video game slots</a></li>
<li><a href="../449008/index.html">Logging HTTP requests in Spring Boot using Reels</a></li>
<li><a href="../449014/index.html">Promoting Ethereum DAPP</a></li>
<li><a href="../449022/index.html">Analysis of the CUBA Platform code using PVS-Studio</a></li>
<li><a href="../449024/index.html">"The Mystery of the Third Planet" with improved neural networks graphics</a></li>
<li><a href="../449026/index.html">Operating Systems: Three Easy Pieces. Part 4: Scheduler Introduction (Translation)</a></li>
<li><a href="../449028/index.html">Anger, bargaining and depression when working with InfluxDB</a></li>
<li><a href="../449036/index.html">And again the wolf in sheep's clothing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>