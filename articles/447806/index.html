<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We accelerate the work of neural networks with the help of hashing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The industry has focused on accelerating matrix multiplication, but improving the search algorithm can lead to a more serious increase in speed. 


 I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We accelerate the work of neural networks with the help of hashing</h1><div class="post__text post__text-html js-mediator-article"><h3>  The industry has focused on accelerating matrix multiplication, but improving the search algorithm can lead to a more serious increase in speed. </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/8e7/9a0/8e3/8e79a08e31fdeadd8258ab001cc23ec5.jpg"><br><br>  In recent years, the computer industry has been busy trying to speed up the calculations required for artificial neural networks, both for learning and for drawing conclusions from its work.  In particular, quite a lot of effort was put on the development of a special iron on which to perform these calculations.  Google developed the <a href="https://cloud.google.com/blog/products/gcp/an-in-depth-look-at-googles-first-tensor-processing-unit-tpu">Tensor Processing Unit</a> , or TPU, first <a href="https://cloud.google.com/blog/products/gcp/google-supercharges-machine-learning-tasks-with-custom-chip">presented</a> to the public in 2016.  Later, Nvidia introduced the <a href="https://www.nvidia.com/en-us/data-center/tesla-v100/">V100</a> Graphics Processing Unit, describing it as a chip specially designed for teaching and using AI, as well as for other high-performance computing needs.  Full and other startups concentrating on other types of <a href="https://spectrum.ieee.org/tech-talk/computing/embedded-systems/two-startups-use-processing-in-flash-memory-for-ai-at-the-edge">hardware accelerators</a> . <br><a name="habracut"></a><br>  Perhaps they all make a big mistake. <br><br>  Such a thought was voiced in a <a href="https://arxiv.org/pdf/1903.03129.pdf">work</a> that appeared in mid-March on the arXiv website.  In it, its authors, <a href="https://www.cs.rice.edu/~bc20/">Beydi Chen</a> , <a href="http://rushlab.blogs.rice.edu/about/team/">Tarun Medini</a> and <a href="https://www.cs.rice.edu/~as143/">Anshumali Srivastava</a> from Rice University, argue that, perhaps, the special equipment developed for the operation of neural networks is optimized for the wrong algorithm. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The thing is that the work of neural networks usually depends on how quickly the equipment can multiply the matrices used to determine the output parameters of each artificial neutron - its ‚Äúactivation‚Äù - for a given set of input values.  Matrices are used because each input value for a neuron is multiplied by the corresponding weight parameter, and then all of them are added together - and this multiplication with addition is the basic operation of matrix multiplication. <br><br>  Researchers from Rice University, like some other scientists, realized that the activation of many neurons in a particular layer of the neural network is too small, and does not affect the output value, calculated by subsequent layers.  Therefore, if you know what these neurons are, you can simply ignore them. <br><br>  It may seem that the only way to find out which neurons in the layer are not activated is to first perform all the operations of the matrix multiplication for this layer.  But the researchers realized that in fact you can decide on this in a more efficient way if you look at the problem from a different angle.  ‚ÄúWe approach this issue as a solution to the search problem,‚Äù says Srivastava. <br><br>  That is, instead of calculating matrix multiplications and watching which neurons are activated for given input data, you can simply see which neurons are in the database.  The advantage of this approach in the problem is that you can use a generalized strategy that has long been improved by computer scientists to speed up the search for data in the database: hashing. <br><br>  Hashing allows you to quickly check whether there is a desired value in a database table, without having to go through each row in sequence.  You use a hash that is easily calculated by applying the hash function to the desired value, indicating where this value should be stored in the database.  Then you can check only this one place to find out if this value is stored there. <br><br>  Researchers did something similar for calculations related to neural networks.  The following example will help illustrate their approach: <br><br>  Suppose we created a neural network that recognizes handwritten input of numbers.  Suppose the input data is gray pixels in a 16x16 array, that is, there are 256 numbers in all.  We feed this data to one hidden layer of 512 neurons, the activation results of which are fed to the output layer of 10 neurons, one for each of the possible digits. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e73/dec/941/e73dec9413ed37b2235bbd1ee8369ca6.jpg"><br><br>  <i>Tables from networks: before calculating the activation of neurons in hidden layers, we use hashes that help us determine which neurons will be activated.</i>  <i>Here, the H1 input hash is used to search for the corresponding neurons in the first hidden layer - in this case, these will be neurons 2 and 4. The second hash H2 shows which neurons from the second hidden layer will contribute.</i>  <i>This strategy reduces the number of activations that need to be calculated.</i> <br><br>  It is rather difficult to train such a network, but for the time being we will omit this moment and imagine that we have already adjusted all the weights of each of the neurons so that the neural network perfectly recognizes handwritten numbers.  When a clearly written digit arrives at the input, the activation of one of the output neurons (corresponding to this digit) will be close to 1. The activation of the other nine will be close to 0. Classically, the work of such a non-network requires one matrix multiplication for each of the 512 hidden neurons, and one more for each weekend - which gives us a lot of multiplications. <br><br>  Researchers take a different approach.  The first step is to hash the weights of each of the 512 neurons in the hidden layer with the help of ‚Äúlocality sensitive hashing‚Äù hashing, one of the properties of which is that similar input data gives similar hash values.  Then you can group neurons with similar hashes, which will mean that these neurons have similar sets of weights.  Each group can be stored in a database, and determined by the hash of the input values, which will lead to the activation of this group of neurons. <br><br>  After all this hashing, it is easy to determine which of the hidden neurons will be activated by some new input data.  It is necessary to drive 256 input values ‚Äã‚Äãthrough easily calculated hash functions, and use the result to search the database for those neurons that will be activated.  In this way, it is necessary to calculate the activation values ‚Äã‚Äãfor only a few neurons that have a value.  No need to count the activation of all other neurons in the layer only to find out that they do not contribute to the result. <br><br>  The input to the input of such a neural network can be represented as the execution of a search query to the database, which asks to find all the neurons that would be activated during direct counting.  You get the answer quickly because you are searching for hashes.  And then you can simply calculate the activation of a small number of neurons that really matter. <br><br>  The researchers used this technique, called SLIDE (Sub-LInear Deep Learning Engine), to teach the neural network for a process that has more computational requests than the use of the neural network for its intended purpose.  They then compared the speed of the learning algorithm with a more traditional approach using a powerful GPU ‚Äî specifically, the Nvidia V100 GPU.  As a result, they got something amazing: ‚ÄúOur results show that on an average CPU, the SLIDE technology can work orders of magnitude faster than the best possible alternative implemented on the best hardware and with any accuracy.‚Äù <br><br>  It is too early to draw conclusions as to whether these results (which have not yet been evaluated by experts) withstand the tests and will force chip manufacturers to take a different look at the development of special equipment for in-depth training.  But the work definitely emphasizes the danger of dragging a certain type of iron in cases when there is a possibility of the emergence of a new and better algorithm for the operation of neural networks. </div><p>Source: <a href="https://habr.com/ru/post/447806/">https://habr.com/ru/post/447806/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447790/index.html">Learn to write Waves smart contracts for RIDE and RIDE4DAPPS. Part 1 (Multiplayer Wallet)</a></li>
<li><a href="../447792/index.html">‚ÄúDark patterns‚Äù and the law: how US regulators try to control product mechanics and reduce the influence of tech companies</a></li>
<li><a href="../447794/index.html">About simple things, difficult. Chemist writing to a 3D printer. Solvents for plastics and protection against them</a></li>
<li><a href="../447802/index.html">Isabella 2</a></li>
<li><a href="../447804/index.html">Dwarf Fortress refuses text graphics, but not its essence.</a></li>
<li><a href="../447808/index.html">Learn to write Waves smart contracts for RIDE and RIDE4DAPPS. Part 2 (DAO - Decentralized Autonomous Organization)</a></li>
<li><a href="../447810/index.html">Analytics for Azure DevOps Services is now publicly available.</a></li>
<li><a href="../447812/index.html">How we implemented continuous delivery of updates to the customer platform</a></li>
<li><a href="../447814/index.html">Where and how to open a development center?</a></li>
<li><a href="../447816/index.html">Some C ++ template magic and CRTP to control the correctness of the programmer's actions in compile-time</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>