<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Browser driven machine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Habr√©, there have already been several articles on typewriters, managed via WiFi and with a webcam on board. 

 Here is one article: " Radio-contro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Browser driven machine</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/da9/ab1/b83/da9ab1b8380ba15e19da4824578e1aa4.jpg"><br><br>  On Habr√©, there have already been several articles on typewriters, managed via WiFi and with a webcam on board. <br><br>  Here is one article: " <a href="http://habrahabr.ru/post/135790/">Radio-controlled Wi-Fi machine with a camera</a> " And here is another article on the topic: " <a href="http://habrahabr.ru/post/145897/">Race of tarantuses controlled via the Internet</a> " 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I want to propose a new (?) Way to create such machines. <a name="habracut"></a><br><br>  To solve this problem, you need to decide on the command transfer channel per machine and think about the video transmission channel from the machine to the client in the browser. <br><br>  I thought over many different options, until I had the idea to use the Android OS phone as a brain machine. <br><br>  This solution immediately gives many advantages: there is a camera on the phone, you can probably organize a broadcast from it.  Again, there is WiFi - you can organize the transfer of commands there and / or from there.  And the weight is small ... <br><br>  Of course, many other problems immediately arise - how to program the phone and how to connect motors to the phone. <br><br>  To connect the phone with the outside world, I used its audio jack.  Several short WAV audio files with a sinusoidal signal of different frequencies: 1000 Hz, 1200 Hz, 1400 Hz ... Their reproduction at the right moment is the command. <br><br><img src="https://habrastorage.org/storage2/ae4/75c/9f4/ae475c9f44d5cdc14fb17afd509f7691.jpg"><br><br>  I connected the <b>Mars rover</b> to the audio connector (there were several articles about it on the Habr√©).  This is a board for beginners experimenting with Altera's FPGAs.  Of course, the FPGA does not have an ADC for digitizing audio, but I don‚Äôt need it.  It is enough that the input element of the plisina switches at a certain threshold in the presence of the input audio signal.  This <a href="http://marsohod.org/index.php/projects/202-android0">was done</a> .  Then for the FPGA he made a project in the Altera Quartus II environment, which measures the frequency of the input signal and interprets it as a command. <br><br><img src="https://habrastorage.org/storage2/5f6/459/b29/5f6459b29b44108b606b591cc14b2925.jpg"><br><br>  At first I just turned on different LEDs, playing different sound files on the phone.  So convinced that the idea works.  Then he connected the motors to the board. <br><br>  I had no experience in phone programming, I had to read and search a lot on the Internet.  As a result, I stopped in the Python language - it turns out you can write small scripts almost on the phone and run them right there.  To do this, you need to install SL4A (Script Layer For Android) on the phone and the actual support of Python itself.  A site where you can read more about it - <a href="http://code.google.com/p/android-scripting/">http://code.google.com/p/android-scripting/</a> There you can also download the SL4A in the download section.  There are API descriptions and examples. <br><br>  Studying the examples of Python scripts for the phone, I realized that everything should work out - after all, I had a rather powerful tool in my hands. <br><br>  I will give a simple example.  In order for the phone to start streaming video, you need to start using SL4A here's a simple script on the phone: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android droid = android.Android() droid.wakeLockAcquireBright() droid.webcamStart(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">9091</span></span>) droid.webcamAdjustQuality(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> <br><br>  After that, the browser can connect to the phone on port 9091. True, there were problems with Firefox, but Chrome shows pretty well.  Another trick is that the video should be faster and the phone should be faster.  My HTC Wildfire S is not very fast, so the video sometimes slowed down. <br><br>  Experimenting further, I decided that it would be right to launch the ‚Äúweb server‚Äù right on the phone.  The server is also implemented as a Python script.  The server sends pages in the form of html frames: in one frame of the video, and in the other HTML FORM with the buttons ‚ÄúStart‚Äù, ‚ÄúStop‚Äù, ‚ÄúLeft‚Äù, ‚ÄúRight‚Äù, ‚ÄúBack‚Äù.  By pressing the buttons, the client browser sends an HTTP-GET request to the server running on the phone.  The server interprets the GET requests and plays the desired sound files.  The board recognizes the frequency of the beeps and turns the motors on or off.  Something like that. <br><br>  After testing each module individually, you can assemble and test the entire ‚Äúsystem‚Äù - a crawler type vehicle with a Mars Rover card and an Android OS phone: <br><br><img src="https://habrastorage.org/storage2/d3a/cfc/2f4/d3acfc2f4ca111728c4edf7f2afff719.jpg"><br><br>  Here is a video demonstration: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/GEYErPdFJrU%3Ffeature%3Doembed&amp;xid=25657,15700019,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhg-DeJ60KvzH6gqt2WiNaSprWke8g" frameborder="0" allowfullscreen=""></iframe><br><br>  All project sources, of course, are open and can be found <a href="http://marsohod.org/index.php/projects/205-carctrlandr">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/146020/">https://habr.com/ru/post/146020/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146012/index.html">Developers will be able to respond to comments on Google Play</a></li>
<li><a href="../146016/index.html">Runet Today, June 18, 2012 Issue Experts: Arkady Sandler, Ilya Dronov</a></li>
<li><a href="../146017/index.html">We invite you to a free webinar "Audit file servers"</a></li>
<li><a href="../146018/index.html">HP adds deduplication catalyst to StoreOnce</a></li>
<li><a href="../146019/index.html">Depth in Agile: Shodan Adherence Metrics</a></li>
<li><a href="../146021/index.html">Installing ruby ‚Äã‚Äãin Ubuntu using rbenv-installer</a></li>
<li><a href="../146023/index.html">MemSQL has launched!</a></li>
<li><a href="../146024/index.html">On the need for self-development in the modern world</a></li>
<li><a href="../146025/index.html">Google I / O Extended Developer Events</a></li>
<li><a href="../146026/index.html">Kenya abolishes software import tax in hopes of reducing piracy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>