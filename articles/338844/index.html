<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Web server - your first Arduino network program</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In my publications [1,2,3] the sensor chain is described in detail - Arduino-interface Python. In real conditions of industrial product...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Web server - your first Arduino network program</h1><div class="post__text post__text-html js-mediator-article"><h3>  Introduction </h3><br>  In my publications [1,2,3] the sensor chain is described in detail - Arduino-interface Python.  In real conditions of industrial production, the sensors are located at a considerable distance not only from each other but also from the place where the centralized processing of the measuring information takes place.  It is logical to transmit information from sensors over a computer LAN using well-developed network technologies.  This publication is written in style exercises for assembling and configuring a network application with Arduino at home. <br><br><h3>  Formulation of the problem </h3><br><ol><li>  Use the Arduino Ethernet library with the Arduino Ethernet Shield extension to create a web server. </li><li>  Create remote access to Arduino using the network on your home computer. </li><li>  Use the standard Arduino example to provide moisture and motion sensor values ‚Äã‚Äãusing a web server. </li><li>  Develop web applications using Python. </li></ol><br><h3>  Stages of solving the problem </h3><br><ol><li>  Design and build hardware for using Arduino and Ethernet Shield. </li><li>  Running the default sample from the Arduino development environment as the starting point for creating a server. </li><li>  Changing the example to place your equipment and redeploy code. </li><li>  Web application development using Python. </li></ol><a name="habracut"></a><br><h3>  Connect Ethernet Shield over Arduino Uno </h3><br>  Arduino Ethernet Shield is an officially supported open source network extension designed to work with Arduino Uno.  Ethernet Shield is equipped with an RJ45 connector for connecting to an Ethernet network.  Ethernet Shield is designed for installation on the Arduino Uno, and it expands the pins of the Arduino Uno at the top of the board.  Ethernet Shield is also equipped with a slot for microSD memory cards for storing important files over the network.  Like most extensions, Ethernet Shield is powered by the Arduino board to which it is attached. <br><br> <a href=""><img src="https://habrastorage.org/webt/59/cb/9c/59cb9cfd5b7be169085985.jpeg"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Each Ethernet Shield has a unique hardware (MAC) address.  You can see it on the back of the board.  You can write down this hardware address, as it will often be required in upcoming exercises.  Also make sure that you are familiar with installing the Arduino Ethernet Shield for the following exercises. <br><br>  Below is a diagram of the fritzing scheme required for this exercise.  The first thing you need to do is connect an Ethernet Shield on top of your Arduino Uno. <br><br><h3>  Arduino uno </h3><br><br> <a href=""><img src="https://habrastorage.org/webt/59/cb/9d/59cb9d5413d73826818895.jpeg"></a> <br><br>  When deploying Arduino hardware for a remote connection without USB, you will need to provide external power to the board, since you no longer have a USB connection to power the board. <br><br>  Now connect the Arduino Uno to your computer using a USB cable.  You also need to connect the Arduino to your local home network using an Ethernet cable.  To do this, use a straight CAT5 or CAT6 cable and connect one end of the cable to your home router. <br><br>  This router must be the same device that provides network access to the computer you are using.  Connect the other end of the Ethernet cable to the Ethernet port of the Arduino Ethernet Shield.  If the physical layer connection is established correctly, you should see a green light on the port. <br><br> <a href=""><img src="https://habrastorage.org/webt/59/cb/9d/59cb9d99c9a5a238586490.jpeg"></a> <br><br>  Now it's time to start coding your first Ethernet example. In the code, you will need to change the MAC and IP addresses so that it works for your configuration.  Although you can get the Ethernet Shield MAC address from the back of the board, you will have to select an IP address according to the configuration of your home network. <br><br>  When you have already received the IP address of the computer you are working with, select another address in the range.  Make sure no other network host uses this IP address.  Use these MAC and IP addresses to update the following values ‚Äã‚Äãin the code. <br><br><pre><code class="python hljs">byte mac [] = {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xAA</span></span>, <span class="hljs-number"><span class="hljs-number">0xBB</span></span>, <span class="hljs-number"><span class="hljs-number">0xCC</span></span>, <span class="hljs-number"><span class="hljs-number">0xDE</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>}; IPAddress ip (<span class="hljs-number"><span class="hljs-number">192</span></span>, <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">102</span></span>); //        File --&gt; Examples --&gt; Ethernet --&gt; DhcpAddressPrinter</code> </pre> <br>  In an IP network, the visible range of IP addresses for your network is a function of another address, called a subnetwork or subnet.  Subnet your LAN IP network can help you choose the appropriate IP address for Ethernet Shield in the range of IP addresses of your computer.  You can learn about the basics of the subnet at [4]. <br><br>  Before delving into the code, compile the code with these changes and upload it to Arduino.  After successfully completing the download process, open a web browser and enter the IP address specified in the Arduino sketch.  If all goes well, you should see text showing the values ‚Äã‚Äãof the analog pins. <br><br>  To better understand what happened here, back to the code.  As you can see, at the beginning of the code, we initialize the Ethernet server library on port <b>80</b> using the <b>Ethernet</b> Server method from the Ethernet library: <br><br><pre> <code class="python hljs">EthernetServer server(<span class="hljs-number"><span class="hljs-number">80</span></span>);</code> </pre> <br>  At runtime <b>setup (), the</b> program initializes the Ethernet connection via Ethernet Shield using the <b>Ethernet.being ()</b> method with variable <b>mac</b> and <b>ip</b> , which you defined earlier.  The <b>server.begin ()</b> method <b>will</b> start the server from here.  Both of these steps are required to start the server if you use the Ethernet library for the server code: <br><br><pre> <code class="python hljs">Ethernet.begin (mac, ip); server.begin ();</code> </pre><br>  In the <b>loop ()</b> function, we initialize the <b>client</b> object to listen for incoming client requests using the <b>EthernetClient</b> method.  This object will respond to any request coming from connected clients that are trying to access the Ethernet server through port 80: <br><br><pre> <code class="python hljs">EthernetClient client = server.available ();</code> </pre> <br>  After receiving the request, the program will wait for the download of the request.  It will then respond to the client with formatted HTML data using the method: <br><br><pre> <code class="python hljs">client.<span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (): <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (client.connected()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (client.available()) { char c = client.read(); Serial.write(c); <span class="hljs-comment"><span class="hljs-comment"># Response code }</span></span></code> </pre><br>  If you try to access the Arduino server from a browser, you will see that the web server responds to clients with data on analog contacts.  Now, to get the correct values ‚Äã‚Äãfor the humidity and PIR sensors that we connected in hardware design, you will have to perform the following code modification. <br><br>  Here you will notice that we respond to customers with calculated relative humidity values ‚Äã‚Äãinstead of raw readings from all analog outputs.  We also changed the text to be printed in the web browser to match the correct sensor name: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c == <span class="hljs-string"><span class="hljs-string">'\n'</span></span> &amp;&amp; currentLineIsBlank) { // send a standard http response header client.println(<span class="hljs-string"><span class="hljs-string">"HTTP/1.1 200 OK"</span></span>); client.println(<span class="hljs-string"><span class="hljs-string">"Content-Type: text/html"</span></span>); client.println(<span class="hljs-string"><span class="hljs-string">"Connection: close"</span></span>); client.println(<span class="hljs-string"><span class="hljs-string">"Refresh: 5"</span></span>); client.println(); client.println(<span class="hljs-string"><span class="hljs-string">"&lt;!DOCTYPE HTML&gt;"</span></span>); client.println(<span class="hljs-string"><span class="hljs-string">"&lt;html&gt;"</span></span>); float sensorReading = getHumidity(analogChannel, temperature); client.print(<span class="hljs-string"><span class="hljs-string">"Relative Humidity from HIH4030 is "</span></span>); client.print(sensorReading); client.println(<span class="hljs-string"><span class="hljs-string">" % &lt;br /&gt;"</span></span>); client.println(<span class="hljs-string"><span class="hljs-string">"&lt;/html&gt;"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre><br>  In this process, we also added the Arduino function, getHumidity (), which will calculate the relative humidity from the values ‚Äã‚Äãobserved from the analog outputs. <br><br><pre> <code class="python hljs">float getHumidity(int analogChannel, float temperature){ float supplyVolt = <span class="hljs-number"><span class="hljs-number">5.0</span></span>; int HIH4030_Value = analogRead(analogChannel); float analogReading = HIH4030_Value/<span class="hljs-number"><span class="hljs-number">1023.0</span></span> * supplyVolt; float sensorReading = <span class="hljs-number"><span class="hljs-number">161.0</span></span> * analogReading / supplyVolt - <span class="hljs-number"><span class="hljs-number">25.8</span></span>; float humidityReading = sensorReading / (<span class="hljs-number"><span class="hljs-number">1.0546</span></span> - <span class="hljs-number"><span class="hljs-number">0.0026</span></span> * temperature); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> humidityReading; }</code> </pre><br>  You can apply these changes to the WebServer Arduino example for the testing phase, or simply open the <b>WebServer_Custom.ino</b> sketch from the <b>Exercise 1 - Web Server</b> folder in your code directory.  As you can see in the open sketch file, we have already modified the code to reflect the changes, but you still have to change the MAC and IP addresses to the corresponding addresses. <br><br>  After you finish these minor changes, compile and load the sketch into Arduino.  If everything goes according to plan, you should have access to the web server using a web browser.  Open the IP address of the newly prepared Arduino in a web browser. <br><br>  You should get the same answer as shown in the following screenshot.  Although we only show moisture values ‚Äã‚Äãthrough this sketch, you can easily attach motion sensor values ‚Äã‚Äãusing additional <b>client.print ()</b> methods. <br><br> <a href=""><img src="https://habrastorage.org/webt/59/cb/9f/59cb9f7c16b85675375570.jpeg"></a> <br><br>  Like the mechanism we implemented in this exercise, the web server responds to the request made by the web browser and provides the web pages you are looking for.  Although this method is very popular and universal for delivering web pages, the payload contains a lot of additional metadata <i>(data about the data)</i> compared to the actual size of the sensor information. <br><br>  In addition, server implementation using the Ethernet server library takes up a lot of Arduino resources.  Arduino, being a device with limited resources, is not suitable for running a server application, since Arduino resources must be prioritized for processing sensors, rather than communication. <br><br>  A web server created using the Ethernet library <b>supports a very limited number of connections</b> , which makes it unsuitable for large-scale applications and multi-user systems. <br><br>  The best approach to solving this problem is to use the Arduino as a client device or use light communication protocols designed to work with hardware devices with limited resources.  In the next few sections, you will learn and implement these approaches for Arduino communication on Ethernet. <br><br><h3>  Web application development using Python </h3><br>  Having implemented the previous program, you have enabled networking on the Arduino.  In the previous example, we created an HTTP web server using methods available from the Ethernet library.  Having created the Arduino web server, we made Arduino resources available on the web.  Similarly, Python also provides extensibility through various libraries to create web server interfaces. <br><br>  By running a Python-based web server on your computer or other devices, such as Raspberry Pi, you can avoid using the Arduino to host a web server.  Web applications created using high-level languages ‚Äã‚Äãsuch as Python can also provide additional features and extensibility compared to Arduino. <br><br>  We will use the Python library, web.py, to create a Python web server.  We will also use this library to create interactive web applications that allow you to transfer data between an Arduino client and a web browser. <br><br>  After you learn the basics of web.py, we will interact with Arduino from web.py using serial ports to make the Arduino accessible via the Python web server.  Then we will update the Arduino communication method from serial interface to HTTP-based messaging. <br><br><h3>  Python Web Framework - web.py </h3><br>  A web server can be developed in Python using various web frameworks such as <b>Django, bottle, Pylon,</b> and <b>web.py.</b>  We have chosen <b>web.py</b> as the preferred web structure due to its simple but powerful features. <br><br>  The <b>web.py</b> library was originally developed by the late Aaron Swartz to develop a simple approach for building web applications using Python.  This library provides two basic methods, <b>GET</b> and <b>POST</b> , to support the <b>HTTP Representation State Transfer (REST)</b> architecture. <br><br>  This architecture is designed to support the HTTP protocol by sending and receiving data between clients and the server.  Today, the REST architecture is implemented by a huge number of websites for transmitting data over HTTP. <br><br><h3>  Installing web.py </h3><br>  To get started with web.py, you need to install the web.py library using Setuptools.  On Linux and Mac OS X, run one of these commands on the terminal to install web.py: <br><br><pre> <code class="python hljs">$ sudo easy_install web.py $ sudo pip install web.py</code> </pre><br>  On Windows, open a command prompt and run the following command: <br><br><pre> <code class="python hljs">&gt; easy_install.exe web.py</code> </pre> <br>  For pythn 3.61, type in the command line: <br><br><pre> <code class="python hljs">&gt; easy_install<span class="hljs-number"><span class="hljs-number">-3.61</span></span>.exe web.py</code> </pre> <br>  If Setuptools is configured correctly, you can install the library without any difficulty.  To verify the library installation, open the Python online help and run this command to make sure that you imported the library without any errors: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> web</code> </pre> <br><h3>  The first Python web application </h3><br>  Implementing a web server using <b>web.py</b> is a very simple and straightforward process.  The <b>web.py</b> library requires the declaration of the required <b>GET</b> method to successfully launch the web server. <br><br>  When a client tries to access the server using a web browser or another client, <b>web.py</b> receives a <b>GET</b> request and returns the data specified in this method.  To create a simple web application using the <b>web.py</b> library <b>,</b> create a Python file using the following lines of code and execute the file using Python. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> web urls = ( <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-string"><span class="hljs-string">'index'</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">index</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GET</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Hello, world!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">"__main__"</span></span>: app = web.application(urls, globals()) app.run()</code> </pre><br>  When executed, you will see that the server is now running and accessible via the address <a href="http://0.0.0.0/">0.0.0.0</a> : 8080.  Since the server program is running on an IP address of 0.0.0.0, you can access it using the same computer, local host, or any other computer on the same network. <br><br>  To test the server, open a web browser and go to <a href="http://0.0.0.0/">0.0.0.0</a> : 8080.  When you try to access the server from the same computer, you can also use <a href="http://127.0.0.1/">127.0.0.1</a> : 8080 or <a href="http://localhost/">localhost</a> : 8080.  127.0.0.1 IP address actually means localhost, that is, the network address of the same computer on which the program is running.  You can see the response of the server displayed in the browser, as shown in the following screenshot: <br><br> <a href=""><img src="https://habrastorage.org/webt/59/cb/a0/59cba0e954370773576232.jpeg"></a> <br><br>  To understand how this simple code works, check out the <b>GET</b> method in the previous code snippet.  As you can see, when a web browser requests a URL, the <b>GET</b> method returns <b>Hello, world!</b>  into the browser. <br><br>  In the meantime, you can also observe two more required components of <b>web.py</b> in your code: the <b>urls</b> and <b>web.application ()</b> methods.  The <b>web.py</b> library requires initialization of the location of the response in the declaration of the urls variable. <br><br>  Each <b>web.py</b> based web application requires that the <b>application (urls, global ())</b> method be called to initialize the web server.  By default, <b>web.py</b> applications run on port <b>8080</b> , which can be changed to a different port number, specifying it at run time.  For example, if you want to start the <b>web.py</b> application on port <b>8888</b> , run the following command: <br><pre> <code class="python hljs">$ python webPyBasicExample.py <span class="hljs-number"><span class="hljs-number">8888</span></span></code> </pre> <br>  Although it only returns plain text, you have successfully created your first web application using Python.  We will move on from here and build more complex web applications in the following chapters using the <b>web.py</b> library. <br><br>  To develop these complex applications, we need not only the <b>GET</b> method.  Let's begin the study of preliminary concepts to further improve your familiarity with the <b>web.py</b> library. <br><br><h3>  Basic web.py concepts for developing complex web applications </h3><br>  The <b>web.py</b> library <b>has</b> been designed to provide convenient and simple methods for developing dynamic websites and web applications using Python.  Using <b>web.py</b> , it‚Äôs easy to create complex websites using just a few additional Python concepts. <br><br>  Thanks to this limited training course and easy-to-use methods, <b>web.py</b> is one of the fastest ways to create web applications from programming languages.  Let's start by understanding these concepts of <b>web.py</b> in detail. <br><br><h3>  URL handling </h3><br>  You may have noticed that in our first web.py program we defined the variable urls, which points to the root folder (/) of the Index class: <br><br><pre> <code class="python hljs">urls = ( <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-string"><span class="hljs-string">'index'</span></span> )</code> </pre><br>  In the previous declaration, the first part, '/', is the usual expression used to match actual URL requests.  You can use such expressions to process complex requests coming to your <b>web.py</b> server and point them to the corresponding class. <br><br>  In <b>web.py,</b> you can associate different places on your landing pages with the appropriate classes.  For example, if you want to redirect the data / data location to a data class in addition to the Index class, you can change the <b>urls</b> variable as follows: <br><br><pre> <code class="python hljs">urls = ( <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-string"><span class="hljs-string">'/data'</span></span>, <span class="hljs-string"><span class="hljs-string">'data'</span></span>, )</code> </pre><br>  Under this condition, when the client sends a request for access to the address http: // &lt;ip-address&gt;: 8080 / data, the request will be sent to the data class, and then to the GET or POST method of this class. <br><br><h3>  GET and POST methods </h3><br>  We created an Arduino-based web server that works on port 80, we used a web browser to access the web server.  Web browsers are one of the most popular types of web clients used to access a web server;  Other types are c URL, wget and web crawlers. <br><br>  The web browser uses HTTP to communicate with any web servers, including the Arduino web server we used.  GET and POST are the two main methods supported by the HTTP protocol for addressing server requests from a web browser. <br><br>  Whenever you try to open a website in your browser or any other HTTP client, you actually request the GET function from the web server;  For example, when opening a website URL [5], you are requesting that the web server hosting this website submit you a GET request for the location '/'. <br><br>  In the URL Handling section, we learned how to associate <b>web.py</b> classes with URL placements.  Using the GET method provided by the <b>web.py</b> library, you can associate a GET request with individual classes.  After you receive a GET request, you need to return the corresponding values ‚Äã‚Äãas a response to the client.  The following code snippet shows how the GET () function will be called when someone makes a GET request to the location ‚Äú/‚Äù: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GET</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> f = self.submit_form() f.validates() t = <span class="hljs-number"><span class="hljs-number">75</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> render.test(f,t);</code> </pre><br>  The <b>HTTP POST</b> function is mainly used to send a form or any other data to a web server.  In most cases, POST is embedded in the web page, and a request to the server is generated when the user sends a component that carries the POST function.  The web.py library also provides the POST () function, which is called when the web client tries to connect to the web.py server using the POST method.  In most implementations of the POST () function, the request includes some data passed through forms.  You can extract individual form elements using the f ['Celsius' ...] value, which will give you the value associated with the Celsius form element.  When the POST () function has performed the provided actions, you can return the relevant information to the client in response to the POST request: <br><br><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">POST</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> f = self.submit_form() f.validates() c = f[<span class="hljs-string"><span class="hljs-string">'Celsius'</span></span>].value t = c*(<span class="hljs-number"><span class="hljs-number">9.0</span></span>/<span class="hljs-number"><span class="hljs-number">5.0</span></span>) + <span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> render.test(f,t)</code> </pre><br><h3>  Templates </h3><br>  Now you know how to redirect an HTTP request to the appropriate URL, as well as how to implement methods to respond to these HTTP requests (that is, GET and POST).  But what about the webpage that should be displayed after receiving the request?  To understand the rendering process, let's start by creating a folder called templates in the same directory where our web.py program will be located.  Templates that will be used to render web pages on demand will be stored in this folder.  You must specify the location of this template folder in the program using the <b>template.render ()</b> function, as shown in the following line of code: <br><br><pre> <code class="python hljs">render = web.template.render (<span class="hljs-string"><span class="hljs-string">'templates'</span></span>)</code> </pre> <br>  After you create an instance of the render folder, it's time to create template files for your program.  According to the requirements of your program, you can create as many template files as you like.  To create these template files in web.py, a language called Templetor is used.  Read more about this at [5].  Each template file created using Templetor must be stored in HTML format with a .html extension. <br><br>  Let's create the <b>test.html</b> file in the <b>templates</b> folder using a text editor and paste the following code snippet into the file: <br><br><pre> <code class="python hljs">$<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(form, i)</span></span></span><span class="hljs-function"> &lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">form</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method</span></span></span><span class="hljs-function">="</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">POST</span></span></span><span class="hljs-function">"&gt; $:</span></span>form.render() &lt;/form&gt; &lt;p&gt;Value <span class="hljs-keyword"><span class="hljs-keyword">is</span></span>: $:i &lt;/p&gt;</code> </pre><br>  As you can see in the previous code snippet, the template file begins with <b>$ def with ()</b> , where you need to specify the input arguments as variables in brackets. <br><br>  After rendering the template, they will be the only variables that you can use for the web page;  For example, in the previous code snippet, we passed two variables ( <b>form</b> and <b>i</b> ) as input variables.  We used a form object using <b>$: form.render ()</b> to display it inside a webpage.  When you need to display a form object, you can directly pass another variable by simply declaring it (that is, $: i).  Templetor will display the HTML file of the template as it is, using variables when they are used. <br><br>  Now you have the test.html template file, ready for use in your web.py program.  Whenever the GET () or POST () function is executed, you need to return the value to the requesting client.  Although you can return any variable for these requests, including None, you will have to display a template file where the answer is related to loading the web page.  You can return the template file using the render () function, followed by the template file name and input arguments: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> render.test (f, i);</code> </pre> <br>  As you can see from the previous line of code, we return the rendered test.html page by specifying the function <b>render.test ()</b> , where <b>test ()</b> is just the name of the file without the .html extension.  The function also includes the form object, f, and the variable i, which will be passed as input arguments. <br><br><h3>  Forms </h3><br>  The web.py library provides simple ways to create form elements using the Form module.  This module includes the ability to create HTML form elements, receive input from users, and validate these inputs before using them in a Python program.  In the following code snippet, we create two form elements: <b>Textbox</b> and <b>Button</b> , using the <b>Form</b> library: <br><br><pre> <code class="python hljs">submit_form = form.Form( form.Textbox(<span class="hljs-string"><span class="hljs-string">'Celsius'</span></span>, description = <span class="hljs-string"><span class="hljs-string">'Celsius'</span></span>), form.Button(<span class="hljs-string"><span class="hljs-string">'submit'</span></span>, type=<span class="hljs-string"><span class="hljs-string">"submit"</span></span>, description=<span class="hljs-string"><span class="hljs-string">'submit'</span></span>))</code> </pre><br>  In addition to <b>Textbox</b> (which receives text input from users) and Button (which sends the form), the Form module also provides several other form elements, such as <b>Password</b> for receiving hidden text input, <b>Dropbox</b> for receiving a mutually exclusive drop-down list, <b>Radioto</b> receiving mutually exclusive inputs from several options and <b>Checkbox</b> selects a binary input from the specified options.  Although all these elements are very simple to implement, you should only select form elements according to your program requirements. <br><br>  In implementing a form via web.py, the webpage must perform a POST method every time the form is submitted.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> As you can see in the following form implementation in the template file, we explicitly declare the form submit method as POST: </font></font><br><br><pre> <code class="python hljs">$<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">with</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(form, i)</span></span></span><span class="hljs-function"> &lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">form</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method</span></span></span><span class="hljs-function">="</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">POST</span></span></span><span class="hljs-function">"&gt; $:</span></span>form.render() &lt;/form&gt;</code> </pre><br><h3>  Conclusion </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The publication contains all the necessary data to build in the home network application for remote control of temperature, humidity and movement. </font></font><br><br><h3>  Links </h3><br><ol><li> <a href="https://habrahabr.ru/post/337986/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prototyping in the Python-Arduino environment.</font></font></a> </li><li> <a href="https://habrahabr.ru/post/337982/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Methods for developing a flow of motion sensor software that works with Arduino.</font></font></a> </li><li> <a href="https://habrahabr.ru/post/337494/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using Python to process real-time information from sensors that work with Arduino.</font></font></a> </li><li> <a href="https://en.wikipedia.org/wiki/Subnetwork"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Subnetwork.</font></font></a> </li><li> <a href="http://webpy.org/templetor"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web.py templating system.</font></font></a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/338844/">https://habr.com/ru/post/338844/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338828/index.html">Sending a request to all databases of all specified servers using the example of MS SQL Server and C # .NET</a></li>
<li><a href="../338830/index.html">Data geometry 6. Star graph</a></li>
<li><a href="../338832/index.html">Numbers - Douglas Crockford‚Äôs paper on number systems in life and in programming</a></li>
<li><a href="../338836/index.html">Design patterns in test automation</a></li>
<li><a href="../338840/index.html">How faster DOM build: parsing, async, defer and preload</a></li>
<li><a href="../338846/index.html">How to get frustrated and NOT go Linux</a></li>
<li><a href="../338848/index.html">PowerShell for IT security. Part IV: Script Security Platform</a></li>
<li><a href="../338850/index.html">Strange character and hot announcements of the first days of Microsoft Ignite</a></li>
<li><a href="../338852/index.html">Why do business games and what have the ERA</a></li>
<li><a href="../338854/index.html">How we did design for bitcoin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>