<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating your own View for Android - can something go wrong?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúIt was evening, there was nothing to do‚Äù - that was how the idea was born to make a twist with the possibility of zoom, distributing users by rank de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating your own View for Android - can something go wrong?</h1><div class="post__text post__text-html js-mediator-article"><img align="left" height="380" src="https://habrastorage.org/files/241/391/6c8/2413916c8172453082805f24ba91b8e3.png">  ‚ÄúIt was evening, there was nothing to do‚Äù - that was how the idea was born to make a twist with the possibility of zoom, distributing users by rank depending on the number of their points.  Since before that I had no experience in creating my own views of this level, the task seemed to me interesting and quite simple for a beginner ... but, oh, oh, how wrong I was. <br><br>  In the article I will talk about the challenges I faced from both the Android SDK and the task (the clustering algorithm).  The main objective of the article is not to teach how to make so-called ‚Äúcustom view‚Äù, but to show the problems that may arise when they are created. <br><br>  The topic will be interesting to those of you who have little or no experience in creating something like this, as well as those who want to <s>catch the Lulz from the author</s> a hundred and first times to believe in the "flexibility" of the Android SDK. <br><a name="habracut"></a><br><h2>  <b>1. How does it work?</b> </h2><br><div class="spoiler">  <b class="spoiler_title">Demonstration of the view (gif)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/cef/faf/2a4/ceffaf2a46e04da6a6cab5cd21548114.gif"><br></div></div><br>  To begin with, I will briefly describe how the made view is arranged: <br>  <i>Hierarchy (own views are green)</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img width="300" src="https://habrastorage.org/files/d5f/7ba/fd9/d5f7bafd91114ae7abc215b23564f622.png"><br><br> <i><code>RankingsListView</code></i> <br> <img width="200" src="https://habrastorage.org/files/b0f/6a9/4af/b0f6a94af08347659cfdcd66c99b2ef8.png"><br>  At the head of the table is the <code>RankingsListView</code> (heir of the <code>ScrollView</code> ).  He manages a scroll (unexpectedly, yes?) And zoom, and also creates a list from the <code>RankingView</code> . <br><br> <i><code>RankingView</code></i> <br> <img width="200" src="https://habrastorage.org/files/49b/fa5/7e5/49bfa57e54074f99baca82b34f0dacd6.png"><br>  <code>RankingView</code> displays rank (left) and <code>UsersView</code> (right). <br><br> <i><code>UsersView</code></i> <br> <img width="200" src="https://habrastorage.org/files/232/784/fc3/232784fc34ef4bcc9437ef281e6895df.png"><br>  <code>UsersView</code> , as you might have guessed, is engaged in displaying users and showing animations of combining and disconnecting users into groups. <br><br> <i><code>GroupView</code></i> <br> <img width="200" src="https://habrastorage.org/files/0b4/968/6a0/0b49686a0c6c4996b2eb4f24c7bf945b.png"><br><br>  Both the user and the group of users are displayed in one view, called <code>GroupView</code> .  Only in the case when one user is displayed, and not a group, there will be no green circle (within which the number of users in the group is displayed).  Well, on the right there is an indicator of user / group points with a ‚Äú%‚Äù sign. <br><br>  Perhaps all with the boring part, go to the problems. <br><br>  <b>ps</b> Link to the source in the "Conclusion". <br><br><h2>  <b>2. Android SDK "wants to play a game with you" ¬© Goog ... Saw</b> </h2><br>  Let's start with a harmless one. <br><br><h3>  <b>2.1.</b>  <b>Inflate the layout inside the custom <code>View</code> using <code>DataBinding</code></b> </h3><br>  <code>DataBinding</code> with its code generation works wonders: <br><br><pre> <code class="java hljs">WidgetGroupViewBinding binding; ‚Ä¶ binding = DataBindingUtil.setContentView(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, R.layout.activity_main); <span class="hljs-comment"><span class="hljs-comment">// binding.title   </span></span></code> </pre> <br>  A couple of lines and through the variable <code>binding</code> are available on <code>id</code> all the twists indicated in the markup, no matter how complex this markup is.  No more: <br><br><pre> <code class="java hljs">@ BindView (R.id.tb_progress) View loadingView; <span class="hljs-meta"><span class="hljs-meta">@BindView</span></span> (R.id.tb_user) View userView; <span class="hljs-meta"><span class="hljs-meta">@BindView</span></span> (R.id.iv_avatar) ImageView avatarView; <span class="hljs-meta"><span class="hljs-meta">@BindView</span></span> (R.id.tv_name) TextView nameView; <span class="hljs-meta"><span class="hljs-meta">@BindView</span></span> (R.id.l_error) View errorView; <span class="hljs-meta"><span class="hljs-meta">@BindView</span></span> (R.id.l_container) ViewGroup containerLayout;</code> </pre> <br>  ... and a dozen more lines like <code><a href="http://jakewharton.github.io/butterknife/">ButterKnife</a></code> .  But wait!  <code>setContentView()</code> is the <code>Activity</code> method.  And what about views <br><br>  In order to add markup inside the current view, you need to call the <code>inflate(getContext(), R.layout.my_view_layout, this)</code> method, for example, inside the constructor.  The last flag is interesting.  It <u>adds a</u> view created by markup inside the current view.  This means that if you have a root tag in your markup, for example, <code>LinearLayout</code> , and you try to use <code>inflate(‚Ä¶)</code> inside your view inherited from <code>LinearLayout</code> , then you will get two LinearLayout in the hierarchy ... <br><br>  ... And this is quite logical, though not pleasant, because one of <code>LinearLayout</code> 's is redundant.  What to do?  To get around this is quite simple.  You need to use the <code>&lt;merge&gt;</code> inside the markup, wrapping everything in it that should be inside your view, <a href="http://trickyandroid.com/protip-inflating-layout-for-your-custom-view/">as described here</a> . <br><br>  But!  <code>DataBinding</code> does not support <code>&lt;merge&gt;</code> .  Its root tag must be a <code>&lt;layout&gt;</code> , inside of which there must be a single child element ‚Äî not- <code>&lt;merge&gt;</code> (in fact, there may be another <code>&lt;data&gt;</code> , but this is a completely different story). <br><br>  As a result, at the moment there is no way to use <code>DataBinding</code> in your own views without generating additional Layouts, which will not have the best effect on performance.  ButterKnife is still our everything. <br><br>  <u><i>UPD</i></u> : <a href="https://code.google.com/p/android/issues/detail%3Fid%3D236312%26thanks%3D236312%26ts%3D1488640686">feature-request at code.google.com</a> . <br><br><h3>  <b>2.2.</b>  <b>Measure &amp; Layout passes</b> </h3><br>  Despite the fact that I had no experience in creating views, I still read occasional articles on this subject, and also saw a section of documentation on the topic <a href="https://developer.android.com/guide/topics/ui/how-android-draws.html">‚Äúhow views are drawn</a> . <a href="https://developer.android.com/guide/topics/ui/how-android-draws.html">‚Äù</a>  If you believe the latter, then everything is easier than ever: <br><br><ul><li>  called <code>onMeasure()</code> couple of times to determine the size; </li><li>  <code>onLayout()</code> is called to position the element inside the container; </li><li>  <code>onDraw()</code> is called to draw. </li></ul><br>  Well, oh-oh-oh, very simple.  It is for this reason that I thought that it would not be difficult to implement my own view.  But this was not the case (spoiler: the author will cut off big problems from the onLayout method hereafter).  Here is a list of tips and rules that I derived after creating a view: <br><br><ul><li>  <code>onMeasure()</code> is for sizing only.  It makes absolutely no sense to put anything else in it.  The reason is not only that the method is called several times, but also that it is impossible to say with certainty whether it will be called again before <code>onLayout()</code> or whether the current calculated size is final; <br><br></li><li>  <code>onSizeChanged()</code> , which for some incredible reason is often not mentioned in the articles on custom views, is called before <code>onLayout()</code> , but inside the <code>layout()</code> method called by the parent.  The bottom line is that <code>layout()</code> calls <code>setFrame()</code> , which calls <code>onSizeChanged()</code> , and only then (after exiting <code>setFrame()</code> ) <code>onLayout()</code> called.  This means that inside the <code>onSizeChanged()</code> method you still cannot rely on the fact that all the child views within your view are arranged as needed.  Moreover, they have not yet called their <code>onSizeChanged()</code> , not to mention <code>onLayout()</code> ; <br><br></li><li>  Inside <code>onLayout()</code> you can call <code>measureChildren()</code> yourself.  In other words, if I wish to twist it, he may drive the measurement pass a few more times; <br><br></li><li>  The last method in <code>onLayout()</code> better to leave <code>super.onLayout()</code> .  Otherwise, you can create a situation in which the child view will be called <code>onSizeChanged()</code> twice with <code>onLayout()</code> .  And if you are unlucky, you can get stuck in such a way that every 16ms (60 fps after all) <code>requestLayout()</code> will be called (spoiler: the author shot himself in the leg, but more on that later). </li></ul><br>  In no article that I read on the topic of views, I have not seen such descriptions of these methods.  Either no one is confronted with such a thing, or this is the first rule of the custom view club ‚Äî not to talk about <code>onLayout()</code> <s>(excluded; spent)</s> . <br><br>  In my case, inside the <code>UsersView.onLayout()</code> , the Y-coordinates of the views change, which causes some views to become visible, while others hide, and this leads to ... (attention to the bottom right): <br><br><div style="text-align:center;"><img width="250" src="https://habrastorage.org/files/2f4/30c/41c/2f430c41cb6f44c49118fa04c8b4bbea.jpg"></div><br>  ... cutting the lower view.  This happened only at a distance.  I had to tinker, but I managed to figure out what, it seems, the daughter view determined that with its current position Y it will appear only half in the parent, and therefore it is possible to trim your <code>Bitmap drawingCache;</code>  .  Then that additional measurement pass in the form of <code>measureChildren()</code> inside <code>onLayout()</code> came to the rescue, forcing the view to reconsider its caches after changing its Y-coordinate. <br><br><h3>  <b>2.3.</b>  <b><code>ScrollView</code> does not allow <code>ScrollView</code> child</b> </h3><br>  Perhaps many of you were faced with the need to set the height of the child to <code>ScrollView</code> element <code>layout_height=match_parent</code> , and then instantly failed, because the result was just the same as with <code>wrap_content</code> , and then found <a href="http://www.curious-creature.com/2010/08/15/scrollviews-handy-trick/">an article like this</a> with the description of the <code>fillViewport</code> flag, guessed?  And now the question: how to achieve the same result as with the <code>fillViewport</code> flag, but at the same time dynamically change the height of the child element? <br><br>  Let's take it in order.  How can I change the height of an element?  Through <code>LayoutParams.height</code> course, no more.  Problem solved?  Not.  Height remained unchanged.  What happened?  After examining <code>onMeasure()</code> in a child view, I came to the conclusion that <code>ScrollView</code> simply ignored the set <code>height</code> in the parameters, sending it <code>onMeasure()</code> with <code>mode</code> equal to ‚Äú <code>UNSPECIFIED</code> ‚Äù and then <code>onMeasure()</code> with ‚Äú <code>EXACTLY</code> ‚Äù and the value of <code>height</code> ', equal to the size of the <code>ScrollView</code> (if <code>fillViewport</code> set).  And since the only way to change the <code>height</code> view is to change its <code>LayoutParams</code> , the child doesn't change. <br><br>  I found two solutions: <br><br><ol><li>  Kohl <code>ScrollView</code> so <s>arrogant</s> and clever and ignores <code>LayoutParams</code> , you can simply rewrite the <code>onMeasure()</code> method in the child and add this to the local <code>super.onMeasure()</code> : <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (MeasureSpec.getMode(heightMeasureSpec) == MeasureSpec.UNSPECIFIED &amp;&amp; getLayoutParams().height &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { heightMeasureSpec = MeasureSpec.makeMeasureSpec( getLayoutParams().height, MeasureSpec.EXACTLY); }</code> </pre> <br>  Thereby making <code>ScrollView</code> work for it.  But it's natural to create a subclass every time just for this - not a good idea.  <code>FrameLayout</code> what class should be a child <code>FrameLayout</code> : <code>FrameLayout</code> , <code>LinearLayout</code> , <code>RelativeLayout</code> , etc.  To do for every possible <code>Layout</code> 'and its subclass - just litter.  Therefore, here is your solution number 2. <br><br></li><li>  Wrap the child in <code>FrameLayout</code> and resize this <code>FrameLayout</code> 's child. </li></ol><br>  It was approach number 2 that I used, and it worked out with a bang.  However, I'm not sure that this is really a valid way (hack).  Perhaps this hack does not work because the extra <code>FrameLayout</code> <s>has due respect</s> takes into account <code>LayoutParams.height</code> , but because inside <code>ScrollView.onLayout()</code> <s>all</s> <code>ScrollView.onLayout()</code> <s>game</s> occur, because of which the child‚Äôs size is calculated only partially.  This is just a hunch, but I cannot explain the problem with the scrolling (spoiler: the problem will be described later). <br><br>  Oh yeah, <code>ScrollView</code> <a href="https://code.google.com/p/android/issues/detail%3Fid%3D78705">has a</a> problem with the <a href="https://code.google.com/p/android/issues/detail%3Fid%3D78705">bug tracker</a> , the problem with the unchangeable size of the child, but as is usually the case with Android, it is still in New status from 2014. <br><br><h3>  <b>2.4.</b>  <b><code>background</code> rounded corners</b> </h3><br>  Subject (bottom left and top left): <br><br><div style="text-align:center;"><img width="150" src="https://habrastorage.org/files/b11/3ba/024/b113ba0243f44f93b0375cc4ad58e85d.png"></div><br>  It would seem that it could be simpler to make a <code>drawable</code> with the <code>&lt;shape&gt;</code> , set the <code>background</code> 'and it's ready ... but no.  The task is such that the color changes programmatically, and the rounded edges are added only to the first and last elements. <br><br>  Oddly enough, the <code>ShapeDrawable</code> class <code>ShapeDrawable</code> not have methods for working with rounded corners, as one would expect.  But fortunately, there is a successor to <code>RoundRectShape</code> and <code>PaintDrawable</code> <s>(why this class is needed - do not ask yourself in shock)</s> , which have missing methods.  At this problem for almost all applications could be considered solved, but not for this task. <br><br>  The specificity of the task is such that the maximum <code>zoom in</code> can be of any kind, which means that the view with its <code>background</code> ‚Äôwill stretch greatly, which leads to ... <br> <code>Logcat: W/OpenGLRenderer: Path too large to be rendered into a texture</code> <br>  It looks like this, after exceeding a certain size, the <code>background</code> just ceases to be displayed.  As you can see from the warning, a certain <code>Path</code> too large to be able to draw it into a texture.  Having rummaged a bit in the source code, I came to the conclusion that this comrade was to blame: <br><br><pre> <code class="java hljs">canvas.drawPath(mPath, paint);</code> </pre> <br>  ... in which <code>mPath</code> place a rounded rectangle: <br><br><pre> <code class="java hljs">mPath.addRoundRect(mInnerRect, mInnerRadii, Path.Direction.CCW);</code> </pre> <br>  This problem can be solved only by inheriting, for example, <code>ColorDrawable</code> and in its <code>draw()</code> method by calling not <code>drawPath()</code> , but: <br><br><pre> <code class="java hljs">canvas.clipPath(roundedPath);</code> </pre> <br>  But, unfortunately, this approach has a relatively significant drawback: <a href="http://stackoverflow.com/a/2746167/2653714"><code>canvas.clipPath()</code> not affected by antialias</a> .  However, in the absence of another way to do this, you have to be content with this. <br><br><h3>  <b>2.5.</b>  <b>Positioning <code>View</code> inside <code>FrameLayout</code></b> </h3><br>  This task arose before me when I tried to implement <code>UsersView</code> , within which GroupView could be anywhere along the OY axis. <br><br>  The first thing that came to mind (and what I thought was the only possible way to move a view inside <code>FrameLayout</code> ) was to use <code>MarginLayoutParams</code> and change the <code>topMargin</code> parameter.  This is also indicated by the majority of responses to stackoverflow ( <a href="http://stackoverflow.com/a/3295056/2653714">one</a> , <a href="http://stackoverflow.com/a/3442189/2653714">two</a> , <a href="http://stackoverflow.com/a/27824866/2653714">three</a> ). <br><br>  The disadvantage of this approach is that changing the <code>LayoutParams</code> causes a <code>requestLayout()</code> , and this is an extremely expensive operation, especially if it is called for all <code>GroupView</code> inside <code>UsersView</code> , even taking into account that the layout pass itself is postponed until better times (next 16ms-frame) . <br><br>  But fortunately, there is another way - <code>View.setY()</code> (the <a href="http://stackoverflow.com/questions/6535648/how-can-i-dynamically-set-the-position-of-view-in-android/41678910">answer to stackoverflow</a> ).  Ideal for animations and for children inside unchanging <code>Layout</code> .  It does not call <code>requestLayout()</code> , but uses only the fields of the view itself and affects only the phase (pass) of the layout.  And since the miscalculation of new positions of the views occurs directly in <code>onLayout()</code> before calling <code>super.onLayout()</code> , the <code>requestLayout()</code> is not needed at all. <br><br><h3>  <b>2.6.</b>  <b>See the font indents?</b>  <b>Not?</b>  <b>And they see you!</b>  <b>¬© <code>includeFontPadding</code></b> </h3><br>  When users are combined into a group, an icon is added that displays the number of users in the group.  Here's what she looks like now: <br><br><img width="45" src="https://habrastorage.org/files/894/867/2ad/8948672ad6294350b3fa5725368a7f76.png"><br><br>  But how she looked before: <br><br><img width="45" src="https://habrastorage.org/files/b59/531/753/b59531753d9e4c919c65d534ff151372.png"><br><br>  Do you notice the difference?  Have an unpleasant feeling when you look at the second picture?  If yes, then you understand me.  For a long time I could not figure out why, when I look at this icon, it does not look as attractive as expected.  Having guessed to take the paint in hand and calculate how many pixels are left / right / top / bottom of the text, I understood the reason - the text is not centered to the end.  Something is clearly not so gravitational text.  Well no.  Gravity was set correctly, other parameters too.  Everything looked perfect. <br><br>  In general, I will not torment, the decision turned out to be very simple, but I could not find it right away simply because I did not understand that at all.  By the way, here is a <a href="http://stackoverflow.com/a/6594320/2653714">link to the solution</a> .  The bottom line is that, as it turns out, the fonts themselves have paddings, which were the cause of non-centering.  By adding the <code>TextView</code> parameter <code>includeFontPadding=false</code> , the problem disappeared completely. <br><br><h3>  <b>2.7.</b>  <b><code>ViewPropertyAnimator</code> does not have a <code>reverse()</code> method</b> </h3><br>  I wanted to make an animation of hiding rank icons at a certain size.  It should look like this: <br><br><div style="text-align:center;"><img width="200" src="https://habrastorage.org/files/0df/5c2/3e9/0df5c23e980f44a69bf5bbd16f0db5a6.gif"></div><br>  To determine when the animation starts, we compare the current size with the required size for all views and, if necessary, use <code>view.animate().setDuration(fadeDuration).alpha(0 or 1)</code> . <br><br>  However, this works well only with fast <code>fade</code> animations.  However, if the <code>fade</code> is slow, then with a sharp <code>zoom in</code> after <code>zoom out</code> , the alpha channel of the view will not be 1 or 0, but, for example, 0.5.  Because of this, the animation will play from 0.5 to 0 for the same <code>fadeDuration</code> .  It will look like the animation slowed down 2 times.  Adding something like <code>view.setAlpha(0 or 1)</code> before calling <code>view.animate()</code> is not a good solution.  The view will begin to flicker during fast zoom. <br><br>  Ideally, there would have to be some method of the form <code>setReverseDuration()</code> (without parameters) that would understand that, ‚Äúyeah, I played the <code>fade</code> animation for 500ms, therefore reverse animation will play the same amount‚Äù.  But this is not, alas.  The only way out that I managed to find is to make such handles.  In my case, the animation was pretty simple, so it was enough for me to hide it: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> realDuration = iconView.getAlpha() * animationDuration;</code> </pre>  ... and this to show: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> realDuration = (<span class="hljs-number"><span class="hljs-number">1</span></span> - iconView.getAlpha()) * animationDuration;</code> </pre> <br>  Well, then as usual: <code>view.animate().setDuration((long) realDuration)</code> - and everything is in openwork. <br><br>  <u><i>UPD</i></u> : <a href="https://code.google.com/p/android/issues/detail%3Fid%3D236313%26thanks%3D236313%26ts%3D1488641553">feature-request at code.google.com</a> . <br><br><h3>  <b>2.8.</b>  <b><code>ScaleGestureDetector</code> (aka "pinch", aka "zoom")</b> </h3><br>  The <code>ScaleGestureDetector</code> API <code>ScaleGestureDetector</code> pretty good - hung up the <code>listener</code> and wait for yourself events, not forgetting to transfer all <code>onTouchEvent()</code> 's into the detector itself.  However, not everything is so rosy. <br><br><h4>  <b>2.8.1.</b>  <b>Small notes</b> </h4><br>  <b><u>First,</u></b> nowhere is it said how to differentiate inside <code>onTouchEvent()</code> events between the <code>ScaleGestureDetector</code> and <code>ScrollView</code> (after all, I remind you, it happens inside the <code>RankingsListView</code> , which is the heir of the <code>ScrollView</code> ).  As a result, the method looks like this: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTouchEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MotionEvent ev)</span></span></span><span class="hljs-function"> </span></span>{ scaleDetector.onTouchEvent(ev); <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onTouchEvent(ev); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br>  And so it is advised to do all stackoverflow-answers ( <a href="http://stackoverflow.com/a/14109407/2653714">example</a> ).  However, this approach has a disadvantage.  The scroll happens even when you produce a pinch.  It may seem like a trifle, but in fact it is very unpleasant to accidentally flip through the view when trying to figure it out. <br><br>  I was ready to scour for a long and tedious search for a difficult solution to the division of responsibility between <code>super.onTouchEvent()</code> and <code>scaleDetector.onTouchEvent()</code> ... and I was really looking for ... But as it turned out, the solution was terribly simple: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTouchEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MotionEvent ev)</span></span></span><span class="hljs-function"> </span></span>{ scaleDetector.onTouchEvent(ev); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ev.getPointerCount() == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onTouchEvent(ev); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br>  Brilliant, yes?  <code>super.onTouchEvent()</code> does not track the <code>id</code> finger that was used to scroll for the first time, so even if you started scrolling with finger # 1, and finished with finger # 2 - it is ok with him.  Unfortunately, I was so sure that the Android SDK would once again put a stick in the wheels, that I bothered to try this only after: googling and studying the sources.  What can I say, the Android SDK can <s>sometimes work as it should</s> surprise. <br><br>  <u><b>Secondly</b></u> , if you suffer from a micro-optimization disease, then you will have to monitor the size of your child views with extreme caution.  As you already know, with pinch, I increase the height for the child inside the child of <code>ScrollView</code> .  This child is a <code>LinearLayout</code> whose children are <code>layout_weight=1</code> .  In other words, they are all the same height ... although no. <br><br>  It is absolutely never noticeable, but its subsidiary views can not always be the same height, because the pixels are atomic units.  That is, if <code>LinearLayout</code> has a height of 1001 and it has 2 children, then one of them will be 501 and the other 500. Notice this by sight is almost impossible, but there may be indirect consequences. <br><br>  When I talked about <code>ViewPropertyAnimator</code> and <code>reverse()</code> , I showed an animation of hiding the rank icon.  The check itself is simple - we <code>onLayout()</code> up the height of 2 <code>TextView</code> and <code>ImageView</code> in <code>onLayout()</code> , and if they don‚Äôt get inside the current view at once, then hide the <code>fade</code> <code>ImageView</code> .  It is also worth noting that this total height (‚Äúheight threshold‚Äù, so to speak) does not change.  As a result, if the threshold is 500 pixels, then in the described case, for one I twist the size of 500, the icon will hide, while the second, the size of 501, will not. <br><br>  The situation is rare and not too critical (it was not so simple (but not difficult) to move the mouse so slowly to detect hidden and hidden icons at the same time).  But still, if you don‚Äôt like this behavior, you can fix it only in one way - do not use <code>getHeight()</code> to <code>getHeight()</code> with a threshold.  In <code>onSizeChanged()</code> inside <code>LinearLayout</code> find the smallest size of all child elements and notify everyone that they compare the threshold with this number.  I called it <code>shared height</code> and it looks like this for me: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateChildsSharedHeight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> minChildHeight = Integer.MAX_VALUE; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; binding.lRankings.getChildCount(); ++i) { minChildHeight = Math.min(minChildHeight, binding.lRankings.getChildAt(i).getMeasuredHeight()); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; binding.lRankings.getChildCount(); ++i) { RankingView child = (RankingView) binding.lRankings.getChildAt(i); child.setSharedHeight(minChildHeight); } }</code> </pre> <br>  And the reconciliation with the threshold value is: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> requiredHeight = binding.tvScore.getHeight() + binding.tvTitle.getHeight() + binding.ivIcon.getHeight(); <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> shouldHideIcon = requiredHeight &gt; sharedHeight;</code> </pre><br><br>  <u><i>UPD</i></u> : <a href="https://code.google.com/p/android/issues/detail%3Fid%3D236315%26thanks%3D236315%26ts%3D1488642088">feature-request at code.google.com</a> . <br><br><h4>  <b>2.8.2.</b>  <b>Problems</b> </h4><br>  And now let's talk not about <code>ScaleGestureDetector</code> at the <code>ScaleGestureDetector</code> , but about its problems. <br><br><h4>  <b>2.8.2.1.</b>  <b>Minimum pinch</b> </h4><br><div style="text-align:center;"><img width="320" src="https://habrastorage.org/files/878/4e2/f99/8784e2f99999444b8c1b76de6a48f820.gif"></div><br>  And-and-and-and-and-and ... he (minimum pinch) is not disabled.  During coding, I didn‚Äôt know about any ‚Äúminimum distance for pinch triggering‚Äù, so I had to study the logs a bit in order to understand whether it was a cant in my code or something else.  The logs said that if the distance between the fingers was less than 510 pixels, then the <code>ScaleGestureDetector</code> simply stopped responding to the touch, sending the event <code>onScaleEnd()</code> .  Information that there is some kind of "minimal pinch" was not present either on the docks or on stackoverflow.  Perhaps, I would not even notice this, if the debugging was not done on the emulator.  On it, the pinch distance can be even millimeter, which was the reason for searching for information on the subject.  However, it turned out to be much closer than I thought, namely, as always, in the source code: <br><br><pre> <code class="java hljs">mMinSpan = res.getDimensionPixelSize(com.android.internal.R.dimen.config_minScalingSpan);</code> </pre> <br>  And-and-and-and-and ... of course, the class has no methods for changing this field, and of course <code>com.android.internal.R.dimen.config_minScalingSpan</code> is magical 27mm.  For me in general, the existence of a minimal pinch seems to be a very strange phenomenon.  Even if there is a sense in this, why not give the opportunity to change it? <br>  The solution to the problem is usually reflection. <br><br><h4>  <b>2.8.2.2.</b>  <b>Slop</b> </h4><br>  For those who do not know what a "slop" is (like me), I translate: <br>  Slop - nonsense, nonsense ¬© ABBYY Lingvo <br><br>  Okay, okay, jokes aside.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Slop" is such a state when it is considered that the user accidentally touched the screen and in fact did not want to move / scroll / zoom / anything else. </font><font style="vertical-align: inherit;">Such "protection against accidental movement." </font><font style="vertical-align: inherit;">Gif will explain:</font></font><br><br><div style="text-align:center;"><img width="320" src="https://habrastorage.org/files/88c/d44/bb1/88cd44bb1882492ea64c467dae7d06f7.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... on the gif it can be seen that minimal movements are allowed before the pinch starts, which will not be considered a pinch. </font><font style="vertical-align: inherit;">In principle, a good thing, plus. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But ... the slop is also not changeable! </font></font><code>ScaleGestureDetector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">describes it like this:</font></font><br><br><pre> <code class="java hljs">mSpanSlop = ViewConfiguration.get(context).getScaledTouchSlop() * <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and </font></font><code>ViewConfigeuration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">so:</font></font><br><br><pre> <code class="java hljs">mTouchSlop = res.getDimensionPixelSize( com.android.internal.R.dimen.config_viewConfigurationTouchSlop);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Where exactly is the meaning? </font></font> What for?  Why?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is not clear ... In general, the Android SDK is the best tutorial on reflection. </font></font><br><br> <u><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></i></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://code.google.com/p/android/issues/detail%3Fid%3D236316%26thanks%3D236316%26ts%3D1488642486"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">feature-request for Slop / Span at code.google.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h4> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.8.2.3. </font><font style="vertical-align: inherit;">Jumps </font></font><code>detector.getScaleFactor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">at the first pinch</font></font></b> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inside the event </font></font><code>onScale(ScaleGestureDetector detector)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is transmitted </font></font><code>detector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, from which using the method </font></font><code>detector.getScaleFactor()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you can find out the pinch coefficient. </font><font style="vertical-align: inherit;">So, at the very first pinch, this method returns strange jump-like values. </font><font style="vertical-align: inherit;">Here are the logs of values ‚Äã‚Äãwhen strictly moving </font></font><code>zoom out</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: It </font><font style="vertical-align: inherit;">looked, to put it mildly, not very much - the size of the view was constantly twitching, and the animations at these jumps looked like - it was better to omit it altogether. </font><font style="vertical-align: inherit;">For a long time I tried to understand what the problem was. </font><font style="vertical-align: inherit;">Checked on a real device (you never know, all of a sudden the emulator problem), moved the mouse as if a cat died somewhere over an extra millimeter of movement (you never know, all of a sudden I‚Äôm twitching and from here </font><font style="vertical-align: inherit;">in the logs) - but no. </font><font style="vertical-align: inherit;">The answer was not found, but I was lucky. </font><font style="vertical-align: inherit;">So to say "from the bald," I decided to try to send in the </font><font style="vertical-align: inherit;">event</font></font><br><br> <code>0.958 <br> 0.987 <br> 0.970 <br> <u>1.009</u> <br> 0.966 <br> 0.967 <br> <u>1.006</u></code> <br> <br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>. &gt; 1</code><font style="vertical-align: inherit;"></font><code>ScaleGestureDetector</code><font style="vertical-align: inherit;"></font><code>MotionEvent.ACTION_CANCEL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> immediately after initialization: </font></font><br><br><pre> <code class="java hljs">scaleDetector = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ScaleGestureDetector(getContext(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ScaleListener()); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> time = SystemClock.uptimeMillis(); MotionEvent motionEvent = MotionEvent.obtain(time - <span class="hljs-number"><span class="hljs-number">100</span></span>, time, MotionEvent.ACTION_CANCEL, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); scaleDetector.onTouchEvent(motionEvent); motionEvent.recycle();</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and it helped O_o ... After rummaging (which time, and Android SDK?) In the source, it turned out that the first pinch has no slop (yes, this is the one mentioned above). </font><font style="vertical-align: inherit;">Why is this so - it remains a mystery to me, exactly like why this hack helped. </font><font style="vertical-align: inherit;">Most likely, somewhere, they namudrili with initialization and part of the class believes that the very first pinch has already passed the test for the slop, and the other part believes that it does not, and as a result, in the heat of the hot battle of the form ‚Äúpassed / failed‚Äù of them. </font><font style="vertical-align: inherit;">¬Ø \ _ („ÉÑ) _ / ¬Ø ¬© SDK </font></font><br><br> <u><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD</font></font></i></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><a href="https://code.google.com/p/android/issues/detail%3Fid%3D236820%26thanks%3D236320%26ts%3D1488644605"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bug-report on code.google.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3>  <b>2.9.</b> <b><code>ScrollView.setScroll()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">triggered only after </font></font><code>super.onLayout()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">?</font></font></b> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We return to the problem of ignoring the </font></font><code>ScrollView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">established children </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'s. </font><font style="vertical-align: inherit;">The situation is the following: as soon as the pinch occurs, I would like the current focus (where you clicked the mouse and from which point you do zoom at all) remained the same.</font></font> Why?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Well, just because the zoom looks more user-friendly, consider that you do not just change the height of the child element, but just zoom to some user, while everyone else is moving away from it: </font></font><br><br><div style="text-align:center;"><img width="270" src="https://habrastorage.org/files/9ee/ee1/86a/9eeee186aaf34828baa290a15c45c4f4.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is not difficult to make it through </font></font><code>ScaleGestureDetector.getFocusY()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with </font></font><code>ScrollView.getScrollY()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Then, it would seem, it is enough to do the </font></font><code>ScrollView.setScrollY(newPosition)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">thing in the hat ... But no, the view begins to twitch strangely at the zoom to the lowest child:</font></font><br><br><div style="text-align:center;"><img width="200" src="https://habrastorage.org/files/524/0fb/494/5240fb494dff40e5a25fa675b2296ba9.gif"></div><br> <a href="http://stackoverflow.com/a/10209457/2653714"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The solution was found here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The following happens: at the moment when we do it </font></font><code>setScroll()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it checks whether the position of the scroll goes beyond the size of the child element, and if it does, we set the maximum possible position. </font><font style="vertical-align: inherit;">And since it </font></font><code>setScroll()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is called at zoom, then the following sequence of actions is obtained:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Calculate newHeight </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Calculate newScrollPos </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Set newHeight via setLayoutParams () </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Set newScrollPos via setScroll () </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The problem in paragraph number 3. </font><font style="vertical-align: inherit;">The real </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will not change until the next </font></font><code>super.onLayout()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>setScroll()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font><font style="vertical-align: inherit;">therefore </font><font style="vertical-align: inherit;">does not what is expected. </font><font style="vertical-align: inherit;">Corrected as follows. </font><font style="vertical-align: inherit;">Instead of </font></font><code>setScroll()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doing this:</font></font><br><br><pre> <code class="java hljs">nextScrollPos = newScrollY;</code> </pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and </font></font><code>onLayout()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">after the method we </font></font><code>super.onLayout()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">call this method:</font></font><br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateScrollPosition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nextScrollPos != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { setScrollY(nextScrollPos.intValue()); nextScrollPos = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you remember, I wrote that it would be better not to call any methods after </font></font><code>super.onLayout()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This is still the case. </font><font style="vertical-align: inherit;">Later I will describe another problem associated with this solution. </font><font style="vertical-align: inherit;">But the fact remains that this is the solution for the scrolling jump problem. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ps</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> However, if you do not use the hack with ‚Äúchange </font></font><code>height</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for child inside child inside </font></font><code>ScrollView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äù, then there will be no such problem. </font><font style="vertical-align: inherit;">But then we come back to the problem of a dozen subclasses.</font></font><br><br><h2> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. The task of clustering users</font></font></b> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now it's time to talk about the task itself, its algorithm and some of its features. </font></font><br><br><h3>  <b>3.1.</b> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What to do with boundary users?</font></font></b> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I'm talking about users who are on the border of their rank: </font></font><br><br><div style="text-align:center;"><img width="250" src="https://habrastorage.org/files/4e7/c66/e6a/4e7c66e6a0204965a9ba1ab445613563.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the picture, boundary users are users with 0%, 30%, 85% points (the user almost completely blocked it with 80%). </font><font style="vertical-align: inherit;">The easiest way would be to draw them in their legal position (equal to:</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), but in this case they will start to call in foreign ranks, which would put it mildly ‚Äúnot comme il faut‚Äù. The main reason for refusing this is grouping. Imagine a user with 29% points. He is on the border rank "Newbie". But suddenly he unites with the user with 33% points and their joint group is now located in the position corresponding to 31%, i.e., in the rank of ‚ÄúGood‚Äù. I didn‚Äôt like the idea that the grouping of views could change the ranks of users, so I refused and decided to restrict users inside the ranks as you saw in the picture above.</font></font><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.721ex" height="2.66ex" viewBox="0 -832 8060.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-68" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="1043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-67" x="1388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-68" x="1869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="2445" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2217" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="3751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-63" x="4221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="4654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-72" x="5140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="5591" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2F" x="6058" y="0"></use><g transform="translate(6558,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-1">height * score/100</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Looking ahead, I note that this added a lot of trouble to the algorithm for grouping and the logic of the application as a whole. </font></font><br><br><h3>  <b>3.2.</b> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is the number of points to show the group?</font></font></b> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, in the group 2 users united with points of 40% and 50%. </font><font style="vertical-align: inherit;">Where to arrange their joint group and with what points? </font><font style="vertical-align: inherit;">The answer is simple: 45% of the group position corresponds to the points of the group. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's complicate the task. </font><font style="vertical-align: inherit;">And how to combine these? </font></font><br><br><img width="250" src="https://habrastorage.org/files/061/cf3/fd3/061cf3fd32be4381b281e682bfd641a7.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are 2 ways to solve it:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Just as with users of 40% and 50%. </font><font style="vertical-align: inherit;">That is, we put the group in the position of 2.5%.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Put the group in position </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.913ex" height="2.66ex" viewBox="0 -832 16754.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-76" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="1220" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-77" x="1687" y="0"></use><g transform="translate(2403,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2E" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="3182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="3686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="4171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="4641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="4986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="5348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="5693" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="6179" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-59" x="6779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2013" x="7543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-76" x="8210" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="8695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="9041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-77" x="9507" y="0"></use><g transform="translate(10224,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2E" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="11003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="11506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="11992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="12461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="12807" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="13168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="13514" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="13999" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-59" x="14600" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-29" x="15363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2F" x="15753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-32" x="16253" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2">(view1.positionY ‚Äì view2. positionY) / 2</script> ,         . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The difference of approaches is that in the first case the group view will not be in the center between users, in the second case it will be in the center, which is much more favorable from the point of view of user experience. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Preferring </font></font><a href="https://en.wikipedia.org/wiki/User_experience"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , I decided to do it using method No. 2, however, the approach showed a significant drawback: the group points are calculated completely crookedly. The fact is that the user with 0% is actually not located at position 0 (after all, he would have entered the territory of someone else‚Äôs rank), so it can be said that everyone in a rank cannot have points less than a certain </font></font><code>minScore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one also changes at zoom, because it is calculated by the formula (simplified version):</font></font><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="68.226ex" height="2.66ex" viewBox="0 -832 29375 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-53" x="1824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-63" x="2470" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="2903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-72" x="3389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="3840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="4584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-28" x="5641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-75" x="6030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="6603" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="7072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-72" x="7539" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-56" x="7990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="8760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="9105" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-77" x="9572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-48" x="10288" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="11177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="11643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-67" x="11989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-68" x="12469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="13046" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2F" x="13407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-63" x="13908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="14341" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="14827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="15427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-61" x="15789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="16318" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="16664" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="17264" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-72" x="17731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-48" x="18182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="19071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="19537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-67" x="19883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-68" x="20363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="20940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-29" x="21301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2217" x="21913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-72" x="22636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-61" x="23087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="23617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6B" x="24217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-53" x="24739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-63" x="25384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="25818" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-72" x="26303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="26755" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-4D" x="27221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-61" x="28273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-78" x="28802" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3">minScore = (userViewHeight / containerHeight) * rankScoreMax</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... because it is </font></font><code>userViewHeight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">unchanged, but </font></font><code>containerHeight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">changes, then at different points of the pinch, the glasses at the boundary twist will be different. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Moreover, the formula itself:</font></font><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="64.353ex" height="2.66ex" viewBox="0 -832 27707.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-76" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-77" x="1297" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-47" x="2014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-72" x="2800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="3252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-75" x="3737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="4310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2E" x="4813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="5258" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="5762" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="6247" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="6717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="7062" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="7424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="7769" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="8255" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-59" x="8855" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="9896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-28" x="10953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-76" x="11342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="11828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="12173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-77" x="12640" y="0"></use><g transform="translate(13356,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2E" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="14135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="14639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="15124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="15594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="15939" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="16301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="16646" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="17132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-59" x="17732" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2013" x="18496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-76" x="19163" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="19648" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="19994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-77" x="20460" y="0"></use><g transform="translate(21177,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2E" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="21956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="22459" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="22945" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="23414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="23760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="24121" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="24467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="24952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-59" x="25553" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-29" x="26316" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2F" x="26706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-32" x="27206" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">viewGroup.positionY = (view1.positionY ‚Äì view2.positionY) / 2</script></p><br> ‚Ä¶   , ..    ,         (      .   <code>view.getY()</code> ,    <code>float</code> ,   ,    ,     <code>MarginLayoutParams.topMargin</code> ,  ,  ). <br><br>      ‚Ññ2,      ‚Ññ1,            -. <br><br><h3>  <b>3.3.</b> <b></b> </h3><br>     .  What I did.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I had at least 5 different implementations that in one way or another were subject to "unpleasant" effects, which forced me to solve the problem again and again in a new way. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I could write a final implementation and finish on this, but I still preferred to describe several of my implementations. </font><font style="vertical-align: inherit;">If you are interested in the clustering problem described below, think about how you would solve it (what algorithm would you think of / use), and then read paragraph by paragraph, changing your decision, if it is also subject to artifacts, like mine.</font></font><br><br><h4> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.1. </font><font style="vertical-align: inherit;">Task</font></font></b> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Make clustering with good UX, which means that: </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Boundary views must remain inside the rank. </font></font></li><li>        ‚Äì  ,   <code>zoom in</code>   <code>zoom out</code>   <code>zoom in</code>      - . </li><li>       / (      ‚Ññ2). </li></ol><br><h4> <b>3.3.2.    </b> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is important to note that in all implementations, before launching the algorithm itself, all users are sorted by their points and each user turns into a class </font></font><code>Group</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, because in fact, a single user is just a group of one person. </font><font style="vertical-align: inherit;">Also, using the word ‚Äúuser‚Äù I can mean both one user before joining a group, and a group of users. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About the notation. </font><font style="vertical-align: inherit;">I will mark the user's number with one digit: ‚Äú7‚Äù, - and the groups with two: ‚Äú78‚Äù. </font><font style="vertical-align: inherit;">The numbers in the group number indicate the numbers of users in it are members, that is, group 78 consists of users 7 and 8. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each algorithm will be given both a verbal description and pseudo-code.</font></font><br><br><h4> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.3. </font><font style="vertical-align: inherit;">Algorithm ‚Ññ1</font></font></b> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A simple sequential algorithm that unites users in order, if they intersect. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steps:</font></font><br><br> <code>1. ,      i  i+1. <br> 2.1.   ‚Äì     ‚Ññ1. <br> 2.2.   ,  . <br> 3.    1     .</code> <br> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; groups.size() - <span class="hljs-number"><span class="hljs-number">1</span></span>; ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isInersected(groups[i], groups[i+<span class="hljs-number"><span class="hljs-number">1</span></span>])) { groups[i].addUsersToGroup(groups[i+<span class="hljs-number"><span class="hljs-number">1</span></span>]); groups.remove(i+<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ++i; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> But this algorithm has a problem with UX: </font></font><br><br><div style="text-align:center;"><img width="500" src="https://habrastorage.org/files/f8d/f5d/82e/f8df5d82e0a84a49a2b68ff0572196c0.png"></div><br>     ,     ,      ,   ‚Äì     UX. <br><br><h4> <b>3.3.4.  ‚Ññ2</b> </h4><br> ,   ,     .       ‚Ññ1.         :    .         ,  . <br><br> : <br> <code>0. i = 0. <br> 1. ,     i  i+1. <br> 2.1.   ‚Äì ,     .    1. <br> 2.2.   ,    2. <br> 3.     ,   1. <br> 4.  i == 1     ,   . <br> 5.    0,  i ( 0  1   1  0 ‚Äì      ).</code> <br> <br><pre> <code class="java hljs">bool didIntersected, isEvenPass = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { didIntersected = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; isEvenPass = !isEvenPass; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = isEvenPass ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (i &lt; (groups.size() - <span class="hljs-number"><span class="hljs-number">1</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isInersected(groups[i], groups[i+<span class="hljs-number"><span class="hljs-number">1</span></span>)) { didIntersected = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; groups[i].addUsersToGroup(groups[i+<span class="hljs-number"><span class="hljs-number">1</span></span>]); groups.remove(i+<span class="hljs-number"><span class="hljs-number">1</span></span>); i += <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { i += <span class="hljs-number"><span class="hljs-number">2</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(isEvenPass || didIntersected);</code> </pre> <br>    ,   ,       (-   ).     ¬´ 21-12¬ª (  ): <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/files/d0b/6e4/b1f/d0b6e4b1f5364191ad70a6a703678863.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let me explain what happened here. </font><font style="vertical-align: inherit;">When you run the algorithm, it was found that 1 and 2 users intersect and form a group. </font><font style="vertical-align: inherit;">The third user intersects with their group, and therefore they all form another group. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, if you try to disengage them with a faster zoom, then what you see at the bottom of the picture will happen - two users will intersect, but will not form a group. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Even if, after splitting, to launch another merge pass, we will get group 23, which did not exist before. </font><font style="vertical-align: inherit;">Previously, users united in groups with a size of 2 and 1, and now, after separation, they form groups of size 1 and 2. Hence the name ‚ÄúProblem 21-12‚Äù. </font><font style="vertical-align: inherit;">This has a bad effect on UX when a group is combined differently depending on the zoom speed, which means the algorithm is not suitable.</font></font><br><br><h4> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.5. </font><font style="vertical-align: inherit;">Algorithm ‚Ññ3</font></font></b> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then it became clear to me that stupidly in the forehead the task could not be solved and I would have to use artillery heavier. </font><font style="vertical-align: inherit;">Therefore, I decided to combine users based on the distance between them (their views). </font><font style="vertical-align: inherit;">The smaller the distance between users - the first is their union. </font><font style="vertical-align: inherit;">And in order to break up groups, you can simply enter the type field </font></font><code>Stack&lt;Group&gt; groupsStack;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and add each new group there. </font><font style="vertical-align: inherit;">Thus, when disconnecting, only the topmost element on the stack will need to be checked. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Steps:</font></font><br> <code>0.         (   groups.size() ‚Äì 1,   /        ).      <br> 1.     .     0? <br> YES.1.  2-         . <br> YES.2.   .  ,     2- ,        . <br> YES.3.     . <br> YES.4.    1. <br> NO.1.  .</code> <br> <br><pre> <code class="java hljs">distances.sortAsc(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!distances.isEmpty() &amp;&amp; distances.getFirst().distance &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { firstDistance = distances.getFirst(); mergedGroup = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Group(firstDistance.groupLeft, firstDistance.groupRight); groupsStack.push(mergedGroup); distances.removeFirst(); firstDistance.groupLeft.notifyPositionChanged(mergedGroup.position); firstDistance.groupRight.notifyPositionChanged(mergedGroup.position); distances.sortAsc(); }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I thought "well, this will surely be enough." </font></font> But no.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It turned out, and here there is a problem: the wrong order of combining groups. </font><font style="vertical-align: inherit;">"How can this be ?!" - you thought?</font></font> Yes, very simple.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What if you make an oh-oh-oh-very sharp zoom? </font></font><br><br><div style="text-align:center;"><img width="450" src="https://habrastorage.org/files/b8c/066/09d/b8c06609d3314b26b83590b66bea6200.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a result of the sharp zoom, all users had the same position, because they were quite close to each other before the zoom. </font><font style="vertical-align: inherit;">Because of this, I </font></font><code>sortAsc()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">did not know what to do, because the distance between users 1 and 2 is 0, but also between users 2 and 3 it is also 0. As a result, the groups merged in the wrong order. </font><font style="vertical-align: inherit;">This will be especially noticeable when disconnected. </font><font style="vertical-align: inherit;">The first 12 will be separated, because they are the last to unite (the stack is </font></font><a href="https://en.wikipedia.org/wiki/LIFO_%2528computing%2529"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LIFO</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Do you all remember?), Although they are closer to each other.</font></font><br><br><h4> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.3.6. </font><font style="vertical-align: inherit;">Algorithm ‚Ññ3.1</font></font></b> </h4><br>       ‚Äì    <code>sortAsc()</code>    ¬´  0¬ª.    ,   .   , ,  <code>distance == 0</code>   2-  ,    <code>group.scoreAfterMerge</code> .   ,      GroupsDistance,      : <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compareTo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull GroupsDistance obj)</span></span></span><span class="hljs-function"> </span></span>{ GroupsDistance a = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, b = obj; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distancesComparison = MathUtil.Compare(b.distance, a.distance); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (distancesComparison != <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> distancesComparison; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> namesComparison = a.leftGroup.name.compareTo(b.leftGroup.name); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> namesComparison; } }</code> </pre><br> ‚Ä¶    .  <code>group.scoreAfterMerge</code> ': <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compareTo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull GroupsDistance obj)</span></span></span><span class="hljs-function"> </span></span>{ GroupsDistance a = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, b = obj; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> distancesComparison = MathUtil.Compare(b.distance, a.distance); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (distancesComparison != <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> distancesComparison; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> scoresComparison = MathUtil.Compare(a.scoreAfterMerge, b.scoreAfterMerge); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (scoresComparison != <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> scoresComparison; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> namesComparison = a.leftGroup.name.compareTo(b.leftGroup.name) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> namesComparison; } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indeed, </font></font><code>user.score</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">they </font></font><code>group.scoreAfterMerge</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will always be unequal (and if they are equal, then there is no difference in the order in which to unite them ‚Äî they will never get separated anyway). This means that add. comparisons </font></font><code>score</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">should be enough to solve the problem ... but no, and in this case there is a flaw. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remember the condition of the problem: "The boundary view must remain inside the rank"? The problem lies in it. If it were not for this condition, </font></font><code>distance</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it would always change proportionally between users, and the position of the user view would uniquely display it </font></font><code>score</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but this is not so. Because of this condition, at the boundary view, the dependence of the position on is violated </font></font><code>score</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This is not obvious enough, so here is a detailed example of such a ‚Äúviolation‚Äù:</font></font><br><br> ,     100.      0,      100.      : [0, 100],     [_, _]. ,     1D .       (, [0, 100]  [60, 160])      ‚Ññ1   ‚Ññ2, .. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.076ex" height="2.178ex" viewBox="0 -780.1 6060.5 937.7" role="img" focusable="false" style="vertical-align: -0.366ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2212" x="1723" y="0"></use><g transform="translate(2724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="4003" y="0"></use><g transform="translate(5059,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-34"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-5">100-60=40</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, we have a view of rank with a height of 1000 and 3 users: </font><i><font style="vertical-align: inherit;">Note: for user No. 3, the position is not [1000, 1100], because going beyond the boundaries of the rank is unacceptable. Therefore, its view was moved to the nearest possible position inside the rank view.</font></i><font style="vertical-align: inherit;"> It would seem that the distance between No. 1 and No. 2 is 90, between No. 2 and No. 3 is 10. The latter will intersect earlier with the zoom, right? .. Let's zoom with a factor of 0.5 (the rank view has become 500): </font><font style="vertical-align: inherit;">The distance between No. 1 and No. 2 is -5, between No. 2 and No. 3 is -95. ‚Ññ2 and ‚Ññ3 united before ‚Ññ1 and ‚Ññ2, did they want it all, hurray? .. No: D. Let's return the zoom back and this time we will produce a zoom with a factor of 0.2 (the size of the rank view has become 200):</font></font><br><br> <code> ‚Ññ1  60%: [600, 700]. <br>  ‚Ññ2  79%: [790, 890]. <br>  ‚Ññ3  100%: [900, 1000] ( : [1000, 1100]).</code> <br> <br> <i><font style="vertical-align: inherit;"></font></i> <br><font style="vertical-align: inherit;"></font><br><br> <code> ‚Ññ1  60%: [300, 400]. <br>  ‚Ññ2  79%: [395, 495]. <br>  ‚Ññ3  100%: [400, 500] ( : [500, 600]).</code> <br> <br><font style="vertical-align: inherit;"></font><br><br> <code> ‚Ññ1  60%: [100, 200] ( : [120, 220]). <br>  ‚Ññ2  79%: [100, 200] ( : [158, 258]). <br>  ‚Ññ3  100%: [100, 200] ( : [200, 300]).</code> <br> <br>   ‚Ññ1  ‚Ññ2  0,   ‚Ññ2  ‚Ññ3   0.   ,     user.score ‚Ä¶  , ‚Ññ1  ‚Ññ2    ,  ‚Ññ2  ‚Ññ3,        . <br><br>     ,        ,    ,     .         . <br><br> ¬´    .    ?  ,          <code>score</code> ?!¬ª ‚Äî      . <br><br><h4> <b>3.3.7.  ‚Ññ4</b> </h4><br>   . ,   .        .      ,   ¬´A¬ª   ¬´B¬ª      -    .  Here is an example: <br><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.263ex" height="2.419ex" viewBox="0 -780.1 14321.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text><g transform="translate(598,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1021,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1450,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1818,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2233,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-41" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3A" x="3624" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="4180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="4684" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="5169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="5639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="5984" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="6346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="6691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="7177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="8055" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="9111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2C" x="9612" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="10057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="10526" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="11030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="11496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-64" x="11963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="12764" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="13820" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> A: position=0, speed=0</script><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="40.456ex" height="2.78ex" viewBox="0 -935.7 17418.3 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text><g transform="translate(598,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1021,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1450,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1818,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2233,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-42" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3A" x="3633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="4189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="4693" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="5178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="5648" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="5993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="6355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="6700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="7186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="8064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2212" x="9120" y="0"></use><g transform="translate(9899,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2C" x="11400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="11845" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="12315" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="12818" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="13285" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-64" x="13751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="14553" y="0"></use><g transform="translate(15609,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><g transform="translate(1001,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-32" x="500" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-7"> B: position =-100, speed=10^{12}</script><br>        ( <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.658ex" height="2.419ex" viewBox="0 -935.7 2005.4 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><g transform="translate(1001,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-39" x="778" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-8">10^{-9}</script> ),       ¬´B¬ª   : <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="92.903ex" height="2.78ex" viewBox="0 -935.7 39999.6 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-42" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2E" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="1204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="1708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="2193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="2663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="3008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="3370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="3715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="4201" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="5079" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-42" x="6135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2E" x="6895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="7340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="7843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="8329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="8798" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="9144" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="9505" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="9851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="10336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2B" x="11159" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-42" x="12160" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2E" x="12919" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="13365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="13834" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="14338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="14804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-64" x="15271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2217" x="16016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="16739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="17100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6D" x="17446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="18324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-44" x="18791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="19619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6C" x="20086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="20384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-61" x="20746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="21553" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2212" x="22610" y="0"></use><g transform="translate(23388,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2B" x="25112" y="0"></use><g transform="translate(26112,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><g transform="translate(1001,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-32" x="500" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2217" x="28143" y="0"></use><g transform="translate(28866,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><g transform="translate(1001,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-39" x="778" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="31149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2212" x="32206" y="0"></use><g transform="translate(32984,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2B" x="34708" y="0"></use><g transform="translate(35709,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-33" x="1415" y="557"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="37441" y="0"></use><g transform="translate(38498,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-9">B.position = B.position + B.speed * timeDelta = -100 + 10^{12} * 10^{-9} = -100 + 10^3 = 900</script><br>    : <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.647ex" height="2.78ex" viewBox="0 -935.7 16639.8 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text><g transform="translate(598,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1021,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1450,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(1818,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><g transform="translate(2233,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-42" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3A" x="3633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="4189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="4693" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="5178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="5648" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-74" x="5993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-69" x="6355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6F" x="6700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-6E" x="7186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="8064" y="0"></use><g transform="translate(9120,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-39"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-2C" x="10622" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-73" x="11067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-70" x="11536" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="12040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-65" x="12506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMATHI-64" x="12973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-3D" x="13774" y="0"></use><g transform="translate(14830,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-30" x="500" y="0"></use><g transform="translate(1001,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/321890/&amp;xid=17259,1500002,15700002,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhVWfRfQXYkTogyQEdKOXsnOA70Dw#MJMAIN-32" x="500" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-10"> B: position=900, speed=10^{12}</script><br><br> ¬´B¬ª   ¬´A¬ª ,      ,           . <br><br>      ,     ‚Äì  ,     ‚Äì  .  ,  ,  ,   ,       ,  <code>height</code> ,    2  !       <code>willIntersectWhenHeight</code> '      ,       .  ‚Äì  ,    (  <code>border</code>  <code>bound</code> ) /   ,   .       . <br><br>      ,   ,     ,    <code>willIntersectWhenHeight</code> '   <code>GroupCandidates</code> . ,  ,        ,   .        ,    . <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIntersectingHeght</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> intersectingHeight; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Float height = calcIntersectingHeightWithNoBound(); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> leftIsBorder = leftGroup.isLeftBorderWhen(height), rightIsBorder = rightGroup.isRightBorderWhen(height); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!leftIsBorder &amp;&amp; !rightIsBorder) { intersectingHeight = space; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (leftIsBorder &amp;&amp; !rightIsBorder) { intersectingHeight = (itemHeight + itemHalfHeight) / right.getNormalizedPos(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!leftIsBorder &amp;&amp; rightIsBorder) { intersectingHeight = (itemHeight + itemHalfHeight) / (<span class="hljs-number"><span class="hljs-number">1</span></span> - left.getNormalizedPos()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (leftIsBorder &amp;&amp; rightIsBorder) { intersectingHeight = ((<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) (itemHeight + itemHeight)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> intersectingHeight; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Float </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calcIntersectingHeightWithNoBound</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> itemHeight / (right.getNormalizedPos() - left.getNormalizedPos()); }</code> </pre> <i>: <code>getNormalizedPos()</code>   (..,  0  1)   .</i> <br><br>     ,    ,       .  ,  . <br><br><h2> <b>4.  </b> ( <i><u>UPD</u></i> :  ) </h2><br>    .        ,    ,  -     ¬´     ‚Äì  ¬ª,    ,  .   ,     , ,   ,   . <br><br><h3>  <b>4.1.</b> <b><code>ScrollView.setScroll()</code>  <code>ScrollView.onLayout()</code>      <code>super.onLayout()</code> (   child'  child'  <code>ScrollView</code> )</b> </h3><br>     .    ,   <code>ScrollView</code>  <code>setScroll()</code>  <code>super.onLayout()</code> .  Why is it important?   <code>requestLayout()</code> .      ¬´  layout pass¬ª      16-.  ,   <code>requestLayout()</code>  ,   ,     <code>super.onLayout()</code> (      ), layout pass   . <br><br> ,   <code>requestLayout()</code>    <code>super.onLayout()</code> ,     .   ,       ( 16),   layout pass,   <code>ScrollView.onLayout()</code> ,      <code>requestLayout()</code>  <code>super.onLayout()</code> ‚Ä¶  ,  16-     <code>Layout</code> '    . ,  .         <code>requestLayout()</code>  <code>super.onLayout()</code> ,  <code>ScrollView.setScroll()</code>   <code>requestLayout()</code> ,     ?    : <br><br><h3>  <b>4.2.</b> <b><code>View.setVisibility(GONE)</code>  <code>requestLayout()</code></b> </h3><br>    (  )   ,     .  ,   recycling  /,       ,     . <br><br>   ,  <code>View.getLocalVisibleRect()</code> (   )  <code>UsersView</code>         ,  <code>groupView.setUsersGroup(group)</code> ,    <code>groupsCountView.setVisiblity(‚Ä¶)</code> . <br><br>  But!     ,    <code>ScrollView.setScroll()</code> ,      <code>View.getLocalVisibleRect()</code> .    <code>ScrollView.setScroll()</code>   <code>super.onLayout()</code> ,  <code>groupView.setUsersGroup(group)</code>   <code>View.setVisiblity(GONE)</code> ,   <code>requestLayout()</code> ,     ,    . <br><br>  ,            ,       ,   <code>View.getLocalVisibleRect()</code> ,     <code>View.setVisiblity(GONE)</code> ,    <code>requestLayout()</code> .  ,      <code>requestLayout()</code> ‚Äì   ! <br><br>     -,      <code>requestLayout()</code>  <code>GroupView</code> ,    (   <code>GroupView</code>   ¬´¬ª‚Ä¶  .   ),    ¬´ <code>requestLayout()</code> ¬ª     .    ¬´¬ª,  . ,   ,  stackoverflow      . <br><br><h3> <b>4.999.   </b> </h3><br>         ,  <code>requestLayout()</code>  ,     (    ).     ,    ,   <code>RecyclerView</code>   <code>LayoutManager</code> . <br><br> ,        ,   <code>RecyclerView</code> ,    . ,     <code>requestLayout()</code> ,      (, <code>child.setVisibility(GONE)</code> ), ‚Ä¶   <code>child</code> '  <code>Layout</code> !    : <code>layout.addView(myChild)</code> . <br>     : <br><ol><li>     <code>View</code> ' <code>child</code> '; </li><li>    <code>measure()</code> , <code>layout()</code>  <code>drawChild()</code>  <code>child</code> '   ; </li><li> <code>child</code> '   ,         <code>requestLayout()</code> . </li></ol><br>   ‚Ññ3      .   ‚Äî   .   <code><a href="https://developer.android.com/reference/android/view/View.html">View.getLocalVisibleRect()</a></code>        /      //. <br><br> ps       ‚Ä¶ ,  ,  <code><a href="https://developer.android.com/reference/android/view/View.html">onScrollChanged()</a></code>      <code>onLayout()</code> ,       <code>setScrollY()</code> ?       ,  <code>View.getLocalVisibleRect()</code>  <code>false</code> (, <code>UsersView</code>    ).   ,  ,     :/  ,     <code>recycling</code> '   .      1.000    .     -   .         NDK. <br><br><h2> <b>5. </b> </h2><br>      ,    .      ,      ,    SDK    .  Android'   . <br><br>     -   ,        .   ,      ,    -_-"‚Ä¶     . ,   . <br><br>      ‚Äî <a href="https://github.com/Nexen23/RankingListView">github.com/Nexen23/RankingListView</a> <br><br>        ¬´ ¬ª ‚Äî   .    ,   ,   . <br><br> <i><u>UPD 1</u></i> :    <a href="https://habrahabr.ru/users/artem_007/" class="user_link">Artem_007</a> ,  feature-request/bug-report    . <br> <i><u>UPD 2</u></i> :   <code>4.999.</code>   ¬´¬ª . </div><p>Source: <a href="https://habr.com/ru/post/321890/">https://habr.com/ru/post/321890/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321880/index.html">Google launched the beta version of Cloud Spanner - NewSQL DBMS generation</a></li>
<li><a href="../321882/index.html">Install MLDonkey and DC ++ plugin for it</a></li>
<li><a href="../321884/index.html">PyNSK # 12 - February meeting of the Pitonists of Novosibirsk</a></li>
<li><a href="../321886/index.html">How IT professionals work. Andrei Makarov, Neti company</a></li>
<li><a href="../321888/index.html">DALI light control with Arduino</a></li>
<li><a href="../321892/index.html">The answer to the introduction to the design of entities, the problem of creating objects</a></li>
<li><a href="../321894/index.html">Zabbix data monitoring in Oracle database without unixODBC</a></li>
<li><a href="../321896/index.html">Unknown cyber grouping has attacked 140 companies in 40 countries with legitimate software</a></li>
<li><a href="../321898/index.html">CEF, ES6, Angular 2, WebPack 2 .Net Core desktop application without server side</a></li>
<li><a href="../321900/index.html">That's what life-giving quantum does.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>