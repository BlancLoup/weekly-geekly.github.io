<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>OutOfMemory and the use of vector images in Android Studio</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! In this article, focused on beginners, I would like to give some tips on how to optimize the use of device memory by the application, so as ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>OutOfMemory and the use of vector images in Android Studio</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  In this article, focused on beginners, I would like to give some tips on how to optimize the use of device memory by the application, so as not to receive OutOfMemory all the time, and also consider using vector images in the current actual version of Android Studio (3.4), since most Russian-language resources on this The topic (the last <a href="https://habr.com/ru/post/265601/">article</a> on Habr√© about vector images dates back to 2015) is outdated, which often misleads novice developers.  So let's get started. <br><a name="habracut"></a><br><h3>  1. Use vector images instead of raster images. </h3><br>  Of course, large images with many small details should not be translated into a vector - it will take as much space as a raster, if not more.  However, small images, such as icons and other parts of the user interface should be converted to a vector in order to save memory.  Yes, and work with <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BE%25D1%2580%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584%25D0%25B8%25D0%25BA%25D0%25B0">vector images</a> are often much more convenient.  And now, the most important thing is how to do it? <br><br><ol><li>  Open Android Studio. </li><li>  We right-click on the drawable folder or its contents&gt; New&gt; Vector Asset <br><br><img src="https://habrastorage.org/webt/yd/yx/nz/ydyxnzofoc2w58vidp0v7kj2pm0.jpeg"></li><li>  Specify the path to your svg-file.  If your image has an irregular shape, then I advise you to put a tick next to the Override parameter - otherwise the picture will fit the standard dimensions, which can distort its proportions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/zw/nx/8j/zwnx8jptjsjvvipavpn5an0v4de.jpeg"></li><li>  Next&gt; Finish </li><li>  Done! </li></ol><br>  To convert from raster to vector, I can advise a great free application <a href="https://inkscape.org/ru/">Inkscape</a> .  A little about working with him: <br><br><ol><li>  Open Inkscape. </li><li>  Drag any raster into it.  In the window that opens, select the import settings and click OK. </li><li>  In the upper toolbar, after selecting our image, select Contour&gt; Vectorize raster (Shift + Alt + B). </li><li>  Now the most important thing.  In the new window, check the box next to ‚ÄúRemove background‚Äù and select the following: will our image be in color and how many scans should be made.  We must not forget that the size of our vector file directly depends on these two parameters. <br><br>  More scans - more colors, shades and details.  My leprechaun needed 30 scans to get a divine look, due to the large number of colors in the image.  This is quite a lot, it is better to do no more than ten and choose pictures simpler. <br><br><img src="https://habrastorage.org/webt/k-/qk/a3/k-qka3pfsclaxmfx5z0lkql_uiq.jpeg"></li><li>  We close the window, click on the raster and delete it with the Delete key, go to File&gt; Document Properties (Shift + Ctrl + D), adjust the page size to the content. </li></ol><br>  Now we will carry out a small test proving the advantage of the vector in saving memory. <br>  I created a new project with a single ImageView, to which I applied an animation that moves it from point A to point B, alternately changing the image to raster and vector.  We look the data. <br><br>  Raster <br><br><img src="https://habrastorage.org/webt/1m/dc/zl/1mdczltjsqgifnfhtxjignty6o0.jpeg"><br><br>  Vector <br><br><img src="https://habrastorage.org/webt/ez/hm/oq/ezhmoqzzrltr5pinghsv8r-0e4a.jpeg"><br><br>  The difference is almost doubled.  I think this is quite convincing. <br><br><h3>  2. Increase heap size </h3><br>  To do this, go to the manifest of your project (app&gt; manifests&gt; AndroidManifest.xml) and in the application column add the line: <br><br><pre><code class="xml hljs">android:largeHeap="true"</code> </pre> <br>  In fact, increasing the heap is not a solution to OutOfMemory, but pushing it to a far shelf.  Instead of optimizing the application's use of device memory, we give it more space.  Do not forget that each device has its own memory capacity, both main and additional, allocated for the application. <br><br><h3>  3. Avoid memory leaks. </h3><br>  Any application in its work uses a variety of objects that, naturally, occupy a certain place in the memory.  Ideally, the garbage collector should remove unused objects from it, but sometimes so-called ‚Äúmemory leaks‚Äù appear that cause serious problems in the operation of the application.  There are various causes of memory leaks, which are described in detail <a href="https://habr.com/ru/company/sebbia/blog/243537/">here</a> . <br><br>  On my own, I would like to recommend the <a href="https://github.com/badoo/android-weak-handler">WeakHandler</a> library, developed by Badoo, and designed to fix memory leaks associated with the incorrect use of android.os.Handler.  To use this library, add to your gradle-file (Gradle Scripts&gt; build.gradle (Module: app)) in the dependencies column the line: <br><br><pre> <code class="xml hljs">compile 'com.badoo.mobile:android-weak-handler:1.1'</code> </pre> <br>  and in the java file: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> WeakHandler mHandler; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ mHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WeakHandler(); ... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View view)</span></span></span><span class="hljs-function"> </span></span>{ mHandler.postDelayed(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { view.setVisibility(View.INVISIBLE); }, <span class="hljs-number"><span class="hljs-number">5000</span></span>); }</code> </pre> <br>  And do not forget to import WeakHandler itself, if the studio did not do this automatically. <br><br><h3>  4. Avoid large frame-by-frame animations. </h3><br>  Frame-by-frame animation in Android Studio is a handy thing, but far from the most economical.  When using a large number of images in it, you will certainly get OutOfMemory. <br><br>  But, if you really need it, better use the gif-image with the <a href="https://github.com/koral--/android-gif-drawable">Android Gif Drawable</a> library.  This library simplifies c-gif work and also consumes much less memory than Android Studio frame-by-frame animations.  To use this library, add to your gradle-file (Gradle Scripts&gt; build.gradle (Module: app)) in the dependencies column the line: <br><br><pre> <code class="xml hljs">implementation 'pl.droidsonroids.gif:android-gif-drawable:1.2.16'</code> </pre> <br>  and in your second gradle file (Gradle Scripts&gt; build.gradle (Module: ‚Äúthe name of your application‚Äù)) in the buildscript and allproject columns line: <br><br><pre> <code class="xml hljs">mavenCentral()</code> </pre> <br>  and in the java file: <br><br><pre> <code class="java hljs">GifDrawable gifFromResource = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GifDrawable( getResources(), R.drawable._ ); gifFromResource.start();</code> </pre><br>  To disable gif instead of start (), we write stop ().  Also do not forget to compress gif-ki, it will save even more space. <br><br>  I hope that my article was useful to you.  Thank. </div><p>Source: <a href="https://habr.com/ru/post/450566/">https://habr.com/ru/post/450566/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../450550/index.html">Part 4. Career programmer. Junior. Freelance entry</a></li>
<li><a href="../450552/index.html">Show laboratory "Advanced nanomaterials and optoelectronic devices" ITMO University</a></li>
<li><a href="../450554/index.html">Breaking a design pattern - Singleton in PHP</a></li>
<li><a href="../450556/index.html">Valve Index - a review of the new VR set</a></li>
<li><a href="../450564/index.html">Glitter and poverty: how the digital revolution made musicians poorer</a></li>
<li><a href="../450568/index.html">Each poison has its own antidote. How to escape or at least try (upd: about antidotes for household poisoning)</a></li>
<li><a href="../450574/index.html">Create a multiplayer web game in the genre .io</a></li>
<li><a href="../450576/index.html">New rules for anonymity messengers</a></li>
<li><a href="../450578/index.html">What is heard on the radio? Receive and decode the most interesting signals. Part 2, VHF</a></li>
<li><a href="../450582/index.html">Principles of operation of the PIM protocol</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>