<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tanchiki in the console, the first article: "From the dispute to writing code"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Perhaps you need to start with a little background: I‚Äôm somehow sitting on a pair and we decided to argue with a group mate about the possibility of c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tanchiki in the console, the first article: "From the dispute to writing code"</h1><div class="post__text post__text-html js-mediator-article">  Perhaps you need to start with a little background: I‚Äôm somehow sitting on a pair and we decided to argue with a group mate about the possibility of creating the simplest tanchik in the console (like dendivs), but for playing on the network. <br><br>  Since we had no computer networks yet, I had to learn everything from scratch myself.  Having read, perhaps, pages 30 of the selected text and having listened to four lectures on this topic, I felt very bored and lazy to listen to this further, and I finally started the project. <br><br><h3>  Are you all ready?  Getting started! </h3><br>  This article will be short but informative (for beginners like me). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the time of this writing, I knew only a few languages ‚Äã‚Äãand I was thinking about the choice of each of them and how it is suitable for the development of these same tanchiki.  But based on knowledge, I decided to distribute everything as follows: <br><br>  C # - client (as the easiest to learn language) <br>  Rust - server (as the safest and fastest) <br>  Php / html / css / javascript - site (which we MAYBE do) <br><a name="habracut"></a><br><h2>  Part One: Problem Statement </h2><br>  The main thing that I had to do in order to prove the correctness is simple tanchiki, but I decided to make a universal client.  Like this?  - This is when the server is equally optimized as for WinForm, and for the console (because I want good tunics in WinForm). <br><br>  So our task sounds like this: It is necessary to develop three applications, the first for WinForm (standard windows), the second - the console (dandy emulator) and the third - the server itself. <br><br><h2>  Part Two: Ideas and Flaws ... </h2><br>  What should a good application do?  - I asked this question when designing and the answer in my head was: ‚ÄúBe quick‚Äù. <br><br>  What does it mean?  - The fact that we have to work with several streams of receiving / transmitting data.  The projectile cannot wait until the tank is rendered, the tank cannot wait while the wall is drawn to move. <br><br>  We all know how offensive it is when you have a FPS drop or do not have time to draw something and kill you.  Such situations should not be! <br><br>  Thinking, I decided to distribute them that way: <br><br>  1st Stream (Maine) - must send a pressed key to the server. <br>  The 2nd stream should receive the coordinates of the tanks. <br>  3rd coordinates of the walls. <br>  4th coordinates of the shells. <br><br>  It was also desirable to create a chat for the communication of tankers during the game (suddenly we will be in different rooms), but this has not yet been implemented. <br><br>  Now there is some specifics with the streams, the first should be a simple sender (that is, organize the minimum calculations and send them to the server), the rest should always receive and draw everything in our application.  In the form of code, everything will be like this: <br><br><pre><code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Tank_coordinate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   await Task.Run( () =&gt; { }); } static async void Coordinate_wall() { //   await Task.Run( () =&gt; { }); } static async void Shot() { //   await Task.Run( () =&gt; { /*  :     ,     */ }); } static void To_key() { //   }</span></span></code> </pre> <br>  After all this, I had several options for organizing data to send them to the server, and then lectures went into battle.  The choice was great: either to organize everything in Inte / String variables and draw through them, or create a structure for the data, I did not consider the objects.  did not want to mess with links.  After an hour of walking in the forums, I stopped at the second, since organizing data as a structure is <b>much easier</b> , and writing documentation will be more convenient (advice: if there are groups of data that are similar in purpose, it will be better to combine them into a structure, because it is much easier read the code and look for variables).  Our new task is: to create a structure in which there will be fields responsible for the key pressed, the player‚Äôs coordinate, the angle of the tank and (for the console) the position of the last character and preferably some kind of draw control.  What is the last thing for us?  - so that the coordinates with which we work are not used (we increase / decrease / send to the server) <br><br>  What were the mistakes?  - you ask me. <br><br>  Initially, I started to climb into the jungle of the http model (I wanted to do it on http), but after a certain amount of time n, it became clear to me that it would be better to do it on tcp (and it will be easier to grow smaller problems with rastom). <br><br>  We decided on the flows and on the idea, what's next? <br><br>  And then, friends, will be the most interesting. <br><br><h2>  Part Three: Creating the structure and method Main ().  The end of the first stage of development </h2><br>  Immediately I will throw the code so that impatient readers will immediately copy it: <br><br><pre> <code class="hljs pgsql">//    //       /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; ///  ( ) /// &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> struct player_coor { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> new_player_coor (<span class="hljs-type"><span class="hljs-type">int</span></span> x_, <span class="hljs-type"><span class="hljs-type">int</span></span> y_, string dir_, ConsoleKey key_, <span class="hljs-type"><span class="hljs-type">int</span></span> last_x_, <span class="hljs-type"><span class="hljs-type">int</span></span> last_y_) { x = x_; y = y_; dir = dir_; key = key_; last_x = last_x_; last_y = last_y_; } static <span class="hljs-type"><span class="hljs-type">int</span></span> x = <span class="hljs-number"><span class="hljs-number">2</span></span>;//  static <span class="hljs-type"><span class="hljs-type">int</span></span> y = <span class="hljs-number"><span class="hljs-number">2</span></span>;// static string dir;//  static ConsoleKey key;//  static <span class="hljs-type"><span class="hljs-type">int</span></span> last_x;// static <span class="hljs-type"><span class="hljs-type">int</span></span> last_y;// <span class="hljs-string"><span class="hljs-string">'y'</span></span>  <span class="hljs-string"><span class="hljs-string">'x'</span></span> } static <span class="hljs-type"><span class="hljs-type">void</span></span> Main(string[] args) { }</code> </pre><br>  But this is not the most convenient code, the best option was proposed: <a href="https://habrahabr.ru/users/norver/" class="user_link">norver</a> <br><br>  and it looks like this: <br><br><pre> <code class="hljs pgsql">//      <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Position { //    <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> X { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> Y { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> Position(<span class="hljs-type"><span class="hljs-type">int</span></span> x, <span class="hljs-type"><span class="hljs-type">int</span></span> y) { X = x; Y = y; } } //   ,  "player_coor" <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> struct PlayerState { //         //  ,     //      /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; ///   /// &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="startPosition"&gt; &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="dir_"&gt;   ()&lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="key_"&gt; &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="lastPosition"&gt;  &lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> PlayerState(Position startPosition, <span class="hljs-type"><span class="hljs-type">int</span></span> dir_, ConsoleKey key_, Position lastPosition) { StartPosition = startPosition; LastPosition = lastPosition; dir = dir_; key = key_; } private Position StartPosition { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } private Position LastPosition { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } //  static <span class="hljs-type"><span class="hljs-type">int</span></span> dir; //  static ConsoleKey key; } static <span class="hljs-type"><span class="hljs-type">void</span></span> Main(string[] args) { //    Position,   <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> var startPosition = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Position(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); //    Position,   <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span> var currentPosition = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Position(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); //    PlayerState var currentState = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PlayerState(startPosition, <span class="hljs-type"><span class="hljs-type">int</span></span>, ConsoleKey.UpArrow, currentPosition); //          Position Console.WriteLine("X={0}, Y={1}", startPosition.X, startPosition.Y); }</code> </pre><br><br>  A small remark: during the writing of the continuation of this article, I found out that it would be much easier to store a numeric variable than a text one, which is why we will store an integer value in the dir variable (that is, the position). <br><br>  This is the simplest code, but it does a great job: it spreads our future application. <br><br>  A small description of the threads: any thread is created through the System.Threading space.  We create it the same way as the class instance, but in the stream argument we specify the void function. <br>  After creating the stream, you can start it using the .Start () method and disable (raise an exception) using the .Abort () method, but this is a synchronous model (that is, we eat with a knife and fork, but we cannot cut it until we take it with a fork), but there is asynchronous (we eat and vacuum, and our legs at the same time do the bench press by +100500 approaches), which we took to use. <br><br>  Here we wrote our first "pseudocode" and the main provisions / ideas of our project.  The first stage has come to an end, as well as our mindlessness has come to an end, then we will develop functions and we will have to sweat. <br><br><h4>  Thank you so much: </h4><br>  <a href="https://habrahabr.ru/users/lair/" class="user_link">lair</a> , <a href="https://habrahabr.ru/users/unsafeptr/" class="user_link">unsafePtr</a> , <a href="https://habrahabr.ru/users/vlreshet/" class="user_link">vlreshet</a> , <a href="https://habrahabr.ru/users/domix32/" class="user_link">domix32</a> , <a href="https://habrahabr.ru/users/vadimturkov/" class="user_link">vadimturkov</a> , <a href="https://habrahabr.ru/users/myxo/" class="user_link">myxo</a> , <a href="https://habrahabr.ru/users/norver/" class="user_link">norver</a> for ideas and article edits. <br><br>  Waiting for your wishes and ideas, and the power will come with you! </div><p>Source: <a href="https://habr.com/ru/post/344226/">https://habr.com/ru/post/344226/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344214/index.html">Strike iron: hot hardware startups</a></li>
<li><a href="../344216/index.html">What's new in DataGrip 2017.3</a></li>
<li><a href="../344220/index.html">Kubernetes 1.9: a review of major innovations</a></li>
<li><a href="../344222/index.html">How to build an image classifier based on a pre-trained neural network</a></li>
<li><a href="../344224/index.html">How and why to determine voice mail</a></li>
<li><a href="../344228/index.html">‚ÄúIs it a good design or not?‚Äù - how do I answer this question with the help of 3 categories</a></li>
<li><a href="../344230/index.html">Oracle Open World 2017: Announcements of ‚ÄúAutonomous AI‚Äù</a></li>
<li><a href="../344234/index.html">Python Meetup 11/14/2017: Python in Porto, Aiohttp and again tests</a></li>
<li><a href="../344236/index.html">The future billing systems and how they change the communications market</a></li>
<li><a href="../344238/index.html">Learn OpenGL. Part 4.2. - Stencil Test</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>