<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NEMA Encryption Machine</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During World War II, the Swiss army used an enhanced version of the commercial Enigma K, sometimes called Swiss K. When the Swiss discovered that thei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NEMA Encryption Machine</h1><div class="post__text post__text-html js-mediator-article">  During World War II, the Swiss army used an enhanced version of the commercial Enigma K, sometimes called Swiss K. When the Swiss discovered that their secret messages were decoded by the Allies and the Germans, they decided to develop their own NEMA encryption machine. <br><br>  NEMA (abbreviated from "Neue Maschine") is an electromechanical encryption machine developed by Zellweger AG (Uster, Switzerland) during World War II and replacing the famous German Enigme.  The machine is also known as TD and as NEMA Modell 45. <br><br>  At first glance, the car had 10 rotors, but only 5 of them were connected by an electric circuit.  Also 4 out of 5 were coding rotors with 26 pins on each side.  And the fifth disc is a reflex one, which could move during ciphering (unlike Enigma, where the reflector was fixed). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      NEMA consisted of a 26 letter (AZ) keyboard for entering open messages, as well as 26 light bulbs highlighting the desired letters of the ciphertext.  But compared to the Enigma, NEMA had additional switches between letters and numbers.  They were used to connect to an electronic printing device.  At NEMA, there were constructive improvements, such as irregular stepping rotations of encryption rotors (by adding extra wheels).  Hacking the cipher was especially difficult. <br><br><img src="https://habrastorage.org/files/791/0e3/3f6/7910e33f64564bca93094ba7166c2478.jpg"><br><br><a name="habracut"></a>  The development of the NEMA machine took place from 1941 to 1943 by a team of specialists led by Bernese teacher Arthur Alder (Captain Arthur Alder).  The developers included: analytic mathematics teacher Hugo Hadwiger (Hugo Hadwiger), professor of mathematics Heinrich Emile Weber (Heinrich Emil Weber) and Paul Glur (Paul Glur). <br><br>  The first prototype of NEMA was presented at the beginning of 1944, but it received approval only a year later (after making several modifications and improvements).  In 1946, began the production of machines.  And the model was commissioned only in 1947, which was somewhat late for military affairs.  NEMA was used by the Swiss army and the Ministry of Foreign Affairs (Diplomatic Service) in the post-war years, until it was replaced by more advanced encryption devices, such as Hagelin and Gretag. <br><br>  NEMA in detail: <br><br><img src="https://habrastorage.org/files/2c1/561/37d/2c156137d10447fdbbfb621971ef3ba7.jpg"><br><br><img src="https://habrastorage.org/files/857/958/556/857958556a5c40a193361bc71e677aa6.jpg"><br><br><img src="https://habrastorage.org/files/b5e/fc9/099/b5efc9099fb7497794195cdb96427ac5.jpg"><br><br><img src="https://habrastorage.org/files/af3/e83/d8c/af3e83d8ca274c449970b09ce0d88637.jpg"><br><br><img src="https://habrastorage.org/files/8fe/818/a74/8fe818a74c3a47219ab25dda7341becc.jpg"><br><br><img src="https://habrastorage.org/files/5fc/f06/280/5fcf06280cc848f686209c780b471c12.jpg"><br><br><h4>  Control </h4><br>  NEMA was in a black metal case-suitcase with a leather belt for carrying and a cylindrical lock on one side.  In the upper case cover there were all the necessary and additional components, such as a panel with light bulbs, a power cable, additional rotors and other accessories. <br><br>  Detailed diagram of the NEMA machine: <br><br><img src="https://habrastorage.org/files/1d3/7f6/79d/1d37f679d0ed4c8eb98b5848aee78a92.png"><br><br><h4>  NEMA Models </h4><br>  The NEMA encryption machine was made in three basic types of models: Training, Military and Machines of the Ministry of Foreign Affairs.  Despite the external identity and similarity of most of the operations of these models, some significant differences made the machines opposite in action. <br><br><h5>  Training machine </h5><br>  This model was used to train operators.  To avoid the risk of leakage of data about the machine and the principles of its operation, the training sample differed from the actual military model.  Most of the surviving NEMA is of this type, since they have been used for training for a long time and intensively.  In German, the model is known as Schulmaschine (from German - a school car).  The sample has a label: <br><br>  <i>Nur f√ºr Schulen und Kurse abgeben</i> <i><br></i>  <i>A remettre uniquement aux √©coles et cours</i> <i><br></i>  <i>A solo uso di scuole e corsi</i> <br><br><h5>  War machine </h5><br>  This model has long been kept secret.  Military samples were slightly different in operations, had additional rotors (E and F), which were located in cylindrical containers in the housing cover.  And the markings on the stepped rotors differed.  Since NEMA was created after the war, it was only occasionally used for testing and remained in stock for many years.  In German, this machine is known as Kriegsmobilmachungs-Maschine or K-Mob-Maschine.  The military model NEMA is a very rare instance, which can be recognized by the label: <br><br>  <i>Nur bei Kriegsmobilmachung abgeben!</i> <i><br></i>  <i>Ne d√©livrer qu'en cas de mobilisation de guerre!</i> <i><br></i>  <i>Da consegn.</i>  <i>solo in caso di mobilitazione di guerra!</i> <br><br><h5>  Ministry of Foreign Affairs machine </h5><br>  This version of NEMA was used exclusively by the Swiss Ministry of Foreign Affairs (Diplomatic Service).  As far as is known, the cars of this model have never shown to the public.  But it was found that the "diplomatic" NEMA were produced with different stepped rotors and discs, as well as a differently tuned stepped mechanism. <br><br><h4>  Principle of operation </h4><br>  The work of NEMA was a lot like the work of Enigma.  Only in the Swiss car there was no switching panel.  Instead, the number of grooves on the rotors was increased.  When you press a key on the keyboard, the circuit closes.  From a 4.5V battery, the current passed through various circuits and, as a result, turned on one of a set of light bulbs representing the desired code letter.  The constant change of the electrical circuit made it possible to create a multi-alphabet substitution cipher.  This made it more stable and reliable.  Unlike Enigma, NEMA‚Äôs rotor movement mechanism was more complex. <br><br><img src="https://habrastorage.org/files/7a8/785/4df/7a87854df63c4586948deb5b74552b45.png"><br><br>  In NEMA, a reflector was used to connect a pair of wires together.  Its presence guaranteed involution, that is, that decryption was the same as encryption. <br><br>  For a more detailed study of the operation of the 10 NEMA coding rotors, it was necessary to raise the hinge cover (to the left of the yellow label).  The current flowed to the disks through an input rotor (ETW), one that is red.  All discs were marked - yellow letters of the alphabet. <br><br><img src="https://habrastorage.org/files/bc4/ecd/819/bc4ecd819bb14545a0f962cf0f9e7e44.jpg"><br><br>  The extreme disk on the right is a reflector (UKW), used as a reflector and consisted of 26 static contacts.  Between the reflector and the input rotor were four pairs of intermediate discs.  Each pair consisted of an electric coding rotor with 26 contacts on both sides and a mechanical wheel that controlled the movement of the rotor.  Each electric disk could be combined with any of the stepped rotors.  Pin and flat contacts corresponded to the letters in the alphabet.  In contact, the contacts of neighboring rotors closed the electrical circuit.  Inside the rotor, each pin contact was connected to one of the flat.  Each rotor had its own order of connection. <br><br><img src="https://habrastorage.org/files/f81/986/e86/f81986e869bf4ac4b3c0aa3467e68f45.jpg"><br><br>  The red lever was used to move the rotors. <br><br><img src="https://habrastorage.org/files/ac3/fb8/4c6/ac3fb84c61ea48ef8e5e6fd5ee0f234a.jpg"><br><br>  After opening the lid, the lever had to be pushed all the way. <br><br><img src="https://habrastorage.org/files/7f2/529/072/7f25290723f040d2be5afa114d954d14.jpg"><br><br>  A drum with pairs of rotors could be pulled out of the NEMA.  With the exception of the input rotor, which was fixed and remained in the car. <br><br><img src="https://habrastorage.org/files/4b3/b0d/248/4b3b0d248e734202914051efedc0330c.jpg"><br><br><img src="https://habrastorage.org/files/81f/f6b/7c3/81ff6b7c3e0742ebaef3d24a98edb52b.jpg"><br><br>  In addition to the input, all the rotors are located on the spindle. <br><br><img src="https://habrastorage.org/files/2ac/d6d/e40/2acd6de404d248228ad519f1f393f3fd.jpg"><br><br>  Rotor disassembled: <br><br><img src="https://habrastorage.org/files/198/84e/dc0/19884edc0bfb469191e22a21ba3b6458.jpg"><br><br><h4>  Step motion of rotors </h4><br>  The stepped motion of the NEMA rotors occurred in a complex pattern.  The rotors were moved using narrow and wide spindles and dogs.  Upward movement of the rotor moved one step.  As a result, it moved only backwards ( <b>Z ‚Üí Y ‚Üí X ‚Üí W</b> , etc.). <br><br><img src="https://habrastorage.org/files/214/ca3/662/214ca36628c24879b5afa888786505a9.png"><br><br>  As an additional level of complexity, four adjustment screws were used in the design. <br><br><img src="https://habrastorage.org/files/c5a/415/9a8/c5a4159a8ae04192b46f632699ef064c.png"><br><br>  Adjustment of such screws required special tools and training.  This configuration was used by military vehicles. <br><br><h4>  Key to cipher </h4><br>  Selecting the key to the NEMA cipher, it was necessary to consider the internal and foreign keys.  The internal key determined which stepped rotors are connected to the encryption disks.  For example: <br><br>  <b>15-C / 12-A / 14-D / 13-B</b> <br><br>  The foreign key determined the initial position of the rotor at the beginning of the message.  For example: <br><br>  <b>BXLRRTVYLZ</b> <br><br>  The initial position changed after moving the lever to the left to the very last position.  It was possible to move all ten rotors back and forth, selecting the desired key. <br><br>  Most of the keys were stored only for a while (usually about a day).  For new messages, new rotor initial positions were also set.  They did this in order to secure the cipher as much as possible.  After all, in the presence of a sufficient number of messages sent with identical settings, a competent cryptanalyst (in addition, he carefully studied several messages) could use a frequency analysis to select a cipher for the messages.  It is worth remembering the principle of the initialization vector, where a similar idea was used.  The initial positions were sent along with the cryptogram, in front of the cipher text.  This principle was called the ‚Äúindicator procedure‚Äù.  Actually, these weaknesses helped to succeed with hacking into the Enigma code. <br><br>  The rotor produced a fairly simple type of encryption: the elementary replacement cipher, in which the elements of the original plaintext were replaced with cipher text in accordance with the requirements. <br><br>  Counting the total number of possible starting positions was relatively simple.  If a military machine was taken, then 6 cipher rotors (AF) were coming out of which 4 were in the car.  The output was 360 possible combinations of rotors <b>(6 √ó 5 √ó 4 √ó 3)</b> .  The same thing happened with stepped rotors (360 variations).  The calculation of the total number of possible starting positions for the 10 rotors was <b>26 <sup>10</sup></b> . <br><br>  The total number of possible settings was calculated by the formula: <br><br>  <b>360 √ó 360 √ó 26 <sup>10</sup></b> , <br><br>  which in total approximately gave: <br><br>  <b>12,359,619,140,000,000,000</b> <br><br><img src="https://habrastorage.org/files/91a/3bb/367/91a3bb3676fc4f809abf14bbf80c98ae.png"><br><br>  Encryption and decryption of messages on NEMA could be spelled using the lamp panel, which, if necessary, was connected to the machine. <br><br><img src="https://habrastorage.org/files/388/e2f/405/388e2f405bc740f7b433afd3dc57ab37.jpg"><br><br>  On July 9, 1992, the NEMA encryption machine was officially declassified.  A few years later, on May 4, 1994, training and operational NEMAs were put up for sale.  As a result, the models have expanded the ranks of acquisitions by collectors of encryption machines. </div><p>Source: <a href="https://habr.com/ru/post/275529/">https://habr.com/ru/post/275529/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275517/index.html">AnyConnect and Address Space Intersection</a></li>
<li><a href="../275519/index.html">Icons in the bookmarks bar and the weight of everything in the assembly Vivaldi 1.0.375.3</a></li>
<li><a href="../275521/index.html">Mocks, fakes and stubs in C ++</a></li>
<li><a href="../275525/index.html">Corporate Laboratories 2016 - practical training in the field of information security</a></li>
<li><a href="../275527/index.html">What should we build the Zhegalkin polynomial ...</a></li>
<li><a href="../275531/index.html">Translation of "Simplified JavaScript Jargon"</a></li>
<li><a href="../275535/index.html">Monitoring uninterruptible power supply ippon winner 3000 using apcupsd + Zabbix in Ubuntu</a></li>
<li><a href="../275539/index.html">Why is HTTPS not commonly used yet?</a></li>
<li><a href="../275541/index.html">2 ^ 74207281-1 - a prime number</a></li>
<li><a href="../275545/index.html">New interface for getting process attributes in Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>