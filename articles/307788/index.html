<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The killer bug. Figak, figak and Therac-25</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The program code began to kill people with the help of machines back in 1985. 



 A typical single therapeutic dose of radiation is up to 200 rad . 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The killer bug. Figak, figak and Therac-25</h1><div class="post__text post__text-html js-mediator-article">  The program code began to kill people with the help of machines back in 1985. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/244/e65/c6d/244e65c6d46662cfa686711a0351252e.jpg"><br><br>  A typical single therapeutic dose of radiation is up to 200 <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D0%25B4_(%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B8%25D1%2586%25D0%25B0_%25D0%25B8%25D0%25B7%25D0%25BC%25D0%25B5%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F)">rad</a> . <br>  1000 glad - lethal dose.  Risen car figachila defenseless earthlings 20 000 happy. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Consider the case when the phased, but not consistent implementation of software improvements has led to a system error.  The worst software bug ever. <br><br><blockquote>  <em>In Therac-25, hardware protection was removed and security functions were assigned to the software.</em> </blockquote><br>  How was the investigation carried out? What designers of IT systems, programmers, testers should do to avoid such things. <br><a name="habracut"></a><br><h2>  Killer </h2><br>  Therac-25 is a radiation therapy device, a medical accelerator created by Canadian government organization Atomic Energy of Canada Limited. <br><br><img src="https://habrastorage.org/files/68e/764/4a4/68e7644a469049e29be3482f16dd24bd.jpg"><br><br><img src="https://habrastorage.org/files/87c/81b/acf/87c81bacf3e34a49b594fd6f84e5f7c7.jpg"><br><br>  Advertising apparatus for housewives. <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/88604078" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Murder </h2><br>  From June 1985 to January 1987, this device caused six overdoses of radiation, some patients received doses of tens of thousands of rad.  At least two died directly from overdose. <br><br><blockquote>  The nurse remembered that that day she replaced ‚Äúx‚Äù with ‚Äúe‚Äù.  It turned out that if it was done quickly enough, overexposure happened with almost 100 percent probability. </blockquote><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/96c/b82/58d/96cb8258dfbfe1ace1d81e4da55bf7a9.jpg"></div><br><br><h2>  Investigation </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/432/d41/14e/432d4114ed4320ec203cc2e85a0587ae.jpg" align="left">  While litigating against AECL, the Texas State Attorney‚Äôs Office turned to <a href="https://en.wikipedia.org/wiki/Nancy_Leveson">Nancy Liveson</a> (a computer science professor at the University of California, Irvine) as an expert to investigate.  She made a significant contribution to computer security.  For three years, Nancy and Clark Turner have been collecting materials and reconstructing Therac-25 events.  This result is important because in most security incidents the information is incomplete, contradictory and incorrect. <br><br>  The Canadian state organization Atomic Energy of Canada Limited (hereinafter AECL) has released three versions: Therac-6, Therac-20 and Therac-25.  6 and 20 were produced in conjunction with the French company CGR.  The partnership ended before the design of Therac-25, but both companies still had access to the projects and source codes of the earlier models. <br><br>  The program code in Therac-20 was based on Therac-6 code.  A <a href="https://ru.wikipedia.org/wiki/PDP-11">PDP-11</a> computer was installed on all three devices.  Previous models did not need it, since they were designed as stand-alone devices.  The radiation therapy technician set up various parameters <strong>manually</strong> , including the position of the rotary dial to adjust the operating mode of the device. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/cf2/3a8/c7c/cf23a8c7cd1d47728676f1adea181021.jpg"></div><br>  In electronic mode, the deflection magnets distribute the beam so that the electrons cover a large area.  In the X-ray mode, the target was located in the path of the radiation, electrons struck at it to produce x-ray photons aimed at the patient.  Finally, a reflector could be placed in the path of the accelerator, with which the X-ray technician could direct radiation precisely at the sore spot.  If the reflector was on the way, the electron beam did not start. <br><br>  On Therac-6 and 20, the hardware locking mechanisms did not allow the operator to do something dangerous, say, to choose a high-power electron beam without an X-ray target in place. <br><br>  An attempt to activate the accelerator in the wrong mode led to the opening of the fuses and stopping the operation.  PDP-11 and related equipment were built for convenience.  A technician could enter a recipe into the VT-100 terminal, and the computer, using servos, automatically set up the rotary disk and other devices. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/45f/fd9/06c/45ffd906cd3e425989dce623857c956e.jpg"></div><br>  The hospital staff liked the computer to set things up faster than people.  The less time it took to set up, the more patients could be taken in a day. <br><br>  When it came time to make Therac-25, AECL decided to <strong>leave only computer control</strong> .  They abandoned manual control devices and hardware locking mechanisms.  The computer had to monitor the device settings and, in the event of a problem, should turn off the power of the entire machine. <br><br>  Oh well. <br><br>  At least four errors were found in Therac-25 software that could lead to overexposure. <br><br><ul><li>  The same variable was used both to analyze the entered numbers and to determine the position of the turntable.  Therefore, when quickly entering data through a terminal, the Therac-25 could deal with the wrong position of the turntable ( <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BE%25D1%2581%25D1%2582%25D0%25BE%25D1%258F%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B3%25D0%25BE%25D0%25BD%25D0%25BA%25D0%25B8">race condition</a> ). <br><br></li><li>  Setting the position of the deflection magnets takes about 8 seconds.  If during this time the parameters of the type and radiation power were changed, and the cursor was set to the final position, the system did not detect changes. <br><br></li><li>  The division by the amount of radiation, which in some cases leads to a division error by zero and a corresponding increase in the amount of exposure to the maximum possible. <br><br></li><li>  Setting the boolean variable (single-byte) to the value ‚Äútrue‚Äù was performed with the command ‚Äúx = x + 1‚Äù.  Therefore, with a probability of 1/256, when the ‚ÄúSet‚Äù button was pressed, the program could skip information about the incorrect position of the disk. </li></ul><br>  Potential errors were identified - there was no synchronization in the multitasking operating system. <br><br><h2>  Fixes </h2><br><ul><li>  All interruptions related to the dosimetry system stopped the procedure, rather than paused it.  The operator was required to re-enter all parameters. </li><li>  Added one-click software shutdown. </li><li>  Added one-click independent hardware shutdown. </li><li>  The coded error messages were replaced by meaningful ones and the current exposure level was displayed on the screen. </li><li>  Added a potentiometer that determines the position of the rotary dial. </li><li>  Changing the position of the disk and other parts of the device is now possible only when the operator holds a special pedal (deadman switch). </li><li>  In the X-ray therapy mode, the diverting magnets for electronic therapy are set to such a configuration that the electron beam is deflected 270 ¬∞. </li></ul><br><div class="spoiler">  <b class="spoiler_title">full list of corrections in English</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/44c/2ce/2cf/44c2ce2cf7fb48d8a8d3ed9041ae34af.jpg"><br>  [source - Nancy G. Leveson, <a href="http://sunnyday.mit.edu/papers/therac.pdf">Therac-25 Accidents</a> ] <br></div></div><br><br>  The manufacturer reported that the software and hardware have been tested for many years.  However, during the trial it turned out that the software was checked by the minimum number of tests on the simulator, and most of the time the entire system was tested.  Thus, unit testing was neglected, and only integration testing was performed. <br><br>  It was a naive assumption that reusing a code or a boxed product would increase the security of the software due to the duration of their successful application.  Code reuse does not guarantee the safety of the module in the new system, since its design has its own characteristics.  Rewriting from scratch allows you to get a simpler and more transparent system, and as a result, a safer one. <br><br>  In this case, there was a reuse of code with Therac-6 and Therac-20.  In Therac-6 there was no X-ray therapy at all, in Therac-20 a mechanical interlock was used. <br><br>  After accidents, the Therac-25 <a href="https://ru.wikipedia.org/wiki/Food_and_Drug_Administration">FDA</a> changed its attitude to the many problems of safety-related systems, and especially in relation to software.  As a result, the FDA launched a process to improve its procedures, guidelines, and reporting systems, and incorporated software into them.  This lesson was important not only for the FDA, but also for all industrial safety-critical systems. <br><br><h2>  More about Therac-25 </h2><br><ul><li>  <a href="https://www.reddit.com/r/programming/comments/mzht1/my_professor_investigated_the_therac25_incident/">He was investigated by the prosecution.</a>  <a href="https://www.reddit.com/r/programming/comments/mzht1/my_professor_investigated_the_therac25_incident/">Got any questions for me to ask him?</a> </li><li>  <a href="https://www.quora.com/What-is-the-name-of-the-programmer-who-wrote-the-Therac-25-software">What is the programmer who wrote the Therac-25 software?</a> </li><li>  <a href="https://www.amazon.com/Fatal-Defect-Chasing-Killer-Computer/dp/0679740279/">Fatal Defect: Chasing Killer Computer Bugs</a> </li><li>  Nancy Leveson, Clark S. Turner <a href="http://courses.cs.vt.edu/cs3604/lib/Therac_25/Therac_1.html">An Investigation of the Therac-25 Accidents</a> </li><li>  Nancy G. Leveson, <a href="http://sunnyday.mit.edu/papers/therac.pdf">Therac-25 Accidents</a> </li><li>  Nancy G. Leveson <a href="https://www.amazon.com/Safeware-Computers-Nancy-G-Leveson/dp/0201119722">Safeware: System Safety and Computer</a> </li><li>  <a href="http://www.fda.gov/MedicalDevices/ProductsandMedicalProcedures/GeneralHospitalDevicesandSupplies/InfusionPumps/ucm202511.htm">Infusion Pump Software Safety Research at FDA</a> </li></ul><br><h2>  Conclusion </h2><br>  The Software Engineering Institute speaks of an average of 1 bug for every 100 lines of code and 98% of cases of device malfunctions caused by bugs in software could easily have been avoided with proper code testing.  Knowing this, I want to join the movement " <a href="https://habrahabr.ru/post/135554/">give the code a look</a> ."  It seems that measures have been taken after high-profile cases, but still I don‚Äôt really want to run into a drill, where in the variable responsible for the angular velocity, they ‚Äúgot it wrong‚Äù.  Dear testers (programmers, developers), do your job well. <br><br><h2>  UPD </h2><br>  The University of California, Berkeley: Computer Science 61A - Lecture 35: Therac-25 <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/nxX-aAvZbmM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/307788/">https://habr.com/ru/post/307788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307778/index.html">Record time: how we increased the launch speed of Mail.Ru Mail application on iOS</a></li>
<li><a href="../307780/index.html">Breaking Equation Group: Stuxnet, Duqu and Flame creator files are sold at auction</a></li>
<li><a href="../307782/index.html">Integration of Ultima 2C and Ebay. Personal experience</a></li>
<li><a href="../307784/index.html">How to check website availability online? Service overview HostTracker. Part 2</a></li>
<li><a href="../307786/index.html">Waiting for Linux version: checking the code of the graphical editor Inkscape</a></li>
<li><a href="../307790/index.html">The first post on Habr√© or Why we are engaged in clouds</a></li>
<li><a href="../307792/index.html">Known cyber-grouping Equation Group could undergo large-scale hacking</a></li>
<li><a href="../307794/index.html">Static code testing for vulnerabilities: what should be the ideal analyzer?</a></li>
<li><a href="../307796/index.html">Learning English with cards</a></li>
<li><a href="../307798/index.html">Android string.xml - a few things to remember</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>