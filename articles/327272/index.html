<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúCryptography in blockchains‚Äù: about hash functions, keys and digital signatures</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cryptography is the heart of the blockchain, which ensures the operation of the system. The architecture of the blockchain assumes that trust between ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúCryptography in blockchains‚Äù: about hash functions, keys and digital signatures</h1><div class="post__text post__text-html js-mediator-article">  Cryptography is the heart of the blockchain, which ensures the operation of the system.  The architecture of the blockchain assumes that trust between the participants of the network is based on the principles of mathematics and economics, that is, it is formalized.  Cryptography also guarantees security, moreover, based on the transparency and verifiability of all operations, and not on the industry's traditional system visibility limit (perimeter security). <br><br>  Various cryptographic techniques guarantee the immutability of the blockchain's transaction log, solve the authentication task, and control access to the network and data in the blockchain as a whole.  In today's article we will talk about hash functions, keys and digital signatures. <br><br> <a href="https://habrahabr.ru/company/bitfury/blog/327272/"><img src="https://habrastorage.org/files/ce0/ad7/221/ce0ad7221b8b40ce976fe6acce06da8d.jpg"></a> <a name="habracut"></a><br>  <i>/ image <a href="https://www.flickr.com/photos/btckeychain/14253586736/">BTC Keychain</a> <a href="https://creativecommons.org/licenses/by/2.0/">CC</a></i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Hash functions </h2><br>  Hashing is the process of converting an input array of arbitrary length into a (output) bit string of fixed length.  For example, a hash function can take a string with any number of characters (one letter or a whole literary work), and at the output to get a string with a strictly defined number of characters (digest). <br><br>  Hash functions are available in almost any programming language.  For example, they are used to implement hash tables and sets (HashMap / HashSet in Java, dict and set in Python, Map, Set and objects in JavaScript, and so on).  A separate category of hash functions is <a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">cryptographic hash functions</a> .  They are subject to significantly more stringent requirements than to the functions commonly used in hash tables.  Therefore, they are used in more "serious" cases, for example <a href="http://security.blogoverflow.com/2013/09/about-secure-password-hashing/">for storing passwords</a> .  Cryptographic hash functions are developed and thoroughly tested by researchers around the world. <br><br>  You can experiment with hash functions by writing a simple Python program: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> hashlib <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hash_hex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(message)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hashlib.sha256(message.encode()).hexdigest()</code> </pre> <br>  The hash_hex () function calculates the hash representation in hexadecimal for a string.  In the above example, the function SHA-256 is used - the same as in Bitcoin. <br><br>  A good hash function provides protection against collisions (it is impossible to get two identical hashes with different initial data) and has a so <a href="http://crypto.stackexchange.com/questions/40268/hash-functions-and-the-avalanche-effect">-called</a> avalanche effect, when the slightest change in input data significantly converts the output value.  The avalanche effect in the SHA-256 hash function is as follows: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>hash_hex(<span class="hljs-string"><span class="hljs-string">'Blockchain'</span></span>) <span class="hljs-string"><span class="hljs-string">'625da44e4eaf58d61cf048d168aa6f5e492dea166d8bb54ec06c30de07db57e1'</span></span> &gt;&gt;&gt; hash_hex(<span class="hljs-string"><span class="hljs-string">'blockchain'</span></span>) <span class="hljs-string"><span class="hljs-string">'ef7797e13d3a75526946a3bcf00daec9fc9c9c4d51ddc7cc5df888f74dd434d1'</span></span> &gt;&gt;&gt; hash_hex(<span class="hljs-string"><span class="hljs-string">'Bl0ckchain'</span></span>) <span class="hljs-string"><span class="hljs-string">'511429398e2213603f4e5dd3fff1f989447c52162b0e0a28fe049288359220fc'</span></span></code> </pre> <br>  Hash functions in blockchains guarantee the ‚Äúirreversibility‚Äù of the entire chain of transactions.  The fact is that each new transaction block refers to the hash of the previous block in the registry.  The hash of the block itself depends on all transactions in the block, but instead of sequentially passing the transaction to the hash functions, they are collected into one hash value using a binary tree with hashes (Merkle tree).  Thus, hashes are used as a replacement for pointers in ordinary data structures: linked lists and binary trees. <br><br>  Through the use of hashes, the general state of the blockchain ‚Äî all transactions ever performed and their sequence ‚Äî can be expressed in one single number: the hash of the newest block.  Therefore, the property of the immutability of the hash of one block guarantees the immutability of the entire blockchain. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/329/8fe/08e/3298fe08e2724d46a7f3dbc01a9ecec3.png" width="500"></div><br>  Below is the recursive implementation of the Merkle tree used in Bitcoin in Python (see the <a href="https://gist.github.com/anonymous/7eb080a67398f648c1709e41890f8c44">link for</a> examples of work).  The input of the function is a list of transaction hashes.  At each stage of the calculation, successive pairs of hashes are glued together using a hash function;  if the hashes are an odd number, the latter is duplicated.  As a result, the only hash remains, which is the final hash value for the entire list. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> hashlib <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">merkle_root</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lst)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#        SHA-256   #  . ,    . sha256d = lambda x: hashlib.sha256(hashlib.sha256(x).digest()).digest() hash_pair = lambda x, y: sha256d(x[::-1] + y[::-1])[::-1] if len(lst) == 1: return lst[0] #         - # ,           . #         , #    : # https://github.com/bitcoin/bitcoin/blob/master/src/consensus/merkle.cpp#L9 if len(lst) % 2 == 1: lst.append(lst[-1]) return merkle_root([ hash_pair(x, y) for x, y in zip(*[iter(lst)] * 2) ])</span></span></code> </pre><br>  Hash trees have many uses besides blockchains.  They are used <a href="https://blogs.oracle.com/bonwick/entry/zfs_end_to_end_data">in file systems</a> to verify the integrity of files <a href="https://wiki.apache.org/cassandra/AntiEntropy">distributed by databases</a> for quick synchronization of copies and <a href="http://certificate-transparency.org/">in key management</a> for reliable journaling of certificate issuance.  Git uses hash-tree generalization - hash-based directed acyclic graphs.  In the blockchain, the use of hash trees is dictated by performance considerations, since they make possible the <a href="https://bitcoin.org/en/developer-guide">existence of</a> ‚Äúlight clients‚Äù who process only a small part of blockchain transactions. <br><br><h2>  Digital signatures </h2><br>  Digital signatures in blockchains are based on public key cryptography.  It uses two keys.  The first one ‚Äî the private key ‚Äî is needed to generate digital signatures and is kept secret.  The second, the public key, is used to verify the electronic signature.  It is realistic to calculate the public key on the basis of the private key, but the inverse transformation requires an amount of computation impossible in practice that is comparable to brute force. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b14/251/150/b142511505214997bffe44cd1429230f.png" width="500"></div><br>  There are many different public key cryptography schemes.  The two most popular of them are <a href="https://ru.wikipedia.org/wiki/RSA">schemes</a> based on factorization (RSA) and <a href="https://en.wikipedia.org/wiki/Elliptic_curve_cryptography">schemes</a> based on elliptic curves.  The latter are more popular in blockchains because of the smaller size of keys and signatures.  For example, in Bitcoin, the <a href="https://ru.wikipedia.org/wiki/ECDSA">standard of</a> elliptic cryptography ECDSA is used together with the elliptic curve secp256k1.  In it, the private key is 32 bytes in length, the open one is 33 bytes, and the signature is about 70 bytes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8b0/90d/f80/8b090df80f974935a441842f0927f625.png" width="500"></div><br>  The general idea of ‚Äã‚Äãpublic key signatures is as follows.  Suppose Alice wants to translate one bitcoin to Bob.  To do this, she forms a transaction, where she writes down where it should be taken from (indicating the previous transaction in which Alice received Bitcoin from someone else) and to whom to send (Bob‚Äôs public key).  Alice knows Bob‚Äôs public key from third-party sources ‚Äî Bob can send it to Alice via an instant messenger or even publish it on the site. <br><br>  Alice then signs the transaction using her private key.  Any node in the bitcoin network can verify that the transaction is signed by a specific public key (authentication) with which one bitcoin (authorization) was associated with the transaction.  If these conditions are met, then the translated bitcoin begins to be associated with the public key of Bob. <br><br>  Since there is no central node in the blockchain that can authorize arbitrary transactions, the security of the system becomes decentralized, and the probability of successful intervention in the work of the blockchain is reduced to almost zero. <br><br>  Thus, the blockchain uses digital signatures to authenticate and ensure the integrity of transactions (and sometimes blocks).  In the case of cryptocurrency, the authentication process means that only the person to whom they were sent by another, earlier transaction can spend the funds.  The peculiarity of the blockchain is that the authentication information is ‚Äúembedded‚Äù in each transaction, and not separated from the business logic, so the blockchain is considered more secure.  In a conventional system, you can hack or administratively bypass the authentication mechanism and manipulate the backend, but in the blockchain, this cannot be done by definition. <br><br><hr><br>  <i>PS In our next posts, we plan to touch on such things as smart contracts and consensus algorithms, and also talk about what the spread of quantum computers for the blockchain will mean</i> . <br><br>  PPS Some additional sources: <br><br><ul><li>  <a href="http://bitfury.com/blog">Our English blog</a> </li></ul><br><ul><li>  <a href="https://habrahabr.ru/company/bitfury/blog/326340/">‚ÄúWhat are they eating?‚Äù: What is a blockchain?</a> </li><li>  <a href="http://bitfury.com/content/5-white-papers-research/pos-vs-pow-1.0.2.pdf">Proof of share and proof of work (PoS vs PoW)</a> </li><li>  <a href="http://bitfury.com/content/5-white-papers-research/contracts-1.1.1.pdf">Smart contracts in bitcoin blockchain</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/327272/">https://habr.com/ru/post/327272/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327260/index.html">How Google Cloud protects its data centers from cybercriminals and internal errors</a></li>
<li><a href="../327262/index.html">UIKit + Viper or MVC healthy person</a></li>
<li><a href="../327264/index.html">Everything is bad</a></li>
<li><a href="../327266/index.html">How to beat groundhog day ‚Üí Automate testing of the KOMPAS-3D v17 interface</a></li>
<li><a href="../327270/index.html">Hacksplaining - an online course on web vulnerabilities</a></li>
<li><a href="../327274/index.html">Development of an accelerated BBC News homepage</a></li>
<li><a href="../327276/index.html">Open access to HighLoad ++ video over the past five years</a></li>
<li><a href="../327280/index.html">Sending voice messages VKontakte using VK API</a></li>
<li><a href="../327282/index.html">Capacity management is another problem.</a></li>
<li><a href="../327284/index.html">New mobile banking on Google Play - now disguised as a flashlight application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>