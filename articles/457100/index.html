<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AWS Lambda - theory, familiarity</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A quick tour of AWS Lambda 
 What is it? 
 AWS Lambda: This is a computational service that allows you to run code for almost any type of application ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AWS Lambda - theory, familiarity</h1><div class="post__text post__text-html js-mediator-article"><h2>  A quick tour of AWS Lambda </h2><br><h3>  What is it? </h3><br>  <b>AWS Lambda:</b> This is a computational service that allows you to run code for almost any type of application or server service ‚Äî all without the need for administration.  AWS Lambda performs all the administration for you, including server and operating system maintenance, resource allocation and automatic scaling, code monitoring and logging.  All you have to do is provide your code in one of the languages ‚Äã‚Äãthat AWS Lambda supports. <br><br><h3>  Why use it? </h3><br><ul><li>  <b>Money.</b>  You only pay for the time when the service is running. </li><li>  <b>Speed.</b>  By itself, lambda rises and works very quickly. </li><li>  <b>Convenience.</b>  Lambda has many capabilities to integrate with AWS services. </li><li>  <b>Performance.</b>  In parallel, it can be performed, depending on the region with a maximum of 1000 to 3000 copies.  And if you wish, this limit can be raised by writing in support. </li></ul><br><blockquote>  This approach has its drawbacks, you can not control the operating system on which the code is running, you can not control the CPU, memory and resources.  AWS does all this. <br><br>  All you can do is choose a language from the AWS Lambda supported. </blockquote><br><h2>  What can? </h2><br>  <b>Below is a brief list of the main features of AWS Lambda.</b>  <b>Next, we consider everything in order.</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/lk/ke/ur/lkkeurxtlx9itiqksndcmjbn2rq.png"><br><a name="habracut"></a><br><h3>  1. Triggers </h3><br>  <b>Triggers</b> are the ‚Äúpathogens‚Äù of lambda.  In some ways, lambda can be compared to PHP, in the sense that for us it <a href="https://habr.com/ru/post/179399/">is executed and dies</a> .  Next, we consider in detail the mechanism of work.  While you need to understand that lambda, this is one function that is performed on request from triggers. <br><br>  <b>Below is a list of all possible triggers:</b> <br><br>  API Gateway <br>  AWS IoT <br>  Alexa Skills Kit <br>  Alexa Smart Home <br>  Application load balancer <br>  Cloudfront <br>  CloudWatch Events <br>  CloudWatch Logs <br>  Codecommit <br>  Cognito Sync Trigger <br>  DynamoDB <br>  Kinesis <br>  S3 <br>  SNS <br>  SQS <br><br>  For each of them, you will need to configure the unique parameters that are available for these triggers.  You can also configure multiple triggers for one lambda.  It depends on the type of trigger whether lambda will be executed synchronously or asynchronously. <br><blockquote>  <b>Notice:</b> Please note that the lambda can be made to run, and using the AWS CLI, AWS SDK in manual mode, passing all the necessary parameters.  Including whether it will be performed synchronously or not. </blockquote><br><h4>  Let's take an example: </h4><br>  <b>1. API Gateway</b> - allows you to pull the lambda on the http request and requires you to return the result to the user.  Such an operation cannot be performed asynchronously, since  requires an answer.  For synchronous operations, some functions are not available. <br><br>  <b>2. SQS</b> - for example, if our lambda processes messages from SQS, there is no need to return the result anywhere and it can be executed asynchronously.  With asynchronous execution, several new features appear, for example, we can configure re-execution in case of an error, or send such requests further to the dead <b>SQS</b> queue. <br><br><h3>  2. Permissions to AWS Services </h3><br>  These are AWS services to which lambda has access by default.  What does it mean?  In the function that you will write, you can always connect the AWS SDK and without keys or any authorization parameters you can use the available services.  All available services you define in <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html">IAM Role</a> that you use for this lambda. <br><br>  Each language in use has its own SDK that can communicate with the main AWS services. <br><blockquote>  <b>Notice:</b> for each lambda you configure the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html">IAM Role</a> on behalf of which lambda will run </blockquote><br><h3>  3. <a href="https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html">VPC</a> </h3><br>  You can set up a virtual network for your lambda, for example, to <a href="https://docs.aws.amazon.com/lambda/latest/dg/vpc-rds.html">connect securely</a> to <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Welcome.html">RDS</a> . <br><br><h3>  4. Online Editor </h3><br>  AWS Lambda also provides the ability to edit the code of your function directly from the interface in your browser. <br><br><img src="https://habrastorage.org/webt/yy/hs/4y/yyhs4ymw2tzhj7hrsb8glnpttfm.png"><br><br><h3>  5. Logging </h3><br>  All requests for lambda are logged in <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html">CloudWatch</a> , data on runtime and memory is also recorded there, this data can be very helpful in setting limits.  Also in the code it is possible to log your own data (for example, in Node.js via console.log). <br><br>  Additionally, you can always see statistics on the use of lambda on the tab <b>Monitoring</b> <br><br><h3>  6. Environment Variables </h3><br>  You have the ability to transfer environment variables to the code safely, which allows you to configure important parts of the system without delivering the code.  It is possible to <a href="https://docs.aws.amazon.com/lambda/latest/dg/env_variables.html">encrypt environment variables through keys.</a> <br><blockquote>  <b>Notice:</b> Please note that there is a list of <a href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-environment-variables.html">predefined</a> environment variables. </blockquote><br><h3>  7. Code </h3><br>  <b>Now the most interesting part, in itself lambda consists of several parts.</b> <br><br>  <b>1. <a href="https://docs.aws.amazon.com/lambda/latest/dg/configuration-layers.html">Layers</a></b> - the bottom layer.  It is not mandatory, but if you need to add some libraries to use the lambda, then you need to put them separately from the main code, so you greatly save on the amount of the main code and the speed of the function itself. <br><br>  The layers in AWS Lambda are somewhat similar to the <a href="https://medium.com/%40jessgreb01/digging-into-docker-layers-c22f948ed612">layers in the docker</a> , in the sense that they are permanents in relation to the function, and they need to be changed separately.  Also they can be reused in other lambdas. <br><br>  <b>2. Function Environment</b> - the code must necessarily contain a function that will be directly executed each time the lambda is started <b>(Handler)</b> .  About her below.  And in front of her is her entourage, which we ask.  The fact is that resource management occurs in such a way that this environment is stored separately from the function for some time after its completion.  And at the next start, it resumes, without wasting time and resources on initialization.  Thus, everything that is possible must be initialized to the function itself, for example, configuration, connection of libraries, etc. <br><br>  <b>3. Handler</b> - directly by itself the executable code, depending on the language, is determined in different ways.  For example, take Node.Js.  In order for your code to execute, you need: <br><br><ol><li>  js file - 1pcs </li><li>  exports.yourFunction = () =&gt; {// Your code} - 1pcs </li></ol><br>  By default, index.js runs and looks for a function in it called ‚Äúhandler‚Äù.  Then executes it.  Your function may be asynchronous in code.  This does not affect the synchronous execution of lambda. <br><br>  Below is a sample code, I will try to describe what is happening there: <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//AWS SDK  ,     e var AWS = require('aws-sdk'); //   //   ,    //   API Gateway. // ,    http  exports.handler = async(event, context) =&gt; { // event       // context     aws lambda : //   ,      console.log('testing cloud watch'); // ^       Cloud Watch   return { //     http ,     statusCode: 200, body: 'Hello world', headers: {} }; }; exports.handler = (event, context, callback) =&gt; { //    callback, // -      callback( null, //&lt;-  ,       { //     statusCode: 200, body: 'Hello world' } ); };</span></span></code> </pre> <br><h3>  8. Versioning </h3><br>  The service supports convenient versioning.  In short, we can issue a version of each downloaded copy.  And add aliases that point to some version.  How it works?  Look at the diagram below. <br><br><img src="https://habrastorage.org/webt/9n/m-/5r/9nm-5r9vatuospaqdnmjk_l5rys.png"><br><br><h3>  And so, now let's see what needs to be done to get what we see in the diagram. </h3><br><h4>  First condition </h4><br><ol><li>  Create the first version of our lambda.  Together with the first version, we create a pointer to the <b>"$ LATEST"</b> version.  It always indicates the latest version added. </li><li>  Add alias <b>"Dev"</b> .  Here we choose where to bind, we have several options - create a pointer to a specific version number, in our case <b>"1"</b> , bind the pointer to <b>"$ LATEST"</b> , or bind to another alias.  In this case, we attach to the <b>$ LATEST pointer</b> , and now our <b>‚ÄúDev‚Äù</b> alias will always point to the last branch, so we can always test our application with the latest version of lambda on our environment.  And if suddenly we need to check how it works on the old version, we just need to switch the alias in the trigger or change the link to the version of the alias without touching our application </li><li>  Add a <b>Stage</b> alias and attach it to the first version of our lambda </li><li>  Add the <b>‚ÄúProd‚Äù</b> alias and repeat what we did for the <b>‚ÄúStage‚Äù</b> </li></ol><br><blockquote>  <b>Notice:</b> <a href="https://docs.aws.amazon.com/lambda/latest/dg/versioning-aliases-walkthrough1.html">here</a> is how to work with aliases in practice.  The practical part of the lambda will be in the next article along with SQS </blockquote><br>  <b>And so, now we have received something incomprehensible, in fact 3 alias refer to one version, it is not clear.</b>  <b>But nothing, all in order</b> <br><br><h4>  Second state </h4><br><ol><li>  Create a second version of our lambda (It is possible to add a second output "Hello world").  Here I want to note that at this moment <b>"$ LATEST"</b> will immediately look at the second version.  And since <b>‚ÄúDev‚Äù is</b> tied to <b>"$ LATEST"</b> , it will also look at the second version. </li><li>  Next, we want our <b>‚ÄúStage‚Äù to</b> look at the second version.  Now it is tied to version <b>"1"</b> .  Here we need to manually change the version that <b>‚ÄúStage</b> ‚Äù points to. </li><li>  We are happy.  We got what we see as the second state on the graph.  That is, our <b>‚ÄúProd‚Äù</b> looks at the first version, and <b>‚ÄúDev‚Äù</b> and <b>‚ÄúStage‚Äù</b> at the second. </li></ol><br><h4>  Third state </h4><br>  Now, to get the third state, we just need to add a couple more lines to our code and there will be a third version of our lambda.  And <b>"Dev"</b> will look at her now. <br><br><h2>  We summarize </h2><br>  And so, what do we have? <br><br>  Small  Fast  Relatively cheap.  Autoscaled  Versioned  Function <br>  In this article we covered only the theoretical part, familiarity with this service.  As with <a href="https://habr.com/ru/post/457068/">SQS</a> in the last article.  In the next article we will look at how these two services interact with each other and in practical form we will learn how to configure and use them. </div><p>Source: <a href="https://habr.com/ru/post/457100/">https://habr.com/ru/post/457100/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457090/index.html">Security Cheat Sheets: JWT</a></li>
<li><a href="../457092/index.html">We study MITER ATT & CK. Mobile Matrices: Device Access. Part 5</a></li>
<li><a href="../457096/index.html">We free our hands to several analysts: API Livy to automate typical banking tasks</a></li>
<li><a href="../457098/index.html">Elegant JavaScript error handling with the Either monad</a></li>
<li><a href="../4571/index.html">"Soup" suffers from bad PR</a></li>
<li><a href="../457102/index.html">QVD files - what's inside, part 3</a></li>
<li><a href="../457106/index.html">The war with robo calls in the USA - who wins and why</a></li>
<li><a href="../457108/index.html">WWDC19: Getting Started with Test Plan for XCTest</a></li>
<li><a href="../45711/index.html">Evaluation of the effectiveness of advertising, and not only - correlation statistics</a></li>
<li><a href="../457110/index.html">Unit testing of C ++ and Mock Injection patterns using Traits</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>