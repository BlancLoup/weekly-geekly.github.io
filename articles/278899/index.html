<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We continue to accelerate the blog on WordPress - PHP7, ESI in Varnish, XtraDB, effective compression and shutdown of excess</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my previous article on optimizing a WordPress site, I talked about a very effective approach to optimizing through page caching. As a result, for n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We continue to accelerate the blog on WordPress - PHP7, ESI in Varnish, XtraDB, effective compression and shutdown of excess</h1><div class="post__text post__text-html js-mediator-article">  In my <a href="https://habrahabr.ru/post/278189/">previous article on optimizing a WordPress site,</a> I talked about a very effective approach to optimizing through page caching.  As a result, for non-logged-in users, the page waiting time by the client (excluding the TLS session establishment time) was reduced from <b>820 ms</b> to <b>30 ms</b> (this and all subsequent measurements were taken from a server located in the same city as my VDS), agree is an excellent indicator.  However, for logged-in users, page generation was still long ‚Äî an average of <b>770 ms</b> on the server.  In this part I will talk about how I reduced this time to <b>65 ms</b> , while fully preserving the functionality of the user functionality. <br><br>  The purpose of this and previous articles is my desire to show the possibility of optimizing websites not only on WordPress, but generally any web application.  Therefore, I use such a number of tools, and so I analyze their configuration in detail.  If you just need to speed up WordPress, install the WP Super Cache plugin.  If you, like me, are interested in technologies that allow you to optimize any site, and you are also interested in what should be taken into account when developing web applications designed for high loads - I ask for the cat, but only after reading the <a href="https://habrahabr.ru/post/278189/">first part</a> - I will be developing the same the system. <br><a name="habracut"></a><br><h2>  Turning off the excess </h2><br>  The recommendations in this section may seem trivial to many, but I promise you, the further we progress, the more interesting the points will be.  This item has led to a significant acceleration of the site, and I believe that this should be here. <br><br>  So, the average time for generating a dynamic page for a logged in user is <b>770 ms</b> .  The generation time was measured by adding lines to the index.php source: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs bash">&lt;?php <span class="hljs-variable"><span class="hljs-variable">$t</span></span> = microtime(1); // index.php <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;!-- : '</span></span> . (microtime(1) - <span class="hljs-variable"><span class="hljs-variable">$t</span></span>) . <span class="hljs-string"><span class="hljs-string">'s'</span></span> . <span class="hljs-string"><span class="hljs-string">'--&gt;'</span></span>; ?&gt;</code> </pre> <br>  Next, I conducted a preliminary stress test: 50 users simultaneously access a dynamically generated page as soon as the page loading is completed - the next request is right there. <br><br><img src="https://habrastorage.org/files/8b2/c3b/466/8b2c3b46641b4b1cb3ae319d9f8616c3.png"><br><br>  The maximum response time in this case was 45.721 seconds. <br><br>  We follow the popular advice in the WordPress optimizer circles, namely - disable unnecessary plugins.  In my blog, almost every article provides code / configuration listings.  For these purposes, I used the Crayon Syntax Highlighter plugin, recommended by almost every blogger as the best tool for syntax highlighting in listings.  However, the light itself was not so necessary for me, the main thing is a neatly decorated window with a scroll bar with tab support.  For testing purposes, I tried to disable this plugin.  The result - instead of <b>770 ms,</b> page generation occurred on average over <b>170 ms</b> , which <b>is 4.5 times faster</b> .  However, the listings were no longer decorated - the text of the articles merged with the code.  Further, in search of a replacement, I came across a wp-syntax plugin, which did not have such rich functionality as Crayon Syntax Highlighter, but with its main task - syntax highlighting, I coped with a bang.  The average time to generate a page with this plugin averaged <b>235 ms</b> , which is, in general, acceptable.  Here I re-conducted the stress test.  The results are as follows: <br><br><img src="https://habrastorage.org/files/5db/488/f26/5db488f2660b4cdabc0552ee140f6e6a.png"><br><br>  The maximum response time is now 9.897 seconds.  The difference is colossal. <br><br>  However, as I said above, the backlight was not so important to me.  Therefore, I decided to remove this plugin too, and instead, in the theme styles for the <b>&lt;pre&gt; tag</b> (it contained the code listings in the above-described plugins) to register the following styles: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">pre</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">max-height</span></span>: <span class="hljs-number"><span class="hljs-number">700px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin-bottom</span></span>: <span class="hljs-number"><span class="hljs-number">20px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">overflow</span></span>: auto; <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: <span class="hljs-number"><span class="hljs-number">#f0f0f0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">-webkit-box-shadow</span></span>: <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-number"><span class="hljs-number">3px</span></span> <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-built_in"><span class="hljs-built_in">rgba</span></span>(0,0,0,0.75); <span class="hljs-attribute"><span class="hljs-attribute">-moz-box-shadow</span></span>: <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-number"><span class="hljs-number">3px</span></span> <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-built_in"><span class="hljs-built_in">rgba</span></span>(0,0,0,0.75); <span class="hljs-attribute"><span class="hljs-attribute">box-shadow</span></span>: <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-number"><span class="hljs-number">3px</span></span> <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-built_in"><span class="hljs-built_in">rgba</span></span>(0,0,0,0.75); }</code> </pre> <br>  Listings took the following form: <br><br><img src="https://habrastorage.org/files/2cf/084/4e5/2cf0844e5df64566a98e66e61ab3d00b.png"><br><br>  That was enough for me.  The page generation time on the server is <b>170 ms</b> .  We carry out a stress test: <br><br><img src="https://habrastorage.org/files/863/f29/49e/863f2949e60e48aa88346136876fcc44.png"><br><br>  The maximum response time is now 7.002 seconds.  The difference is palpable, I leave this option. <br><br>  Next, I removed 2 widget from the footer - recent comments and a tag cloud.  By reducing the number of queries to the database, the average page generation time on the server was reduced to <b>155 ms</b> .  The results of the stress test lost, but the maximum response time was about 6.5 seconds. <br><br><h2>  Selecting the table engine in MariaDB </h2><br>  In the comments to the previous article I was told that using MyISAM as a table engine in the MariaDB DBMS is unreasonable.  I agree, correcting.  I will choose between <b>MyISAM</b> , <b>Aria</b> , <b>XtraDB</b> . <br><br>  The configuration of my.cnf in the case of <b>MyISAM</b> and <b>Aria</b> will be the same, and does not differ from the configuration given in the <a href="https://habrahabr.ru/post/278189/">first article</a> .  However, for <b>Aria</b> , use the directive <b>default-storage-engine = Aria</b> . <br><br>  The following directives should be set for <b>XtraDB</b> (I‚Äôm giving only what I changed compared to the configuration in the previous article): <br><br><pre> <code class="hljs 1c">key_buffer = <span class="hljs-number"><span class="hljs-number">32</span></span>M <span class="hljs-meta"><span class="hljs-meta">#  </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword"></span></span></span><span class="hljs-meta">   MyISAM  Aria #skip-innodb #   XtraDB #default-storage-engine=MyISAM #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword"></span></span></span><span class="hljs-meta">-   XtraDB innodb_buffer_pool_size = 128M #  </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword"></span></span></span><span class="hljs-meta">     XtraDB innodb_flush_method = "O_DIRECT" #      </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword"></span></span></span><span class="hljs-meta">   </span></span></code> </pre><br>  As a selection criterion, I first wanted to use the page generation time, but all types of engines with a simple page request showed the same results, so it was decided to perform stress tests with a load of 100 users.  My test account did not allow running stress tests with more than 50 users, however, as it was found out by experience, it was possible to run several tests from different browser tabs at the same time, which I used.  We check MyISAM.  Users: 100 (in the other tab, the same test was launched a little earlier): <br><br><img src="https://habrastorage.org/files/3f7/91e/afe/3f791eafe2cd4ee5841d168d2acbe878.png"><br><br>  Maximum response time: 17.473 seconds. <br><br>  Check Aria.  Users: 100 (in the other tab, the same test was launched a little earlier): <br><br><img src="https://habrastorage.org/files/878/452/484/878452484c364c4fbc9f7a69698c9a7e.png"><br><br>  Maximum response time: 14.223 seconds.  At the same time a smoother change in response time. <br><br>  We check XtraDB.  Users: 100 (in the other tab, the same test was launched a little earlier): <br><br><img src="https://habrastorage.org/files/b58/563/374/b58563374b4b4070a45c3b5207bf1382.png"><br><br>  Maximum response time: 14.355 seconds. <br><br>  Since the results on XtraDB and Aria turned out to be almost the same, leaving MyISAM behind, I decided to go ahead and increase the number of requests until the site is down.  On which engine will withstand a large load - he will choose. <br><br>  Testing Aria again.  Users: 150 (in the other two tabs, the same tests were started a little earlier): <br><br><img src="https://habrastorage.org/files/87f/8d5/b14/87f8d5b14ed04e54b4e27873d076239a.png"><br><br>  Dropped by 148 users.  Response time: <b>19.311 seconds</b> . <br><br>  We are testing XtraDB.  Users: 150 (in the other two tabs, the same tests were started a little earlier): <br><br><img src="https://habrastorage.org/files/f68/22d/654/f6822d6543574b179eef38aef1a8cc96.png"><br><br>  Fell on 150 users.  Response time: <b>20.963 seconds</b> .  Overall, the results on Aria and XtraDB are almost identical.  But I decided to choose <b>XtraDB</b> , because in the future I want to implement a data request for pages with articles using the NoSQL solution HandlerSocket, which only works with InnoDB / XtraDB.  At the moment there is an extension compiled for PHP (php-handlersocket) and a library written in PHP (HSPHP).  I managed to try the extension together with PHP5.6.  With it, I made a sample of the database on the PRIMARY KEY about 2.5 times faster than using a SQL query.  But under PHP7, it refuses to compile (and the next step is to switch to the new version).  As for the HSPHP library - having measured the sample acquisition time with its help and with the help of a SQL query (taking into account the library connection time), I found out that with a single query in the database it does not increment.  Therefore, I refused to use it and now I am waiting for a version of the extension that is compatible with PHP7. <br><br><h2>  Install and configure PHP7 + php-fpm </h2><br>  March 3, the release of a new version of PHP7.0.4.  And we will put it.  First, remove the previous version of PHP and php-fpm: <br><br>  apt-get purge php5 php5-fpm <br><br>  Download and unpack the archive with source code: <br><br><pre> <code class="hljs pgsql">mkdir /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/src/php7-build cd /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/src/php7-build curl -O http://se1.php.net/<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>.tar.bz2/<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>/this/mirror tar jxf php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>.tar.bz2 cd php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/</code> </pre> <br>  Install everything you need to compile: <br><br><pre> <code class="hljs sql">apt-get <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> <span class="hljs-keyword"><span class="hljs-keyword">build</span></span>-essential libfcgi-dev libfcgi0ldbl libjpeg62-turbo-dbg libmcrypt-dev libssl-dev libc-client2007e libc-client2007e-dev libxml2-dev libbz2-dev libcurl4-openssl-dev libjpeg-dev libpng12-dev libfreetype6-dev libkrb5-dev libpq-dev libxml2-dev libxslt1-dev</code> </pre> <br>  Create a symlink, otherwise we will not be able to compile php with imap support. <br><pre> <code class="hljs axapta">ln -s /usr/lib/libc-<span class="hljs-keyword"><span class="hljs-keyword">client</span></span>.a /usr/lib/x86_64-linux-gnu/libc-<span class="hljs-keyword"><span class="hljs-keyword">client</span></span>.a</code> </pre> <br>  Create a folder for installation: <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">mkdir</span></span> /opt/php-<span class="hljs-number"><span class="hljs-number">7</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre> <br>  Configuring: <br><br><pre> <code class="hljs actionscript">./configure --prefix=/opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-pdo-pgsql --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-zlib-dir --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-freetype-dir --enable-mbstring --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-libxml-dir=/usr --enable-soap --enable-calendar --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-curl --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-mcrypt --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-zlib --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-gd --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-pgsql --disable-rpath --enable-inline-optimization --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-bz2 --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-zlib --enable-sockets --enable-sysvsem --enable-sysvshm --enable-pcntl --enable-mbregex --enable-exif --enable-bcmath --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-mhash --enable-zip --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-pcre-regex --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-pdo-mysql --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-mysqli --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-mysql-sock=/<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/run/mysqld/mysqld.sock --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-jpeg-dir=/usr --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-png-dir=/usr --enable-gd-<span class="hljs-keyword"><span class="hljs-keyword">native</span></span>-ttf --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-openssl --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-fpm-user=www-data --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-fpm-group=www-data --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-libdir=/lib/x86_64-linux-gnu --enable-ftp --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-imap --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-imap-ssl --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-kerberos --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-gettext --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-xmlrpc --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-xsl --enable-opcache --enable-fpm</code> </pre> <br>  Compile and install (if you have a VDS with the same characteristics as mine, you can safely go and drink coffee): <br><br><pre> <code class="hljs go"><span class="hljs-built_in"><span class="hljs-built_in">make</span></span> <span class="hljs-built_in"><span class="hljs-built_in">make</span></span> install</code> </pre> <br>  Copy configs: <br><br><pre> <code class="hljs pgsql">cp /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/src/php7-build/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/php.ini-production /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/lib/php.ini cp /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/etc/php-fpm.conf.<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/etc/php-fpm.conf cp /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/etc/php-fpm.d/www.conf.<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/etc/php-fpm.d/www.conf</code> </pre> <br>  In the <b>/opt/php-7.0.4/etc/php-fpm.conf</b> file <b>we</b> uncomment the following lines: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">pid</span></span> = run/php-fpm.pid events.mechanism = <span class="hljs-literal"><span class="hljs-literal">epoll</span></span></code> </pre> <br>  The <b>/opt/php-7.0.4/etc/php-fpm.d/www.conf</b> file <b>contains</b> the same settings for workers as in the <a href="https://habrahabr.ru/post/278189/">first article</a> .  Directive <b>listen = 127.0.0.1:9000</b> Replace with the following lines: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">listen</span></span> = /var/run/php7<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>-fpm.sock <span class="hljs-keyword"><span class="hljs-keyword">listen</span></span>.owner = www-data <span class="hljs-keyword"><span class="hljs-keyword">listen</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">group</span></span> = www-data</code> </pre> <br><br>  Accordingly, in the settings of nginx in the /etc/nginx/conf.d/backend.conf file, the directive should be indicated: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">fastcgi_pass</span></span> unix:/var/run/php7.0.4-fpm.sock;</code> </pre> <br><br>  At the same time, it is necessary to increase the maximum number of allowed connections to a Unix-socket in the system by adding a directive to the end of the /etc/sysctl.conf file: <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.core.somaxconn = <span class="hljs-number"><span class="hljs-number">65535</span></span></code> </pre> <br><br>  After this, it is necessary to re-read the config: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sysctl</span></span> -p /etc/sysctl.conf</code> </pre> <br><br>  In the file /opt/php-7.0.4/lib/php.ini we set the same settings as in the first article.  To enable OPcache, in addition, add the line: <br><br><pre> <code class="hljs">zend_extension=opcache.so</code> </pre> <br>  We create symlinks for PHP and utilities: <br><br><pre> <code class="hljs lua">ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/pear /bin/pear ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/peardev /bin/peardev ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/pecl /bin/pecl ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/phar /bin/phar ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/phar.phar /bin/phar.phar ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/php /bin/php ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/php-cgi /bin/php-cgi ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/php-<span class="hljs-built_in"><span class="hljs-built_in">config</span></span> /bin/php-<span class="hljs-built_in"><span class="hljs-built_in">config</span></span> ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/phpdbg /bin/phpdbg ln -s /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/bin/phpize /bin/phpize</code> </pre> <br><br>  Now create the systemd <b>/etc/systemd/system/php-7.0.4-fpm.service</b> unit file: <br><br><pre> <code class="hljs javascript">[Unit] Description=The PHP <span class="hljs-number"><span class="hljs-number">7</span></span> FastCGI Process Manager After=network.target [Service] Type=simple PIDFile=<span class="hljs-regexp"><span class="hljs-regexp">/opt/</span></span>php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/run/php-fpm.pid ExecStart=<span class="hljs-regexp"><span class="hljs-regexp">/opt/</span></span>php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/sbin/php-fpm --nodaemonize --fpm-config /opt/php<span class="hljs-number"><span class="hljs-number">-7.0</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>/etc/php-fpm.conf ExecReload=<span class="hljs-regexp"><span class="hljs-regexp">/bin/</span></span>kill -USR2 $MAINPID [Install] WantedBy=multi-user.target</code> </pre> <br>  We activate the service and restart systemd: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">systemctl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">enable</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">php-7</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4-fpm</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.service</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">systemctl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">daemon-reload</span></span></code> </pre> <br>  It remains only to run php-fpm: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">systemctl</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">start</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">php-7</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4-fpm</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.service</span></span></code> </pre> <br>  Check the speed of page generation on the server: <b>45 ms</b> .  Compared with the previous step, the performance increased <b>3.4 times</b> .  We carry out load testing.  150 users were not enough for the site to fall.  Open another tab with the dough.  At 179 users, an error (not a complete crash) slips, I stop the test.  Maximum response time: <b>8.966 seconds</b> .  In general, go to PHP7. <br><br><img src="https://habrastorage.org/files/9ed/17e/a5a/9ed17ea5a10543c49dc4ecae5a818165.png"><br><br><h2>  Configuring Edge Side Includes (ESI) in Varnish </h2><br>  ESI is a language for incorporating web page fragments into other pages.  This allows you to use cached pages, using dynamic elements in them, reducing the generation time due to this.  This is an analogue of SSI. <br><br><img src="https://habrastorage.org/files/192/413/ac2/192413ac2e7247e4a72abc7d685b02e4.png"><br><br>  In WordPress, I decided to use this to implement the following scheme: if the user is logged in, then generate on the backend for him only the header containing the top user menu.  For pages with posts also dynamically generate a block with comments.  Everything else is taken from the cache.  Also, to maintain a high rate of return for logged in users, a static header is generated for each page and subsequently used from the cache. <br><br>  Since now everything that is below the header is cached, it‚Äôs impossible to determine the page generation rate using PHP.  For this, I used the Pingdom Tools service, which allows me to estimate the download speed of the site as a whole and of each document.  I chose it because it is possible for them to start testing from a server located in Amsterdam, where my VDS is located.  Due to this, the time to establish a connection was around 20 ms and the time the page was generated after sending the request to the server with several requests sent in a row remained almost unchanged (¬± 5 ms).  Before activating ESI, I measured the download speed of the site using this service.  Here are the results: <br><br><img src="https://habrastorage.org/files/42a/d1d/790/42ad1d79070f4bc38ac7e4b47110aded.png"><br><br>  The site was fully loaded in 360 ms, and the generation time of the page itself was 135 ms.  We proceed to the setting. <br><br>  Slightly <b>modify the</b> VCL configuration file <b>/etc/varnish/default.vcl</b> , shown in the <a href="https://habrahabr.ru/post/278189/">first part</a> . <br><br>  After the block in the section <b>vcl_backend_response</b> , describing work with static files <br><br><pre> <code class="hljs 1c"><span class="hljs-meta"><span class="hljs-meta"># </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword"></span></span></span><span class="hljs-meta">  ,   ... { ... }</span></span></code> </pre><br>  Add the following block: <br><br><pre> <code class="hljs swift">#   <span class="hljs-type"><span class="hljs-type">ESI</span></span>   ,  <span class="hljs-type"><span class="hljs-type">URL</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span>,   -  ,         <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(bereq.url ~ <span class="hljs-string"><span class="hljs-string">"dynamic"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> beresp.do_esi = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  Enabling processing will be enabled only for those cases for which the prohibition of processing is not specified in the <b>vcl_recv</b> section using the <b>set req.esi = false</b> directive <b>;</b> <br><br>  Block of code in the <b>vcl_recv</b> section, sending a logged-in user to the backend <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.http.Cookie ~ <span class="hljs-string"><span class="hljs-string">"wordpress_"</span></span> || req.http.Cookie ~ <span class="hljs-string"><span class="hljs-string">"comment_"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (pass); }</code> </pre> <br>  replace the block: <br><br><pre> <code class="hljs swift">#     <span class="hljs-type"><span class="hljs-type">ESI</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(req.http.<span class="hljs-type"><span class="hljs-type">Cookie</span></span> ~ <span class="hljs-string"><span class="hljs-string">"wordpress_"</span></span> || req.http.<span class="hljs-type"><span class="hljs-type">Cookie</span></span> ~ <span class="hljs-string"><span class="hljs-string">"comment_"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> req.esi = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  And at the very beginning of the <b>vcl_recv</b> section <b>we</b> place the following block: <br><br><pre> <code class="hljs kotlin">#  ,   <span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.url ~ <span class="hljs-string"><span class="hljs-string">"dynamic"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (pass); }</code> </pre> <br>  Now we need to make WordPress work the way we want it.  But first, I‚Äôll talk about the tags used in ESI, which allow you to create 2 different pages in the browser, depending on whether ESI processing is enabled or not. <br><ol><li>  The comment <b>tag</b> <b>&lt;! - esi</b> ... <b>-&gt;</b> - subject to the inclusion of ESI processing, these comments are removed, and what they commented out is executed.  If ESI is disabled, then in the client‚Äôs browser this section of code will be interpreted as a simple HTML comment and will be ignored; </li><li>  <b>&lt;esi: include src = "address / page" /&gt;</b> - if ESI is enabled, this page will be turned on at this place.  If ESI is disabled, it will be transmitted to the browser in its original form.  Therefore, it consists in the comment tag described above; </li><li>  <b>&lt;esi: remove&gt;</b> ... <b>&lt;/ esi: remove&gt;</b> - if ESI is enabled, this portion of the code will be removed.  If ESI is disabled, it will be transmitted to the browser in its original form.  Therefore, it also consists in the comment tag described above. </li></ol><br>  So, set up WordPress.  The code of the top user panel is generated, as a rule, in the file <b>header.php</b> .  However, in my case, a part of the styles was moved to <b>footer.php</b> in order to speed up page loading and was generated when the function <b>wp_footer () was</b> called.  First of all, I transferred the call to this function to the file <b>header.php</b> , placing the code after the opening <b>&lt;body&gt;</b> tag: <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> wp_footer(); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  and removed it in the file <b>footer.php</b> . <br><br>  Now edit the theme file <b>index.php</b> .  Instead of code <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> get_header(); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br>  write: <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> $beforeHeader = </span><span class="hljs-string"><span class="php"><span class="hljs-string">'?'</span></span></span><span class="php">; </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">if</span></span></span><span class="php">(</span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">isset</span></span></span><span class="php">($_GET[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'dynamic-header'</span></span></span><span class="php">]) || </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">isset</span></span></span><span class="php">($_GET[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'static-header'</span></span></span><span class="php">])) { get_header(); </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">die</span></span></span><span class="php">(); } </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">elseif</span></span></span><span class="php"> ($_SERVER[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'QUERY_STRING'</span></span></span><span class="php">] != </span><span class="hljs-string"><span class="php"><span class="hljs-string">''</span></span></span><span class="php">) { $beforeHeader = </span><span class="hljs-string"><span class="php"><span class="hljs-string">'&amp;'</span></span></span><span class="php">; } </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--esi &lt;esi:include src="&lt;?php echo $_SERVER['REQUEST_URI'] . $beforeHeader; ?&gt;dynamic-header"/&gt; &lt;esi:remove&gt; --&gt;</span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> file_get_contents(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'http://webshake.ru'</span></span></span><span class="php">.$_SERVER[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'REQUEST_URI'</span></span></span><span class="php">] . $beforeHeader .</span><span class="hljs-string"><span class="php"><span class="hljs-string">'static-header'</span></span></span><span class="php">); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--esi &lt;/esi:remove&gt; --&gt;</span></span></code> </pre><br>  If you do not understand, I will explain how it works.  The <b>$ beforeHeader</b> variable contains the character that will be placed before the parameter in the URL.  If the query string is empty, add a question mark and a parameter after the address, and if not, the ' <b>&amp;</b> ' symbol and the parameter.  If the <b>dynamic-header</b> or <b>static-header</b> variable was set using the GET method, output the header and die.  Otherwise, in the case of ESI enabled (and for us this means that we have a logged in user), request the current page with the addition of <b>? Dynamic-header</b> .  Since the URL contains the word dynamic, Varnish will send a request to the backend.  Then the current page with the <b>? Static-header</b> at the end will be loaded using the <b>file_get_contents ()</b> function; no cookies from the user will reach this page and a static header will be created for guests, which due to the lack of the <b>dynamic</b> word in the URL will go to the cache . <br>  If ESI is disabled (the guest has come), the dynamic header will not be included, and commented out code will be sent.  The <b>&lt;esi: remove&gt;</b> and <b>&lt;/ esi: remove&gt;</b> tags will also be sent commented out, and the static header code will be loaded from the cache, or generated and stored in the cache if the page is accessed for the first time. <br><br>  We make a similar code replacement <b>&lt;? Php get_header ();</b>  <b>?&gt;</b> in all pages of the topic where it is available. <br><br>  It remains only to implement dynamic work with comments on the pages of records.  To do this, open the template <b>single.php</b> and look for the function responsible for issuing the comment code.  In my case, this is the <b>comments_template ()</b> function <b>;</b>  and at the top of the code, in addition to the one we have already added, <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">if</span></span></span><span class="php">(</span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">isset</span></span></span><span class="php">($_GET[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'dynamic-comments'</span></span></span><span class="php">])) { comments_template( </span><span class="hljs-string"><span class="php"><span class="hljs-string">''</span></span></span><span class="php">, </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">true</span></span></span><span class="php"> ); </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">die</span></span></span><span class="php">(); }</span></span></code> </pre> <br>  And instead of calling the function <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> comments_template( </span><span class="hljs-string"><span class="php"><span class="hljs-string">''</span></span></span><span class="php">, </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">true</span></span></span><span class="php"> ); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br>  We write: <br><pre> <code class="hljs xml"><span class="hljs-comment"><span class="hljs-comment">&lt;!--esi &lt;esi:include src="&lt;?php echo $_SERVER['REQUEST_URI'] . $beforeHeader; ?&gt;dynamic-comments"/&gt; &lt;esi:remove&gt; --&gt;</span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> file_get_contents(</span><span class="hljs-string"><span class="php"><span class="hljs-string">'https://webshake.ru'</span></span></span><span class="php">.$_SERVER[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'REQUEST_URI'</span></span></span><span class="php">] . $beforeHeader .</span><span class="hljs-string"><span class="php"><span class="hljs-string">'dynamic-comments'</span></span></span><span class="php">); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--esi &lt;/esi:remove&gt; --&gt;</span></span></code> </pre> <br><br>  Everything works exactly the same as in the case above, only comments will always be issued dynamically, because if someone adds a comment, the PURGE request will be sent only to the page, but not to page? Static-comments and comments for logged in users will not update , and everything works. <br><br>  Restart varnish: <br><br><pre> <code class="hljs pgsql">service varnish <span class="hljs-keyword"><span class="hljs-keyword">restart</span></span></code> </pre> <br>  We measure the download speed of the site with ESI enabled: <br><br><img src="https://habrastorage.org/files/48b/373/ce9/48b373ce919e48e8860ef1d636aca6ed.png"><br><br>  The total site loading time is <b>289 ms</b> .  The page generation time was <b>65 ms</b> .  Thus, with the help of ESI, we accelerated the page generation for the user by a little more than 2 times. <br><br>  After that, I conducted the final load testing.  Users: 300 (in the other five tabs, the same tests were started a little earlier): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/263/bc2/2c7/263bc22c751c98cc4de5085ce1b8326b.png"><br><br>  The server crashed with a load of <b>276 logged in</b> users.  The response time was <b>7.155 seconds</b> . <br><br><h2>  Efficient compression </h2><br>  In the comments to the previous article, I was told that compression at the output of nginx with compression level 9 would put an extra load on the processor, while the files would compress by about 5 percent more than compression level 1, which gives a much smaller load on the processor. <br><br>  Actually, the thought came to compress static files (.css, .js) to use 9th degree and compress them on the backend side, after which they will fall into the Varnish cache and already without a subsequent load on the processor due to the compression operation are transferred to the user, The generated page itself is compressed on the front end with a compression ratio of 1. <br><br>  Thus, we will save space in the cache, and we will give smaller files to users. <br><br>  For this you need to set the following directives in the frontend config nginx <b>/etc/nginx/conf.d/frontend.conf</b> : <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">gzip</span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">gzip_comp_level</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">gzip_min_length</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">gzip_buffers</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">64k</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">gzip_types</span></span> text/plain; <span class="hljs-attribute"><span class="hljs-attribute">gzip_proxied</span></span> any;</code> </pre> <br>  And in the config of the backend <b>/etc/nginx/conf.d/backend.conf</b> : <br><br><pre> <code class="hljs pgsql">gzip <span class="hljs-keyword"><span class="hljs-keyword">on</span></span>; gzip_comp_level <span class="hljs-number"><span class="hljs-number">9</span></span>; gzip_min_length <span class="hljs-number"><span class="hljs-number">512</span></span>; gzip_buffers <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span>k; gzip_types <span class="hljs-type"><span class="hljs-type">text</span></span>/css application/<span class="hljs-type"><span class="hljs-type">json</span></span> application/x-javascript <span class="hljs-type"><span class="hljs-type">text</span></span>/<span class="hljs-type"><span class="hljs-type">xml</span></span> application/<span class="hljs-type"><span class="hljs-type">xml</span></span> application/<span class="hljs-type"><span class="hljs-type">xml</span></span>+rss <span class="hljs-type"><span class="hljs-type">text</span></span>/javascript application/javascript image/svg+<span class="hljs-type"><span class="hljs-type">xml</span></span>; gzip_proxied <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>;</code> </pre> <br>  I didn‚Äôt give any tangible results in the download speed, but the sizes of static files still decreased by several KB.  On a super-loaded system, it will give off. <br><br><h2>  Conclusion </h2><br>  In addition to all of the above, you can wait for the release of memcache for PHP7 and cache database requests using the W3 Total Cache plugin or some similar.  I would also like to see an extension for php-handlersocket for PHP7, try to use to get materials by ID.  The speed of access to this data should increase 2 times exactly.  Most of the tips that were given in the comments to the last article complied.  Thank you very much to the commentators, thanks to you, I managed to disperse the site as I never dreamed of.  Thanks for reading. <br><br>  Source: <a href="https://webshake.ru/post/265">webshake.ru/post/265</a> </div><p>Source: <a href="https://habr.com/ru/post/278899/">https://habr.com/ru/post/278899/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278887/index.html">IBM and X Prize Foundation Announce Artificial Intelligence Competition With $ 5 Million Prize Fund</a></li>
<li><a href="../278891/index.html">Databoom. Beginning of work. Control Panel</a></li>
<li><a href="../278893/index.html">Release ownCloud 9.0 - opensource alternatives to Dropbox and other cloud storage</a></li>
<li><a href="../278895/index.html">Learning OpenGL ES2 for Android</a></li>
<li><a href="../278897/index.html">Data flow relocation route: loading into a relational database</a></li>
<li><a href="../278901/index.html">Fixes, fixes, fixes and a few words about Vivaldi</a></li>
<li><a href="../278903/index.html">Correct polyhedra. Part 2.5 (auxiliary)</a></li>
<li><a href="../278905/index.html">Cloud Digest # 1: Infrastructure, Data Storage and IoT</a></li>
<li><a href="../278907/index.html">Announcement of ThinkJava # 3. Microservices</a></li>
<li><a href="../278909/index.html">Announcement of a free online course DevOps: What, Why, and How</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>