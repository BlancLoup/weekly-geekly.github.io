<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What does the strong name protect from in the .net builds?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The main purpose of a strong name or assembly signature is its uniqueness in the GAC ( Global assembly cache ). Based on the assembly, a cryptographic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What does the strong name protect from in the .net builds?</h1><div class="post__text post__text-html js-mediator-article">  The main purpose of a <i>strong name</i> or assembly signature is its uniqueness in the <i>GAC</i> ( <i>Global assembly cache</i> ).  Based on the assembly, a cryptographic public key is calculated during the signature, the private one is kept secret with the manufacturer of the assembly, the hash function of which is <i>public token</i> , which, in fact, has a strong name for the assembly.  <i>The public token is</i> stored in the build metadata and paired with the build name, version, and culture, and serves to uniquely identify it. <br><br>  There is no doubt that this mechanism is very suitable for the unique identification of assemblies and the use of the same assembly by different applications. <br><br>  But many are mistaken in thinking that an assembly with a strong name is protected from modification.  In fairness, it is worth noting that if the manufacturer of the assembly has published a <i>public token</i> or a public key, for example, on its website, then you can always check if this key or token matches the key that is sewn into the used assemblies, but you will probably have to check it manually.  The important thing is that the strong name will not protect the assembly from modification, as many think, and accordingly the mechanism in the <i>CLR</i> will not work as expected and load the modified assembly. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How is this possible you ask?  It's very simple, since the Public token (public key token) is sewn into the assembly, you can simply remove it from there. <br><br>  But after all, other assemblies that refer to this assembly and its strong name will not load it and will not be executed properly, you say.  Yes, do not upload.  As long as they are also signed with a strong name and while dependencies they have this build.  But if these assemblies have strict names or links to assemblies removed and replaced with the same ones only without a strong name, then the application will work as it should. <br><br>  However, it should first be noted that everything described above works when you have access to assemblies for modification.  If, for example, this is a web service, then these assemblies cannot be accessed. <br><br>  Let's look at an example.  Let some company produces its product.  No matter what.  What is important is that their product consists of a certain number of their own assemblies signed with one private key, and therefore with the same <i>public token</i> .  Also their product contains <i>3rd party</i> assemblies, third- <i>party</i> assemblies, components that come with the product.  The company decides to somehow limit the functionality of the product, of course the code restrictions and the conditions under which it works, are in the assemblies of the company.  An attacker needs to modify any one assembly to remove the restriction.  He modifies it and removes the strong name, so that the assembly will not be signed.  In order for other assemblies that refer to it to work properly, it will remove the signature from them as well, and also change the dependencies of these assemblies for unsigned assemblies. <br><br>  Perhaps you think it is difficult to do?  No, this can make any student.  What is needed for this?  Reflex and <i>ReflexIL</i> plug-in for it. <br><br>  <i>ReflexIL</i> has a strong name remover.  It works very simply.  Select the assembly, click " <i>Auto scan assembly directory</i> ", if the assemblies with a strong name are found, they will be added to the list.  And then click " <i>Remove strong name and update referencing assemblies</i> " and that's it.  Now we have removed the signature from the assembly. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b41/a12/f39/b41a12f3909e70bc3a853c32b10b9bcb.png" alt="image"><br><br>  Those.  Despite the fact that we are assured that a strong name in addition to its relation to the global cache of assemblies also protects against modification of the assembly, this is not so in practice. <br>  So you should not rely on a strong name as a reliable protection against modification. <br>  But what about you?  In fact, this is the topic of another article.  But the answer is clear, use the standard for .NET protection mechanisms - obfuscation, the use of mixed managed and unmanaged code. <br><br>  You can also check the strong name of the assembly manually, and in combination with <i>PostSharp</i> or some other AOP approach, mark the necessary methods in the code with an attribute indicating that you need to check the strong name before calling it.  And check with your own method the strong name of the assembly with a hard-wired constant.  Only with this, the pieces of the code with the check and call of the check, as well as the constant with the public token should be obfuscated and encrypted.  Or rethink the product and make some of its parts as web services, although this is not always possible.  You can manually check the strong name in the following way. <br><blockquote><code><font color="black"><font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">bool</font> IsPublicTokenValid( <font color="#0000ff">byte</font> [] tokenExpected) <br> { <br> <font color="#008000">// Retrieve token from current assembly</font> <br> <font color="#0000ff">byte</font> [] tokenCurrent = <font color="#2B91AF">Assembly</font> .GetExecutingAssembly().GetName().GetPublicKeyToken(); <br> <br> <font color="#008000">// Check that lengths match</font> <br> <font color="#0000ff">if</font> (tokenExpected.Length == tokenCurrent.Length) <br> { <br> <font color="#008000">// Check that token contents match</font> <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; tokenCurrent.Length; i++) <br> <font color="#0000ff">if</font> (tokenExpected[i] != tokenCurrent[i]) <br> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <br> } <br> <font color="#0000ff">else</font> <br> { <br> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <br> } <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> }</font> <br></code> </blockquote><br>  <b>So what does a strong name protect against?</b>  Roughly speaking, from nothing.  This is a means to uniquely identify assemblies, with which several versions of the same assemblies in the <i>GAC</i> can coexist. <br><br>  <b>Does a strong name help protect against assembly modifications?</b>  A strict name <a href="http://www.csharp411.com/net-assembly-faq-part-3-strong-names-and-signing/">cannot protect</a> against spoofing an assembly; it will not stop the attacker from deleting the assembly's signature, over-signing the assembly with his own key and distributing it in this form.  True, the re-signed assembly will have a different public key, which can be manually compared with the publisher's public key. <br><br>  <b>Is it possible to use the assembly signature with a strong name to determine the author of the assembly</b> ?  A strong name does not imply a level of trust in an assembly that provides, for example, <a href="http://www.iss.net/security_center/advice/Countermeasures/Authentication/Authenticode/default.htm">Authenticode</a> . </div><p>Source: <a href="https://habr.com/ru/post/91999/">https://habr.com/ru/post/91999/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../91989/index.html">Quiet, quiet crawl, Haiku, on the slope of Fuji</a></li>
<li><a href="../91990/index.html">8 useful tricks for WordPress database</a></li>
<li><a href="../91991/index.html">The awful truth about AMOLED screens :)</a></li>
<li><a href="../91996/index.html">We are testing the ERP system. Part 1</a></li>
<li><a href="../91997/index.html">Troyan on travel.mail.ru</a></li>
<li><a href="../92000/index.html">Universal charging for gadgets do it yourself</a></li>
<li><a href="../92001/index.html">DIY SSL-certificate monitoring script for the lazy</a></li>
<li><a href="../92003/index.html">Harumambu.ru - all freelance projects of the RuNet</a></li>
<li><a href="../92005/index.html">School "Operations research in logistics" in Nizhny Novgorod</a></li>
<li><a href="../92007/index.html">VS 2010: Debugging Innovations</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>