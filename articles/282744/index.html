<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Microsoft improves Windows 10 kernel security mechanisms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A well-known Windows internal device guru, Alex Ionescu , revealed new features of the Windows 10 kernel, which appeared in the new Windows 10 Insider...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Microsoft improves Windows 10 kernel security mechanisms</h1><div class="post__text post__text-html js-mediator-article">  A well-known Windows internal device guru, <a href="https://twitter.com/aionescu">Alex Ionescu</a> , revealed new features of the Windows 10 kernel, which appeared in the new Windows 10 Insider Preview 14332 build. Earlier in our blog, we repeatedly mentioned Insider Preview versions of Windows 10 that are used by software developers and drivers for testing.  The updates that appear in them will then be released to all users of Windows 10 as one big update of this OS. <br><br><img src="https://habrastorage.org/files/aa0/fda/97b/aa0fda97bfad4128a62fdc83ffa70b33.png"><br><br>  This time we are talking about ASLR in kernel mode (Kernel ASLR), which is known not so much, unlike its <a href="https://habrahabr.ru/company/eset/blog/206244/">counterpart</a> for Ring3 components of Windows.  Prior to Windows 10 14332, Windows used only a partial implementation of KASLR <a href="http://www.osronline.com/showthread.cfm%3Flink%3D235951">only</a> for system images (drivers) and starting with Windows Vista SP1.  Now, with each reboot, Windows will change the virtual addresses of the location not only of the drivers, but also, practically, of all the OS structures and components operating in the system virtual address space. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  The main goal pursued by Windows (like Apple OS X, iOS, Google Android) when implementing ASLR is to move important data structures and system images in the system part of the virtual address space to new addresses with each reboot.  In addition, Windows kernel data structures, which it, in one form or another, can pass to Ring3, should not contain direct or indirect pointers to kernel objects.  This is also a requirement for the implementation of ASLR. <br><br><img src="https://habrastorage.org/files/a73/e5e/971/a73e5e97194a46309c5e19f3001d12ff.png"><br>  Fig.  According to Ionescu, for Windows Virtual Memory Manager, something previously unheard of happens, the directory and page table mapping addresses will be dynamic.  Local Privilege Escalation (LPE) exploits that relied on fixed addresses in the system virtual address space will no longer work correctly.  The only exception is the used HAL memory regions, as well as the still <a href="https://twitter.com/NicoEconomou/status/725772271512604676">relevant</a> pointers in <i>PEB.GdiSharedHandleTable</i> .  This loophole can still be used to partially bypass KASLR in exploits. <br><br>  Starting from Win10 14332, Windows will be able to change virtual base addresses of such critical virtual memory manager data structures as a page table directory (PDE), page table (PTE), system PTE addresses, hyperspace, PFN database, etc. In the concepts of virtual distribution the Windows kernel address space has always been implied by the base starting address of the beginning of the page tables and the structures listed above, the addresses were protected at the kernel compilation stage and could differ only in the case of a 32-bit or 64-bit virtual address  space, and the use of PAE addressing. <br><br>  New measure Microsoft will significantly increase the immunity of Windows to LPE-exploits, which are based on fixed virtual addresses in the virtual address space of the kernel.  Earlier, we <a href="https://habrahabr.ru/company/eset/blog/281481/">wrote</a> about a Microsoft added measure to protect against LPE exploits, which will allow applications to filter access to Win32k system services ( <i>Win32k syscalls filtering</i> ), often used by exploits when vulnerabilities are triggered in win32k.sys.  Both of these features will be available to users of Windows 10 in the new large OS update. </div><p>Source: <a href="https://habr.com/ru/post/282744/">https://habr.com/ru/post/282744/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282734/index.html">OpenStack: How not to ‚Äútread on the rake‚Äù of OpenSource business</a></li>
<li><a href="../282736/index.html">Development in own juice or as we understood that we are not doing what users need</a></li>
<li><a href="../282738/index.html">We present data and code in order: optimization and memory, part 1</a></li>
<li><a href="../282740/index.html">Windows performance analysis using OS features and PAL utility</a></li>
<li><a href="../282742/index.html">Hotel business: an easy target for hackers with attractive profits</a></li>
<li><a href="../282750/index.html">Analysis of English text with a cup of coffee "JavaSE8"</a></li>
<li><a href="../282752/index.html">Chewing Algorithm for Touchscreen</a></li>
<li><a href="../282756/index.html">Code examples for the Internet of things: smart sprinkler</a></li>
<li><a href="../282760/index.html">Hire an identity, not a skill set. My most important questions in the interview</a></li>
<li><a href="../282764/index.html">Why PostgreSQL is better than other open source SQL databases. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>