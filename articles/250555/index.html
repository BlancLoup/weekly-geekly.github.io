<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Putting the glove to determine the position of the hands themselves</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will talk about how we collected the glove to determine the position of the hand for the competition. Of course, there are difficult...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Putting the glove to determine the position of the hands themselves</h1><div class="post__text post__text-html js-mediator-article">  In this article I will talk about how we collected the glove to determine the position of the hand for the competition.  Of course, there are difficulties in its manufacture, but even a schoolboy can collect it.  Such a glove can be used both for controlling electronics and as a manipulator for various games. <br><br><img src="https://habrastorage.org/files/53f/55c/644/53f55c644c4f41b3a9db9d87bee34d6e.jpg"><br><a name="habracut"></a><br>  Those who read the <a href="http://habrahabr.ru/post/247423/">article about the scanner</a> will probably remember that I promised to continue.  But because of the contests, I still have no time for this.  But now I sit after the competition and write an article about a part of our project.  At the exhibition I was asked to tell about the principle of operation of this device, then they asked for contacts, and then I just decided that I would better write an article and solve the problem for more than two people.  Initially, with the help of this glove we controlled the electronics (we included teapots on the Internet using gestures), and now we use it for tracking the position of the hand.  That's all the introduction. <br><br><h4>  Principle of operation </h4><br>  Hand gloves can be divided into several types (I can miss something): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1) On strain gages <br>  Well, this is the easiest.  A strain gauge is a strip from which two contacts extend.  When stretching / compressing this strip, its resistance changes.  We put on each movable joint on such a sensor and get a profit.  But these strain gauges are quite expensive, it is impossible to determine the direction of the bend and the tape itself has a decent length (about the length of a finger). <br><br>  2) On the "LED tubes" <br>  Already more interesting.  The bottom line is this: a silicone or rubber tube is taken, an LED is installed at one end of the tube, and a photoresistor / transistor at the other end.  The more we bend such a sensor, the less light falls on the photo sensor, and accordingly its resistance increases.  Such a sensor is cheaper than a strain gauge in order.  But it has the same disadvantages: it is inconvenient to bend and it is impossible to determine the direction of the bend. <br><br>  3) orientation sensors <br>  By this I mean various accelerometers, gyroscopes, magnetometers, and various combinations of them.  The cost of such sensors varies greatly, and the main problems arise when programming them.  It is these sensors that I applied in a glove. <br><br>  I stopped the choice on LIS331 sensors.  This is an eight-bit, three-axis accelerometer.  Just because they then cost 30 rubles apiece retail.  This was generally my first experience in using such sensors, so I decided: ‚Äúif I drown this sensor, it will not be a pity‚Äù. <br>  From the accelerometer we get the decomposition of the acceleration vector of the sensor in its three axes.  Where is the acceleration?  Well, as from space - the acceleration of free fall on the Earth acts on us.  Here it is necessary to say about the minus of this sensor: this very vector fluctuates from any hand-shake, so we have high-frequency noise at the output.  But to determine the gesture, when the hand almost does not move, you can apply them. <br>  Actually, this is the whole task: take the sensor on each moving bone, connect it to the microcontroller, find the position of the sensor, determine the gesture.  But it was not there‚Ä¶ <br><br><h4>  Sensor board </h4><br>  Let's start with the fact that this sensor is still necessary to solder.  Do you think you are good at soldering?  Meet (grid pitch on photo 0.5 mm): <br><br><img src="https://habrastorage.org/files/da2/1f6/c6c/da21f6c6c15e48c3a016989648119072.jpg"><br><br>  LGA16.  He is also pleased to meet you.  It was because of him that I had to buy a soldering station.  I really love SMD.  The details are small and the handkerchiefs are correspondingly small too.  But this is ... In general, now, after soldering the MPU-9250, I say that it is a freebie, but then it was a look.  Well, at least it's not a pity to kill.  Armed with a program for tracing boards draw a board.  First, the area under the microcircuit.  Our best friend in soldering is surface tension.  When we solder exactly this power will cause the microcircuit to fall into place.  Therefore, the site must be done quite long, otherwise the microcircuit will pull the same surface tension to the side.  All sizes are taken from datasheet.  I could not do it in one layer without jumpers, so there will be one after all.  On the layout, it is shown in red.  Large sites in order to solder the cable there.  Since the pitch between these pads is 2.54 mm and these pads are located both above and below the microcircuit, the loop with a pitch of 1.27 mm is ideal for us.  The result will be such a fee: <br><br><img src="https://habrastorage.org/files/b0b/162/973/b0b162973fa846e194da7a9ec25cb914.JPG"><br><br>  And such a sensor after soldering: <br><br><img src="https://habrastorage.org/files/a98/f2f/578/a98f2f57821145fe97d9eef85d7d961d.PNG"><br><br>  The photo clearly shows the <s>mess on the table for which I apologize</s> what I had in mind when I spoke about the step of conclusions.  The width of the cable is almost equal to the width of the board, and therefore does not look very bad.  But the board still needs to be done and corroded.  The fee is easily done by LUT, and I‚Äôm being bullied in hydrogen peroxide.  To achieve a better result, I roll the board in solution with an electric motor.  You can at once make an array of boards on one piece of fiberglass.  This will greatly speed up the manufacturing process.  After etching we puddle the board and at this stage the problems begin ... <br><br><h4>  Soldering </h4><br>  This process is absolutely useless to describe.  Better to see the video once.  I can only say that I jammed 8 sensors before I sealed the 6 sensors I needed.  Well, the first time is soldering, you can forgive.  I will not attach a video about the soldering of the LGA case, since they are easy to find in a search engine, and I don‚Äôt want to litter the Internet with another one. <br><br>  Another useful life hack: blow-dry in some tray / baking tray / plate / basin in general in anything that has sides.  The microcircuits are blown away by a hairdryer, and it is almost useless to look for them. <br><br>  After sealing the sensor, solder the cable, remember that you forgot to solder the jumper, solder the cable, solder the jumper, return the cable to its place. <br><br><h4>  Microcontroller board </h4><br>  This is your business, which MK to use.  Here I will talk about a little trick, which for some reason is forgotten.  And it allows saving the legs of the microcontroller, which are already few on some boards.  And this trick is called logic.  Not the one that feminine happens, but the one that starts at 74HC.  Specifically, we are interested in 74HC164.  This is a shift register.  It works quite simply.  He has legs Data, Clock, Reset and conclusions.  Through Data and Clock, we successively transmit 8 bits, which the register simultaneously outputs to the outputs.  And with the help of Reset, you can set all the pins to 0. Actually we connect the legs of the Enable accelerometers to this microcircuit and with the help of one microcircuit we control eight accelerometers.  But we need only five, so that the remaining two can be occupied by LEDs.  There will be a beautiful highlight.  Only here there is a bug: when we reset the chip, the ‚Äúbits of LEDs‚Äù will be written to 0. And since we write the data pretty quickly, this blinking will look like a decrease in brightness, which can make the engineer nervous.  Actually the general block diagram of the glove will look like this: <br><br><img src="https://habrastorage.org/files/5a3/dee/e1f/5a3deee1fe04403383b7e9aa09e785a4.bmp"><br><br>  When programming, you must also remember that the microcircuit will be selected when there is a logical zero on the Enable leg (also known as CS).  So in order to select the second accelerometer, you will need to write 10111111 instead of 01000000 in the register. <br><br><h4>  Programming </h4><br>  Data exchange with the accelerometer is as follows: <br>  0 bit - R / W bit.  If 1, then we read the data, if 0, then we write to the sensor. <br>  1-7 bit - Address of the register with which we are going to work. <br>  8-15 bit - The data we write to the register.  If we read, then the accelerometer will simply ignore them. <br><br>  If everything is clear with this, then for the beginning we read the WHO_AM_I register.  This register can only be read and its default value can be found in the datasheet.  For our accelerometer, this register is located at the address 0x0F, and the default value is 0x3B.  That is, we send 0x8F to the accelerometer first, then any 8 bits, and must read 0x3B.  If you read something else, then somewhere cant.  Either in soldering, or send the wrong data, or overheated microchip during soldering.  Maybe the speed is too big.  And do not forget to tighten the leg CS to the ground and return back.  If you received the correct data, then you can be congratulated - it remains to solder only 4 sensors.  It turns out this picture: <br><br><img src="https://habrastorage.org/files/066/d98/648/066d98648cb8427faaf64789f6d6ac58.jpg"><br><br>  After sealing all five sensors (one for each finger), we attach them to the glove.  I used hot glue for this.  It turned out this: <br><br><img src="https://habrastorage.org/files/e35/1a4/8a1/e351a48a1a6445559c790cddbdd62056.jpg"><br><br>  In order for us to begin to receive any data from the chip, it must be turned on.  To do this, set the BOOT bit of the CTRL_REG2 register to one and write the value 0xC7 to the CTRL_REG1 register.  The first is to reset the accelerometer, and the second is to take the sensor out of power saving mode, set the sampling frequency to 400Hz, and turn on all three axes. <br>  All data from the x, y and z axes is written to registers with addresses 0x29, 0x2B, and 0x2D, ‚Äã‚Äãrespectively.  In order to get the data, we just read them and that's it (don't forget that if we read, then 0bit of the first parcel is 1).  Here is another ‚Äúif‚Äù with a trick: if you read the data, and there are solid zeros, and the code is exactly working and correct, then look carefully at the name of your accelerometers.  There may not be LIS331DL, but LIS331DLH.  What does this letter give?  And the sensor is now 16-bit, so also with a large number of settings.  Because of this, the addresses of the registers change.  I on search of this jamb killed hours 4, not less.  It was a shame.  But suppose you did everything right.  Then you will get this kind of trash in the terminal: <br><br><img src="https://habrastorage.org/files/b0d/af8/b71/b0daf8b710db491790e7bb1006dadefc.PNG"><br><br>  I doubt that such accelerations act on the accelerometer lying peacefully on the table.  Probably all a matter of interference.  No, well, what did we want for 30 rubles?  We'll have to somehow get rid of them.  For this we need a filter.  The easiest way to implement it is software (it seems that there is a filter inside the sensor, but for some reason it did not work for me).  It looks ugly simply: the new value = old value + measured value * coefficient.  It is clear that the cut-off frequency depends on the coefficient that you need to choose for your own tasks. <br><br><h4>  Gesture definition </h4><br>  In the simplest case, you can simply look at the sign of the number that we accepted.  Get the array on five fingers, and send this array to the computer.  Like, if the finger is bent, then 1, and if straightened, then 0. For example, 11011. This is exactly what was realized in the first glove, for more was not needed.  But it is also realistic to determine the angle of inclination.  To do this, we simply take the arctangent of the ratio of accelerations along two axes and obtain the angle of inclination along the plane in which these axes lie.  Having done this for three pairs of axes, we can find the tilt angles along the three axes and restore the position of the sensor in three-dimensional space.  But I think no one will need it.  Even not due to the fact that the task will not require it, but due to the fact that for such tasks it is necessary to use a six-axis sensor (accelerometer + gyroscope) or even better nine-axis (accelerometer + gyroscope + magnetometer).  But they are much more expensive and work with them is somewhat more difficult. <br><br><h4>  Conclusion </h4><br>  I hope that those who wanted to collect something like this article will help.  I would have helped at that time.  Now we have already won one competition with this glove, and even made a new glove on nine-axis sensors, with which we won on the other.  Truth be told in secret, the magnetometer did not work for me, but nobody knows about it.  The glove works well without it, so I'd rather have bought cheaper six-axis sensors.  Now there are no contests in the near future, so I will try to write a second article about 3d scanner, as I promised. <br><br>  PS I forgot to attach the sensor board layout itself: <br>  <a href="">SprintLayout Fee</a> </div><p>Source: <a href="https://habr.com/ru/post/250555/">https://habr.com/ru/post/250555/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../250541/index.html">Wiring diagrams with LaTeX and TikZ</a></li>
<li><a href="../250545/index.html">Intel¬Æ Graphics Technology. Part II: ‚Äúunload‚Äù calculations on graphics</a></li>
<li><a href="../250549/index.html">The boot server - as a bootable USB flash drive, only the server and the network</a></li>
<li><a href="../250551/index.html">Overview of the site for testing web vulnerabilities OWASP Top-10 for example bWAPP</a></li>
<li><a href="../250553/index.html">February 14 - the day of the programmer</a></li>
<li><a href="../250557/index.html">Practical programming of artificial intelligence</a></li>
<li><a href="../250561/index.html">Change postal codes for three-word addresses using reverse geocoding</a></li>
<li><a href="../250565/index.html">VirusTotal will track false positive</a></li>
<li><a href="../250569/index.html">Nice build frontend project</a></li>
<li><a href="../250571/index.html">RIG exploit kit exploit source code leaked to network</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>