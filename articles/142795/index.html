<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>EAP-SIM authentication in WLAN</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The main idea of ‚Äã‚ÄãEAP-SIM authentication in WLAN (802.1X) networks is the use of authentication parameters and SIM card algorithms for user authentic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>EAP-SIM authentication in WLAN</h1><div class="post__text post__text-html js-mediator-article"> The main idea of ‚Äã‚ÄãEAP-SIM authentication in WLAN (802.1X) networks is the use of authentication parameters and SIM card algorithms for user authentication and traffic encryption in WLAN networks.  At the same time, the user does not have to enter a login and password, all authentication is "transparent". <br><br><a name="habracut"></a><br>  1) EAP-SIM authentication scheme <br><br>  Legend: <br>  EAP - Enhanced Authentication Protocol (Extended Authentication Protocol) <br>  SIM Subscriber Identity Module (GSM Subscriber Identity Module) <br>  MAC - Message Authentication Code <br>  IMSI - International Mobile Subscriber Identifier <br>  Nonce - Random value generated by client side <br>  GSM triplet - RAND and Kc and SRES values ‚Äã‚Äãcalculated on the basis of this RAND using A3 / A8 algorithms <br>  AuC - GSM operator authentication center.  One of the tasks is the calculation of a GSM triplet. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The basic authentication scheme using EAP-SIM is shown below. <br><img src="https://habrastorage.org/storage2/7c7/864/60e/7c786460e5f52d6fdd66d5dcc1d0561a.png"><br><br>  EAP-SIM authentication with this scheme requires the following components: <br>  - Client device (Terminal) with support for a conventional GSM SIM card and corresponding software.  You can use a specific SIM card, in this case, security will be higher <br>  - 802.1X compatible WLAN access point with EAP-SIM support <br>  - Access Controller / Gateway with DHCP (Dynamic Host Configuration Protocol) and EAP-SIM protocol on the WLAN side of the network to allocate dynamic IP addresses to network users and interact with the AAA RADIUS server of the WLAN network via the EAP protocol <br>  - AAA RADIUS server used to authenticate the user of a WLAN network using EAP-SIM / AKA algorithms (in traditional WLAN networks this is an authentication server that, in the simplest case, checks the entered login &amp; password and charges the subscriber) <br>  - SS7 gateway for interworking AAA RADIUS server's WLAN network with HLR (Home Location Register) / Authentication Center (AuC) operator.  The diagram, for simplicity, is not indicated. <br>  - HLR / AuC - home register of GSM subscribers <br><br>  2) The principle of operation of EAP-SIM authentication <br><br>  A timing diagram explaining the principle of EAP-SIM authentication is given below. <br><img src="https://habrastorage.org/storage2/7d9/54e/d9f/7d954ed9fa22084c98456cf0f4c4d72a.png"><br><br>  If the PIN code is entered correctly (or the request is turned off) and the subscriber has chosen the appropriate WLAN network, EAP-SIM authentication starts at his terminal.  The authentication process takes the following steps: <br>  a) from the WLAN side of the access point (in the Access Point diagram), the EAP Identity Request message is sent to the user terminal via the EAPOL protocol <br>  b) the user terminal in the EAP Identity Response message transmits the MSISDN (in the form of an NAI, for example 250097000000001@eapsim.mobile_carrier.ru) of the SIM card used or pseudonym.  Pseudonym (temporary identity), which is analogous to the temporary IMSI and is designed to increase security by hiding the real IMSI. <br>  c) The WLAN access point in the EAP SIM Start Request message informs the user terminal of the supported versions of the EAP-SIM authentication, and also requests the parameters of the terminal equipment. <br>  d) the user terminal selects one of the supported authentication algorithms, which is reported to the access point in the EAP SIM Start response message.  This message also contains the value of the required number of GSM triplets per session (see clause 3.1). <br>  e) The WLAN access point translates 802.1X protocols into RADIUS compliant protocols and forwards the MSISDN + parameters from the EAP SIM Start response to the AAA RADIUS server.  In turn, the AAA RADIUS server, via the SS7 gateway (via MAP), transmits the MSISDN of the terminal to AuC and requests standard GSM triplets (RAND, Kc, SRES). <br>  d) Two or three RAND values ‚Äã‚Äãand Kc &amp; SRES values ‚Äã‚Äãreceived from AuC are used by the WLAN AAA RADIUS server to calculate EAP-SIM authentication keys (K_aut), EAP-SIM encryption keys (K_encr), MSK &amp; EMSK session keys and EAP-SIM additional authentication parameters.  Next, an EAP packet is generated, containing: RAND values ‚Äã‚Äã(in open form), encrypted additional authentication parameters (AT_ENCR_DATA).  Then, the EAP packet and the packet hash sum (AT_MAC value = SHA1 (EAP packet, NONCE_MT)) are transmitted to the terminal in the EAP SIM Challenge Request message. <br>  e) the RAND values ‚Äã‚Äãobtained by the terminal are transmitted to the SIM card for calculating SRES and Kc values ‚Äã‚Äãby the A3 / A8 algorithms, which are then used by the terminal to decrypt additional authentication parameters obtained in the previous step ‚ÄúEAP-SIM‚Äù.  Further, if the decryption on the terminal side is successful and the ‚ÄúEAP-SIM advanced authentication parameters‚Äù are correct, the terminal sends the network in the EAP SIM Challenge Response message a sign of successful ‚Äúterminal authentication‚Äù and the hash sum of the calculated SRES value (AT_MAC = SHA1 (SRES) ).  Otherwise, the hash amount of SRES is not sent. <br>  d) if the WLAN AAA RADIUS server acknowledges receipt of a successful authentication flag and if the SRES hash sum from the terminal matches the calculated one, the access point starts providing the service, and a successful "server authentication" message is sent to the terminal.  Service provisioning is possible using standard WPA / WPA2 (WLAN Access Protection) encryption. <br>  The protocols used in each of the sections are shown in the figure below. <br><img src="https://habrastorage.org/storage2/820/952/69f/82095269f99b2538878710c9da2feb0d.png"><br><br>  It should be noted that for the EAP mode there are two main methods of authentication in WLAN networks: EAP-AKA and EAP-SIM.  The first one is more reliable, but requires a USIM card with Milenage support, besides Milenage support must be present on the AuC / HLR operator‚Äôs side.  The second method indicated is less reliable, requires 2G SIM cards (COMP128v1-4) and standard 2G authentication on the AuC / HLR operator‚Äôs side.  It should also be noted that authentication via EAP-SIM / AKA is reciprocal, and is performed by analyzing the AT_MAC values ‚Äã‚Äãreceived from the access point from the terminal side - if the parameters in AT_MAC do not match the parameters of the SIM card, then the authentication is terminated and the hash amount SRES to the access point . <br><br>  Also, when setting up a WLAN network, you need to set the user reauthentication mode if the data transfer session is broken.  Here two options are possible: <br>  - re-EAP-SIM / AKA authentication <br>  - use the client access parameters (MSISDN, MAC) stored in the AAA RADIUS server and do not re-request the triplets from the AuC server of the operator.  The second method will reduce the load on the operator‚Äôs network, but this method is less secure in the matter of illegal access under the client‚Äôs name <br><br>  The advantage of EAP-SIM / AKA authentication is transparent to the subscriber authentication while maintaining data confidentiality, since the secret key Ki is not transmitted to the IP network.  As stated in RFC 4186, the reliability of EAP-SIM / AKA authentication is no worse than in GSM. <br><br>  3) GSM network security when using EAP-SIM authentication <br><br>  Due to the fact that a SIM card is involved in EAP-SIM authentication, it is necessary to carefully analyze the confidentiality of secret data in various schemes for using EAP-SIM.  For now, let's turn to RFC 4186, from which two observations follow: <br><br>  3.1.  As stated in RFC 4186: ‚ÄúThe cipher key (Kc) is no longer a key.‚Äù  The length of Kc is not enough to securely encrypt user data in a WLAN network.  To eliminate this, an algorithm for obtaining 2-3 Kc can be applied, followed by merging on the client side and the AAA RADIUS server of the WLAN network.  When using the algorithm of using 2-3 Kc keys, the reliability of data channel encryption increases. <br><br>  3.2.  The second question is the transfer of the SRES hash from the terminal to the AAA RADIUS server via the WLAN IP network.  In the standard case, SRES is not transmitted explicitly and cannot be obtained by an attacker.  However, there is a possibility of the presence on the side of the terminal / PC "Trojans" in order to illegally obtain SRES and Kc.  After receiving a sufficiently large number of triplets, it is possible to calculate the key i and further clone the GSM SIM card.  This method allows you to get triplets without physical access to the SIM card, which increases the risk of cloning SIM cards.  It should also be noted that the algorithm for calculating the SRES hash sum via SHA1 is unreliable and has already been cracked (http://www.schneier.com/blog/archives/2005/02/sha1_broken.html).  Thus, by listening to a Wi-Fi network, attackers can get real SRES and RAND values.  Kc, however, is not transmitted and cannot be obtained by listening to the network. <br><br>  4) EAP-SIM authentication solutions analysis <br><br>  Depending on the requirements for the coverage of the terminal base and the level of security, there are three options for the introduction of EAP-SIM at the cellular operator. <br><br>  a) Calculating the MAC and MAC2 values ‚Äã‚Äãinside the SIM card.  Formation of EAP packets inside the SIM card. <br><br>  Advantages of the solution: <br>  - High degree of security when calculating GSM triplets <br>  - Work on various WLAN terminals, including PCs with different operating systems, but on condition that third-party software is also developed.  WLAN requirements are minimal, since all calculations go on the SIM card side. <br>  Solution Minuses: <br>  - It is necessary to create a new SIM card profile, finance the development of an applet on the SIM card <br>  - It is necessary to create third-party software for various operating systems of the phone and PC.  Given that the OS is constantly updated, it will be necessary to periodically release new software versions or updates. <br>  - The need to configure software in a WLAN device <br>  - If the subscriber wants to take advantage of the EAP-SIM he will need to change the SIM card <br><br><img src="https://habrastorage.org/storage2/fac/9f8/bc8/fac9f8bc8e166f0d1553e2a9d8ae019b.png"><br><br>  b) Calculating the MAC and MAC2 values ‚Äã‚Äãinside the SIM card.  Formation of EAP on the WLAN side of the terminal. <br><br>  Advantages of the solution: <br>  - High degree of security when calculating GSM triplets <br>  - Work on various WLAN terminals, including PCs with different operating systems, but on condition that third-party software is also developed. <br>  Solution Minuses: <br>  - Since EAP packets will be formed and decrypted on the terminal side, there are some performance requirements, but given the modern terminal hardware, these risks are minimized. <br>  - It is necessary to create a new SIM card profile, finance the development of an applet on the SIM card <br>  - It is necessary to create third-party software for various operating systems of the phone and PC.  Given that the OS is constantly updated, it will be necessary to periodically release new software versions or updates. <br>  - The need to configure software in a WLAN device <br>  - If the subscriber wants to take advantage of the EAP-SIM he will need to change the SIM card <br><img src="https://habrastorage.org/storage2/62a/a23/8f5/62aa238f5aa2c143763db25085b94a38.png"><br><br>  c) Calculation of MAC &amp; MAC2 &amp; EAP packet values ‚Äã‚Äãon the WLAN side of the terminal. <br><br>  Advantages of the solution: <br>  - There are no specific requirements for the SIM card, existing SIM cards will do. <br>  - There is no need to install additional software on the terminal. <br>  - Before connecting to the WLAN network, the subscriber does not need to configure anything on the terminal side (except for iphone). <br><br>  Solution Minuses: <br>  - The average degree of security when calculating GSM triplets.  It should be noted that it is easy for a hacker to get GSM triplets without EAP-SIM technology, but simply by writing software with the RUN GSM Algorithm function.  Therefore, the main risks are associated with the possible penetration of Trojans to the WLAN terminal, which will intercept data for an already authorized session and use them in a relatively short period of time and on the same access point. <br>  - EAP-SIM support is required on the terminal side.  At the beginning of 2012, of the major vendors, EAP-SIM is supported only by some Nokia, iPhone, blackberry phones. <br><img src="https://habrastorage.org/storage2/b42/bf0/d0f/b42bf0d0f40f129970d0917e48824a0e.png"><br><br>  5) Equipment requirements for the operation and development of EAP-SIM authentication <br><br>  With the successful implementation of EAP-SIM authentication, users get the advantage of transparent and reliable authentication (without entering a login and password) and the ability to use corporate resources (without organizing a VPN channel).  Below are the requirements necessary for the operation of EAP-SIM / AKA authentication and conditions for rapid development: <br><br>  a) The need to use specific software on a computer and WLAN communicators that do not support EAP-SIM / AKA at the software and hardware level. <br>  b) Although there are several WLAN modems with EAP-SIM support at the hardware / software level (see section below), their number is very limited.  For WLAN modems with built-in EAP-SIM support, the need to use specific software is eliminated. <br>  c) For WLAN terminals that do not support EAP-SIM / AKA technology, you will have to use additional equipment in the form of a SIM reader, which greatly affects the usability of the service. <br>  d) A limiting factor in using WLAN networks on equipment that does not support EAP-SIM / AKA authentication is the need to remove the SIM card from a standard GSM phone.  The telephone connection, however, will be unavailable for the subscriber.  When using 2 SIM cards, this is not a limiting factor. <br>  e) AAA RADIUS of the guest WLAN server and home networks must support EAP-SIM / AKA authentication (in accordance with the recommendations of RFC 4186 and RFC 4187) and International Roaming Access Protocols (IRAP) protocols, which are not always guaranteed.  In the absence of this functionality, EAP-SIM / AKA roaming is not possible. <br><img src="https://habrastorage.org/storage2/5f2/5b5/23f/5f25b523f13e655ad30d1c43d4d5f46f.jpg"><br><br>  f) With a large number of WLAN users, the load on the operator Auc / HLR will increase <br>  g) With each EAP-SIM authentication on the Auc / HLR server, two or three standard GSM authentication is performed, which increases the load on the GSM network equipment (see RFC 4686 chapter 10) <br>  h) The operator Auc / HLR must be able to connect (via SS7 / MAP) to the AAA RADUIS WLAN server of the home provider <br>  i) The controller / access gateway of the WLAN provider must support EAP-SIM / AKA (in accordance with the recommendations of RFC 4186 and RFC 4187) <br>  j) EAP-SIM / AKA protocol support is required on the operator AUC / HLR side, in accordance with RFC 4186. This issue needs to be further developed. <br>  k) For the organization of inter-network roaming, i.e.  in order for a business WLAN network to serve any subscriber it is necessary that roaming agreements be concluded between business providers and a home WLAN provider <br>  l) Since the terminal uses the standard RUN GSM ALGORITHM request when working with a SIM / USIM card by WLAN, there are no specific requirements for a SIM / USIM card to implement EAP-SIM and EAP-AKA.  But when using the perspective method of EAP-SIM inside and EAP-SmartCard, the EAP-SIM protocol and associated cryptographic primitives will be executed in a protected area, therefore a special SIM card will be required. <br><br>  6) Standards <br><br>  - RFC 4186 EAP mechanism for GSM <br>  <a href="">ftp.isi.edu/in-notes/rfc4186.txt</a> (Recommendations) <br>  - RFC 4187 EAP mechanism for 3rd generation <br>  <a href="">ftp.isi.edu/in-notes/rfc4187.txt</a> (Recommendations) <br>  - RFC 2284: PPP Extensible Authentication Protocol (EAP) <br>  - WLAN-SIM Specification V 1.0 was released in 2004, however, is currently not available for reading on the site <br>  - WBA: Wireless Broadband Alliance <br>  <a href="http://www.wballiance.net/">www.wballiance.net</a> <br>  - FMCA: Fixed-Mobile Convergence Alliance <br>  <a href="http://www.thefmca.com/">www.thefmca.com</a> <br>  - Wireless-Link French Hot Spots Operators industry body <br>  <a href="http://www.w-link.org/public/wlink/html/fr/home/home.php">www.w-link.org/public/wlink/html/fr/home/home.php</a> <br>  - WLAN Alliance <br>  <a href="http://www.wlan.org/">www.WLAN.org</a> <br><br>  findings <br><br>  1. The main limiting factor in the development of EAP-SIM / AKA authentication is a very small base of user terminals supporting EAP-SIM / AKA protocols.  It requires pressure from international alliances for vendors to implement EAP-SIM / AKA functionality in WLAN devices. <br>  2. Subscriber operation in roaming is not guaranteed and depends on AAA RADIUS server support of the business WLAN IRAP network of protocols and EAP-SIM / AKA authentication.  An additional condition for subscriber work in roaming is roaming agreements. <br>  3. Specifications are very limited quantity.  At the same time, readily available specifications for the implementation of EAP-SIM / AKA exist as recommendations (RFC).  Other types of documents are either not available outside alliances or do not exist. <br>  4. At the network levels, for the implementation of EAP-SIM / AKA functionality, additional settings or installations are required on the WLAN AAA RADUIS server and AuC / HLR side. <br>  5. In terms of security, there are two ways to authenticate using SIM: EAP-SIM inside and EAP-SIM.  For EAP-SIM inside, EAP packets are generated inside the SIM card, which is safer, but requires special SIM cards and special terminals.  For EAP-SIM, the formation of EAP packets during authentication is performed on the terminal side; therefore, triplets of GSM triplets may leak, but standard SIM cards and any WLAN terminal with EAP-installed software can be used for this method. <br>  6. As stated in the RFC, the reliability of authentication when using EAP-SIM is no worse than in GSM. <br>  7. GSM network security when using EAP-SIM is quite high, since Kc values ‚Äã‚Äãin EAP-SIM are not transmitted to the network.  SRES is transmitted to the network in encrypted form.  If there is a hacker software on the WLAN terminal, there may be isolated cases of leakage of confidential authentication data.  Also, due to the presence of the final counter of authentication on the SIM card, in the presence of hacker software, there may be cases of blocking the SIM card. <br>  8. The successful launch of EAP-SIM authentication with the operator Swiss Mobile allows you to talk about the emergence of interest in this technology. </div><p>Source: <a href="https://habr.com/ru/post/142795/">https://habr.com/ru/post/142795/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142788/index.html">Twitter Bootstrap 2.0 - Russian PSD style library</a></li>
<li><a href="../142791/index.html">Google is building a new data center in the US</a></li>
<li><a href="../142792/index.html">Actors and AJAX</a></li>
<li><a href="../142793/index.html">Trial versions of CS6 are available for download from Adobe servers.</a></li>
<li><a href="../142794/index.html">"Crouching cars, hidden piano", or the theory of probability in action</a></li>
<li><a href="../142796/index.html">Determine which row was clicked in UIPickerView</a></li>
<li><a href="../142798/index.html">Google Street View in Donetsk</a></li>
<li><a href="../142799/index.html">Java Agent in Jelastic</a></li>
<li><a href="../142800/index.html">ASP.NET MVC: Conversion or injection? That is the question</a></li>
<li><a href="../142801/index.html">Shareware Building ASP.NET MVC Apps with EF Code First, HTML5, and jQuery</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>