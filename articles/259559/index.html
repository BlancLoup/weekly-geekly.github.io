<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Investigating a single hack or how to quickly and easily spend a billion</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="UPDATE: Hello everyone! Today I was surprised to learn from colleagues about this record. It turned out that my account was hacked - the representativ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Investigating a single hack or how to quickly and easily spend a billion</h1><div class="post__text post__text-html js-mediator-article">  <b>UPDATE: Hello everyone!</b>  <b>Today I was surprised to learn from colleagues about this record.</b>  <b>It turned out that my account was hacked - the representatives of Habrakhabr confirmed this and restored my access and now they understand how it happened.</b>  <b>But I leave this entry as it is for history.</b> <b><br></b>  <b>Yandex representatives have already noted in the comments: they say that the vulnerability is closed, software security is being audited.</b> <b><br><br></b>  <b>And, taking this opportunity, I want to remind you that the program ‚Äú <a href="http://corp.badoo.com/security/">Check Badoo for Strength</a> ‚Äù has been going on in <a href="http://habrahabr.ru/company/badoo/">Badoo</a> for several years and we are paying for the vulnerabilities found.</b> <br><br><img src="https://habrastorage.org/files/da6/e69/b45/da6e69b451c248e2a59f0c29fefebe27.png" align="right">  All around are constantly talking about corruption.  And I want to tell you about the case, corruption is very similar, but in the environment of pure IT business, the state is not tied to. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The case described below is interesting precisely from the point of view of hacking a business, although the article is more devoted to hacking in the sense of IT. <br><br>  I'll start with the non-technical part. <br><a name="habracut"></a><br>  My classmate friend works in the Moscow taxi business.  Works in this business for many years.  Several years ago, when a major player entered the Moscow taxi market (and now a monopolist), Yandex, then my friend, of course (like all the other small and major players in this business) also joined Yandex Taxi orders. <br><br>  For several years he has been working in <a href="http://taxi.yandex.ru/">Yandex.Taxi</a> using the software of <a href="http://rostaxi.itrf.ru/">ROSINFOTECH LLC</a> . <br><br>  Somewhere about six months ago, Yandex <a href="http://www.cnews.ru/top/2015/01/29/yandeks_kupil_servis_dlya_taksoparkov_vmeste_s_razrabotchikami_592138">acquired this company</a> and now this software is called Yandex.Taxometer or something like that. <br><br>  What is this software: this is a driver management kit (you can add / remove a car / driver), as well as accept / cancel the order. <br><br>  So, I promised that I would start with the non-technical part.  For several years this friend of mine has been complaining to me at personal meetings about the eternal Russian problem: ‚Äúthey are stealing‚Äù. <br><br>  Tells that they steal drivers, orders and even, according to rumors, money from QIWI-wallets ... <br><br>  I treated this somehow philosophically.  Well, the person complains about life.  The driver left (took him) to another company, and he thinks that it was stolen is a common story.  But this weekend, he still begged me: ‚ÄúIvan, yes, yes, you (as you say) are not a security specialist, but see how they can steal drivers from me?  You're an IT person, after all! ‚Äù <br><br>  We sat with him in a cafe with WiFi and began to look. <br><br>  I‚Äôll finish non-technical introductory by saying that, according to rumors, among the companies working with Yandex-Taxi, which also come from Rosinfoteh, Yandex acquired the above software for a billion. <br><br>  <b>Remember this number, we will need it at the end of the article</b> . <br><br>  So, the entry is over, let's move on to the technical part. <br><br>  He gave me a login / password from his personal account in the control room, and I went in there. <br><br>  Everything is simple there: list of drivers: add / remove / block / print.  Reports, orders, etc.  Climbing a bit on the pages, I noticed that almost the entire site is built on the fact that <a href="https://ru.wikipedia.org/wiki/UUID">UUIDs</a> appear in the links or queries. <br><br>  By clicking on the driver, you can see that the driver's UUID appears in the information link for him. <br><br>  Then it became interesting to find out three questions: <br><br><ul><li>  is it possible to find out the driver's uuid of a foreign company </li><li>  is it possible, knowing this UUID, to get information about a foreign driver (actually, what my friend was complaining about) </li><li>  is it possible to get access to the orders of drivers of other companies </li></ul><br><br>  Having walked through the pages of my personal account, I noticed that the UUID is also assigned to companies too. <br><br>  ‚ÄúAha!‚Äù I thought and began to ask my friend if he knew what a UUID is and if he used it somewhere.  He says: ‚ÄúYes, in Yandex‚Äôs private office I pointed out the URL to the API‚Äù.  ‚ÄúCome here,‚Äù I say, ‚Äúthis url.‚Äù  He gives me something like this <code>sync.yandex.taxi.itrf.ru/drivers/&lt;UUID&gt;</code> .  We look at this URL and see - all drivers of my friend‚Äôs company are convenient for parsing - XML.  <b>Without authorization</b> . <br><br>  It remains to learn the UUID of other companies.  How to do it?  As I said above, in some places on the site, a clanky Ctrl-U in the browser shows the UUID of other companies, but I was interested to get the UUID addresses of ALL companies using this software.  We rummaged around the urls for about half an hour, using Ctrl-U, and found at once many ways to do this. <br><br>  For example, this beautiful JSON tells us a similar list: <br><br><img src="https://habrastorage.org/files/8c6/844/93b/8c684493ba8843b3a35d92883120c3e0.png" alt="List of Companies in JSON"><br><br>  Please note that the list <b>affects all regions of the country</b> at once, not only Moscow. <br><br>  Well, or similar lists are found in various selets, lists, etc.  There are many such places.  However, we continue further. <br><br>  It became interesting to return to the driver cards and consider them closer.  To do this, we chose one of the Moscow companies - we took XML with all its drivers (which, as described above, is available without authorization) and continued to experiment on it. <br><br><img src="https://habrastorage.org/files/9e7/54e/0bf/9e754e0bfc064476a8424568cd3ec340.png" alt="A lot of XML with partners of Yandex"><br><br>  We took a couple of drivers from this XML, entered their UUID in a card in your account.  We looked at the driver card.  Ratings, when I took a taxi exam, license numbers and so on - everything is clear.  <b>Information about any driver (including someone else) is available by urla with a UUID</b> . <br><br>  It is like extended information (more than the above XML). <br><br>  Probably, the developers of this software about the concepts of "authorization", "authentication" have not heard, and even more so about the difference between them. <br><br>  In the same place, sitting in a cafe, I sketched a script in Python, and after 20 minutes we had a database of all Yandex.Taxi drivers in all cities (not only in Moscow) with their phones, ratings, license numbers, license numbers, account balances and other private information. <br><br>  We got something like this XLS file: <br><br><img src="https://habrastorage.org/files/aab/2b3/c5f/aab2b3c5ff6d4b48b4c607974be8009d.png" alt="Unloading drivers"><br><br>  So I got a physical evidence of more than two years of my friend's suspicion about driver theft. <br><br>  Then it became interesting to look a little wider at this problem: the availability of these UUIDs without authorization at all.  It turned out, and it is! <br><br>  This software offers a fairly wide range of related services.  For example, a taxi order web form on the website of the client company. <br><br>  Looking (Ctrl-U) at several partner sites Yandex-taxi, how do you think I found there?  Right!  UUID of these companies, by which (remember) you can get all the drivers for free. <br><br>  Thus, I do not exclude that any search engine (including Yandex) once will index all these private data of companies and people. <br><br>  Then we looked at another resource <b>without authorization of</b> this company.  In public access is a real-time log of all orders in Yandex-taxi.  You can see who is assigned to what is happening to him, who performs, the address of filing and so forth. <br><br><img src="https://habrastorage.org/files/adb/ba5/9c7/adbba59c765343e8afad46f9765cfad1.png" alt="Order log"><br><br>  Pressing Ctrl-U on this page, we see the ID of the order, the company for which it is assigned. <br><br>  So we got to the bottom of ID orders of other companies on an unauthorized page (on authorized ones, they also exist, but I repeat: it was interesting to find on an unauthorized one). <br><br>  Further, using the tools available in different parts of your personal account, we can not only observe, but also <b>influence the process</b> : for example, you can depict the cancellation of an order for someone else‚Äôs company, and send the car instead of it! <br><br>  For the driver, it will look like canceling an order.  For the client - as ‚Äúanother car arrived‚Äù. <br><br>  It's just some kind of Klondike for someone who is configured for dishonest ways of doing business! <br><br><div class="spoiler">  <b class="spoiler_title">but we are not</b> <div class="spoiler_text">  Hence the article :) </div></div><br><br>  The most interesting thing is that this is not just any one hole, but all of the software is entirely, the whole service is built on the fact that there is no ANY information protection.  The product is simply a sort of database records viewer without any protection between users. <br><br>  Imagine having logged in to Google, you could see all the mail of ALL Google users.  Here is about such a case. <br><br>  However, we will continue.  The complex contains another application for android.  Taking the application "Taximeter" from the <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.taximeter.android">android market,</a> we quickly found out that it makes <b>requests for unauthorized urls</b> .  And the first unauthorized http request that makes this application - guess which one? <br><br>  That's right, a complete list of UUID-company name pairs! <br><br>  Using URLs taken from this application, you can: <br><br><ul><li>  take / cancel orders on behalf of other drivers, </li><li>  write broadcast and address messages (for example, job offers) to other drivers, </li></ul><br>  and so on. <br><br>  Here I received another confirmation that not only drivers can be stolen, but also orders from these drivers. <br><br>  They say that cunning people have even released a special application on this topic for intercepting Yandex.Taxi orders.  It‚Äôs a pity, they just didn‚Äôt post an Android market (or did they post it? We‚Äôd have to look at the paid sections of the market). <br><br>  Well, now let's think a little about the topic about which I wrote at the beginning. <br><br>  Corruption or not corruption. <br><br>  Yes, Yandex is a private company.  The word "corruption" does not apply to it.  However, an interesting question arises: here Yandex buys for a huge amount of money (billion) a software package.  At the same time, judging by the above picture, NO technical audit of this software package has been performed. <br><br>  What I found (an ordinary IT person) in a couple of hours of digging at a cafe, a security specialist would have found without much difficulty, but the question is: why didn't this specialist (of which Yandex have enough) not even look into this complex for a billion? <br><br>  Do you think this complex was purchased using the kickback system, or not? <br><br>  It seems to me that, conducting a transaction for a billion, I don‚Äôt have to allocate 10 thousand rubles for one working day of a specialist to conduct an audit ... ugh ... or conscious negligence, or just want to get rid of a billion quickly. <br><br>  The explanation that this is bought using a rollback is, in my opinion, the most logical one. <br><br>  An interesting question: who in Yandex made the decision to buy such a ‚Äúbig hole‚Äù?  Probably, they should start with him to clarify the circumstances of the purchase of the Yandex.S. <br><br><hr><br>  PS: After we looked at the Taximeter from the android market, we also looked into the application device for ordering a taxi from the same market - <a href="https://play.google.com/store/apps/details%3Fid%3Dru.yandex.taxi">Yandex.Taxi</a> .  What is depressing - the situation there is very similar.  It was clearly made by people far from not only security issues, but also from HighLoad programming issues. <br><br>  However, this is a completely different story, you can write a separate article about it. <br><br>  PPS: Recently, Yandex.Taxi introduced payment of travel by credit cards.  I personally feel scared now to pay for the trip with a credit card.  And you? <br><br><hr><br><br>  <b>UPD:</b> Yandex is notified of the problem, so here I propose to discuss the method of hacking into the Yandex.Taxi business used by the comrades from the above company.  One can only express admiration for the business abilities of these people.  Agree, to dissolve the largest company of the RuNet for such money without any quality check of the code being used - this is not to sell you old women vacuum cleaners ... </div><p>Source: <a href="https://habr.com/ru/post/259559/">https://habr.com/ru/post/259559/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259547/index.html">Primer Programming Tutorial</a></li>
<li><a href="../259549/index.html">How to identify duplicate pictures using PHP</a></li>
<li><a href="../259551/index.html">Dell comes to the rescue of video production studio.</a></li>
<li><a href="../259553/index.html">Static Analysis of Wireshark with PVS-Studio</a></li>
<li><a href="../259555/index.html">Attackers use Linux / Moose to compromise Linux-embedded systems, part 3</a></li>
<li><a href="../259561/index.html">A selection of courses on the development of games from Microsoft</a></li>
<li><a href="../259563/index.html">Localization RC (C ++, MFC, Win32)</a></li>
<li><a href="../259565/index.html">Talking with first customers</a></li>
<li><a href="../259567/index.html">Setting an object property using lambda expressions</a></li>
<li><a href="../259569/index.html">BSON injection in MongoDB adapter for Ruby</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>