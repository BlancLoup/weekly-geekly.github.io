<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>React-testing-library library overview</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the material that we are publishing today, Kent Dodds talks about the self-developed library for testing React applications, the react-testing-libr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>React-testing-library library overview</h1><div class="post__text post__text-html js-mediator-article">  In the material that we are publishing today, Kent Dodds talks about the self-developed library for testing React applications, the <a href="https://github.com/kentcdodds/react-testing-library">react-testing-library</a> , in which he sees a simple tool that can replace the <a href="http://airbnb.io/enzyme/">enzyme</a> and promote writing quality tests using advanced techniques in this area. . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/765/bfc/501/765bfc501f6667f439675ea43a76e643.jpg"></div><br>  The author of the material said that he had long thought about something similar, and as a result, around the middle of last month, he <a href="https%253A%252F%252Fblog.kentcdodds.com%252Fmedia%252Fbe99c7963bd007a10cdb030c10f46317%253FpostId%253De3a274307e65">decided to</a> start developing a library for testing that would suit him.  In particular, in the enzyme he did not like the fact that most of the capabilities of this library incline the developer to not the best test preparation methods that can harm the project.  As a result, he got a simple but self-contained set of tools for testing React DOM. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">React-testing-library library overview</font> </h2><br>  Suppose you are going to write tests for React components.  You want these tests to be convenient to maintain.  In addition, you need to ensure that the tests do not rely on the details of the implementation of the components and test the components in conditions close to the actual scenarios of their use.  In addition, you strive to ensure that the tests would remain working in the long term, that is, you want to refactor components (that is, change their implementation, but not functionality) would not violate the testing system and not force you or your team constantly rewrite tests, slowing down the work on the project. <br><br>  What to choose to achieve these goals?  In our case, the answer to these questions was the <code>react-testing-library</code> , a minimalist solution designed for testing React components. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d23/07b/80c/d2307b80cdfb223a3f777cdcc75148bc.png"></div><br>  <i><font color="#999999">React-testing-library logo</font></i> <br><br>  This library gives the developer simple tools built on the basis of <code>react-dom</code> and <code>react-dom/test-utild</code> , and the library is designed so that the one who uses it, without any problems would apply in his work best testing practices.  The <code>react-testing-library</code> is based on the <a href="https%253A%252F%252Fblog.kentcdodds.com%252Fmedia%252Fa7c0bd4c78b2a36c7b9d996543a5d851%253FpostId%253De3a274307e65">following</a> principle: the more the testing process resembles a real session with an application ‚Äî the more confidently we can say that when an application gets into production, it will work as expected. <br><br>  As a result, instead of working with instances of React's rendered components, tests will interact with real DOM nodes.  The mechanisms provided by the library perform calls to the DOM in the same way that project users would do.  The search for elements is carried out by the text of their tags (as users do), the search for links and buttons also occurs by their texts (and this is typical for users).  In addition, here, as an ‚Äúemergency exit‚Äù, it is possible to apply the search for elements by <code>data-testid</code> .  This is a common practice that allows you to work with elements whose signatures are meaningless or impractical for a given purpose. <br><br>  The considered library helps to increase the availability of applications, helps bring tests to real work scenarios. <br><br>  The <code>react-testing-library</code> is a replacement for the <a href="http://airbnb.io/enzyme/">enzyme</a> .  Using the <code>enzyme</code> , you can follow the same principles that are laid down in the library considered here, but in this case they are more difficult to adhere because of the additional funds provided by the <code>enzyme</code> (that is, everything that helps in the details of the test implementation).  Details about this can be found <a href="">here</a> . <br><br>  In addition, although the <code>react-testing-library</code> intended for <code>react-dom</code> , it is also suitable for React Native through the use of this small <a href="https://github.com/kentcdodds/react-testing-library/issues/22">configuration file</a> . <br><br>  Immediately it should be said that this library is not a means for running tests or a framework.  In addition, it is not tied to a certain framework for testing (although we recommend Jest, but this is just a tool that we prefer to use, in general, the library will work with any framework and even in <a href="https://codesandbox.io/s/5z6x4r7n0p">CodeSandbox</a> environment!). <br><br><h2>  <font color="#3AC1EF">Practical example</font> </h2><br>  Consider the following code demonstrating a practical example of working with the <code>react-testing-library</code> . <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {render, Simulate, wait} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-testing-library'</span></span> //      <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'react-testing-library/extend-expect'</span></span> // Mock-    __mocks__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axiosMock <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GreetingFetcher <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../greeting-fetcher'</span></span> test(<span class="hljs-string"><span class="hljs-string">'displays greeting when clicking Load Greeting'</span></span>, async () =&gt; { //  Arrange axiosMock.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>.mockImplementationOnce(({<span class="hljs-type"><span class="hljs-type">name</span></span>}) =&gt;   Promise.resolve({     data: {greeting: `Hello ${<span class="hljs-type"><span class="hljs-type">name</span></span>}`}   }) ) const {   getByLabelText,   getByText,   getByTestId,   container } = render(&lt;GreetingFetcher /&gt;) //  Act getByLabelText(<span class="hljs-string"><span class="hljs-string">'name'</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-string"><span class="hljs-string">'Mary'</span></span> Simulate.click(getByText(<span class="hljs-string"><span class="hljs-string">'Load Greeting'</span></span>)) //   mock- `<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>` //       ,      await wait(() =&gt; getByTestId(<span class="hljs-string"><span class="hljs-string">'greeting-text'</span></span>)) //  <span class="hljs-keyword"><span class="hljs-keyword">Assert</span></span> expect(axiosMock.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>).toHaveBeenCalledTimes(<span class="hljs-number"><span class="hljs-number">1</span></span>) expect(axiosMock.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>).toHaveBeenCalledWith(url) //  ! expect(getByTestId(<span class="hljs-string"><span class="hljs-string">'greeting-text'</span></span>)).toHaveTextContent(   <span class="hljs-string"><span class="hljs-string">'Hello Mary'</span></span> ) //       DOM! expect(container.firstChild).toMatchSnapshot() })</code> </pre> <br>  The most important thing that can be learned from this example is that the tests resemble work with a real user application. <br><br>  Continue to analyze this code. <br><br>  <code>GreetingFletcher</code> can display some HTML code, for example, like this: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name-input"</span></span></span><span class="hljs-tag">&gt;</span></span>Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"name-input"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span>Load Greeting<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-testid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"greeting-text"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  When working with these elements, the following sequence of actions is expected: set a name, click on the <code>Load Greeting</code> button, which will cause a request to the server to load some text in which the specified name is used. <br><br>  In the test, you will need to find the <code>&lt;input /&gt;</code> field, as a result, you can set its <code>value</code> parameter to a certain value.  Common sense suggests that you can use the <code>id</code> property in the CSS selector: <code>#name-input</code> .  But is the user doing this to find the input field?  Definitely not so!  The user looks at the screen and finds the field with the signature <code>Name</code> in which he enters the data.  Therefore, this is exactly what our test with <code>getByLabelText</code> .  It detects a control based on its label. <br><br>  Often in tests created on the basis of the <code>enzyme</code> , to search for a button, for example, with the inscription <code>Load Greeting</code> , a CSS selector is used or a search is made on the <code>displayName</code> of the component constructor.  But when the user wants to download some text from the server, he does not think about the details of the program‚Äôs implementation, instead he searches for the button labeled <code>Load Greetings</code> and clicks on it.  This is exactly what our test does with the help of the <code>getByText</code> helper function. <br><br>  In addition to this, the <code>wait</code> construct, again, simulates user behavior.  Here organized waiting for the appearance of text on the screen.  The system will wait as long as necessary.  In our test, we use a mock object for this, so the text is output almost instantly.  But our test doesn't care how long it takes.  We do not need to use <code>setTimeout</code> or something similar in the test. <br><br>  We simply inform the test: ‚ÄúWait until the greeting-text node appears.‚Äù  Note that in this case, the <code>data-testid</code> attribute is used; that same ‚Äúemergency exit‚Äù used in situations where searching for elements using some other mechanism does not make sense.  In such cases, <code>data-testid</code> <a href="https://blog.kentcdodds.com/making-your-ui-tests-resilient-to-change-d37a6ee37269">definitely better</a> than alternative methods. <br><br><h2>  <font color="#3AC1EF">API overview</font> </h2><br>  At the very beginning, the library gave the developer only the <code>queryByTestId</code> method.  Read about it <a href="https://blog.kentcdodds.com/making-your-ui-tests-resilient-to-change-d37a6ee37269">here</a> .  However, due to the response to the above publication and this fantastic <a href="https://www.youtube.com/watch%3Fv%3DqfnkDyHVJzs%26feature%3Dyoutu.be%26t%3D5h39m19s">performance</a> , additional methods were added to the library. <br><br>  Details about the library and its API can be read in the <a href="https://github.com/kentcdodds/react-testing-library">official documentation</a> .  Here is a general overview of its capabilities. <br><br><ul><li>  <a href="">Simulate</a> - re-export from <a href="https://reactjs.org/docs/test-utils.html">Simulate</a> <code>react-dom/test-utils</code> . <br></li><li>  <a href="">wait</a> - allows you to organize the waiting in tests for an indefinite period of time.  Usually you should use mock-objects for <a href="">requests</a> to the API or <a href="">animations</a> , but even when working with immediately resolved promises, you need the tests to wait for the next tick of the event cycle.  The <code>wait</code> method is great for this.  (Many thanks to Lukash Gandertsky, who <a href="https://github.com/kentcdodds/react-testing-library/issues/21">suggested</a> this as a replacement for <code>flushPromises</code> API, which is now considered obsolete). <br></li></ul><br><ul><li>  <a href="">render</a> : the whole essence of the library is hidden here.  In fact, this is a fairly simple function.  It creates a <code>div</code> element using <code>document.createElement</code> , then uses <code>ReactDOM.render</code> to output data to this <code>div</code> . <br></li></ul><br>  The <code>render</code> function returns the following objects and utility functions: <br><br><ul><li>  <a href="">container</a> : the <code>div</code> element into which the component was drawn. <br></li><li>  <a href="">unmount</a> : a simple wrapper around <code>ReactDOM.unmountComponentAtNode</code> to unmount a component (for example, to simplify testing <code>componentWillUnmount</code> ). <br></li><li>  <a href="">getByLabelText</a> : gets a form control based on its label. <br></li><li>  <a href="">getByPlaceholderText</a> : placeholders are not very good alternatives to tags, but if it makes sense in a particular situation, you can use them. <br></li><li>  <a href="">getByText</a> : gets the element by its text content. <br></li><li>  <a href="">getByAltText</a> : gets an element (sort of) by the value of its <code>alt</code> attribute. <br></li><li>  <a href="">getByTestId</a> : gets an element by its <code>data-testid</code> . <br></li></ul><br>  Each of these helper getters produces an informative error message if the item cannot be found.  In addition, there is a set of similar query methods (like <code>queryByText</code> ).  They, instead of giving an error when there is no element, return <code>null</code> , which can be useful if you need to check the DOM for the absence of the element. <br><br>  In addition, the following can be passed to these methods to search for the desired item: <br><br><ul><li>  Case-insensitive string: for example, <code>lo world</code> will match <code>Hello World</code> . <br></li><li>  Regular expression: for example, <code>/^Hello World$/</code> will match <code>Hello World</code> . <br></li><li>  A function that accepts text and an element: for example, using a function <code>(text, el) =&gt; el.tagName === 'SPAN' &amp;&amp; text.startsWith('Hello')</code> will result in the selection of a <code>span</code> element whose text content begins with <code>Hello</code> . <br></li></ul><br>  It should be noted that thanks to <a href="https://github.com/antoaravinth">Ento Ryan</a> , the library has its own matchmakers for Jest. <br><br><ul><li>  <a href="">toBeInTheDOM</a> : checks if an element is present in the DOM. <br></li><li>  <a href="">toHaveTextContent</a> : checks if the specified element has text content. <br></li></ul><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  The main feature of the <code>react-testing-library</code> is that it does not have auxiliary methods that allow you to test the implementation details of components.  It is aimed at developing tests that promote the application of best practices in the field of software testing and development.  We hope the <a href="https://github.com/kentcdodds/react-testing-library">react-testing-library</a> is useful for you. <br><br>  <b>Dear readers!</b>  Do you plan to use the react-testing-library in your projects? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/353076/">https://habr.com/ru/post/353076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353066/index.html">ITSM literacy program: 7 ways to diagnose the causes of IT incidents and problems</a></li>
<li><a href="../353068/index.html">Sending mail from the Docker container (postfix and sasl dokerization)</a></li>
<li><a href="../353070/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ309 (April 2 - 8, 2018)</a></li>
<li><a href="../353072/index.html">Developing native extensions for Node.js</a></li>
<li><a href="../353074/index.html">About the main reason for the existence of modern JS frameworks</a></li>
<li><a href="../353080/index.html">Misconceptions about automated testing</a></li>
<li><a href="../353082/index.html">Desperate quad circle search</a></li>
<li><a href="../353084/index.html">Digital Signature Cloud Services</a></li>
<li><a href="../353088/index.html">We write the plugin for Unity correctly. Part 1: iOS</a></li>
<li><a href="../353090/index.html">IT asset management: how myths affect projects (Part 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>