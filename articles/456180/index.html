<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How did I find my first vulnerability?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 Hello. I am 20 years old. More recently, I studied at a lyceum and was preparing to enroll in a medical college, and now I am a full-servic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How did I find my first vulnerability?</h1><div class="post__text post__text-html js-mediator-article"><h3>  Foreword </h3><br>  Hello.  I am 20 years old.  More recently, I studied at a lyceum and was preparing to enroll in a medical college, and now I am a full-service developer in an American company.  In fact, I am very glad that I didn‚Äôt work out with medicine - programming was my hobby, and now I can do it all the time.  Now I would like to write more likely not about success in IT.  Right now I want to talk about how I read a couple of books on vulnerabilities (to protect my projects) and I managed to put this knowledge into practice. <br><br><h3>  Disclaimer </h3><br>  All materials, screenshots, as well as links to third-party resources are posted for educational purposes.  The author is not responsible for their use by other visitors of Habr.  The company was notified in advance of 48 hours of the vulnerability and received enough data to fix it. <br><a name="habracut"></a><br><h2>  How it all began </h2><br>  It was quite an ordinary day.  I did a few tasks at work and made myself a cup of coffee.  For one, I decided to read <a href="https://morioh.com/p/d65bafd88b10">one article</a> about deployments on AWS, which I once repost myself in VK (by the way, I never read the article).  In the column to the right of the article, several other articles and a <b>partner banner for the hosting provider are</b> displayed. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f8/47a/a34/8f847aa343de32b3f8e385a1d691259b.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I do not remember what exactly made me go to the site, but when I went, I noticed one interesting feature: the link leads to the registration page and one field is immediately filled in - the promotional code. <br><br>  If you compare the promotional code that is in the input field and in the address bar - we will see that they are completely the same. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/458/0be/bcc/4580bebcc578ee1a923cd2973093c0d9.png" alt="image"><br><br><h2>  What can we do about it? </h2><br>  Trite - try to change.  If the promotional code is compared with the value in the database - with a high probability we will get an error.  But If you change the input, there is no request to the server and it turns out that the input is checked only when you press the registration button. <br><br>  I think here it is already possible to do something more interesting: we change our promo code right in the address bar and see what happens.  If they do not have a promotional code specifically for Habr, which I guessed right away, <s>as well as another hundred different character sets</s> - we can definitely change the values ‚Äã‚Äãof the input field using the address link. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b5/dad/ca0/2b5dadca07aa57c01f7af71162effabf.png" alt="image"><br><br>  The next step is to look at the HTML code.  PCM by input field -&gt; View item code. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e5/76c/6f0/1e576c6f0af03c3e06c7db8f0374af68.png" alt="image"><br><br>  It is immediately clear that we are changing the value of the input field.  Let's try to get out of it and add for example a link.  For this we just need to change the link and we can change the page content: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f36/e33/a28/f36e33a28083d6c544d340f54ba51676.png" alt="image"><br><br>  Result: we have just found an xss vulnerability on the site hosting provider. <br><br><h2>  So, what is next? </h2><br>  I think it is worth going deeper.  Link - somehow small and not interesting.  We want to tell all this to the owners of the service and, ideally, to receive a reward (the company, by the way, does not have a bug bounty, which means all this is not paid, but then I didn‚Äôt know about it yet).  Let's try to place the block, zastilzovit it and insert the image.  What is needed for this?  all the same - change the url. <br><br>  I think to describe html and css is not worth it, so I just put here what happened.  Habr blocks part of the tags, others discards - I can not put the link code here. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e4d/22c/2e0/e4d22c2e0478fcd98e3804d8125792bc.png" alt="image"><br><br>  <a href="https://t3.ftcdn.net/jpg/01/24/58/72/500_F_124587212_X7kwCwCusZmy3B3IT54opKPU2077akTx.jpg%2520/%253E%253C/div%253E">I'll post a link here.</a>  <a href="https://t3.ftcdn.net/jpg/01/24/58/72/500_F_124587212_X7kwCwCusZmy3B3IT54opKPU2077akTx.jpg%2520/%253E%253C/div%253E">I do not know if it works at the moment, but it worked when laying out the post.</a>  <a href="https://t3.ftcdn.net/jpg/01/24/58/72/500_F_124587212_X7kwCwCusZmy3B3IT54opKPU2077akTx.jpg%2520/%253E%253C/div%253E">To whom it is necessary - will pull out the link and parsit.</a> <br><br><h3>  Reward </h3><br>  Do not think that upCloud completely refused to pay.  Instead, they offered their services for free.  But I refused this type of payment, because I‚Äôm not interested in renting a server now. <br><br><h3>  How can I exploit this vulnerability? </h3><br>  Everything is simple: you can start with collecting data from all new users, and finish with phishing sites and use someone else‚Äôs hosting as your own.  You can replace all links on the page with your own or replace the form with users.  It is enough to send them as referrals.  And of course, you can substitute the request to the server from the form so that it does not check the promotional code (when registering, the promotional code is checked and the client returns an error with an error, but this is all solved by switching on). <br><br><h2>  What the developers forgot to do: </h2><br>  It's simple - validate user input.  SQL-Inj does not work there - the service hangs on WordPress, and it, in turn, processes incoming lines. <br><br>  Therefore, we can: <br><br><ol><li>  Check the promo code with the base when rendering the page <br><br>  It is slow and not justified.  It is not worth the additional load on the base, and there is no point in this if it is checked all the same during registration. <br></li><li>  Run through the regular entrance code <br><br>  / [A-Z0-9] / g - enough to validate values ‚Äã‚Äãand protect against vulnerability.  And it works faster than a request to the database, and the effect is not worse - XSS is removed. <br></li></ol><br><h2>  Conclusion </h2><br>  The owners of the service were notified 48 hours + 2 days before that, I had been negotiating via email and LinkedIn with those who are at least somehow involved in the development.  All the conversations came to: "Please tell us how you did it, but we, of course, will not pay for the vulnerabilities."  I also add that in the same way the site accepts third-party js-scripts: both through a third-party source and by direct writing the code, however, in the second case, Google Chrome automatically detects xss and renders the error page instead of the service page. <br><br>  I hope each programmer will validate all input data and will not forget about querystring.  And I am also sure that the article was to help someone notice in advance + fix this problem in their country. <br><br>  Thank you very much for your attention. </div><p>Source: <a href="https://habr.com/ru/post/456180/">https://habr.com/ru/post/456180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456168/index.html">Where was your home millions of years ago?</a></li>
<li><a href="../45617/index.html">uTorrent for makovodov</a></li>
<li><a href="../456170/index.html">How to create an application for finance: 5 API to help the developer</a></li>
<li><a href="../456174/index.html">How to organize a hackathon as a student 101. Part Two</a></li>
<li><a href="../456178/index.html">Themes and styles in Android without magic. And how to cook them with SwitchCompat</a></li>
<li><a href="../456184/index.html">Software Defined Radio - how does it work? Part 8</a></li>
<li><a href="../456188/index.html">Token, refresh token and creating an asynchronous wrapper for the REST request</a></li>
<li><a href="../45619/index.html">DreamSpark now and on student tickets</a></li>
<li><a href="../456194/index.html">Cheat Sheet by Data Structures in Go</a></li>
<li><a href="../456196/index.html">The main misconceptions about SCRUM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>