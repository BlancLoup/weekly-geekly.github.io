<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Codeception - testing in a new way</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PHP is a very popular programming language, but testing it is more of an expert prerogative than a vital necessity. Is it really from the fact that PH...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Codeception - testing in a new way</h1><div class="post__text post__text-html js-mediator-article">  PHP is a very popular programming language, but testing it is more of an expert prerogative than a vital necessity.  Is it really from the fact that PHP developers are all cattle-coders?  I think not.  Rather, all of the fact that testing systems are sometimes unnecessarily complicated.  And tests, on the contrary, should have been extremely simple: easy to read, write, debug, and of course, quickly run.  My vision of how this can be translated into PHP resulted in a project called <a href="http://codeception.com/">Codeception</a> . <br><br>  With it, tests for your web applications might look like this: <br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $I = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TestGuy($scenario); $I-&gt;wantTo(<span class="hljs-string"><span class="hljs-string">'create new blog post'</span></span>); $I-&gt;amOnPage(<span class="hljs-string"><span class="hljs-string">'/blog/posts'</span></span>); $I-&gt;click(<span class="hljs-string"><span class="hljs-string">'Create new post'</span></span>); $I-&gt;fillField(<span class="hljs-string"><span class="hljs-string">'Title'</span></span>,<span class="hljs-string"><span class="hljs-string">'Codeception, a new way of testing!'</span></span>); $I-&gt;fillField(<span class="hljs-string"><span class="hljs-string">'Text'</span></span>,<span class="hljs-string"><span class="hljs-string">'Codeception is new PHP full-stack testing framework.'</span></span>); $I-&gt;click(<span class="hljs-string"><span class="hljs-string">'Send'</span></span>); $I-&gt;see(<span class="hljs-string"><span class="hljs-string">'Congratulations, your post is successfully created!'</span></span>);</code> </pre> <br><br>  Agree, such a test is clear without additional comments. <br>  And now the most interesting thing: without any changes, this code can be executed as a functional test in the <b>symfony</b> , <b>Symfony2</b> , <b>Zend Framework frameworks</b> , as well as in the Goutte browser emulator and even through <b>Selenium</b> .  Thus, you are offered a single interface for writing functional tests for virtually any site. <br><a name="habracut"></a><br>  In <a href="http://codeception.com/">Codeception</a> , you describe the entire test as a script in the simplest possible way.  You repeat the actions of the user who uses your web application: clicks on links, fills out forms and expects to see some result.  It would be logical to write a test that would accurately reflect his actions.  At the same time, the process of writing a test is extremely simple, if you use autocompletion in your IDE: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/abf/4b6/85a/abf4b685acf8389072ceb12863a6fbc7.png"><br><br>  Codeception runs on three pillars: <br>  - how the test environment is used by <a href="http://www.phpunit.de/">PHPUnit</a> . <br>  - for acceptance tests - <a href="http://mink.behat.org/">Mink</a> .  For him, <a href="https://habrahabr.ru/users/everzet/" class="user_link">many</a> thanks to Konstantin Kudryashov <a href="https://habrahabr.ru/users/everzet/" class="user_link">everzet</a> . <br>  - and of course, <a href="http://symfony.com/">symfony components</a> .  They are used for almost everything.  Of particular note is BrowserKit, which is used for functional tests. <br><br>  To get started, set up a Codeception via PEAR: <br><br><pre> <code class="hljs ruby">$ pear channel-discover codeception.com/pear $ pear install codeception/Codeception</code> </pre> <br><br>  Now install the necessary dependencies. <br><pre> <code class="hljs sql">$ codecept <span class="hljs-keyword"><span class="hljs-keyword">install</span></span></code> </pre> <br><br>  Select the project that you want to test and execute in its root command. <br><br><pre> <code class="hljs ruby">$ codecept bootstrap $ codecept build</code> </pre> <br><br>  The bootstrap command will create a configuration file and a tests folder for three categories of tests: <br><br>  - unit <br>  - functional <br>  - acceptance <br><br>  It is important to note that we distinguish between functional and acceptance tests.  The latter require a web server, on which it will be tested using the same Goutte or Selenium.  Functional applications run the application within the test itself, as is the case, for example, when testing in Symfony or the Zend Framework. <br><br>  The easiest way to start is to write an acceptance test.  In the tests / acceptance directory, create a new StartPageCept.php file: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $I = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebGuy($scenario); $I-&gt;wantToTest(<span class="hljs-string"><span class="hljs-string">'front page of my site'</span></span>); $I-&gt;amOnPage(<span class="hljs-string"><span class="hljs-string">'/'</span></span>); $I-&gt;see(<span class="hljs-string"><span class="hljs-string">'A sample text on my site'</span></span>);</code> </pre><br><br>  It checks that there is a text on the main page of your site: 'A sample text on my site'.  Enter in see the text that is really there, and your test is ready to run. <br>  But before you start it, remember that acceptance tests require that the site be run inside the web server.  So it is necessary to inform the url through which you can access our site.  Open the file: tests / acceptance.suite.yml <br><br><pre> <code class="hljs lua"> <span class="hljs-built_in"><span class="hljs-built_in">config</span></span>: PhpBrowser: url: <span class="hljs-string"><span class="hljs-string">'   url  '</span></span></code> </pre><br><br>  Now run. <br><br><pre> <code class="hljs ruby">$ codecept run acceptance</code> </pre> <br><br>  And you will see something like this: <br><br><pre> <code class="hljs pgsql">Suite acceptance started Trying <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> see front page <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> my site (StartPageCept) - Ok <span class="hljs-type"><span class="hljs-type">Time</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> second, Memory: <span class="hljs-number"><span class="hljs-number">21.00</span></span>Mb OK (<span class="hljs-number"><span class="hljs-number">1</span></span> test, <span class="hljs-number"><span class="hljs-number">1</span></span> assertions)</code> </pre><br><br>  Now you can start writing more complex tests for your application.  For example, a test for authorization on a site might look like this: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $I = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebGuy($scenario); $I-&gt;wantTo(<span class="hljs-string"><span class="hljs-string">'log in as regular user'</span></span>); $I-&gt;amOnPage(<span class="hljs-string"><span class="hljs-string">'/login'</span></span>); $I-&gt;fillField(<span class="hljs-string"><span class="hljs-string">'Username'</span></span>,<span class="hljs-string"><span class="hljs-string">'davert'</span></span>); $I-&gt;fillField(<span class="hljs-string"><span class="hljs-string">'Password'</span></span>,<span class="hljs-string"><span class="hljs-string">'qwerty'</span></span>); $I-&gt;click(<span class="hljs-string"><span class="hljs-string">'Login'</span></span>); $I-&gt;see(<span class="hljs-string"><span class="hljs-string">'Hello, davert'</span></span>); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br><br>  Read more about writing tests in the <a href="http://codeception.com/">documentation</a> . <br><br>  To perform one of these tests inside the framework, you must copy the test into 'tests / functional', and edit the file test / functional.suite.yml. <br>  I‚Äôll give an example for Symfony2, but in absolutely the same way you can connect Zend Framework or symfony, as well as Doctrine1 or Doctrine2. <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">class_name</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">TestGuy</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">modules</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">enabled</span></span>: <span class="hljs-selector-attr"><span class="hljs-selector-attr">[Symfony2, TestHelper]</span></span></code> </pre><br><br>  So we specified the Symfony2 module for use in functional tests.  If your AppKernel is standard in the 'app' folder, the test will be performed without additional configuration. <br><br>  To run functional tests you should use: <br><pre> <code class="hljs ruby">$ codecept run functional</code> </pre> <br><br>  I'll tell you about the modules.  The modules define the actions that are available when writing tests.  In the TestGuy or WebGuy script description class, methods taken from several modules are available. <br>  The modules also implement integration with various libraries with almost no configuration and do not require the installation of additional plug-ins or bundles into your application. <br><br>  Codeception not only executes tests, but also tries to create the necessary environment for testing from scratch.  An important part of testing is preparing the database and clearing it. <br>  It is implemented through the module Db.  Create a test database and fill it with the data required for testing.  You can do it manually or using fixtures.  Create a database dump and place it in the tests / _data folder.  Then open the configuration file codeception.yml in the root of your project and enter the database access parameters and the dump path for the Db module.  Now, if you add a Db module to the list of modules in the tests / acceptance.suite.yml or functional.suite.yml file, the database will be updated automatically after each test. <br><br>  However, this is not the only way to clean.  If you use Doctrine or Doctrine2, then the appropriate modules place all your requests into a transaction and rollback at the end. <br>  Thus, the database is not clogged, and therefore it does not need constant cleaning.  Such tests will work very quickly, but transactions are available only in functional and unit tests. <br><br>  More complete documentation can be found on the <a href="http://codeception.com/">official website</a> .  There are available as review materials, and descriptions of specific modules. <br><br>  Codeception is currently in beta testing and your feedback will be highly appreciated. <br>  Follow the project on <a href="https://github.com/codeception/codeception">GitHub</a> . </div><p>Source: <a href="https://habr.com/ru/post/136477/">https://habr.com/ru/post/136477/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136468/index.html">Oracle on the way to decline</a></li>
<li><a href="../136469/index.html">Code Review and Probability Theory</a></li>
<li><a href="../136471/index.html">We create our own framework based on symfony2. (Part 3)</a></li>
<li><a href="../136472/index.html">Be a voice, not an echo</a></li>
<li><a href="../136475/index.html">CSS 3D effects</a></li>
<li><a href="../136479/index.html">Google Cache Browser - view cache without torment</a></li>
<li><a href="../136480/index.html">As you stumble with "dead souls" registered but not using the site</a></li>
<li><a href="../136481/index.html">Simple monitoring of SQL Server activity. Who is active?</a></li>
<li><a href="../136482/index.html">Implementation of ECM-solutions: what to talk with the client, part 2</a></li>
<li><a href="../136483/index.html">Face recognition by the human brain: 19 facts that computer vision researchers should be aware of</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>