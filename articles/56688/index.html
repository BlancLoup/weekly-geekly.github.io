<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MS Chart: an example of performance counters with 3D rotation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At one of the User Group meetings, I told the report ‚ÄúCreating Charts Using MS Chart‚Äù, for which I made an example of the WinForms performance counter...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MS Chart: an example of performance counters with 3D rotation</h1><div class="post__text post__text-html js-mediator-article">  At one of the <a href="http://yana.ineta.ru/Events/EventMultiSessionInfo.aspx%3FId%3Dde1f252a-e804-43de-ae4a-b12e89b4b21d">User Group</a> meetings, I told the report ‚ÄúCreating Charts Using MS Chart‚Äù, for which I made an example of the WinForms performance counter application, which displays information about 3 system indicators in real time: processor load, physical and virtual memory usage, and also 3D rotation capability.  I do not know if this example would be useful to anyone, but I decided to tell about it. <br><br>  First, a few words about MS Chart: this is an addition to the Microsoft .NET Framework 3.5 SP1, which allows you to create diagrams in WinForms applications (which gives us both WPF) and WebForms.  In the future, this will be part of the Microsoft .NET Framework 4. MS Chart was not created from scratch, but was taken from the Dundas library ( <a href="http://blogs.msdn.com/alexgor/archive/2008/11/07/microsoft-chart-control-vs-dundas-chart-control.aspx">source</a> ). <br><br>  In order to start working with MS Chart, you need to install MS Chart Controls components.  You can download them at the following links: <ul><li>  <a href="http://www.microsoft.com/downloads/details.aspx%3FFamilyId%3D130F7986-BF49-4FE5-9CA8-910AE6EA442C%26amp%3Bdisplaylang%3Den">Microsoft Chart Controls for Microsoft .NET Framework 3.5</a> (controls themselves) </li><li>  <a href="http://www.microsoft.com/downloads/details.aspx%3FFamilyId%3D1D69CE13-E1E5-4315-825C-F14D33A303E9%26amp%3Bdisplaylang%3Den">Microsoft Chart Controls Add-on for Microsoft Visual Studio 2008</a> (add-on for working with controls in MS Visual Studio 2008) </li><li>  <a href="http://code.msdn.microsoft.com/mschart">Microsoft Chart Controls Samples</a> (Usage Examples) </li><li>  <a href="http://www.microsoft.com/downloads/details.aspx%3FFamilyId%3DEE8F6F35-B087-4324-9DBA-6DD5E844FD9F%26amp%3Bdisplaylang%3Den">Microsoft Chart Controls for .NET Framework Documentation</a> (Documentation) </li><li>  <a href="http://www.microsoft.com/downloads/details.aspx%3Fdisplaylang%3Dru%26amp%3BFamilyID%3D581ff4e3-749f-4454-a5e3-de4c463143bd">Microsoft Chart Controls for Microsoft .NET Framework 3.5 Language Pack</a> (Russification, or ... well, in total about 23 different languages) </li></ul><br>  I would also like to say that the examples are much richer than the documentation on these controls, therefore it is better to see the examples right away than read the documentation itself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  So, we installed MS Chart.  Create a new WinForms project.  Put on him control Chart.  Set the Area Area3DStyle.Enabled3D property to true.  We put 3 Series sets with Spline types (this is one of the types of graphs that allows you to put several graphs on one Area).  In summary, we have some idea that we can fill out with information.  Then you can adjust the appearance of the graphs, colors and much more, which I did. <br><br> <a href="http://pics.livejournal.com/outcoldman/pic/00003r0e/"><img width="320" height="172" src="https://habrastorage.org/getpro/geektimes/post_images/54e/a23/344/54ea23344f76736026ae5db32b30bf3c.jpg"></a> <br>  Next we need to create 3 PerfomanceCounter objects from the System.Diagnostics namespace: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">#region</font> Counters <br> <br> <font color="#0000ff">private</font> PerformanceCounter pcCpu; <br> <font color="#0000ff">private</font> PerformanceCounter pcRam; <br> <font color="#0000ff">private</font> PerformanceCounter pcPage; <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///  </font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> InitCounters() <br> { <br> pcCpu = <font color="#0000ff">new</font> PerformanceCounter( <font color="#a31515">"Processor"</font> , <font color="#a31515">"% Processor Time"</font> , <font color="#a31515">"_Total"</font> , Environment.MachineName); <br> pcRam = <font color="#0000ff">new</font> PerformanceCounter( <font color="#a31515">"Memory"</font> , <font color="#a31515">"% Committed Bytes In Use"</font> , <font color="#2b91af">String</font> .Empty, Environment.MachineName); <br> pcPage = <font color="#0000ff">new</font> PerformanceCounter( <font color="#a31515">"Paging File"</font> , <font color="#a31515">"% Usage"</font> , <font color="#a31515">"_Total"</font> , Environment.MachineName); <br> } <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///   - PerformanceCounters</font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> DisposeCounters() <br> { <br> <font color="#0000ff">try</font> <br> { <br> <font color="#0000ff">if</font> (pcCpu != <font color="#0000ff">null</font> ) <br> pcCpu.Dispose(); <br> <font color="#0000ff">if</font> (pcRam != <font color="#0000ff">null</font> ) <br> pcRam.Dispose(); <br> <font color="#0000ff">if</font> (pcPage != <font color="#0000ff">null</font> ) <br> pcPage.Dispose(); <br> } <br> <font color="#0000ff">finally</font> <br> { <br> PerformanceCounter.CloseSharedResources(); <br> } <br> } <br> <br> <font color="#0000ff">#endregion</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  The InitCounters method is called in the form constructor.  And the DisposeCounters method in the Dispose method.  Next, we describe the work of the stream, which will add data to the graph every 0.1 seconds.  This approach is in one of the examples supplied with MS Chart, I took it from there. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">#region</font> Thread Sample <br> <br> <font color="#0000ff">private</font> Thread addDataRunner; <br> <font color="#0000ff">public</font> <font color="#0000ff">delegate</font> <font color="#0000ff">void</font> AddDataDelegate(); <br> <font color="#0000ff">public</font> AddDataDelegate addDataDel; <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///  ,       </font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#008000">/// &lt;param name="e"&gt;&lt;/param&gt;</font> <br> <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLoad( <font color="#2b91af">EventArgs</font> e) <br> { <br> <font color="#0000ff">base</font> .OnLoad(e); <br> Application.DoEvents(); <br> <br> <font color="#008000">// create the Adding Data Thread but do not start until start button clicked</font> <br> ThreadStart addDataThreadStart = <font color="#0000ff">new</font> ThreadStart(AddDataThreadLoop); <br> addDataRunner = <font color="#0000ff">new</font> Thread(addDataThreadStart); <br> <br> <font color="#008000">// create a delegate for adding data</font> <br> addDataDel += <font color="#0000ff">new</font> AddDataDelegate(AddData); <br> <br> <font color="#008000">// start worker threads.</font> <br> <font color="#0000ff">if</font> (addDataRunner.IsAlive == <font color="#0000ff">true</font> ) <br> { <br> addDataRunner.Resume(); <br> } <br> <font color="#0000ff">else</font> <br> { <br> addDataRunner.Start(); <br> } <br> } <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///     0.1 </font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> AddDataThreadLoop() <br> { <br> <font color="#0000ff">while</font> ( <font color="#0000ff">true</font> ) <br> { <br> <font color="#0000ff">if</font> (!chartPerfomance.IsHandleCreated) <br> <font color="#0000ff">return</font> ; <br> <br> chartPerfomance.Invoke(addDataDel); <br> <br> Thread.Sleep(100); <br> } <br> } <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///   </font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> DisposeThread() <br> { <br> <font color="#0000ff">if</font> ((addDataRunner.ThreadState &amp; ThreadState.Suspended) == ThreadState.Suspended) <br> { <br> addDataRunner.Resume(); <br> } <br> addDataRunner.Abort(); <br> } <br> <br> <font color="#0000ff">#endregion</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  The DisposeThread method must be called in the Dispose method of the form to terminate the thread.  Next we describe the methods for adding points to graphs: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">#region</font> Add Data <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///          </font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> AddData() <br> { <br> <font color="#2b91af">DateTime</font> timeStamp = <font color="#2b91af">DateTime</font> .Now; <br> <br> AddNewPoint(timeStamp, chartPerfomance.Series[0], pcCpu.NextValue()); <br> AddNewPoint(timeStamp, chartPerfomance.Series[1], pcRam.NextValue()); <br> AddNewPoint(timeStamp, chartPerfomance.Series[2], pcPage.NextValue()); <br> } <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///   (timeStamp, nexVal)   ptSeries</font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#008000">/// &lt;param name="timeStamp"&gt;&lt;/param&gt;</font> <br> <font color="#008000">/// &lt;param name="ptSeries"&gt;&lt;/param&gt;</font> <br> <font color="#008000">/// &lt;param name="nexVal"&gt;&lt;/param&gt;</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> AddNewPoint( <font color="#2b91af">DateTime</font> timeStamp, Series ptSeries, <font color="#0000ff">float</font> nexVal ) <br> { <br> ptSeries.Points.AddXY(timeStamp.ToOADate(), nexVal); <br> <br> <font color="#0000ff">double</font> removeBefore = timeStamp.AddSeconds( ( <font color="#0000ff">double</font> )(9) * ( -1 )).ToOADate(); <br> <br> <font color="#0000ff">while</font> ( ptSeries.Points[0].XValue &lt; removeBefore ) <br> { <br> ptSeries.Points.RemoveAt(0); <br> } <br> <br> chartPerfomance.ChartAreas[0].AxisX.Minimum = ptSeries.Points[0].XValue; <br> chartPerfomance.ChartAreas[0].AxisX.Maximum = <font color="#2b91af">DateTime</font> .FromOADate(ptSeries.Points[0].XValue).AddSeconds(10).ToOADate(); <br> <br> chartPerfomance.Invalidate(); <br> } <br> <br> <font color="#0000ff">#endregion</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Now add the rotation logic: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">#region</font> Mouse Events <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///  </font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#008000">/// &lt;param name="sender"&gt;&lt;/param&gt;</font> <br> <font color="#008000">/// &lt;param name="e"&gt;&lt;/param&gt;</font> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> chartPerfomance_MouseMove( <font color="#0000ff">object</font> sender, MouseEventArgs e) <br> { <br> <font color="#0000ff">if</font> (e.Button == MouseButtons.Left) <br> { <br> <font color="#0000ff">int</font> x = savedRotation - (savedLocation.X - eX); <br> <font color="#0000ff">int</font> y = savedInclination - (savedLocation.Y - eY); <br> chartPerfomance.ChartAreas[0].Area3DStyle.Rotation = <font color="#2b91af">Math</font> .Max( <font color="#2b91af">Math</font> .Min(x, 180), -180); <br> chartPerfomance.ChartAreas[0].Area3DStyle.Inclination = <font color="#2b91af">Math</font> .Max( <font color="#2b91af">Math</font> .Min(y, 90), -90); <br> } <br> } <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///    </font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#008000">/// &lt;param name="sender"&gt;&lt;/param&gt;</font> <br> <font color="#008000">/// &lt;param name="e"&gt;&lt;/param&gt;</font> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> chartPerfomance_MouseDown( <font color="#0000ff">object</font> sender, MouseEventArgs e) <br> { <br> <font color="#0000ff">if</font> (e.Button == MouseButtons.Left) <br> { <br> Cursor = Cursors.NoMove2D; <br> savedLocation = e.Location; <br> savedRotation = chartPerfomance.ChartAreas[0].Area3DStyle.Rotation; <br> savedInclination = chartPerfomance.ChartAreas[0].Area3DStyle.Inclination; <br> } <br> } <br> <br> <font color="#008000">/// &lt;summary&gt;</font> <br> <font color="#008000">///  </font> <br> <font color="#008000">/// &lt;/summary&gt;</font> <br> <font color="#008000">/// &lt;param name="sender"&gt;&lt;/param&gt;</font> <br> <font color="#008000">/// &lt;param name="e"&gt;&lt;/param&gt;</font> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> chartPerfomance_MouseUp( <font color="#0000ff">object</font> sender, MouseEventArgs e) <br> { <br> <font color="#0000ff">if</font> (e.Button == MouseButtons.Left) <br> { <br> Cursor = Cursors.Default; <br> } <br> } <br> <br> <font color="#0000ff">private</font> Point savedLocation; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> savedRotation; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> savedInclination; <br> <br> <font color="#0000ff">#endregion</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  The angle along the Y axis can be set only between -90 and 90 degrees, therefore full 3d rotation cannot be done.  Turning the graph upside down does not work (though you can certainly make it, but not so easy).  On the X axis, the angle can be set from -180 to 180 degrees, because there you can make a full rotation, setting the Rotation property to the value x% 360 - 360 * ((x / 180)% 2). <br>  All three methods need to be attached to the Chart object on the MouseMove, MouseDown and MouseUp events, respectively. <br>  As a result, we should have the following result: <br> <a href="http://pics.livejournal.com/outcoldman/pic/00004667/"><img width="302" height="240" src="https://habrastorage.org/getpro/geektimes/post_images/8da/c7d/e5f/8dac7de5f0c6c1741388c6728d0fcc06.jpg"></a> <br>  Here is a simple example of working with MS Chart.  I want to say that this is quite a powerful library that provides the ability to present data in the form of graphs.  And of the free analogues, probably the best.  True, I know only one free analogue - <a href="http://zedgraph.sourceforge.net/samples.html">ZedGraph</a> , and before the advent of MS Chart I used it only.  Not to say that MS Chart brought more functionality, but it has the ability to place smart signatures (so that they do not climb on each other), methods for calculating financial formulas (medians and much more), displaying legends and many more. <br><br>  At the end I want to give a few links where you can still get information about MS Chart: <ul><li>  <a href="http://blogs.msdn.com/alexgor/">Alex Gorev's Weblog</a> </li><li>  <a href="http://social.msdn.microsoft.com/Forums/en-US/MSWinWebChart/threads/">MS Chart Forum</a> </li></ul><br>  <a href="">Download an example ...</a> </div><p>Source: <a href="https://habr.com/ru/post/56688/">https://habr.com/ru/post/56688/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../56679/index.html">Improved Gmail and Calendar for iPhone / Android</a></li>
<li><a href="../56680/index.html">Empire of Microsoft</a></li>
<li><a href="../56683/index.html">2 reasons why numbered lists are easy to read</a></li>
<li><a href="../56684/index.html">Jabber webcam bot</a></li>
<li><a href="../56686/index.html">Ukraine introduced a new procedure for the importation and operation of mobile</a></li>
<li><a href="../56689/index.html">Jailbreak firmware 3.0 for iPhone</a></li>
<li><a href="../56690/index.html">VPN with firewall / NAT</a></li>
<li><a href="../56691/index.html">Are you participating in the development of open source projects?</a></li>
<li><a href="../56693/index.html">Web 2.0 conference in Minsk is looking for speakers</a></li>
<li><a href="../56697/index.html">Learning from a distance or a bit about Moodle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>