<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Labyrus: 3D maze</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""You have 2 minutes to create a maze, the exit from which you need a minute." 
 Kob, "Start" 


 About a year ago, it became interesting for me to dra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Labyrus: 3D maze</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <i>"You have 2 minutes to create a maze, the exit from which you need a minute."</i> <br>  Kob, "Start" </blockquote><br><img src="https://habrastorage.org/storage2/173/1cb/300/1731cb3008aff30931e32ffcc35bbcf4.png"><br><br>  About a year ago, it became interesting for me to draw a maze, which takes at least some time to complete.  I tried to do this for a long time, but I encountered many problems: <br><ol><li>  From the exit of such a maze was passed to the "one-two." </li><li>  It was almost always possible to see and understand whether you were going the right way or not. </li><li>  Drawing a maze took a lot of time. </li></ol><br>  Then I decided to write a program that will hide what is not supposed to be seen and, at the same time, generate labyrinths. <br>  And then he picked up a maze in 3D using OpenGL. <br>  And then he added a network, streams and floors. <br>  So, meet: <br><br><h1>  Labyrus is an open cross-platform multi-threaded online game written using OpenGl and Qt. </h1><a name="habracut"></a><h2>  Legend </h2><br>  The maze consists of "cells".  The walls can only stand between the cells. <br>  n is the width of the maze <br>  n is the length of the labyrinth (the base of the labyrinth is a square), <br>  h - the height of the maze. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Card generation </h2><br>  First, a hollow die is created.  Then a list of all possible walls inside this cube is created in a random order.  After that, in turn, trying to add walls.  After each addition, the map is checked for connectivity by dfs.  Total it turns out a tree. <br><br><h2>  Evaluation of work time </h2><br>  number of cells: <i>n * n * h</i> , <br>  number of walls: <i>3 * n * n * h</i> , <br>  dfs operation time: <i>n ^ 4 * h ^ 2</i> (I do not optimally store the graph), <br>  generation time: <i>O (n ^ 6 * h ^ 3)</i> . <br><br>  In principle, generation can be significantly accelerated.  But: <br><ol><li>  Too lazy to write. </li><li>  The card, which takes ~ 10 minutes to complete, is generated in 0.4 s, which, in principle, performs the task.  (Justification of laziness) </li></ol><br><br><img src="https://habrastorage.org/storage2/666/dba/433/666dba4333687a22a0812516b12474ab.png"><br>  Labyrinth with h = 1.  Developer mode.  View from above. <br><br><h2>  Description of executable files </h2><br><ul><li>  labyrus-server: generates a maze and waits for a connection. </li><li>  labyrus-server-gui: GUI to server - for those who do not like the console. </li><li>  labyrus-client: the client part of the game - the game is in it (requires running server) </li><li>  labyrus-switchlanguage: to change the language (system default).  For those who like apps in% language%.  Naturally, only those languages ‚Äã‚Äãthat I have built in (English and Russian) work. </li></ul><br><h2>  Control </h2><br><ul><li>  Standard control - arrows and keys [ <b>wasd</b> ]. </li><li>  Chat and commands - press [ <b>enter</b> ] <b>command</b> [ <b>enter</b> ]. </li><li>  A mouse is available in full screen mode. </li><li>  Switch to full screen mode and back - hot key <b>z</b> . </li><li>  Open the menu - <b>escape</b> . </li><li>  On the <b>Control</b> - binoculars.  I just was interested to write it. </li><li>  In developer mode (debug mode), the [ <b>qe</b> ] keys are available - vertical takeoff and landing, without a test of intersections with the walls. </li></ul><br><h2>  General scheme </h2><br>  First you need to raise the server.  Then the players connect to the server.  At the moment when the number of players specified on the server is connected, the game begins.  All fall down through the walls at the start.  Initially you are exit oriented.  It is always located on the same floor as you - in the opposite corner.  With the <b>--strong</b> parameter <b>no</b> further connections are possible.  Wins the player who first reached the exit.  After the last player reaches the finish line, a new card is generated and the game is restarted. <br><br><img src="https://habrastorage.org/storage2/df0/9fd/a7e/df09fda7e8f3ccb2585601593dbf158f.png"><img src="https://habrastorage.org/storage2/a0f/4c6/dc0/a0f4c6dc0896c9176397e596fa397b26.png"><br><br><h2>  System requirements </h2><br>  How to define them, I do not know, but it seems not great.  OpenGL hardware acceleration is welcome.  (~ 40000 polygons in the largest maze) <br><br><h1>  Comments </h1><br><h2>  During the writing of the project, I learned a bunch of new things: </h2><br><ol><li>  Seriously advanced in the development of Qt. </li><li>  I learned how to work with OpenGl. </li><li>  I worked with Git, I can say with a clear conscience: Git is not for me.  God forgive me Linus. </li><li>  I realized that it is worthwhile to first somehow design a program, because at some point you have to redo too many things.  In particular, the transition from discrete to real coordinates was very painful and took with it the opportunity to build and demolish walls. </li><li>  I ran into a bunch of interesting and not very bugs.  In particular, it was not possible to compile Labyrus on Qt5 under Windows. </li><li>  I realized that in Linux with dependencies everything is also not so good - they had to be calculated by experience and with the help of similar Qt programs. </li><li>  Understand how important testers are. </li><li>  It was very interesting to learn how to write the intersection of objects. </li><li>  I understand why in games, screen resolutions are usually fixed.  In my case, they are not fixed, and the transition to full screen mode occurs without restarting the program.  It was hard to implement.  In addition, it creates a bunch of bugs that I leave on the conscience of users.  That is, if you ran forward and switched to another window - be ready to see how you continue to run. </li><li>  Wrote a bot that runs a maze.  Very interesting how to write really complex bots. </li></ol><br><h2>  ... And also I learned 9 laps of hell debug application, which: </h2><br><ol><li>  Graphic. </li><li>  OpenGL. </li><li>  Qt.  (It‚Äôs not clear who called this slot, and why the program fell somewhere inside the Qt-part) </li><li>  Multithreaded </li><li>  Network. </li><li>  Cross platform  (compile under Linux, not under Windows. But ifdefs are resolved) </li><li>  Multilingual (Russian + English).  Qt, of course, provides a great translation system, but when text is placed in the right area in one language and not in the other, this is terrible. </li><li>  It consists of many files (loading graphics and intercepting the output of another program).  I didn‚Äôt understand for a long time why everything works under Windows, while others have white textures.  As a result, it turned out that some left-wing libraries were missing. </li><li>  Requires version control.  No, Git, of course, I mastered.  But here, how to find out the version in the style of xx.xx.xx-buildxx, I have no idea.  So far, normally done only for ArchLinux.  There is at least a package creation date. </li></ol><br><h1>  Authorship </h1>  The project was written by me completely, without using any engines, except for: <br><ol><li>  Skins - thanks to my mom. </li><li>  The begin2d () end2d () functions are taken from gamedev.ru. </li><li>  For testing thanks to my classmate <a href="https://habrahabr.ru/users/danpol/" class="user_link">danpol</a> . </li></ol><br><h1>  Demo </h1><br><iframe width="560" height="315" src="https://www.youtube.com/embed/hpWUWf5DFio" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  <a href="https://github.com/vtyulb/labyrus">Sources</a> <br>  <a href="http://sourceforge.net/projects/labyrus/files/LabyrusPortable.zip/download">Windows (Qt4)</a> <br>  <a href="http://sourceforge.net/projects/labyrus/files/LabyrusPortable-linux-x86.tar.gz/download">Linux-x86 (Qt4)</a> <br>  <a href="http://sourceforge.net/projects/labyrus/files/LabyrusPortable-linux-x86_64.tar.gz/download">Linux-x86_64 (Qt5)</a> <br>  <a href="https://aur.archlinux.org/packages/labyrus-git/">ArchLinux (AUR) (Qt5)</a> <br><br>  <b>UPD April 27:</b> <br>  I managed to put a bunch of extra files in the archive for Windows. <br>  LabyrusPortable.zip updated (-8Mb) </div><p>Source: <a href="https://habr.com/ru/post/177807/">https://habr.com/ru/post/177807/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../177797/index.html">Organization of storage of intermediate tables for the CART algorithm</a></li>
<li><a href="../177799/index.html">I want to write tests</a></li>
<li><a href="../177801/index.html">Yandex.Maps-Time.Lapse</a></li>
<li><a href="../177803/index.html">Just add meat or embedding on mode</a></li>
<li><a href="../177805/index.html">Creating a graphic captcha with a choice of extra</a></li>
<li><a href="../177811/index.html">MegaFon Login (SP-A1): well, very budget Android</a></li>
<li><a href="../177813/index.html">Google joins FIDO Alliance to find a reliable alternative to user password authentication.</a></li>
<li><a href="../177817/index.html">Refactoring with a tambourine, or as we Hulk pacified</a></li>
<li><a href="../177819/index.html">Habrainterview with the creators of the game "Space Rangers" Alexei Dubov and representatives of the SNK</a></li>
<li><a href="../177821/index.html">YouTube turned 8 years old</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>