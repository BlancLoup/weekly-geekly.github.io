<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using a bunch of PHP and MySQL with Google Maps</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gag 
 And here is the translation of the third lesson on the Google Maps API. This lesson - as the name implies - is devoted to creating maps using da...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using a bunch of PHP and MySQL with Google Maps</h1><div class="post__text post__text-html js-mediator-article"><h4>  Gag </h4><br>  And here is the translation of the third lesson on the Google Maps API.  This lesson - as the name implies - is devoted to creating maps using data stored in the database.  Like the previous - cross post from <a href="http://blog.aaa-nan.info/">my blog</a> . <br><br><a name="habracut"></a>  This lesson is intended for people who are familiar with a bunch of PHP / MySQL and who want to learn how to use the Google Maps API with MySQL databases.  After completing this lesson, you will have a database based map.  The map will be located markers of different colors.  Some of them will point to restaurants, others - to bars.  When clicking on a marker, an info-window will appear showing the name of the place and its address. <br>  The lesson is divided into the following paragraphs: <ul><li>  Creating a database table; </li><li>  Filling the table; </li><li>  Displaying information in XML using PHP; </li><li>  Create a map. </li></ul><br><h4>  CREATING A TABLE </h4><br>  When creating a table, first of all, you should pay attention to the <code>lat</code> (latitude) and <code>lng</code> (longitude) card parameters.  With the current resolution of Google Maps, we only need 6 digits after the decimal point.  To reduce the disk space occupied by the database to a minimum, for <code>lat</code> (latitude) and <code>lng</code> (longitude) values, it is recommended to select the <code>FLOAT</code> data type with parameter 10.6.  This type allows you to store up to 6 decimal places and up to 4 before the comma, for example -123.456789 degrees.  Your table should have an <code>id</code> field, which will be the primary key for access to the records, as well as a <code>type</code> field in which the institution type will be recorded (restaurant or bar). <br>  Note: in this lesson, places are used whose latitude and longitude values ‚Äã‚Äãare already known and are used to draw markers on the map.  If you try to use your information without having data on the coordinates of a place, then use the geocoding service to convert the address of the place to its coordinates.  Here is a list of some geocoding services: <a href="http://groups.google.com/group/Google-Maps-API/web/resources-non-google-geocoders">http://groups.google.com/group/Google-Maps-API/web/resources-non-google-geocoders</a> . <br>  If you prefer to create tables in the database using phpMyAdmin, then below is a screenshot of the table creation: <br><img alt="picture" src="http://g.codesite.articles.googlepages.com/phpsqlajax_createtable.jpg"><br>  If you do not have access to phpMyAdmin or give preference to pure SQL, the SQL query code is shown below: <br><blockquote>  <font color="black"><font color="#0000ff">CREATE</font> <font color="#0000ff">TABLE</font> `markers` (</font> <font color="black"><br></font>  <font color="black">`id` <font color="#0000ff">INT</font> <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> AUTO_INCREMENT <font color="#0000ff">PRIMARY</font> <font color="#0000ff">KEY</font> ,</font> <font color="black"><br></font>  <font color="black">`name` <font color="#0000ff">VARCHAR</font> (60) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> ,</font> <font color="black"><br></font>  <font color="black">`address` <font color="#0000ff">VARCHAR</font> (80) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> ,</font> <font color="black"><br></font>  <font color="black">`lat` <font color="#0000ff">FLOAT</font> (10, 6) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> ,</font> <font color="black"><br></font>  <font color="black">`lng` <font color="#0000ff">FLOAT</font> (10, 6) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font> ,</font> <font color="black"><br></font>  <font color="black">`type` <font color="#0000ff">VARCHAR</font> (30) <font color="#0000ff">NOT</font> <font color="#0000ff">NULL</font></font> <font color="black"><br></font>  <font color="black">) ENGINE = MYISAM;</font> </blockquote><br><h4>  FILLING TABLE </h4><br>  After creating the table, it's time to fill it with information.  Data on 10 places in Seattle are shown below.  In phpMyAdmin, you can use the IMPORT option to insert data stored in various formats into the table, including CSV.  MS Excel and Google Spreadsheets applications support exporting data to CSV format.  So you can easily transfer data from these applications to the MySQL database using the export / import options. <br>  Here is the information provided in CSV format: <br><blockquote>  <font color="black">Pan Africa Market, "1521 1st Ave, Seattle, WA", 47.608941, -122.340145, restaurant</font> <font color="black"><br></font>  <font color="black">Buddha Thai &amp; Bar, "2222 2nd Ave, Seattle, WA", 47.613591, -122.344394, bar</font> <font color="black"><br></font>  <font color="black">The Melting Pot, "14 Mercer St, Seattle, WA", 47.624562, -122.356442, restaurant</font> <font color="black"><br></font>  <font color="black">Ipanema Grill, "1225 1st Ave, Seattle, WA", 47.606366, -122.337656, restaurant</font> <font color="black"><br></font>  <font color="black">Sake House, "2230 1st Ave, Seattle, WA", 47.612825, -122.34567, bar</font> <font color="black"><br></font>  <font color="black">Crab Pot, "1301 Alaskan Way, Seattle, WA", 47.605961, -122.34036, restaurant</font> <font color="black"><br></font>  <font color="black">Mama's Mexican Kitchen, "2234 2nd Ave, Seattle, WA", 47.613975, -122.345467, bar</font> <font color="black"><br></font>  <font color="black">Wingdome, "1416 E Olive Way, Seattle, WA", 47.617215, -122.326584, bar</font> <font color="black"><br></font>  <font color="black">Piroshky Piroshky, "1908 Pike pl, Seattle, WA", 47.610127, -122.342838, restaurant</font> </blockquote><br>  And here is a screenshot showing the import of data from CSV to the database table: <br><img alt="picture" src="http://g.codesite.articles.googlepages.com/phpsqlajax_importdata.jpg"><br>  If you do not use phpMyAdmin, then below is the query code to the database in SQL language: <br><blockquote>  <font color="black"><font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `markers` (` name`, `address`,` lat`, `lng`,` type`) <font color="#0000ff">VALUES</font> ( <font color="#A31515">'Pan Africa Market'</font> , <font color="#A31515">'1521 1st Ave, Seattle, WA'</font> , <font color="#A31515">'47 .608941 '</font> , <font color="#A31515">' - 122.340145 '</font> , <font color="#A31515">' restaurant '</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `markers` (` name`, `address`,` lat`, `lng`,` type`) <font color="#0000ff">VALUES</font> ( <font color="#A31515">'Buddha Thai &amp; Bar'</font> , <font color="#A31515">'2222 2nd Ave, Seattle, WA'</font> , <font color="#A31515">'47 .613591 '</font> , <font color="#A31515">' -122.344394 '</font> , <font color="#A31515">' bar '</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `markers` (` name`, `address`,` lat`, `lng`,` type`) <font color="#0000ff">VALUES</font> ( <font color="#A31515">'The Melting Pot'</font> , <font color="#A31515">'14 Mercer St, Seattle, WA '</font> , <font color="#A31515">'47 .624562'</font> , <font color="#A31515">'- 122.356442 '</font> , <font color="#A31515">' restaurant '</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `markers` (` name`, `address`,` lat`, `lng`,` type`) <font color="#0000ff">VALUES</font> ( <font color="#A31515">'Ipanema Grill'</font> , <font color="#A31515">'1225 1st Ave, Seattle, WA'</font> , <font color="#A31515">'47 .606366 '</font> , <font color="#A31515">' -122.337656 '</font> , <font color="#A31515">' restaurant '</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `markers` (` name`, `address`,` lat`, `lng`,` type`) <font color="#0000ff">VALUES</font> ( <font color="#A31515">'Sake House'</font> , <font color="#A31515">'2230 1st Ave, Seattle, WA'</font> , <font color="#A31515">'47 .612825 '</font> , <font color="#A31515">' -122.34567 '</font> , <font color="#A31515">' bar '</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `markers` (` name`, `address`,` lat`, `lng`,` type`) <font color="#0000ff">VALUES</font> ( <font color="#A31515">'Crab Pot'</font> , <font color="#A31515">'1301 Alaskan Way, Seattle, WA'</font> , <font color="#A31515">'47 .605961 '</font> , <font color="#A31515">' -122.34036 '</font> , <font color="#A31515">' restaurant '</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `markers` (` name`, `address`,` lat`, `lng`,` type`) <font color="#0000ff">VALUES</font> ( <font color="#A31515">'Mama Mexican Kitchen'</font> , <font color="#A31515">'2234 2nd Ave, Seattle, WA'</font> , <font color="#A31515">'47. 613975 '</font> , <font color="#A31515">' - 122.345467 '</font> , <font color="#A31515">' bar '</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `markers` (` name`, `address`,` lat`, `lng`,` type`) <font color="#0000ff">VALUES</font> ( <font color="#A31515">'Wingdome'</font> , <font color="#A31515">'1416 E Olive Way, Seattle, WA'</font> , <font color="#A31515">'47 .617215 '</font> , <font color="#A31515">' -122.326584 '</font> , <font color="#A31515">' bar '</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">INSERT</font> <font color="#0000ff">INTO</font> `markers` (` name`, `address`,` lat`, `lng`,` type`) <font color="#0000ff">VALUES</font> ( <font color="#A31515">'Piroshky Piroshky'</font> , <font color="#A31515">'1908 Pike pl, Seattle, WA'</font> , <font color="#A31515">'47 .610127 '</font> , <font color="#A31515">' -122.342838 '</font> , <font color="#A31515">' restaurant '</font> );</font> </blockquote><br><h4>  CONCLUSION OF INFORMATION IN XML C WITH THE HELP OF PHP </h4><br>  At this point, you should have a database table (called markers) filled with data.  Now you need to write some PHP code that allows you to connect to the database, take the necessary information from it and export it to an XML file with which the map will interact using asynchronous JavaScript requests.  If you have never written to PHP code that allows you to connect to the database, then you need to visit the site <a href="http://www.php.net/">php.net</a> and read about the functions <code>mysql_connect()</code> , <code>mysql_select_db()</code> , <code>my_sql_query()</code> , and <code>mysql_error()</code> . <br>  Note: Some lessons suggest that you create a page with a map as a PHP file and use JavaScript to output each marker individually.  Such an approach can be problematic.  Using the XML file as an intermediary between the database and the map, you speed up the initial loading of the page and make it easier for you to debug the application.  You can check the data recorded from the database to an XML file and the result of the analysis of this file in JavaScript.  And at any stage you can do without the database, managing the map only using a static XML file. <br>  First of all, you should put the information about the connection to the database in a separate file.  Below is the PHP code in which you must enter your own username, password and database name: <br> <code><font color="#0000ff">&lt;? <br> $username="username"; <br> $password="password"; <br> $database="username-databaseName"; <br> ?&gt;</font></code> <br>  <u>Using PHP's XML functions to create an XML file</u> <br>  Check the PHP configuration or try using the <code>domxml_new_doc()</code> function to test the <code>dom_xml</code> functionality.  If you have access to <code>dom_xml</code> functions, you can use them to create XML nodes and display the XML document on the screen.  Using <code>dom_xml</code> functions <code>dom_xml</code> you can create XML documents of almost any complexity. <br>  In PHP, for starters, you need to initialize a new XML document and create a parent node ‚Äúmarlers‚Äù.  Then you need to connect to the database and select the necessary data using the query of the type <code>SELECT *</code> (select all) to the table named ‚Äúmarkers‚Äù and go through all the results of this sample.  For each record in the table (each establishment), a node will be created in the XML document, the attributes of which will be fields from the corresponding table entry - this node will be attached to the parent node.  After that you will receive a ready-made XML document. <br>  Note: if you use international characters in the database, then you need to apply UTF-8 encoding to the output data.  Here <a href="http://us2.php.net/manual/en/function.utf8-encode.php">is the transcoding function in UTF-8</a> . <br>  Your PHP code should be similar to the one below: <br> <code><font color="#0000ff">&lt;?php <br> require("phpsqlajax_dbinfo.php"); <br> <font color="#17c600">//  XML-   </font> <br> $doc = domxml_new_doc(" 1.0 "); <br> $node = $doc-&gt;create_element("markers"); <br> $parnode = $doc-&gt;append_child($node); <br> <br> <font color="#17c600">//    MySQL-</font> <br> $connection=mysql_connect (localhost, $username, $password); <br> if (!$connection) { <br> die('  : ' . mysql_error()); <br> } <br> <br> <font color="#17c600">//    </font> <br> $db_selected = mysql_select_db($database, $connection); <br> if (!$db_selected) { <br> die ('   : ' . mysql_error()); <br> } <br> <br> <font color="#17c600">//      markers</font> <br> $query = "SELECT * FROM markers WHERE 1" <br> $result = mysql_query($query); <br> if (!$result) { <br> die(' : ' . mysql_error()); <br> } <br> <br> header("Content-type: text/xml"); <br> <br> <font color="#17c600">//      ;    </font> <br> while ($row = @mysql_fetch_assoc($result)){ <br> <font color="#17c600">//     XML</font> <br> $node = $doc-&gt;create_element("marker"); <br> $newnode = $parnode-&gt;append_child($node); <br> <br> $newnode-&gt;set_attribute("name", $row['name']); <br> $newnode-&gt;set_attribute("address", $row['address']); <br> $newnode-&gt;set_attribute("lat", $row['lat']); <br> $newnode-&gt;set_attribute("lng", $row['lng']); <br> $newnode-&gt;set_attribute("type", $row['type']); <br> } <br> <br> $xmlfile = $doc-&gt;dump_mem(); <br> echo $xmlfile; <br> <br> ?&gt;</font></code> <br>  <u>Using the echo php function to create an xml file</u> <br>  If you do not have access to the <code>dom_xml</code> functions, you can create the XML file using the <code>echo</code> function.  When using the <code>echo</code> function, you will need to write an assistant function (for example, <code>parseToXML</code> ) that will decode some special characters (&gt;, &lt;, ', ‚Äù) so that no XML errors occur. <br>  In PHP, first of all, you need to connect to the database and select the necessary data using a <code>SELECT *</code> query (select all) to a table named <code>‚Äúmarkers‚Äù</code> and go through all the results of this sample.  Then you need to display the parent node using the <code>echo</code> function and walk through the results of the sample.  In this case, you must use the <code>parseToXML</code> function <code>parseToXML</code> we <code>parseToXML</code> .  The execution of this script should end with the closing <code>markers</code> tag. <br>  Note: if you use international characters in the database, then you need to apply UTF-8 encoding to the output data.  Here <a href="http://us2.php.net/manual/en/function.utf8-encode.php">is the transcoding function in UTF-8</a> . <br>  Your PHP code should be similar to the one below: <br> <code><font color="#0000ff">&lt;?php <br> require("phpsqlajax_dbinfo.php"); <br> <br> function parseToXML($htmlStr) <br> { <br> $xmlStr=str_replace('&lt;','&amp;lt;',$htmlStr); <br> $xmlStr=str_replace('&gt;','&amp;gt;',$xmlStr); <br> $xmlStr=str_replace('"','&amp;quot;',$xmlStr); <br> $xmlStr=str_replace("'",'&amp;#39;',$xmlStr); <br> $xmlStr=str_replace("&amp;",'&amp;amp;',$xmlStr); <br> return $xmlStr; <br> } <br> <br> <font color="#17c600">//    MySQL-</font> <br> $connection=mysql_connect (localhost, $username, $password); <br> if (!$connection) { <br> die('  : ' . mysql_error()); <br> } <br> <br> <font color="#17c600">//    </font> <br> $db_selected = mysql_select_db($database, $connection); <br> if (!$db_selected) { <br> die ('   : ' . mysql_error()); <br> } <br> <br> <font color="#17c600">//      markers</font> <br> $query = "SELECT * FROM markers WHERE 1" <br> $result = mysql_query($query); <br> if (!$result) { <br> die(' : ' . mysql_error()); <br> } <br> <br> header("Content-type: text/xml"); <br> <br> <font color="#17c600">//  XML-,   </font> <br> echo '&lt;markers&gt;'; <br> <br> <font color="#17c600">//      ;    </font> <br> while ($row = @mysql_fetch_assoc($result)){ <br> <font color="#17c600">//    XML</font> <br> echo '&lt;marker '; <br> echo 'name="' . parseToXML($row['name']) . '" '; <br> echo 'address="' . parseToXML($row['address']) . '" '; <br> echo 'lat="' . $row['lat'] . '" '; <br> echo 'lng="' . $row['lng'] . '" '; <br> echo 'type="' . $row['type'] . '" '; <br> echo '/&gt;'; <br> } <br> <br> <font color="#17c600">//  XML-</font> <br> echo '&lt;/markers&gt;'; <br> <br> ?&gt;</font></code> <br>  <u>Using PHP DOM Functions to Create an XML File</u> <br>  First, you need to make sure that you are using PHP version 5. If your version of PHP is lower, use any of the previous methods. <br>  In PHP, for starters, you need to initialize a new XML document and create a parent node ‚Äúmarkers‚Äù.  Then you need to connect to the database and select the necessary data using the query of the type <code>SELECT *</code> (select all) to the table named ‚Äúmarkers‚Äù and go through all the results of this sample.  For each record in the table (each establishment), a node will be created in the XML document, the attributes of which will be fields from the corresponding table entry - this node will be attached to the parent node.  After that you will receive a ready-made XML document. <br>  Note: if you use international characters in the database, then you need to apply UTF-8 encoding to the output data.  Here <a href="http://us2.php.net/manual/en/function.utf8-encode.php">is the transcoding function in UTF-8</a> . <br> <code><font color="#0000ff">&lt;?php <br> <br> require("phpsqlajax_dbinfo.php"); <br> <br> <font color="#17c600">//  XML-   </font> <br> <br> $dom = new DOMDocument(" 1.0 "); <br> $node = $dom-&gt;createElement("markers"); <br> $parnode = $dom-&gt;appendChild($node); <br> <br> <font color="#17c600">//    MySQL-</font> <br> <br> $connection=mysql_connect (localhost, $username, $password); <br> if (!$connection) { die('  : ' . mysql_error());} <br> <br> <font color="#17c600">//    </font> <br> <br> $db_selected = mysql_select_db($database, $connection); <br> if (!$db_selected) { <br> die ('   : ' . mysql_error()); <br> } <br> <br> <font color="#17c600">//      markers</font> <br> <br> $query = "SELECT * FROM markers WHERE 1" <br> $result = mysql_query($query); <br> if (!$result) { <br> die(' : ' . mysql_error()); <br> } <br> <br> header("Content-type: text/xml"); <br> <br> <font color="#17c600">//      ;    </font> <br> <br> while ($row = @mysql_fetch_assoc($result)){ <br> <font color="#17c600">//     XML</font> <br> $node = $dom-&gt;createElement("marker"); <br> $newnode = $parnode-&gt;appendChild($node); <br> $newnode-&gt;setAttribute("name",$row['name']); <br> $newnode-&gt;setAttribute("address", $row['address']); <br> $newnode-&gt;setAttribute("lat", $row['lat']); <br> $newnode-&gt;setAttribute("lng", $row['lng']); <br> $newnode-&gt;setAttribute("type", $row['type']); <br> } <br> <br> echo $dom-&gt;saveXML(); <br> <br> ?&gt;</font></code> <br>  <u>XML Output Verification</u> <br>  Run this script to make sure the output is correct.  If there are any problems with connecting to the database, you can try to delete the line with the content header (text / xml), since  It may prevent your browser from displaying error messages. <br>  If the script did its job correctly, then you should see the following: <br><blockquote>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">markers</font> <font color="#0000ff">&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">marker</font> <font color="#ff0000">name</font> <font color="#0000ff">= "Pan Africa Market"</font> <font color="#ff0000">address</font> <font color="#0000ff">= "1521 1st Ave, Seattle, WA"</font> <font color="#ff0000">lat</font> <font color="#0000ff">= "47.608940"</font> <font color="#ff0000">lng</font> <font color="#0000ff">= "-122.340141"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "restaurant"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">marker</font> <font color="#ff0000">name</font> <font color="#0000ff">= "Buddha Thai &amp; Bar"</font> <font color="#ff0000">address</font> <font color="#0000ff">= "2222 2nd Ave, Seattle, WA"</font> <font color="#ff0000">lat</font> <font color="#0000ff">= "47.613590"</font> <font color="#ff0000">lng</font> <font color="#0000ff">= "-122.344391"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "bar"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">marker</font> <font color="#ff0000">name</font> <font color="#0000ff">= "The Melting Pot"</font> <font color="#ff0000">address</font> <font color="#0000ff">= "14 Mercer St, Seattle, WA"</font> <font color="#ff0000">lat</font> <font color="#0000ff">= "47.624561"</font> <font color="#ff0000">lng</font> <font color="#0000ff">= "-122.356445"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "restaurant"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">marker</font> <font color="#ff0000">name</font> <font color="#0000ff">= "Ipanema Grill"</font> <font color="#ff0000">address</font> <font color="#0000ff">= "1225 1st Ave, Seattle, WA"</font> <font color="#ff0000">lat</font> <font color="#0000ff">= "47.606365"</font> <font color="#ff0000">lng</font> <font color="#0000ff">= "-122.337654"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "restaurant"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">marker</font> <font color="#ff0000">name</font> <font color="#0000ff">= "Sake House"</font> <font color="#ff0000">address</font> <font color="#0000ff">= "2230 1st Ave, Seattle, WA"</font> <font color="#ff0000">lat</font> <font color="#0000ff">= "47.612823"</font> <font color="#ff0000">lng</font> <font color="#0000ff">= "-122.345673"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "bar"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">marker</font> <font color="#ff0000">name</font> <font color="#0000ff">= "Crab Pot"</font> <font color="#ff0000">address</font> <font color="#0000ff">= "1301 Alaskan Way, Seattle, WA"</font> <font color="#ff0000">lat</font> <font color="#0000ff">= "47.605961"</font> <font color="#ff0000">lng</font> <font color="#0000ff">= "-122.340363"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "restaurant"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">marker</font> <font color="#ff0000">name</font> <font color="#0000ff">= "Mama's Mexican Kitchen"</font> <font color="#ff0000">address</font> <font color="#0000ff">= "2234 2nd Ave, Seattle, WA"</font> <font color="#ff0000">lat</font> <font color="#0000ff">= "47.613976"</font> <font color="#ff0000">lng</font> <font color="#0000ff">= "-122.345467"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "bar"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">marker</font> <font color="#ff0000">name</font> <font color="#0000ff">= "Wingdome"</font> <font color="#ff0000">address</font> <font color="#0000ff">= "1416 E Olive Way, Seattle, WA"</font> <font color="#ff0000">lat</font> <font color="#0000ff">= "47.617214"</font> <font color="#ff0000">lng</font> <font color="#0000ff">= "-122.326584"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "bar"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">marker</font> <font color="#ff0000">name</font> <font color="#0000ff">= "Piroshky Piroshky"</font> <font color="#ff0000">address</font> <font color="#0000ff">= "1908 Pike pl, Seattle, WA"</font> <font color="#ff0000">lat</font> <font color="#0000ff">= "47.610126"</font> <font color="#ff0000">lng</font> <font color="#0000ff">= "-122.342834"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "restaurant"</font> <font color="#0000ff">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;/</font> <font color="#800000">markers</font> <font color="#0000ff">&gt;</font></font> </blockquote><br><h4>  CREATION OF THE CARD </h4><br>  Once the XML file is correctly displayed in the browser, then it is time to create a map using JavaScript.  If you have never dealt with the Google Maps API, then please learn the basics with the help of official documentation. <br>  <u>XML file upload</u> <br>  In order to upload an XML file to a page, you must use the API <code>GDownloadURL</code> .  <code>GDownloadURL</code> is like a wrapper for the <code>XMLHttpRequest</code> method, which is used to send requests in an XML form.  The first parameter of the <code>GDownloadURL</code> function is the path to the XML file.  The second parameter is a function that will be executed when receiving a response from XML. <br>  Note: it is very important to understand that <code>GDownloadURL</code> works asynchronously - the function, which is the second parameter of <code>GDownloadURL</code> , will not work once you have applied this method.  The larger your XML file, the longer it will take to call this parameter function.  You should not put any code responsible for placing markers on the map, after the method <code>GDownloadURL</code> - it must be placed in the function-parameter. <br>  The function parameter is needed in order to find all the ‚Äúmarkers‚Äù elements in XML.  For each marker, we restore the values ‚Äã‚Äãof the name, address, type and coordinates, and then we pass these values ‚Äã‚Äãto the <code>creatMarker</code> function, which places the markers on the map. <br><blockquote>  <font color="black">GDownloadUrl ( <font color="#A31515">"phpsqlajax_genxml.php"</font> , <font color="#0000ff">function</font> (data) {</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> xml = GXml.parse (data);</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> markers = xml.documentElement.getElementsByTagName ( <font color="#A31515">"marker"</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0; i &lt;markers.length; i ++) {</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> name = markers [i] .getAttribute ( <font color="#A31515">"name"</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> address = markers [i] .getAttribute ( <font color="#A31515">"address"</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> type = markers [i] .getAttribute ( <font color="#A31515">"type"</font> );</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> point = <font color="#0000ff">new</font> GLatLng (parseFloat (markers [i] .getAttribute ( <font color="#A31515">"lat"</font> )),</font> <font color="black"><br></font>  <font color="black">parseFloat (markers [i] .getAttribute ( <font color="#A31515">"lng"</font> )));</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> marker = createMarker (point, name, address, type);</font> <font color="black"><br></font>  <font color="black">map.addOverlay (marker);</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black">});</font> </blockquote><br>  <u>Create icons for markers</u> <br>  You can use the <code>GIcon</code> class to define arbitrary images that will be displayed as a marker.  First we define two objects: iconBlue and iconRed. <br>  Warning: You may not define as many properties as shown in the example, but by doing so, you run the risk of encountering various errors later. <br>  You can also create an associative array that will associate each <code>GIcon</code> object with a specific type of institution: a restaurant or a bar.  This approach will help you in the future to easily understand the markers created using data from an external XML file. <br><blockquote>  <font color="black"><font color="#0000ff">var</font> iconBlue = <font color="#0000ff">new</font> GIcon ();</font> <font color="black"><br></font>  <font color="black">iconBlue.image = <font color="#A31515">'http://labs.google.com/ridefinder/images/mm_20_blue.png'</font> ;</font> <font color="black"><br></font>  <font color="black">iconBlue.shadow = <font color="#A31515">'http://labs.google.com/ridefinder/images/mm_20_shadow.png'</font> ;</font> <font color="black"><br></font>  <font color="black">iconBlue.iconSize = <font color="#0000ff">new</font> GSize (12, 20);</font> <font color="black"><br></font>  <font color="black">iconBlue.shadowSize = <font color="#0000ff">new</font> GSize (22, 20);</font> <font color="black"><br></font>  <font color="black">iconBlue.iconAnchor = <font color="#0000ff">new</font> GPoint (6, 20);</font> <font color="black"><br></font>  <font color="black">iconBlue.infoWindowAnchor = <font color="#0000ff">new</font> GPoint (5, 1);</font> <font color="black"><br><br></font>  <font color="black"><font color="#0000ff">var</font> iconRed = <font color="#0000ff">new</font> GIcon ();</font> <font color="black"><br></font>  <font color="black">iconRed.image = <font color="#A31515">'http://labs.google.com/ridefinder/images/mm_20_red.png'</font> ;</font> <font color="black"><br></font>  <font color="black">iconRed.shadow = <font color="#A31515">'http://labs.google.com/ridefinder/images/mm_20_shadow.png'</font> ;</font> <font color="black"><br></font>  <font color="black">iconRed.iconSize = <font color="#0000ff">new</font> GSize (12, 20);</font> <font color="black"><br></font>  <font color="black">iconRed.shadowSize = <font color="#0000ff">new</font> GSize (22, 20);</font> <font color="black"><br></font>  <font color="black">iconRed.iconAnchor = <font color="#0000ff">new</font> GPoint (6, 20);</font> <font color="black"><br></font>  <font color="black">iconRed.infoWindowAnchor = <font color="#0000ff">new</font> GPoint (5, 1);</font> <font color="black">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </font>  <font color="black"><font color="#0000ff">var</font> customIcons = [];</font> <font color="black"><br></font>  <font color="black">customIcons [ <font color="#A31515">"restaurant"</font> ] = iconBlue;</font> <font color="black"><br></font>  <font color="black">customIcons [ <font color="#A31515">"bar"</font> ] = iconRed;</font> </blockquote><br>  <u>Creating bullets and info windows</u> <br>  You must put all the code you need to create markers in the <code>createMarker</code> function.  Since the <code>customIcons</code> array was defined globally, we can transfer its elements to the constructor of the <code>GMarker</code> class without interference.  Then you need to write the HTML code that will be displayed in the info window. <br>  Hint: Some lessons advise you to store information formatted as HTML.  But this is not good, since you cannot freely manipulate HTML formatting. <br>  After writing the displayed HTML code, you need to add events for the markers so that when you click on the marker, the info window appears. <br><blockquote>  <font color="black"><font color="#0000ff">function</font> createMarker (point, name, address, type) {</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> marker = <font color="#0000ff">new</font> GMarker (point, customIcons [type]);</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> html = <font color="#A31515">"&lt;b&gt;"</font> + name + <font color="#A31515">"&lt;/ b&gt; &lt;br/&gt;"</font> + address;</font> <font color="black"><br></font>  <font color="black">GEvent.addListener (marker, <font color="#A31515">'click'</font> , <font color="#0000ff">function</font> () {</font> <font color="black"><br></font>  <font color="black">marker.openInfoWindowHtml (html);</font> <font color="black"><br></font>  <font color="black">});</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">return</font> marker;</font> <font color="black"><br></font>  <font color="black">}</font> </blockquote><br>  <u>Putting it all together</u> <br>  Below is the code that links everything that we wrote above into a coherent whole.  As soon as the page loads, the load map <code>load</code> function is activated.  This function displays a map, and then calls the <code>GDownloadUrl</code> method.  Make sure that the <code>GDownloadUrl</code> function performs its work correctly and the XML file is displayed in the browser correctly. <br>  And here is the <a href="http://g.codesite.articles.googlepages.com/phpsqlajax_map.htm">link</a> to the finished example. <br>  Happy Codding to you! </div><p>Source: <a href="https://habr.com/ru/post/38290/">https://habr.com/ru/post/38290/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../38285/index.html">The True Story of the Internet - The Battle of Browsers</a></li>
<li><a href="../38286/index.html">"We are with Yandex on YOU!" or SEO in Russia</a></li>
<li><a href="../38287/index.html">Apple will have to pay a large amount before selling the iPhone in Russia</a></li>
<li><a href="../38288/index.html">Hidden features supergabra</a></li>
<li><a href="../38289/index.html">National mail system mail.ua</a></li>
<li><a href="../38291/index.html">Yandex.Market - Automatic sorting of goods by category</a></li>
<li><a href="../38295/index.html">UA Webstar 2008</a></li>
<li><a href="../38296/index.html">Silverlight File Upload Progress</a></li>
<li><a href="../38298/index.html">Vimperator</a></li>
<li><a href="../38299/index.html">Client optimization and development stages</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>