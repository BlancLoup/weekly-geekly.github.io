<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Access to hidden UEFI BIOS settings from Insyde</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello Habr! 

 One of the directions of my company is the sale of technology solutions in the field of virtualization. On duty, you have to do pilot p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Access to hidden UEFI BIOS settings from Insyde</h1><div class="post__text post__text-html js-mediator-article">  Hello Habr! <br><br>  One of the directions of my company is the sale of technology solutions in the field of virtualization.  On duty, you have to do pilot projects or arrange test benches.  Recently, Citrix has released a new product called XenClient XT, which is essentially a first-level client hypervisor, that is, it runs on pure hardware.  The main idea of ​​the client hypervisor is to create virtual machines on your own laptop.  Where and how it is applicable - we will lower. <br><br>  All modern Intel and AMD processors support <a href="https://ru.wikipedia.org/wiki/VT-d">hardware virtualization</a> technology. <br>  And so, at my disposal was a laptop with a H77 chipset and an Intel Core i7-3820QM processor.  According to the manufacturer’s specifications, my processor supported Intel Virtualization Technology (VT-x) and Intel Virtualization Technology for Directed I / O (VT-d) technology.  If the first is available on almost all new laptops, then the second technology is found only on top models.  But it provides many advantages, such as direct forwarding of GDU to a virtual environment, respectively, the client machine receives full 3D support.  But let's not delve into technologies other than the subject of this article. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      My bios had the ability to enable VT-x, but the management of VT-d technology was not provided for initially. <br><a name="habracut"></a><br>  In my frustrated feelings, I began to wander through various resources on the Internet and came across two very interesting resources: <a href="http://forums.mydigitallife.info/forums/25-BIOS-Mods">mydigitallife</a> and <a href="http://www.bios-mods.com/forum/">bios-mods</a> . <br><br>  It turned out that most of the BIOS settings are hidden from the regular user.  The reason is clear - do not let users poking around in the initialization settings of iron, so as not to create queues at service centers from the army of curious "bearded" subjects with "bricks" in their hands. <br><br>  The initial introduction to technology plunged me into some confusion.  A bunch of unfamiliar utilities to me, new terms, incomprehensible interpretations ... I decided not to suffer and wrote on both resources that I was ready to pay someone who would help me to open the menu hidden from me.  For this it was necessary to delve into the assembly code, remove a few checks, flash patched BIOS and you have a complete menu of your BIOS. <br><br>  So I waited a week, but nobody wanted to earn ... well, or could not. <br><br>  Taking myself together, I decided to figure out how this bios works and make the patch myself.  Two weeks later, with the help of the Russian community of <a href="http://forum.ixbt.com/">IXBT,</a> I wrote my first patch to the BIOS of my test notebook.  Having crossed my fingers and with a sinking heart, I stitched my laptop ... <br><br>  Do you remember in shaggy years we were flashing our system blocks with new bios for motherboards?  Then there was an inscription on the screen saying that in no case should you turn off the computer until the end of the firmware?  There were cases when, by a strange coincidence, at that very moment electricity was cut off ... As a result, a large non-functional box was received.  What happened next - history is silent. <br><br>  My laptop did not turn on.  Interruptions in electricity with a battery he is not afraid.  But here I did something wrong.  Mental disorder knew no bounds.  To my great joy, it turned out that the BIOS has a recovery function and by using simple key combinations and a previously prepared USB flash drive, you can revive the laptop. <br><br>  I went another way: patch those places that, well, how could not affect the functionality of the BIOS, but rather replaced the logo.  I flashed it again and got a brick again.  Reflecting and consulting with experienced businessmen in this matter, we concluded that modern UEFI bios has a secondary check for the checksum of the firmware image.  The first check happens when you try to flash, and the second when the BIOS starts.  If in the first case I also patched the flash driver so that it did not check the checksum, then I won’t overcome the second check, as it is sewn in the hardware itself. <br><br>  At the moment we have the following: You can patch EFI BIOSes and can not UEFI.  My, of course, the second case.  Again, a long search on the Internet and stumble upon an article <a href="http://feature-enable.blogspot.com/2009/07/enable-vt-on-insydeh2o-based-sony-vaio.html">Enable VT on InsydeH2O based on Sony Vaio laptops, the EFI way</a> . <br>  The essence of the method is simple: you boot into EFI mode using a special bootloader and get access to VSS memory, where your BIOS settings are stored.  I tested that it works on my laptop, reopened the excellent IDA disassembler, downloaded the latest <a href="http://www.uefi.org/">specs</a> and began to gut my bios in full equipment. <br><br>  The result of two weeks of work was the gutted menu. <br><div class="spoiler">  <b class="spoiler_title">a small part of it</b> <div class="spoiler_text"><pre><code class="java hljs">╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗ ║ FormSet: <span class="hljs-string"><span class="hljs-string">'Main'</span></span> GUID: a04a27f4-df00-<span class="hljs-number"><span class="hljs-number">4</span></span>d42-b552-<span class="hljs-number"><span class="hljs-number">39511302113</span></span>d ║ ╟────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╢ ║ VarStore Id: <span class="hljs-string"><span class="hljs-string">'0x1234'</span></span>, Size: <span class="hljs-string"><span class="hljs-string">'900'</span></span>, Name: <span class="hljs-string"><span class="hljs-string">'SystemConfig'</span></span> GUID: a04a27f4-df00-<span class="hljs-number"><span class="hljs-number">4</span></span>d42-b552-<span class="hljs-number"><span class="hljs-number">39511302113</span></span>d ║ ╚════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝ ┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ Form Name: <span class="hljs-string"><span class="hljs-string">'Main'</span></span> [ ID: <span class="hljs-string"><span class="hljs-string">'0x0001'</span></span> ]│ └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ ┌- Grayout IF: | Question [ ID: <span class="hljs-string"><span class="hljs-string">'0x08'</span></span> ] == <span class="hljs-number"><span class="hljs-number">0x02</span></span> | Question [ ID: <span class="hljs-string"><span class="hljs-string">'0x07'</span></span> ] == <span class="hljs-number"><span class="hljs-number">0x01</span></span> | AND expression └- END IF Grayout; Time: <span class="hljs-string"><span class="hljs-string">'System Time'</span></span> [ QuestionId: <span class="hljs-string"><span class="hljs-string">'0x01'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">'&lt;Enter&gt; selects field.'</span></span> ] Default value: <span class="hljs-string"><span class="hljs-string">'00:00:00'</span></span>, Type: <span class="hljs-number"><span class="hljs-number">0x05</span></span> Date: <span class="hljs-string"><span class="hljs-string">'System Date'</span></span> [ QuestionId: <span class="hljs-string"><span class="hljs-string">'0x02'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">'&lt;Enter&gt; selects field.'</span></span> ] Default value: <span class="hljs-string"><span class="hljs-string">'2010/05/01'</span></span>, Type: <span class="hljs-number"><span class="hljs-number">0x06</span></span> ┌- Grayout IF: | EQ == TRUE | Text: <span class="hljs-string"><span class="hljs-string">'Notebook Model'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'Product Number'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'System Board ID'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'Born On Date'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'Processor Type'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | ┌- Suppress IF: | | Question [ ID: <span class="hljs-string"><span class="hljs-string">'0x06'</span></span> ] == <span class="hljs-number"><span class="hljs-number">0x00</span></span> | | Text: <span class="hljs-string"><span class="hljs-string">'Processor Speed'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | └- END IF Suppress; | Text: <span class="hljs-string"><span class="hljs-string">'Total Memory'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'BIOS Version'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'Fake Data'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'BIOS Vendor'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'Insyde'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'Serial Number'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'UUID Number'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'Product configuration ID'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'System Board CT Number'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'C AAAA RR SS WW XXX'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | Text: <span class="hljs-string"><span class="hljs-string">'Factory installed OS'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | ┌- Suppress IF: | | Question [ ID: <span class="hljs-string"><span class="hljs-string">'0x05'</span></span> ] == <span class="hljs-number"><span class="hljs-number">0x00</span></span> | | Text: <span class="hljs-string"><span class="hljs-string">'Primary Battery SN'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'N/A'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | └- END IF Suppress; | ┌- Suppress IF: | | Question [ ID: <span class="hljs-string"><span class="hljs-string">'0x04'</span></span> ] == <span class="hljs-number"><span class="hljs-number">0x00</span></span> | | Text: <span class="hljs-string"><span class="hljs-string">'Secondary Battery SN'</span></span> Default: <span class="hljs-string"><span class="hljs-string">''</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> | └- END IF Suppress; | | | ┌- Suppress IF: | | EQ == TRUE | | | | | └- END IF Suppress; └- END IF Grayout; Reference: <span class="hljs-string"><span class="hljs-string">'System Log'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0540'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x03'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] ┌- Suppress IF: | EQ == TRUE | └- END IF Suppress; ┌- Suppress IF: | EQ == TRUE | └- END IF Suppress; ┌- Suppress IF: | EQ == TRUE | └- END IF Suppress; ┌- Suppress IF: | EQ == TRUE | └- END IF Suppress; ┌- Suppress IF: | EQ == TRUE | └- END IF Suppress; ┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ Form Name: <span class="hljs-string"><span class="hljs-string">'System Log'</span></span> [ ID: <span class="hljs-string"><span class="hljs-string">'0x0540'</span></span> ]│ └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ Subtitle: <span class="hljs-string"><span class="hljs-string">'System Log'</span></span> Action: <span class="hljs-string"><span class="hljs-string">' '</span></span> [ QuestionId: <span class="hljs-string"><span class="hljs-string">'0xfffe'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span>, Help: View the system diagnostic failure results. ] Text: <span class="hljs-string"><span class="hljs-string">'Result:'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'Time:'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> ┌- Grayout IF: | EQ == TRUE | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> | Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">'- No Data -'</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> └- END IF Grayout; Text: <span class="hljs-string"><span class="hljs-string">' '</span></span> Default: <span class="hljs-string"><span class="hljs-string">' '</span></span> Help: <span class="hljs-string"><span class="hljs-string">'View the system diagnostic failure results.'</span></span> ╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗ ║ FormSet: <span class="hljs-string"><span class="hljs-string">'Security'</span></span> GUID: a04a27f4-df00-<span class="hljs-number"><span class="hljs-number">4</span></span>d42-b552-<span class="hljs-number"><span class="hljs-number">39511302113</span></span>d ║ ╟────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╢ ║ VarStore Id: <span class="hljs-string"><span class="hljs-string">'0x1234'</span></span>, Size: <span class="hljs-string"><span class="hljs-string">'900'</span></span>, Name: <span class="hljs-string"><span class="hljs-string">'SystemConfig'</span></span> GUID: a04a27f4-df00-<span class="hljs-number"><span class="hljs-number">4</span></span>d42-b552-<span class="hljs-number"><span class="hljs-number">39511302113</span></span>d ║ ╚════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝ ┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ Form Name: <span class="hljs-string"><span class="hljs-string">'Security'</span></span> [ ID: <span class="hljs-string"><span class="hljs-string">'0x0001'</span></span> ]│ └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ Password: Administrator Password [ VarStore: <span class="hljs-string"><span class="hljs-string">'0x9d'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">'Administrator Password controls access to the setup utility.'</span></span>] Password: Power-On Password [ VarStore: <span class="hljs-string"><span class="hljs-string">'0xa1'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">'Power-On Password controls access to the system at boot.'</span></span>] ╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗ ║ FormSet: <span class="hljs-string"><span class="hljs-string">'Main'</span></span> GUID: a04a27f4-df00-<span class="hljs-number"><span class="hljs-number">4</span></span>d42-b552-<span class="hljs-number"><span class="hljs-number">39511302113</span></span>d ║ ╟────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╢ ║ VarStore Id: <span class="hljs-string"><span class="hljs-string">'0x1234'</span></span>, Size: <span class="hljs-string"><span class="hljs-string">'900'</span></span>, Name: <span class="hljs-string"><span class="hljs-string">'SystemConfig'</span></span> GUID: a04a27f4-df00-<span class="hljs-number"><span class="hljs-number">4</span></span>d42-b552-<span class="hljs-number"><span class="hljs-number">39511302113</span></span>d ║ ╚════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝ ┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ Form Name: <span class="hljs-string"><span class="hljs-string">'Main'</span></span> [ ID: <span class="hljs-string"><span class="hljs-string">'0x0001'</span></span> ]│ └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ ┌- Grayout IF: | VALUE = <span class="hljs-number"><span class="hljs-number">1</span></span> | VALUE = <span class="hljs-number"><span class="hljs-number">1</span></span> | EQUAL expression └- END IF Grayout; Text: <span class="hljs-string"><span class="hljs-string">'InsydeH2O Version'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'Fake Data'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> ┌- Grayout IF: | VALUE = <span class="hljs-number"><span class="hljs-number">1</span></span> | VALUE = <span class="hljs-number"><span class="hljs-number">1</span></span> | EQUAL expression └- END IF Grayout; Text: <span class="hljs-string"><span class="hljs-string">'System Memory Speed'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> ┌- Grayout IF: | VALUE = <span class="hljs-number"><span class="hljs-number">1</span></span> | VALUE = <span class="hljs-number"><span class="hljs-number">1</span></span> | EQUAL expression └- END IF Grayout; ┌- Grayout IF: | VALUE = <span class="hljs-number"><span class="hljs-number">1</span></span> | VALUE = <span class="hljs-number"><span class="hljs-number">1</span></span> | EQUAL expression └- END IF Grayout; Text: <span class="hljs-string"><span class="hljs-string">'Total Memory'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'[Not Detected]'</span></span> Help: <span class="hljs-string"><span class="hljs-string">' '</span></span> ┌- Grayout IF: | Question [ ID: <span class="hljs-string"><span class="hljs-string">'0x05'</span></span> ] == <span class="hljs-number"><span class="hljs-number">0x02</span></span> | Question [ ID: <span class="hljs-string"><span class="hljs-string">'0x04'</span></span> ] == <span class="hljs-number"><span class="hljs-number">0x01</span></span> | AND expression └- END IF Grayout; Time: <span class="hljs-string"><span class="hljs-string">'System Time'</span></span> [ QuestionId: <span class="hljs-string"><span class="hljs-string">'0x01'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">'This is the help for the hour, minute, second field. Valid range is from 0 to 23, 0 to 59, 0 to 59. INCREASE/REDUCE : +/-.'</span></span> ] Default value: <span class="hljs-string"><span class="hljs-string">'00:00:00'</span></span>, Type: <span class="hljs-number"><span class="hljs-number">0x05</span></span> Date: <span class="hljs-string"><span class="hljs-string">'System Date'</span></span> [ QuestionId: <span class="hljs-string"><span class="hljs-string">'0x02'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">'This is the help for the month field, day field, year field. Valid range is from 1 to 12, 1 to 31, 2000 to 2099. (Error checking will be done against month/day/year combinations that are not supported.) INCREASE/REDUCE : +/-.'</span></span> ] Default value: <span class="hljs-string"><span class="hljs-string">'2011/05/01'</span></span>, Type: <span class="hljs-number"><span class="hljs-number">0x06</span></span> Action: <span class="hljs-string"><span class="hljs-string">'About this Software'</span></span> [ QuestionId: <span class="hljs-string"><span class="hljs-string">'0x1059'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span>, Help: ] ┌- Suppress IF: | LIST [ ID: <span class="hljs-string"><span class="hljs-string">'0x04'</span></span> ] in (<span class="hljs-string"><span class="hljs-string">'0x00'</span></span>,<span class="hljs-string"><span class="hljs-string">'0x01'</span></span>) | Select option: <span class="hljs-string"><span class="hljs-string">'Debug Reclaim'</span></span> [ VarStore: <span class="hljs-string"><span class="hljs-string">'0x1d7'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x03'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">' '</span></span>] | Option: <span class="hljs-string"><span class="hljs-string">'Enabled'</span></span> [ Value: <span class="hljs-string"><span class="hljs-string">'1'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'false'</span></span> Type: <span class="hljs-string"><span class="hljs-string">'int8'</span></span> ] | Option: <span class="hljs-string"><span class="hljs-string">'Disabled'</span></span> [ Value: <span class="hljs-string"><span class="hljs-string">'0'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'true'</span></span> Type: <span class="hljs-string"><span class="hljs-string">'int8'</span></span> ] └- END IF Suppress; ┌- Suppress IF: | EQ == TRUE | └- END IF Suppress; ┌- Suppress IF: | EQ == TRUE | └- END IF Suppress; ╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗ ║ FormSet: <span class="hljs-string"><span class="hljs-string">'Advanced'</span></span> GUID: a04a27f4-df00-<span class="hljs-number"><span class="hljs-number">4</span></span>d42-b552-<span class="hljs-number"><span class="hljs-number">39511302113</span></span>d ║ ╟────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╢ ║ VarStore Id: <span class="hljs-string"><span class="hljs-string">'0x1234'</span></span>, Size: <span class="hljs-string"><span class="hljs-string">'900'</span></span>, Name: <span class="hljs-string"><span class="hljs-string">'SystemConfig'</span></span> GUID: a04a27f4-df00-<span class="hljs-number"><span class="hljs-number">4</span></span>d42-b552-<span class="hljs-number"><span class="hljs-number">39511302113</span></span>d ║ ╚════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝ ┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ │ Form Name: <span class="hljs-string"><span class="hljs-string">'Advanced'</span></span> [ ID: <span class="hljs-string"><span class="hljs-string">'0x0001'</span></span> ]│ └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ Reference: <span class="hljs-string"><span class="hljs-string">'Boot Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0021'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x01'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'Peripheral Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0022'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x02'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'IDE Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0023'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x03'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'Thermal Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0024'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x04'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'Video Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0025'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x05'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'USB Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0026'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x06'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'Chipset Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0027'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x07'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'ACPI Table/Features Control'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0028'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x08'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'PCI Express Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0030'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x09'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'Intel(R) Anti-Theft Technology Support'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x0038'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x0a'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'Extended ICC'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x1cc0'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x0b'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'DPTF Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x3610'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x0c'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ] Reference: <span class="hljs-string"><span class="hljs-string">'Intel(R) Smart Connect Technology Configuration'</span></span> [ FormID: <span class="hljs-string"><span class="hljs-string">'0x1e00'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x0d'</span></span>, VarStore: <span class="hljs-string"><span class="hljs-string">'0xffff'</span></span> ]</code> </pre> <br></div></div><br>  I successfully booted into the boot loader with access to VSS memory, I assigned the variables I needed and turned on or off what was missing or interfered with in my work. <br><br>  And now how to do it for you. <br><br><h4>  Tooling preparation </h4><br>  1. You need to download <a href="http://forums.mydigitallife.info/threads/13194-Tool-to-Insert-Replace-SLIC-in-Phoenix-Insyde-Dell-EFI-BIOSes">PhoenixTool</a> from this forum, where the current version is constantly laid out.  You will need it to decompose the firmware file into its components. <br>  2. You need perl.  If you have a UNIX system, then everything is simple, if not, then <a href="http://www.activestate.com/activeperl">ActivePerl</a> or <a href="http://www.cygwin.com/">Cygwin</a> under Windows. <br>  3. You need the latest BIOS from your manufacturer. <br>  4. Any archiver. <br><br><h4>  Getting the firmware image </h4><br>  <b>1</b> .  Open the file of your firmware with the exe archiver, find there a file with the extension bin or fd and unpack it to a place convenient for you.  Better in a separate folder. <br>  <b>2</b>  Start PhoenixTool and try opening the firmware file. <br>  <b>3</b>  If when you try to open you see this window <br><img src="https://habrastorage.org/getpro/habr/post_images/ffc/1f1/a81/ffc1f1a812e0058e6b2f4ba3a8617755.png"><br>  then most likely your image from the manufacturer is encrypted.  Decrypt method has not yet been invented, but this is only a matter of time.  If this is your case, then go to the next step, if not, then skip and go to step <b>8</b> . <br>  <b>4</b>  Unzip the firmware in a convenient folder for you and start updating your BIOS to the latest version. <br>  <b>5</b>  After your laptop restarts, go back to this folder and find the file platform.ini <br>  <b>6</b>  Open with a text editor and make the following changes: <br><pre> <code class="bash hljs">[BackupROM] Flag=1 FilePath=c: FileName=0183AF24.BIN</code> </pre>  This will allow you to flash your BIOS again, but a backup copy of the current BIOS will be created. <br>  <b>7</b>  After reboot, open the resulting backup using PhoenixTool <br>  <b>8</b>  After a couple of seconds, you'll need to see a window similar to this: <br><img src="https://habrastorage.org/getpro/habr/post_images/99d/12e/570/99d12e57070654df44437af46f4b0b4c.png"><br>  <b>9</b>  Now you can close the window. <br>  <b>10</b>  In the folder where you lay the image folder DUMP will appear, and in it a lot of files.  We are interested in, which starts at FE3542FE and has the largest size: <br><img src="https://habrastorage.org/getpro/habr/post_images/1e4/363/b9c/1e4363b9cf143dc2401171dbaac6528d.png"><br>  <b>11</b>  Now download my source code. <div class="spoiler">  <b class="spoiler_title">parser</b> <div class="spoiler_text"><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/perl # # Copyright (c) 2013 Nurlan Mukhanov (aka Falseclock) &lt;nurike@gmail.com&gt; # # Please inform me if you found error/mistakes or enhance this script. # # Permission is hereby granted, free of charge, to any person obtaining a copy # of this software and associated documentation files (the "Software"), to deal # in the Software without restriction, including without limitation the rights # to use, copy, modify, merge, publish, distribute, sublicense, and/or sell # copies of the Software, and to permit persons to whom the Software is # furnished to do so, subject to the following conditions: # # The above copyright notice and this permission notice shall be included in all # copies or substantial portions of the Software. # THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR # IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, # FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE # AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER # LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, # OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE # SOFTWARE. $| = 1; use strict; use warnings; use utf8; use Encode; use Data::Dumper; use vars qw($ROM $ROM_SIZE $IFR_PACKAGE_SIG @EFI_HII_PACKAGES %EFI_HII_PACKAGE_TYPE %LANGUAGES @EFI_HII_PACKAGE_FORMS %EFI $DEFAULT_LANGUAGE @STRINGS @TABS %TYPES); ################### !!! IMPORTANT !!! ################### $IFR_PACKAGE_SIG = '$IFRPKG!'; ######################################################### $DEFAULT_LANGUAGE = 'en-US'; my $file = $ARGV[0] || "Setup.rom"; &amp;SPECIFICATION_LOAD(); #---------------------------- MAIN PROGRAMM ----------------------------# open($ROM, "&lt;$file ") or die "ERROR : Cannot open $file.\n"; { binmode $ROM; undef $/; $ROM_SIZE = -s $file; } #-------------------------------------------------------------------- # 1. Search IFR virtual package my $header_offset = &amp;IFR_PACKAGE_SIG(); print STDERR "IFR_PACKAGE_SIG not found!\nExiting programm...\n" and exit 1 if (!$header_offset); #-------------------------------------------------------------------- # 2. Search EFI_HII_PACKAGE_HEADERs @EFI_HII_PACKAGES = &amp;EFI_HII_PACKAGES($header_offset); #print Dumper(\@EFI_HII_PACKAGES); #=head #-------------------------------------------------------------------- # 3. Parse EFI_HII_PACKAGE_STRINGS #print "Parsing language tables..\n"; %LANGUAGES = &amp;EFI_HII_PACKAGE_STRINGS(); #printf "\tFound %d languages: %s\n", scalar keys %LANGUAGES, join ', ', sort keys %LANGUAGES; @STRINGS = @{$LANGUAGES{$DEFAULT_LANGUAGE}-&gt;{'strings'}}; #print Dumper(\@STRINGS); #print Dumper(\%LANGUAGES); =head # 3.1. Check languages length my %length; $length{$_} = scalar @{$LANGUAGES{$_}-&gt;{'strings'}} foreach (keys %LANGUAGES); my $warn = 0; foreach (keys %length) { next if $_ eq 'en-US'; if ($length{$_} != $length{'en-US'}) { if (!$warn) { printf STDERR "\tWARNING: languages array length is different, must be %d elements:\n", $length{'en-US'}; $warn = 1; } printf "\t\t%s: (%d)\n", $_, $length{$_} - $length{'en-US'}; } } =cut #-------------------------------------------------------------------- # 4. FORM packages parsing @EFI_HII_PACKAGE_FORMS = &amp;EFI_HII_PACKAGE_FORMS(); close($ROM); #-----------------------------------------------------------------------# #-----------------------------------------------------------------------# sub str2hex { return unpack ("H*", shift); } sub dec2bin { return unpack("B32", pack("N", shift)); } sub bin2dec { return unpack("N", pack("B32", substr("0" x 32 . shift, -32))); } sub oplength { my $data = shift; my $length = unpack("C", $data); return bin2dec(substr &amp;dec2bin($length), -7); } sub EFI_IFR { my $data = shift; my $length = length($data); my @opcodes; #printf "length: %d, hex: %s\n", length($data), join (' ', unpack("(H2)*",substr($data,0,10))); my $i = 0; while ($i &lt; $length) { my %op; # Reading OPCODE $op{'opcode'} = unpack("C", substr($data,$i,1)); $i++; # Reading length $op{'length'} = oplength(substr($data,$i,1)); $i++; # Reading payload $op{'payload'} = substr($data,$i,$op{'length'}-2); $i += $op{'length'} -2; # Setting indent #$op{'indent'} = $INDENTS{$op{'opcode'}}; push @opcodes, \%op; # printf "Opcode: %02X, Length: %d\n",$op{'opcode'} , $op{'length'}; # my $www = &lt;STDIN&gt;; } return \@opcodes; } sub EFI_HII_PACKAGE_FORMS { my @forms = (); foreach (@EFI_HII_PACKAGES) { my %pkg = %{$_}; my %form; if ($_-&gt;{type} == 0x02) { # printf "EFI_HII_PACKAGE_FORMS offset int : %d, hex: (0x%08x)\n",$pkg{'int_offset'},$pkg{'int_offset'}; # Skeep first 4 bytes of FULLL_PACKAGE_LENGTH my $FORM_PACKAGE_LENGTH = unpack('I', (data($pkg{int_offset} + 4, 3).pack("H",0)) ); my $FORM_PACKAGE_TYPE = unpack('C', (data($pkg{int_offset} + 7, 1)) ); $form{'length'} = $FORM_PACKAGE_LENGTH; $form{'type'} = $FORM_PACKAGE_TYPE; #printf " Form length: %s, type: %s\n", $FORM_PACKAGE_LENGTH, $FORM_PACKAGE_TYPE; my $op_offset = $pkg{int_offset} + 8; my $op_length = ($FORM_PACKAGE_LENGTH - 4); $form{'opcodes'} = &amp;EFI_IFR(data($op_offset,$op_length)); $form{'package'} = $_; push @forms, \%form; } } &amp;EFI_IFR_FORM_SET(\@forms); #print Dumper(\@forms); return @forms; } sub EFI_IFR_FORM_SET { my $forms = shift; my @forms = @{$forms}; #print Dumper(\@forms); foreach my $form (@forms) { my %form = %{$form}; my @ops = @{$form{'opcodes'}}; foreach (@ops) { my %op = %{$_}; &amp;EFI_IFR_PRINT(\%op,\%{$form{'package'}}); } print "\n"; } } sub fguid { my $guid = shift; my ($a, $b, $c, $d, $e); $a = unpack("H*",scalar reverse(substr($guid,0,4))); $b = unpack("H*",scalar reverse(substr($guid,4,2))); $c = unpack("H*",scalar reverse(substr($guid,6,2))); $d = unpack("H*",substr($guid,8,2)); $e = unpack("H*",substr($guid,10,6)); return sprintf("%s-%s-%s-%s-%s",$a,$b,$c,$d,$e); } sub EFI_HII_PACKAGE_STRINGS { my %pkg; foreach (@EFI_HII_PACKAGES) { %pkg = %{$_} and last if ($_-&gt;{type} == 0x04); } my $reader= 4; # current reading offset my %languages; while ($reader &lt; $pkg{size}) # read until we in package { my $LANG_PACKAGE_LENGTH = unpack('I', (data($pkg{int_offset} + $reader, 3).pack("H",0)) ); my $LANG_PACKAGE_OFFSET = $pkg{int_offset} + $reader; #print $LANG_PACKAGE_LENGTH,"\n"; if ($LANG_PACKAGE_LENGTH) { $reader += (3 + 1 + 42); my $LANG_PACKAGE_NAME = (data($pkg{int_offset} + $reader, 5)); # skip 00 - end of header $languages{$LANG_PACKAGE_NAME} = {'offset' =&gt; $LANG_PACKAGE_OFFSET, 'length' =&gt; $LANG_PACKAGE_LENGTH, 'name' =&gt; $LANG_PACKAGE_NAME }; } $reader += $LANG_PACKAGE_LENGTH - (3 + 1 + 42); } foreach (keys %languages) { my %lang = %{$languages{$_}}; #print "Reading language from offset: ".$lang{'offset'}."\n"; #print "Language name is: ".$lang{'name'}."\n"; my $table = data($lang{'offset'}+46+6, $lang{'length'} - 46 - 6); my @table = unpack('(H2)*',$table); #         #        ,    my @strings; my $position=0; my $word = undef; my $eof = 0; my $last = undef; my $skip = 0; my $word_start = 0; push @strings, undef; # MEMEORY OFFSET CAN NOT BE 0 my %EFI_HII_STRING_BLOCK = map { $_ =&gt; 1 } ('10', '11', '12', '13', '15', '16', '17', '22', '30', '31', '32', '40'); for (my $l=0; $l &lt; $#table; $l++) { my $byte = $table[$l]; if ( exists($EFI_HII_STRING_BLOCK{$byte}) &amp;&amp; !$word &amp;&amp; $last ne '14') { print STDERR "Unexpected EFI_HII_STRING_BLOCK -&gt; BlockType = $byte found!\n"; printf STDERR "String offset: %d (0x%08x)\n", $lang{'offset'} + $l, $lang{'offset'} + $l; exit 1; } $last = $byte and $word_start = 1 and next if ($byte eq '14'); # EFI_HII_SIBT_STRING_UCS2 if ($byte eq '21' &amp;&amp; !$word &amp;&amp; !$word_start ) # EFI_HII_SIBT_SKIP2 { #print "SKEEP FOUND\n"; $skip = hex($table[$l+1]); # number of skips $l += 2; # pass reading @table for next 2 bytes while ($skip) { push @strings, "EFI_HII_SIBT_SKIP2-$skip"; $skip--; } next; } if ($byte eq '20' &amp;&amp; !$word &amp;&amp; !$word_start ) # EFI_HII_SIBT_DUPLICATE { push @strings, $strings[$#strings]; $l += 3; next; } # If word end if ($byte eq '00' &amp;&amp; $table[$l+1] eq '00') { #print $word."\n"; push @strings, $word; $word = undef; $word_start = 0; $l++; next; } $word .= decode('utf-16le',pack("H*",$byte).pack("H*",$table[$l+1])); $l++; } $languages{$_}-&gt;{'strings'} = \@strings; } return %languages; #print Dumper(\%languages); } sub EFI_HII_PACKAGES { my $offset = shift; $offset += 8; my @address = (); while (1) { my $data = data($offset,8); my $hex = unpack("H*",$data); last if $hex !~ /^[ABCDEF0-9]{10}000000$/i; if ($hex =~ /^[ABCDEF0-9]{6}8001000000$/i) { push @address, substr ((join '', (reverse ($hex =~ m/../g))), 10); #my $address = substr ((join '', (reverse ($hex =~ m/../g))), 10); #printf "$address - %s\n", hex($address); } $offset += 8; } my @pkg = (); foreach (@address) { my %pkg; $pkg{int_offset} = hex($_); $pkg{hex_offset} = $_; $pkg{size} = unpack("I*",data(hex($_),4)); $pkg{type} = unpack("C", data( hex($_)+7 , 1 )); $pkg{type_name} = $EFI_HII_PACKAGE_TYPE{$pkg{type}}-&gt;{name}; $pkg{type_text} = $EFI_HII_PACKAGE_TYPE{$pkg{type}}-&gt;{text}; push @pkg, \%pkg; } return @pkg; } sub IFR_PACKAGE_SIG { my $i = 0; my $offset = 0; my $seek = undef; my @sig = split //, $IFR_PACKAGE_SIG; while ($i &lt;= $ROM_SIZE) { my $byte = data($i,1); #last unless $byte; # If we found start of header if ($byte eq '$') { $offset = $i; # Store current offset $seek = $byte; # Store begining of the signature $i++; next; } if ($offset) # just to save CPU time { if (scalar grep $byte eq $_, @sig) { $seek .= $byte if ($IFR_PACKAGE_SIG =~ $seek.$byte ); last if ($IFR_PACKAGE_SIG eq $seek ); } else { $offset = 0; $seek = undef; } } $i++; } #printf "\nIFR_PACKAGE_SIG found at offset: %d (0x%08x)\n", ($offset, $offset) if $offset; return $offset; } sub data { my $offset = shift; my $length = shift; my $data; seek $ROM, $offset, 0; sysread $ROM, $data, $length; return $data; }; sub TabSpace { # Pushing push @TABS, shift; return ' ' x (scalar @TABS - 1); } sub TabClose { my $length = scalar @TABS; my $return = ""; if ($length) { my $opcode = pop @TABS; if ($opcode == $EFI{EFI_IFR_GRAY_OUT_IF_OP}) { $return = sprintf "\xE2\x94\x94- END IF Grayout;\n"; } elsif ($opcode == $EFI{EFI_IFR_SUPPRESS_IF_OP}) { $return = sprintf "\xE2\x94\x94- END IF Suppress;\n"; } else { $return = "What the fuck?"; } } return $return; } sub EFI_IFR_PRINT { my $op = shift; my $package = shift; my $TabSpace = ''; my %op = %{$op}; my %package = %{$package}; if ($op{'opcode'} != $EFI{EFI_IFR_FORM_SET_OP} and scalar @TABS) { if ($op{'opcode'} == $EFI{EFI_IFR_SUPPRESS_IF_OP} or $op{'opcode'} == $EFI{EFI_IFR_GRAY_OUT_IF_OP}) { $TabSpace = sprintf "|"; } elsif ( $op{'opcode'} == $EFI{EFI_IFR_END_OP} ) { $TabSpace = sprintf "%s",'| ' x (scalar @TABS - 1 ); } else { $TabSpace = sprintf "%s",'| ' x (scalar @TABS); } print $TabSpace; } if ($op{'opcode'} == $EFI{EFI_IFR_FORM_SET_OP}) { # 0x0E my $Guid = substr($op{'payload'},0,16); my $FormSetTitle = unpack("S2",substr($op{'payload'},16,2)); my $Help = unpack("S2",substr($op{'payload'},18,2)); my $Flags = substr($op{'payload'},20,2); my $ClassGuid = substr($op{'payload'},22,16); printf "\n\xE2\x95\x94%s\xE2\x95\x97\n","\xE2\x95\x90"x116; printf "\x{E2}\x{95}\x{91} FormSet: '%-62sGUID: %s \xE2\x95\x91\n", ($STRINGS[$FormSetTitle]."'", fguid($Guid)); printf "\x{e2}\x{95}\x{9f}%s\x{e2}\x{95}\x{a2}\n","\x{e2}\x{94}\x{80}"x116; if ($STRINGS[$Help] and $STRINGS[$Help] ne ' ') { printf " \\Help text: '%s'\n", $STRINGS[$Help]; } } elsif ($op{'opcode'} == $EFI{EFI_IFR_GUID_OP}) { # 0x5F my $Guid = substr($op{'payload'},0,16); my $Data = unpack("H*", substr($op{'payload'},16)); #printf "\x{E2}\x{95}\x{91} Operation data: '%-55sGUID: %s \xE2\x95\x91\n", $Data, &amp;fguid($Guid); } elsif ($op{'opcode'} == $EFI{EFI_IFR_DEFAULTSTORE_OP}) { # 0x5C my $DefaultId = unpack("S2", substr($op{'payload'},2,2)); my $DefaultName = unpack("S2", substr($op{'payload'},2,2)); #printf "EFI_IFR_DEFAULTSTORE_OP, length: %d, DefaultId: %s, DefaultName: %s \n",length($op{'payload'}),$DefaultId,$DefaultName ; } elsif ($op{'opcode'} == $EFI{EFI_IFR_VARSTORE_OP}) { # 0x24 # typedef struct _EFI_IFR_VARSTORE { # EFI_IFR_OP_HEADER Header; # EFI_GUID Guid; # EFI_VARSTORE_ID VarStoreId; # UINT16 Size; # UINT8 Name[1]; # } EFI_IFR_VARSTORE; #printf "EFI_IFR_VARSTORE_OP, length: %d \n",length($op{'payload'}); my $Guid = substr($op{'payload'},0,16); my $VarStoreId = unpack("S2", substr($op{'payload'},16,2)); my $Size = unpack("S2", substr($op{'payload'},18,2)); my $Name = substr($op{'payload'},20,12); printf "\x{E2}\x{95}\x{91} VarStore Id: '0x%x', Size: '%s', Name: '%s' GUID: %s \x{E2}\x{95}\x{91}\n", $VarStoreId, $Size, $Name, &amp;fguid($Guid); printf "\xE2\x95\x9A%s\xE2\x95\x9D\n","\xE2\x95\x90"x116; } elsif ($op{'opcode'} == $EFI{EFI_IFR_FORM_OP}) { # 0x01 my $FormId = unpack("S2",substr($op{'payload'},0,2)); my $FormTitle = unpack("S2",substr($op{'payload'},2,2)); printf "\x{e2}\x{94}\x{8c}%s\x{e2}\x{94}\x{90}\n","\x{e2}\x{94}\x{80}"x116; printf "\x{e2}\x{94}\x{82} Form Name: '%-86s [ ID: '0x%04x' ]\x{e2}\x{94}\x{82}\n", ($STRINGS[$FormTitle]."'", $FormId); printf "\x{e2}\x{94}\x{94}%s\x{e2}\x{94}\x{98}\n","\x{e2}\x{94}\x{80}"x116; } elsif ($op{'opcode'} == $EFI{EFI_IFR_GRAY_OUT_IF_OP}) { # 0x19 printf "%s\x{E2}\x{94}\x{8C}- Grayout IF:\n",TabSpace($op{'opcode'}); } elsif ($op{'opcode'} == $EFI{EFI_IFR_SUPPRESS_IF_OP}) { # 0x0A printf "%s\xE2\x94\x8C- Suppress IF:\n",TabSpace($op{'opcode'}); } elsif ($op{'opcode'} == $EFI{EFI_IFR_END_OP}) { # 0x29 printf "%s",&amp;TabClose($op{'opcode'}); } elsif ($op{'opcode'} == $EFI{EFI_IFR_EQ_ID_VAL_OP}) { # 0x12 my $QuestionId = unpack("S2",substr($op{'payload'},0,2)); my $Value = unpack("S2",substr($op{'payload'},2,2)); printf "Question [ ID: '0x%02x' ] == 0x%02x\n", $QuestionId, $Value,; } elsif ($op{'opcode'} == $EFI{EFI_IFR_AND_OP}) { # 0x15 printf "AND expression\n"; } elsif ($op{'opcode'} == $EFI{EFI_IFR_SUBTITLE_OP}) { # 0x02 my $Prompt = unpack("S2",substr($op{'payload'},0,2)); my $Help = unpack("S2",substr($op{'payload'},2,2)); printf "Subtitle: '%s'\n", ($STRINGS[$Prompt]) if defined $STRINGS[$Prompt] and $STRINGS[$Prompt] ne ' '; } elsif ($op{'opcode'} == $EFI{EFI_IFR_DEFAULT_OP}) { # 0x5B my $DefaultId = unpack("S2",substr($op{'payload'},0,2)); my $Type = unpack("C",substr($op{'payload'},2,1)); my $value; if ($Type == 0) { $value = unpack("C",substr($op{'payload'},3,1)); } elsif ($Type == 1) { $value = unpack("S2",substr($op{'payload'},3,2)); } elsif ($Type == 2) { $value = unpack("S2",substr($op{'payload'},3,2)); } elsif ($Type == 5) { $value = sprintf("%02d",unpack("C",substr($op{'payload'},3,1))).':'.sprintf("%02d",unpack("C",substr($op{'payload'},4,1))).':'.sprintf("%02d",unpack("C",substr($op{'payload'},5,1))); } elsif ($Type == 6) { $value = unpack("S2",substr($op{'payload'},3,2)).'/'.sprintf("%02d",unpack("C",substr($op{'payload'},5,1))).'/'.sprintf("%02d",unpack("C",substr($op{'payload'},6,1))); } else { $value = unpack("S*",substr($op{'payload'},3,4)); } printf " Default value: '%s', Type: 0x%02x\n",$value, $Type; } elsif ($op{'opcode'} == $EFI{EFI_IFR_TRUE_OP}) { # 0x46 printf "EQ == TRUE\n"; } elsif ($op{'opcode'} == $EFI{EFI_IFR_TEXT_OP}) { # 0x03 my $Prompt = unpack("S2",substr($op{'payload'},0,2)); my $Help = unpack("S2",substr($op{'payload'},2,2)); my $TextTwo = unpack("S2",substr($op{'payload'},4,2)); my $t2 = ""; $t2 = $STRINGS[$TextTwo] if (defined $STRINGS[$TextTwo]); printf "Text: '%-32.32sDefault: '%-32.32sHelp: '%s'\n", $STRINGS[$Prompt]."'", $t2."'", $STRINGS[$Help]; } elsif ($op{'opcode'} == $EFI{EFI_IFR_UINT64_OP}) { # 0x45 my $Value = $op{'payload'}; printf "VALUE = %s\n", unpack("S*",$Value); } elsif ($op{'opcode'} == $EFI{EFI_IFR_EQUAL_OP}) { # 0x2F printf "EQUAL expression\n"; } elsif ($op{'opcode'} == $EFI{EFI_IFR_EQ_ID_LIST_OP}) { # 0x14 my $QuestionId = unpack("S2", substr($op{'payload'},0,2)); my $ListLength = unpack("S2", substr($op{'payload'},2,2)); my @ValueList = unpack("(S4)*", substr($op{'payload'},4)); @ValueList = map {sprintf "'0x%02x'", $_ } @ValueList; printf "LIST [ ID: '0x%02x' ] in (%s)\n",$QuestionId, join ",", @ValueList; } elsif ($op{'opcode'} == $EFI{EFI_IFR_OR_OP}) { # 0x16 printf "OR expression\n"; } elsif ($op{'opcode'} == $EFI{EFI_IFR_NOT_OP}) { # 0x17 printf "NOT expression \n"; } elsif ($op{'opcode'} == $EFI{EFI_IFR_TIME_OP}) {# 0x1b my $Prompt = unpack("S2",substr($op{'payload'},0,2)); my $Help = unpack("S2",substr($op{'payload'},2,2)); my $QuestionId = unpack("S2",substr($op{'payload'},4,2)); my $VarStoreId = unpack("S2",substr($op{'payload'},8,2)); #my $VarName = unpack("S2",substr($op{'payload'},8,1)); #my $VarOffset = unpack("S2",substr($op{'payload'},9,1)); #my $Flags = unpack("S2",substr($op{'payload'},9,1)); printf "Time: '%s' [ QuestionId: '0x%02x', VarStore: '0x%02x', Help: '%s' ]\n", $STRINGS[$Prompt],$QuestionId,$VarStoreId,$STRINGS[$Help] ; } elsif ($op{'opcode'} == $EFI{EFI_IFR_DATE_OP}) {# 0x1A my $Prompt = unpack("S2",substr($op{'payload'},0,2)); my $Help = unpack("S2",substr($op{'payload'},2,2)); my $QuestionId = unpack("S2",substr($op{'payload'},4,2)); my $VarStoreId = unpack("S2",substr($op{'payload'},8,2)); #my $VarName = unpack("S2",substr($op{'payload'},8,1)); #my $VarOffset = unpack("S2",substr($op{'payload'},9,1)); #my $Flags = unpack("S2",substr($op{'payload'},9,1)); printf "Date: '%s' [ QuestionId: '0x%02x', VarStore: '0x%02x', Help: '%s' ]\n", $STRINGS[$Prompt],$QuestionId,$VarStoreId,$STRINGS[$Help] ; } elsif ($op{'opcode'} == $EFI{EFI_IFR_NUMERIC_OP}) {# 0x07 my $Prompt = unpack("S2",substr($op{'payload'},0,2)); my $Help = unpack("S2",substr($op{'payload'},2,2)); my $QuestionId = unpack("S2",substr($op{'payload'},4,2)); my $VarStoreId = unpack("S2",substr($op{'payload'},8,2)); #my $VarStoreInfo = unpack("C",substr($op{'payload'},10,1)); my $Type = unpack("C",substr($op{'payload'},11,1)); my $MinValue = unpack("C",substr($op{'payload'},12,1)); my $MaxValue = unpack("C",substr($op{'payload'},13,1)); my $Step = unpack("C",substr($op{'payload'},14,1)); printf "Number question: Prompt: %s, Help: %s\n",($STRINGS[$Prompt], $STRINGS[$Help]) if $Prompt; printf "%s \x{E2}\x{94}\x{94}- [ QuestionId: '0x%02x', VarStore: '0x%02x' , Type: '%02x', MinValue: '%d', MaxValue: '%d', Step: '%d' ]\n",($TabSpace,$QuestionId, $VarStoreId, $Type,$MinValue, $MaxValue, $Step) if $Prompt;; } elsif ($op{'opcode'} == $EFI{EFI_IFR_REF_OP}) {# 0x0F my $Prompt = unpack("S2",substr($op{'payload'},0,2)); my $Help = unpack("S2",substr($op{'payload'},2,2)); my $QuestionId = unpack("S2",substr($op{'payload'},4,2)); my $VarStoreId = unpack("S2",substr($op{'payload'},8,2)); my $FormId = unpack("S2&gt;*!",substr($op{'payload'},11,4)); printf "Reference: '%s' [ FormID: '0x%04x', QuestionId: '0x%02x', VarStore: '0x%02x' ]\n", $STRINGS[$Prompt], $FormId, $QuestionId, $VarStoreId; } elsif ($op{'opcode'} == $EFI{EFI_IFR_ACTION_OP}) {# 0x0C my $Prompt = unpack("S2",substr($op{'payload'},0,2)); my $Help = unpack("S2",substr($op{'payload'},2,2)); my $QuestionId = unpack("S2",substr($op{'payload'},4,2)); my $VarStoreId = unpack("S2",substr($op{'payload'},8,2)); #my $VarStoreInfo = unpack("C",substr($op{'payload'},8,1)); printf "Action: '%-32.32s [ QuestionId: '0x%02x', VarStore: '0x%02x', Help: %s ] \n", ($STRINGS[$Prompt]."'", $QuestionId,$VarStoreId, $STRINGS[$Help]); #printf "%s \x{E2}\x{94}\x{94}- \n", ($TabSpace if $STRINGS[$Prompt]; } elsif ($op{'opcode'} == $EFI{EFI_IFR_PASSWORD_OP}) {# 0x08 my $Prompt = unpack("S2", substr($op{'payload'},0,2)); my $Help = unpack("S2", substr($op{'payload'},2,2)); my $VarStoreId = unpack("S2", substr($op{'payload'},8,2)); printf "Password: %-32.32s [ VarStore: '0x%02x', Help: '%s']\n", ($STRINGS[$Prompt], $VarStoreId, $STRINGS[$Help]); } elsif ($op{'opcode'} == $EFI{EFI_IFR_ONE_OF_OP}) { # 0x05 my $Prompt = unpack("S2", substr($op{'payload'},0,2)); my $Help = unpack("S2", substr($op{'payload'},2,2)); my $QuestionId = unpack("S2", substr($op{'payload'},4,2)); my $VarStoreId = unpack("S2", substr($op{'payload'},8,2)); # my $VarOffset = unpack("S2", substr($op{'payload'},4,2)); printf "Select option: '%-32.32s[ VarStore: '0x%02x', QuestionId: '0x%02x', Help: '%s']\n", ($STRINGS[$Prompt]."'", $VarStoreId, $QuestionId, (defined $STRINGS[$Help] ? $STRINGS[$Help] : '' )); } elsif ($op{'opcode'} == $EFI{EFI_IFR_ONE_OF_OPTION_OP}) { # 0x09 my $Option = unpack("S2", substr($op{'payload'},0,2)); my $Flags = str2hex(substr($op{'payload'},2,1)); my $Type = unpack("C", substr($op{'payload'},3,1)); my $Value = unpack("C*", substr($op{'payload'},4,8)); # oid, value, flags, key = struct.unpack("&lt;HHBH", self.payload) # print ts+"Option '%s' = 0x%x Flags 0x%x Key 0x%x"%(s[oid], value, flags, key) printf " Option: '%-37.37s[ Value: '%s' Default: '%-6s Type: '%-6.6s ]\n", ($STRINGS[$Option]."'", $Value, ($Flags eq '10' ? 'true' : 'false')."'", $TYPES{$Type}."'"); } else { printf "--&gt; UNKNOWN OPCODE: %02X, length: %d\n", $op{'opcode'}, $op{'length'}; exit 1; } } sub SPECIFICATION_LOAD { $EFI{EFI_IFR_FORM_OP} = 0x01; $EFI{EFI_IFR_SUBTITLE_OP} = 0x02; $EFI{EFI_IFR_TEXT_OP} = 0x03; $EFI{EFI_IFR_IMAGE_OP} = 0x04; $EFI{EFI_IFR_ONE_OF_OP} = 0x05; $EFI{EFI_IFR_CHECKBOX_OP} = 0x06; $EFI{EFI_IFR_NUMERIC_OP} = 0x07; $EFI{EFI_IFR_PASSWORD_OP} = 0x08; $EFI{EFI_IFR_ONE_OF_OPTION_OP} = 0x09; $EFI{EFI_IFR_SUPPRESS_IF_OP} = 0x0A; $EFI{EFI_IFR_LOCKED_OP} = 0x0B; $EFI{EFI_IFR_ACTION_OP} = 0x0C; $EFI{EFI_IFR_RESET_BUTTON_OP} = 0x0D; $EFI{EFI_IFR_FORM_SET_OP} = 0x0E; $EFI{EFI_IFR_REF_OP} = 0x0F; $EFI{EFI_IFR_NO_SUBMIT_IF_OP} = 0x10; $EFI{EFI_IFR_INCONSISTENT_IF_OP} = 0x11; $EFI{EFI_IFR_EQ_ID_VAL_OP} = 0x12; $EFI{EFI_IFR_EQ_ID_ID_OP} = 0x13; $EFI{EFI_IFR_EQ_ID_LIST_OP} = 0x14; $EFI{EFI_IFR_AND_OP} = 0x15; $EFI{EFI_IFR_OR_OP} = 0x16; $EFI{EFI_IFR_NOT_OP} = 0x17; $EFI{EFI_IFR_RULE_OP} = 0x18; $EFI{EFI_IFR_GRAY_OUT_IF_OP} = 0x19; $EFI{EFI_IFR_DATE_OP} = 0x1A; $EFI{EFI_IFR_TIME_OP} = 0x1B; $EFI{EFI_IFR_STRING_OP} = 0x1C; $EFI{EFI_IFR_REFRESH_OP} = 0x1D; $EFI{EFI_IFR_DISABLE_IF_OP} = 0x1E; $EFI{EFI_IFR_ANIMATION_OP} = 0x1F; $EFI{EFI_IFR_TO_LOWER_OP} = 0x20; $EFI{EFI_IFR_TO_UPPER_OP} = 0x21; $EFI{EFI_IFR_MAP_OP} = 0x22; $EFI{EFI_IFR_ORDERED_LIST_OP} = 0x23; $EFI{EFI_IFR_VARSTORE_OP} = 0x24; $EFI{EFI_IFR_VARSTORE_NAME_VALUE_OP} = 0x25; $EFI{EFI_IFR_VARSTORE_EFI_OP} = 0x26; $EFI{EFI_IFR_VARSTORE_DEVICE_OP} = 0x27; $EFI{EFI_IFR_VERSION_OP} = 0x28; $EFI{EFI_IFR_END_OP} = 0x29; $EFI{EFI_IFR_MATCH_OP} = 0x2A; $EFI{EFI_IFR_GET_OP} = 0x2B; $EFI{EFI_IFR_SET_OP} = 0x2C; $EFI{EFI_IFR_READ_OP} = 0x2D; $EFI{EFI_IFR_WRITE_OP} = 0x2E; $EFI{EFI_IFR_EQUAL_OP} = 0x2F; $EFI{EFI_IFR_NOT_EQUAL_OP} = 0x30; $EFI{EFI_IFR_GREATER_THAN_OP} = 0x31; $EFI{EFI_IFR_GREATER_EQUAL_OP} = 0x32; $EFI{EFI_IFR_LESS_THAN_OP} = 0x33; $EFI{EFI_IFR_LESS_EQUAL_OP} = 0x34; $EFI{EFI_IFR_BITWISE_AND_OP} = 0x35; $EFI{EFI_IFR_BITWISE_OR_OP} = 0x36; $EFI{EFI_IFR_BITWISE_NOT_OP} = 0x37; $EFI{EFI_IFR_SHIFT_LEFT_OP} = 0x38; $EFI{EFI_IFR_SHIFT_RIGHT_OP} = 0x39; $EFI{EFI_IFR_ADD_OP} = 0x3A; $EFI{EFI_IFR_SUBTRACT_OP} = 0x3B; $EFI{EFI_IFR_MULTIPLY_OP} = 0x3C; $EFI{EFI_IFR_DIVIDE_OP} = 0x3D; $EFI{EFI_IFR_MODULO_OP} = 0x3E; $EFI{EFI_IFR_RULE_REF_OP} = 0x3F; $EFI{EFI_IFR_QUESTION_REF1_OP} = 0x40; $EFI{EFI_IFR_QUESTION_REF2_OP} = 0x41; $EFI{EFI_IFR_UINT8_OP} = 0x42; $EFI{EFI_IFR_UINT16_OP} = 0x43; $EFI{EFI_IFR_UINT32_OP} = 0x44; $EFI{EFI_IFR_UINT64_OP} = 0x45; $EFI{EFI_IFR_TRUE_OP} = 0x46; $EFI{EFI_IFR_FALSE_OP} = 0x47; $EFI{EFI_IFR_TO_UINT_OP} = 0x48; $EFI{EFI_IFR_TO_STRING_OP} = 0x49; $EFI{EFI_IFR_TO_BOOLEAN_OP} = 0x4A; $EFI{EFI_IFR_MID_OP} = 0x4B; $EFI{EFI_IFR_FIND_OP} = 0x4C; $EFI{EFI_IFR_TOKEN_OP} = 0x4D; $EFI{EFI_IFR_STRING_REF1_OP} = 0x4E; $EFI{EFI_IFR_STRING_REF2_OP} = 0x4F; $EFI{EFI_IFR_CONDITIONAL_OP} = 0x50; $EFI{EFI_IFR_QUESTION_REF3_OP} = 0x51; $EFI{EFI_IFR_ZERO_OP} = 0x52; $EFI{EFI_IFR_ONE_OP} = 0x53; $EFI{EFI_IFR_ONES_OP} = 0x54; $EFI{EFI_IFR_UNDEFINED_OP} = 0x55; $EFI{EFI_IFR_LENGTH_OP} = 0x56; $EFI{EFI_IFR_DUP_OP} = 0x57; $EFI{EFI_IFR_THIS_OP} = 0x58; $EFI{EFI_IFR_SPAN_OP} = 0x59; $EFI{EFI_IFR_VALUE_OP} = 0x5A; $EFI{EFI_IFR_DEFAULT_OP} = 0x5B; $EFI{EFI_IFR_DEFAULTSTORE_OP} = 0x5C; $EFI{EFI_IFR_FORM_MAP_OP} = 0x5D; $EFI{EFI_IFR_CATENATE_OP} = 0x5E; $EFI{EFI_IFR_GUID_OP} = 0x5F; $EFI{EFI_IFR_SECURITY_OP} = 0x60; %EFI_HII_PACKAGE_TYPE = ( 0x00 =&gt; { name =&gt; 'EFI_HII_PACKAGE_TYPE_ALL' , text =&gt; 'Pseudo-package type' }, 0x01 =&gt; { name =&gt; 'EFI_HII_PACKAGE_TYPE_GUID' , text =&gt; 'Package type where the format of the data is specified using a GUID immediately following the package header' }, 0x02 =&gt; { name =&gt; 'EFI_HII_PACKAGE_FORMS' , text =&gt; 'Forms package' }, 0x04 =&gt; { name =&gt; 'EFI_HII_PACKAGE_STRINGS' , text =&gt; 'Strings package' }, 0x05 =&gt; { name =&gt; 'EFI_HII_PACKAGE_FONTS' , text =&gt; 'Fonts package' }, 0x06 =&gt; { name =&gt; 'EFI_HII_PACKAGE_IMAGES' , text =&gt; 'Images package' }, 0x07 =&gt; { name =&gt; 'EFI_HII_PACKAGE_SIMPLE_FONTS' , text =&gt; 'Simplified (8x19, 16x19) Fonts package' }, 0x08 =&gt; { name =&gt; 'EFI_HII_PACKAGE_DEVICE_PATH' , text =&gt; 'Binary-encoded device path' }, 0x09 =&gt; { name =&gt; 'EFI_HII_PACKAGE_KEYBOARD_LAYOUT' , text =&gt; 'Used to mark the end of a package list' }, 0x0A =&gt; { name =&gt; 'EFI_HII_PACKAGE_ANIMATIONS' , text =&gt; 'Animations package' }, 0xDF =&gt; { name =&gt; 'EFI_HII_PACKAGE_END' , text =&gt; 'Package types reserved for use by platform firmware implementations' }, 0xE0 =&gt; { name =&gt; 'EFI_HII_PACKAGE_TYPE_SYSTEM_BEGIN' , text =&gt; 'Package types reserved for use by platform firmware implementations' }, ); %TYPES = ( 0x00 =&gt; 'int8', 0x01 =&gt; 'int16', 0x02 =&gt; 'int32', 0x03 =&gt; 'int64', 0x04 =&gt; 'bool', 0x05 =&gt; 'time', 0x06 =&gt; 'date', 0x07 =&gt; 'string', 0x08 =&gt; 'other', ); }</span></span></code> </pre></div></div><br>  <b>12</b>  Save it to your computer where you have a file from point <b>10</b> and give it a name convenient for you, for example uefidump.pl <br>  <b>13</b>  Switch to console mode and issue the command perl uefidump.pl FE3542FE-C1D3-4EF8-657C-8048606FF670_2_514.ROM&gt; uefidump.log <br>  <b>14</b>  Upon completion, you will find a dump menu of your BIOS in the file uefidump.log. <br><br><h5>  Preparing a bootable floppy </h5><br>  <b>1</b> .  We take the flash drive, the size is not important. <br>  <b>2</b>  We format it in FAT32 <br>  <b>3</b>  Create an EFI \ Boot directory structure <br>  <b>4</b>  Download <a href="http://www.mediafire.com/download.php%3F81vegw2aw0pxcib">BOOTX64.EFI</a> <br>  <b>5</b>  Put in the folder Boot <br>  <b>6</b>  Reboot into the BIOS, turn on the Legacy and disable the Secure Boot. <br>  <b>7</b>  We save and load via the USB flash drive. <br>  <b>8</b>  After downloading, you should see yellow text on a black screen. <br><pre> <code class="html hljs xml">&gt; Welcome to GRUB! &gt; &gt; Entering rescue mode... &gt; error: file not found &gt; grub rescue &gt;</code> </pre><br>  <b>9</b>  By modifying the BIOS settings, everything is ready. <br><br><h5>  Change settings </h5><br>  For changes, the <b>VarStore</b> and <b>Value</b> fields are used.  Value in the log in decimal form, when changing, you must specify a hexadecimal value. <br><br>  <b>1</b> .  Suppose you need to change the mode of the disk from IDE to AHCI.  Someone needs it for hakintoshi, and someone bought a solid-state hard drive, but the laptop does not see it.  We look for in the log file as for the subject and find the following lines: <br><pre> <code class="java hljs">Select option: <span class="hljs-string"><span class="hljs-string">'HDC Configure As'</span></span> [ VarStore: <span class="hljs-string"><span class="hljs-string">'0x39'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x1a'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">'Set Harddisk Controller Configure Type'</span></span>] Option: <span class="hljs-string"><span class="hljs-string">'IDE'</span></span> [ Value: <span class="hljs-string"><span class="hljs-string">'0'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'true'</span></span> Type: <span class="hljs-string"><span class="hljs-string">'int8'</span></span> ] Option: <span class="hljs-string"><span class="hljs-string">'AHCI'</span></span> [ Value: <span class="hljs-string"><span class="hljs-string">'1'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'false'</span></span> Type: <span class="hljs-string"><span class="hljs-string">'int8'</span></span> ] Option: <span class="hljs-string"><span class="hljs-string">'RAID'</span></span> [ Value: <span class="hljs-string"><span class="hljs-string">'2'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'false'</span></span> Type: <span class="hljs-string"><span class="hljs-string">'int8'</span></span> ]</code> </pre><br>  In order for you to change the setting, you must first give the command <code>setup_var 0x39</code> . <br>  The result of this command will be the current value of this variable.  To change it and put it in AHCI, you must give the command <code>setup_var 0x39 0x1</code> .  Keep in mind that if you have Windows, you will need to reinstall it, because once configured Windows on the IDE will not be able to understand that now it needs to work with AHCI.  As an option, after booting into safe mode, edit the registry, then you will not have to reinstall anything. <br><br>  <b>2</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, you need to disable the discrete video adapter. </font><font style="vertical-align: inherit;">The following lines are responsible for this item:</font></font><br><pre> <code class="java hljs">Select option: <span class="hljs-string"><span class="hljs-string">'Special Features'</span></span> [ VarStore: <span class="hljs-string"><span class="hljs-string">'0x1e6'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x92'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">'Enable Switch Graphic Function'</span></span>] Option: <span class="hljs-string"><span class="hljs-string">'Disabled'</span></span> [ Value: <span class="hljs-string"><span class="hljs-string">'0'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'false'</span></span> Type: <span class="hljs-string"><span class="hljs-string">'int8'</span></span> ] Option: <span class="hljs-string"><span class="hljs-string">'Enabled'</span></span> [ Value: <span class="hljs-string"><span class="hljs-string">'1'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'true'</span></span> Type: <span class="hljs-string"><span class="hljs-string">'int8'</span></span> ]</code> </pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The command </font></font><code>setup_var 0x1e6 0x0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will disable the discrete and only the built-in will work. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">We want Numlock not to turn on</font></font><br><pre> <code class="java hljs">Select option: <span class="hljs-string"><span class="hljs-string">'Numlock'</span></span> [ VarStore: <span class="hljs-string"><span class="hljs-string">'0x08'</span></span>, QuestionId: <span class="hljs-string"><span class="hljs-string">'0x10'</span></span>, Help: <span class="hljs-string"><span class="hljs-string">'Selects Power-on state for Numlock'</span></span>] Option: <span class="hljs-string"><span class="hljs-string">'Off'</span></span> [ Value: <span class="hljs-string"><span class="hljs-string">'0'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'false'</span></span> Type: <span class="hljs-string"><span class="hljs-string">'int8'</span></span> ] Option: <span class="hljs-string"><span class="hljs-string">'On'</span></span> [ Value: <span class="hljs-string"><span class="hljs-string">'1'</span></span> Default: <span class="hljs-string"><span class="hljs-string">'true'</span></span> Type: <span class="hljs-string"><span class="hljs-string">'int8'</span></span> ]</code> </pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The command </font></font><code>setup_var 0x08 0x0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will disable it at boot.</font></font><br><br><h4>  Epilogue </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This manual has been compiled as it is and as I do in practice. I am not responsible for damaged motherboards or lost information. All that we can do is you do at your own peril and risk. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If something went wrong, the first lifebuoy could be removing the bios battery to erase the VSS memory. If it does not help, then you need to look for a recovery method for your BIOS. In the case of HP instructions can be found </font></font><a href="http://forum.ixbt.com/topic.cgi%3Fid%3D17:38124:920"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . For other vendors there, but I was not looking. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">My topic where I am not, no helping the afflicted is </font></font><a href="http://www.bios-mods.com/forum/Thread-HOWTO-access-you-BIOS-settings-through-EFI-shell"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Thanks from users as proof that this all works.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And lastly, do not try to disable the equipment that you have or turn on the equipment that you do not have, otherwise the failure to initialize the equipment will lead to a complete collapse and the inability to restore the motherboard. </font></font><br><br> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And the last thing, my advice to you is: before you start experimenting with overclocking and BIOS tuning, check that a way to restore the BIOS in case of its collapse works for your laptop. </font><font style="vertical-align: inherit;">So far there have been no such cases, but it is not enough.</font></font></u> </div><p>Source: <a href="https://habr.com/ru/post/182676/">https://habr.com/ru/post/182676/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../182660/index.html">Can I make money on 3D printing? Remove pink glasses in an interview with Oscar van Deventer</a></li>
<li><a href="../182666/index.html">The digest of news from the world of mobile development in the last week №15 (June 3 - 9, 2013)</a></li>
<li><a href="../182670/index.html">Understanding scope or Scope in AngularJS</a></li>
<li><a href="../182672/index.html">How to create a simple tower defense game on Unity3D, part two</a></li>
<li><a href="../182674/index.html">Android is behind the “Internet of Things” - and it's everywhere</a></li>
<li><a href="../182678/index.html">Creating a multiplayer realtime game on node.js</a></li>
<li><a href="../182684/index.html">Bees can communicate through weak electric fields</a></li>
<li><a href="../182686/index.html">Bruce Schneier: The Illusion of Security</a></li>
<li><a href="../182688/index.html">Microsoft Dryad vs Apache Hadoop. Uncomplicated Big Data Battle</a></li>
<li><a href="../182690/index.html">We optimize Boid's on Unity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>