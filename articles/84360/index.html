<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Project to optimize the distribution of incoming Voip calls</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I work as a Voip system administrator for one small French company, how I got here is a separate story. 
 I will show the results of the team‚Äôs work o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Project to optimize the distribution of incoming Voip calls</h1><div class="post__text post__text-html js-mediator-article"><img src="http://www.asterisk.org/themes/newAsterisk/images/logo.jpg" alt="image"><img src="http://cdnso.trixbox.com/sites/trixbox.com/themes/trixbox/img/logo_Fonalitytrixbox.gif" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/a8e/171/b87/a8e171b87308e95ad5b84f0fda3e267e.png" alt="image"><br><br>  I work as a Voip system administrator for one small French company, how I got here is a separate story. <br>  I will show the results of the team‚Äôs work on the project whose goal was a global equivalent call distribution strategy for call centers, depending on the number of agents capable of receiving calls.  The phrase certainly succeeded, <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>In the example, it looks like this:</b> <br><br>  Center1 = 20 agents <br>  Cent2 = 10 agents <br><br>  With a load of 50%, there should be 10 free agents in Center1, and 5 agents in Center2.  Here is such parity. <br>  When the number of calls exceeds the number of free agents, customers must stand in the same global queue, one after the other.  If a certain number of agents become free, then customers move in order of priority to the agents. <br><br>  Everything should be wrapped in a web interface, with fashionable gadgets. <br><br>  <b>Old system:</b> <br><br>  Our client, 6 call centers, all of them satisfy the same service with a single incoming number.  The number of calls depends on the day of the week, but basically it is 15000-20000 per day.  The centers themselves worked according to the following scheme: <br><br><img src="http://img704.imageshack.us/img704/1315/diagramp.png" alt="image"><br><br>  Before me, the servers on tricboxes (asterisk) worked without servers, the system was archaic, there were problems with sound quality.  I put two servers with open accounts, <a href="http://www.opensips.org/">Opensips</a> is like a proxy, only for calls, they can be sent according to the rules set anywhere.  But this system also began to show its limit.  The servers at opencipse distributed calls with the <a href="http://www.opensips.org/html/docs/modules/1.6.x/dispatcher.html">Dispatcher</a> module, the principle is simple, the server had a text file with the following data: <br><br>  1 192.168.1.1:5060 #Cent1 <br>  1 192.168.1.2:5060 #Cent2 <br>  1 192.168.1.3:5060 #Cent3 <br>  1 192.168.1.4:5060 # Center4 <br>  1 192.168.1.5:5060 #Cent5 <br>  1 192.168.1.6:5060 #Cent6 <br><br>  The call comes, the open-end reads the first line&gt; the call to the center 1&gt; We redirect <br>  The call comes, the open-ended reads the second line&gt; call to the center 2&gt; Redirect <br><br>  When we come to the end of the file, we start reading in a circle.  Now imagine that we have 100 lines, what's this?  100% correct <br>  <b>Every morning</b> I received a percentage for each center, rounded and generated a file with a small ruby ‚Äã‚Äãscript.  This allowed to raise the efficiency by 5% A little?  5% is 9 people, with an average salary of 1,700, multiply = <b>‚Ç¨ 15,300</b> savings per month.  The number of agents is different, from 180 to 1, that is, varies throughout the day.  After some time, I began to notice some <b>anomalies</b> , then one center declares fewer resources than it actually is, then another ... Here it is a human factor.  Yes, and general opacity, locally on Trixboxes there was complete reporting, but globally, how many people waiting in line at 10:30 am I am not able to say.  It turns out that without a global visibility it is just hard to predict the load, and the number of agents may be wrong.  My 5% went to zero because of the ‚ÄúFactor X‚Äù and global statistics. <br><br>  <b>Idea!</b>  And how would it be, so what would it be like that ... <br><br>  In between, an open version 1.6 came out with an interesting <a href="http://www.opensips.org/html/docs/modules/1.6.x/load_balancer.html">Load Balancer</a> module.  The principle is interesting, open-storage keeps in mind the number of specified resources, and sends calls where they are free.  It remains to get the number of agents from Trixbox every minute and modify the database.  Eureka ?! <br><br>  Not quite <br><br>  1: He does this not equivalent to the number of agents, that is, he clogs the first resource to 0, then the second.  (in our case the first center, the second) <br>  2: Opensips cannot play audio, and in general there are no queues, this is a proxy. <br>  3: Alpha version. <br><br>  <b>Decision,</b> <br><br>  1: I wrote to the main developer of the open-source (Bogdan) he made the necessary algorithm for us.  You can see <a href="http://www.opensips.org/html/docs/modules/1.6.x/dispatcher.html">here</a> <br>  2: Use asterisk for audio and queue. <br>  3: We baptize, test, test. <br><br>  <b>New system:</b> <br><br>  The asterisk takes a call, and tries to call through an open-ended subscription, if there are resources, it passes, there are no resources, we are waiting.  All customers are in one place which reduces the number of unanswered calls in comparison with the old system.  Updating the number of resources is every X seconds.  What are these resources?  This is the number of logged in agents in Triksboh. <br><br><img src="http://img638.imageshack.us/img638/4710/diagram2.png" alt="image"><br><br>  We set up 4 servers, everything needs to be duplicated, network power, network adapters in different switches, two servers on separate hangars with different power sources, between them double optics "ring".  Physical characteristics are: <br><br>  Dell r410 double quad core xenon, download statistics: <br><br>  <b>Opensips</b> <br><br>  top - 19:05:59 up 35 days, 4:16, 2 users, load average: 1.10, 1.24, 1.21 <br>  Tasks: 192 total, 1 running, 191 sleeping, 0 stopped, 0 zombie <br>  Cpu (s): 9.2% us, 1.3% sy, 0.0% ni, 89.4% id, 0.2% wa, 0.0% hi, 0.0% si, 0.0% st <br>  Mem: 4043228k total, 3905396k used, 137832k free, 256656k buffers <br>  Swap: 6094840k total, 108k used, 6094732k free, 3101996k cached <br><br>  <b>Asterisk:</b> <br><br>  top - 19:10:31 up 37 days, 23:40, 3 users, load average: 0.04, 0.05, 0.12 <br>  Tasks: 175 total, 1 running, 174 sleeping, 0 stopped, 0 zombie <br>  Cpu (s): 0.0% us, 16.7% sy, 0.0% ni, 83.3% id, 0.0% wa, 0.0% hi, 0.0% si, 0.0% st <br>  Mem: 4037580k total, 2375616k used, 1661964k free, 156400k buffers <br>  Swap: 6094840k total, 168k used, 6094672k free, 1876072k cached <br><br>  On an asterisk removed late, usually they on average 0.5 Load.  We are thinking of adding memory and processors at the open-source system, the system is eating, optimization has not helped. <br><br>  <b>Launch</b> <br><br>  The nightmare, the system kicked, stalled in the middle of the day, the client spat, we worked at night.  Bugs came out, the problem is that they were difficult to detect without real server load, synthetic tests did not help.  It took us 5 days to fix bugs.  The schedule was interesting, you work at night, in the daytime you look so that it would not fall.  I <b>SAW</b> these 180 people who did not work for me, their curses went straight to my brain.  During these five days I understood what it means to be in a burning pan.  But on the fifth day it worked, after there were only minor modifications.  Customer satisfied. <br><br>  <b>Interface</b> <br><br>  The web interface is simple and functional, there are no extra ryushechek, and here it is.  The truth had to rub the names, because of legal issues. <br><br>  <b>Login:</b> <br><br><img src="http://img20.imageshack.us/img20/7044/loginmr.png" alt="image"><br><br>  Global statistics in digital form.  All in French, I will try to explain: <br><br>  <b>Nombre d'appels totaux pour la journ√©e</b> : The number of calls received. <br>  <b>Temps de r√©ponse estim√©</b> : Average waiting time. <br>  <b>Appels en attente</b> : The number of people in the queue (they have not yet been answered). <br>  <b>Appels re√ßus</b> : The number of calls received. <br>  <b>Agents [Total: Libre: En com]</b> : Agents [All: Free: Speak] <br>  <b>Appels abandonn√©es</b> : Number of clients who hung up before contacting an agent. <br>  <b>Efficacit√© Globale</b> : Overall effectiveness,% of the <b>answers</b> from the total accepted. <br>  <b>Charge Globale</b> : Global load, well, if 10 out of 10 are talking, and 0 people are waiting, then the load is 100% and so on ... <br><br><img src="http://img20.imageshack.us/img20/7187/statstg.png" alt="image"><br><br>  The same, but statistics on one center: <br><br><img src="http://img20.imageshack.us/img20/5784/callcentrestats.png" alt="image"><br><br>  <b>Charts</b> , pay attention to the second schedule, now the number of agents is faster and more efficiently adapted to workload, when there is nothing to do they do other things instead of sticking out at the phone that rings once every half hour. <br>  But it is clear that they can still put pressure on lunch. <br><br><img src="http://img20.imageshack.us/img20/9161/graph2m.png" alt="image"><br><br>  The rest of the screenshots I will insert a smaller one, and even so the topic is long.  Who cares he will look. <br><br> <a href="http://img20.imageshack.us/i/graphaa.png/"><img src="http://img20.imageshack.us/img20/5648/graphaa.th.png"></a> <br> <a href="http://img20.imageshack.us/i/customfi.png/"><img src="http://img20.imageshack.us/img20/6185/customfi.th.png"></a> <br> <a href="http://img20.imageshack.us/i/planning.png/"><img src="http://img20.imageshack.us/img20/8980/planning.th.png"></a> <br> <a href="http://img20.imageshack.us/i/agents.png/"><img src="http://img20.imageshack.us/img20/4958/agents.th.png"></a> <br> <a href="http://img20.imageshack.us/i/reportingpersonal.png/"><img src="http://img20.imageshack.us/img20/9762/reportingpersonal.th.png"></a> <br><br>  <b>Race results</b> <br><br>  7-10% increase in productivity. This is only for dialing centers, a global time saving for other tasks.  The disappearance of routine tasks, such as the compilation of resources by the management centers of the dialer. <br><br>  Our website: <a href="http://www.ipbx-france.fr/">www.ipbx-france.fr</a> <br><br>  Special thanks to the Master of Code team for their work on the web part of the muzzle and internal scripts. <br>  Thank you all for your attention. </div><p>Source: <a href="https://habr.com/ru/post/84360/">https://habr.com/ru/post/84360/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../84350/index.html">Cheapest way to get to Hawaii</a></li>
<li><a href="../84351/index.html">Zend Framework Tips and Tricks</a></li>
<li><a href="../84355/index.html">Our iPad Killer</a></li>
<li><a href="../84357/index.html">SVN: Six months later</a></li>
<li><a href="../84359/index.html">iPhone development: Integrating In-App Purchases</a></li>
<li><a href="../84361/index.html">Cubestormer robot, collects the Rubik's cube in 12 seconds</a></li>
<li><a href="../84362/index.html">Where do you go for packaging from household and computer equipment?</a></li>
<li><a href="../84364/index.html">Akinator and Mathematics</a></li>
<li><a href="../84367/index.html">NOMOBILE.RU at MWC-2010. Day zero and day one. How it was</a></li>
<li><a href="../84368/index.html">Troubleshooting xdebug with php version 5.3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>