<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Phalcon: Let's learn by example</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="More recently, the Habr√© mentioned the PHP MVC Framework written in C, where its advantages and disadvantages were described. With this article I want...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Phalcon: Let's learn by example</h1><div class="post__text post__text-html js-mediator-article"><img src="http://habrastorage.org/storage2/4ae/a6d/f00/4aea6df00753383c2f255e92fbfbf967.png" alt="PHP MVC Framework - PhalconPHP" align="left"><br>  More recently, the Habr√© <a href="http://habrahabr.ru/post/159217/">mentioned the</a> PHP MVC Framework written in C, where its advantages and disadvantages were described.  With this article I want to continue my acquaintance with a rather interesting web developer tool - <b>PhalconPHP</b> . <br><br>  This article is a free translation of the <a href="http://docs.phalconphp.com/en/0.7.0/reference/tutorial.html">basic lesson</a> , in which the process of creating an application with a simple registration form will be reviewed, and the main aspects of the framework's behavior will be explained. <br><br>  The best way to use this guide is to go through it step by step. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The end result can be found on <a href="https://github.com/phalcon/tutorial">github</a> . <br>  The application framework can be automatically generated using <a href="http://docs.phalconphp.com/en/0.7.0/reference/tools.html">developer tools</a> , but this article does not describe this feature. <br><br>  Installing Phalcon PHP is quite trivial, it all comes down to installing a PHP extension, which can be <a href="http://phalconphp.com/download">downloaded</a> from the official site. <br><br>  With Phalcon PHP installed, check for the presence of the ‚ÄúPhalcon‚Äù section in the phpinfo () output results, or execute the snippet below: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> print_r(get_loaded_extensions());</code> </pre> <br>  Among other extensions, you should see phalcon: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">Array</span></span> ( [<span class="hljs-number"><span class="hljs-number">0</span></span>] =&gt; Core [<span class="hljs-number"><span class="hljs-number">1</span></span>] =&gt; libxml [<span class="hljs-number"><span class="hljs-number">2</span></span>] =&gt; filter [<span class="hljs-number"><span class="hljs-number">3</span></span>] =&gt; SPL [<span class="hljs-number"><span class="hljs-number">4</span></span>] =&gt; standard [<span class="hljs-number"><span class="hljs-number">5</span></span>] =&gt; phalcon [<span class="hljs-number"><span class="hljs-number">6</span></span>] =&gt; pdo_mysql )</code> </pre><br><br><h4>  Directory structure </h4><br>  Phalcon does not require the use of any particular project hierarchy; to develop an application, you can use such a structure you are used to working with. <br><br>  For example, in this lesson we will use the following structure: <br><br><pre> tutorial /
   app /
     controllers /
     models /
     views /
   public /
     css /
     img /
     js /
</pre><br>  Note that you do not need a directory like ‚Äúlibrary‚Äù to host the framework, Phalcon is already accessible from memory and is ready for use. <br><br><h4>  Beautiful URLs </h4><br>  This lesson uses human-readable URLs (CNCs).  CNC is not only useful for search engine optimization, but also makes it easier for users to memorize links.  Support of CNC by your application is not required, you are free to develop a project without their support. <br><br>  This example uses <code>mod_rewrite</code> for Apache and, based on our directory structure, we need two .htaccess files: one at the root of the project, the other in a public directory. <br><br><pre> <code class="apache hljs"><span class="hljs-comment"><span class="hljs-comment">#/.htaccess &lt;IfModule mod_rewrite.c&gt; RewriteEngine on RewriteRule ^$ public/ [L] RewriteRule (.*) public/$1 [L] &lt;/IfModule&gt;</span></span></code> </pre><br>  All requests to the application will be sent to the <code>public/</code> directory.  This step ensures that internal project folders remain hidden from public access, reducing the security risk. <br><br>  The second set of rules checks if the required file exists.  If the file is missing, the web server converts the request to the required form for the framework. <br><br><pre> <code class="apache hljs"><span class="hljs-comment"><span class="hljs-comment">#/public/.htaccess &lt;IfModule mod_rewrite.c&gt; RewriteEngine On RewriteCond %{REQUEST_FILENAME} !-d RewriteCond %{REQUEST_FILENAME} !-f RewriteRule ^(.*)$ index.php?_url=/$1 [QSA,L] &lt;/IfModule&gt;</span></span></code> </pre><br>  <i>Translator's note: in terms of both security and performance, it will be more efficient to take the application out of public_html, leaving only the images, js and css available.</i>  <i>But we will not deviate from the example.</i> <br><br><h4>  Bootstrap bootstrap </h4><br>  The first file you need to create is the init script.  This file implements the initialization of components, it serves as the basis of the application, providing control over its entire behavior. <br><br>  The <code>public/index.php</code> Bootstrap file looks like this: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//Register an autoloader $loader = new \Phalcon\Loader(); $loader-&gt;registerDirs(array( '../app/controllers/', '../app/models/' ))-&gt;register(); //Create a DI $di = new Phalcon\DI\FactoryDefault(); //Setting up the view component $di-&gt;set('view', function(){ $view = new \Phalcon\Mvc\View(); $view-&gt;setViewsDir('../app/views/'); return $view; }); //Handle the request $application = new \Phalcon\Mvc\Application(); $application-&gt;setDI($di); echo $application-&gt;handle()-&gt;getContent(); } catch(\Phalcon\Exception $e) { echo "PhalconException: ", $e-&gt;getMessage(); }</span></span></code> </pre><br>  Below we analyze each part of this file in more detail. <br><br><h4>  Autoloader </h4><br>  The first part of the initialization file is the autoloader registration.  It is used to load controllers and models.  For example, we can register one or more controller directories, increasing the flexibility of the application.  In our example, the <code>Phalcon\Loader</code> component is used. <br><br>  With it, you can load classes using different approaches, but in this example we chose to detect classes based on predefined directories. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $loader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \Phalcon\Loader(); $loader-&gt;registerDirs( <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'../app/controllers/'</span></span>, <span class="hljs-string"><span class="hljs-string">'../app/models/'</span></span> ) )-&gt;register();</code> </pre><br><br><h4>  Dependency management </h4><br>  Working with the Phalcon framework, it is necessary to understand the concept of dependency <a href="http://docs.phalconphp.com/en/0.7.0/reference/di.html">injection</a> ( <a href="http://docs.phalconphp.com/en/0.7.0/reference/di.html">Dependency injection</a> , <a href="http://ru.wikipedia.org/wiki/%25D0%2592%25D0%25BD%25D0%25B5%25D0%25B4%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B7%25D0%25B0%25D0%25B2%25D0%25B8%25D1%2581%25D0%25B8%25D0%25BC%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">wiki</a> ).  This may seem complicated, but in reality everything is very simple and practical. <br><br>  Phalcon contains a mechanism that stores the components necessary for the operation of the application, and provides access to them upon request by the framework.  This mechanism is the class <code>Phalcon\DI</code> , which acts as a link, combining the various components to work together. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//Create a DI $di = new Phalcon\DI\FactoryDefault();</span></span></code> </pre><br>  <a href="http://docs.phalconphp.com/en/0.7.0/api/Phalcon_DI_FactoryDefault.html">Phalcon \ DI \ FactoryDefault is the</a> heir of <code>Phalcon\DI</code> implementing dependency injection.  It registers most of the standard framework components.  Thus, we should not register them one by one.  If necessary, you can easily replace it with your own implementation. <br><br>  The next step is to register the ‚Äúview‚Äù component.  Since view files are not classes, they cannot be loaded using the autoloader, so we must specify their location. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//Setting up the view component $di-&gt;set('view', function(){ $view = new \Phalcon\Mvc\View(); $view-&gt;setViewsDir('../app/views/'); return $view; });</span></span></code> </pre><br>  The <a href="http://docs.phalconphp.com/en/0.7.0/api/Phalcon_Mvc_Application.html">Phalcon \ Mvc \ Application</a> component is registered in the last part of this file.  Its purpose is to initialize the request environment, process the route, and perform the corresponding request action.  It receives a response from the controller and returns it when the process is complete. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $application = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \Phalcon\Mvc\Application(); $application-&gt;setDI($di); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $application-&gt;handle()-&gt;getContent();</code> </pre><br>  As you can see, the initialization file is quite simple and we do not need to include any additional files.  We set the stage for a flexible MVC application in less than 30 lines of code. <br><br><h4>  Controller </h4><br>  By default, Phalcon searches for a controller and its action with the name ‚ÄúIndex‚Äù.  It will be executed if the controller and action are not specified in the request.  The simplest controller looks like this: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Phalcon</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mvc</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">indexAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Hello!&lt;/h1&gt;"</span></span>; } }</code> </pre><br>  The controller class has the ‚ÄúController‚Äù suffix, and its action must have the ‚ÄúAction‚Äù suffix.  If you open the application in a browser, you will see something like this: <br><br><img src="http://docs.phalconphp.com/en/0.7.0/_images/tutorial-1.png" alt="image"><br><br>  <b>Congratulations, you are flying with a falcon!</b>  <i>(Approx. Translator: Phalcon is consonant with the English. Falcon - Falcon <a href="https://habr.com/ru/post/160311/">*</a> )</i> <br><br><h4>  View </h4><br>  Sending output to the screen directly from the controller is justified, but you should not do so.  The necessary data should be transferred to the view responsible for the display on the screen.  Phalcon will look for a view in a file with the same name as the last action taken, in a directory with the name of the last controller that was executed. <br><br>  In our case, this is <code>app/views/index/index.phtml</code> : <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Hello!&lt;/h1&gt;"</span></span>;</code> </pre><br>  And the controller itself ( <code>app/controllers/IndexController.php</code> ) now contains an empty action: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Phalcon</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mvc</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">indexAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre><br>  The view is processed automatically after the completion of the action.  The output in the browser should remain the same. <br><br><h4>  Registration form </h4><br>  Change the view <code>app/views/index/index.phtml</code> by adding a link to another ‚Äúsignup‚Äù controller: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Hello!&lt;/h1&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Phalcon\Tag::linkTo(<span class="hljs-string"><span class="hljs-string">"signup"</span></span>, <span class="hljs-string"><span class="hljs-string">"Sign Up Here!"</span></span>);</code> </pre><br>  The generated HTML will display the &lt;a&gt; tag with a link to the new controller: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Hello!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/test/signup"</span></span></span><span class="hljs-tag">&gt;</span></span>Sign Up Here!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  To generate a link, the <a href="http://docs.phalconphp.com/en/0.7.0/api/Phalcon_Tag.html">Phalcon \ Tag</a> class was used.  This auxiliary class allows you to build HTML in accordance with the framework standard.  <a href="http://docs.phalconphp.com/en/0.7.0/reference/tags.html">Here</a> you can find a more detailed description of the generation of HTML code. <br><br><img src="http://docs.phalconphp.com/en/0.7.0/_images/tutorial-2.png" alt="image"><br><br>  This is the new ‚ÄúSignup‚Äù <code>app/controllers/SignupController.php</code> ( <code>app/controllers/SignupController.php</code> ): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SignupController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Phalcon</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mvc</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">indexAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre><br><br>  The empty action ‚ÄúindexAction‚Äù directs to the form view ( <code>app/views/signup/index.phtml</code> ). <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Phalcon</span></span>\<span class="hljs-title"><span class="hljs-title">Tag</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;h2&gt;Sign using this form&lt;/h2&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Tag::form(<span class="hljs-string"><span class="hljs-string">"signup/register"</span></span>); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;p&gt; &lt;label <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>=<span class="hljs-string"><span class="hljs-string">"name"</span></span>&gt;Name&lt;/label&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Tag::textField(<span class="hljs-string"><span class="hljs-string">"name"</span></span>) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;/p&gt; &lt;p&gt; &lt;label <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>=<span class="hljs-string"><span class="hljs-string">"name"</span></span>&gt;E-Mail&lt;/label&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Tag::textField(<span class="hljs-string"><span class="hljs-string">"email"</span></span>) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;/p&gt; &lt;p&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Tag::submitButton(<span class="hljs-string"><span class="hljs-string">"Register"</span></span>) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;/p&gt; &lt;/form&gt;</code> </pre><br>  Opening this controller in the browser you will see something like this: <br><br><img src="http://docs.phalconphp.com/en/0.7.0/_images/tutorial-3.png" alt="image"><br><br>  <code>Phalcon\Tag</code> provides useful methods for creating form elements. <br>  In the <code>Phalcon\Tag::form</code> method, we passed the path to the controller / action of the application that will process the form. <br><br>  By clicking on the ‚ÄúRegister‚Äù button you will see an exception thrown from the framework, indicating the absence of the ‚Äúregister‚Äù action in the ‚Äúsignup‚Äù controller. <br><br><blockquote>  PhalconException: Action ‚Äúregister‚Äù was not found on controller ‚Äúsignup‚Äù </blockquote><br>  By implementing this action we will get rid of the exception: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SignupController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Phalcon</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mvc</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">indexAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre><br>  Again, sending the form you will see a blank page. <br><br>  The username and email entered must be saved in the database.  In accordance with the principles of MVC, interaction with the database must be carried out by the application model to provide clean object-oriented code. <br><br><h4>  Model </h4><br>  Phalcon brings the first ORM for PHP, written entirely in C.  Instead of increasing the complexity of development, it simplifies it. <br><br>  Before creating our first model, we need to have a table in the database.  A simple table for storing registered users might look like this: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`users`</span></span> ( <span class="hljs-string"><span class="hljs-string">`id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> AUTO_INCREMENT, <span class="hljs-string"><span class="hljs-string">`name`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">70</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`email`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">70</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-string"><span class="hljs-string">`id`</span></span>) );</code> </pre><br>  The model must be located in the <code>app/models</code> directory. <br>  This will look like a model that provides access to the ‚Äú <code>users</code> ‚Äù table: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Users</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Phalcon</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mvc</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Model</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre><br><br><h4>  DB connection </h4><br>  In order to be able to use a database connection and access data through models, we need to specify connection settings in the initialization file.  Connecting to a database is just another component that other components can later use. <br><br>  The updated bootstrap file (public / index.php) will look like this: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//Register an autoloader $loader = new \Phalcon\Loader(); $loader-&gt;registerDirs(array( '../app/controllers/', '../app/models/' ))-&gt;register(); //Create a DI $di = new Phalcon\DI\FactoryDefault(); //Set the database service $di-&gt;set('db', function(){ return new \Phalcon\Db\Adapter\Pdo\Mysql(array( "host" =&gt; "localhost", "username" =&gt; "root", "password" =&gt; "secret", "dbname" =&gt; "test_db" )); }); //Setting up the view component $di-&gt;set('view', function(){ $view = new \Phalcon\Mvc\View(); $view-&gt;setViewsDir('../app/views/'); return $view; }); //Handle the request $application = new \Phalcon\Mvc\Application(); $application-&gt;setDI($di); echo $application-&gt;handle()-&gt;getContent(); } catch(\Phalcon\Exception $e) { echo "PhalconException: ", $e-&gt;getMessage(); }</span></span></code> </pre><br>  Now our models are ready to work and interact with the rest of the application. <br><br><h4>  Saving data using the model </h4><br>  Our next step: getting data from a form and writing it to a table. <br>  Let's add the ‚Äúregister‚Äù action: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SignupController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Phalcon</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mvc</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">indexAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Request variables from html form $name = $this-&gt;request-&gt;getPost("name", "string"); $email = $this-&gt;request-&gt;getPost("email", "email"); $user = new Users(); $user-&gt;name = $name; $user-&gt;email = $email; //Store and check for errors if ($user-&gt;save()) { echo "Thanks for register!"; } else { echo "Sorry, the following problems were generated: "; foreach ($user-&gt;getMessages() as $message) { echo $message-&gt;getMessage(), "&lt;br/&gt;"; } } } }</span></span></code> </pre><br><br>  You can never trust the data received from the user.  The data transferred to our application must be <a href="http://docs.phalconphp.com/en/0.7.0/reference/filter.html">validated / filtered</a> .  This will make the application more secure from attacks like SQL injections. <br><br>  In our application, we apply the ‚Äú <code>string</code> ‚Äù filter to the entered name and the ‚Äú <code>email</code> ‚Äù filter to the email address to make sure that the user has not sent us any malicious characters. <br><br>  The <a href="http://docs.phalconphp.com/en/0.7.0/api/Phalcon_Filter.html">Phalcon \ Filter</a> component makes this task elementary, since it is embedded from the dependency container in a call to the getPost method. <br><br>  Next, we create an instance of the <code>Users</code> model.  Public properties of the model correspond to the fields in the <code>users</code> table.  By setting the values ‚Äã‚Äãof the new model and calling the <code>save()</code> method, we write to the database.  The <code>save()</code> method returns a Boolean value that informs us whether the record was successful. <br><br>  Additional validation occurs automatically for fields that are marked as <code>not null</code> (i.e., are required).  If you leave the fields blank when sending the form, then in the browser you will see the message: <br><br><blockquote>  Sorry, the following problems were generated: name is required <br>  email is required </blockquote><br><br><h4>  Conclusion </h4><br>  This very simple lesson is designed to show how easy it is to start developing your application on the Phalcon PHP framework.  The fact that Phalcon is an extension to PHP written in C does not contradict the simplicity of development. <br><br>  I invite you to continue to study the <a href="http://docs.phalconphp.com/en/0.7.0/index.html">manual</a> , which will open for you the additional features offered by Phalcon! <br><br>  ___ <br><a name="Falcon"></a>  * Falcon is the fastest bird, and generally a living creature, in the world.  But, in fairness, it is worth noting that in the speed of horizontal flight, the falcon is inferior to the swift. </div><p>Source: <a href="https://habr.com/ru/post/160311/">https://habr.com/ru/post/160311/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../160301/index.html">Work with time in Google</a></li>
<li><a href="../160303/index.html">Life and death of information technology</a></li>
<li><a href="../160305/index.html">Who uses Node.js: Trello (Part 1)</a></li>
<li><a href="../160307/index.html">Increase the reliability of the data center! (photo from the thermal imager inside)</a></li>
<li><a href="../160309/index.html">What online dictionaries / translators do you use?</a></li>
<li><a href="../160313/index.html">Own module for admin on Webasyst</a></li>
<li><a href="../160315/index.html">Export message history from Skype 4. *</a></li>
<li><a href="../160317/index.html">Color profiles and their use</a></li>
<li><a href="../160319/index.html">Ecosystem battles: how technological empires can start a war to control the digital life of users</a></li>
<li><a href="../160321/index.html">An anonymous interview with a former participant of the cutting scene. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>