<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Monitoring delays during online video broadcasts and teleconferences</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About a week ago there was an interesting article about the methods of organizing video broadcasts with the lowest possible delay, and a number of leg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Monitoring delays during online video broadcasts and teleconferences</h1><div class="post__text post__text-html js-mediator-article">  About a week ago there was an <a href="http://habrahabr.ru/post/265675/">interesting article</a> about the methods of organizing video broadcasts with the lowest possible delay, and a number of legitimate questions were voiced in the comments, many of which I did not see a complete and meaningful answer.  In my post I would like to add material from my colleagues and share with my readers my thoughts on the following issues: <br><br>  <b>Why do we need a minimum delay?</b> <b><br></b>  <b>How can you easily and visually measure the delay in video transmission?</b> <b><br></b>  <b>What elements of the video path to increase the delay?</b> <br><br><img src="https://habrastorage.org/files/1dc/cc7/e8d/1dccc7e8d7d64270a1af86b64506715b.jpg"><br>  <i>Our top result - FullHD signal flew to the server and back in less than half a second.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Interesting?  Then read on. <br><a name="habracut"></a><br>  So, <b>why do we need a minimum delay</b> ? <br><br>  My company organizes online video broadcasts, and lately we have been very actively developing the topic of telemedicine - we arrange broadcasts of surgical master classes, and we organize almost full-fledged TV bridges between operating and conference rooms: an image is transmitted from external cameras and medical devices ( endoscopes, laparoscopes, robotic surgeons), the spectators sit in comfortable chairs at the other end of the city, look at the healthy FullHD-picture screen, and ask the doctors if necessary.  In this scenario, the comfort in communication turned out to be very important for customers - everyone got used to the phone and Skype, and even a 3-4-second delay significantly complicates the interaction between the hall and the operating room, and it is very distracting for surgeons who perform the real operations. <br><br>  Here are the typical conditions in which we have to work: <br><br>  - 720p or 1080i signal, most often in SDI format, received either directly from the camera or medical stand, or from the program output of the switcher; <br>  - most often a fairly slow Internet, or its complete absence - a considerable part of the projects we do through 4G networks; <br>  - lack of external IP; <br>  - highly dynamic and extremely detailed picture, the need to maintain adequate color reproduction; <br><br>  I will say right away: we studied the options for Skype and video conferencing systems (video conferencing), tested them and safely buried them. <br><br>  The main problems of Skype are the impossibility of manually adjusting the video quality parameters, and its ‚Äútoo smart‚Äù coding algorithm, which can independently begin to degrade picture quality if it suddenly decides that it lacks the width of the Internet channel.  Well, to get in Skype a picture from the SDI output of the switcher is a separate witch, not every Muggle is subject to ... <br><br>  The video conferencing also did not turn out smoothly - the essential requirements for the bandwidth of the channel, the availability of external IPs, the lack of professional video and audio inputs, a completely horse price tag for both buying and renting, and at the same time ‚Äúno‚Äù quality.  Yes, it‚Äôs possible that the VKS can be beautifully shown by the uncle and aunt in suits sitting in a fashionably decorated rally room, but when at one status medical event our competitors launched a broadcast from the laparoscopic stand through the VKS, the picture came terrifying video signal with high detail, and instead of FullHD on the screens there was a completely infernal kaleidoscope that most resembled the trailer for the Pixels movie. <br><br>  The picture quality on our mass broadcasts conducted via our own servers based on Wowza was much better than on Skype and on video conferencing, plus we had a decent fleet of encoders - powerful compact computers with SDI video capture cards, which made it possible to do several projects without nerves at the same time. <br><br>  I set before my engineers the task of ‚Äúsqueezing‚Äù the maximum possible speed out of Wowza, and immediately the question arose of <b>how and what to measure the delay</b> ?  Frankly, they thought for a long time, and therefore the result looks even more amusing, once again confirming that everything ingenious is simple. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/KM5tL_mvrkc%3Ffeature%3Doembed&amp;xid=17259,15700022,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhZzxBOq0ljFdj7HAtTQRreWt2EzA" frameborder="0" allowfullscreen=""></iframe><br><br>  We took as a basis the classic ‚Äúcountdown‚Äù used (or rather, not used for a long time) in film and television production, making it a bit more informative and detailed. <br><br>  The measurement procedure is ridiculously simple: we turn on the video in the player, run through the entire video path, put the transmitting and receiving computer screens nearby, tritely photograph both screens on the phone, subtract the smaller figure from the larger one, and get the delay time accurate to the frame.  Accordingly, if the transmission and reception points are removed, then you can send a signal from site A, receive it at site B, immediately send it back to site A, take a similar picture, and divide the result into two.  The revolving timecode and the red square that is pointing back and forth allow you to visually monitor the possible misalignments of the transmission of a video stream of the ‚Äústuck‚Äù type and ‚Äúexplosions‚Äù of the picture. <br><br>  Using this simple tool, we conducted a total revision of our video path, conjured with the server settings, and literally milliseconds squeezed all the delays, having a rather good result - when broadcasting via ‚Äúdedicated‚Äù we received FullHD video speed of 4-5 Mbit / s in 11-16 frames (about half a second).  When broadcasting over 4G networks and when transmitting over long distances (for example, testing St. Petersburg - Astana), the delay increased by about half a second.  Here, of course, complex routing between the points of transmission and reception is already beginning to be felt. <br><br>  For obvious reasons, I will not disclose the nuances of ‚Äútuning‚Äù a broadcast server, but I want to draw attention to an important nuance ‚Äî often <b>tangible delays come from the ‚Äúiron‚Äù elements of the video section</b> , which few people think about when preparing a project.  For example, we are making a teleconference with a conference room in a hotel, where all the switching on projectors is done on VGA, and you have the entire receiving path on SDI or HDMI - you can be sure that the mixer and conversion to VGA will add at least half a second to you.  Antediluvian projector connected by "composite"?  Second.  At the transfer point, they put a cheap camera with an HDMI output, and screwed an SDI-HDMI converter to it with tape?  Lost three frames.  Calculate how much such converters, splitters, and other pieces of hardware you have in your path, and get very impressive numbers, often negating the efforts of translation engineers.  The conclusion is simple - optimize the path, removing all unnecessary signal conversion. <br><br>  And for testing, you can safely use our video, you can download it for free at <a href="https://yadi.sk/i/Hduocjbkix39N">this link</a> . <br><br>  PS For fans of unpretentious labyrinths - a block diagram of switching from one of our medical projects. <br><br><img src="https://habrastorage.org/files/79a/8ca/cdd/79a8cacddf9e42e788800ffe32223f64.jpg"></div><p>Source: <a href="https://habr.com/ru/post/267269/">https://habr.com/ru/post/267269/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267245/index.html">RailsClub 2015: Interview with Nikolai Ryzhikov</a></li>
<li><a href="../267247/index.html">How many tweets do you need to know your character?</a></li>
<li><a href="../267253/index.html">In the Chinese AppStore, 39 infected applications were detected due to a modified version of Xcode.</a></li>
<li><a href="../267257/index.html">New PHP, Part 1: Return types</a></li>
<li><a href="../267265/index.html">The digest of interesting materials for the mobile developer # 121 (September 14-20)</a></li>
<li><a href="../267271/index.html">It's harder for Chinese data center operators to use freecooling.</a></li>
<li><a href="../267273/index.html">Linux in a device based on the Altera SoC FPGA chip: restore lost functionality</a></li>
<li><a href="../267277/index.html">How to write test code</a></li>
<li><a href="../267279/index.html">The digest of interesting materials from the world of web development and IT for the last week No. 177 (September 14 - 20, 2015)</a></li>
<li><a href="../267281/index.html">PHP Digest number 70 - interesting news, materials and tools (September 6 - 20, 2015)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>