<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why the SoundCloud team switched to microservices</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have already talked about the imgix photoservice data center, described the detective story of finding problems with SSD disks of the Algolia proje...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why the SoundCloud team switched to microservices</h1><div class="post__text post__text-html js-mediator-article">  We have already talked about the <a href="http://habrahabr.ru/company/1cloud/blog/261089/">imgix photoservice</a> data center, described the <a href="http://habrahabr.ru/company/1cloud/blog/262257/">detective story of</a> finding problems with SSD disks of the Algolia project, and today we present to your attention how the SoundCloud streaming service team switched to using microservices. <br><br> <a href="http://habrahabr.ru/company/1cloud/blog/266699/"><img src="https://habrastorage.org/files/d73/81f/85b/d7381f85b3d04dd39ff68141a743250a.jpg"></a> <a name="habracut"></a><br>  / <a href="https://www.flickr.com/photos/jonathangrossphotography/16020203085/">photo Jonathan Gross</a> <a href="https://creativecommons.org/licenses/by-nd/2.0/">CC</a> <br><br>  Recently, microservices have become a real hit, but the company made the move not for technical reasons, but for productivity reasons.  Two teams worked together with one of the working projects, which was a monolithic application on Ruby on Rails, a <a href="https://developers.soundcloud.com/blog/building-the-next-soundcloud">one-page JavaScript web application</a> and a <a href="http://www.slideshare.net/pcalcado/pcalcado-gotoberlin2013-27296652">client to a public API</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      They were isolated from each other and even worked in different buildings.  The development process was based on the description of ideas, mocaps, the creation of layouts, code, and the layout of the project after a short test.  As a result, engineers and designers complained about the overload, while product managers and partners complained that nothing was ever done on time. <br><br>  At this stage of the project development, it was critically important to announce a partnership with a number of prominent companies, but for this it was necessary to launch a closed beta test.  Just at this time, the team decided to find out where the organic growth of the company had led them. <br><br>  For this, a Value Stream Map was used, which helped to <a href="">visualize the</a> reality of the development process.  It turned out that many third-party services and iterations were involved.  For example, the specification was published in Drive, the cards on the board in Trello, the code changes in Pivotal Tracker, and so on.  As a result, the total implementation time increased also due to the fact that the second team usually waited for changes in the brunch to accumulate, and only then ‚Äúrolled in‚Äù them into production. <br><br>  In general, it took at least two months for a new feature to be implemented.  To solve the problem, the team decided to adapt the release train technique.  <a href="">Instead</a> of waiting for a few new features to accumulate, you can simply deploy them as soon as they are ready every day.  In this whole scheme, the main trouble was ping-pong between two front-end and back-end teams ‚Äî 47 days spent on ‚Äúengineering,‚Äù and 11 days ‚Äî on development.  The rest of the time was wasted on meaningless waiting. <br><br>  <a href="">An experiment</a> with the development of a pair of features by backend and front-end developers led to the fact that each individual employee began to spend more time working on a specific function.  At the same time, the process of obligatory code review (pull request) was preserved, before the code could get into the master branch of our Rails application. <br><br>  Further, the designer, product manager and front-end developers began to work together, and <a href="">the</a> development <a href="">cycle</a> was a little further reduced.  All this allowed the team to implement the first release of Next, <a href="http://techcrunch.com/2012/12/04/soundcloud-revamps-site-announces-new-numbers-180m-users-and-counting/">much earlier than the</a> deadline. <br><br>  Creation of pairs from employees of different specialties, which led to the structure of ‚Äúfeature teams‚Äù (feature team), which is used in SoundCloud today.  Further, in the process of working on a monolith on Ruby on Rails, the team was faced with questions regarding the practice of reviewing the code.  It was decided to apply a similar approach - the requirement of viewing the code by the second engineer, and with pair programming, such a review was carried out in real time. <br><br>  An experiment with several pairs revealed problems that made us start all over again.  The base of the monolith code was so extensive and covered so different aspects that no one could navigate in all this.  The company even born a meme "everything is always good until you need to climb into the monolith." <br><br>  As a result, a lot has come to reconsider.  The backend system was a black box that needed to be opened.  The output was not a monolith, but a platform with many components.  Each of them has its own owners and its own independent life cycle.  In addition, for different modules, <a href="https://en.wikipedia.org/wiki/Service-level_agreement">the service level</a> expectation also differed. <br><br>  Thus, at the code level, it was necessary to make sure that making changes to a specific function can be carried out in relative isolation, without having to touch the code of other components.  And from the point of view of deployment, it was necessary to make sure of the possibility of an isolated deployment of a feature that would lead to the creation of a group of servers responsible for only one feature. <br><br>  It was decided to go the other way and build everything that is needed for the monetization project, as services isolated from the monolith.  <a href="http://techcrunch.com/2013/03/11/soundclouds-new-moving-sounds-feature-holds-promise-for-ads-viral-content-like-tumblrs-gifs/">The project</a> included large-scale updates and a complete rethinking of the subscription model, but we managed to finish it earlier with two teams of two engineers each.  The experience was considered successful, and this approach was applied to all new developments. <br><br>  The new architectural <a href="">framework has</a> reduced the time to create new functions to, if not ideal, but much more acceptable for the company values ‚Äã‚Äãthat allowed not to lag behind competitors in the complex music market. <br><br>  One team is still responsible for the main objects, but now the architecture is more stable, which reduces the number of ‚Äúfires‚Äù.  As a result, even these employees can make time for switching to microservices. <br><br>  Today SoundCloud still has a monolithic code, but its importance is decreasing every day.  It is still critical for many functions, but now it does not even work directly with the Internet (thanks to a special <a href="http://www.martinfowler.com/bliki/StranglerApplication.html">system</a> ).  Perhaps it will never completely disappear - many functions are so small and stable that it may be cheaper to leave everything as it is, but after a year nothing really important will remain there. <br><br>  PS A little more about how we improve the work of the virtual infrastructure provider <b><a href="https://1cloud.ru/">1cloud</a></b> : <br><br><ul><li>  <a href="https://habrahabr.ru/company/1cloud/blog/281889/">How to create a virtual infrastructure provider: Experience 1cloud</a> </li><li>  <a href="https://habrahabr.ru/company/1cloud/blog/280748/">Client-oriented "cloud": Experience 1cloud</a> </li><li>  <a href="https://habrahabr.ru/company/1cloud/blog/278479/">Photo tour of the "cloud" of 1cloud</a> </li><li>  <a href="https://habrahabr.ru/company/1cloud/blog/278055/">A little about data storage and experience 1cloud</a> </li><li>  <a href="https://habrahabr.ru/company/1cloud/blog/277155/">UI Optimization: Experience 1cloud</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/266699/">https://habr.com/ru/post/266699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266685/index.html">Accelerate vectorization and memory accesses in DL_MESO: optimization examples with Vectorization Advisor on a large project</a></li>
<li><a href="../266687/index.html">Memory Profiling with Intel¬Æ VTune ‚Ñ¢ Amplifier XE</a></li>
<li><a href="../266689/index.html">Rating of data center operators in Russia by the degree of readiness to interact with foreign customers</a></li>
<li><a href="../266693/index.html">Under the hood rendering navigation data in MAPS.ME</a></li>
<li><a href="../266695/index.html">VAD (Voice Application Designer). Part 2 components (Call Related)</a></li>
<li><a href="../266701/index.html">Notes from Intel System Studio Developer: Debugging Android Linux Core with Intel JTAG Debugger and MinnowBoard MAX</a></li>
<li><a href="../266703/index.html">Microservices without servers (cloud version)</a></li>
<li><a href="../266705/index.html">Basics of preparing applications for deployment (Application packaging)</a></li>
<li><a href="../266707/index.html">Underground carders market. Translation of the book "KingPIN". Chapter 10. "Cris Aragon"</a></li>
<li><a href="../266713/index.html">Design unification from the backend: JavaScript on the server</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>