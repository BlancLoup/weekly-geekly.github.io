<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to read ads in C</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Even completely green C programmers have no problems reading these ads: 
 int foo[5]; // foo 5 int 
 char *foo; // foo char 
 double foo(); // foo dou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to read ads in C</h1><div class="post__text post__text-html js-mediator-article"> Even completely green C programmers have no problems reading these ads: <br> <code>int foo[5]; // foo   5   int <br> char *foo; // foo   char <br> double foo(); // foo     double <br></code> <br>  But as soon as the ads become a bit more complicated, it‚Äôs difficult to say exactly what it is.  For example: <br> <code>char *(*(**foo[][8])())[]; <br></code> <br><a name="habracut"></a><br>  It turns out that the rules for reading arbitrarily cumulative declarations are easily learned even by novice programmers (although it is impossible to use such a declared variable). <br><br><h3>  Basic and derived types </h3><br>  In addition to the variable name, the declaration consists of one basic type and may also contain a derived type, and this is the key to understanding the differences between them. <br><br>  Basic types: <br>  <strong>‚Ä¢ char</strong> <strong><br></strong>  <strong>‚Ä¢ signed char</strong> <strong><br></strong>  <strong>‚Ä¢ unsigned char</strong> <strong><br></strong>  <strong>‚Ä¢ short</strong> <strong><br></strong>  <strong>‚Ä¢ unsigned short</strong> <strong><br></strong>  <strong>‚Ä¢ int</strong> <strong><br></strong>  <strong>‚Ä¢ unsigned int</strong> <strong><br></strong>  <strong>‚Ä¢ long</strong> <strong><br></strong>  <strong>‚Ä¢ unsigned long</strong> <strong><br></strong>  <strong>‚Ä¢ float</strong> <strong><br></strong>  <strong>‚Ä¢ double</strong> <strong><br></strong>  <strong>‚Ä¢ long double</strong> <strong><br></strong>  <strong>‚Ä¢ void</strong> <strong><br></strong>  <strong>‚Ä¢ struct tag</strong> <strong><br></strong>  <strong>‚Ä¢ union tag</strong> <strong><br></strong>  <strong>‚Ä¢ enum tag</strong> <strong><br></strong>  <strong>‚Ä¢ long long</strong> <strong><br></strong>  <strong>‚Ä¢ unsigned long long</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An ad can contain only <strong>one main type</strong> , and it is always on the left of an expression.  The main types are complemented by derived types, in C there are three: <br><br>  1) <strong>* - pointer to ...</strong> <br>  It is denoted by the * symbol, and it is important to understand that the pointer <strong>always</strong> points to something. <br><br>  2) <strong>[] - an array of ...</strong> <br>  The array can be dimensionless - [], and maybe dimensional [10].  True or not, it does not matter when reading ads (usually the size of the array is written).  It should be clear that an array is always an "array of something." <br><br>  3) <strong>() - a function that returns ...</strong> <br>  It is usually indicated by a pair of parentheses (), but it is also possible that within them there will be parameter models. The parameter list (if any) does not play a significant role when reading ads, and we usually ignore it.  Note that the parentheses used to designate functions are different from the brackets used for grouping: grouping brackets surround variables, whereas brackets to designate a function are on the right. The function does not make sense if it returns nothing (when we declare a function with a return type of void then it just looks like the function returns void) <br><br>  Derived types <strong>always</strong> modify something, be it a basic type or a derivative, and in order to correctly read the declarations, one should always insert a preposition (‚Äúto‚Äù, ‚Äúfrom‚Äù, ‚Äúreturning‚Äù).  Using the ‚Äúpointer‚Äù instead of ‚Äúpointer to‚Äù when reading, you will definitely read the announcement incorrectly. <br><br><h3>  The priority of operators. </h3><br>  Almost every C programmer is familiar with operator precedence tables, which state that (for example) multiplication and division have higher priority (are performed earlier) than addition and subtraction, and grouping brackets are used to change this priority. This seems normal for ‚Äúordinary‚Äù expressions but the same rules apply to ads - they are just ‚Äútypical‚Äù, not computational. <br>  The operators ‚Äúarray of‚Äù <strong>[]</strong> and ‚Äúreturn function‚Äù <strong>()</strong> have a higher priority than ‚Äúpointer to‚Äù, which leads to a rather simple decoding rule: <br>  <strong>Always start with the variable name:</strong> <br><br>  <strong>foo is .....</strong> <br><br>  <strong>And finish the decoding with the main type:</strong> <br><br>  <strong>... of int type</strong> <br><br>  What will be in the middle is usually harder to make out, but you can formulate the rule: <br>  <strong>move to the right, if possible, and move to the left if necessary</strong> <br>  Starting with the variable name, following the rules of priority, move to the right as much as possible by deleting lexemes until you reach the grouping brackets. After that, move to the left in accordance with the brackets. <br><br><h3>  A simple example. </h3><br>  Let's start with a simple example: <br>  -&gt; <strong>long ** foo [7];</strong> <br><br>  Let's try to figure it out by focusing on one or two parts, highlighting them <strong>in bold type</strong> , otherwise we‚Äôve already decided to <s>cross out</s> <br><br>  -&gt; <font color="red">long</font> ** <font color="red">foo</font> [7]; <br><br>  We start with the variable name and end with the main type: <br>  <font color="red">foo is ... like long</font> <br><br>  We analyze further: <br>  -&gt; <s>long</s> ** <s>foo</s> <font color="red">[7]</font> ; <br><br>  At this moment, the variable name is surrounded by a token meaningful "array of 7" and a token meaningful "pointer to", and in accordance with the rule we move to the right and append to our description an "array of 7": <br>  foo is an <font color="red">array of 7</font> ... of type long <br><br>  -&gt; <s>long</s> * <font color="red">*</font> <s>foo [7]</s> ; <br><br>  There is no place to move to the right, and the nearest token is a ‚Äúpointer to‚Äù.  Add it: <br>  foo is an array of 7 <font color="red">pointers to</font> ... a value of type long <br><br>  -&gt; <s>long</s> <font color="red">*</font> <s>* foo [7]</s> ; <br><br>  The nearest lexeme is also a ‚Äúpointer to‚Äù, add it as well: <br>  foo is an array of 7 pointers to <font color="red">pointers to a</font> value of type long <br><br>  Well that's all. <br><br><h3>  Difficult example </h3><br><br>  To test our skills, we need to try to read a very complex announcement that will never occur in real life (in fact, we thought for a very long time how to apply this announcement). But we need to show that the rules also work for very complex declarations. <br><br>  -&gt; <font color="red">char</font> * (* (** <font color="red">foo</font> [] [8]) ()) []; <br>  All ads should start reading with "variable name ... main type" <br>  <font color="red">foo is ... of type char</font> ; <br><br>  -&gt; <s>char</s> * (* (** <s>foo</s> <font color="red">[]</font> [8]) ()) []; <br>  The name is adjacent to the "pointer to" and "array of", go right: <br>  foo is an <font color="red">array of</font> ... of type char; <br><br>  <s>char</s> * (* (** <s>foo []</s> <font color="red">[8]</font> ) ()) []; <br>  We can choose the right or left adjacent lexeme, but the rule says that you need to move to the right as far as possible, while there is something adjacent to the inside of the grouping brackets, so we go to the right. <br>  foo is an array from an <font color="red">array of</font> ... of type char; <br><br>  -&gt; <s>char</s> * (* (* <font color="red">*</font> <s>foo [] [8]</s> ) ()) []; <br>  We have reached the grouping brackets, and it is not possible to move further to the right, so we move to the left until we reach the pair grouping bracket to cross out all other lexemes. <br>  foo is an array from an array of <font color="red">pointers to</font> ... of type char; <br><br>  -&gt; <s>char</s> * (* ( <font color="red">*</font> <s>* foo [] [8]</s> ) ()) []; <br>  Again we move to the left and assign a ‚Äúpointer to‚Äù. <br>  foo is an array from an array of pointers to <font color="red">pointers to</font> ... of type char; <br><br>  -&gt; <s>char</s> * (* <s>(** foo [] [8])</s> <font color="red">()</font> ) []; <br>  After we added the ‚Äúpointer to‚Äù in the previous step, we reached the pairing grouping bracket, so we will continue to attach to the ‚Äúgrouping brackets‚Äù.  Now they are adjoined by the ‚Äúfunction returns‚Äù on the right and the ‚Äúpointer to‚Äù on the left.  We move to the right. <br>  foo is an array from an array of pointers to pointers to a <font color="red">function that returns</font> ... of type char; <br><br>  -&gt; <s>char</s> * ( <font color="red">*</font> <s>(** foo [] [8]) ()</s> ) []; <br>  We again rested against the grouping brackets, so we return to the left again. <br>  foo is an array from an array of pointers to function <font color="red">pointers that</font> return <font color="red">pointers to</font> ... of type char; <br><br>  -&gt; <s>char</s> * <s>(* (** foo [] [8]) ())</s> <font color="red">[]</font> ; <br>  Bypassing the grouping brackets, we see that now to the crossed out tokens there is an ‚Äúarray of‚Äù on the right and a ‚Äúpointer to‚Äù on the left, the ‚Äúarray of‚Äù is on the right, we will add. <br>  foo is an array from an array of pointers to function pointers that return pointers to an <font color="red">array of</font> ... of type char; <br><br>  -&gt; <s>char</s> <font color="red">*</font> <s>(* (** foo [] [8]) ()) []</s> ; <br>  Well, add the last lexeme. <br>  foo is an array from an array of pointers to function pointers that return pointers to an array of <font color="red">pointers to</font> char; <br><br>  We really do not know how to apply it, but the type description is correct. <br><br><h3>  Abstract ads </h3><br><br>  The C standard allows the use of abstract declarations when a type is to be declared, but not associated with a variable name.  This is used when casting, and as a <strong>sizeof</strong> argument, sometimes it looks terrifying: <br><br>  <strong>int (* (*) ()) ()</strong> ; <br><br>  Naturally, the question arises of where to start, so the answer will sound like "you need to find a place where the variable name will stand and be treated as a regular declaration."  Such a place will be only one, and to find it is actually very simple.  Using the syntax rules we know: <br><br>  ‚Ä¢ to the right of all tokens <br>  ‚Ä¢ to the left of all the tokens ‚Äúarray of‚Äù <br>  ‚Ä¢ to the left of all tokens "function returns" <br>  ‚Ä¢ inside all grouping brackets <br><br>  And now let's look at an example.  We see that the left set of tokens ‚Äúpointer to‚Äù sets one border and the right set of tokens ‚Äúfunction returns‚Äù sets another border. <br>  <s>int (* (*</s> <font color="red">‚Ä¢) ‚Ä¢</font> <s>()) ()</s> ; <br><br>  Red dots show where to put the name of a variable, but only one place satisfies the conditions (inside grouping brackets).  And what about us then with the announcement?  Here's what: <br><br>  <strong>int (* (* foo) ()) ()</strong> ; <br>  which our rules describe as: <br>  foo is a pointer to a function that returns a pointer to a function that returns a value of type int <br><br><h3>  Semantic constraints / Notes </h3><br>  Not all combinations of derived types are allowed.  It is possible to create ads that perfectly fit the syntactic rules, but which nevertheless will be erroneous (they will be syntactically correct, but semantically erroneous, for example) <br><br>  <strong>‚Ä¢ Cannot create an array of functions</strong> <br>  But you can use an array of function pointers. <br><br>  <strong>‚Ä¢ The function cannot return a function.</strong> <br>  But it can return a pointer to a function. <br><br>  <strong>‚Ä¢ The function cannot return an array.</strong> <br>  Again, the function can return a pointer to an array. <br><br>  <strong>‚Ä¢ In arrays, only the left token [] may be empty</strong> <br>  C supports multi-dimensional arrays (for example, foo [1] [2] [3] [4]), which is a very simple data structure.  However, when an array has more than one dimension, only the first brackets can be empty.  <strong>char foo []</strong> and <strong>char foo [] [5]</strong> have the right to exist, but char <strong>foo [5] [] is</strong> already prohibited <br>  <strong>‚Ä¢ Type "void" limited</strong> <br>  The type ‚Äúvoid‚Äù is a pseudo-type, and variables of this type can only be ‚Äúpointer to‚Äù and ‚Äúreturn function‚Äù.  It is forbidden (more precisely, impossible) to use an ‚Äúarray of void‚Äù and just variables of the ‚Äúvoid‚Äù type. <br>  void * foo;  // allowed <br>  void foo ();  // allowed <br>  void foo;  //prohibited <br>  void foo [];  //prohibited <br><br><h3>  Add call agreement type </h3><br>  When developing on the windows platform, it is often added to the description of the call convention function. This tells the computer which method to use to call the function in the request, and the method should be the same as the function expects.  Here's what it looks like: <br><br> <code>extern int __cdecl main(int argc, char **argv); <br> <br> extern BOOL __stdcall DrvQueryDriverInfo(DWORD dwMode, PVOID pBuffer, <br> DWORD cbBuf, PDWORD pcbNeeded);</code> <br> <br>  Such an addition is very often found in the development under win32, it is quite simple to understand.  More information in the article <a href="http://www.unixwiz.net/techtips/win32-callconv.html">Using win32 calling conventions</a> . <br><br>  Where it becomes somehow more complicated is when the calling convention has to be included in the ‚Äúpointer‚Äù (including typedef), because the token does not look like it fits the normal pattern. This is often used when it comes to working with <strong>LoadLibrary ( )</strong> and <strong>GetProcAddress ()</strong> API to call a function call from a newly loaded library. <br>  This can often be found with typedef: <br> <code>typedef BOOL (__stdcall *PFNDRVQUERYDRIVERINFO)( <br> DWORD dwMode, <br> PVOID pBuffer, <br> DWORD cbBuf, <br> PDWORD pcbNeeded <br> ); <br> <br> ... <br> <br> /* get the function address from the DLL */ <br> pfnDrvQueryDriverInfo = (PFNDRVRQUERYDRIVERINFO) <br> GetProcAddress(hDll, "DrvQueryDriverInfo")</code> <br> <br>  Call negotiation is an attribute of a function, not a pointer, so when reading this, you need to put it in front of the pointer, but still inside the grouping brackets: <br><br>  <strong>BOOL (__stdcall * foo) (...);</strong> <br><br>  Read: <br>  foo is a pointer to the __stdcall function returning a BOOL. <br><br>  ps Please write about inaccuracies in a personal. </div><p>Source: <a href="https://habr.com/ru/post/116255/">https://habr.com/ru/post/116255/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116246/index.html">IPad Web Development</a></li>
<li><a href="../116250/index.html">Time Management: Evolution</a></li>
<li><a href="../116251/index.html">A couple of words about the project diary</a></li>
<li><a href="../116253/index.html">Ubuntu 11.04 Application Center will provide an opportunity to "test-drive" applications without installing them directly.</a></li>
<li><a href="../116254/index.html">Transformer is already coming</a></li>
<li><a href="../116256/index.html">OMG and LOL words fall into the Oxford English Dictionary</a></li>
<li><a href="../116259/index.html">Target - Android</a></li>
<li><a href="../116260/index.html">Free business solutions in Russia are waiting for the fate of Linux</a></li>
<li><a href="../116261/index.html">iPad for young parents</a></li>
<li><a href="../116262/index.html">Rails. Adding an element when using nested attributes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>