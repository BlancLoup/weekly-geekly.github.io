<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How did we get the native module to React Native</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you are not familiar with ReactJS or React Native , then we highly recommend that you read, these frameworks already have a significant impact on w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How did we get the native module to React Native</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/230/81c/56d/23081c56d81744a686c0916ba25a2e2b.png" align="left">  If you are not familiar with <a href="http://facebook.github.io/react/">ReactJS</a> or <a href="https://facebook.github.io/react-native/">React Native</a> , then we highly recommend that you read, these frameworks already have a significant impact on where the world of mobile and web application development is heading.  Our article is about how to enable a web developer to make iOS applications with audio / video calls and other pleasures of the voximplant platform.  Creating native modules for React Native is such an extensive topic that you can write about it endlessly and there are still a lot of materials about it on the network.  When creating the module, we relied on a number of ready-made examples with github, which really helped not to dig in with this for centuries. <br><br><a name="habracut"></a><br><br><h1>  <font color="#0ac">What is React Native</font> </h1>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/7ea/73c/834/7ea73c834aaf4b5e9ca0f6384869805e.png" align="right">  I suspect that the vast majority of readers Habra knows about it.  But just in case: it is a framework from Facebook that allows you to create native iOS applications in javascript, while ReactJS is used to create the user interface.  Which, in turn, creates native operating system widgets instead of HTML DOM.  Moreover, the authors promise to do the same for Android in the future. <br><br><br><br><h1>  <font color="#0ac">What is Native Modules</font> </h1><br><br><img src="https://habrastorage.org/files/0f4/185/a7f/0f4185a7f44e4afe96805f2de1ad4da0.png" align="left">  In React Native, there are already a number of ready-made modules that come with the framework and allow you to do a lot of useful things, but obviously not all that a mobile application developer may want, and here come native modules to help: <br><br><blockquote>  ‚ÄúSometimes the corresponding module yet doesn‚Äôt need a corresponding module yet.  If you want to use it, it can be javascript, it can be javascript, it can be javascript or </blockquote><br><br>  This is our case, we have a lot of pieces in the <a href="http://voximplant.com/">voximplant</a> client SDK that will work normally only if they are written at a sufficiently low level: video / audio codecs, webrtc, srtp, ws, and other scary words.  And developers of React Native applications are not very interested in this, they want to deal with a clear high-level javascript API, since all of their applications are almost continuous javascript / jsx.  Packaging low-level code into the React Native module allows developers to focus on application development and not worry about magic under the hood. <br><br><h1>  <font color="#0ac">Native module architecture</font> </h1><br><br>  A native module can contain c / c ++ code, objective-c code, and javascript.  In the low-level code, we carried the network interaction with our cloud (c, c ++, libwebrtc and a small handful of libraries on a trifle) and video display (objective-c).  The high-level javascript code left the cloud wrapper and two React widgets: one for previewing your own video and the second for watching the interlocutor's video: <br><br><img src="https://habrastorage.org/files/7cb/ea0/958/7cbea09582004f3fa917da8f8368fc6f.png"><br><br>  Technically, the division into low-level and high-level code is as follows: you create an objective-c class that inherits from the RCTBridgeModule class provided by React.  Using RCT_EXPORT_METHOD type macros you specify interaction points with javascript code, while in objective-c code you can interact with the operating system, c / c ++ libraries, create native iOS widgets and do other useful and useful things. <br><br>  A ready-made native module can be distributed in different ways, the easiest one is to collect the source code in the form of .npm package and publish it in the repository.  In this case, to add a module to your project, you just need to do ‚Äúnpm install‚Äù, add the .xcodeproj and the assembled library (because users obviously don‚Äôt want to build libwebrtc with patches - something else is fun) and build your project. <br><br><h1>  <font color="#0ac">Functional</font> </h1><br><br><img src="https://habrastorage.org/files/7b3/d67/069/7b3d6706939a46b796a4a2d9d977b5ac.png" align="right">  In our case, everything is simple - the functionality of the module should repeat the functionality of voximplant mobile sdk, that is, support both audio and video calls through the platform, give the opportunity to turn on / off the loud speaker, microphone, change camera, etc.  In general, there is no way to restrict the developer due to the fact that he chose the path of the warrior react native. <br><br><br><br><br><br><h1>  <font color="#0ac">Using the module in React Native application</font> </h1><br><br>  Installing the module looks quite simple, in the project directory we execute: <br><br><pre><code class="bash hljs">npm install react-native-voximplant@latest --save</code> </pre> <br><br><img src="https://habrastorage.org/files/6cc/8da/82d/6cc8da82d84548cc86a51e645145b755.png" align="left">  After that, open your project in Xcode, in the project navigator, right-click <b>Add Files to</b> , go to <b>node_modules / react-native-voximplant</b> and select <b>VoxImplant.xcodeproj</b> . <br><br><br><br><br><br><img src="https://habrastorage.org/files/364/ff0/5a0/364ff05a07b94ee4bd662febd2eb5840.png" align="right">  Next, in the Xcode project navigator, select the project, switch to the ‚ÄúBuild Phases‚Äù tab, and in the ‚ÄúLink Binary with Libraries‚Äù section specify <b>GLKit.framework</b> , <b>libc ++. Dylib</b> , <b>libvoximplant.a</b> and <b>react-native-voximplant / VoxImplantSDK / libVoxImplantSDK.a</b> <br><br><br><br><br><br>  In the ‚ÄúBuild Settings‚Äù tab, we check that 'All' is selected (and not 'Basic'), find the Header Search Paths and make sure that there is <b>$ (SRCROOT) /../ react-native / React</b> and <b>$ (SRCROOT) / ../../React</b> and both are marked as ‚Äúrecursive‚Äù. <br><br>  That's all, then we write our application that uses the connected module: <br><br><div class="spoiler">  <b class="spoiler_title">some code</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> VoxImplant = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'react-native-voximplant'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Adding SDK event listener RCTDeviceEventEmitter.addListener( 'ConnectionSuccessful', () =&gt; { console.log('Connection successful'); } ); ... componentDidMount: function() { VoxImplant.SDK.connect(); VoxImplant.SDK.setCameraResolution(320,240); }, ‚Ä¶ makeCall: function() { VoxImplant.SDK.createCall(number, settings_video, null, function(callId) { currentCallId = callId; VoxImplant.SDK.startCall(callId); }); }, ...</span></span></code> </pre><br></div></div><br><br>  To simplify the task of familiarizing with the module, we made a demo application that can be taken from <a href="https://github.com/voximplant/react-native-demo">github</a> and assembled by following the instructions on the page.  The result is: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cd/39e/3c7/3cd39e3c72a3434cdff7c517f05d67d1.gif"></div><br><br><h1>  <font color="#0ac">Conclusion</font> </h1><br><br>  Many criticize React Native, speaking of the performance of javascript with respect to the ‚Äúnative‚Äù code.  In fact, such technologies allow to combine the best of both worlds: high-level and concise javascript is used for application logic code, while low-level c / c ++ / objective-c code is used for libraries and speed-critical sections of logic.  This approach allows you to evenly smear the complexity in parts of the application, avoiding its accumulation in one place - which often leads to over-complicated and unsupported code. <br><br>  Questions, comments, criticism?  We are traditionally ready to communicate. </div><p>Source: <a href="https://habr.com/ru/post/265761/">https://habr.com/ru/post/265761/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265749/index.html">Urho3D Editor (Part 1)</a></li>
<li><a href="../265751/index.html">Infobox VPS Review</a></li>
<li><a href="../265753/index.html">Truly responsive letters. Part two. Framework</a></li>
<li><a href="../265755/index.html">How to stop configuring and start living or setting up Puppet in a school classroom on 25 computers</a></li>
<li><a href="../265757/index.html">How I passed the OSCP</a></li>
<li><a href="../265763/index.html">Clusterize NetApp storage systems using handy switches</a></li>
<li><a href="../265765/index.html">Vendor replacement for IT infrastructure (telecommunications): which import can be exchanged for another import</a></li>
<li><a href="../265767/index.html">Preparing for iOS 9</a></li>
<li><a href="../265769/index.html">Best Approaches to Database Versioning</a></li>
<li><a href="../265771/index.html">Summary of Udi Dahan‚Äôs ‚ÄúIntegrated Service Approach‚Äù presentation from ¬µCon 2014: The Microservices Conference</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>