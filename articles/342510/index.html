<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>3D graphics from scratch. Part 1: ray tracing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is divided into two main parts, Ray Tracing and Rasterization , which discuss two main ways to get beautiful images from data. The Genera...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>3D graphics from scratch. Part 1: ray tracing</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad6/9dd/9e1/ad69dd9e1d49953b28fc5fdf901f06bf.png" alt="image"></div><br><br>  This article is divided into two main parts, <strong>Ray Tracing</strong> and <strong>Rasterization</strong> , which discuss two main ways to get beautiful images from data.  The <strong>General Concepts</strong> chapter presents some basic concepts necessary for understanding these two parts. <br><br>  In this paper, we will focus not on speed, but on a clear explanation of the concepts.  The code of examples is written in the most <em>understandable</em> way, which is not necessarily the most <em>efficient</em> for the implementation of algorithms.  There are many ways to implement, I chose the one that is easiest to understand. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The ‚Äúend result‚Äù of this work will be two complete, fully working renderers: a ray tracer and a rasterizer.  Although they use very different approaches, they render similar results when rendering a simple scene: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/188/1e1/463/1881e146387a6106617d616066add8eb.png"><br><a name="habracut"></a><br>  Although their capabilities largely overlap, they are not similar, so the article discusses their strengths: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b00/161/776/b0016177668c0a7a98f18fc489a1742a.png"><br><br>  The article in the form of an informal pseudocode presents the code of examples, it also contains fully working implementations, written in JavaScript, rendered on the <code>canvas</code> element, which can be run in the browser. <br><br><h2>  Why read this article? </h2><br>  This work will give you all the information you need to write software renderers.  Although in our era of video processors few will find compelling reasons for writing a purely software renderer, writing experience will be valuable for the following reasons: <br><br><ol><li>  <strong>Shaders</strong>  In the first video processors, the algorithms were hard-coded in hardware, but in modern programs the programmer must write his own shaders.  In other words, you still need to implement large fragments of the rendering software, only now it is executed in the video processor. </li><li>  <strong>Understanding</strong> .  Regardless of whether you use a ready-made pipeline or write your shaders, <em>understanding</em> what happens behind the scenes will allow you to make better use of the finished pipeline and write shaders better. </li><li>  <strong>Interesting</strong> .  Few areas of computer science can boast the ability to instantly obtain visible results, which gives us computer graphics.  The feeling of pride after starting the execution of the first SQL query is incomparable with the fact that you feel the first time when you manage to trace reflections correctly.  I taught computer graphics at the university for five years.  I was often amazed how I managed to enjoy semester after semester: in the end, my efforts justified themselves with the students' joy that they could use their first renders as desktop wallpapers. </li></ol><br><h1>  General concepts </h1><br><h2>  Canvas </h2><br>  In the process, we will draw objects on the <em>canvas</em> .  Canvas is a rectangular array of pixels that can be individually painted.  Will it be displayed on the screen, printed on paper, or used as a texture for subsequent rendering?  This is not important for our work: we will focus on rendering images on this abstract rectangular array of pixels. <br><br>  Everything in this article we will build from a simple primitive: draw a pixel on the canvas with the specified color: <br><br><pre>  canvas.PutPixel (x, y, color) </pre><br>  Now we will study the parameters of this method - coordinates and colors. <br><br><h2>  Coordinate systems </h2><br>  The canvas has a certain width and height in pixels, which we call <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-msubsup" id="MJXp-Span-2"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4" style="vertical-align: -0.4em;">w</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.071ex" height="2.419ex" viewBox="0 -780.1 1322.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-77" x="1011" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> C_w </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-msubsup" id="MJXp-Span-6"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-8" style="vertical-align: -0.4em;">h</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.841ex" height="2.419ex" viewBox="0 -780.1 1223.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="1011" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> C_h </script>  .  To work with its pixels, you can use any coordinate system.  On most computer screens, the origin point is in the upper left corner. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> x </script>  increases to the right as well <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> y </script>  - way down: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e86/4e7/268/e864e72687cfcaa3592b756d7806c9e2.png"><br><br>  This is a very natural coordinate system taking into account the organization of video memory, but for people it is not very familiar.  Instead, we will use the coordinate system commonly used for drawing graphs on paper: the origin of coordinates in the center <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> x </script>  increases to the right as well <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> y </script>  - up: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/82e/beb/f6b/82ebebf6b3176ec9b0faebbe074fcdd9.png"><br><br>  When using this coordinate system, the coordinate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> x </script>  is in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-21"><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-23"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-25" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mtext" id="MJXp-Span-26">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">r</span><span class="MJXp-mn" id="MJXp-Span-31">2</span></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-33"><span class="MJXp-msubsup" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-36" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mtext" id="MJXp-Span-37">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">r</span><span class="MJXp-mn" id="MJXp-Span-42">2</span></span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.538ex" height="2.66ex" viewBox="0 -832 9704 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="0" y="0"></use><g transform="translate(778,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-77" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6F" x="2350" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="2836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="3321" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="3788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="4239" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="5018" y="0"></use><g transform="translate(5463,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-77" x="1011" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6F" x="1572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="2057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="2543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="3009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="3461" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-5D" x="9425" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> [{- C_w \ over 2}, {C_w \ over 2}] </script>  and coordinate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-44"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> y </script>  - in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-46"><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;">h</span></span><span class="MJXp-mtext" id="MJXp-Span-53">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">r</span><span class="MJXp-mn" id="MJXp-Span-58">2</span></span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-60"><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">h</span></span><span class="MJXp-mtext" id="MJXp-Span-64">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">r</span><span class="MJXp-mn" id="MJXp-Span-69">2</span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.078ex" height="2.66ex" viewBox="0 -832 9506 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="0" y="0"></use><g transform="translate(778,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6F" x="2251" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="2737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="3222" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="3689" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="4140" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="4919" y="0"></use><g transform="translate(5364,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="1011" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6F" x="1473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="1958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="2444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="2910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="3362" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-5D" x="9227" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> [{- C_h \ over 2}, {C_h \ over 2}] </script>  (Note: strictly speaking, or <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mrow" id="MJXp-Span-72"><span class="MJXp-mo" id="MJXp-Span-73" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;">h</span></span><span class="MJXp-mtext" id="MJXp-Span-77">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">r</span><span class="MJXp-mn" id="MJXp-Span-82">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.779ex" height="2.419ex" viewBox="0 -780.1 4641.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="0" y="0"></use><g transform="translate(778,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6F" x="2251" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="2737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="3222" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="3689" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="4140" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> {- C_h \ over 2} </script>  , or <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mrow" id="MJXp-Span-84"><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-87" style="vertical-align: -0.4em;">h</span></span><span class="MJXp-mtext" id="MJXp-Span-88">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">r</span><span class="MJXp-mn" id="MJXp-Span-93">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.971ex" height="2.419ex" viewBox="0 -780.1 3862.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="1011" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6F" x="1473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="1958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="2444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="2910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="3362" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> {C_h \ over 2} </script>  are outside the interval, but we will ignore it.).  For simplicity, when trying to work with pixels outside of a possible interval, nothing will just happen. <br><br>  In the examples, the canvas will be drawn on the screen, so it is necessary to perform transformations from one coordinate system to another.  If we assume that the screen is the same size as the canvas, then the transformation equations will be simple: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-94"><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-99"><span class="MJXp-msubsup" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-102" style="vertical-align: -0.4em;">w</span></span><span class="MJXp-mtext" id="MJXp-Span-103">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">r</span><span class="MJXp-mn" id="MJXp-Span-108">2</span></span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-112" style="vertical-align: -0.4em;">x</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.572ex" height="2.419ex" viewBox="0 -780.1 8857.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="867" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1396" y="0"></use><g transform="translate(2452,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-77" x="1011" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6F" x="1572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="2057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="2543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="3009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="3461" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="6636" y="0"></use><g transform="translate(7636,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="1011" y="-213"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> S_x = {C_w \ over 2} + C_x </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-113"><span class="MJXp-msubsup" id="MJXp-Span-114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-116" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-118"><span class="MJXp-msubsup" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-121" style="vertical-align: -0.4em;">h</span></span><span class="MJXp-mtext" id="MJXp-Span-122">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">r</span><span class="MJXp-mn" id="MJXp-Span-127">2</span></span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;">y</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.096ex" height="2.66ex" viewBox="0 -780.1 8652.2 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="867" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1343" y="0"></use><g transform="translate(2399,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="1011" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6F" x="1473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="1958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="2444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="2910" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="3362" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="6484" y="0"></use><g transform="translate(7484,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="1011" y="-213"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-14"> S_y = {C_h \ over 2} - C_y </script></p><br><br><h2>  Color models </h2><br>  The theory of the color work itself is amazing, but, unfortunately, is beyond the scope of our article.  Below is a simplified version of those aspects that are important to us. <br><br>  <em>Color</em> is the way in which the brain interprets photons that enter our eye.  These photons carry energy of different frequencies, our eyes associate these frequencies with colors.  The smallest energy perceived by us has a frequency of about 450 THz, we perceive it as red.  At the other end of the spectrum are 750 THz, which we see as "purple."  Between these two frequencies, we see a continuous spectrum of colors (for example, green is about 575 THz). <br><br>  In the normal state, we cannot see frequencies outside this range.  Higher frequencies carry more energy, so infrared radiation (frequencies below 450 THz) is harmless, but ultraviolet (frequencies above 750 THz) can burn the skin. <br><br>  Any color can be described as various combinations of these colors (in particular, ‚Äúwhite‚Äù is the sum of all colors, and ‚Äúblack‚Äù is the absence of all colors).  Describing the colors with the exact frequency is inconvenient.  Fortunately, you can create almost all colors as a linear combination of all three colors, which we call "primary colors." <br><br><h3>  Subtractive color model </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/5b7/323/490/5b73234904178e77044229ffd78829fb.png"><br><br>  Objects have a different color because they absorb and reflect light in different ways.  Let's start with white light, such as solar light (Note: sunlight is not completely white, but for our purposes it is close enough to it.).  White light contains frequencies of all colors.  When light falls on an object, depending on the material of the object, its surface absorbs some of the frequencies and reflects the rest.  Part of the reflected light enters our eye and the brain transforms it into color.  What color?  In the sum of all reflected frequencies (Note: due to the laws of thermodynamics, the rest of the energy is not lost, it basically turns into heat.). <br><br>  To summarize: we start with all the frequencies, and subtract some amount of primary colors to create a different color.  Since we subtract frequencies, such a model is called a <em>subtractive color model</em> . <br><br>  However, this model is not entirely correct.  In fact, the main colors in the subtractive model are not blue, red and yellow, as taught by children and students, but cyan (Cyan), magenta (Magenta) and yellow (Yellow).  Moreover, the mixture of the three primary colors gives some darkish color, which does not quite look like black, so black is added as the fourth ‚Äúprimary‚Äù color.  Black is denoted by the letter K - and so it turns out the CMYK color model used for printers. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c27/ed4/222/c27ed4222d9831b847aaa623ed088771.png"><br><br><h3>  Additive color model </h3><br>  But this is only half the story.  The screens of the monitors are opposite to the paper.  The paper does not emit light, but simply reflects part of the light falling on it.  On the other hand, the screens are black, but they emit light.  On paper, we started with white light and <em>subtracted</em> unnecessary frequencies;  on the screen, we start with a lack of light and <em>add the</em> necessary frequencies. <br><br>  It turns out that this requires other primary colors.  Most colors can be created by adding different sizes of red, green and blue to the black surface;  This is an RGB color model, an <em>additive color model</em> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e08/c11/fac/e08c11fac88d51c247edc6aea0bc9750.png"><br><br><h3>  Forget about the details </h3><br>  Now that you know all this, you can selectively forget unnecessary details and focus on what is important for work. <br><br>  Most colors can be represented in RGB or CMYK (or in many other color models) and can be converted from one color space to another.  Since our main task is to render images to the screen, we will use the RGB color model. <br><br>  As stated above, objects absorb a portion of the light falling on them, and reflect the rest.  We perceive the absorbed and reflected frequencies as the ‚Äúcolor‚Äù of the surface.  From now on, we will perceive color simply as a property of the surface and forget about the frequencies of the absorbed light. <br><br><h2>  Depth and color representation </h2><br>  As explained in the previous section, monitors can create colors from various combinations of red, green, and blue. <br><br>  How different can their brightness be?  Although voltage is a continuous variable, we will process colors using a computer using discrete values.  The more different shades of red, green and blue we can set, the more colors we can create. <br><br>  The most popular format today uses 8 bits per primary color (also called a <em>color channel</em> ).  8 bits per channel gives us 24 bits per pixel, that is, the total <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-msubsup" id="MJXp-Span-133"><span class="MJXp-mn" id="MJXp-Span-134" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-135" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-136">24</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-34" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-15"> 2 ^ {24} </script>  various colors (approximately 16.7 million).  This format, known as 888, will be used in our work.  We can say that this format has <em>a color depth of</em> 24 bits. <br><br>  However, it is by no means the only possible format.  Not so long ago, 15-bit and 16-bit formats were used to save memory, assigning 5 bits per channel or 5 bits for red, 6 for green, and 5 for blue (this format was known as 565).  Why did green get an extra bit?  Because our eyes are more sensitive to changes in green than red or blue. <br><br>  16 bits give us <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-137"><span class="MJXp-msubsup" id="MJXp-Span-138"><span class="MJXp-mn" id="MJXp-Span-139" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-140" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-141">16</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-36" x="500" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-16"> 2 ^ {16} </script>  flowers (about 65 thousand).  This means that we get one color for every 256 colors of the 24-bit mode.  Although 65,000 is a lot, on images with gradually changing colors, you can notice very small ‚Äústeps‚Äù that are invisible in 16.7 million colors, because there are enough bits to represent intermediate colors.  16.7 million colors are more and more than the human eye can recognize, so in the foreseeable future we will most likely continue to use 24-bit colors.  (Note: this only applies to <i>displaying</i> images, <i>storing</i> images with a wider range is a completely different matter, which we will look at in the Lighting chapter.) <br><br>  To represent the color, we will use three bytes, each of which will contain the value of an 8-bit color channel.  In the text, we denote colors as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-142"><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">R</span><span class="MJXp-mo" id="MJXp-Span-145" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">G</span><span class="MJXp-mo" id="MJXp-Span-147" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">B</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.232ex" height="2.66ex" viewBox="0 -832 3974.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-52" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-47" x="1594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-42" x="2825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="3585" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> (R, G, B) </script>  - eg, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-152">255</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-154">0</span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-156">0</span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.689ex" height="2.66ex" viewBox="0 -832 4171.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="2336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="3281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="3782" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> (255, 0, 0) </script>  - it is pure red color; <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-160">255</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-162">255</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-164">255</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.339ex" height="2.66ex" viewBox="0 -832 6173.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1891" y="0"></use><g transform="translate(2336,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3837" y="0"></use><g transform="translate(4282,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="5784" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> (255, 255, 255) </script>  - white, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-166"><span class="MJXp-mo" id="MJXp-Span-167" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-168">255</span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-170">0</span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-172">128</span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.014ex" height="2.66ex" viewBox="0 -832 5172.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="2336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2836" y="0"></use><g transform="translate(3281,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-38" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4783" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20"> (255, 0, 128) </script>  - reddish purple. <br><br><h2>  Color management </h2><br>  For color management, we use several operations (Note: if you know linear algebra, then perceive colors as vectors in three-dimensional color space. In the article I will introduce you to the operations that we will use for readers unfamiliar with linear algebra.). <br><br>  We can increase the color brightness by increasing each color channel by a constant: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">k</span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">R</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">G</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">B</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">R</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">G</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">B</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.407ex" height="2.66ex" viewBox="0 -832 11369.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-52" x="911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-47" x="2115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-42" x="3347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4106" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="4774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="5830" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6B" x="6219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-52" x="6741" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="7500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6B" x="7946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-47" x="8467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="9254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6B" x="9699" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-42" x="10220" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="10980" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-21"> k (R, G, B) = (kR, kG, kB) </script></p><br>  We can add two colors together by adding color channels separately: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-194"><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-198" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-202" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-206" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-212" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-216" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-220" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-226" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229" style="margin-right: 0.05em;">R</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-230" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-234" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237" style="margin-right: 0.05em;">G</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-238" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-242" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-246" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="60.161ex" height="2.66ex" viewBox="0 -832 25902.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31" x="1074" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1602" y="0"></use><g transform="translate(2048,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31" x="1112" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3288" y="0"></use><g transform="translate(3733,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31" x="1074" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4947" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="5558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="6559" y="0"></use><g transform="translate(6948,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="1074" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="8162" y="0"></use><g transform="translate(8607,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="1112" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="9847" y="0"></use><g transform="translate(10293,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="1074" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="11506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="12173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="13230" y="0"></use><g transform="translate(13619,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31" x="1074" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="15055" y="0"></use><g transform="translate(16055,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="1074" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="17269" y="0"></use><g transform="translate(17714,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31" x="1112" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="19177" y="0"></use><g transform="translate(20177,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="1112" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="21418" y="0"></use><g transform="translate(21863,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31" x="1074" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="23299" y="0"></use><g transform="translate(24299,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-42" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="1074" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="25513" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> (R_1, G_1, B_1) + (R_2, G_2, B_2) = (R_1 + R_2, G_1 + G_2, B_1 + B_2) </script></p><br>  For example, if we have a reddish purple <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-248"><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-250">252</span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-252">0</span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-254">66</span><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.852ex" height="2.66ex" viewBox="0 -832 4672.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="2336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2836" y="0"></use><g transform="translate(3281,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4282" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-23"> (252, 0, 66) </script></p>  and we want to get exactly the same shade, but three times less bright, then we multiply each channel by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mn" id="MJXp-Span-257">1</span><span class="MJXp-mtext" id="MJXp-Span-258">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">r</span><span class="MJXp-mn" id="MJXp-Span-263">3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.293ex" height="1.937ex" viewBox="0 -728.2 3140 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6F" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="1236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="1721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="2188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-33" x="2639" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24"> 1 \ over 3 </script>  and get <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-264"><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-266">84</span><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-268">0</span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-270">22</span><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.689ex" height="2.66ex" viewBox="0 -832 4171.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-38"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-34" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="1835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2336" y="0"></use><g transform="translate(2781,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="3782" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-25"> (84, 0, 22) </script>  .  If we want to combine red <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-274">255</span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-276">0</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-278">0</span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.689ex" height="2.66ex" viewBox="0 -832 4171.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="2336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="3281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="3782" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-26"> (255, 0, 0) </script>  and green <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-280"><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-282">0</span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-284">255</span><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-286">0</span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.689ex" height="2.66ex" viewBox="0 -832 4171.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="890" y="0"></use><g transform="translate(1335,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="3281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="3782" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-27"> (0, 255, 0) </script>  then we fold the channels and get <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-288"><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-290">255</span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-292">255</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-294">0</span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.014ex" height="2.66ex" viewBox="0 -832 5172.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1891" y="0"></use><g transform="translate(2336,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-35" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3837" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="4282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4783" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-28"> (255, 255, 0) </script>  that is, yellow. <br><br>  An attentive reader may say that with such operations we may get incorrect values: for example, doubling the brightness <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-296"><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-298">192</span><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-300">64</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-302">32</span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.014ex" height="2.66ex" viewBox="0 -832 5172.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-39" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1891" y="0"></use><g transform="translate(2336,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-34" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3337" y="0"></use><g transform="translate(3782,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4783" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-29"> (192, 64, 32) </script>  , we get the value of R outside the color range.  We will assume that any value greater than 255 is equal to 255, and any value less than 0 is equal to 0. This is more or less the same as when you take a picture with a too slow or slow shutter speed - completely black or completely white areas appear on it. <br><br><h2>  Scene </h2><br>  Canvas (canvas) is an abstraction on which we render everything.  What do we render?  Another abstraction is a <em>scene</em> . <br><br>  A scene is a collection of objects that you need to render.  It can be anything from a single sphere hanging in empty space (we start with this one) to an incredibly detailed model of the insides of the nose of the ogre. <br><br>  In order to talk about objects in the scene, we need a coordinate system.  You can choose any, but we will find something useful for our purposes.  Y axis will be pointing up.  X and Z axes are horizontal.  That is, the XZ plane will be ‚Äúfloor‚Äù, and XY and YZ will be vertical ‚Äúwalls‚Äù. <br><br>  Since we are talking here about ‚Äúphysical‚Äù objects, we need to select the units of their measurement.  They can also be any, but they strongly depend on what is represented in the scene.  ‚Äú1‚Äù can be one millimeter when modeling a circle, or one astronomical unit when modeling a solar system.  Fortunately, nothing described below depends on the units of measurement, so we will simply ignore them.  As long as we maintain uniformity (that is, ‚Äú1‚Äù always means the same thing for the whole scene), everything will work fine. <br><br><h1>  Part I: ray tracing </h1><br>  Imagine that you are in some exotic place and enjoy a stunning view, so stunning that you just <em>have to</em> capture it in the picture. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b4/935/7ff/2b49357ff87c5d0790517e9fbb0d683a.jpg" alt="A swiss landscape"><br>  <i>Swiss landscape</i> <br><br>  You have paper and markers, but absolutely no artistic talent.  Is all lost? <br><br>  Not necessary.  Maybe you have no talent, but there is a method. <br><br>  You can do the most obvious thing: take an insect screen and place it in a rectangular frame, attaching the frame to a stick.  Then look at the landscape through this grid, select the best angle and place another stick exactly where the head should be in order to get the exact same point of view: <br><br>  You have not started drawing yet, but at least you have a fixed point of view and a fixed frame through which you see the landscape.  Moreover, this fixed frame is divided into small squares.  And now we proceed to the methodical part.  Draw a grid on paper with the same number of squares as in the insect screen.  Now look at the upper left square of the grid.  What color is dominant in it?  Sky blue.  Therefore, we draw in the upper left square of the paper sky-blue color.  Repeat the same for each square and pretty soon we will get a pretty good picture of the landscape, as if visible from the window: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f3/31d/8be/5f331d8be6f996924dec8c2abc23a950.png" alt="Crude approximation of the landscape"><br>  <i>Rough terrain approximation</i> <br><br>  If you think about it, the computer, in essence, is a very methodical machine that has absolutely no artistic talents.  If we replace the squares on paper with pixels on the screen, we can describe the process of rendering the scene as follows: <br><br><pre>  For each pixel of the canvas
     Color it with the desired color </pre><br>  Very simple! <br><br>  However, such code is too abstract to be implemented directly in the computer.  Therefore, we can go into the details a bit: <br><br><pre>  Place the eye and frame in the right places.
 For each pixel of the canvas
     Determine the grid square corresponding to this pixel.
     Determine the color visible through this square.
     Fill pixel with this color </pre><br>  This is still too abstract, but it is already beginning to sound like an algorithm.  Surprisingly, this is the high-level description of the entire ray tracing algorithm.  Yes, everything is so simple. <br><br>  Of course, the devil is in the details.  In the following chapters we will take a closer look at all these stages. <br><br><h1>  Ray Tracing Basics </h1><br>  One of the most interesting things in computer graphics (and perhaps the most interesting) is drawing graphics on the screen.  In order to proceed to it as soon as possible, we will first make some minor simplifications in order to display something on the screen <em>right now</em> .  Of course, such simplifications imply some limitations on our possible actions, but in subsequent chapters we will step by step get rid of these limitations. <br><br>  First, we will assume that the viewpoint is fixed.  The viewpoint is the place where the eye is located in our analogy, and it is usually called <em>the camera position</em> ;  let's call him <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">O</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309" style="margin-right: 0.05em;">O</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-310" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313" style="margin-right: 0.05em;">O</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-314" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317" style="margin-right: 0.05em;">O</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-318" style="vertical-align: -0.4em;">z</span></span><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.292ex" height="2.78ex" viewBox="0 -832 7445.3 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="2097" y="0"></use><g transform="translate(2487,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3755" y="0"></use><g transform="translate(4200,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="5415" y="0"></use><g transform="translate(5860,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-7A" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="7055" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-30"> O = (O_x, O_y, O_z) </script>  .  We will assume that the camera is located at the origin of the coordinate system, i.e. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">O</span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-324">0</span><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-326">0</span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-328">0</span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.236ex" height="2.66ex" viewBox="0 -832 5268.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="2097" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="2487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="3432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="4378" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4878" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-31"> O = (0, 0, 0) </script>  . <br><br>  Secondly, we will assume that the orientation of the camera is also fixed, that is, the camera is always directed to the same place.  We assume that it is looking down the positive Z axis, the positive Y axis is pointing up, and the positive X axis is right: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0bd/412/8b3/0bd4128b329b86aed3b9dab9b0bb7697.png"><br><br>  The position and orientation of the camera is now fixed.  But we still do not have a ‚Äúframework‚Äù from the analogy proposed by us, through which we look at the scene.  We assume that the frame has dimensions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-330"><span class="MJXp-msubsup" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-333" style="vertical-align: -0.4em;">w</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.764ex" height="2.419ex" viewBox="0 -780.1 1190.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-77" x="825" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-32"> V_w </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-334"><span class="MJXp-msubsup" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336" style="margin-right: 0.05em;">V</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-337" style="vertical-align: -0.4em;">h</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.534ex" height="2.419ex" viewBox="0 -780.1 1091.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="825" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-33"> V_h </script>  it is frontal with respect to the position of the camera (i.e., perpendicular <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-338"><span class="MJXp-mtext" id="MJXp-Span-339">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mrow" id="MJXp-Span-343"><span class="MJXp-msubsup" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-346" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.897ex" height="2.539ex" viewBox="0 -780.1 2969.5 1093.4" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-5A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="966" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-34"> \ vec {Z _ +} </script>  ) and is at a distance <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.216ex" height="2.057ex" viewBox="0 -780.1 523.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-64" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-35"> d </script>  its sides are parallel to the X and Y axes, and it is centered relative to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-mtext" id="MJXp-Span-350">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mrow" id="MJXp-Span-354"><span class="MJXp-msubsup" id="MJXp-Span-355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-357" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.897ex" height="2.539ex" viewBox="0 -780.1 2969.5 1093.4" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-5A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="966" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-36"> \ vec {Z _ +} </script>  .  The description looks complicated, but in fact everything is quite simple: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f6c/511/eab/f6c511eabd36d32c1bd0ae3ad9596234.png"><br><br>  This rectangle, which will be our window to the world, is called the <em>viewport</em> .  In essence, we will draw on the canvas all that we see through the viewing window.  It is important that the size of the viewport and the distance to the camera determine the angle of visibility from the camera, called <em>the field of view</em> or FOV for short.  In people, the horizontal FOV is almost <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-msubsup" id="MJXp-Span-359"><span class="MJXp-mn" id="MJXp-Span-360" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">180</font></font></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-361" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.165ex" height="1.937ex" viewBox="0 -728.2 3515.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-38" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-63" x="1851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-69" x="2285" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="2630" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-63" x="3082" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-37"> 180 ^ \ circ </script>  however, most of it is vague peripheral vision without a sense of depth.  In general, reliable images are obtained using FOV <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-366"><span class="MJXp-msubsup" id="MJXp-Span-367"><span class="MJXp-mn" id="MJXp-Span-368" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">60</font></font></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-369" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the vertical and horizontal direction; </font><font style="vertical-align: inherit;">this can be achieved by setting</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.003ex" height="1.937ex" viewBox="0 -728.2 3015 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-63" x="1351" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-69" x="1784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="2130" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-63" x="2581" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-38"> 60 ^ \ circ </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-374"><span class="MJXp-msubsup" id="MJXp-Span-375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-377" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-381" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-385"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.972ex" height="2.419ex" viewBox="0 -780.1 7307.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-77" x="825" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1467" y="0"></use><g transform="translate(2524,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="3893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-64" x="4949" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="5750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31" x="6806" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-39">V_w = V_h = d = 1</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Let's go back to the ‚Äúalgorithm‚Äù presented in the previous section, we denote its steps by numbers: </font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Place the eye and frame in the right places (1)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
For each pixel of the canvas</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Determine the grid square corresponding to this pixel (2)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Determine the color visible through this square (3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    Fill pixel with this color (4) </font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We have already completed step 1 (or, more precisely, got rid of it for a while). </font><font style="vertical-align: inherit;">Step 4 is trivial ( </font></font><code>canvas.PutPixel(x, y, color)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Let's take a quick look at step 2, and then focus on much more complicated ways to implement step 3.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> From canvas to viewport </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In step 2, we need to " </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Determine the grid square corresponding to this pixel</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ." </font><font style="vertical-align: inherit;">We know the coordinates of the pixel on the canvas (we draw them all) - let's call them</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-386"><span class="MJXp-msubsup" id="MJXp-Span-387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-389" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.834ex" height="2.419ex" viewBox="0 -780.1 1220.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="1011" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-40">C_x</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-390"><span class="MJXp-msubsup" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-393" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.711ex" height="2.66ex" viewBox="0 -780.1 1167.3 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="1011" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-41">C_y</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notice how conveniently we positioned the viewing window - its axes correspond to the orientation of the axes of the canvas, and its center corresponds to the center of the viewing window. </font><font style="vertical-align: inherit;">That is, you can move from the coordinates of the canvas to the coordinates of space by simply changing the scale!</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-394"><span class="MJXp-msubsup" id="MJXp-Span-395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-397" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-401" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-402"><span class="MJXp-mfrac" id="MJXp-Span-403" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-406" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-409" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.367ex" height="5.551ex" viewBox="0 -1454.5 5324.8 2390.2" role="img" focusable="false" style="vertical-align: -2.173ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="825" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1366" y="0"></use><g transform="translate(2422,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="1011" y="-213"></use></g><g transform="translate(3642,0)"><g transform="translate(120,0)"><rect stroke="none" width="1442" height="60" x="0" y="220"></rect><g transform="translate(126,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-77" x="825" y="-213"></use></g><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-77" x="1011" y="-213"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-42">V_x = C_x {V_w \over C_w}</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-410"><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-413" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-417" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-418"><span class="MJXp-mfrac" id="MJXp-Span-419" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-422" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-425" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.891ex" height="5.551ex" viewBox="0 -1454.5 5119.8 2390.2" role="img" focusable="false" style="vertical-align: -2.173ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="825" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1313" y="0"></use><g transform="translate(2369,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="1011" y="-213"></use></g><g transform="translate(3536,0)"><g transform="translate(120,0)"><rect stroke="none" width="1343" height="60" x="0" y="220"></rect><g transform="translate(126,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="825" y="-213"></use></g><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-68" x="1011" y="-213"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-43">V_y = C_y {V_h \over C_h}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is another subtlety. </font><font style="vertical-align: inherit;">Although the viewport is two-dimensional, it is built into three-dimensional space. </font><font style="vertical-align: inherit;">We indicated that it is at a distance d from the camera. </font><font style="vertical-align: inherit;">At each point in this plane (called </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the projection plane</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), by definition</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.402ex" height="2.057ex" viewBox="0 -780.1 2326.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-7A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-64" x="1802" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-44">z = d</script>  .  Consequently, <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-430"><span class="MJXp-msubsup" id="MJXp-Span-431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-433" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.671ex" height="2.419ex" viewBox="0 -780.1 2872.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-7A" x="825" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1292" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-64" x="2348" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-45">V_z = d</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And on this we have completed step 2. For each pixel </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-436"><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-440" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-444" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) of the</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> canvas we can define the corresponding point of the viewport</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.389ex" height="2.78ex" viewBox="0 -832 3611.8 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1609" y="0"></use><g transform="translate(2054,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="3222" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-46">(C_x, C_y)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-446"><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-450" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-451" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-454" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-458" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.166ex" height="2.78ex" viewBox="0 -832 4807.7 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1477" y="0"></use><g transform="translate(1922,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2958" y="0"></use><g transform="translate(3403,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-7A" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4418" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-47">(V_x, V_y, V_z)</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In step 3, we need to determine what color the light passes through. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-460"><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-464" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-468" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-472" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in terms of camera view</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.166ex" height="2.78ex" viewBox="0 -832 4807.7 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1477" y="0"></use><g transform="translate(1922,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2958" y="0"></use><g transform="translate(3403,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-7A" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4418" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-48">(V_x, V_y, V_z)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-478" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-482" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-486" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.421ex" height="2.78ex" viewBox="0 -832 5347.7 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1657" y="0"></use><g transform="translate(2102,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3318" y="0"></use><g transform="translate(3763,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-7A" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4958" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-49">(O_x, O_y, O_z)</script>  . <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Trace the rays </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> So through what color does light reach </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-488"><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-490"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-492" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-496" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-500" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> after passing through</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.421ex" height="2.78ex" viewBox="0 -832 5347.7 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1657" y="0"></use><g transform="translate(2102,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3318" y="0"></use><g transform="translate(3763,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-7A" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4958" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-50">(O_x, O_y, O_z)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-502"><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-506" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-510" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-514" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.166ex" height="2.78ex" viewBox="0 -832 4807.7 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1477" y="0"></use><g transform="translate(1922,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2958" y="0"></use><g transform="translate(3403,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-7A" x="825" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4418" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-51">(V_x, V_y, V_z)</script>  ? <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the real world, light emanates from a source of light (the sun, light bulbs, etc.), reflects from several objects, and finally reaches our eyes. We can try to simulate the path of each photon emitted from simulated light sources, but it will be </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">incredibly</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> time consuming (Note: the results will be amazing. This technique is called photon tracing or photon distribution; unfortunately, it is not related to the topic of our article.) . We would not only have to simulate millions and millions of photons, but after passing through the viewing window</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-516"><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-520" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-524" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-528" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> would reach only a small part of them. </font><font style="vertical-align: inherit;">Instead, we will trace the rays "in the reverse order" - we will start with the beam on the camera, passing through a point in the viewing window and moving until it collides with some object in the scene. </font><font style="vertical-align: inherit;">This object will be ‚Äúvisible‚Äù from the camera through this point of the viewport. </font><font style="vertical-align: inherit;">That is, as a first approximation, we simply take the color of this object as ‚Äúthe color of light that has passed through this point‚Äù. </font><font style="vertical-align: inherit;">Now we just need a few equations.</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.421ex" height="2.78ex" viewBox="0 -832 5347.7 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-78" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1657" y="0"></use><g transform="translate(2102,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-79" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3318" y="0"></use><g transform="translate(3763,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-7A" x="1079" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="4958" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-52">(O_x, O_y, O_z)</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b4/8d8/86f/6b48d886fcbb642c135ec9e1100fe77d.png"><br><br><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ray equation </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The best way to represent rays for our purpose would be to use a parametric equation. </font><font style="vertical-align: inherit;">We know that the beam passes through O, and we know its direction (from O to V), so we can express any point P of the beam as</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.507ex" height="2.66ex" viewBox="0 -832 7968.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="2085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="3071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="4072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="4433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="4823" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="5814" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="6815" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="7578" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-53">P = O + t(V - O)</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where t is an arbitrary real number. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's denote</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-541"><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mo" id="MJXp-Span-544" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-546" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, the direction of the beam, as</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.21ex" height="2.66ex" viewBox="0 -832 3534.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-56" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="1381" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="2381" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="3145" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-54">(V - O)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-547"><span class="MJXp-mrow" id="MJXp-Span-548"><span class="MJXp-munderover" id="MJXp-Span-549"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.924ex" height="2.66ex" viewBox="0 -1039.5 828.5 1145.2" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g></svg></span><script type="math/tex" id="MathJax-Element-55">\vec{D}</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> then the equation takes the simple form </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-554" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-558"><span class="MJXp-munderover" id="MJXp-Span-559"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.221ex" height="2.78ex" viewBox="0 -1039.5 5262 1197.1" role="img" focusable="false" style="vertical-align: -0.366ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="2085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="3071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="4072" y="0"></use><g transform="translate(4433,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-56">P = O + t\vec{D}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can read more about this in linear algebra; </font><font style="vertical-align: inherit;">it is intuitively clear that if we start from the starting point and move forward to some multiple of the direction of the beam, we will always move along the beam:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/05b/563/60c/05b56360cd958f1bd744f76515e3d6b7.png"><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sphere equation </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we need to add some objects to the scene so that the rays can </font><font style="vertical-align: inherit;">collide </font><font style="vertical-align: inherit;">with </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">something</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . We can choose any arbitrary geometric primitive as a building block of scenes; for ray tracing the simplest primitive for mathematical manipulations will be the sphere. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What is a sphere? A sphere is a set of points lying at a constant distance (called the </font><font style="vertical-align: inherit;">sphere‚Äôs </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">radius</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) from a fixed point (called the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">center of the</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sphere): </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/84a/540/e2e/84a540e2e86ea74e37f304c7d55d6926.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notice that judging by definition, the spheres are hollow. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If C is the center of the sphere, and r is the radius of the sphere, then the points P on the surface of the sphere satisfy the following equation:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.165ex" height="2.66ex" viewBox="0 -832 8251.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-69" x="523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-73" x="869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="1338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-61" x="1700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6E" x="2229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-63" x="2830" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-65" x="3263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="3730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="4119" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="4871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="5316" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="6076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="6743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="7800" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-57">distance(P, C) = r</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's experiment a bit with this equation. </font><font style="vertical-align: inherit;">The distance between P and C is the length of the vector from P to C:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-578"><span class="MJXp-mrow" id="MJXp-Span-579"><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow" id="MJXp-Span-584"><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.793ex" height="2.66ex" viewBox="0 -832 5077.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="2252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-7C" x="3013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="3569" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="4626" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-58">|P - C| = r</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The length of a vector is the square root of its scalar product itself: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-588"><span class="MJXp-msqrt" id="MJXp-Span-589"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àö</font></font></span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-592" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-596" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-598" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü©</font></font></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.018ex" height="4.708ex" viewBox="0 -1247 9480.1 2027.1" role="img" focusable="false" style="vertical-align: -1.812ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJSZ2-221A" x="0" y="-24"></use><rect stroke="none" width="6694" height="60" x="1000" y="1067"></rect><g transform="translate(1000,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="1363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="2363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="3569" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="4543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="5544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="6304" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="7972" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="9028" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-59">\sqrt{\langle P - C, P - C \rangle} = r</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And to get rid of the square root, </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-601"><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-614" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.749ex" height="3.021ex" viewBox="0 -987.6 8933.5 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="1363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="2363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="3569" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="4543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="5544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="6304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="6971" y="0"></use><g transform="translate(8028,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-60">\langle P - C, P - C \rangle = r^2</script></p><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ray meets the sphere </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now we have two equations, one of which describes the points of the sphere, and the other the points of the ray: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-615"><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-622" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-624" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-628" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.749ex" height="3.021ex" viewBox="0 -987.6 8933.5 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="1363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="2363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="3569" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="4543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="5544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="6304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="6971" y="0"></use><g transform="translate(8028,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-61">\langle P - C, P - C \rangle = r^2</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-631" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-635"><span class="MJXp-munderover" id="MJXp-Span-636"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.221ex" height="2.78ex" viewBox="0 -1039.5 5262 1197.1" role="img" focusable="false" style="vertical-align: -0.366ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="2085" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="3071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="4072" y="0"></use><g transform="translate(4433,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-62">P = O + t\vec{D}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The point P, in which the beam falls on a sphere, is both a point of the beam and a point on the surface of the sphere, so it must satisfy both equations at the same time. </font><font style="vertical-align: inherit;">Notice that the only variable in these equations is the parameter t, because O,</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-mrow" id="MJXp-Span-640"><span class="MJXp-munderover" id="MJXp-Span-641"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , C, and r are given, and P is the point we need to find. </font><font style="vertical-align: inherit;">Since P is the same point in both equations, we can replace P in the first by the expression for P in the second. </font><font style="vertical-align: inherit;">It gives us</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.924ex" height="2.66ex" viewBox="0 -1039.5 828.5 1145.2" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g></svg></span><script type="math/tex" id="MathJax-Element-63">\vec{D}</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-644"><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-649"><span class="MJXp-munderover" id="MJXp-Span-650"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-659"><span class="MJXp-munderover" id="MJXp-Span-660"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-669" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.013ex" height="3.142ex" viewBox="0 -1039.5 13783.4 1352.7" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="1375" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="2375" y="0"></use><g transform="translate(2737,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="3788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="4788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="5549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="5994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="6980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="7981" y="0"></use><g transform="translate(8342,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="9393" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="10393" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="11154" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="11821" y="0"></use><g transform="translate(12878,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-64">\langle O + t\vec{D} - C, O + t\vec{D} - C \rangle = r^2</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What values ‚Äã‚Äãof t satisfy this equation? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In its current form, the equation is rather cumbersome. </font><font style="vertical-align: inherit;">Let's transform it to see what can be obtained from it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First, we denote</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-670"><span class="MJXp-mrow" id="MJXp-Span-671"><span class="MJXp-munderover" id="MJXp-Span-672"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-675" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.018ex" height="3.624ex" viewBox="0 -1402.6 5605 1560.2" role="img" focusable="false" style="vertical-align: -0.366ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="2858" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="3843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="4844" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-65">\vec{OC} = O - C</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Then the equation can be written as </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-680"><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-682"><span class="MJXp-munderover" id="MJXp-Span-683"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-689"><span class="MJXp-munderover" id="MJXp-Span-690"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-694"><span class="MJXp-munderover" id="MJXp-Span-695"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-701"><span class="MJXp-munderover" id="MJXp-Span-702"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-709" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.332ex" height="3.985ex" viewBox="0 -1402.6 11337.5 1715.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="2135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="3136" y="0"></use><g transform="translate(3497,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="4326" y="0"></use><g transform="translate(4771,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="6517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="7518" y="0"></use><g transform="translate(7880,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="8708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="9375" y="0"></use><g transform="translate(10432,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-66">\langle \vec{OC} + t\vec{D}, \vec{OC} + t\vec{D} \rangle = r^2</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Then we decompose the scalar product into its components, taking advantage of its distributivity: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-710"><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-712"><span class="MJXp-munderover" id="MJXp-Span-713"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-719"><span class="MJXp-munderover" id="MJXp-Span-720"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-724"><span class="MJXp-munderover" id="MJXp-Span-725"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-732"><span class="MJXp-munderover" id="MJXp-Span-733"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-739"><span class="MJXp-munderover" id="MJXp-Span-740"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-745"><span class="MJXp-munderover" id="MJXp-Span-746"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-750" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-753" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.32ex" height="3.985ex" viewBox="0 -1402.6 16498.6 1715.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="2135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="3136" y="0"></use><g transform="translate(3497,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="4326" y="0"></use><g transform="translate(4771,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="6295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="6907" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="7908" y="0"></use><g transform="translate(8297,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="10043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="11044" y="0"></use><g transform="translate(11406,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="12234" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="12679" y="0"></use><g transform="translate(13041,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="13869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="14536" y="0"></use><g transform="translate(15593,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-67">\langle \vec{OC} + t\vec{D}, \vec{OC} \rangle + \langle \vec{OC} + t\vec{D}, t\vec{D} \rangle = r^2</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-754"><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-756"><span class="MJXp-munderover" id="MJXp-Span-757"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-762"><span class="MJXp-munderover" id="MJXp-Span-763"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-766" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-771"><span class="MJXp-munderover" id="MJXp-Span-772"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-776"><span class="MJXp-munderover" id="MJXp-Span-777"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-784"><span class="MJXp-munderover" id="MJXp-Span-785"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-788" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-791"><span class="MJXp-munderover" id="MJXp-Span-792"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-795" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-799"><span class="MJXp-munderover" id="MJXp-Span-800"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-802" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-805"><span class="MJXp-munderover" id="MJXp-Span-806"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-810" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-813" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.31ex" height="3.985ex" viewBox="0 -1402.6 21661 1715.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1913" y="0"></use><g transform="translate(2358,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="3882" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="4494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="5495" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="5884" y="0"></use><g transform="translate(6246,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="7074" y="0"></use><g transform="translate(7519,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="9043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="9655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="10656" y="0"></use><g transform="translate(11045,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="12569" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="13014" y="0"></use><g transform="translate(13376,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="14204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="14816" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="15817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="16206" y="0"></use><g transform="translate(16568,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="17396" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="17842" y="0"></use><g transform="translate(18203,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="19032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="19699" y="0"></use><g transform="translate(20755,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-68">\langle \vec{OC}, \vec{OC} \rangle + \langle t\vec{D}, \vec{OC} \rangle + \langle \vec{OC}, t\vec{D} \rangle + \langle t\vec{D}, t\vec{D} \rangle = r^2</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Transforming it a bit, we get </font></font><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-814"><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><span class="MJXp-mrow" id="MJXp-Span-817"><span class="MJXp-munderover" id="MJXp-Span-818"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-823"><span class="MJXp-munderover" id="MJXp-Span-824"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-826" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mn" id="MJXp-Span-829"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-831"><span class="MJXp-munderover" id="MJXp-Span-832"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-838"><span class="MJXp-munderover" id="MJXp-Span-839"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-843" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-845"><span class="MJXp-munderover" id="MJXp-Span-846"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-851"><span class="MJXp-munderover" id="MJXp-Span-852"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-857" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-860" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.485ex" height="3.985ex" viewBox="0 -1402.6 17000.4 1715.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="389" y="0"></use><g transform="translate(751,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="1579" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="2024" y="0"></use><g transform="translate(2386,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="3214" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="3826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="4827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="5327" y="0"></use><g transform="translate(5717,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="7241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="7686" y="0"></use><g transform="translate(8047,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="8876" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="9488" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="10488" y="0"></use><g transform="translate(10878,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="12402" y="0"></use><g transform="translate(12847,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="14371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="15038" y="0"></use><g transform="translate(16094,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-69">\langle t\vec{D}, t\vec{D} \rangle + 2\langle \vec{OC}, t\vec{D} \rangle + \langle \vec{OC}, \vec{OC} \rangle = r^2</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> By moving the parameter t from scalar products, and </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-861"><span class="MJXp-msubsup" id="MJXp-Span-862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-864" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to another part of the equation, we get</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.103ex" height="2.419ex" viewBox="0 -935.7 905.4 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="513"></use></g></svg></span><script type="math/tex" id="MathJax-Element-70">r^2</script><font style="vertical-align: inherit;"></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-865"><span class="MJXp-msubsup" id="MJXp-Span-866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-868" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-870"><span class="MJXp-munderover" id="MJXp-Span-871"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-875"><span class="MJXp-munderover" id="MJXp-Span-876"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-880" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-883"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mo" id="MJXp-Span-884" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-885"><span class="MJXp-munderover" id="MJXp-Span-886"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-891"><span class="MJXp-munderover" id="MJXp-Span-892"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-899"><span class="MJXp-munderover" id="MJXp-Span-900"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-905"><span class="MJXp-munderover" id="MJXp-Span-906"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-911" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-914" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mn" id="MJXp-Span-916"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.512ex" height="3.985ex" viewBox="0 -1402.6 19595.2 1715.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="511" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="815" y="0"></use><g transform="translate(1204,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="2033" y="0"></use><g transform="translate(2478,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="3307" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="3918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-74" x="4919" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-28" x="5281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="5670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="6171" y="0"></use><g transform="translate(6560,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="8084" y="0"></use><g transform="translate(8529,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="9358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-29" x="9747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2B" x="10359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="11360" y="0"></use><g transform="translate(11749,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="13273" y="0"></use><g transform="translate(13718,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="15242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="15854" y="0"></use><g transform="translate(16855,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="18038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-30" x="19094" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-71">t^2 \langle \vec{D}, \vec{D} \rangle + t(2\langle \vec{OC}, \vec{D} \rangle) + \langle \vec{OC}, \vec{OC} \rangle - r^2 = 0</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Has it become less bulky? </font><font style="vertical-align: inherit;">Note that the scalar product of two vectors is a real number, so each term in the parentheses is a real number. </font><font style="vertical-align: inherit;">If we denote them by name, then we get something much more familiar:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-917"><span class="MJXp-msubsup" id="MJXp-Span-918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-920" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mo" id="MJXp-Span-922" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-923"><span class="MJXp-munderover" id="MJXp-Span-924"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-927" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-928"><span class="MJXp-munderover" id="MJXp-Span-929"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-932" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.056ex" height="3.142ex" viewBox="0 -1039.5 5190.6 1352.7" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-31" x="737" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="2309" y="0"></use><g transform="translate(2698,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="3527" y="0"></use><g transform="translate(3972,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="4801" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-72">k_1 = \langle \vec{D}, \vec{D} \rangle</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-933"><span class="MJXp-msubsup" id="MJXp-Span-934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-936" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mn" id="MJXp-Span-938"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-940"><span class="MJXp-munderover" id="MJXp-Span-941"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-946"><span class="MJXp-munderover" id="MJXp-Span-947"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.834ex" height="3.985ex" viewBox="0 -1402.6 6386.6 1715.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="737" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="2309" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="2809" y="0"></use><g transform="translate(3199,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="4723" y="0"></use><g transform="translate(5168,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-20D7" x="704" y="246"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="5997" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-73">k_2 = 2\langle \vec{OC}, \vec{D} \rangle</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-951"><span class="MJXp-msubsup" id="MJXp-Span-952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-954" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mo" id="MJXp-Span-956" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-957"><span class="MJXp-munderover" id="MJXp-Span-958"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-963"><span class="MJXp-munderover" id="MJXp-Span-964"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-972" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.23ex" height="3.985ex" viewBox="0 -1402.6 8710 1715.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-33" x="737" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-3D" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E8" x="2309" y="0"></use><g transform="translate(2698,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2C" x="4222" y="0"></use><g transform="translate(4668,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-43" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2192" x="291" y="795"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-27E9" x="6192" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-2212" x="6803" y="0"></use><g transform="translate(7804,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342510/&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgi_6YfPA3mSiL19-jsjx8eOqt3aw#MJMAIN-32" x="638" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-74">k_3 = \langle \vec{OC}, \vec{OC} \rangle - r^2</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-973"><span class="MJXp-msubsup" id="MJXp-Span-974"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-976" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-977"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-979" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-980" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-983" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t </font></font></span><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-988" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-989" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mn" id="MJXp-Span-990"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-75">k_1t^2 + k_2t + k_3 = 0</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is nothing more than the good old quadratic equation. </font><font style="vertical-align: inherit;">Its solution gives us the values ‚Äã‚Äãof the parameter t, at which the ray intersects with the sphere:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-991"><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-995" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-999" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> } </font></font></span><span class="MJXp-mo" id="MJXp-Span-1001" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1002"><span class="MJXp-mrow" id="MJXp-Span-1003"><span class="MJXp-mfrac" id="MJXp-Span-1004" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1005"><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1009" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬± </font></font></span><span class="MJXp-msqrt" id="MJXp-Span-1011"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale8" style="font-size: 201%; margin-top: 0.07em; margin-left: -0.109em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àö</font></font></span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.089em solid;"></span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1012"><span class="MJXp-mrow" id="MJXp-Span-1013" style="margin-right: 0.05em;"><span class="MJXp-msubsup" id="MJXp-Span-1014"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1016" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1017" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-1019"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1022" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-1023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1025" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1026"><span class="MJXp-mn" id="MJXp-Span-1027"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1030" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-76">\{ t_1, t_2 \} = {{-k_2 \pm \sqrt{ {k_2}^2 -4k_1k_3} \over {2k_1}}}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fortunately, this has a geometric meaning. </font><font style="vertical-align: inherit;">As you may remember, a quadratic equation may have no solutions, have one double solution or two different solutions, depending on the value of the discriminant</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1031"><span class="MJXp-msubsup" id="MJXp-Span-1032"><span class="MJXp-mrow" id="MJXp-Span-1033" style="margin-right: 0.05em;"><span class="MJXp-msubsup" id="MJXp-Span-1034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1036" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1037" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1038" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mn" id="MJXp-Span-1039"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1042" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-1043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1045" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77">{k_2}^2 -4k_1k_3</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This exactly corresponds to the cases when the ray does not intersect the sphere, the ray touches the sphere and the ray enters and leaves the sphere: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/323/668/7ea/3236687ea4f020b40347d77c332ba9ab.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we take the value t and insert it into the equation of the ray, we finally get the intersection point P corresponding to this value t.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rendering our first areas </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To summarize - for each pixel on the canvas, we can calculate the corresponding point in the viewport. </font><font style="vertical-align: inherit;">Knowing the position of the camera, we can express the equation of the beam that comes from the camera and passes through a given point of the viewing window. </font><font style="vertical-align: inherit;">Having a sphere, we can calculate the point at which the ray intersects this sphere. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That is, we only need to calculate the intersection of the beam and each sphere, save the points closest to the camera and paint over the pixel on the canvas with the corresponding color. </font><font style="vertical-align: inherit;">We are almost ready to render our first areas! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, special attention should be paid to the parameter t. </font><font style="vertical-align: inherit;">Returning to the beam equation:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mo" id="MJXp-Span-1054" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-78">P = O + t(V - O)</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since the initial point and the direction of the ray are constant, changing t in the set of real numbers, we get every point P on this ray. </font><font style="vertical-align: inherit;">Notice that when</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1060"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we get</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79">t = 0</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1061"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80">P = O</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-1067" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1068"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we get</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81">t = 1</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-1071" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82">P = V</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">With negative numbers we get points in the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opposite</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> direction, that is, </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">behind the camera</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">That is, we can divide the parameter area into three parts:</font></font><br><br><table><tbody><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-1075" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt; </font></font></span><span class="MJXp-mn" id="MJXp-Span-1076"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83">t < 0</script></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Behind the camera </font></font></td></tr><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mn" id="MJXp-Span-1078"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚â§ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚â§ </font></font></span><span class="MJXp-mn" id="MJXp-Span-1082"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84">0 \le t \le 1</script></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Between the camera and the projection plane </font></font></td></tr><tr><td><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; </font></font></span><span class="MJXp-mn" id="MJXp-Span-1086"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85">t > 1</script></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Scene </font></font></td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is a diagram of the parameter area: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/dfc/ea8/f81/dfcea8f8183be8dc7cc58c7ad98aee79.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notice that nothing in the intersection equation says that the sphere should be </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in front of the</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> camera; </font><font style="vertical-align: inherit;">the equation gives no solution at all for intersections </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">behind the</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> camera. </font><font style="vertical-align: inherit;">Obviously, we do not need this; </font><font style="vertical-align: inherit;">so we need to ignore all decisions when</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt; </font></font></span><span class="MJXp-mn" id="MJXp-Span-1090"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86">t < 0</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To avoid additional mathematical difficulties, we will limit the solutions. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt; </font></font></span><span class="MJXp-mn" id="MJXp-Span-1094"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, we will render everything that is</font><em><font style="vertical-align: inherit;">behind</font></em><font style="vertical-align: inherit;">the projection plane.</font><font style="vertical-align: inherit;">On the other hand, we do not need to set the upper limit of the value of t; we want to see objects in front of the camera, no matter how far they are. Since at later stages we</font><em><font style="vertical-align: inherit;">will</font></em><font style="vertical-align: inherit;">limit the length of the beam, we still need to add this formality and limit t to the upper value</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87">t > 1</script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1095"><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-1097"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Note: in languages ‚Äã‚Äãin which infinity cannot be directly specified, a very large number will suffice.)</font><font style="vertical-align: inherit;">Now we can formalize everything that was done in pseudo-code. </font><font style="vertical-align: inherit;">In general, I will assume that the code has access to any data it needs, so we will not explicitly pass parameters, except for the most necessary ones. </font><font style="vertical-align: inherit;">The main method now looks like this:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88">+\infty</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O = &lt;0, 0, 0&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
for x in [-Cw / 2, Cw / 2] {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for y in [-Ch / 2, Ch / 2] {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        D = CanvasToViewport (x, y)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        color = TraceRay (O, D, 1, inf)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        canvas.PutPixel (x, y, color)</font></font><font></font>
     }
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The function is </font></font><code>CanvasToViewport</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">very simple:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CanvasToViewport (x, y) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return (x * vw / cw, y * vh / ch, d)</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this code snippet </font></font><code>d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, this is the distance to the projection plane. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The method </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculates the intersection of the ray with each sphere, and returns the color of the sphere at the nearest intersection point, which is in the required interval t:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TraceRay (O, D, t_min, t_max) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_t = inf</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_sphere = NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for sphere in scene.Spheres {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        t1, t2 = IntersectRaySphere (O, D, sphere)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if t1 in [t_min, t_max] and t1 &lt;closest_t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_t = t1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_sphere = sphere</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if t2 in [t_min, t_max] and t2 &lt;closest_t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_t = t2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_sphere = sphere</font></font><font></font>
     }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if closest_sphere == NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        return BACKGROUND_COLOR</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return closest_sphere.color</font></font><font></font>
 } </pre><br> <code>O</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in this code snippet, this is the starting point of the beam; </font><font style="vertical-align: inherit;">Although we emit rays from a camera that is located at the origin point, at later stages it may be located elsewhere, so this value should be a parameter. </font><font style="vertical-align: inherit;">The same applies to </font></font><code>t_min</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>t_max</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note that when the beam does not intersect the sphere, it must still return </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">some</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> color ‚Äî in most of the examples I chose white for this. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And finally, </font></font><code>IntersectRaySphere</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">just solves the quadratic equation:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IntersectRaySphere (O, D, sphere) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    C = sphere.center</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    r = sphere.radius</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    oc = O - C</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    k1 = dot (D, D)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    k2 = 2 * dot (OC, D)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    k3 = dot (OC, OC) - r * r</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    discriminant = k2 * k2 - 4 * k1 * k3</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if discriminant &lt;0:</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        return inf, inf</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    t1 = (-k2 + sqrt (discriminant)) / (2 * k1)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    t2 = (-k2 - sqrt (discriminant)) / (2 * k1)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return t1, t2</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's set a very simple scene: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/541/8e0/349/5418e03494f86950a867a35c23e19492.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the pseudo language of the scene, it will be set like this:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> viewport_size = 1 x 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
projection_plane_d = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (0, -1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (255, 0, 0) # Red</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (2, 0, 4)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (0, 0, 255) #Blue</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (-2, 0, 4)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (0, 255, 0) # Green</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then if we run the algorithm for this scene, then we will finally be rewarded with the look of an incredible scene obtained by ray tracing: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/213/212/578/21321257836dca8aa343c6ff6e171629.png"><br><br> <a href="http://www.gabrielgambetta.com/computer-graphics-from-scratch/demos/raytracer-01.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code and working demo &gt;&gt;</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I know this is a bit disappointing. Where are the reflections, the shadows and the beautiful appearance? We all get it, because we have just started. But this is a good start - the spheres look like circles, and this is better than if they looked like cats. They do not look like spheres because we have missed an important component that allows a person to determine the shape of an object - how it interacts with the light.</font></font><br><br><h1>  Lighting </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first step to add ‚Äúrealism‚Äù to our scene rendering will be a lighting simulation. Lighting is an incredibly complex topic, so I‚Äôll present a very simplified model, sufficient for our purposes. Some parts of this model are not even close to the physical models, they are just quick and good looking. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will start with some simplifying assumptions that make life easier for us. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First, we will declare that all lighting is white. This will allow us to characterize any light source with a single real number i, called the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">brightness of the</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> light. The simulation of color lighting is not so complicated (only three brightness values ‚Äã‚Äãare needed, one per channel, and the calculation of all colors and lighting per channel), but to make our work easier, I will not do it.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Secondly, we will get rid of the atmosphere. </font><font style="vertical-align: inherit;">This means that the lighting does not become less bright, regardless of their range. </font><font style="vertical-align: inherit;">The attenuation of the brightness of light depending on the distance is also not too difficult to implement, but for clarity, we will skip it for now.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Light sources </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Light must </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">come from somewhere</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In this section, we will define three different types of light sources.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Point sources </font></font></h3><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A point source</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> emits light from a fixed point in space, called its </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">position</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Light is emitted evenly in all directions; </font><font style="vertical-align: inherit;">this is why it is also called </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">omnidirectional lighting</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Therefore, a point source is completely characterized by its position and brightness. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incandescent bulbs are a good example from the real world, the approximation of which is a point source of illumination. </font><font style="vertical-align: inherit;">Although the incandescent lamp does not emit light from one point and it is not completely omnidirectional, but the approximation is quite good. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's set the vector</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1098"><span class="MJXp-mrow" id="MJXp-Span-1099"><span class="MJXp-munderover" id="MJXp-Span-1100"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as the direction from point P in the scene to the light source Q. This vector, called the</font><em><font style="vertical-align: inherit;">light vector</font></em><font style="vertical-align: inherit;">, is simply equal to</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89">\vec{L}</script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q </font></font></span><span class="MJXp-mo" id="MJXp-Span-1105" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90">Q - P</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Note that since Q is fixed and P can be any point on the scene, in general </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1107"><span class="MJXp-mrow" id="MJXp-Span-1108"><span class="MJXp-munderover" id="MJXp-Span-1109"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be different for each point of the scene.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91">\vec{L}</script><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b4/f6c/bf0/2b4f6cbf0cbad3b15399d8e15edbbc60.png"><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Directed Sources </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If a point source is a good approximation of an incandescent lamp, then what can serve as an approximation of the sun? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is a tricky question, and the answer depends on what you want to render. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the scale of the Solar System, the Sun can be approximately considered as a point source. </font><font style="vertical-align: inherit;">In the end, it emits light from a point (albeit a fairly large one) and emits it in all directions, that is, it fits both requirements.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, if in your scene the action takes place on Earth, then this is not a very good approximation. The sun is so far away that each ray of light will actually have the same direction (Note: this approximation remains on a city scale, but not at longer distances - in fact. The ancient Greeks were able to calculate the radius of the Earth with surprising accuracy from different directions sunlight in various places.). Although it can be approximated using a point source far from the scene, this distance and the distance between objects in the scene are so different in magnitude that errors in the accuracy of numbers may appear. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For such cases, we will set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directional light sources.</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Like point sources, a directional source has brightness, but unlike them, it has no position. </font><font style="vertical-align: inherit;">Instead, he has a </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">direction</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">You can perceive it as an infinitely distant point source, shining in a certain direction. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the case of point sources, we need to compute a new light vector.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1112"><span class="MJXp-mrow" id="MJXp-Span-1113"><span class="MJXp-munderover" id="MJXp-Span-1114"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for each point P of the scene, but in this case</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-92">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1117"><span class="MJXp-mrow" id="MJXp-Span-1118"><span class="MJXp-munderover" id="MJXp-Span-1119"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L is</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> set. </font><font style="vertical-align: inherit;">In a scene with the sun and the earth</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-93">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1122"><span class="MJXp-mrow" id="MJXp-Span-1123"><span class="MJXp-munderover" id="MJXp-Span-1124"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-94">\vec{L}</script>  will be equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1127"><span class="MJXp-mo" id="MJXp-Span-1128" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-1129"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">center of the sun </font></font></span><span class="MJXp-mo" id="MJXp-Span-1130" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mo" id="MJXp-Span-1132" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mtext" id="MJXp-Span-1133"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">center of the earth </font></font></span><span class="MJXp-mo" id="MJXp-Span-1134" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-95">(\text{ }) - (\text{ })</script>  . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/219/96e/6c8/21996e6c8c158a978adb699fe85a4c22.png"><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ambient lighting </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is it possible to model any real-world illumination as a point or directional source? Almost always yes (Note: but this will not necessarily be simple; zonal illumination (imagine the source behind the diffuser) can be approximated by a multitude of point sources on its surface, but it is difficult, more expensive to calculate, and the results are not ideal.). Are these two types of sources sufficient for our purposes?</font></font> Unfortunately not. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imagine what is happening on the moon. The only significant source of lighting nearby is the sun. That is, the "front half" of the Moon relative to the Sun receives all the lighting, and the "back half" is in complete darkness. We see it from different angles on Earth, and this effect creates what we call the "phases" of the Moon. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, the situation on Earth is slightly different. Even the points that do not receive lighting directly from the light source are not completely in the dark (just look at the floor under the table). How do the rays of light reach these points if the ‚Äúview‚Äù of the sources of illumination is somehow blocked? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As I mentioned in the section </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Color Models</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">when light falls on an object, part of it is absorbed, but the rest is scattered in the scene. This means that the light can come not only from sources of illumination, but also from other objects that receive it from sources of illumination and scatter it back. But why stop there? The diffuse illumination in turn falls on some other object, a part of it is absorbed, and a part is again scattered in the scene. With each reflection, the light loses some of its brightness, but theoretically you can continue </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ad infinitum</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Note: in fact, no, because the light has a quantum nature, but close enough to this.). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This means that </font><em><font style="vertical-align: inherit;">every object</font></em><font style="vertical-align: inherit;"> should be considered a source of lighting.</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">As you can imagine, this greatly increases the complexity of our model, so we will not go this way (Note: but you can at least google Global Illumination and look at the beautiful images.). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But we still do not want every object to be either illuminated directly, or completely dark (unless we render the model of the solar system). </font><font style="vertical-align: inherit;">To overcome this barrier, we will define a third type of light source, called </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ambient light</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is characterized only by brightness. </font><font style="vertical-align: inherit;">It is believed that it is the unconditional contribution of lighting to each point of the scene. </font><font style="vertical-align: inherit;">This is a very powerful simplification of the extremely complex interaction between light sources and scene surfaces, but it works.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Illumination of one point </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, there will be one ambient light source in the scene (because ambient light has only a brightness value, and any number of them will trivially combine into a single ambient light source) and an arbitrary number of point and directional sources. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To calculate the illumination of a point, we just need to calculate the amount of light contributed by each source and add them up to get one number representing the total amount received by the illumination point. Then we can multiply the color of the surface at this point by this number to get a properly lit color. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, what happens when a ray of light with a direction</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1135"><span class="MJXp-mrow" id="MJXp-Span-1136"><span class="MJXp-munderover" id="MJXp-Span-1137"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from a directional or point source falls on a point P of some object in our scene? </font><font style="vertical-align: inherit;">Intuitively, we can break objects into two general classes, depending on how they behave with light: "matte" and "shiny." </font><font style="vertical-align: inherit;">Since most of the objects around us can be considered "dull", then we will begin with them.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-96">\vec{L}</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diffuse scattering </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When a beam of light falls on a matte object, because of the irregularity of its surface at the microscopic level, it reflects the beam into the scene evenly in all directions, that is, a ‚Äúdiffuse‚Äù (‚Äúdiffuse‚Äù) reflection is obtained. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To see this, carefully look at some matte object, for example, a wall: if you move along the wall, its color does not change. That is, the light you see, reflected from the object, is the same regardless of where you are looking at the object. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the other hand, the amount of reflected light depends on the angle between the light beam and the surface. Intuitively, this is understandable - the energy transferred by the beam, depending on the angle, should be distributed over a smaller or larger surface, that is, the energy per unit area reflected in the scene will be higher or lower, respectively:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea5/69a/423/ea569a423f8f1efbe8cc41ac21c4043a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To express it mathematically, let's characterize the orientation of the surface along its </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">normal vector</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The normal vector, or simply "normal" is a vector perpendicular to the surface at some point. </font><font style="vertical-align: inherit;">It is also a unit vector, that is, its length is 1. We will call this vector</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1140"><span class="MJXp-mrow" id="MJXp-Span-1141"><span class="MJXp-munderover" id="MJXp-Span-1142"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1144" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-97">\vec{N}</script>  . <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diffuse reflection simulation </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> So, a ray of light with direction </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1145"><span class="MJXp-mrow" id="MJXp-Span-1146"><span class="MJXp-munderover" id="MJXp-Span-1147"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and brightness</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-98">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> falls on the surface with normal</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-99-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-99">I</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1152"><span class="MJXp-mrow" id="MJXp-Span-1153"><span class="MJXp-munderover" id="MJXp-Span-1154"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-100-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-100">\vec{N}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What part </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I is</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reflected back to the scene as a function of</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-101-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-101">I</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-102-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-102">I</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-mrow" id="MJXp-Span-1162"><span class="MJXp-munderover" id="MJXp-Span-1163"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1165" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-103-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-103">\vec{N}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1166"><span class="MJXp-mrow" id="MJXp-Span-1167"><span class="MJXp-munderover" id="MJXp-Span-1168"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-104-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-104">\vec{L}</script>  ? <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For a geometric analogy, let us imagine the brightness of the light as the ‚Äúwidth‚Äù of the beam. </font><font style="vertical-align: inherit;">Its energy is distributed over the surface size</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-105-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-105"> A </script>  .  When <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1173"><span class="MJXp-mrow" id="MJXp-Span-1174"><span class="MJXp-munderover" id="MJXp-Span-1175"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1177" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-106-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-106">\vec{N}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1178"><span class="MJXp-mrow" id="MJXp-Span-1179"><span class="MJXp-munderover" id="MJXp-Span-1180"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> have one direction, that is, the beam is perpendicular to the surface,</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-107-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-107">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which means that the energy reflected per unit area is equal to the incident energy per unit area;</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-108-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-108">I = A</script><font style="vertical-align: inherit;"></font> &lt; <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1187"><span class="MJXp-mrow" id="MJXp-Span-1188"><span class="MJXp-mfrac" id="MJXp-Span-1189" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1192" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mn" id="MJXp-Span-1193"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-109">{I \over A} = 1</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> On the other hand, when the angle between </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1194"><span class="MJXp-mrow" id="MJXp-Span-1195"><span class="MJXp-munderover" id="MJXp-Span-1196"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1198" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110">\vec{L}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1199"><span class="MJXp-mrow" id="MJXp-Span-1200"><span class="MJXp-munderover" id="MJXp-Span-1201"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> approaches</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111">\vec{N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1204"><span class="MJXp-msubsup" id="MJXp-Span-1205"><span class="MJXp-mn" id="MJXp-Span-1206" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1207" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-112">90^\circ</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> approaches</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113"> A </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1210"><span class="MJXp-mi" id="MJXp-Span-1211"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, the energy per unit area approaches 0;</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114">\infty</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1215"><span class="MJXp-msubsup" id="MJXp-Span-1216"><span class="MJXp-mo" id="MJXp-Span-1217" style="margin-left: 0.333em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lim </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1218" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-1220"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mi" id="MJXp-Span-1221"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû </font></font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1222"><span class="MJXp-mfrac" id="MJXp-Span-1223" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mn" id="MJXp-Span-1227"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115">\lim_{A \to \infty} {I \over A} = 0</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But what happens in between? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The situation is shown in the diagram below. </font><font style="vertical-align: inherit;">We know</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1228"><span class="MJXp-mrow" id="MJXp-Span-1229"><span class="MJXp-munderover" id="MJXp-Span-1230"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116">\vec{N}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1233"><span class="MJXp-mrow" id="MJXp-Span-1234"><span class="MJXp-munderover" id="MJXp-Span-1235"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117">\vec{L}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118"> P </script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I added corners </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1240"><span class="MJXp-mtext" id="MJXp-Span-1241">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119"> \ alpha </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as well as points</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120">\beta</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121"> Q </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1251"><span class="MJXp-mrow" id="MJXp-Span-1252"><span class="MJXp-munderover" id="MJXp-Span-1253"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122">\vec{R}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to make related entries easier. </font><font style="vertical-align: inherit;">Since technically the beam of light does not have a width, so we will assume that everything happens on an infinitely small flat portion of the surface. </font><font style="vertical-align: inherit;">Even if it is the surface of a sphere, the area under consideration is so infinitely small that it is almost flat relative to the size of the sphere, just as the Earth looks flat at small scales. </font><font style="vertical-align: inherit;">Beam of light with a width</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-123-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-123"> S </script><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a83/2a3/9e6/a832a39e600eb8bd64d2ea83f9c25f9e.png"><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> falls to the surface at point</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-124-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-124">I</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at an angle</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-125-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-125"> P </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-126-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-126">\beta</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Normal at </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-127-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-127"> P </script>  equals <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1266"><span class="MJXp-mrow" id="MJXp-Span-1267"><span class="MJXp-munderover" id="MJXp-Span-1268"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the energy transferred by the beam is distributed over</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-128-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-128">\vec{N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-129-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-129"> A </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We need to calculate </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1273"><span class="MJXp-mrow" id="MJXp-Span-1274"><span class="MJXp-mfrac" id="MJXp-Span-1275" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-130-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-130">{I \over A}</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We assume </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "width" of the beam. </font><font style="vertical-align: inherit;">By definition, it is perpendicular</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131">SR</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1281"><span class="MJXp-mrow" id="MJXp-Span-1282"><span class="MJXp-munderover" id="MJXp-Span-1283"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1285" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is also the direction</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-133-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-133">PQ</script>  .  therefore <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-134-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-134">PQ</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> form a right angle, turning</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-135-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-135">QR</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in a right triangle. </font><font style="vertical-align: inherit;">One of the corners</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-136-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-136">PQR</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-137-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-137">PQR</script>  equals <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1303"><span class="MJXp-msubsup" id="MJXp-Span-1304"><span class="MJXp-mn" id="MJXp-Span-1305" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1306" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the other -</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-138-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-138">90^\circ</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-139-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-139">\beta</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Then the third angle is </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1309"><span class="MJXp-msubsup" id="MJXp-Span-1310"><span class="MJXp-mn" id="MJXp-Span-1311" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1312" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1313" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-140-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-140">90^\circ - \beta</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> But it should be noted that </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1315"><span class="MJXp-mrow" id="MJXp-Span-1316"><span class="MJXp-munderover" id="MJXp-Span-1317"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-141-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-141">\vec{N}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> also form a right angle, i.e.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-142-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-142">PR</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> must also be</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-143-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-143">\alpha + \beta</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1327"><span class="MJXp-msubsup" id="MJXp-Span-1328"><span class="MJXp-mn" id="MJXp-Span-1329" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1330" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-144-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-144">90^\circ</script>  .  Consequently, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1331"><span class="MJXp-mrow" id="MJXp-Span-1332"><span class="MJXp-munderover" id="MJXp-Span-1333"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">^ </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ±</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-145-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-145">\widehat{QRP} = \alpha</script>  : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/462/cba/ddf/462cbaddf40db7907cf9dac972b9b253.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Let's look at the triangle </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-146-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-146">PQR</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Its angles are equal </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-mtext" id="MJXp-Span-1345">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-147-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-147"> \ alpha </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ≤</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-148-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-148">\beta</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1353"><span class="MJXp-msubsup" id="MJXp-Span-1354"><span class="MJXp-mn" id="MJXp-Span-1355" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1356" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-149-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-149">90^\circ</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Side </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-150-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-150">QR</script>  equals <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1360"><span class="MJXp-mfrac" id="MJXp-Span-1361" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1363"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the side</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-151-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-151">I \over 2</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-152-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-152">PR</script>  equals <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1367"><span class="MJXp-mfrac" id="MJXp-Span-1368" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1370"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-153-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-153">A \over 2</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And now ... trigonometry to the rescue! </font><font style="vertical-align: inherit;">By definition</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1377" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-1378" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1379"><span class="MJXp-mfrac" id="MJXp-Span-1380" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-154-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-154">cos(\alpha) = {QR \over PR}</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> replace </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-155-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-155">QR</script>  on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1390"><span class="MJXp-mfrac" id="MJXp-Span-1391" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1393"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-156-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-156">I \over 2</script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-157-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-157">PR</script>  on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1397"><span class="MJXp-mfrac" id="MJXp-Span-1398" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1400"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and we get</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-158-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-158">A \over 2</script><font style="vertical-align: inherit;"></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1407" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-1408" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1409"><span class="MJXp-mfrac" id="MJXp-Span-1410" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1411"><span class="MJXp-mfrac" id="MJXp-Span-1412" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1414"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1415"><span class="MJXp-mfrac" id="MJXp-Span-1416" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1418"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-159-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-159">cos(\alpha) = { {I \over 2} \over {A \over 2} }</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> which translates into </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-1426" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1427"><span class="MJXp-mfrac" id="MJXp-Span-1428" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-160-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-160">cos(\alpha) = {I \over A}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We are almost done. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1431"><span class="MJXp-mtext" id="MJXp-Span-1432">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the angle between</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-161-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-161"> \ alpha </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1438"><span class="MJXp-mrow" id="MJXp-Span-1439"><span class="MJXp-munderover" id="MJXp-Span-1440"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-162-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-162">\vec{N}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1443"><span class="MJXp-mrow" id="MJXp-Span-1444"><span class="MJXp-munderover" id="MJXp-Span-1445"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1447" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-163-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-163">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be expressed as</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-164-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-164">cos(\alpha)</script><font style="vertical-align: inherit;"></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1463"><span class="MJXp-mfrac" id="MJXp-Span-1464" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1465"><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1467"><span class="MJXp-munderover" id="MJXp-Span-1468"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1472"><span class="MJXp-munderover" id="MJXp-Span-1473"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1477"><span class="MJXp-mrow" id="MJXp-Span-1478"><span class="MJXp-mo" id="MJXp-Span-1479" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1480"><span class="MJXp-munderover" id="MJXp-Span-1481"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1483" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1484"><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1486"><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1488"><span class="MJXp-munderover" id="MJXp-Span-1489"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1492"><span class="MJXp-mo" id="MJXp-Span-1493" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> |</font></font></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-165-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-165">cos(\alpha) = {{\langle \vec{N}, \vec{L} \rangle} \over {|\vec{N}||\vec{L}|}}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And finally </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1494"><span class="MJXp-mrow" id="MJXp-Span-1495"><span class="MJXp-mfrac" id="MJXp-Span-1496" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1499" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1500"><span class="MJXp-mfrac" id="MJXp-Span-1501" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1502"><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü®</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1504"><span class="MJXp-munderover" id="MJXp-Span-1505"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1509"><span class="MJXp-munderover" id="MJXp-Span-1510"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1512" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1514"><span class="MJXp-mrow" id="MJXp-Span-1515"><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1517"><span class="MJXp-munderover" id="MJXp-Span-1518"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1521"><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1523"><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1525"><span class="MJXp-munderover" id="MJXp-Span-1526"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1528" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1529"><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> |</font></font></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-166-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-166">{I \over A} = {{\langle \vec{N}, \vec{L} \rangle} \over {|\vec{N}||\vec{L}|}}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, we have obtained a very simple equation relating the reflected part of the world to the angle between the normal to the surface and the direction of the light. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note that with more angles</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1531"><span class="MJXp-msubsup" id="MJXp-Span-1532"><span class="MJXp-mn" id="MJXp-Span-1533" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1534" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-167-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-167">90^\circ</script>  value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> becomes negative. </font><font style="vertical-align: inherit;">If we do not hesitate to use this value, then as a result we get light sources that</font><em><font style="vertical-align: inherit;">subtract</font></em><font style="vertical-align: inherit;">light. </font><font style="vertical-align: inherit;">It has no physical meaning; </font><font style="vertical-align: inherit;">angle more</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-168-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-168">cos(\alpha)</script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1542"><span class="MJXp-msubsup" id="MJXp-Span-1543"><span class="MJXp-mn" id="MJXp-Span-1544" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1545" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simply means that the light actually reaches the</font><em><font style="vertical-align: inherit;">back of the</font></em><font style="vertical-align: inherit;">surface, and does not contribute to the illumination of the illuminated point. </font><font style="vertical-align: inherit;">That is, if</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-169-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-169">90^\circ</script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> becomes negative, then we consider it equal</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-170-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-170">cos(\alpha)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1553"><span class="MJXp-mn" id="MJXp-Span-1554"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-171-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-171"> 0 </script>  . <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diffuse reflection equation </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now we can formulate an equation to calculate the total amount of light produced by a point </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with normal</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-172-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-172"> P </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1557"><span class="MJXp-mrow" id="MJXp-Span-1558"><span class="MJXp-munderover" id="MJXp-Span-1559"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1561" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in a scene with ambient lighting brightness</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-173-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-173">\vec{N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1562"><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1565" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-174-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-174"> I_A </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> point or directional light sources with brightness</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-175-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-175"> n </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1568"><span class="MJXp-msubsup" id="MJXp-Span-1569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1571" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and light vectors</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-176-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-176">I_n</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1572"><span class="MJXp-mrow" id="MJXp-Span-1573"><span class="MJXp-munderover" id="MJXp-Span-1574"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1577" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or known (for directional sources), or calculated for P (for point sources):</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-177-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-177">\vec{L_n}</script><font style="vertical-align: inherit;"></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1579"><span class="MJXp-msubsup" id="MJXp-Span-1580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1582" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1583" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1586" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1587" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-munderover" id="MJXp-Span-1588"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1594" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ£</font></font></span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1590" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> i </font></font></span><span class="MJXp-mo" id="MJXp-Span-1592"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1593"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1598" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1599"><span class="MJXp-mfrac" id="MJXp-Span-1600" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1601"><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1603"><span class="MJXp-munderover" id="MJXp-Span-1604"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1608"><span class="MJXp-munderover" id="MJXp-Span-1609"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1612" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1615"><span class="MJXp-mrow" id="MJXp-Span-1616"><span class="MJXp-mo" id="MJXp-Span-1617" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1618"><span class="MJXp-munderover" id="MJXp-Span-1619"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1621" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1622"><span class="MJXp-mo" id="MJXp-Span-1623" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1624"><span class="MJXp-mo" id="MJXp-Span-1625" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1626"><span class="MJXp-munderover" id="MJXp-Span-1627"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-1631" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1630" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1632"><span class="MJXp-mo" id="MJXp-Span-1633" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> |</font></font></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-178-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-178">I_P = I_A + \sum_{i = 1}^{n} I_i {{\langle \vec{N}, \vec{L_i} \rangle} \over {|\vec{N}||\vec{L_i}|}}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It is worth repeating again that the members in which </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1634"><span class="MJXp-mo" id="MJXp-Span-1635" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1636"><span class="MJXp-munderover" id="MJXp-Span-1637"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1641"><span class="MJXp-munderover" id="MJXp-Span-1642"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-1646" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1645" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü© </font></font></span><span class="MJXp-mo" id="MJXp-Span-1648" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt; </font></font></span><span class="MJXp-mn" id="MJXp-Span-1649"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> should not be added to the light point.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-179-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-179">\langle \vec{N}, \vec{L_i} \rangle < 0</script><font style="vertical-align: inherit;"></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sphere normals </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The only trifle is missing here: where do the normals come from? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This question is much more cunning than it seems, as we will see in the second part of the article. </font><font style="vertical-align: inherit;">Fortunately, for the case we are considering there is a very simple solution: the normal vector of any point of the sphere lies on a straight line passing through the center of the sphere. </font><font style="vertical-align: inherit;">That is, if the center of the sphere is</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then the direction of the normal point</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-180-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-180"> C </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-181-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-181"> P </script>  equally <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-182-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-182">P - C</script>  : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f2a/003/d91/f2a003d912358b11af91275dbb195d8a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why did I write ‚Äúnormal direction‚Äù instead of ‚Äúnormal‚Äù? </font><font style="vertical-align: inherit;">In addition to perpendicularity to the surface, the normal should be a unit vector; </font><font style="vertical-align: inherit;">it would be fair if the radius of the sphere were equal</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1658"><span class="MJXp-mn" id="MJXp-Span-1659"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is not always true. </font><font style="vertical-align: inherit;">To calculate the normal itself, we need to divide the vector by its length, thus obtaining the length</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-183-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-183"> 1 </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1660"><span class="MJXp-mn" id="MJXp-Span-1661"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-184-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-184"> 1 </script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1662"><span class="MJXp-mrow" id="MJXp-Span-1663"><span class="MJXp-munderover" id="MJXp-Span-1664"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1667" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1668"><span class="MJXp-mfrac" id="MJXp-Span-1669" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> P </font></font></span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1674"><span class="MJXp-mrow" id="MJXp-Span-1675"><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1680"><span class="MJXp-mo" id="MJXp-Span-1681" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">|</font></font></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-185-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-185">\vec{N} = {{P - C} \over {|P - C|}}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This is mainly of theoretical interest, because the lighting equation written above contains a division by </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1682"><span class="MJXp-mrow" id="MJXp-Span-1683"><span class="MJXp-mo" id="MJXp-Span-1684" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-1685"><span class="MJXp-munderover" id="MJXp-Span-1686"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1689"><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">but a good approach would be to create "true" normals; </font><font style="vertical-align: inherit;">This will simplify our work in the future.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-186-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-186">|\vec{N}|</script><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Diffuse reflection rendering </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's translate all this into pseudocode. </font><font style="vertical-align: inherit;">First, let's add a couple of sources of lighting to the scene:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> light {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    type = ambient</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    intensity = 0.2</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
light {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    type = point</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    intensity = 0.6</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    position = (2, 1, 0)</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
light {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    type = directional</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    intensity = 0.2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    direction = (1, 4, 4)</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Note that the brightness conveniently adds up to </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1691"><span class="MJXp-mn" id="MJXp-Span-1692"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , because it follows from the lighting equation that no point can have a luminance higher than one. </font><font style="vertical-align: inherit;">This means that we will not get areas with ‚Äútoo much exposure‚Äù. </font><font style="vertical-align: inherit;">The lighting equation is quite simple to convert to pseudocode:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-187-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-187">1.0</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ComputeLighting (P, N) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    i = 0.0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for light in scene.Lights {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if light.type == ambient {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            i + = light.intensity</font></font><font></font>
         } else {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if light.type == point</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                L = light.position - P</font></font><font></font>
             else<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                L = light.direction</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            n_dot_l = dot (N, L)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if n_dot_l&gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                i + = light.intensity * n_dot_l / (length (N) * length (L))</font></font><font></font>
         }
     }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return i</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And the only thing left is to use </font></font><code>ComputeLighting</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">We will replace the string that returns the color of the sphere.</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> return closest_sphere.color </font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to this fragment: </font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> P = O + closest_t * D # intersection calculation</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    N = P - closest_sphere.center # calculating the sphere normal at the intersection point</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    N = N / length (N)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return closest_sphere.color * ComputeLighting (P, N) </font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Just for fun, let's add a big yellow sphere: </font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (255, 255, 0) # Yellow</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (0, -5001, 0)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 5000</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are launching the renderer, and see - the spheres have finally begun to look like spheres! </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/91b/8cf/456/91b8cf4562e75cecf37aa4fa5a46925f.png"><br><br> <a href="http://www.gabrielgambetta.com/computer-graphics-from-scratch/demos/raytracer-02.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code and working demo &gt;&gt;</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> But wait, how did the big yellow sphere turn into a flat yellow floor? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It was not there, it‚Äôs just so big relative to the other three, and the camera is so close to it that it looks flat. </font><font style="vertical-align: inherit;">Just as our planet looks flat when we stand on its surface.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Reflection from a smooth surface </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we turn our attention to the "shiny" objects. </font><font style="vertical-align: inherit;">Unlike "matte" objects, "shiny" change their appearance when you look at them from different angles. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Take a billiard ball or a car that has just been washed. </font><font style="vertical-align: inherit;">In such objects, a special pattern of light propagation appears, usually with bright areas that seem to move when you walk around them. </font><font style="vertical-align: inherit;">Unlike matte objects, how you perceive the surface of these objects actually depends on the point of view. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notice that the red billiard balls remain red if you take a few steps back, but the bright white spot, giving them a ‚Äúshiny‚Äù look, seems to move. </font><font style="vertical-align: inherit;">This means that the new effect does not replace the diffuse reflection, but complements it.</font></font><br><br>  Why is this happening?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We can start with why this </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does not</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> happen on matte objects. </font><font style="vertical-align: inherit;">As we saw in the previous section, when a beam of light falls on the surface of a frosted object, it is scattered evenly back into the scene in all directions. </font><font style="vertical-align: inherit;">It is intuitively clear that this is due to the irregularity of the object's surface, that is, at the microscopic level, it resembles many small surfaces directed in random directions: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b8/f45/07a/0b8f4507ab1ba371fcbcb44c24c5b7cb.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But what if the surface is not so uneven? </font><font style="vertical-align: inherit;">Let's take the other extreme - a perfectly polished mirror. </font><font style="vertical-align: inherit;">When a beam of light falls on a mirror, it is reflected in a single direction that is symmetrical to the angle of incidence relative to the normal of the mirror. </font><font style="vertical-align: inherit;">If we call the direction of the reflected light</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1693"><span class="MJXp-mrow" id="MJXp-Span-1694"><span class="MJXp-munderover" id="MJXp-Span-1695"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and agree that</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-188-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-188">\vec{R}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1698"><span class="MJXp-mrow" id="MJXp-Span-1699"><span class="MJXp-munderover" id="MJXp-Span-1700"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1702" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indicates</font><em><font style="vertical-align: inherit;">a</font></em><font style="vertical-align: inherit;">light source, we get the following situation:</font><font style="vertical-align: inherit;">Depending on the degree of "polished" surface, it is more or less like a mirror; </font><font style="vertical-align: inherit;">that is, we get a ‚Äúmirror‚Äù reflection (specular reflection, from the Latin ‚Äúspeculum‚Äù, that is, a ‚Äúmirror‚Äù). </font><font style="vertical-align: inherit;">For a perfectly polished mirror incident beam</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-189-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-189">\vec{L}</script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/157/dd2/305/157dd2305b6a5d0bae323d7d50aa11a7.png"><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1703"><span class="MJXp-mrow" id="MJXp-Span-1704"><span class="MJXp-munderover" id="MJXp-Span-1705"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1707" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L is</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reflected in a single direction.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-190-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-190">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1708"><span class="MJXp-mrow" id="MJXp-Span-1709"><span class="MJXp-munderover" id="MJXp-Span-1710"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1712" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-191-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-191">\vec{R}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This is what allows us to clearly see objects in the mirror: for each incident beam </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1713"><span class="MJXp-mrow" id="MJXp-Span-1714"><span class="MJXp-munderover" id="MJXp-Span-1715"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1717" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the only reflected ray.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-192-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-192">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1718"><span class="MJXp-mrow" id="MJXp-Span-1719"><span class="MJXp-munderover" id="MJXp-Span-1720"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1722" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-193-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-193">\vec{R}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But not every object is perfectly polished; </font><font style="vertical-align: inherit;">although most of the light is reflected in the direction</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1723"><span class="MJXp-mrow" id="MJXp-Span-1724"><span class="MJXp-munderover" id="MJXp-Span-1725"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1727" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , part of it is reflected in directions close to</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-194-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-194">\vec{R}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1728"><span class="MJXp-mrow" id="MJXp-Span-1729"><span class="MJXp-munderover" id="MJXp-Span-1730"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1732" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-195-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-195">\vec{R}</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the closer to </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1733"><span class="MJXp-mrow" id="MJXp-Span-1734"><span class="MJXp-munderover" id="MJXp-Span-1735"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the more light is reflected in this direction. </font><font style="vertical-align: inherit;">The ‚Äúbrilliance‚Äù of an object determines how quickly the reflected light decreases when away from</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-196-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-196">\vec{R}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1738"><span class="MJXp-mrow" id="MJXp-Span-1739"><span class="MJXp-munderover" id="MJXp-Span-1740"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-197-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-197">\vec{R}</script>  : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a4d/11c/ae2/a4d11cae2307ef4630eb9e9e2767d758.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We are interested in how to find out how much light from </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1743"><span class="MJXp-mrow" id="MJXp-Span-1744"><span class="MJXp-munderover" id="MJXp-Span-1745"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L is</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reflected back in the direction of our point of view (because it is the light that we use to determine the color of each point).</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-198-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-198">\vec{L}</script><font style="vertical-align: inherit;"></font> If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1748"><span class="MJXp-mrow" id="MJXp-Span-1749"><span class="MJXp-munderover" id="MJXp-Span-1750"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the ‚Äúview vector‚Äù indicating from</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-199-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-199">\vec{V}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> into the camera, and</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-200-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-200"> P </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1755"><span class="MJXp-mtext" id="MJXp-Span-1756">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the angle between</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-201-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-201"> \ alpha </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1762"><span class="MJXp-mrow" id="MJXp-Span-1763"><span class="MJXp-munderover" id="MJXp-Span-1764"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-202-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-202">\vec{R}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1767"><span class="MJXp-mrow" id="MJXp-Span-1768"><span class="MJXp-munderover" id="MJXp-Span-1769"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , this is what we have:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-203-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-203">\vec{V}</script><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/630/834/4aa/6308344aa8f31021ff5cf97235bdf1a9.png"><br><br>  With <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1774" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1775"><span class="MJXp-mn" id="MJXp-Span-1776" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1777" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reflects the whole world.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-204-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-204">\alpha = 0^\circ</script><font style="vertical-align: inherit;"></font> With <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1781"><span class="MJXp-mn" id="MJXp-Span-1782" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1783" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> light is not reflected. </font><font style="vertical-align: inherit;">As in the case of diffuse reflection, we need a mathematical expression to determine what happens at intermediate values.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-205-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-205">\alpha = 90^\circ</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1784"><span class="MJXp-mtext" id="MJXp-Span-1785">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-206-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-206"> \ alpha </script>  . <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modeling "mirror" reflection </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remember how I mentioned earlier that not all models are based on physical models? </font><font style="vertical-align: inherit;">Well, here is one example of this. </font><font style="vertical-align: inherit;">The model presented below is arbitrary, but it is used, because it is easy to calculate and looks good. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's take</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1795" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1797" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-207-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-207">cos(\alpha)</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> He has good properties: </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1802" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-1803"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1804" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-1805" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1806"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-208-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-208">cos(0) = 1</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1811" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mo" id="MJXp-Span-1812" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬± </font></font></span><span class="MJXp-mn" id="MJXp-Span-1813"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1816"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the values ‚Äã‚Äãgradually decrease from</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-209-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-209">cos(\pm 90) = 0</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1817"><span class="MJXp-mn" id="MJXp-Span-1818"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-210-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-210"> 0 </script>  before <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1819"><span class="MJXp-mn" id="MJXp-Span-1820"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">90</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> along a very beautiful curve:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-211-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-211">90</script><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b00/8ce/339/b008ce3392d579ca680005d39d0d026d.png"><br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1827" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> meets all the requirements for the ‚Äúmirror‚Äù reflection function, so why not use it? </font><font style="vertical-align: inherit;">But we lack one more detail. </font><font style="vertical-align: inherit;">In this formulation, all objects shine the same. </font><font style="vertical-align: inherit;">How to change the equation to obtain different degrees of brilliance? </font><font style="vertical-align: inherit;">Remember that this gloss is a measure of how quickly the reflection function decreases with increasing</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-212-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-212">cos(\alpha)</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1828"><span class="MJXp-mtext" id="MJXp-Span-1829">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-213-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-213"> \ alpha </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A very simple way to get different light curves is to calculate the degree </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ±</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> some positive indicator</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-214-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-214">cos(\alpha</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-215-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-215"> s </script>  .  Insofar as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1843"><span class="MJXp-mn" id="MJXp-Span-1844"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1845" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚â§ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-1851" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-1852" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚â§ </font></font></span><span class="MJXp-mn" id="MJXp-Span-1853"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , it is obvious that</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-216-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-216">0 \le cos(\alpha) \le 1</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1854"><span class="MJXp-mn" id="MJXp-Span-1855"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚â§ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1860" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1862"><span class="MJXp-mo" id="MJXp-Span-1863" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1864" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1865" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚â§ </font></font></span><span class="MJXp-mn" id="MJXp-Span-1866"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-217-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-217">0 \le cos(\alpha)^s \le 1</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> i.e </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1871" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1873"><span class="MJXp-mo" id="MJXp-Span-1874" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1875" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> behaves exactly the same as</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-218-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-218">cos(\alpha)^s</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1880" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ±</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , only ‚Äúalready‚Äù.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-219-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-219">cos(\alpha</script><font style="vertical-align: inherit;"></font> Here is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1888"><span class="MJXp-mo" id="MJXp-Span-1889" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1890" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for different values</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-220-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-220">cos(\alpha)^s</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-221-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-221"> s </script>  : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ab/661/5f8/9ab6615f8739f2727d8eebe99d3f4cd4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The larger the value </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the ‚Äúalready‚Äù becomes the function in the vicinity</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-222-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-222"> s </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1895"><span class="MJXp-mn" id="MJXp-Span-1896"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the more brilliant the object looks.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-223-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-223"> 0 </script><font style="vertical-align: inherit;"></font><br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s is</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usually called</font><em><font style="vertical-align: inherit;">the reflection index</font></em><font style="vertical-align: inherit;">, and it is a surface property. </font><font style="vertical-align: inherit;">Since the model is not based on physical reality, the values</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-224-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-224"> s </script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can only be determined by trial and error, that is, by adjusting the values ‚Äã‚Äãuntil they start to look ‚Äúnatural‚Äù (Note: for using a model based on physics, see the two-beam reflectance function (DFOS)). </font><font style="vertical-align: inherit;">Let's unite everything together. </font><font style="vertical-align: inherit;">Ray</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-225-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-225"> s </script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1901"><span class="MJXp-mrow" id="MJXp-Span-1902"><span class="MJXp-munderover" id="MJXp-Span-1903"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> falls to the surface at</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-226-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-226">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , where the normal is</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-227-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-227"> P </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1908"><span class="MJXp-mrow" id="MJXp-Span-1909"><span class="MJXp-munderover" id="MJXp-Span-1910"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1912" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the reflection index -</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-228-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-228">\vec{N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-229-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-229"> s </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> How much light is reflected in the direction of the view </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1915"><span class="MJXp-mrow" id="MJXp-Span-1916"><span class="MJXp-munderover" id="MJXp-Span-1917"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1919" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-230-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-230">\vec{V}</script>  ? <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We have already decided that this value is </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-1924" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1926"><span class="MJXp-mo" id="MJXp-Span-1927" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1928" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-231-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-231">cos(\alpha)^s</script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1929"><span class="MJXp-mtext" id="MJXp-Span-1930">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the angle between</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-232-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-232"> \ alpha </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1936"><span class="MJXp-mrow" id="MJXp-Span-1937"><span class="MJXp-munderover" id="MJXp-Span-1938"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1940" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-233-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-233">\vec{V}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1941"><span class="MJXp-mrow" id="MJXp-Span-1942"><span class="MJXp-munderover" id="MJXp-Span-1943"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1945" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1944"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which in turn is</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-234-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-234">\vec{R}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1946"><span class="MJXp-mrow" id="MJXp-Span-1947"><span class="MJXp-munderover" id="MJXp-Span-1948"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1950" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , reflected relatively</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-235-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-235">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1951"><span class="MJXp-mrow" id="MJXp-Span-1952"><span class="MJXp-munderover" id="MJXp-Span-1953"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1955" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-236-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-236">\vec{N}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> That is, the first step is to calculate </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1956"><span class="MJXp-mrow" id="MJXp-Span-1957"><span class="MJXp-munderover" id="MJXp-Span-1958"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1960" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-237-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-237">\vec{R}</script>  of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1961"><span class="MJXp-mrow" id="MJXp-Span-1962"><span class="MJXp-munderover" id="MJXp-Span-1963"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1965" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-238-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-238">\vec{N}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1966"><span class="MJXp-mrow" id="MJXp-Span-1967"><span class="MJXp-munderover" id="MJXp-Span-1968"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1970" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-239-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-239">\vec{L}</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We can decompose </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1971"><span class="MJXp-mrow" id="MJXp-Span-1972"><span class="MJXp-munderover" id="MJXp-Span-1973"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1975" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> into two vectors</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-240-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-240">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1976"><span class="MJXp-mrow" id="MJXp-Span-1977"><span class="MJXp-munderover" id="MJXp-Span-1978"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-1982" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1981" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-241-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-241">\vec{L_P}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1983"><span class="MJXp-mrow" id="MJXp-Span-1984"><span class="MJXp-munderover" id="MJXp-Span-1985"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-1989" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1988" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> such that</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-242-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-242">\vec{L_N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1990"><span class="MJXp-mrow" id="MJXp-Span-1991"><span class="MJXp-munderover" id="MJXp-Span-1992"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-1994" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1995" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-1996"><span class="MJXp-munderover" id="MJXp-Span-1997"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2001" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2000" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2003"><span class="MJXp-munderover" id="MJXp-Span-2004"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2008" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2007" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-243-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-243">\vec{L} = \vec{L_P} + \vec{L_N}</script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2009"><span class="MJXp-mrow" id="MJXp-Span-2010"><span class="MJXp-munderover" id="MJXp-Span-2011"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2015" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2014" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N is</font></font></span></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parallel</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-244-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-244">\vec{L_N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2016"><span class="MJXp-mrow" id="MJXp-Span-2017"><span class="MJXp-munderover" id="MJXp-Span-2018"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2020" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-245-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-245">\vec{N}</script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2021"><span class="MJXp-mrow" id="MJXp-Span-2022"><span class="MJXp-munderover" id="MJXp-Span-2023"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2026" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P is</font></font></span></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perpendicular</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-246-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-246">\vec{L_P}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2028"><span class="MJXp-mrow" id="MJXp-Span-2029"><span class="MJXp-munderover" id="MJXp-Span-2030"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2031"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-247-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-247">\vec{N}</script>  : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/41a/013/4e6/41a0134e6b9ce94e90caaceb3c9cb01d.png"><br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2033"><span class="MJXp-mrow" id="MJXp-Span-2034"><span class="MJXp-munderover" id="MJXp-Span-2035"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2039" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2038" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a projection.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-248-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-248">\vec{L_N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2040"><span class="MJXp-mrow" id="MJXp-Span-2041"><span class="MJXp-munderover" id="MJXp-Span-2042"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2044" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-249-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-249">\vec{L}</script>  on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2045"><span class="MJXp-mrow" id="MJXp-Span-2046"><span class="MJXp-munderover" id="MJXp-Span-2047"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2049" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-250-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-250">\vec{N}</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on the properties of the scalar product and based on the fact that </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2050"><span class="MJXp-mrow" id="MJXp-Span-2051"><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2053"><span class="MJXp-munderover" id="MJXp-Span-2054"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2056" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2057"><span class="MJXp-mo" id="MJXp-Span-2058" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2059" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2060"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the length of this projection is equal to</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-251-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-251">|\vec{N}| = 1</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2061"><span class="MJXp-mo" id="MJXp-Span-2062" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2063"><span class="MJXp-munderover" id="MJXp-Span-2064"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2067" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2068"><span class="MJXp-munderover" id="MJXp-Span-2069"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2071" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2072" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-252-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-252">\langle \vec{N}, \vec{L} \rangle</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We have determined that </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2073"><span class="MJXp-mrow" id="MJXp-Span-2074"><span class="MJXp-munderover" id="MJXp-Span-2075"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2079" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2078" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be parallel</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-253-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-253">\vec{L_N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2080"><span class="MJXp-mrow" id="MJXp-Span-2081"><span class="MJXp-munderover" id="MJXp-Span-2082"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2083"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , therefore</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-254-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-254">\vec{N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2085"><span class="MJXp-mrow" id="MJXp-Span-2086"><span class="MJXp-munderover" id="MJXp-Span-2087"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2091" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2090" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2092" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2093"><span class="MJXp-munderover" id="MJXp-Span-2094"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2097" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü®</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2098"><span class="MJXp-munderover" id="MJXp-Span-2099"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2102" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2103"><span class="MJXp-munderover" id="MJXp-Span-2104"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2106" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2107" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-255-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-255">\vec{L_N} = \vec{N} \langle \vec{N}, \vec{L} \rangle</script>  . <br><br>  Insofar as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2108"><span class="MJXp-mrow" id="MJXp-Span-2109"><span class="MJXp-munderover" id="MJXp-Span-2110"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2113" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2114"><span class="MJXp-munderover" id="MJXp-Span-2115"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2119" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2117" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2118" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2120" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2121"><span class="MJXp-munderover" id="MJXp-Span-2122"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2126" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2125" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we can immediately get</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-256-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-256">\vec{L} = \vec{L_P} + \vec{L_N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2127"><span class="MJXp-mrow" id="MJXp-Span-2128"><span class="MJXp-munderover" id="MJXp-Span-2129"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2133" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2132" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2134" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2135"><span class="MJXp-munderover" id="MJXp-Span-2136"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2138" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2139" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2140"><span class="MJXp-munderover" id="MJXp-Span-2141"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2145" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2143" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2144" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2146" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2147"><span class="MJXp-munderover" id="MJXp-Span-2148"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2150" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2151" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2152"><span class="MJXp-munderover" id="MJXp-Span-2153"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2155" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2154"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2156" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü®</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2157"><span class="MJXp-munderover" id="MJXp-Span-2158"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2160" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2161" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2162"><span class="MJXp-munderover" id="MJXp-Span-2163"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2165" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2166" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-257-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-257">\vec{L_P} = \vec{L} - \vec{L_N} = \vec{L} - \vec{N} \langle \vec{N}, \vec{L} \rangle</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now look at </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2167"><span class="MJXp-mrow" id="MJXp-Span-2168"><span class="MJXp-munderover" id="MJXp-Span-2169"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2171" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-258-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-258">\vec{R}</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> because it is symmetrical </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2172"><span class="MJXp-mrow" id="MJXp-Span-2173"><span class="MJXp-munderover" id="MJXp-Span-2174"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2175"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> relative</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-259-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-259">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2177"><span class="MJXp-mrow" id="MJXp-Span-2178"><span class="MJXp-munderover" id="MJXp-Span-2179"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2181" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , its component, parallel</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-260-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-260">\vec{N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2182"><span class="MJXp-mrow" id="MJXp-Span-2183"><span class="MJXp-munderover" id="MJXp-Span-2184"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2186" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2185"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , same as u</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-261-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-261">\vec{N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2187"><span class="MJXp-mrow" id="MJXp-Span-2188"><span class="MJXp-munderover" id="MJXp-Span-2189"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2191" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2190"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the perpendicular component is opposite to the component</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-262-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-262">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2192"><span class="MJXp-mrow" id="MJXp-Span-2193"><span class="MJXp-munderover" id="MJXp-Span-2194"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2196" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-263-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-263">\vec{L}</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> i.e </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2197"><span class="MJXp-mrow" id="MJXp-Span-2198"><span class="MJXp-munderover" id="MJXp-Span-2199"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2201" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2202" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2203"><span class="MJXp-munderover" id="MJXp-Span-2204"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2208" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2206" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2207" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2210"><span class="MJXp-munderover" id="MJXp-Span-2211"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2215" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2213" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2214" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-264-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-264">\vec{R} = \vec{L_N} - \vec{L_P}</script>  : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/154/b24/88b/154b2488bca8fadd8c9b694dcba5e5f3.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Substituting the expressions obtained earlier, we get </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2216"><span class="MJXp-mrow" id="MJXp-Span-2217"><span class="MJXp-munderover" id="MJXp-Span-2218"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2220" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2219"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2221" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2222"><span class="MJXp-munderover" id="MJXp-Span-2223"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2225" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2226" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü®</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2227"><span class="MJXp-munderover" id="MJXp-Span-2228"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2231" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2232"><span class="MJXp-munderover" id="MJXp-Span-2233"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2235" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2236" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span><span class="MJXp-mo" id="MJXp-Span-2237" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2238"><span class="MJXp-munderover" id="MJXp-Span-2239"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2241" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2242" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2243"><span class="MJXp-munderover" id="MJXp-Span-2244"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2246" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2245"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2247" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü®</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2248"><span class="MJXp-munderover" id="MJXp-Span-2249"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2251" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2252" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2253"><span class="MJXp-munderover" id="MJXp-Span-2254"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2256" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2257" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-265-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-265">\vec{R} = \vec{N} \langle \vec{N}, \vec{L} \rangle - \vec{L} + \vec{N} \langle \vec{N}, \vec{L} \rangle</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and simplifying a little, we get </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2258"><span class="MJXp-mrow" id="MJXp-Span-2259"><span class="MJXp-munderover" id="MJXp-Span-2260"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2262" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mn" id="MJXp-Span-2264"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2265"><span class="MJXp-munderover" id="MJXp-Span-2266"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2268" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2269" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü®</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2270"><span class="MJXp-munderover" id="MJXp-Span-2271"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2273" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2272"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2274" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2275"><span class="MJXp-munderover" id="MJXp-Span-2276"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2278" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2279" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span><span class="MJXp-mo" id="MJXp-Span-2280" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2281"><span class="MJXp-munderover" id="MJXp-Span-2282"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2284" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-266-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-266">\vec{R} = 2\vec{N} \langle \vec{N}, \vec{L} \rangle - \vec{L}</script></p><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The value of the "mirror" reflection </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now we are ready to write the equation of ‚Äúmirror‚Äù reflection: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2285"><span class="MJXp-mrow" id="MJXp-Span-2286"><span class="MJXp-munderover" id="MJXp-Span-2287"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2289" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2288"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2290" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mn" id="MJXp-Span-2291"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2292"><span class="MJXp-munderover" id="MJXp-Span-2293"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2295" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2296" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü®</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2297"><span class="MJXp-munderover" id="MJXp-Span-2298"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2300" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2299"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2301" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2302"><span class="MJXp-munderover" id="MJXp-Span-2303"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2305" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2306" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span><span class="MJXp-mo" id="MJXp-Span-2307" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2308"><span class="MJXp-munderover" id="MJXp-Span-2309"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2311" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2310"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-267-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-267">\vec{R} = 2\vec{N} \langle \vec{N}, \vec{L} \rangle - \vec{L}</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2312"><span class="MJXp-msubsup" id="MJXp-Span-2313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2314" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2315" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2316" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2319" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-2320"><span class="MJXp-mrow" id="MJXp-Span-2321" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2322" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.629em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.516em; margin-left: -0.17em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2323"><span class="MJXp-mfrac" id="MJXp-Span-2324" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2325"><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ü® </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2327"><span class="MJXp-munderover" id="MJXp-Span-2328"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2330" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2329"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2331" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2332"><span class="MJXp-munderover" id="MJXp-Span-2333"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2335" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2336" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚ü©</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2337"><span class="MJXp-mrow" id="MJXp-Span-2338"><span class="MJXp-mo" id="MJXp-Span-2339" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2340"><span class="MJXp-munderover" id="MJXp-Span-2341"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2343" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2342"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2344"><span class="MJXp-mo" id="MJXp-Span-2345" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2346"><span class="MJXp-mo" id="MJXp-Span-2347" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2348"><span class="MJXp-munderover" id="MJXp-Span-2349"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2351" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2352"><span class="MJXp-mo" id="MJXp-Span-2353" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font></font></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2354" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.629em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.516em; margin-left: -0.17em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2355" style="vertical-align: 1.432em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-268-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-268">I_S = I_L \left( {{\langle \vec{R}, \vec{V} \rangle} \over {|\vec{R}||\vec{V}|}} \right)^s</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> As with diffuse lighting, </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2358"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-2360" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mo" id="MJXp-Span-2362" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be negative, and again we should ignore it. </font><font style="vertical-align: inherit;">In addition, not every object should be brilliant; </font><font style="vertical-align: inherit;">for such objects (which we will present through</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-269-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-269">cos(\alpha)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-2366" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-2367"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) the value of ‚Äúspecularity‚Äù will not be calculated at all.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-270-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-270">s = -1</script><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rendering with "mirror" reflections </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's add to the scene the ‚Äúmirror‚Äù reflections we were working on. </font><font style="vertical-align: inherit;">First, we make some changes to the scene itself:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (0, -1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (255, 0, 0) # Red</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 500 # Brilliant</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (-2, 1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (0, 0, 255) #Blue</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 500 # Brilliant</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (2, 1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (0, 255, 0) # Green</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 10 # A bit shiny</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (255, 255, 0) # Yellow</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (0, -5001, 0)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 5000</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 1000 # Very brilliant</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the code, we need to change </font></font><code>ComputeLighting</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it to calculate the ‚Äúspecularity‚Äù value if necessary and add it to the general lighting. </font><font style="vertical-align: inherit;">Notice that he now needs</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2368"><span class="MJXp-mrow" id="MJXp-Span-2369"><span class="MJXp-munderover" id="MJXp-Span-2370"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2372" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-271-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-271">\vec{V}</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-272-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-272"> s </script>  : <br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ComputeLighting (P, N, V, s) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    i = 0.0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for light in scene.Lights {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if light.type == ambient {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            i + = light.intensity</font></font><font></font>
         } else {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if light.type == point</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                L = light.position - P</font></font><font></font>
             else<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                L = light.direction</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            # Diffusion</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            n_dot_l = dot (N, L)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if n_dot_l&gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                i + = light.intensity * n_dot_l / (length (N) * length (L))</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            # Mirror</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if s! = -1 {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                R = 2 * N * dot (N, L) - L</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                r_dot_v = dot (R, V)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                if r_dot_v&gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    i + = light.intensity * pow (r_dot_v / (length (R) * length (V)), s)</font></font><font></font>
             }
         }
     }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return i</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally, we need to change </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it to pass on new parameters </font></font><code>ComputeLighting</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2376"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is obvious; </font><font style="vertical-align: inherit;">It is taken from the data sphere. </font><font style="vertical-align: inherit;">But what about</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-273-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-273"> s </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2377"><span class="MJXp-mrow" id="MJXp-Span-2378"><span class="MJXp-munderover" id="MJXp-Span-2379"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2381" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2380"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-274-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-274">\vec{V}</script>  ? <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2382"><span class="MJXp-mrow" id="MJXp-Span-2383"><span class="MJXp-munderover" id="MJXp-Span-2384"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2386" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the vector pointing from the object to the camera. </font><font style="vertical-align: inherit;">Fortunately, in</font><font style="vertical-align: inherit;">we already have a vector directed from the camera to the object - this</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-275-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-275">\vec{V}</script><font style="vertical-align: inherit;"></font><code>TraceRay</code><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2387"><span class="MJXp-mrow" id="MJXp-Span-2388"><span class="MJXp-munderover" id="MJXp-Span-2389"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2391" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2390"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the direction of the traced beam!</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-276-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-276">\vec{D}</script><font style="vertical-align: inherit;"></font> I.e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2392"><span class="MJXp-mrow" id="MJXp-Span-2393"><span class="MJXp-munderover" id="MJXp-Span-2394"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2396" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is just</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-277-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-277">\vec{V}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2397"><span class="MJXp-mo" id="MJXp-Span-2398" style="margin-left: 0em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2399"><span class="MJXp-munderover" id="MJXp-Span-2400"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2402" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-278-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-278">-\vec{D}</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is the new code </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with a ‚Äúmirror‚Äù reflection:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TraceRay (O, D, t_min, t_max) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_t = inf</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_sphere = NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for sphere in scene.Spheres {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        t1, t2 = IntersectRaySphere (O, D, sphere)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if t1 in [t_min, t_max] and t1 &lt;closest_t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_t = t1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_sphere = sphere</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if t2 in [t_min, t_max] and t2 &lt;closest_t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_t = t2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_sphere = sphere</font></font><font></font>
     }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if closest_sphere == NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        return BACKGROUND_COLOR</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    P = O + closest_t * D # Calculate intersection</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    N = P - closest_sphere.center # Calculate the sphere normal at the intersection point</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    N = N / length (N)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return closest_sphere.color * ComputeLighting (P, N, -D, sphere.specular)</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And here is our reward for all this juggling with vectors: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b2/e9b/a0c/1b2e9ba0ccc21593cedefe9ce176fb8d.png"><br><br> <a href="http://www.gabrielgambetta.com/computer-graphics-from-scratch/demos/raytracer-03.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code and working demo &gt;&gt;</font></font></a> <br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shadows </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Where there is light and objects, there must be shadows. So where are our shadows? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's start with a more fundamental question. Why </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">should there</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> be shadows? Shadows appear where there is light, but its rays cannot reach the object, because there is another object in their path. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You will notice that in the previous section we were interested in angles and vectors, but we considered only the light source and the point that we need to paint, and completely ignored everything else that happens in the scene ‚Äî for example, an object in the way. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instead, we need to add a bit of logic, saying " </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if there is an object between a point and a source, then there is no need to add lighting coming from this source</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ." </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We want to highlight the following two cases:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/dbc/ff2/2f2/dbcff22f25dcd0ef89830f179a76fffd.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It seems that we have all the necessary tools for this. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's start with a directional source. </font><font style="vertical-align: inherit;">We know</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-279-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-279"> P </script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is the point that interests us. </font><font style="vertical-align: inherit;">We know</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2405"><span class="MJXp-mrow" id="MJXp-Span-2406"><span class="MJXp-munderover" id="MJXp-Span-2407"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2409" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-280-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-280">\vec{L}</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is part of the definition of the light source. </font><font style="vertical-align: inherit;">Having</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2411"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-281-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-281"> P </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2412"><span class="MJXp-mrow" id="MJXp-Span-2413"><span class="MJXp-munderover" id="MJXp-Span-2414"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2416" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we can define a ray, namely</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-282-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-282">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2418"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-2419" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2420"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2421"><span class="MJXp-munderover" id="MJXp-Span-2422"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2424" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which passes from a point to an infinitely distant light source. </font><font style="vertical-align: inherit;">Does this beam intersect another object? </font><font style="vertical-align: inherit;">If not, then there is nothing between the point and the source, that is, we can calculate the illumination from this source and add it to the total illumination. </font><font style="vertical-align: inherit;">If it crosses, then we ignore this source. </font><font style="vertical-align: inherit;">We already know how to calculate the nearest intersection between a ray and a sphere; </font><font style="vertical-align: inherit;">we use it to trace the rays from the camera. </font><font style="vertical-align: inherit;">We can again use it to calculate the nearest intersection between the ray of light and the rest of the scene. </font><font style="vertical-align: inherit;">However, the parameters are slightly different. </font><font style="vertical-align: inherit;">Instead of starting from the camera, the rays are emitted from</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-283-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-283">P + t\vec{L}</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-284-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-284"> P </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direction is not equal </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2427"><span class="MJXp-mo" id="MJXp-Span-2428" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2429"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mo" id="MJXp-Span-2430" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2431"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font></span><span class="MJXp-mo" id="MJXp-Span-2432" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-285-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-285">(V - O)</script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2433"><span class="MJXp-mrow" id="MJXp-Span-2434"><span class="MJXp-munderover" id="MJXp-Span-2435"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2437" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2436"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-286-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-286">\vec{L}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And we are interested in intersections with everything after </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2439"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for infinite distance; </font><font style="vertical-align: inherit;">it means that</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-287-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-287"> P </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2440"><span class="MJXp-msubsup" id="MJXp-Span-2441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2443" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2444"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2445"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2447" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mn" id="MJXp-Span-2448"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-288-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-288">t_{min} = 0</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2449"><span class="MJXp-msubsup" id="MJXp-Span-2450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2452" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2453"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2456" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mo" id="MJXp-Span-2457" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-2458"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-289-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-289">t_{max} = +\infty</script>  . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/266/c2b/ce1/266c2bce1fc0f4dfcea644c32f6d2b9e.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We can handle point sources in a very similar way, but with two exceptions. </font><font style="vertical-align: inherit;">First, it is not set</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2459"><span class="MJXp-mrow" id="MJXp-Span-2460"><span class="MJXp-munderover" id="MJXp-Span-2461"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2463" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but it is very easy to calculate it from the position of the source and</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-290-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-290">\vec{L}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-291-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-291"> P </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Secondly, we are interested in any intersections, starting with </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2467"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but only until</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-292-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-292"> P </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2469"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (otherwise, objects</font><em><font style="vertical-align: inherit;">behind the</font></em><font style="vertical-align: inherit;">light source might create shadows!); </font><font style="vertical-align: inherit;">that is, in this case</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-293-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-293"> L </script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2470"><span class="MJXp-msubsup" id="MJXp-Span-2471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2473" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2475"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2477" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mn" id="MJXp-Span-2478"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-294-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-294">t_{min} = 0</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2479"><span class="MJXp-msubsup" id="MJXp-Span-2480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2481" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2482" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2484"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2486" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mn" id="MJXp-Span-2487"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-295-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-295">t_{max} = 1</script>  . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27a/e67/265/27ae67265be68da6cf34dc8dedcf3450.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is one borderline case that we need to consider. </font><font style="vertical-align: inherit;">Take a ray</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2489"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-2490" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2491"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2492"><span class="MJXp-munderover" id="MJXp-Span-2493"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2495" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2494"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-296-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-296">P + t\vec{L}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If we search for intersections starting from </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2496"><span class="MJXp-msubsup" id="MJXp-Span-2497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2498" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2499" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2501"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2503" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mn" id="MJXp-Span-2504"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then we will most likely find the very</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-297-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-297">t_{min} = 0</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2506"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-298-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-298"> P </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2508"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-2509" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2510"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> because</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-299-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-299">t = 0</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2512"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> really is on the sphere, and</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-300-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-300"> P </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P </font></font></span><span class="MJXp-mo" id="MJXp-Span-2515" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mn" id="MJXp-Span-2516"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2517"><span class="MJXp-munderover" id="MJXp-Span-2518"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2520" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2521" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2522"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-301-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-301">P + 0\vec{L} = P</script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in other words, each object will cast shadows on itself (Note: more precisely, we want to avoid a situation in which a point, rather than the whole object, casts a shadow on itself; an object with a shape more complex than a sphere (namely, any concave an object can cast true shadows on itself! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The simplest way to handle this is to use the lower bound of values.</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2524"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-302-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-302"> t </script>  instead <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2525"><span class="MJXp-mn" id="MJXp-Span-2526"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> small value</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-303-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-303"> 0 </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2527"><span class="MJXp-mtext" id="MJXp-Span-2528">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2529"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2530"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2531"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2532"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2533"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2534"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-304-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-304"> \ epsilon </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Geometrically, we want to make the beam start a little away from the surface, that is, next to </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> but not exactly in</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-305-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-305"> P </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-306-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-306"> P </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> That is, for directional sources, the interval will be </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2540"><span class="MJXp-mo" id="MJXp-Span-2541" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2542"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œµ </font></font></span><span class="MJXp-mo" id="MJXp-Span-2543" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mo" id="MJXp-Span-2544" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-2545"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû </font></font></span><span class="MJXp-mo" id="MJXp-Span-2546" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and for point ones</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-307-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-307">[\epsilon, +\infty]</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2547"><span class="MJXp-mo" id="MJXp-Span-2548" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œµ </font></font></span><span class="MJXp-mo" id="MJXp-Span-2550" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2551"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2552" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-308-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-308">[\epsilon, 1]</script>  . <br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rendering with shadows </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's turn this into pseudocode. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the previous version, I </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">calculated the nearest intersection of the ray-sphere, and then I calculated the lighting at the intersection. </font><font style="vertical-align: inherit;">We need to extract the code of the nearest intersection, because we want to use it again to calculate the shadows:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ClosestIntersection (O, D, t_min, t_max) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_t = inf</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_sphere = NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for sphere in scene.Spheres {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        t1, t2 = IntersectRaySphere (O, D, sphere)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if t1 in [t_min, t_max] and t1 &lt;closest_t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_t = t1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_sphere = sphere</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if t2 in [t_min, t_max] and t2 &lt;closest_t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_t = t2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_sphere = sphere</font></font><font></font>
     }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return closest_sphere, closest_t</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The result </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is much simpler:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TraceRay (O, D, t_min, t_max) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_sphere, closest_t = ClosestIntersection (O, D, t_min, t_max)</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if closest_sphere == NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        return BACKGROUND_COLOR</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    P = O + closest_t * D # Compute intersection</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    N = P - closest_sphere.center # Compute sphere normal at intersection</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    N = N / length (N)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return closest_sphere.color * ComputeLighting (P, N, -D, sphere.specular)</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we need to add </font></font><code>ComputeLighting</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a shadow </font><font style="vertical-align: inherit;">to the </font><font style="vertical-align: inherit;">check:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ComputeLighting (P, N, V, s) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    i = 0.0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for light in scene.Lights {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if light.type == ambient {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            i + = light.intensity</font></font><font></font>
         } else {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if light.type == point {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                L = light.position - P</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                t_max = 1</font></font><font></font>
             } else {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                L = light.direction</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                t_max = inf</font></font><font></font>
             }<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            # Shadow checking</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            shadow_sphere, shadow_t = ClosestIntersection (P, L, 0.001, t_max)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if shadow_sphere! = NULL</font></font><font></font>
                 continue<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            # Diffusion</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            n_dot_l = dot (N, L)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if n_dot_l&gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                i + = light.intensity * n_dot_l / (length (N) * length (L))</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            # Mirror</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if s! = -1 {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                R = 2 * N * dot (N, L) - L</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                r_dot_v = dot (R, V)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                if r_dot_v&gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    i + = light.intensity * pow (r_dot_v / (length (R) * length (V)), s)</font></font><font></font>
             }
         }
     }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return i</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here‚Äôs what our newly rendered scene will look like: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ed/1ea/353/6ed1ea353a56b72f78769975e6e30187.png"><br> <a href="http://www.gabrielgambetta.com/computer-graphics-from-scratch/demos/raytracer-04.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code and working demo &gt;&gt; </font></font></a> <br><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we are already doing something.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Reflection </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We got shiny objects. But is it possible to create objects that actually behave like mirrors? Of course, in fact, their implementation in the ray tracer is very simple, but at first it may seem confusing. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's see how the mirrors work. When we look in the mirror, we see the rays of light reflected from the mirror. Rays of light are reflected symmetrically with respect to the surface normal: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/61a/b07/aee/61ab07aee3f8b3bf0d9c4abfb983c461.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppose we trace the beam and the closest intersection is a mirror. What color has a ray of light? Obviously, it is not the color of the mirror, but any color that has a reflected beam. All we need is to calculate the direction of the reflected beam and find out what was the color of the light falling from this direction. If only we had a function that returns for the given beam the color of the light falling from this direction ...</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oh, wait, we have it: it is called </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, we start with the main loop </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to see what the beam emitted from the camera "sees". If it </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">determines that the ray sees a reflecting object, then it simply has to calculate the direction of the reflected ray and call ... itself. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At this stage, I suggest you re-read the last three paragraphs until you understand them. If this is your first time reading about recursive ray tracing, then you may need to reread a couple of times and think a bit before you really </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">understand</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Take your time, I'll wait.</font></font><br><br>  ... <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now that the euphoria of this beautiful moment is </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eureka! </font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Slept a little, let's formalize it a little. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The most important in all recursive algorithms is to prevent an infinite loop. </font><font style="vertical-align: inherit;">In this algorithm, there is an obvious exit condition: when the beam either falls on a non-reflecting object, or when it does not fall on anything. </font><font style="vertical-align: inherit;">But there is a simple case in which we can cater to an endless cycle: the effect of an </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">endless corridor</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">It manifests itself when you put a mirror opposite another mirror and see endless copies of yourself in them! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are many ways to prevent this problem. </font><font style="vertical-align: inherit;">We will enter </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the recursion limit of the</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algorithm; </font><font style="vertical-align: inherit;">he will control the "depth" to which he can go. </font><font style="vertical-align: inherit;">Let's call him</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2554"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-309-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-309"> r </script>  .  With <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2558"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then we see objects, but without reflections.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-310-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-310">r = 0</script><font style="vertical-align: inherit;"></font> With <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2560"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mo" id="MJXp-Span-2561" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2562"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we see some objects and reflections of some objects.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-311-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-311">r = 1</script><font style="vertical-align: inherit;"></font> With <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2564"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mo" id="MJXp-Span-2565" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2566"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we see some objects, reflections of some objects</font><em><font style="vertical-align: inherit;">and reflections of some reflections of some objects</font></em><font style="vertical-align: inherit;">.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-312-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-312">r = 2</script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font> And so on.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, there is not much point in going deeper by more than 2-3 levels, because at this stage the difference is barely noticeable. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will create another distinction. </font><font style="vertical-align: inherit;">"Reflectability" should not matter "is or not" - objects can be partially reflective and partially colored. </font><font style="vertical-align: inherit;">We will assign each surface a number from</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2567"><span class="MJXp-mn" id="MJXp-Span-2568"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-313-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-313"> 0 </script>  before <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2569"><span class="MJXp-mn" id="MJXp-Span-2570"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , determining its reflectivity. </font><font style="vertical-align: inherit;">Then we will mix the locally lit color and the reflected color in proportion to this number. </font><font style="vertical-align: inherit;">Finally, you need to decide which parameters the recursive call should receive</font><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">The beam starts from the surface of the object, a point</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-314-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-314"> 1 </script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><code>TraceRay</code><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2572"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-315-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-315"> P </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The direction of the beam is the direction of the light reflected from </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2574"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-316-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-316"> P </script>  ;<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we have</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2575"><span class="MJXp-mrow" id="MJXp-Span-2576"><span class="MJXp-munderover" id="MJXp-Span-2577"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2579" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, the direction from the camera to</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-317-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-317">\vec{D}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2581"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , opposite to the movement of light, that is, the direction of the reflected beam will be</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-318-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-318"> P </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2582"><span class="MJXp-mrow" id="MJXp-Span-2583"><span class="MJXp-munderover" id="MJXp-Span-2584"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2587" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2585" style="margin-left: 0em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2586"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reflected on</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-319-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-319">\vec{-D}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2588"><span class="MJXp-mrow" id="MJXp-Span-2589"><span class="MJXp-munderover" id="MJXp-Span-2590"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2591"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-320-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-320">\vec{N}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Similar to what happens with shadows, we do not want objects to reflect themselves, so </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2593"><span class="MJXp-msubsup" id="MJXp-Span-2594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2596" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2598"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2599"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2600" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œµ</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-321-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-321">t_{min} = \epsilon</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We want to see objects reflected no matter how distant they are, therefore </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2602"><span class="MJXp-msubsup" id="MJXp-Span-2603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2604" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2605" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2606"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2607"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2608"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2609" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mo" id="MJXp-Span-2610" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-2611"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àû</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-322-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-322">t_{max} = +\infty</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And the last - the recursion limit is one less than the recursion limit in which we are at the moment. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rendering with reflection </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's add reflection to the ray tracer code. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As before, first of all we change the scene:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (0, -1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (255, 0, 0) # Red</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 500 # Brilliant</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    reflective = 0.2 # Slightly reflective</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (-2, 1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (0, 0, 255) #Blue</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 500 # Brilliant</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    reflective = 0.3 # A bit more reflective</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (2, 1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (0, 255, 0) # Green</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 10 # A bit shiny</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    reflective = 0.4 # Even more reflective</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (255, 255, 0) # Yellow</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (0, -5001, 0)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 5000</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 1000 # Very brilliant</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    reflective = 0.5 # half reflective</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We use the ‚Äúray of reflection‚Äù formula in a couple of places, so we can get rid of it. </font><font style="vertical-align: inherit;">She gets a ray</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2612"><span class="MJXp-mrow" id="MJXp-Span-2613"><span class="MJXp-munderover" id="MJXp-Span-2614"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2616" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2615"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and normal</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-323-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-323">\vec{R}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2617"><span class="MJXp-mrow" id="MJXp-Span-2618"><span class="MJXp-munderover" id="MJXp-Span-2619"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2621" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2620"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , returning</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-324-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-324">\vec{N}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2622"><span class="MJXp-mrow" id="MJXp-Span-2623"><span class="MJXp-munderover" id="MJXp-Span-2624"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2626" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reflected on</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-325-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-325">\vec{R}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2627"><span class="MJXp-mrow" id="MJXp-Span-2628"><span class="MJXp-munderover" id="MJXp-Span-2629"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2630"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-326-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-326">\vec{N}</script>  : <br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ReflectRay (R, N) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return 2 * N * dot (N, R) - R;</font></font><font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The only change in </font></font><code>ComputeLighting</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the replacement of the reflection equation to the challenge of this new one </font></font><code>ReflectRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A small change has been made to the main method - we need to pass the </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">upper level limit of recursion:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> color = TraceRay (O, D, 1, inf, recursion_depth) </font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A constant </font></font><code>recursion_depth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can be given a reasonable value, for example, 3 or 5. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The only important changes occur near the end </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, where we recursively calculate the reflections:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TraceRay (O, D, t_min, t_max, depth) {</font></font><font></font>
    closest_sphere, closest_t = ClosestIntersection(O, D, t_min, t_max)<font></font>
<font></font>
    if closest_sphere == NULL<font></font>
        return BACKGROUND_COLOR<font></font>
<font></font>
    #   <font></font>
    P = O + closest_t*D #   <font></font>
    N = P - closest_sphere.center #       <font></font>
    N = N / length(N)<font></font>
    local_color = closest_sphere.color*ComputeLighting(P, N, -D, sphere.specular)<font></font>
<font></font>
    #         ,   <font></font>
    r = closest_sphere.reflective<font></font>
    if depth &lt;= 0 or r &lt;= 0:<font></font>
        return local_color<font></font>
<font></font>
    #   <font></font>
    R = ReflectRay(-D, N)<font></font>
    reflected_color = TraceRay(P, R, 0.001, inf, depth - 1)<font></font>
<font></font>
    return local_color*(1 - r) + reflected_color*r<font></font>
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let the results speak for themselves: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2c4/772/458/2c477245819ed47508f647eedd9401a7.png"><br><br> <a href="http://www.gabrielgambetta.com/computer-graphics-from-scratch/demos/raytracer-05.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code and working demo &gt;&gt;</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To better understand the limit of the depth of recursion, let's take a closer look at the render with</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2633"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mo" id="MJXp-Span-2634" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2635"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-327-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-327">r = 1</script>  : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/872/478/5dd/8724785dd129c7cd5048291208806fda.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> But the same magnified view of the same scene, this time rendered with </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2637"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mo" id="MJXp-Span-2638" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-2639"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-328-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-328">r = 3</script>  : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ff/2b5/629/1ff2b5629e9b0e22b4b14b7796c2b0e6.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> As you can see, the difference is whether we see reflections of reflections of reflections of objects, or just reflections of objects. </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arbitrary camera </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> At the very beginning of the ray tracing discussion, we made two important assumptions: the camera is fixed in </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2640"><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2642"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2643" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2644"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2645" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2646"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2647" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and sent to</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-329-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-329">(0, 0, 0)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2648"><span class="MJXp-mrow" id="MJXp-Span-2649"><span class="MJXp-munderover" id="MJXp-Span-2650"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2654" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2652" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Z </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2653" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the direction ‚Äúup‚Äù is</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-330-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-330">\vec{Z_+}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2655"><span class="MJXp-mrow" id="MJXp-Span-2656"><span class="MJXp-munderover" id="MJXp-Span-2657"><span><span class="MJXp-over"><span class=""><span class="MJXp-mo" id="MJXp-Span-2661" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-2658"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2659" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2660" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-331-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-331">\vec{Y_+}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this section, we will get rid of these restrictions so that you can position the camera anywhere in the scene and direct it in any direction. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's start with position. </font><font style="vertical-align: inherit;">You probably noticed that</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2663"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O is</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> used throughout the pseudocode only once: as the starting point of the rays emanating from the camera in the top-level method. </font><font style="vertical-align: inherit;">If we want to change the position of the camera. </font><font style="vertical-align: inherit;">the</font><em><font style="vertical-align: inherit;">only</font></em><font style="vertical-align: inherit;">thing to do is use a different value for</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-332-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-332"> O </script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-333-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-333"> O </script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Does the change in </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">position</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> affect </font><font style="vertical-align: inherit;">the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">direction of the</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rays? </font><font style="vertical-align: inherit;">Not at all. </font><font style="vertical-align: inherit;">The direction of the rays is a vector passing from the camera to the projection plane. </font><font style="vertical-align: inherit;">When we move the camera, the projection plane moves with the camera, that is, their relative positions do not change. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's now pay attention to the direction. </font><font style="vertical-align: inherit;">Let's say we have a rotation matrix that rotates</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2666"><span class="MJXp-mo" id="MJXp-Span-2667" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2668"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2669" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2670"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2671" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2672"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2673" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the desired viewing direction, and</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-334-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-334">(0, 0, 1)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2674"><span class="MJXp-mo" id="MJXp-Span-2675" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2676"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2677" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2678"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2679" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2680"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2681" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - in the right direction "up" (and since this is a rotation matrix, then by definition it should do what is required for</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-335-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-335">(0, 1, 0)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2682"><span class="MJXp-mo" id="MJXp-Span-2683" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2684"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2685" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2686"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2687" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2688"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2689" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-336-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-336">(1, 0, 0)</script>  ). <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The position of the</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> camera does not change if you simply rotate the camera around. </font><font style="vertical-align: inherit;">But the direction changes, it just undergoes the same turn as the whole camera. </font><font style="vertical-align: inherit;">That is, if we have a direction</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2690"><span class="MJXp-mrow" id="MJXp-Span-2691"><span class="MJXp-munderover" id="MJXp-Span-2692"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2694" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and rotation matrix</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-337-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-337">\vec{D}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then rotated</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-338-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-338"> R </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2698"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is just</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-339-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-339"> D </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2699"><span class="MJXp-mrow" id="MJXp-Span-2700"><span class="MJXp-munderover" id="MJXp-Span-2701"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-2703" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2702"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2704"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-340-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-340">\vec{D}R</script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Only the top level function changes: </font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for x in [-Cw / 2, Cw / 2] {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for y in [-Ch / 2, Ch / 2] {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        D = camera.rotation * CanvasToViewport (x, y)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        color = TraceRay (camera.position, D, 1, inf)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        canvas.PutPixel (x, y, color)</font></font><font></font>
     }
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is how our scene looks when viewed from a different position and with a different orientation: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ad6/9dd/9e1/ad69dd9e1d49953b28fc5fdf901f06bf.png"><br><br> <a href="http://www.gabrielgambetta.com/computer-graphics-from-scratch/demos/raytracer-06.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code and working demo &gt;&gt;</font></font></a> <br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Where to go next </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We will finish the first part of the work with a brief overview of some interesting topics that we did not explore. </font></font><br><br><h2>  Optimization </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As stated in the introduction, we considered the most understandable way to explain and implement various possibilities. </font><font style="vertical-align: inherit;">Therefore, the ray tracer is fully functional, but not very fast. </font><font style="vertical-align: inherit;">Here are some ideas that you can explore on your own to speed up the work of the router. </font><font style="vertical-align: inherit;">Just for fun, try to measure the execution time before and after their implementation. </font><font style="vertical-align: inherit;">You will be very surprised!</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Parallelization </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The most obvious way to accelerate the work of the ray tracer is to trace several rays simultaneously. </font><font style="vertical-align: inherit;">Since each beam emanating from the camera is independent of all the others, and most of the structures are read-only, we can trace one beam to each core of the central processor without much difficulty and difficulty due to synchronization problems. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In fact, ray tracers belong to a class of algorithms called </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extremely parallelizable</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> precisely because their very nature makes it very easy to parallelize them.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Value caching </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consider the values ‚Äã‚Äãcalculated </font></font><code>IntersectRaySphere</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on which the ray tracer usually spends most of the time:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> k1 = dot (D, D)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    k2 = 2 * dot (OC, D)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    k3 = dot (OC, OC) - r * r </font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Some of these values ‚Äã‚Äãare constant for the whole scene - as soon as you know how the spheres are located, </font></font><code>r*r</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>dot(OC, OC)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no longer change. </font><font style="vertical-align: inherit;">You can calculate them once while loading the scene and store them in the spheres themselves; </font><font style="vertical-align: inherit;">you just need to recount them if the spheres are to move in the next frame. </font></font><code>dot(D, D)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- this is a constant for a given beam, so you can calculate it in </font></font><code>ClosestIntersection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and pass in </font></font><code>IntersectRaySphere</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shadow Optimization </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If a point of an object is in the shadow relative to the light source, because another object is detected on the way, then there is a high probability that the neighboring point due to the same object is also in the shadow relative to the light source (this is called </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">shadow consistency</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ): </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e83/44e/667/e8344e667595db2a6324c59ced3866b9.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That is When we search for objects between a point and a light source, we can first check whether the last object that shadows the previous point over the same light source imposes a shadow on the current point. If so, then we can finish; if not, then just continue to check the remaining objects in the usual way.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Similarly, when calculating the intersection between a ray of light and objects in the scene, in fact we do not need the nearest intersection - it is enough to know that there is at least one intersection. </font><font style="vertical-align: inherit;">You can use a special version </font></font><code>ClosestIntersection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that returns the result as soon as it finds the first intersection (and for this we need to calculate and return not </font></font><code>closest_t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">just a boolean value).</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Spatial structures </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calculating the intersection of the beam with each sphere is quite a big waste of resources. There are many data structures that allow you to drop entire groups of objects at one go without the need to calculate individual intersections. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A detailed examination of such structures does not relate to the subject of our article, but the general idea is this: suppose that we have several areas close to each other. You can calculate the center and radius of the smallest sphere containing all of these spheres. If the ray does not intersect this boundary sphere, then one can be sure that it does not intersect any sphere contained in it, and this can be done in one intersection check. Of course, if he crosses a sphere, then we still need to check if he crosses any of the spheres contained in it.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can learn more about this by reading about the </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hierarchy of limiting volumes</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Subsampling </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here is an easy way to do a ray tracer in </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2706"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> times faster: calculate in</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-341-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-341"> N </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2708"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> times pixels smaller! </font><font style="vertical-align: inherit;">Suppose we trace rays for pixels</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-342-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-342"> N </script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2709"><span class="MJXp-mo" id="MJXp-Span-2710" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2711"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2712" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2713"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2714" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-343-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-343">(10, 100)</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2715"><span class="MJXp-mo" id="MJXp-Span-2716" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2717"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">12 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2718" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2719"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and they fall on one object. </font><font style="vertical-align: inherit;">You can logically assume that the ray is for a pixel.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-344-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-344">(12, 100)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2721"><span class="MJXp-mo" id="MJXp-Span-2722" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2723"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2724" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-2725"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2726" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will also fall on the same object, skip the initial search for intersections with the entire scene and go directly to the color calculation at this point. </font><font style="vertical-align: inherit;">If you do this in the horizontal and vertical directions, then you can perform a maximum of 75% less primary beam-scene cross-sectional calculations. </font><font style="vertical-align: inherit;">Of course, one can easily miss a very thin object: unlike the ones considered earlier, this is the ‚Äúwrong‚Äù optimization, because the results of its use are not</font><em><font style="vertical-align: inherit;">identical</font></em><font style="vertical-align: inherit;">to what we would get without it; </font><font style="vertical-align: inherit;">in a sense, we are ‚Äúcheating‚Äù on this economy. </font><font style="vertical-align: inherit;">The trick is to figure out how to save properly, ensuring satisfactory results.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-345-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-345">(11, 100)</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Other primitives </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the previous sections, we used spheres as primitives because it is convenient to manipulate them from a mathematical point of view. </font><font style="vertical-align: inherit;">But having achieved this, you can simply add other primitives. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note that from the point of view </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, any object may be suitable, as long as it needs to calculate only two values: the value</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2728"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for the nearest intersection between the ray and the object, and the normal at the intersection point. </font><font style="vertical-align: inherit;">Everything else in the ray tracer does not depend on the type of object. </font><font style="vertical-align: inherit;">Triangles are a good choice. </font><font style="vertical-align: inherit;">First you need to calculate the intersection between the ray and the plane containing the triangle, and if there is an intersection, then determine whether the point is inside the triangle.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-346-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-346"> t </script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Constructive block geometry </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is a very interesting type of objects that is relatively simple to implement: a boolean operation between other objects. </font><font style="vertical-align: inherit;">For example, the intersection of two spheres can create something similar to a lens, and when subtracting a small sphere from a larger sphere, you can get something resembling a Death Star.</font></font><br><br>  How it works?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For each object, you can calculate the places where the ray enters and leaves the object; </font><font style="vertical-align: inherit;">for example, in the case of a sphere, a ray enters</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2731"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2732"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2733" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2735" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2736" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2737" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2739" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2740" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2741" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and goes to</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-347-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-347">min(t_1, t_2)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2743"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2744"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2745"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-2746" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2748" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2749" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2750" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2752" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2753" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2754" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-348-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-348">max(t_1, t_2)</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppose we need to calculate the intersection of two spheres; </font><font style="vertical-align: inherit;">the beam is inside the intersection when it is inside both spheres, and outside otherwise. </font><font style="vertical-align: inherit;">In the case of subtraction, the beam is inside when it is inside the first object, but not inside the second. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">More generally, if we want to calculate the intersection between a ray and</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2756"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-2757" style="margin-left: 0.111em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚®Ä </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2758"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-349-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-349">A \bigodot B</script>  (Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2759"><span class="MJXp-mo" id="MJXp-Span-2760" style="margin-left: 0.111em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚®Ä</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - any Boolean operator), then first you need to separately calculate the intersection of the ray</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-350-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-350">\bigodot</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and luch-</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-351-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-351"> A </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2764"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which gives us the "internal" interval of each object</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-352-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-352"> B </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2765"><span class="MJXp-msubsup" id="MJXp-Span-2766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2767" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2768" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-353-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-353"> R_a </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2769"><span class="MJXp-msubsup" id="MJXp-Span-2770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2771" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2772" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-354-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-354"> R_b </script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Then we calculate </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2773"><span class="MJXp-msubsup" id="MJXp-Span-2774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2775" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2776" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2777" style="margin-left: 0.111em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚®Ä </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2779" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2780" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is in the "internal" interval</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-355-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-355">R_A \bigodot R_B</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2782"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-2783" style="margin-left: 0.111em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚®Ä </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2784"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-356-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-356">A \bigodot B</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We just need to find the first value. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2786"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is both in the "internal" interval and in the interval</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-357-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-357"> t </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2787"><span class="MJXp-mo" id="MJXp-Span-2788" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2791" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2793"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2794"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2795" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2798" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2800"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2801"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-2802" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ]</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that interest us: The</font><font style="vertical-align: inherit;">normal at the intersection point is either the normal of the object creating the intersection, or its opposite, depending on whether we look outside or inside the original object. </font><font style="vertical-align: inherit;">Of course</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-358-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-358">[t_{min}, t_{max}]</script><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f36/e23/f95/f36e23f9582371437e69b96083d99c6a.png"><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2804"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-359-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-359"> A </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2806"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do not have to be primitive; </font><font style="vertical-align: inherit;">they themselves can be the results of boolean operations! </font><font style="vertical-align: inherit;">If we realize this purely, then we will not even need to know</font><em><font style="vertical-align: inherit;">what</font></em><font style="vertical-align: inherit;">they are, as long as we can get intersections and normals from them. </font><font style="vertical-align: inherit;">Thus, we can take three spheres and calculate, for example,</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-360-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-360"> B </script><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2807"><span class="MJXp-mo" id="MJXp-Span-2808" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2809"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mo" id="MJXp-Span-2810" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚à™ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2811"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B </font></font></span><span class="MJXp-mo" id="MJXp-Span-2812" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-2813" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚à© </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-361-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-361">(A \cup B) \cap C</script>  . <br><br><h2>  Transparency </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Not all objects must be opaque, some may be partially transparent. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The implementation of transparency is very similar to the implementation of reflection. </font><font style="vertical-align: inherit;">When the beam falls on a partially transparent surface, we, as before, calculate the local and reflected color, but also calculate the additional color - the color of light passing </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">through the</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> object received by another call </font></font><code>TraceRay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Then you need to mix this color with local and reflected colors, taking into account the transparency of the object, and that's it.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Refraction </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In real life, when a ray of light passes through a transparent object, it changes direction (therefore, when immersed in a straw in a glass of water, it looks ‚Äúbroken‚Äù). </font><font style="vertical-align: inherit;">The change of direction depends on </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the refractive index of</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> each material in accordance with the following equation:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2815"><span class="MJXp-mrow" id="MJXp-Span-2816"><span class="MJXp-mfrac" id="MJXp-Span-2817" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2819"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2820"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2822" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2824" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2825" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2826" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2828"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2829"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2830"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2831" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2833" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2834" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2835" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2836" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2837"><span class="MJXp-mfrac" id="MJXp-Span-2838" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2840" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2841" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2843" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2844" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-362-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-362">{sin(\alpha_1) \over sin(\alpha_2)} = { n_2 \over n_1 }</script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2845"><span class="MJXp-mtext" id="MJXp-Span-2846">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2847"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2848"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2849"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2850"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2852" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2853" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-363-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-363"> \ alpha_1 </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2854"><span class="MJXp-msubsup" id="MJXp-Span-2855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2856" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2857" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the angle between the beam and the normal before and after crossing the surface, and</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-364-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-364">\alpha_2</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2858"><span class="MJXp-msubsup" id="MJXp-Span-2859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2860" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2861" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-365-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-365"> n_1 </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2862"><span class="MJXp-msubsup" id="MJXp-Span-2863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2864" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2865" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the refractive indices of the material outside and inside objects.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-366-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-366">n_2</script><font style="vertical-align: inherit;"></font><br><br>  For example, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2866"><span class="MJXp-msubsup" id="MJXp-Span-2867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2869" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2870"><span class="MJXp-mo" id="MJXp-Span-2871"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2872"><span class="MJXp-mo" id="MJXp-Span-2873"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">about </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2874"><span class="MJXp-mo" id="MJXp-Span-2875"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2876"><span class="MJXp-mo" id="MJXp-Span-2877"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2878"><span class="MJXp-mo" id="MJXp-Span-2879"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2880"><span class="MJXp-mo" id="MJXp-Span-2881"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2882"><span class="MJXp-mo" id="MJXp-Span-2883"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font></font></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> approximately equal</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-367-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-367">n_{}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2884"><span class="MJXp-mn" id="MJXp-Span-2885"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-368-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-368">1.0</script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2886"><span class="MJXp-msubsup" id="MJXp-Span-2887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2888" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2889" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-2890"><span class="MJXp-mo" id="MJXp-Span-2891"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2892"><span class="MJXp-mo" id="MJXp-Span-2893"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">about </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2894"><span class="MJXp-mo" id="MJXp-Span-2895"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-2896"><span class="MJXp-mo" id="MJXp-Span-2897"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> approximately equal</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-369-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-369">n_{}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2898"><span class="MJXp-mn" id="MJXp-Span-2899"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.33</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-370-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-370">1.33</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> That is, for a ray entering the water at an angle </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2900"><span class="MJXp-msubsup" id="MJXp-Span-2901"><span class="MJXp-mn" id="MJXp-Span-2902" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">60 </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2903" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-371-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-371">60^\circ</script>  we get <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2904"><span class="MJXp-mrow" id="MJXp-Span-2905"><span class="MJXp-mfrac" id="MJXp-Span-2906" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2908"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2909"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2910"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2911" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2912"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">60 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2913" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2915"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2916"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2917"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2918" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2919"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2920" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2921" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-2922" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2923" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mrow" id="MJXp-Span-2924"><span class="MJXp-mfrac" id="MJXp-Span-2925" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2926"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.33</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2927"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.0</font></font></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-372-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-372">{sin(60) \over sin(\alpha_2)} = {1.33 \over 1.0}</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2929"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2930"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2931"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2932" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mn" id="MJXp-Span-2934"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2935" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-2936" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2937"><span class="MJXp-mfrac" id="MJXp-Span-2938" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2940"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2941"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2942"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2943" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2944"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">60 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2945" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2946"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.33</font></font></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-373-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-373">sin(\alpha2) = {sin(60) \over 1.33}</script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2948"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ± </font></font></span><span class="MJXp-mn" id="MJXp-Span-2949"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2950" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2951"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2952"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2953"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2954"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2955"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2956"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2957" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mrow" id="MJXp-Span-2958"><span class="MJXp-mfrac" id="MJXp-Span-2959" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2961"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2962"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2963"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mo" id="MJXp-Span-2964" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-2965"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">60 </font></font></span><span class="MJXp-mo" id="MJXp-Span-2966" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2967"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.33</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2968" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span><span class="MJXp-mo" id="MJXp-Span-2969" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-2970"><span class="MJXp-mn" id="MJXp-Span-2971" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">40.628</font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2972" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àò</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-374-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-374">\alpha2 = arcsin({sin(60) \over 1.33}) = 40.628^\circ</script></p><br><img src="https://habrastorage.org/getpro/habr/post_images/1da/ff7/1e7/1daff71e7506a23afc0868c8efd8d7a6.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Stop for a moment and realize: if you implement a constructive block geometry and transparency, you can simulate a magnifying glass (the intersection of two spheres), which will behave like a physically correct magnifying glass! </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Supersampling </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supersampling is the approximate opposite of subsampling, when we strive for accuracy instead of speed. Suppose that the rays corresponding to two neighboring pixels fall on two different objects. We need to color each pixel in the appropriate color. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, do not forget about the analogy with which we started: each beam must specify the ‚Äúdetermining‚Äù color of each </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">square of the</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äúgrid‚Äù through which we look. Using one ray per pisle, we conditionally decide that the color of the ray of light passing through the middle of the square determines the whole square, but this may not be so. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This problem can be solved by tracing several rays per pixel - 4, 9, 16, and so on, and then averaging them to get the color of the pixel.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Of course, with this, the ray tracer becomes 4, 9 or 16 times slower, for the same reason that sub-sampling makes it in </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2974"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> times faster. </font><font style="vertical-align: inherit;">Fortunately, there is a trade-off. </font><font style="vertical-align: inherit;">We can assume that the properties of an object along its surface change smoothly, that is, the emission of 4 rays per pixel that fall on one object at slightly different points does not improve the look of the scene too much. </font><font style="vertical-align: inherit;">Therefore, we can start from one ray per pixel and compare neighboring rays: if they fall on other objects or their color differs more than on a divided threshold value, then we apply a division of pixels to both.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-375-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-375"> N </script><font style="vertical-align: inherit;"></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ray tracer pseudocode </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Below is the full version of the pseudo code we created in the ray tracing chapters: </font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CanvasToViewport (x, y) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return (x * vw / cw, y * vh / ch, d)</font></font><font></font>
 }<font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ReflectRay (R, N) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return 2 * N * dot (N, R) - R;</font></font><font></font>
 }<font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ComputeLighting (P, N, V, s) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    i = 0.0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for light in scene.Lights {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if light.type == ambient {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            i + = light.intensity</font></font><font></font>
         } else {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if light.type == point {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                L = light.position - P</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                t_max = 1</font></font><font></font>
             } else {<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                L = light.direction</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                t_max = inf</font></font><font></font>
             }<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            # Shadow checking</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            shadow_sphere, shadow_t = ClosestIntersection (P, L, 0.001, t_max)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if shadow_sphere! = NULL</font></font><font></font>
                 continue<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            # Diffusion</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            n_dot_l = dot (N, L)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if n_dot_l&gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                i + = light.intensity * n_dot_l / (length (N) * length (L))</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            # Glitter</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            if s! = -1 {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                R = ReflectRay (L, N)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                r_dot_v = dot (R, V)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                if r_dot_v&gt; 0</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                    i + = light.intensity * pow (r_dot_v / (length (R) * length (V)), s)</font></font><font></font>
             }
         }
     }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return i</font></font><font></font>
 }<font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ClosestIntersection (O, D, t_min, t_max) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_t = inf</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_sphere = NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for sphere in scene.Spheres {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        t1, t2 = IntersectRaySphere (O, D, sphere)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if t1 in [t_min, t_max] and t1 &lt;closest_t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_t = t1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_sphere = sphere</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        if t2 in [t_min, t_max] and t2 &lt;closest_t</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_t = t2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            closest_sphere = sphere</font></font><font></font>
     }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return closest_sphere, closest_t</font></font><font></font>
 }<font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TraceRay (O, D, t_min, t_max, depth) {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    closest_sphere, closest_t = ClosestIntersection (O, D, t_min, t_max)</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if closest_sphere == NULL</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        return BACKGROUND_COLOR</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    # Calculating local color</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    P = O + closest_t * D # Calculating the intersection point</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    N = P - closest_sphere.center # Calculate the sphere normal at the intersection point</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    N = N / length (N)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    local_color = closest_sphere.color * ComputeLighting (P, N, -D, sphere.specular)</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    # If we have reached the recursion limit or the object is not reflective, then we are done.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    r = closest_sphere.reflective</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    if depth &lt;= 0 or r &lt;= 0:</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        return local_color</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    # Calculation of reflected color</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    R = ReflectRay (-D, N)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    reflected_color = TraceRay (P, R, 0.001, inf, depth - 1)</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    return local_color * (1 - r) + reflected_color * r</font></font><font></font>
 }<font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
for x in [-Cw / 2, Cw / 2] {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    for y in [-Ch / 2, Ch / 2] {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        D = camera.rotation * CanvasToViewport (x, y)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        color = TraceRay (camera.position, D, 1, inf)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        canvas.PutPixel (x, y, color)</font></font><font></font>
     }
 } </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here is the scene used to render the examples: </font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> viewport_size = 1 x 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
projection_plane_d = 1</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (0, -1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (255, 0, 0) # Red</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 500 # Brilliant</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    reflective = 0.2 # Slightly reflective</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (-2, 1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (0, 0, 255) #Blue</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 500 # Brilliant</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    reflective = 0.3 # A bit more reflective</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (2, 1, 3)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 1</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (0, 255, 0) # Green</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 10 # A bit shiny</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    reflective = 0.4 # Even more reflective</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sphere {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    color = (255, 255, 0) # Yellow</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    center = (0, -5001, 0)</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    radius = 5000</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    specular = 1000 # Very brilliant</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    reflective = 0.5 # half reflective</font></font><font></font>
 }<font></font>
<font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
light {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    type = ambient</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    intensity = 0.2</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
light {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    type = point</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    intensity = 0.6</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    position = (2, 1, 0)</font></font><font></font>
 }<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
light {</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    type = directional</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    intensity = 0.2</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    direction = (1, 4, 4)</font></font><font></font>
 } </pre></div><p>Source: <a href="https://habr.com/ru/post/342510/">https://habr.com/ru/post/342510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342498/index.html">Reactive programming with Spring Boot 2. Part 1</a></li>
<li><a href="../342502/index.html">Why the founder of Interactive Brokers is afraid of bitcoin futures</a></li>
<li><a href="../342504/index.html">Virtuozzo 7 Update 5 - what's new?</a></li>
<li><a href="../342506/index.html">Reactive programming with Spring Boot 2. Part 2</a></li>
<li><a href="../342508/index.html">3CX Upgrade from Debian 8 Jessie to Debian 9 Stretch</a></li>
<li><a href="../342512/index.html">‚ÄúHello, World!‚Äù For novice writers</a></li>
<li><a href="../342514/index.html">How White Label helps in the development of services and products. 5 examples</a></li>
<li><a href="../342516/index.html">Key announcements Connect (); 2017</a></li>
<li><a href="../342518/index.html">Why programmers don't get jobs: four horror stories</a></li>
<li><a href="../342524/index.html">Experience developing low power devices on the STM32L</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>