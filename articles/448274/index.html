<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SMS monitoring of the weight of three hives for $ 35</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Very little time has passed since the previous publication on the system for $ 30 . 


 What has changed over the past lunar month? 


1. Added solar ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SMS monitoring of the weight of three hives for $ 35</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/getpro/habr/post_images/77d/797/12a/77d79712a55957a17ca74a0995a7844d.jpg" alt="Newbee"></p><br><p>  Very little time has passed since the previous publication <a href="https://habr.com/ru/post/444326/">on the system for $ 30</a> . </p><br><p>  What has changed over the past lunar month? </p><br><ol><li>  Added solar battery - the time is almost unlimited. </li><li>  Added sending information on the call. </li><li>  Ability to work with all types of communication modules that have fallen into my field of vision - AiThinker, Goouu tech, SIM800 / 900, Neoway M590 * </li></ol><br><p>  But the most important thing is that the communication module and the microcontroller are now physically separated, which eliminates interference in its operation with the HX711. </p><br><p>  And all this thanks to constructive criticism of habrovchan and beekeepers who have joined the discussion of the system. </p><br><p>  The remaining TTX remain the same - the maximum weight of the hives is 200kg, after sunset a measurement is made, and the indicators are sent. </p><br><p>  Anticipating criticism about the non-use of sleep modes and additional signal lines of GSM modules, I will say the following: </p><br><p>  Each communication module has its own specifics - who falls asleep at a low signal level, who is at a high level, some - by double pressing. </p><br><p>  The specifics of ‚Äúdo-it-yourself‚Äù implies some kind of creative part, which is exactly where it should be shown. </p><br><p>  I did the same system with an eye on the further development of monitoring other parameters of the hive, where sleep is not really needed. </p><br><p>  In general, in the title scheme - <del>  pure android </del>  basic system from which you can dance anywhere with the design and the number / set of sensors, modules, etc. </p><br><p>  This same article is about weights, and under the cut is my personal vision and system performance. </p><br><p>  One word - WELCOME!  GO! </p><a name="habracut"></a><br><p>  For a start, this system does not sleep ... at all, because a 6-volt two-battery solar battery, even in cloudy weather, produces 5 volts and up to one hundred milliamperes. </p><br><p>  And the consumption of the entire system is 17mA, in standby mode (in GSM1800 standard) and about thirty on GSM900. </p><br><p>  Besides, as already mentioned, this is done with an eye to implementing additional monitoring functions in real time (for example, a swarm can go out in 5 minutes) - there is no time to sleep ;-) </p><br><p>  Want absolute energy saving, so it will be in the next publication, but it will be completely different <del>  story </del>  system. </p><br><h4 id="da-esche-po-povodu-snoski-o-modulyah-svyazi---ne-to-chtoby-ya-stal-adeptom-aithinker-prosto-neoway-nuzhno-esche-samomu-sobirat-a-moduli-sim800l-trebuyut-otdelnoy-stati-s-likbezom-po-rabote-s-nimi">  * Yes, also about the footnote about communication modules - it's not that I become an adept of AiThinker, I just need to assemble Neoway myself, and SIM800L modules require a separate article on educational work with them. </h4><br><p>  In short, the selected GSM-ki - IMHO, the only ones that can work on 4 wires without additional dancing with tambourines, including power. </p><br><p>  We will need the following set of equipment / materials: </p><br><ol><li>  Arduino Pro Mini 3V <br>  Attention should be paid to the linear converter chip - it should be exactly 3.3V - on the chip of the marking KB 33 / LB 33 / DE A10 - I got the Chinese confused and the whole batch <br>  The boards in the store turned out to be 5 volt regulators and quartz at 16MHz. </li><li>  USB-Ttl on the CH340 chip - you can even 5-volt, but then during the microcontroller's firmware, the Arduino will need to be disconnected from the GSM module in order not to burn the latter. <br>  Boards on the PL2303 chip do not work under Windows 10. </li><li>  GSM communication module Goouu Tech IOT GA-6-B or AI-THINKER A-6 Mini. </li><li>  GSM GPRS "YG-01" antenna <br><img src="https://habrastorage.org/getpro/habr/post_images/ff7/aa9/69e/ff7aa969e86e53e60122bcdb2ca47c04.jpg"><br>  How they achieved such a gain is a mystery - it can be relatively complete lack of it ;-). </li><li>  The starting package of the operator with good coverage in the location of your apiary. <br>  Yes, the package must first be activated in a regular phone, DISABLE THE PIN REQUEST at the entrance, and replenish the account. </li><li>  Dupont wire 20cm mother-mother - 4 pcs.  (for connecting Arduino to USB-TTL) </li><li>  3 pcs.  HX711 - ADC for scales </li><li>  6 strain gauges for weight up to 50kg </li><li>  15 meters of 4-wire telephone cable - for connecting weight modules and GSM with ARDUINO. </li><li>  Photoresistor GL5528 (important is this, with a dark resistance of 1MŒ© and a light resistance of 10-20 kŒ©). </li><li>  two pairs of 6P6C plugs and sockets - telephone, sockets - with "tails" </li><li>  50cm double-sided tape 10mm wide - for attaching the solar battery to the GSM-module body. </li><li>  TP4056 base battery charger for LiIon batteries </li><li>  Battery holder 18650 and, in fact, the battery itself. </li><li>  A bit of wax or paraffin (candle oil burner) - for moisture protection HX711 </li><li>  A piece of wooden timber 25x50x300mm for the foundation of strain gauges. </li><li>  A dozen of self-tapping screws with a press washer of 4.2 √ó 19 mm for attaching the sensors to the base. </li><li>  Solar battery 5-6V 2W (there was no one in the next radio car - took two single-cell and a pair of 1N4148 diodes) <br><img src="https://habrastorage.org/getpro/habr/post_images/397/805/59c/39780559cbbd169641e5371eba3ec8e3.jpg" alt="Rear view of the panels"><br>  There is no reverse current through the charger, but parallel solar modules should be properly turned on through diodes </li><li>  A box for a communication module and a solar battery (size 60x100mm) - you can take a suitable distribution box from electrical goods, I had a perfect plastic from business cards 30x60x100. </li></ol><br><p>  In addition, you will need uncured hands, soldering iron EPSN-25, rosin and solder POS-60. </p><br><p>  For carpentry enough hacksaws for wood / metal, chisels and drills with a 3mm drill bit. </p><br><p>  The system layout is as follows: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d34/875/ffc/d34875ffca19e80ac4658a8e439f749e.jpg" alt="Layout"></p><br><p>  In any case, you should not have a GSM module closer than a meter from the Arduino - with a high signal power in the GSM900 standard, this may cause the microcontroller to reboot! </p><br><p>  Well, the communication module with the solar battery - should be installed on the pole - and the reception will be better, and further from the bees. </p><br><p>  Now proceed to the assembly: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/eba/218/027/eba21802786557630e811458e9a07eaa.jpg" alt="GSM A6"></p><br><p>  To begin with, we evaporate two LEDs from the GSM-module (the place where they were circled in an orange oval). </p><br><p>  We insert the SIM card with the contact pads to the printed circuit board, the bevelled corner in the photo is indicated by the arrow. </p><br><p>  Plus from the battery and the wire going to the controller it is soldered to the capacitor directly (4). </p><br><p>  The fact is that the communication module itself requires 3.4‚Äì4.2V for its power supply, and its PWR contact is wired to a step-down downconverter, therefore, to operate from a li-ion voltage, it is necessary to bypass this part of the circuit. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b89/f94/1c2/b89f941c27d96e91f2d7ec3c970e453d.jpg" alt="Arduino Pro Mini 3v"></p><br><p>  Then we carry out a similar procedure with the LED on the Arduino board (the oval to the right of the square chip). </p><br><p>  Solder the comb to the four pins (1), always horizontally - along the board. </p><br><p> The photoresistor shortens the legs to 10mm and solder it with 20 cm conductors to the GND and D2 terminals of the board (2). </p><br><p>  We supply power through a linear converter - at low current consumption, the drop-out voltage drop is 0.1V. </p><br><p>  On the other hand, by applying a stabilized voltage to the HX711 modules, we eliminate the need to modify them at a lower voltage (and, at the same time, from an increase in noise as a result of this operation). </p><br><p>  Now you need to take 5 meters of a telephone four-wire cable, and unsolder between the microcontroller and the communication module according to the diagram at the beginning of the article (the colors of the wires correspond to reality). </p><br><p>  We also solder the battery holder, everything else will be done a little later. </p><br><p>  And now we will for some time digress from the soldering iron, and move on to the program part. <br>  I will describe the sequence of actions for Windows: <br>  First, you need to download and install / unzip the <a href="https://www.arduino.cc/en/Main/Software">Arduino IDE</a> program - the current version is 1.8.9, but I use 1.6.4 </p><br><p>  For simplicity, unpack the archive in the folder C: \ arduino- "number_Your_version", inside we will have the folder / dist, drivers, examples, hardware, java, lib, libraries, reference, tools, as well as the arduino executable file (among others). </p><br><p>  Now we need a library to work with the <a href="https://github.com/bogde/HX711">HX711</a> ADC - green button "clone or download" - download ZIP. </p><br><p>  Content (folder HX711-master) is placed in the directory C: \ arduino- "number_Your_version" \ libraries </p><br><p>  Well, of course, the same driver for <a href="https://github.com/HobbyComponents/CH340-Drivers">USB-TTL</a> from the same github - from the unpacked archive, simply start the installer with the SETUP file. </p><br><p>  For those who are reluctant to mess with libraries, I packed my build of the <a href="http://zfile.in.ua/download%3Ffile%3D256e2919d32470d78e1c2add52085ec4">Arduino IDE</a> program - just download and unpack it. </p><br><p>  Run and configure the program C: \ arduino- "number_Your_version" \ arduino </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2fd/429/2d5/2fd4292d54f67c31052b54ca853be5b3.jpg" alt="Program interface"></p><br><p>  Go to "Tools" - select the "Arduino Pro or Pro Mini" board, Atmega 328 3.3V 8 MHz processor, port - number except the system COM1 (it appears after installing the CH340 driver with a USB-TTL adapter connected). </p><br><p>  Ok, copy the following sketch (program), and paste it into the Arduino IDE window </p><br><pre><code class="plaintext hljs">char phone_no[]="+123456789012"; // Your phone number that receive SMS with counry code // NeverSleep #include &lt;SoftwareSerial.h&gt; // Sofrware serial library #include "HX711.h" // HX711 lib. https://github.com/bogde/HX711 #include &lt;EEPROM.h&gt; // EEPROM lib. HX711 scale0(10, 14); HX711 scale1(11, 14); HX711 scale2(12, 14); #define SENSORCNT 3 HX711 *scale[SENSORCNT]; SoftwareSerial mySerial(5, 4); // Set I/O-port TXD, RXD of GSM-shield float delta00; // delta weight from start float delta10; float delta20; float delta01; // delta weight from yesterday float delta11; float delta21; float raw00; //raw data from sensors on first start float raw10; float raw20; float raw01; //raw data from sensors on yesterday float raw11; float raw21; float raw02; //actual raw data from sensors float raw12; float raw22; word calibrate0=20880; //calibration factor for each sensor word calibrate1=20880; word calibrate2=20880; word daynum=0; //numbers of day after start int notsunset=0; boolean setZero=false; boolean forceSend=false; char ch = 0; char ch1 = 0; char ch2 = 0; char ch3 = 0; char ch4 = 0; void readVcc() // read battery capacity { ch = mySerial.read(); while (mySerial.available() &gt; 0) { ch = mySerial.read(); } // empty input buffer from modem mySerial.println("AT+CBC?"); //ask gprs for battery status (for sim800 and neoway command must be "AT+CBC" ) delay(200); while (mySerial.available() &gt; 0) { //read input string between coma and CR ch = mySerial.read(); if (ch ==','){ ch1 = mySerial.read(); ch2 = mySerial.read(); ch3 = mySerial.read(); ch4 = mySerial.read(); } } } // ********************************************************************** void SendStat() { detachInterrupt(digitalPinToInterrupt(0)); // turn off external interrupt digitalWrite(13, HIGH); if (!forceSend){ notsunset=0; for (int i=0; i &lt;= 250; i++){ if ( !digitalRead(2) ){ notsunset++; } //is a really sunset now? you shure? delay(360); } } if ( notsunset==0 || forceSend ) { raw01=raw02; raw11=raw12; raw21=raw22; raw02=scale0.get_units(16); //read data from scales raw12=scale1.get_units(16); raw22=scale2.get_units(16); daynum++; delta00=(raw02-raw00)/calibrate0; // calculate weight changes delta01=(raw02-raw01)/calibrate0; delta10=(raw12-raw10)/calibrate1; delta11=(raw12-raw11)/calibrate1; delta20=(raw22-raw20)/calibrate2; delta21=(raw22-raw21)/calibrate2; readVcc(); delay(200); mySerial.println("AT+CMGF=1"); // Part of SMS sending delay(2000); mySerial.print("AT+CMGS=\""); mySerial.print(phone_no); mySerial.write(0x22); mySerial.write(0x0D); // hex equivalent of Carraige return mySerial.write(0x0A); // hex equivalent of newline delay(2000); mySerial.print("Turn "); mySerial.println(daynum); mySerial.print("Hive1 "); mySerial.print(delta01); mySerial.print(" "); mySerial.println(delta00); mySerial.print("Hive2 "); mySerial.print(delta11); mySerial.print(" "); mySerial.println(delta10); mySerial.print("Hive3 "); mySerial.print(delta21); mySerial.print(" "); mySerial.println(delta20); mySerial.print("Battery capacity is "); mySerial.print(ch1); mySerial.print(ch2); mySerial.print(ch3); mySerial.print(ch4); mySerial.println(" %"); if (forceSend) {mySerial.print("Forced SMS");} mySerial.println (char(26));//the ASCII code of the ctrl+z is 26 delay(3000); } forceSend=false; digitalWrite(13, LOW); attachInterrupt(0, SendStat , RISING); // Interrupt by HIGH level } // ************************************************************************************************* void switchto9600() { mySerial.begin(115200); // Open software serial port delay(16000); // wait for boot mySerial.println("AT"); delay(200); mySerial.println("AT"); delay(200); mySerial.println("AT+IPR=9600"); // Change Serial Speed delay(200); mySerial.begin(9600); mySerial.println("AT&amp;W0"); delay(200); mySerial.println("AT&amp;W"); } void setup() { // Setup part run once, at start pinMode(13, OUTPUT); // Led pin init pinMode(2, INPUT_PULLUP); // Set pullup voltage Serial.begin(9600); // ------------------------------------------------------------------------------- switchto9600(); // switch module port speed // ------------------------------------------------------------------------------- mySerial.begin(9600); delay(200); scale[0] = &amp;scale0; //init scale scale[1] = &amp;scale1; scale[2] = &amp;scale2; scale0.set_scale(); scale1.set_scale(); scale2.set_scale(); delay(200); setZero=digitalRead(2); //if (EEPROM.read(500)==EEPROM.read(501) || setZero) // first boot/reset with hiding photoresistor if (setZero) { raw00=scale0.get_units(16); //read data from scales raw10=scale1.get_units(16); raw20=scale2.get_units(16); EEPROM.put(500, raw00); //write data to eeprom EEPROM.put(504, raw10); EEPROM.put(508, raw20); for (int i = 0; i &lt;= 24; i++) { //blinking LED13 on reset/first boot digitalWrite(13, HIGH); delay(500); digitalWrite(13, LOW); delay(500); } } else { EEPROM.get(500, raw00); // read data from eeprom after battery change EEPROM.get(504, raw10); EEPROM.get(508, raw20); digitalWrite(13, HIGH); // turn on LED 13 on 12sec. delay(12000); digitalWrite(13, LOW); } delay(200); // Test SMS at initial boot readVcc(); delay(200); mySerial.println("AT+CMGF=1"); delay(2000); mySerial.print("AT+CMGS=\""); mySerial.print(phone_no); mySerial.write(0x22); mySerial.write(0x0D); // hex equivalent of Carraige return mySerial.write(0x0A); // hex equivalent of newline delay(2000); mySerial.println("INITIAL BOOT OK"); mySerial.print("Battery capacity is "); mySerial.print(ch1); mySerial.print(ch2); mySerial.print(ch3); mySerial.print(ch4); mySerial.println(" %"); mySerial.println (char(26));//the ASCII code of the ctrl+z is 26 delay(3000); raw02=raw00; raw12=raw10; raw22=raw20; attachInterrupt(0, SendStat , RISING); // Interrupt by HIGH level } void loop() { digitalWrite(13, LOW); ch=mySerial.read(); if ( ch=='R' ) { //wait first lerrer from "RING" string forceSend=true; mySerial.println("ATH"); SendStat(); ch=' '; } }</code> </pre> <br><p>  In the first line, in quotes char phone_no [] = "+ 123456789012";  - instead of 123456789012 we put our phone number with the country code, which will receive SMS. </p><br><p>  We press the check button (above the number one in the screenshot above) - if below (under the triple on the screen) "Compilation is complete" - then we can flash the microcontroller. </p><br><p>  So, USB-TTL is connected to ARDUINO and the computer (as in the photo above), we put the charged battery in the holder (usually the LED on the new arduinka blinks once a second). </p><br><p>  Now the firmware - we are training to press the red (silver) button of the microcontroller - this will need to be done strictly at a certain moment !!! </p><br><p>  There is?  We press the button "Load" (above the two in the screenshot), and carefully look at the line at the bottom of the interface (under the triple screen). </p><br><p>  As soon as the inscription "compilation" is replaced by "loading" - press the red button (reset) - if everything is ok - the lights on the USB-TTL adapter blink, and at the bottom of the interface the inscription "Loaded" </p><br><p>  While we are waiting for the arrival of the test SMS on the phone, I will tell you how the program works: </p><br><p>  The first time the system is turned on, the system checks the bytes number 500 and 501 of the EEPROM; if they are equal, then the calibration data is not recorded, and the algorithm goes to the settings section. </p><br><p>  The same happens if the photoresistor is shaded when turned on (cap from the pen) - the reset mode is activated. </p><br><p>  Strain gauges should already be installed under the hives, since we simply fix the initial level of zero and then measure the change in weight (now just zero will come, since we haven‚Äôt connected anything yet). </p><br><p>  At Arduino, the built-in LED of pin 13 will start blinking. <br>  If the reset does not occur, the LED lights up for 12 seconds. <br>  After that, a test SMS is sent with the message "INITIAL BOOT OK" and the percentage of battery charge. </p><br><p>  Further, we have an interruption on the photosensor on the second pin (the pullup plus feature is enabled by the pullup function). <br>  At the same time, after triggering another 3 minutes, the state of the photoresistor is checked - to avoid repeated / false positives. <br>  In order for the system not to reset every time it is turned on, at least the first HX711 module must be connected (pins DT-D10, SCK-A0) </p><br><p>  Then the load cell readings are taken, the weight change from the previous response (the first number in the row after Hive) and from the first start is calculated, the battery voltage is checked and this information is sent as SMS: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c63/a89/992/c63a89992a1311d828e3d9380ba45036.jpg" alt="Sample system"></p><br><p>  By the way, received SMS?  Congratulations!  We are in the middle of the road!  The battery can be removed from the holder, the computer will not be needed further. </p><br><p>  Proceed to the manufacture of sensors, for the beginning let's touch the layout of the sensors: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/182/43b/cec/18243bcecc904c4018d7b2217cc72d9b.jpg" alt="Sensor location"></p><br><p>  This is a hive plan - a top view. </p><br><p>  Classically, 4 sensors are installed in the corners (1,2,3,4) </p><br><p>  We will measure differently.  Or rather, even in the third.  Because the guys from BroodMinder do it differently: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b49/fbe/1f3/b49fbe1f378d3e5b4b7320bf6ac83520.jpg" alt="BroodMinder"></p><br><p>  In this design, the sensors are installed at positions 1 and 2, points 3.4 rely on the beam. <br>  Then the sensors account for only half the weight. <br>  Yes, this method has less accuracy, but still it is difficult to imagine that the bees build up all the frames with "tongues" from the cells along one wall of the hive. </p><br><p>  So, I propose to reduce the sensors to point 5 in general - then there is no need for shielding the system, and when using light hives, you can do just one sensor. </p><br><p>  So, for one hive, we will have two strain gauges and one HX711 module, the decoupling scheme is as follows: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6d2/39b/bef/6d239bbef099b427b0f6127a323a7e69.jpg"></p><br><p>  From the ADC board to the Arduino, there is 5 meters of a 4-wire telephone cable (in the case of modules of weight 2 and 3), the first sensor is connected with a 10 cm tail, but more on that later. </p><br><p>  In general, we leave ‚Äútails‚Äù of 8 cm on the sensors, we clean the twisted pair and we solder everything as in the photo above. </p><br><p>  Before starting the carpentry part, put the wax / paraffin in a suitable container to melt in a water bath. </p><br><p>  Now we take our timber and divide by three pieces of 100mm </p><br><p>  Next we mark the longitudinal groove 25 mm wide, 7-8 mm deep, with the help of a hacksaw and chisel we remove the excess - a U-shaped profile should come out. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/509/226/d98/509226d98d5b52f993b21c9e6679fc1a.jpg" alt="The basics"></p><br><p>  In fact, we need one N-shaped part 1 and two - P-shki, all 10 cm long. </p><br><p>  Why N-ka - do not believe it, we hide Arduino: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/096/e6b/89d/096e6b89d4442e3bf898be19dae38566.jpg" alt="miracle of hostile technology"></p><br><p>  In addition, the 6P6C sockets for connecting sensors 2 and 3 are also attached here. </p><br><p>  Is the wax warming up?  - we dip our ADC boards there - this will protect them from moisture / fog: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a57/672/7f1/a576727f1b4385933b640b0dd1ef2a01.jpg" alt="ADC protection from moisture"></p><br><p>  We place it all on a wooden base (must be treated with antiseptic from rotting): </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a57/a6b/347/a57a6b34743c1f8b8add453e729fadea.jpg" alt="Assembly"></p><br><p>  And finally, fix the sensors with self-tapping screws: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/94d/e43/541/94de435418f3d001e47b181935612e5f.jpg" alt="Ready sensor"></p><br><p>  Next, we solder all the remaining components according to the scheme in the header and common sense. </p><br><h4 id="v-plane-raspolozheniya-komponentov-zhelatelno-proyavit-fantaziyu-stoit-uchityvat-odno---rasstoyanie-mezhdu-mikrokontrollerom-i-gsm-modulem-dolzhno-sostavlyat-ne-menee-odnogo-metra">  In terms of the location of the components, it is desirable to show imagination, you should consider one thing - the distance between the microcontroller and the GSM-module must be at least one meter! </h4><br><p>  I have the same design: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/828/60b/f5a/82860bf5acb8465591e4fa82f0d284da.jpg" alt="The final"></p><br><p>  Yes, the installation angle of the panels, I took 45 degrees - because of the simplicity of manufacture, but it is close to the forty degrees that are optimal for summer at the latitude of Kiev. </p><br><p>  Everything, now for the final check, we put the sensors on sectors of the circle, on top - a piece of plywood, reset the controller (turn on the system with the pen cap on the photodiode). </p><br><p>  At the same time, the LED on arduinka should blink and test SMS should arrive. </p><br><p>  Then we remove the cap from the photocell, and go to collect water in a 6 - liter plastic bottle. <br>  We put the bottle on plywood and if several minutes have already passed from switching on, put the cap back on the photoresistor (imitating the sunset). </p><br><p>  At the same time, the Arduino LED will light up, and you should receive an SMS with weight values ‚Äã‚Äãof about 4 kg in all positions. </p><br><p>  Congratulations!  system successfully assembled! </p><br><p>  If we now make the system work again, then in the first column of weight we get zeros. </p><br><p>  Yes, in real conditions the photoresistor is desirable to be oriented vertically upwards. </p><br><p>  Now I will give a brief manual for use: </p><br><ol><li>  Install strain gauges under the rear walls of the hives (substitute a bar / board ~ 30mm thick under the front) </li><li>  Install a communication module with solar panels on an elevation, with a distance of several meters from the hives. <br>  The orientation of the solar panels - to the south - can be on a compass (we will not catch the true one). </li><li>  Shade the photoresistor and put the battery - the LED should blink and test SMS with the text "INITIAL BOOT OK" should come <br>  Every evening, after sunset, SMS will arrive with a change in weight per day and from the moment of launch. <br>  When you call the SIM-card number of the GSM module, the controller hangs up (we hear "The subscriber cannot receive the call") and an SMS arrives with extraordinary measurements. <br>  In such a message will be an additional line - "Forced SMS"; </li></ol><br><p>  Very little is left to the complete beauty of the system: </p><br><ol><li>  Add a hardware autoreset system on the photosensor. </li><li>  Check other types of communication modules. </li><li>  Do everything under the ESP-8266 - firstly, it supports updating the firmware "over the air" - it is convenient the same. </li></ol><br><p>  Secondly - it can give statistics in the form of simple web pages. <br>  And finally, if you have Wi-Fi, you can refuse GSM at all. </p><br><p>  Oh yeah, I‚Äôm tired of messing with wires, and I promised a system with "absolute" energy saving. </p><br><p>  In short, I decided to "fool around" a bit and do it all. <br>  As far as possible - read the publication in a month! </p><br><p>  See you on the pages of Habr, <br>  The Electric Beekeeper Andrei </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/448274/">https://habr.com/ru/post/448274/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448262/index.html">How to play Speedgate, the first sport created by AI</a></li>
<li><a href="../448264/index.html">Lipids cold uneasy: preventing the crystallization of water at -263 ¬∞ C</a></li>
<li><a href="../448266/index.html">Phoned! How to build your Web-dialer for an hour</a></li>
<li><a href="../448268/index.html">Box Telephone Systems</a></li>
<li><a href="../448270/index.html">Change program settings while maintaining personal settings</a></li>
<li><a href="../448276/index.html">How Alfa-Bank lives during the period of changes and what we managed to do when combining IT development and Alfa-Lab</a></li>
<li><a href="../448278/index.html">Technical mortgage: what and to whom should timlid</a></li>
<li><a href="../448280/index.html">Test drive nanoCAD SPDS Metal structures 1.2. Part 2</a></li>
<li><a href="../448286/index.html">News from the world of OpenStreetMap ‚Ññ455 (04/02/2019-08.04.2019)</a></li>
<li><a href="../448288/index.html">Using C ++ and templates with a variable number of arguments when programming microcontrollers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>