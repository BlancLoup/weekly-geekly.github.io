<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Script for obtaining information from a Windows image</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have a series of articles on the topic of servicing Windows images by the DISM system teams. In my articles, examples of scripts in the command inte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Script for obtaining information from a Windows image</h1><div class="post__text post__text-html js-mediator-article">  I have a series of articles on the topic of servicing Windows images by the <b>DISM</b> system teams.  In my articles, examples of scripts in the command interpreter language <b>cmd.exe were given</b> .  As a result of the work, the original Windows image (live system or stand-alone <i>* .wim</i> file) was changed - updates were integrated into it, system components were disabled, universal applications were removed.  But how to see the changes in the image?  In this article, I present a script that, using DISM commands, extracts various information from a Windows image and displays it to the user on the screen, or exports it to a file. <br><a name="habracut"></a><br>  This script will be useful for system administrators who create their own ‚Äúbuilds‚Äù or test others.  Sometimes it may be necessary to look at some information about the installed OS - in this case this script is also useful.  All DISM commands for obtaining information from a Windows image are implemented in this script.  Information from the image that can be obtained using this script: <br><br><ul><li>  Device driver (availability); </li><li>  Service Packs (availability); </li><li>  System components (state); </li><li>  Language support (state); </li><li>  Windows editions (state); </li><li>  Classic applications (availability); </li><li>  Universal applications (availability); </li><li>  File associations (state). </li></ul><br>  An aspect of information is indicated in brackets.  If a certain type of objects can be added or removed from the image, then the information will show the presence of objects of this type in the image.  If some property of the operating system can be switched in the image (for example, enabled / disabled), then the information will display the status of this property.  The last two items in the list are available only on OS starting with Windows 8. I called this script <i>GetWimInfo.cmd</i> , here it is: <br><br><h2>  Script </h2><br><pre><code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> Getting information from Windows image <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _file=install.wim <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _img=Online <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _mnt=mount <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _tool=<span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _word=Wim <span class="hljs-built_in"><span class="hljs-built_in">ver</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> "<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>" &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _tool=<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_tool%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _word=Image :pre_menu <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> <span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>Info /<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>File:<span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEQ</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /p _ind=Input index or press [Enter] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> quit: || <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEQ</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :ind_menu <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :pre_menu :ind_menu <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>Info /<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>File:<span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> /Index:<span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEQ</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :pre_menu choice /c abcdefghijklmnopqrstuvwxyz /n /m "Mount selected image? [m] " <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :mount <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :pre_menu :adv_menu <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_img%</span></span>==Online (<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> DISM: Online Servicing)^ <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> (dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Mounted<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>Info) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ~~~~Menu~~~~ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [d] drivers ([D] - export) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [p] packages ([P] - export) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [f] features ([F] - export) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [l] languages <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [e] editions <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [a] app <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_tool%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [x] appx ([X] - export) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_tool%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [s] <span class="hljs-built_in"><span class="hljs-built_in">assoc</span></span> ([S] - export) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> [q] quit (unmount) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- choice /c dDpPfFleaxXsSq /n /cs /m "Your choice: " <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :drivers <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :drivers-export <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :packages <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :packages-export <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :features <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :features-export <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :languages <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :editions <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :app <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_tool%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :appx) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_tool%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :appx-export) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_tool%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">assoc</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_tool%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">assoc</span></span>-export) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu) <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :unmount :drivers <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Drivers /All | <span class="hljs-built_in"><span class="hljs-built_in">more</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- choice /cb /n /m "Back [b] " <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :drivers-export <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> drivers<span class="hljs-variable"><span class="hljs-variable">%_numd%</span></span>.txt <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _numd+=<span class="hljs-number"><span class="hljs-number">1</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :drivers-export <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Getting list of drivers. Please wait... dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Drivers /All /<span class="hljs-built_in"><span class="hljs-built_in">Format</span></span>:Table &gt; drivers<span class="hljs-variable"><span class="hljs-variable">%_numd%</span></span>.txt <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :packages <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Packages | <span class="hljs-built_in"><span class="hljs-built_in">more</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- choice /cb /n /m "Back [b] " <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :packages-export <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> packages<span class="hljs-variable"><span class="hljs-variable">%_nump%</span></span>.txt <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _nump+=<span class="hljs-number"><span class="hljs-number">1</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :packages-export <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Getting list of packages. Please wait... dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Packages /<span class="hljs-built_in"><span class="hljs-built_in">Format</span></span>:Table &gt; packages<span class="hljs-variable"><span class="hljs-variable">%_nump%</span></span>.txt <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :features <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Features | <span class="hljs-built_in"><span class="hljs-built_in">more</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- choice /cb /n /m "Back [b] " <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :features-export <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> features<span class="hljs-variable"><span class="hljs-variable">%_numf%</span></span>.txt <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _numf+=<span class="hljs-number"><span class="hljs-number">1</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :features-export <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Getting list of features. Please wait... dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Features /<span class="hljs-built_in"><span class="hljs-built_in">Format</span></span>:Table &gt; features<span class="hljs-variable"><span class="hljs-variable">%_numf%</span></span>.txt <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :languages <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Intl <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- choice /cb /n /m "Back [b] " <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :editions <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-CurrentEdition <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-TargetEditions <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- choice /cb /n /m "Back [b] " <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :app <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_img%</span></span>==Online <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Apps <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-AppPatches <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- choice /cb /n /m "Back [b] " <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :appx <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-ProvisionedAppxPackages | <span class="hljs-built_in"><span class="hljs-built_in">more</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- choice /cb /n /m "Back [b] " <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :appx-export <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> appxes<span class="hljs-variable"><span class="hljs-variable">%_numx%</span></span>.txt <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _numx+=<span class="hljs-number"><span class="hljs-number">1</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :appx-export <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Getting list of appx. Please wait... dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-ProvisionedAppxPackages &gt; appxes<span class="hljs-variable"><span class="hljs-variable">%_numx%</span></span>.txt <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :<span class="hljs-built_in"><span class="hljs-built_in">assoc</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-DefaultAppAssociations | <span class="hljs-built_in"><span class="hljs-built_in">more</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- choice /cb /n /m "Back [b] " <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :<span class="hljs-built_in"><span class="hljs-built_in">assoc</span></span>-export <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> associat<span class="hljs-variable"><span class="hljs-variable">%_nums%</span></span>.txt <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _nums+=<span class="hljs-number"><span class="hljs-number">1</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">assoc</span></span>-export <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Getting list of <span class="hljs-built_in"><span class="hljs-built_in">assoc</span></span>. Please wait... dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-DefaultAppAssociations &gt; associat<span class="hljs-variable"><span class="hljs-variable">%_nums%</span></span>.txt <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :mount <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> <span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Mount-<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span> /<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>File:<span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> /Index:<span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> /MountDir:<span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> /ReadOnly <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEQ</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">rd</span></span> <span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _img=Image:<span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :adv_menu :unmount <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> <span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-variable"><span class="hljs-variable">%_img%</span></span>==Online ( dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Unmount-<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span> /MountDir:<span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> /Discard <span class="hljs-built_in"><span class="hljs-built_in">rd</span></span> <span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _img=Online <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :pre_menu</code> </pre> <br><h2>  Using </h2><br>  If the startup folder of the script contains an autonomous Windows operating system image - <i>install.wim</i> , then information about the available indexes is requested from it and the user is prompted to enter the number with which the work will be performed.  In the next submenu of the selected index, the extended information is displayed and the user is prompted to mount this image to continue.  After the image is mounted, the main script menu is displayed on the screen.  If there is no <i>install.wim</i> file in the script launch folder, then immediately go to the main menu, and information requests will be sent to the current OS.  Working with the main menu is very simple - just press the corresponding key to display information on the screen.  For some items, the amount of data may be large, so items have been added for exporting information to the created text file in the script launch folder.  Export to file is an uppercase letter. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Parsing code </h2><br><blockquote>  At first, the set command sets the variables.  You can change the estimated name of the install.wim image file (for example, to install.esd).  You can change the name of the mount folder (by default, mount) or set the path if the mount folder should be outside of the launch folder. </blockquote>  Also, at first, the OS version on which the script is launched is determined, by logic - if not Windows 7, then something newer.  Based on this, it is concluded which version of the DISM system will accept script commands, which affects the accessibility of the last two menu items. <br><br><h3>  : pre_menu </h3><br><blockquote>  Preliminary menu.  Getting basic information about wim file with error checking.  If there is no image file, then run in online mode. </blockquote><br><h3>  : ind_menu </h3><br><blockquote>  Index menu.  Obtaining extended information about the selected "index" in a wim file with error control.  Offer to mount the "index". </blockquote><br><h3>  : adv_menu </h3><br>  The main (extended) menu script.  After pressing the key corresponding to the selected item, a transition takes place to the corresponding label in the script body, then following the required commands and returning to this menu.  All items display information on the screen of the same type and include some command DISM.  No need to disassemble them.  Than the display of information on the screen of greater interest is the export to a text file.  Information is recorded in tabular form, which is convenient for perception and comparison.  For each type of information - a text file with a specific name.  Repeated export on some item does not replace the file, but creates a new one, adding a numeric index to the name.  This is useful when collecting information from several different image indices, for example. <br><br><h3>  : mount </h3><br><blockquote>  Mounting image  Pre-created mount folder.  Error control.  The variable defining the specification of the image changes, now points to the path to the autonomous image. </blockquote>  I also note that the mount is performed in the <i>/ ReadOnly</i> mode, which means that it is not possible to make any changes to the image, including the dates and attributes of the image file. <br><br><h3>  : unmount </h3><br><blockquote>  Unmounting an image.  If online maintenance was performed (/ Online), then it is not necessary to unmount it.  Return of variables to initial values. </blockquote><br>  Unmount with the <i>/ Discard</i> key, since the mount was read-only.  Missing key is unacceptable. <br><br><h2>  Conclusion </h2><br>  This script is a logical addition to the collection of scripts presented by me in previous articles.  Although, in truth, all this was written more than three months ago, and this script was my first.  Just gradually open the cards.  Of course, many system administrators have long written such solutions for themselves and each has its own.  Other people's work seemed uncomfortable, in some cases cumbersome.  Someone tried to implement all the capabilities of the DISM system in one ‚Äúmega‚Äù script, I decided to make several scripts, each for a specific task.  Probably not very good that some code is repeated, because when implementing some ideas and / or correcting errors, I had to edit all the files at once.  Advertisers PowerShell pass by.  I wrote this script for myself and decided to share it with you the way it is.  I hope it will be useful to many - both for work and as an example in study. </div><p>Source: <a href="https://habr.com/ru/post/349894/">https://habr.com/ru/post/349894/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349876/index.html">Three ways to update a query in Jira from ScriptRunner using the Jira Java API</a></li>
<li><a href="../349880/index.html">Vue.js + Asp.NETCore + TypeScript application without Webpack</a></li>
<li><a href="../349886/index.html">Quick interactive layout of the hall on canvas</a></li>
<li><a href="../349888/index.html">The digest of interesting materials for the mobile developer # 242 (February 19 - February 25)</a></li>
<li><a href="../349890/index.html">We receive the list of passengers of flights of the largest air carrier of Ukraine</a></li>
<li><a href="../349900/index.html">Creating a Telegram bot to get information on the Dogecoin wallet</a></li>
<li><a href="../349902/index.html">"Digital States": how it all began</a></li>
<li><a href="../349904/index.html">GLPI in a small organization, part 2. Basic functionality and features of its use</a></li>
<li><a href="../349906/index.html">Setting up VoIP FXO gateway Yeastar Neogate TAXXX to work with 3CX</a></li>
<li><a href="../349908/index.html">How to learn to learn. Part 3 - we train memory "on a science"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>