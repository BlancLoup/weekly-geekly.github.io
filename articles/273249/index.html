<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to get to the president's cottage at five o'clock in the morning</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This post is about how the usual break-in turned into torments of conscience and mental agony. Source will not be much more pictures and analysis. So,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to get to the president's cottage at five o'clock in the morning</h1><div class="post__text post__text-html js-mediator-article">  This post is about how the usual break-in turned into torments of conscience and mental agony.  Source will not be much more pictures and analysis.  So, someone Vasya works as a ‚Äúbad guy.‚Äù  The extent of Vasya‚Äôs fall is such that the means for living are brought to him by the search and analysis of information, access to which has been compromised due to illiterate maintenance, disorder or savings on maintenance personnel. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5fe/7c9/bd4/5fe7c9bd4ec86e237035d97dabc4f2bc.png"><br><a name="habracut"></a><br>  This has been the case since the emergence of the group where Vasya spends most of the time, his profile is the analysis of the extracted data and the compilation of some feedback, if requested by the person concerned. <br><br><h4>  Moscow day </h4><br>  The usual Moscow morning, office basement, coffee, Vasya and his friends are discussing a new order from an old acquaintance.  Everything is standard, you need to get info, all you can reach.  Addresses, sites, residences of staff, pages in social networks, etc.  obtained in advance, and the more information the buyer collects in advance, the faster and better the result will be.  The experimental company turned out to be from the northern capital, without a website (these are still fully available in Mother Russia) and supplies some (which will be disassembled below) equipment, the office seems to have collapsed, but is still agonizing, and someone Mr. X wants to get the remnants of the data development.  The youngest went on a business trip, for qualifications, in order to listen for wifi traffic for passwords, turnovers, links and other information, you don‚Äôt need much. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result of these studies, secret words were obtained to the post office, then it was revealed from the correspondence that a Dedik who was standing in the experimental subject was leased for storage.  The server is sometimes remotely administrated from outside, the old ubunt 12.04 LTS version is spinning on it (this is about saving on equipment and staff).  We scanned for vulnerabilities, access via ssh is configured only for specific ip (quite competently), a dozen ports are open, including 21 (FTP), 39, 41 and 95, several holes were found, the server surrendered to CVE-2014-0196 vulnerability , through it they raised the root from the third attempt, twice the server fell, but no one even moved to find out what was wrong.  We searched for everything that looked like source code, documentation, etc.  We went in, looked around, reaped the harvest, cleaned it, checked it, cleaned it again, left. <br><br><h4>  We continue to dig </h4><br>  Looking through the merged directories, the folders <s>Confluence, Repositories and Secrets</s> were found with all sorts of garbage and a couple of uninteresting backups, the total amount of data a little more than 70 gigs.  The Secrets folder, as well as the backups, contained "soft pink stuffing" from the data, photos, scraps of the text - it feels like having gone through a shredder.  We open ‚ÄúRepositories‚Äù as the most interesting candidate for the study: there was a bunch of SVN repositories created between 2006 and 2013.  Those folders that Vasya unpacked differ in creation dates from the main archive. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dc1/f5d/ce2/dc1f5dce2cb1dbcfe8da8155a7244c21.png"><br><br>  The fishing was a success - here it is ‚ÄúIde‚Äù programmer: a bunch of sorts from a private repository, obtained in ‚Äúsleepless nights‚Äù.  Vasya rummaging through folders, simultaneously asking Google for some names, most of the requests the latter responds with <s>advertising with</s> incoherent muttering, but for some - with very specific events and coordinates: <br><br>  - moskva_postanovka: well, here it is clear that something was put in the capital; <br>  - sochi_bruche_postanovka: Google doesn't know what sochi_bruche is, but it will answer the question ‚Äúsochi b ruche‚Äù.  You can look; <br>  - sosnbor_aes_postanovka: here google gave the answer on such a change as ‚Äúpine bore aus staging‚Äù; <br>  - valdai_rosino_postanovka: again hit the first time - ‚ÄúValdai Grove staging‚Äù; <br>  - volgodonsk_aes_postanovka: well, here and a hedgehog is clear, something was put on the Volgodonsk nuclear power plant, Vasya served there in his youth and was familiar with firsthand knowledge of places. <br><br>  Apparently, serious guys, it's time to see what kind of fish got into our nets.  And yes, Vasya, like an old sishnik, is very jarred by the Russian transliteration in the source code (sarcasm). <br><br><h4>  "Moskva_postanovka_r" </h4><br>  We look turnips - mother of God, who writes so?  Sortsy mixed with temporary files and objectists, apparently, the developer is (was at the time of 2008) on the first courses of the institute ... stop, student-developer of a large soft?  Are you seriously? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e25/fa8/17d/e25fa817df24dfb2fe481a3aeb47406e.png"><br><br>  Removing temporary files we get the following picture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3d6/812/c99/3d6812c9945b7d618ed0c4a0bd60615c.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f48/363/e00/f48363e0041cefbc1ac1ae1546d12b65.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/88f/38c/aad/88f38caad2268f1a5981dde61adb19a4.png"><br><br>  In the <b>Capture</b> folder, the picture strayed on September 30, 2008. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/def/ccb/a21/defccba21256771e83bb5199ef6ceaa4.jpg"><br><br>  It looks like a picture from Google maps.  The distinctive features of this place are the location near the water, and the unusual shape of the embankment.  Further search on the gold-headed map led to the following result: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c8/197/9da/1c81979dabed9b757b55281bd4b6cfbe.jpg"><br><br><h4>  "Dig further" </h4><br>  A dock was also found in the repository, explaining why the program was made and what the product actually was, Vasya received. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b3/086/335/9b3086335aba6dc60798c64ab19f3b65.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/098/097/767/09809776714749f8c302373a4435615c.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e12/6d8/94a/e126d894aea47fd5df3eb02e5af56782.png"><br><br><h4>  "Easter eggs" </h4><br>  Having figured out the exemplary purpose of the program, Vasya began to study the source code more closely in search of something unusual.  After all, everyone knows that developers who are not burdened with corporate etiquette can insert something to entertain themselves.  What search criteria were asked?  First of all, comments like: ‚ÄúWTF, TODO, f * ck and other funny words‚Äù were sought.  And the attempts were rewarded on the third day of Zen contemplation: the following pieces of code were found: <br><br>  1. Protection against bosses (UMainForm.cpp file): <br><br>  If either the one with the special name in the Windows folder is not found, the program will issue the following warning: ‚ÄúOAO NPP‚Äú XXX ‚Äùdid not pay for the development of this application!  The application will be closed! ‚Äù <br><br>  Funny warning, apparently calculated on the chief-fool. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b95/8c9/940/b958c99403c51bb2b0cebd5916df5a2b.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/074/937/f17/074937f17b025cdba245038a4a03d4de.png"><br><br>  2. Border on the lock (file UBChannel.cpp). <br><br>  This section of the code in the period from 5.00 to 5.30 in the morning, apparently, sends further to the program with random instead of real data received from the equipment. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3fd/dac/195/3fddac19500818ed5eea98da7c8b4bc4.png"><br><br>  3. Black hole (UBsoDevice.cpp file). <br><br>  A third suspicious site has been identified here.  If the network address of the machine is set to 192.168.88.88, then the incoming information is not sent further (tab / test machine?). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ee3/9c6/4b8/ee39c64b88fc5a6342f65702e9b7b96a.png"><br><br><h4>  What is worth (presumably) </h4><br>  A Google search yields the following results for the queries of ‚ÄúGUPO, Tral M, Gals, Nerpa M, NPP XXX‚Äù. <br><br>  The software described in the repository serves this equipment: <a href="http://tetis-ks.ru/catalog/229/1211/">one</a> , <a href="http://www.oborudunion.ru/i_store/item_1000618037/gidroakusticheskoe-ustroystvo-podvodnoy-ohrany-gupo-tral-m.html">two</a> , you can read more <a href="http://www.arms-expo.ru/armament/samples/1111/59676/">here</a> . <br><br>  The next page indirectly confirms the correctness of the compromised information - <a href="http://tetis-ks.ru/catalog/229/">three</a> , in the repository there are also folders with the names " <s>nerpa-m, nerpau, nerpa-sdp, nerpa_vs, nerpa_sc</s> ".  Vasya did not study them, so we will not dwell on them, but the programming style is similar.  It also indicates on the site that the service life of these products is at least 10 years, i.e.  if the programs were delivered in 2008, then they still work and, perhaps, the same leaky ones (either these are program bookmarks, or test lines were not commented out before production). <br><br><h4>  Where it is (presumably) </h4><br>  Having a little rummaged in repositories, it was possible to find out the following habitats of this masterpiece by the programmer of thought. <br><br>  1. Valdai (presumably a rest house in Roshchino, near a government facility; <br>  2. Kalinin NPP; <br>  3. Leningrad NPP; <br><br><img src="https://habrastorage.org/getpro/habr/post_images/497/0a2/20a/4970a220a82f5b33f8bf91fab91e24e7.png"><br><br>  4. Sochi (presumably the rest house "Bocharov Ruchey", near a government facility, allegedly a government dacha); <br>  5. Moscow (presumably the House of the Moscow Region Government); <br>  6. Volgondos NPP. <br><br>  Presumably a general list of device installation locations: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/011/971/8e1/0119718e19c50eaa4bf0dfdf5d260dc7.png"><br><br><h4>  The truth of life </h4><br>  After scoring the number of desired buns, the interested person somehow disappeared from the field of vision, leaving Vasya in deep thoughts about the meaning of being in the modern world and the prices for the operating system that grow without measure.  At the general council, it was decided to point out unlucky admins to security flaws, indicating the methods of their possible remediation.  Also, a letter was sent to the head of OAO NPP XXX with a description of the vulnerabilities found.  As usual, a two-week interval was given before the publication of the written article, but Vasya‚Äôs reply came somewhat discouraged, with some remarks (the audience is still cultural): <br><br>  ‚ÄúListen to me [az] deeply to me deeply [b] th as you received or sleep [n] dil this information.  You have no idea what kind of r [ya] but he has run into and if anyone else finds out about this, the whole country will look for you, and I personally [will punish you]. ‚ÄùPunctuation is left unchanged. <br><br><h4>  Epilogue </h4><br>  At the general council, it was decided to publish some of the information in the form of this article, while not merging the Sortsy into the Internet, although supporters show the world "this" almost won. <br><br>  Vasya, of course, deleted the sorts, and forgot everything he saw and dug out.  It‚Äôs a shame only if the software for the army and sensitive objects is written by [students] low-professional programmers, having managed to cram a couple of bookmarks, and then the inadequate and rude people who hired them sell it for considerable sums to the state.  According to information from specialized forums, the cost of such equipment for the army and other departments is several million wooden.  I hope that the manufacturer has eliminated the existing vulnerabilities, but who guarantees that there are no others, not such obvious ones? <br><br>  PS: At the time of this writing, a server without any problems is scanned with old holes.  Rip. <br><br><h4>  Sources </h4><br>  UBChannel.cpp - <a href="http://pastebin.com/xnA9p80F">pastebin.com/xnA9p80F</a> <br>  UKernel.cpp - <a href="http://pastebin.com/7AZpqkRX">pastebin.com/7AZpqkRX</a> <br>  UMainForm.cpp - <a href="http://pastebin.com/PJgdKGcY">pastebin.com/PJgdKGcY</a> </div><p>Source: <a href="https://habr.com/ru/post/273249/">https://habr.com/ru/post/273249/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273237/index.html">Robot seller. Automating your sales team with SaaS</a></li>
<li><a href="../273241/index.html">We study the graph-oriented DBMS Neo4j on the example of the lexical database Wordnet</a></li>
<li><a href="../273243/index.html">7 errors of the ETL developer</a></li>
<li><a href="../273245/index.html">Announcement of the JPoint 2016 Java Conference</a></li>
<li><a href="../273247/index.html">We are testing the Russian E-Class server platform from T-Platforms</a></li>
<li><a href="../273251/index.html">DaData.ru finds and destroys the same people.</a></li>
<li><a href="../273253/index.html">Parsing formulas in 50 lines in Python</a></li>
<li><a href="../273255/index.html">Adding packages to the standalone installer Lubuntu Alternate ISO</a></li>
<li><a href="../273257/index.html">Best-in-class system Infortrend EonStor DS 4000 Gen2. Ultra High Performance Storage</a></li>
<li><a href="../273259/index.html">PHP vs Node.js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>