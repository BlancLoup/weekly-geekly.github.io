<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dagaz: Kicks to common sense (part 8)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- To begin with, you have to understand the main thing ... 
 - What is the main thing? 
 - There is no spoon! 

 " Matrix " 
 

 As I have said many t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dagaz: Kicks to common sense (part 8)</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/43e/794/3a3/43e7943a3e289a281570ab8b68d347b8.png" alt="image">  <i><b>- To begin with, you have to understand the main thing ...</b></i> <i><b><br></b></i>  <i><b>- What is the main thing?</b></i> <i><b><br></b></i>  <i><b>- There is no spoon!</b></i> <i><b><br><br></b></i>  <i><b>" <a href="http://www.kinopoisk.ru/film/301/">Matrix</a> "</b></i> <i><b><br></b></i> <br><br>  As I have said many times <a href="http://habrahabr.ru/post/258437/">before</a> , it is simply impossible to implement some things in <a href="http://www.zillions-of-games.com/">Zillions of Games</a> .  However, if you can not, but really want, then sometimes it is still possible.  How far can you go this way? <br><a name="habracut"></a><br><h4>  <b>3. All deception</b> </h4><br>  We have already encountered this.  ZoG does not allow to determine the moves, limited to the removal of pieces from the board?  No problem - let's create a move that <b>drops a</b> piece onto the board and immediately deletes it (as a result, the piece located on the target field will be deleted automatically).  In this way, you can create "buttons", expanding the ZoG interface capabilities (although, in fact, no these are not buttons, but simply special pieces on the board).  Does ZoG limit board dimension to five dimensions?  Too no trouble! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Create the missing positions and manually link them.</b> <div class="spoiler_text"><pre><code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>D (<span class="hljs-name"><span class="hljs-name">image</span></span> <span class="hljs-string"><span class="hljs-string">"images\6DChess\6DChess.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">grid</span></span> (<span class="hljs-name"><span class="hljs-name">start-rectangle</span></span> <span class="hljs-number"><span class="hljs-number">34</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">76</span></span> <span class="hljs-number"><span class="hljs-number">53</span></span>) (<span class="hljs-name"><span class="hljs-name">dimensions</span></span> <span class="hljs-comment"><span class="hljs-comment">; 2x2x2x2x2 ("Zii/Zi" (0 148)) ; 5D ("A/B" (162 0)) ; 4D ("II/I" (0 68)) ; 3D ("a/b" (66 0)) ; columns ("2/1" (31 19))) ; rows offset 31 (directions (n 0 0 0 0 -1) (s 0 0 0 0 1) (e 0 0 0 1 0) (w 0 0 0 -1 0) (u 0 0 -1 0 0) (d 0 0 1 0 0) (4e 0 1 0 0 0) (4w 0 -1 0 0 0) (5u -1 0 0 0 0) (5d 1 0 0 0 0))) (positions ; 6D (YiAIa1 413 241 445 287) (YiAIa2 383 223 415 269) (YiAIb1 477 241 509 287) (YiAIb2 448 223 480 269) (YiAIIa1 413 175 445 221) (YiAIIa2 383 155 415 201) (YiAIIb1 477 175 509 221) (YiAIIb2 448 155 480 201) (YiBIa1 577 241 609 287) (YiBIa2 547 223 579 269) (YiBIb1 641 241 673 287) (YiBIb2 609 223 642 269) (YiBIIa1 577 175 609 221) (YiBIIa2 547 155 579 201) (YiBIIb1 641 175 673 221) (YiBIIb2 609 155 642 201) (YiiAIa1 413 95 445 141) (YiiAIa2 383 76 415 122) (YiiAIb1 477 95 509 141) (YiiAIb2 448 76 480 122) (YiiAIIa1 413 26 445 72) (YiiAIIa2 383 7 415 53) (YiiAIIb1 477 26 509 72) (YiiAIIb2 448 7 480 53) (YiiBIa1 577 95 609 141) (YiiBIa2 547 76 579 122) (YiiBIb1 641 95 673 141) (YiiBIb2 609 76 642 122) (YiiBIIa1 577 26 609 72) (YiiBIIa2 547 8 579 54) (YiiBIIb1 641 26 673 72) (YiiBIIb2 609 8 642 54) ) (links n (YiAIa1 YiAIa2) (YiAIb1 YiAIb2) (YiAIIa1 YiAIIa2) (YiAIIb1 YiAIIb2) (YiBIa1 YiBIa2) (YiBIb1 YiBIb2) (YiBIIa1 YiBIIa2) (YiBIIb1 YiBIIb2) (YiiAIa1 YiiAIa2) (YiiAIb1 YiiAIb2) (YiiAIIa1 YiiAIIa2) (YiiAIIb1 YiiAIIb2) (YiiBIa1 YiiBIa2) (YiiBIb1 YiiBIb2) (YiiBIIa1 YiiBIIa2) (YiiBIIb1 YiiBIIb2)) (links s (YiAIa2 YiAIa1) (YiAIb2 YiAIb1) (YiAIIa2 YiAIIa1) (YiAIIb2 YiAIIb1) (YiBIa2 YiBIa1) (YiBIb2 YiBIb1) (YiBIIa2 YiBIIa1) (YiBIIb2 YiBIIb1) (YiiAIa2 YiiAIa1) (YiiAIb2 YiiAIb1) (YiiAIIa2 YiiAIIa1) (YiiAIIb2 YiiAIIb1) (YiiBIa2 YiiBIa1) (YiiBIb2 YiiBIb1) (YiiBIIa2 YiiBIIa1) (YiiBIIb2 YiiBIIb1)) (links e (YiAIa1 YiAIb1) (YiAIa2 YiAIb2) (YiAIIa1 YiAIIb1) (YiAIIa2 YiAIIb2) (YiBIa1 YiBIb1) (YiBIa2 YiBIb2) (YiBIIa1 YiBIIb1) (YiBIIa2 YiBIIb2) (YiiAIa1 YiiAIb1) (YiiAIa2 YiiAIb2) (YiiAIIa1 YiiAIIb1) (YiiAIIa2 YiiAIIb2) (YiiBIa1 YiiBIb1) (YiiBIa2 YiiBIb2) (YiiBIIa1 YiiBIIb1) (YiiBIIa2 YiiBIIb2)) (links w (YiAIb1 YiAIa1) (YiAIb2 YiAIa2) (YiAIIb1 YiAIIa1) (YiAIIb2 YiAIIa2) (YiBIb1 YiBIa1) (YiBIb2 YiBIa2) (YiBIIb1 YiBIIa1) (YiBIIb2 YiBIIa2) (YiiAIb1 YiiAIa1) (YiiAIb2 YiiAIa2) (YiiAIIb1 YiiAIIa1) (YiiAIIb2 YiiAIIa2) (YiiBIb1 YiiBIa1) (YiiBIb2 YiiBIa2) (YiiBIIb1 YiiBIIa1) (YiiBIIb2 YiiBIIa2)) (links u (YiAIa1 YiAIIa1) (YiAIa2 YiAIIa2) (YiAIb1 YiAIIb1) (YiAIb2 YiAIIb2) (YiBIa1 YiBIIa1) (YiBIa2 YiBIIa2) (YiBIb1 YiBIIb1) (YiBIb2 YiBIIb2) (YiiAIa1 YiiAIIa1) (YiiAIa2 YiiAIIa2) (YiiAIb1 YiiAIIb1) (YiiAIb2 YiiAIIb2) (YiiBIa1 YiiBIIa1) (YiiBIa2 YiiBIIa2) (YiiBIb1 YiiBIIb1) (YiiBIb2 YiiBIIb2)) (links d (YiAIIa1 YiAIa1) (YiAIIa2 YiAIa2) (YiAIIb1 YiAIb1) (YiAIIb2 YiAIb2) (YiBIIa1 YiBIa1) (YiBIIa2 YiBIa2) (YiBIIb1 YiBIb1) (YiBIIb2 YiBIb2) (YiiAIIa1 YiiAIa1) (YiiAIIa2 YiiAIa2) (YiiAIIb1 YiiAIb1) (YiiAIIb2 YiiAIb2) (YiiBIIa1 YiiBIa1) (YiiBIIa2 YiiBIa2) (YiiBIIb1 YiiBIb1) (YiiBIIb2 YiiBIb2)) (links 4e (YiAIa1 YiBIa1) (YiAIa2 YiBIa2) (YiAIb1 YiBIb1) (YiAIb2 YiBIb2) (YiAIIa1 YiBIIa1) (YiAIIa2 YiBIIa2) (YiAIIb1 YiBIIb1) (YiAIIb2 YiBIIb2) (YiiAIa1 YiiBIa1) (YiiAIa2 YiiBIa2) (YiiAIb1 YiiBIb1) (YiiAIb2 YiiBIb2) (YiiAIIa1 YiiBIIa1) (YiiAIIa2 YiiBIIa2) (YiiAIIb1 YiiBIIb1) (YiiAIIb2 YiiBIIb2)) (links 4w (YiBIa1 YiAIa1) (YiBIa2 YiAIa2) (YiBIb1 YiAIb1) (YiBIb2 YiAIb2) (YiBIIa1 YiAIIa1) (YiBIIa2 YiAIIa2) (YiBIIb1 YiAIIb1) (YiBIIb2 YiAIIb2) (YiiBIa1 YiiAIa1) (YiiBIa2 YiiAIa2) (YiiBIb1 YiiAIb1) (YiiBIb2 YiiAIb2) (YiiBIIa1 YiiAIIa1) (YiiBIIa2 YiiAIIa2) (YiiBIIb1 YiiAIIb1) (YiiBIIb2 YiiAIIb2)) (links 5u (YiAIa1 YiiAIa1) (YiAIa2 YiiAIa2) (YiAIb1 YiiAIb1) (YiAIb2 YiiAIb2) (YiAIIa1 YiiAIIa1) (YiAIIa2 YiiAIIa2) (YiAIIb1 YiiAIIb1) (YiAIIb2 YiiAIIb2) (YiBIa1 YiiBIa1) (YiBIa2 YiiBIa2) (YiBIb1 YiiBIb1) (YiBIb2 YiiBIb2) (YiBIIa1 YiiBIIa1) (YiBIIa2 YiiBIIa2) (YiBIIb1 YiiBIIb1) (YiBIIb2 YiiBIIb2)) (links 5d (YiiAIa1 YiAIa1) (YiiAIa2 YiAIa2) (YiiAIb1 YiAIb1) (YiiAIb2 YiAIb2) (YiiAIIa1 YiAIIa1) (YiiAIIa2 YiAIIa2) (YiiAIIb1 YiAIIb1) (YiiAIIb2 YiAIIb2) (YiiBIa1 YiBIa1) (YiiBIa2 YiBIa2) (YiiBIb1 YiBIb1) (YiiBIb2 YiBIb2) (YiiBIIa1 YiBIIa1) (YiiBIIa2 YiBIIa2) (YiiBIIb1 YiBIIb1) (YiiBIIb2 YiBIIb2)) (links 6e (ZiAIa1 YiAIa1) (ZiAIa2 YiAIa2) (ZiAIb1 YiAIb1) (ZiAIb2 YiAIb2) (ZiAIIa1 YiAIIa1) (ZiAIIa2 YiAIIa2) (ZiAIIb1 YiAIIb1) (ZiAIIb2 YiAIIb2) (ZiBIa1 YiBIa1) (ZiBIa2 YiBIa2) (ZiBIb1 YiBIb1) (ZiBIb2 YiBIb2) (ZiBIIa1 YiBIIa1) (ZiBIIa2 YiBIIa2) (ZiBIIb1 YiBIIb1) (ZiBIIb2 YiBIIb2) (ZiiAIa1 YiiAIa1) (ZiiAIa2 YiiAIa2) (ZiiAIb1 YiiAIb1) (ZiiAIb2 YiiAIb2) (ZiiAIIa1 YiiAIIa1) (ZiiAIIa2 YiiAIIa2) (ZiiAIIb1 YiiAIIb1) (ZiiAIIb2 YiiAIIb2) (ZiiBIa1 YiiBIa1) (ZiiBIa2 YiiBIa2) (ZiiBIb1 YiiBIb1) (ZiiBIb2 YiiBIb2) (ZiiBIIa1 YiiBIIa1) (ZiiBIIa2 YiiBIIa2) (ZiiBIIb1 YiiBIIb1) (ZiiBIIb2 YiiBIIb2)) (links 6w (YiAIa1 ZiAIa1) (YiAIa2 ZiAIa2) (YiAIb1 ZiAIb1) (YiAIb2 ZiAIb2) (YiAIIa1 ZiAIIa1) (YiAIIa2 ZiAIIa2) (YiAIIb1 ZiAIIb1) (YiAIIb2 ZiAIIb2) (YiBIa1 ZiBIa1) (YiBIa2 ZiBIa2) (YiBIb1 ZiBIb1) (YiBIb2 ZiBIb2) (YiBIIa1 ZiBIIa1) (YiBIIa2 ZiBIIa2) (YiBIIb1 ZiBIIb1) (YiBIIb2 ZiBIIb2) (YiiAIa1 ZiiAIa1) (YiiAIa2 ZiiAIa2) (YiiAIb1 ZiiAIb1) (YiiAIb2 ZiiAIb2) (YiiAIIa1 ZiiAIIa1) (YiiAIIa2 ZiiAIIa2) (YiiAIIb1 ZiiAIIb1) (YiiAIIb2 ZiiAIIb2) (YiiBIa1 ZiiBIa1) (YiiBIa2 ZiiBIa2) (YiiBIb1 ZiiBIb1) (YiiBIb2 ZiiBIb2) (YiiBIIa1 ZiiBIIa1) (YiiBIIa2 ZiiBIIa2) (YiiBIIb1 ZiiBIIb1) (YiiBIIb2 ZiiBIIb2)) (symmetry Black (ns) (sn) (ud) (du) (4e 4w) (4w 4e) (5u 5d) (5d 5u) (6e 6w) (6w 6e)) (zone (name promotion-zone) (players White) (positions YiiAIIa2 YiiAIIb2 YiiBIIa2 YiiBIIb2)) (zone (name promotion-zone) (players Black) (positions ZiAIa1 ZiAIb1 ZiBIa1 ZiBIb1)) )</span></span></code> </pre> <br></div></div><br>  Looks scary?  But it <a href="http://zillions-of-games.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D858">works</a> ! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/005/0a2/194/0050a21947814283b4ac0dbc558db5d2.png"></div><br><br>  A little cheating, <a href="http://zillions-of-games.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D376">you can</a> define the hexagonal boards: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/acb/b6d/294/acbb6d294887466a95c061ca62f7a5e8.png"></div><br><br><div class="spoiler">  <b class="spoiler_title">It's all the same two-dimensional grid whose rows are shifted relative to each other.</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> Board-Definitions (<span class="hljs-name"><span class="hljs-name">image</span></span> <span class="hljs-string"><span class="hljs-string">"Images\6Chess.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">grid</span></span> (<span class="hljs-name"><span class="hljs-name">start-rectangle</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">-79</span></span> <span class="hljs-number"><span class="hljs-number">69</span></span> <span class="hljs-number"><span class="hljs-number">-31</span></span>) (<span class="hljs-name"><span class="hljs-name">dimensions</span></span> (<span class="hljs-string"><span class="hljs-string">"a/b/c/d/e/f/g/h/i"</span></span> (<span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span>)) <span class="hljs-comment"><span class="hljs-comment">; files ("10/9/8/7/6/5/4/3/2/1" (0 44)) ; ranks ) (directions (z0 0 -1) (z1 1 -2) (z2 1 -1) (z3 2 -1) (z4 1 0) (z5 1 1) (z6 0 1) (z7 -1 2) (z8 -1 1) (z9 -2 1) (zx -1 0) (zy -1 -1) ) ) (kill-positions a7 a8 a9 a10 b8 b9 b10 c9 c10 d10 f1 g1 g2 h1 h2 h3 i1 i2 i3 i4) (symmetry Black (z0 z6)(z6 z0) (z1 z7)(z7 z1) (z2 z8)(z8 z2) (z3 z9)(z9 z3) (zx z4)(z4 zx) (zy z5)(z5 zy) ) (zone (name promotion-zone) (players White) (positions a6 b7 c8 d9 e10 f10 g10 h10 i10) ) (zone (name promotion-zone) (players Black) (positions a1 b1 c1 d1 e1 f2 g3 h4 i5) ) (zone (name fast-through) (players White) (positions b3 c3 d3 e3 f4 g5 h6) ) (zone (name fast-through) (players Black) (positions b5 c6 d7 e8 f8 g8 h8) ) (zone (name faster-through) (players White) (positions d4 e4 f5) ) (zone (name faster-through) (players Black) (positions d6 e7 f7) ) )</span></span></code> </pre><br></div></div><br>  <a href="http://zillions-of-games.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D712">You can</a> move parts of the board, along with the figures on them! <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/au93TWncKBw%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjzqsEejeWjMYc5oD1MD6RAZpBleA" frameborder="0" allowfullscreen=""></iframe><br><br>  It is really easy. <br><br><div class="spoiler">  <b class="spoiler_title">In fact, there are two boards</b> <div class="spoiler_text"><pre> <code class="lisp hljs"> (<span class="hljs-name"><span class="hljs-name">board</span></span> (<span class="hljs-name"><span class="hljs-name">image</span></span> <span class="hljs-string"><span class="hljs-string">"Images\PlatformChess\Void8x8.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">grid</span></span> (<span class="hljs-name"><span class="hljs-name">start-rectangle</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">48</span></span> <span class="hljs-number"><span class="hljs-number">48</span></span>) (<span class="hljs-name"><span class="hljs-name">dimensions</span></span> (<span class="hljs-string"><span class="hljs-string">"a/b/c/d/e/f/g/h"</span></span> (<span class="hljs-number"><span class="hljs-number">49</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-comment"><span class="hljs-comment">; files ("8/7/6/5/4/3/2/1" (0 49)) ; ranks ) (directions (n 0 -1) (e 1 0) (s 0 1) (w -1 0) (ne 1 -1) (nw -1 -1) (se 1 1) (sw -1 1) ) ) (grid (start-rectangle 5 5 103 103) (dimensions ("A/B/C/D" (98 0)) ; grid files ("4/3/2/1" (0 98)) ;grid ranks ) (directions (n 0 -1) (e 1 0) (w -1 0) (s 0 1))) (links up (A1 a2) (A2 a4) (A3 a6) (A4 a8) (B1 c2) (B2 c4) (B3 c6) (B4 c8) (C1 e2) (C2 e4) (C3 e6) (C4 e8) (D1 g2) (D2 g4) (D3 g6) (D4 g8)) (links down (a1 A1) (a2 A1) (b1 A1) (b2 A1) (a3 A2) (a4 A2) (b3 A2) (b4 A2) (a5 A3) (a6 A3) (b5 A3) (b6 A3) (a7 A4) (a8 A4) (b7 A4) (b8 A4) (c1 B1) (c2 B1) (d1 B1) (d2 B1) (c3 B2) (c4 B2) (d3 B2) (d4 B2) (c5 B3) (c6 B3) (d5 B3) (d6 B3) (c7 B4) (c8 B4) (d7 B4) (d8 B4) (e1 C1) (e2 C1) (f1 C1) (f2 C1) (e3 C2) (e4 C2) (f3 C2) (f4 C2) (e5 C3) (e6 C3) (f5 C3) (f6 C3) (e7 C4) (e8 C4) (f7 C4) (f8 C4) (g1 D1) (g2 D1) (h1 D1) (h2 D1) (g3 D2) (g4 D2) (h3 D2) (h4 D2) (g5 D3) (g6 D3) (h5 D3) (h6 D3) (g7 D4) (g8 D4) (h7 D4) (h8 D4) ) (symmetry Black (ns) (sn) (ne se) (se ne) (nw sw) (sw nw)) (zone (name promotion-zone) (players White) (positions a8 b8 c8 d8 e8 f8 g8 h8) ) (zone (name promotion-zone) (players Black) (positions a1 b1 c1 d1 e1 f1 g1 h1) ) (zone (name enemy-promotion-zone) (players Black) (positions a8 b8 c8 d8 e8 f8 g8 h8) ) (zone (name enemy-promotion-zone) (players White) (positions a1 b1 c1 d1 e1 f1 g1 h1) ) (zone (name third-rank) (players White) (positions a3 b3 c3 d3 e3 f3 g3 h3 a2 b2 c2 d2 e2 f2 g2 h2) ) (zone (name third-rank) (players Black) (positions a6 b6 c6 d6 e6 f6 g6 h6 a7 b7 c7 d7 e7 f7 g7 h7) ) )</span></span></code> </pre><br></div></div><br>  The traditional 8x8 board is combined with a 4x4 board, along which the ‚Äúpieces of the board‚Äù - the platforms - move.  Additional <b>up</b> and <b>down</b> directions help the figures to control the presence of ‚Äúsoil under their feet‚Äù.  The most difficult is to ensure the synchronous movement of the figures together with the platforms. <br><br><div class="spoiler">  <b class="spoiler_title">Cascade and to operators come to the rescue.</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> wplatform-move (<span class="hljs-name"><span class="hljs-name">mark</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) to back up (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> empty? (<span class="hljs-name"><span class="hljs-name">empty</span></span>? e) (<span class="hljs-name"><span class="hljs-name">empty</span></span>? s) (<span class="hljs-name"><span class="hljs-name">empty</span></span>? se)) add else back up (<span class="hljs-name"><span class="hljs-name">if</span></span> not-empty? cascade from $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> (<span class="hljs-name"><span class="hljs-name">in-zone</span></span>? promotion-zone $<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Pawn (<span class="hljs-name"><span class="hljs-name">opposite</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">friend</span></span>? (<span class="hljs-name"><span class="hljs-name">opposite</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span>))) $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">change-type</span></span> Queen) to else $<span class="hljs-number"><span class="hljs-number">1</span></span> to)) back up e (<span class="hljs-name"><span class="hljs-name">if</span></span> not-empty? cascade from $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> (<span class="hljs-name"><span class="hljs-name">in-zone</span></span>? promotion-zone $<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Pawn (<span class="hljs-name"><span class="hljs-name">opposite</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">friend</span></span>? (<span class="hljs-name"><span class="hljs-name">opposite</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span>))) $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">change-type</span></span> Queen) to else $<span class="hljs-number"><span class="hljs-number">1</span></span> to)) back up s (<span class="hljs-name"><span class="hljs-name">if</span></span> not-empty? cascade from $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> (<span class="hljs-name"><span class="hljs-name">in-zone</span></span>? enemy-promotion-zone $<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Pawn (<span class="hljs-name"><span class="hljs-name">opposite</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">enemy</span></span>? (<span class="hljs-name"><span class="hljs-name">opposite</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span>))) $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">change-type</span></span> Queen) to else $<span class="hljs-number"><span class="hljs-number">1</span></span> to)) back up se (<span class="hljs-name"><span class="hljs-name">if</span></span> not-empty? cascade from $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> (<span class="hljs-name"><span class="hljs-name">in-zone</span></span>? enemy-promotion-zone $<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? Pawn (<span class="hljs-name"><span class="hljs-name">opposite</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">enemy</span></span>? (<span class="hljs-name"><span class="hljs-name">opposite</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span>))) $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">change-type</span></span> Queen) to else $<span class="hljs-number"><span class="hljs-number">1</span></span> to)) add ) ) )</code> </pre><br></div></div><br>  You might think that this is the limit of ZoG's capabilities, but look at <a href="http://www.zillions-of-games.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D2051">this</a> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dcf/bb6/79e/dcfbb679e7d541b0bc167a4a89d10bee.png"></div><br>  There is clearly something wrong here.  The figures overlap each other!  Does ZoG do that?  Of course not!  But who said that the figures must be whole?  In this game, each ‚Äúfigure‚Äù is made up of four pieces, and the board is, of course, three-dimensional (but we see only its ‚Äúupper plan‚Äù).  The implementation is great.  The only thing that can confuse is that in order to select any of the figures, it is necessary to indicate its upper left corner (this can be corrected, if desired). <br><br>  You can go even further!  From the moment I saw <a href="http://www.cameronius.com/games/margo/margo-basics-41.pdf">this</a> book for the first time, I had a burning desire to make a board for Margo.  Since I am a realist, I realize that I can hardly get AI ZoG to work with it correctly.  Even for the classic implementation of <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D0%25BE">Go</a> on a two-dimensional board, ZoG needed an <a href="http://www.zillions-of-games.com/progsample.html">engine</a> to play at the level of an average beginner.  In Margo, with its ‚Äúzombies‚Äù, ‚Äúbridges‚Äù and ‚Äúvirtual groups‚Äù, it is still more difficult.  The full game can be implemented in <a href="http://zillions-of-games.com/cgi-bin/zilligames/submissions.cgi%3Fdo%3Dshow%3Bid%3D1452">Axiom</a> , but there the development of AI is a separate story.  To begin with, I am completely satisfied with the board controlling the rules of the game, supporting the game of two people and the analysis of etudes.  Start by defining the board: <br><br><div class="spoiler">  <b class="spoiler_title">Margo board</b> <div class="spoiler_text"><pre> <code class="lisp hljs"> (<span class="hljs-name"><span class="hljs-name">board</span></span> (<span class="hljs-name"><span class="hljs-name">image</span></span> <span class="hljs-string"><span class="hljs-string">"../images/margo/board.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">grid</span></span> (<span class="hljs-name"><span class="hljs-name">start-rectangle</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">59</span></span> <span class="hljs-number"><span class="hljs-number">59</span></span>) (<span class="hljs-name"><span class="hljs-name">dimensions</span></span> (<span class="hljs-string"><span class="hljs-string">"a/b/c/d/e/f/g/h/i/j/k/l/m/n"</span></span> (<span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-comment"><span class="hljs-comment">; files ("14/13/12/11/10/9/8/7/6/5/4/3/2/1" (0 30)) ; ranks ("I/II/III/IV/V/VI/VII" (1600 0)) ;layers ) (directions (n 0 -1 0) (e 1 0 0) (s 0 1 0) (w -1 0 0) (nw -1 -1 0) (ne 1 -1 0) (sw -1 1 0) (se 1 1 0) (u 0 0 -1) (d 0 0 1) ) ) (zone (name im) (players R) (positions a1I) ) (zone (name im) (players B) (positions a2I) ) (zone (name empty-plane) (players RB) (positions a2I a4I a6I a8I a10I a12I a14I c2I c4I c6I c8I c10I c12I c14I e2I e4I e6I e8I e10I e12I e14I g2I g4I g6I g8I g10I g12I g14I i2I i4I i6I i8I i10I i12I i14I k2I k4I k6I k8I k10I k12I k14I m2I m4I m6I m8I m10I m12I m14I ) ) (zone (name plane) (players RB) (positions a1I a2I a3I a4I a5I a6I a7I a8I a9I a10I a11I a12I a13I a14I b1I b2I b3I b4I b5I b6I b7I b8I b9I b10I b11I b12I b13I b14I c1I c2I c3I c4I c5I c6I c7I c8I c9I c10I c11I c12I c13I c14I d1I d2I d3I d4I d5I d6I d7I d8I d9I d10I d11I d12I d13I d14I e1I e2I e3I e4I e5I e6I e7I e8I e9I e10I e11I e12I e13I e14I f1I f2I f3I f4I f5I f6I f7I f8I f9I f10I f11I f12I f13I f14I g1I g2I g3I g4I g5I g6I g7I g8I g9I g10I g11I g12I g13I g14I h1I h2I h3I h4I h5I h6I h7I h8I h9I h10I h11I h12I h13I h14I i1I i2I i3I i4I i5I i6I i7I i8I i9I i10I i11I i12I i13I i14I j1I j2I j3I j4I j5I j6I j7I j8I j9I j10I j11I j12I j13I j14I k1I k2I k3I k4I k5I k6I k7I k8I k9I k10I k11I k12I k13I k14I l1I l2I l3I l4I l5I l6I l7I l8I l9I l10I l11I l12I l13I l14I m1I m2I m3I m4I m5I m6I m7I m8I m9I m10I m11I m12I m13I m14I n1I n2I n3I n4I n5I n6I n7I n8I n9I n10I n11I n12I n13I n14I ) ) )</span></span></code> </pre><br></div></div><br>  Taking the definition of the ‚ÄúMahjong‚Äù board, I changed the graphic resources and the size of the board (to get a 7x7 board, you must define a <b>grid of</b> 14x14 tiles, with support for 7 layers).  Here you should pay attention to the definition of gaming areas.  First, it is necessary to define the ‚Äútop plan‚Äù - the <b>plane</b> zone in which all visible tiles will be located.  Only in this zone is it possible to add new figures and the removal of them should begin with it.  Further, the creation of figures on an empty board may not anywhere.  The <b>empty-plan</b> zone defines the possible location of their left upper tiles. <br><br>  As for the definition of the zone, ‚Äú <b>im</b> ‚Äù is a funny trick that will allow you to further determine whether a piece belongs to a player (and not just their friendliness or hostility).  This macro will be used to obtain complete information about the tile located at the current position (unfortunately, it is impossible to implement a similar functionality in the ZRF in any clearer way): <br><br><div class="spoiler">  <b class="spoiler_title">Getting tile information</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> get-piece (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-piece? false) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-black? false) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-left? false) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-top? false) (<span class="hljs-name"><span class="hljs-name">if</span></span> not-empty? (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-piece? true) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> enemy? (<span class="hljs-name"><span class="hljs-name">in-zone</span></span>? im a1I)) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-black? true) ) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> friend? (<span class="hljs-name"><span class="hljs-name">in-zone</span></span>? im a2I)) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-black? true) ) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">or</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? tnw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? tne)) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-top? true) ) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">or</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? tnw) (<span class="hljs-name"><span class="hljs-name">piece</span></span>? tsw)) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-left? true) ) ) )</code> </pre><br></div></div><br>  The task of placing a figure (four tiles) on an empty board is solved trivially.  The only technical difficulty is that the move begins by resetting <b>another</b> special piece (not a tile), since this is the only piece that can be dropped <b>to any</b> field.  At the point of discharge, it must be replaced with the corresponding tile (this is almost the same as what was done in ‚ÄúHuffing Checkers‚Äù in the previous article).  The remaining tiles are simply created in the adjacent fields (since the move can start from any tile, 4 possible moves must be defined): <br><br><div class="spoiler">  <b class="spoiler_title">Move to the empty board</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> pre-check-3 (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">2</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">in-zone</span></span>? $<span class="hljs-number"><span class="hljs-number">3</span></span>)) ) (<span class="hljs-name"><span class="hljs-name">define</span></span> pre-check-4 (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">2</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">in-zone</span></span>? $<span class="hljs-number"><span class="hljs-number">3</span></span> $<span class="hljs-number"><span class="hljs-number">4</span></span>)) ) (<span class="hljs-name"><span class="hljs-name">define</span></span> check-e (<span class="hljs-name"><span class="hljs-name">verify</span></span> empty?) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">empty</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">empty</span></span>? $<span class="hljs-number"><span class="hljs-number">2</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">empty</span></span>? $<span class="hljs-number"><span class="hljs-number">3</span></span>)) ) (<span class="hljs-name"><span class="hljs-name">define</span></span> post-action (<span class="hljs-name"><span class="hljs-name">create</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span>-$<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">create</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span>-$<span class="hljs-number"><span class="hljs-number">2</span></span> $<span class="hljs-number"><span class="hljs-number">2</span></span>) (<span class="hljs-name"><span class="hljs-name">create</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span>-$<span class="hljs-number"><span class="hljs-number">3</span></span> $<span class="hljs-number"><span class="hljs-number">4</span></span>) (<span class="hljs-name"><span class="hljs-name">create</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span>-$<span class="hljs-number"><span class="hljs-number">5</span></span> $<span class="hljs-number"><span class="hljs-number">6</span></span>) add ) (<span class="hljs-name"><span class="hljs-name">define</span></span> de-nw ( (<span class="hljs-name"><span class="hljs-name">pre-check-3</span></span> es empty-plane) (<span class="hljs-name"><span class="hljs-name">check-e</span></span> es se) (<span class="hljs-name"><span class="hljs-name">post-action</span></span> nw se ne e sw s) )) (<span class="hljs-name"><span class="hljs-name">define</span></span> de-ne ( (<span class="hljs-name"><span class="hljs-name">pre-check-4</span></span> ws empty-plane w) (<span class="hljs-name"><span class="hljs-name">check-e</span></span> ws sw) (<span class="hljs-name"><span class="hljs-name">post-action</span></span> ne sw nw w se s) )) (<span class="hljs-name"><span class="hljs-name">define</span></span> de-se ( (<span class="hljs-name"><span class="hljs-name">pre-check-4</span></span> wn empty-plane nw) (<span class="hljs-name"><span class="hljs-name">check-e</span></span> nw nw) (<span class="hljs-name"><span class="hljs-name">post-action</span></span> se nw ne n sw w) )) (<span class="hljs-name"><span class="hljs-name">define</span></span> de-sw ( (<span class="hljs-name"><span class="hljs-name">pre-check-4</span></span> en empty-plane n) (<span class="hljs-name"><span class="hljs-name">check-e</span></span> en ne) (<span class="hljs-name"><span class="hljs-name">post-action</span></span> sw ne nw n se e) )) (<span class="hljs-name"><span class="hljs-name">define</span></span> tile (<span class="hljs-name"><span class="hljs-name">name</span></span> $<span class="hljs-number"><span class="hljs-number">1</span></span>$<span class="hljs-number"><span class="hljs-number">2</span></span>) (<span class="hljs-name"><span class="hljs-name">image</span></span> G <span class="hljs-string"><span class="hljs-string">"../images/margo/w$1$2.bmp"</span></span> R <span class="hljs-string"><span class="hljs-string">"../images/margo/b$1$2.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">attribute</span></span> is-ko? false) ) (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">tile</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span> nw) ) (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">tile</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span> ne) ) (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">tile</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span> sw) ) (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">tile</span></span> <span class="hljs-literal"><span class="hljs-literal">t</span></span> se) ) (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">name</span></span> M) (<span class="hljs-name"><span class="hljs-name">image</span></span> R <span class="hljs-string"><span class="hljs-string">"../images/margo/m.bmp"</span></span> B <span class="hljs-string"><span class="hljs-string">"../images/margo/m.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">drops</span></span> (<span class="hljs-name"><span class="hljs-name">de-nw</span></span>) (<span class="hljs-name"><span class="hljs-name">de-ne</span></span>) (<span class="hljs-name"><span class="hljs-name">de-se</span></span>) (<span class="hljs-name"><span class="hljs-name">de-sw</span></span>) ) )</code> </pre><br></div></div><br>  A move that builds a "pyramid" is more complicated.  It is necessary to make sure that all four tiles on which the new figure is placed have the required type and the depth below them is the same.  Further, before placing a piece on the board in the upper (visible) layer, it is necessary to transfer the tiles previously placed there to deeper layers.  Initially, I chose a not entirely successful solution, using layers from <b>II</b> to <b>VII</b> as a ‚Äústack‚Äù, from top to bottom: <br><br><div class="spoiler">  <b class="spoiler_title">Building the pyramids</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> check-p (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? <span class="hljs-literal"><span class="hljs-literal">t</span></span>-$<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? <span class="hljs-literal"><span class="hljs-literal">t</span></span>-$<span class="hljs-number"><span class="hljs-number">2</span></span> $<span class="hljs-number"><span class="hljs-number">3</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? <span class="hljs-literal"><span class="hljs-literal">t</span></span>-$<span class="hljs-number"><span class="hljs-number">4</span></span> $<span class="hljs-number"><span class="hljs-number">5</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">piece</span></span>? <span class="hljs-literal"><span class="hljs-literal">t</span></span>-$<span class="hljs-number"><span class="hljs-number">6</span></span> $<span class="hljs-number"><span class="hljs-number">7</span></span>)) ) (<span class="hljs-name"><span class="hljs-name">define</span></span> check-d mark u (<span class="hljs-name"><span class="hljs-name">while</span></span> not-empty? (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">not-empty</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">not-empty</span></span>? $<span class="hljs-number"><span class="hljs-number">2</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">not-empty</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>$<span class="hljs-number"><span class="hljs-number">2</span></span>)) u ) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">empty</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">empty</span></span>? $<span class="hljs-number"><span class="hljs-number">2</span></span>)) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">empty</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>$<span class="hljs-number"><span class="hljs-number">2</span></span>)) back ) (<span class="hljs-name"><span class="hljs-name">define</span></span> dp-nw ( (<span class="hljs-name"><span class="hljs-name">pre-check-3</span></span> es plane) (<span class="hljs-name"><span class="hljs-name">check-p</span></span> se sw e nw se ne s) (<span class="hljs-name"><span class="hljs-name">check-d</span></span> se) (<span class="hljs-name"><span class="hljs-name">pre-action</span></span> se) (<span class="hljs-name"><span class="hljs-name">post-action</span></span> nw se ne e sw s) )) (<span class="hljs-name"><span class="hljs-name">define</span></span> dp-ne ( (<span class="hljs-name"><span class="hljs-name">pre-check-4</span></span> ws plane w) (<span class="hljs-name"><span class="hljs-name">check-p</span></span> sw se w nw s ne sw) (<span class="hljs-name"><span class="hljs-name">check-d</span></span> sw) (<span class="hljs-name"><span class="hljs-name">pre-action</span></span> sw) (<span class="hljs-name"><span class="hljs-name">post-action</span></span> ne sw nw w se s) )) (<span class="hljs-name"><span class="hljs-name">define</span></span> dp-se ( (<span class="hljs-name"><span class="hljs-name">pre-check-4</span></span> wn plane nw) (<span class="hljs-name"><span class="hljs-name">check-p</span></span> nw sw n ne w se nw) (<span class="hljs-name"><span class="hljs-name">check-d</span></span> nw) (<span class="hljs-name"><span class="hljs-name">pre-action</span></span> nw) (<span class="hljs-name"><span class="hljs-name">post-action</span></span> se nw ne n sw w) )) (<span class="hljs-name"><span class="hljs-name">define</span></span> dp-sw ( (<span class="hljs-name"><span class="hljs-name">pre-check-4</span></span> en plane n) (<span class="hljs-name"><span class="hljs-name">check-p</span></span> ne nw e se n sw ne) (<span class="hljs-name"><span class="hljs-name">check-d</span></span> ne) (<span class="hljs-name"><span class="hljs-name">pre-action</span></span> ne) (<span class="hljs-name"><span class="hljs-name">post-action</span></span> sw ne nw n se e) )) (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">name</span></span> M) (<span class="hljs-name"><span class="hljs-name">image</span></span> R <span class="hljs-string"><span class="hljs-string">"../images/margo/m.bmp"</span></span> B <span class="hljs-string"><span class="hljs-string">"../images/margo/m.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">drops</span></span> (<span class="hljs-name"><span class="hljs-name">de-nw</span></span>) (<span class="hljs-name"><span class="hljs-name">dp-nw</span></span>) (<span class="hljs-name"><span class="hljs-name">de-ne</span></span>) (<span class="hljs-name"><span class="hljs-name">dp-ne</span></span>) (<span class="hljs-name"><span class="hljs-name">de-se</span></span>) (<span class="hljs-name"><span class="hljs-name">dp-se</span></span>) (<span class="hljs-name"><span class="hljs-name">de-sw</span></span>) (<span class="hljs-name"><span class="hljs-name">dp-sw</span></span>) ) )</code> </pre><br></div></div><br>  Subsequently, it became clear that it is much more convenient to keep all the tiles of one shape (except the visible ones) in one layer.  The stack had to be " <a href="https://github.com/GlukKazan/ZoG/commit/f7fa7a5cdd79ba48b11e6dd4857d1bed60ad4637">turned over</a> " (for this it was necessary to create an additional direction connecting the first layer with the seventh).  The next step was removal.  The algorithms for removing figures, in connection with their ‚Äúdeath‚Äù in Go (and even more so in Margo) are very complex.  I decided to start with a simple one - removing any shape with a simple mouse click.  Of course, in order for the whole structure not to fall apart, it is also necessary to remove all the figures ‚Äúrelying‚Äù on the removed one (directly or indirectly) by the same move.  In itself, the removal of marked tiles is fairly obvious. <br><br><div class="spoiler">  <b class="spoiler_title">Group tile removal</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> clean-piece (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-piece? false) d (<span class="hljs-name"><span class="hljs-name">while</span></span> empty? d) (<span class="hljs-name"><span class="hljs-name">while</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> not-empty? (<span class="hljs-name"><span class="hljs-name">position-flag</span></span>? is-dead?)) capture d ) (<span class="hljs-name"><span class="hljs-name">if</span></span> not-empty? (<span class="hljs-name"><span class="hljs-name">get-piece</span></span>) capture ) (<span class="hljs-name"><span class="hljs-name">while</span></span> (<span class="hljs-name"><span class="hljs-name">not-in-zone</span></span>? plane) u) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">flag</span></span>? is-piece?) (<span class="hljs-name"><span class="hljs-name">add-piece</span></span>) else capture ) ) (<span class="hljs-name"><span class="hljs-name">define</span></span> clean-pieces mark a0 (<span class="hljs-name"><span class="hljs-name">while</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? next) next (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> not-empty? (<span class="hljs-name"><span class="hljs-name">position-flag</span></span>? is-dead?)) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">empty</span></span>? b) capture else (<span class="hljs-name"><span class="hljs-name">clean-piece</span></span>) ) ) ) back )</code> </pre><br></div></div><br>  In the main <b>clean-pieces</b> cycle, all top-level tiles are viewed.  If one of them is marked for deletion, the tiles are checked directly below it, in the lower layers.  Everything marked for deletion is deleted, and the first unmarked tile moves up to the first layer.  Positional flags are used for marking, which allow to associate a Boolean value with an arbitrary position.  It remains to figure out how to mark tiles for deletion. <br><br><div class="spoiler">  <b class="spoiler_title">Marking tiles for removal</b> <div class="spoiler_text"><pre> <code class="lisp hljs">(<span class="hljs-name"><span class="hljs-name">define</span></span> check-top (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> (<span class="hljs-name"><span class="hljs-name">not-empty</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">not-position-flag</span></span>? is-dead? $<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">not-position-flag</span></span>? is-current? $<span class="hljs-number"><span class="hljs-number">1</span></span>)) $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">set-position-flag</span></span> is-current? true) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">not-piece</span></span>? <span class="hljs-literal"><span class="hljs-literal">t</span></span>$<span class="hljs-number"><span class="hljs-number">3</span></span>) d (<span class="hljs-name"><span class="hljs-name">while</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> empty? (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? d)) d) (<span class="hljs-name"><span class="hljs-name">verify</span></span> not-empty?) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> not-empty? (<span class="hljs-name"><span class="hljs-name">not-position-flag</span></span>? is-dead?) (<span class="hljs-name"><span class="hljs-name">not-position-flag</span></span>? is-current?)) (<span class="hljs-name"><span class="hljs-name">set-position-flag</span></span> is-current? true) ) (<span class="hljs-name"><span class="hljs-name">while</span></span> (<span class="hljs-name"><span class="hljs-name">not-in-zone</span></span>? plane) u) ) $<span class="hljs-number"><span class="hljs-number">2</span></span> ) ) (<span class="hljs-name"><span class="hljs-name">define</span></span> check-deep (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>)) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> (<span class="hljs-name"><span class="hljs-name">not-empty</span></span>? $<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">not-position-flag</span></span>? is-dead? $<span class="hljs-number"><span class="hljs-number">1</span></span>) (<span class="hljs-name"><span class="hljs-name">not-position-flag</span></span>? is-current? $<span class="hljs-number"><span class="hljs-number">1</span></span>)) $<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-name"><span class="hljs-name">set-position-flag</span></span> is-current? true) (<span class="hljs-name"><span class="hljs-name">verify</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? u)) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">and</span></span> (<span class="hljs-name"><span class="hljs-name">not-empty</span></span>? u) (<span class="hljs-name"><span class="hljs-name">not-position-flag</span></span>? is-dead? u) (<span class="hljs-name"><span class="hljs-name">not-position-flag</span></span>? is-current? u)) u (<span class="hljs-name"><span class="hljs-name">set-position-flag</span></span> is-current? true) d ) $<span class="hljs-number"><span class="hljs-number">2</span></span> ) ) (<span class="hljs-name"><span class="hljs-name">define</span></span> proceed-current (<span class="hljs-name"><span class="hljs-name">set-position-flag</span></span> is-dead? true) (<span class="hljs-name"><span class="hljs-name">set-position-flag</span></span> is-current? false) (<span class="hljs-name"><span class="hljs-name">get-piece</span></span>) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">in-zone</span></span>? plane) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">flag</span></span>? is-left?) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">flag</span></span>? is-top?) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> ew ne) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> sn sw) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> se nw se) else (<span class="hljs-name"><span class="hljs-name">check-top</span></span> ew se) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> ns nw) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> ne sw ne) ) else (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">flag</span></span>? is-top?) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> we nw) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> sn se) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> sw ne sw) else (<span class="hljs-name"><span class="hljs-name">check-top</span></span> we sw) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> ns ne) (<span class="hljs-name"><span class="hljs-name">check-top</span></span> nw se nw) ) ) else (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">flag</span></span>? is-left?) (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">flag</span></span>? is-top?) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> ew) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> sn) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> se nw) else (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> ew) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> ns) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> ne sw) ) else (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">flag</span></span>? is-top?) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> we) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> sn) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> sw ne) else (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> we) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> ns) (<span class="hljs-name"><span class="hljs-name">check-deep</span></span> nw se) ) ) ) ) (<span class="hljs-name"><span class="hljs-name">define</span></span> proceed-all (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-done? false) (<span class="hljs-name"><span class="hljs-name">while</span></span> (<span class="hljs-name"><span class="hljs-name">not-flag</span></span>? is-done?) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-done? true) mark a0 (<span class="hljs-name"><span class="hljs-name">while</span></span> (<span class="hljs-name"><span class="hljs-name">on-board</span></span>? next-all) next-all (<span class="hljs-name"><span class="hljs-name">if</span></span> (<span class="hljs-name"><span class="hljs-name">position-flag</span></span>? is-current?) (<span class="hljs-name"><span class="hljs-name">set-flag</span></span> is-done? false) (<span class="hljs-name"><span class="hljs-name">proceed-current</span></span>) ) ) back ) ) (<span class="hljs-name"><span class="hljs-name">define</span></span> dp-clear ( (<span class="hljs-name"><span class="hljs-name">verify</span></span> not-empty?) (<span class="hljs-name"><span class="hljs-name">set-position-flag</span></span> is-current? true) (<span class="hljs-name"><span class="hljs-name">proceed-all</span></span>) (<span class="hljs-name"><span class="hljs-name">clean-pieces</span></span>) add )) ... (<span class="hljs-name"><span class="hljs-name">piece</span></span> (<span class="hljs-name"><span class="hljs-name">name</span></span> M) (<span class="hljs-name"><span class="hljs-name">image</span></span> G <span class="hljs-string"><span class="hljs-string">"../images/margo/m.bmp"</span></span> R <span class="hljs-string"><span class="hljs-string">"../images/margo/m.bmp"</span></span>) (<span class="hljs-name"><span class="hljs-name">drops</span></span> (<span class="hljs-name"><span class="hljs-name">de-nw</span></span>) (<span class="hljs-name"><span class="hljs-name">dp-nw</span></span>) (<span class="hljs-name"><span class="hljs-name">de-ne</span></span>) (<span class="hljs-name"><span class="hljs-name">dp-ne</span></span>) (<span class="hljs-name"><span class="hljs-name">de-se</span></span>) (<span class="hljs-name"><span class="hljs-name">dp-se</span></span>) (<span class="hljs-name"><span class="hljs-name">de-sw</span></span>) (<span class="hljs-name"><span class="hljs-name">dp-sw</span></span>) (<span class="hljs-name"><span class="hljs-name">dp-clear</span></span>) ) )</code> </pre><br></div></div><br>  Here, it is important to understand that deletion <b>always</b> begins with visible tiles located in the first layer.  Having set the initial mark in <b>dp-clear</b> , we perform <b>proceed-current</b> as long as there are new, not yet deleted tiles.  This procedure itself performs the ‚Äúdistribution‚Äù of flags to neighboring tiles and does this in different ways, depending on whether the action takes place in the upper layer or in the depth. <br><br>  In the first layer, the type of the adjacent tile is controlled and if it does not coincide with the expected one (this means that the figure is overlapped lying above), in addition to marking the tile of the overlapping figure, the flag extends in depth.  On deeper layers, the shape tiles are always located in one layer.  We simply spread the flag to neighboring tiles, and if there is something on top of them, pass it up as well.  As a result, everything works as expected, but the picture itself looks something like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e33/68d/5af/e3368d5af6d6444390b59b6bb23a99e8.png"></div><br><br>  Well ... these are tiles.  In order to take into account the color of the figure below, it will be necessary, having worked in a graphic editor, add two more types for each tile and complicate the code a little.  In the end, all together will look like <a href="">this</a> . <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/tfKkstb9FtA%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhTLBIaicJjzO4sNJpgjaf4q9x4xg" frameborder="0" allowfullscreen=""></iframe><br><br>  Of course, in order to turn this piece into a full-fledged game ‚ÄúMargo‚Äù, I will have to work a lot more.  Most likely, I still have to redo everything on the Axiom, and this in itself is a whole story.  In Axiom there are no attributes of figures, play zones and positional flags, but, in terms of development (including AI), its capabilities are immeasurably superior to ZRF.  In addition, the code in ForthScript can somehow debug.  When (and if) I cope with all the difficulties, it will deserve a separate article, today I just wanted to show that with the help of ZRF <b>you can</b> do really amazing things.  It is enough to show a little ingenuity and not be afraid (very much) to work with your hands. <br></div><p>Source: <a href="https://habr.com/ru/post/259611/">https://habr.com/ru/post/259611/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259601/index.html">Monitoring the exchange of a distributed database 1C by means of Zabbix</a></li>
<li><a href="../259603/index.html">Rounds - border-radius inset for images</a></li>
<li><a href="../259605/index.html">Geolocation without GPS (part 2)</a></li>
<li><a href="../259607/index.html">Developer Errors in MMO Testing</a></li>
<li><a href="../259609/index.html">How on PHDays V hacked the RB System</a></li>
<li><a href="../259613/index.html">As I png reduced 4 times</a></li>
<li><a href="../259615/index.html">Data from Arduino in the form of charts and graphs</a></li>
<li><a href="../259619/index.html">Python Meetup 04/24/15: Python tests, Rest services on Flask and GUI application in 5 minutes</a></li>
<li><a href="../259621/index.html">"1-wire" for buttons with indication</a></li>
<li><a href="../259623/index.html">ADC as a random number generator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>