<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deep learning using R and mxnet. Part 1. Basics</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 

 This article is the first part of a neural network preparation guide using the mxnet library in the R language. The source of inspiration...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deep learning using R and mxnet. Part 1. Basics</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/7_/1k/z2/7_1kz26fj17wsjdkdyg_julbivs.jpeg"><br><br>  Hi, Habr! <br><br>  This article is the first part of a neural network preparation guide using the <strong>mxnet</strong> library in the R language. The source of inspiration was the online book <a href="https://github.com/zackchase/mxnet-the-straight-dope">Deep Learning - The Straight Dope</a> , which is enough for conscious use of <strong>mxnet</strong> on Python.  Examples from there will be reproduced, corrected for the lack of implementation of the Gluon interface for R. In the first part, we consider the installation of the library and the general principles of operation, and also implement a simple linear model for solving the regression problem. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Content: </h3><br><ol><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">Installing the mxnet library</a> </li><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">Used dataset</a> </li><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">The main function for learning neural networks</a> </li><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">Iterators</a> </li><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">Network architecture</a> </li><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">Initializer</a> </li><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">Optimizer</a> </li><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">Callback Functions (Callbacks)</a> </li><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">Model training</a> </li><li>  <a href="https://habr.com/ru/company/ods/blog/354944/">Solution of the regression problem on real data</a> </li></ol><br><h4 id="section1">  1. Install the mxnet library </h4><br><p> A clear installation <a href="https://mxnet.apache.org/install/index.html">guide</a> for different versions (CPU / GPU) for different languages ‚Äã‚Äãand for different devices appeared relatively recently.  Preparatory steps such as installing drivers and CUDA / cuDNN were considered in <a href="http://biostat-r.blogspot.com/2017/01/deep-learning-r-mxnet.html">this message</a> , we will not repeat.  For Python, by the way, you can collect nothing from source, but simply install with the command <code>pip install mxnet --pre</code> .  In a situation where the CPU cores are relatively large, and the RAM is relatively small, when assembling from the source you can face a shortage of memory.  In this case, run the build in single-threaded mode: <code>make -j1</code> . </p><br><p>  The library can also be used in code in Julia, Scala, and, suddenly, Perl.  And still declared support for work on the Raspberry Pi 3. </p><br><h4 id="section2">  2. Used dataset </h4><br><p>  Create an artificial data set of 10,000 observations ( <code>num_examples</code> ) with two signs ( <code>num_inputs</code> ) and one target variable ( <code>num_outputs</code> ).  The true form of the relationship between the predictors and the target variable is set by the function <code>real_fn()</code> , a small Gaussian noise of <code>0.01 * rnorm(num_examples)</code> added to the values ‚Äã‚Äãgenerated using this function: </p><br><pre> <code class="hljs matlab">num_inputs &lt;- <span class="hljs-number"><span class="hljs-number">2</span></span> num_outputs &lt;- <span class="hljs-number"><span class="hljs-number">1</span></span> num_examples &lt;- <span class="hljs-number"><span class="hljs-number">10000</span></span> real_fn &lt;- <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function"> { 2 * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[, 1]</span></span></span><span class="hljs-function"> - 3.4 * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[, 2]</span></span></span><span class="hljs-function"> + 4.2 } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">X</span></span></span><span class="hljs-function"> &lt;- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">matrix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rnorm(num_examples * num_inputs)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ncol</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">num_inputs</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">noise</span></span></span><span class="hljs-function"> &lt;- 0.01 * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rnorm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(num_examples)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">y</span></span></span><span class="hljs-function"> &lt;- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">real_fn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(X)</span></span></span><span class="hljs-function"> + </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">noise</span></span></span></span></code> </pre> <br><h4 id="section3">  3. The main function for learning neural networks </h4><br><p>  The learning of neural networks of direct propagation is the responsibility of the <code>mx.model.FeedForward.create()</code> function.  The list of parameters it takes is as follows: </p><br><ul><li>  <code>symbol</code> - network architecture as a symbolic description.  This is not exactly a graph of computations, since the dimensions of the tensors and the loss function are not given in it, but something similar.  The architecture can be drawn using the <code>graph.viz()</code> function, an example will be below; </li><li>  <code>X</code> is the matrix / array or iterator of the data used for training.  We use arrays when the data is completely stored in memory, and iterators when it does not fit.  There are several ready-made iterators (for arrays, for pictures in binary RecordIO format, for csv-files) and the ability to create your own; </li><li>  <code>y</code> - values ‚Äã‚Äãof the target variable.  It is set only in the case when <code>X</code> is an array, otherwise the iterator must return everything necessary for learning, including the correct answers; </li><li>  <code>ctx</code> - device or list of devices used for training (CPU / GPU).  An MXContext object created with <code>mx.cpu()</code> or <code>mx.gpu()</code> ; </li><li>  <code>begin.round</code> is the initial count of iterations (epochs) of learning.  Changing the default value (1) is necessary only when the model is additionally trained; </li><li>  <code>num.round</code> is the number of epochs; </li><li>  <code>optimizer</code> - used optimizer, given by name (as a string).  The default is stochastic gradient descent ("sgd").  An example of optimizer parameters setting is presented below; </li><li>  <code>initializer</code> - an object that specifies the initialization scheme for the model parameters; </li><li>  <code>eval.data</code> - a list of the form <code>list(data = R.array, label = R.array)</code> or an iterator with validation data; </li><li>  <code>eval.metric</code> is a function for assessing the quality of a model.  In addition to the available options, you can also use your own handwritten; </li><li>  <code>epoch.end.callback</code> is a function that runs after each training era; </li><li>  <code>batch.end.callback</code> - function launched after each batch; </li><li>  <code>array.batch.size</code> - batch size when using data as an array.  When using iterators, the size of the match in them is specified; </li><li>  <code>array.layout</code> - "auto", "colmajor" or "rowmajor" (default is "auto").  Array format: for the rowmajor matrix means that <code>dim(X) = c(nexample, nfeatures)</code> , and colmajor means that <code>dim(X) = c(nfeatures, nexample)</code> .  The "rowmajor" format is valid only for matrices.  The function <code>mx.io.arrayiter()</code> explicitly requires that the data be converted to the colmajor format, i.e.  the matrix will be transposed with respect to the usual view with observations in the rows and signs in the columns; </li><li>  <code>kvstore</code> is set as a string and is responsible for the synchronization scheme when training on multiple devices.  The default is "local"; </li><li>  <code>verbose</code> - is responsible for displaying informational messages in the learning process.  The default is TRUE; </li><li>  <code>arg.params</code> is an optional parameter with a list of NDArray arrays containing model weights; </li><li>  <code>aux.params</code> - a similar list of additional parameters; </li><li>  <code>input.names</code> - the names of the characters supplied to the input; </li><li>  <code>output.names</code> - the names of characters received on output; </li><li>  <code>fixed.param</code> - parameters that remain fixed during training (not trained); </li><li>  <code>allow.extra.params</code> - allows passing additional parameters that are not required according to the symbolic description of the model.  If set to TRUE, if there are such extra parameters in the <code>arg.params</code> and <code>aux.params</code> error will not appear. </li></ul><br><h4 id="section4">  4. Iterators </h4><br><p>  Create an iterator over the data array (matrix): </p><br><pre> <code class="hljs django"><span class="xml"><span class="xml">batch_size </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">4</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train_data</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mx.io.arrayiter</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">t</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">X</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">batch.size</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">batch_size,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">shuffle</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">TRUE)</span></span></span></span></span></span></code> </pre> <br><p>  The function takes as input an array or matrix of attributes (in this case, as already mentioned, the matrix must be transposed), an array with the values ‚Äã‚Äãof the target variable, and the size of the batch.  We also turned on the shuffle of observations with the option <code>shuffle = TRUE</code> .  The list of all available iterators looks like this: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">apropos</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span>") # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[1]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.arrayiter</span></span>" "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bucket</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.iter</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[3]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.CSVIter</span></span>" "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.extract</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[5]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ImageDetRecordIter</span></span>" "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ImageRecordIter</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[7]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ImageRecordIter_v1</span></span>" "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ImageRecordUInt8Iter</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[9]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ImageRecordUInt8Iter_v1</span></span>" "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.io</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.LibSVMIter</span></span>"</code> </pre> <br><p>  Now we will not consider any other options or writing our own iterators. </p><br><h4 id="section5">  5. Network architecture </h4><br><p>  The network architecture is described by successive calls of functions of the <code>mx.symbol.*</code> Family, each of which adds abstract representations of the network to the model: fully connected, convolutional, pooling, and others.  There are a lot of layers available: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">apropos</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span>") # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[1]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">is</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[2]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.abs</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[3]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Activation</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[4]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.adam_update</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[5]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.add_n</span></span>" # ..... # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[208]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.transpose</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[209]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.trunc</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[210]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.uniform</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[211]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.UpSampling</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[212]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Variable</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[213]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.where</span></span>" # <span class="hljs-selector-attr"><span class="hljs-selector-attr">[214]</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.symbol</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.zeros_like</span></span>"</code> </pre> <br><p>  To create a simple linear model that solves the regression problem, use the following code: </p><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span> &lt;- mx.symbol.Variable(<span class="hljs-string"><span class="hljs-string">"data"</span></span>) fc1 &lt;- mx.symbol.FullyConnected(<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>, num_hidden = <span class="hljs-number"><span class="hljs-number">1</span></span>) linreg &lt;- mx.symbol.LinearRegressionOutput(fc1)</code> </pre> <br><p>  Draw the resulting architecture: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">graph</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.viz</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">linreg</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/sh/u_/pa/shu_pahltsfquaoea8prevo6v88.png"><br><h4 id="section6">  6. Initializer </h4><br><p>  The initializer determines from which initial values ‚Äã‚Äãthe learning of the neural network starts.  Since our network is very simple and shallow, it is enough to initialize the weights with random values ‚Äã‚Äãthat have a normal distribution: </p><br><pre> <code class="hljs swift">initializer &lt;- mx.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>.normal(sd = <span class="hljs-number"><span class="hljs-number">0.1</span></span>)</code> </pre> <br><p>  The only parameters accepted in this case is the standard deviation.  There is also an initializer <code>mx.init.uniform()</code> , the only parameter of which is the limit of the range from which values ‚Äã‚Äãare generated. </p><br><p>  For deep networks, proper initialization of weights is of great importance, so we would use the <code>mx.init.Xavier()</code> option. </p><br><p>  This scale initialization scheme was invented in 2010 by Joshua Bengio and Xavier Gloro, after whom the method got its name.  Currently used everywhere under different names, for example, in Keras you can find <code>glorot_normal</code> <code>glorot_uniform</code> .  The library for Python also contains many other initializers that are not available in the version for R. For example, it is not possible to use the preferred variant of initializing the weights of neurons with the ReLU activation function ‚Äî Xe initialization. </p><br><p>  Parameters of the function <code>mx.init.Xavier()</code> : </p><br><ul><li>  <code>rnd_type</code> is a string specifying the type of distribution ("uniform" or "gaussian") from which weights will be generated; </li><li>  <code>factor_type</code> - "avg", "in" or "out" (see below); </li><li>  <code>magnitude</code> is a not entirely clear numeric parameter that sets the scale of the weights to be obtained. </li></ul><br><p>  If <code>rnd_type = "uniform"</code> and <code>factor_type = "avg"</code> (default), weights will be initialized to random values ‚Äã‚Äãfrom the range <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.149ex" height="2.66ex" viewBox="0 -832 2647.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2C" x="1490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5D" x="2369" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>‚àí</mo><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> [- c, c] </script>  where <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>3</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0.5</mn><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.572ex" height="2.66ex" viewBox="0 -832 14885.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-3D" x="711" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-73" x="2017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-71" x="2487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="2947" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="3399" y="0"></use><g transform="translate(3760,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-33" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-35" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="1963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6F" x="2486" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="2972" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-28" x="3333" y="0"></use><g transform="translate(3723,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="345" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2B" x="5314" y="0"></use><g transform="translate(6315,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-75" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="1058" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-29" x="8019" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>0.5</mn><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-2"> c = \ sqrt {\ frac {3} {0.5 \ cdot (n_ {in} + n_ {out})}} </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.181ex" height="1.817ex" viewBox="0 -520.7 1369.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="345" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> n_ {in} </script>  - the number of neurons at the entrance (ie, in the previous layer), <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.958ex" height="1.817ex" viewBox="0 -520.7 1704.2 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-75" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="1058" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-4"> n_ {out} </script>  - the number of neurons at the output (ie, in the next layer). </p><br><p>  If <code>rnd_type = "uniform"</code> and <code>factor_type = "in</code> , then <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>3</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.222ex" height="2.419ex" viewBox="0 -780.1 7845.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-3D" x="711" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-73" x="2017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-71" x="2487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="2947" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="3399" y="0"></use><g transform="translate(3760,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-33" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="345" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-5"> c = \ sqrt {\ frac {3} {n_ {in}}} </script>  .  Similarly, when <code>rnd_type = "uniform"</code> and <code>factor_type = "out"</code> we get <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>3</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.999ex" height="2.419ex" viewBox="0 -780.1 8180.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-3D" x="711" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-73" x="2017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-71" x="2487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="2947" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="3399" y="0"></use><g transform="translate(3760,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-33" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-75" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="1058" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-6"> c = \ sqrt {\ frac {3} {n_ {out}}} </script>  . </p><br><p>  With <code>rnd_type = "gaussian"</code> and <code>factor_type = "avg"</code> weights will be extracted from the normal distribution with standard deviation. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>3</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0.5</mn><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.467ex" height="2.66ex" viewBox="0 -832 13117.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-71" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="1631" y="0"></use><g transform="translate(1993,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-33" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-35" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="1963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6F" x="2486" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="2972" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-28" x="3333" y="0"></use><g transform="translate(3723,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="345" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2B" x="5314" y="0"></use><g transform="translate(6315,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-75" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="1058" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-29" x="8019" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>q</mi><mi>r</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>3</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>0.5</mn><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-7"> \ sqrt {\ frac {3} {0.5 \ cdot (n_ {in} + n_ {out})}} </script>  . </p><br><h4 id="section7">  7. Optimizer </h4><br><p>  The optimizer determines how the network weights are updated.  Available options are sgd, rmsprop, adam, adagrad and adadelta.  You can create an optimizer with the necessary settings using the general function <code>mx.opt.create()</code> : </p><br><pre> <code class="hljs pgsql">optimizer &lt;- mx.opt.<span class="hljs-keyword"><span class="hljs-keyword">create</span></span>("sgd", learning.rate = <span class="hljs-number"><span class="hljs-number">2e-5</span></span>, momentum = <span class="hljs-number"><span class="hljs-number">0.9</span></span>)</code> </pre> <br><p>  To find out about the parameters of each optimizer, which we will pass to the <code>mx.opt.create()</code> call, use the help: </p><br><pre> <code class="hljs css">?<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.opt</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.sgd</span></span> ?<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.opt</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.rmsprop</span></span> ?<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.opt</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.adam</span></span> ?<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.opt</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.adagrad</span></span> ?<span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.opt</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.adadelta</span></span></code> </pre> <br><p>  These functions themselves cannot be called in the usual way (but they can be accessed: <code>mxnet:::mx.opt.adagrad</code> ). </p><br><p>  Parameters <code>mx.opt.sgd()</code> </p><br><ul><li>  <code>learning.rate</code> - <code>learning.rate</code> speed; </li><li>  <code>momentum</code> - the moment; </li><li>  <code>wd</code> is the l2-regularization coefficient (adds a penalty for large weights); </li><li>  <code>rescale.grad</code> is the value by which the resulting gradient is multiplied before the weights are updated.  Often taken to be <code>1 / batch_size</code> ; </li><li>  <code>clip_gradient</code> - restriction of gradient values ‚Äã‚Äãby their projection onto the interval <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.913ex" height="2.78ex" viewBox="0 -832 12879.2 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="1490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="1789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="2134" y="0"></use><g transform="translate(2638,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="3327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="3779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="4308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="4832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="5177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="5644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="6244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2C" x="6606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="7051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="7484" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="7783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="8128" y="0"></use><g transform="translate(8632,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="9322" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="9773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="10303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="10826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="11172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="11638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="12239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5D" x="12600" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>‚àí</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-8"> [- clip \ _gradient, clip \ _gradient] </script>  ; </li><li>  <code>lr_scheduler</code> - scheduler changes learning speed. </li></ul><br><p>  Parameters <code>mx.opt.rmsprop()</code> </p><br><ul><li>  <code>learning.rate</code> - <code>learning.rate</code> speed; </li><li>  <code>gamma1</code> - attenuation coefficient for a moving average of squares of gradients; </li><li>  <code>gamma2</code> - the moment; </li><li>  <code>wd</code> is the l2-regularization coefficient (adds a penalty for large weights); </li><li>  <code>rescale.grad</code> is the value by which the resulting gradient is multiplied before the weights are updated.  Often taken to be <code>1 / batch_size</code> ; </li><li>  <code>clip_gradient</code> - restriction of gradient values ‚Äã‚Äãby their projection onto the interval <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.913ex" height="2.78ex" viewBox="0 -832 12879.2 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="1490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="1789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="2134" y="0"></use><g transform="translate(2638,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="3327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="3779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="4308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="4832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="5177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="5644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="6244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2C" x="6606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="7051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="7484" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="7783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="8128" y="0"></use><g transform="translate(8632,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="9322" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="9773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="10303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="10826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="11172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="11638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="12239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5D" x="12600" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>‚àí</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-9"> [- clip \ _gradient, clip \ _gradient] </script>  ; </li><li>  <code>lr_scheduler</code> - scheduler changes learning speed. </li></ul><br><p>  Parameters <code>mx.opt.adadelta()</code> : </p><br><ul><li>  <code>rho</code> is the attenuation coefficient for the squares of the gradients and squares of the parameter updates; </li><li>  <code>epsilon</code> is a small constant (1e-05) to avoid dividing by 0; </li><li>  <code>wd</code> is the l2-regularization coefficient (adds a penalty for large weights); </li><li>  <code>rescale.grad</code> is the value by which the resulting gradient is multiplied before the weights are updated.  Often taken to be <code>1 / batch_size</code> ; </li><li>  <code>clip_gradient</code> - restriction of gradient values ‚Äã‚Äãby their projection onto the interval <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.913ex" height="2.78ex" viewBox="0 -832 12879.2 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="1490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="1789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="2134" y="0"></use><g transform="translate(2638,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="3327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="3779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="4308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="4832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="5177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="5644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="6244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2C" x="6606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="7051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="7484" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="7783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="8128" y="0"></use><g transform="translate(8632,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="9322" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="9773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="10303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="10826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="11172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="11638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="12239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5D" x="12600" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>‚àí</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-10"> [- clip \ _gradient, clip \ _gradient] </script>  . </li></ul><br><p>  Note: for the speed of learning parameter is not provided. </p><br><p>  The Adadelta optimizer is similar to RMSprop, but Adadelta makes the second amendment with unit changes and update history storage, and RMSprop simply uses the root of the mean of the squares of the gradients.  The following algorithm, Adagrad, uses smoothed versions of mean and rms gradients.  You can read more about all this in the book <a href="https://play.google.com/store/books/details/%25D0%259D%25D0%25B8%25D0%25BA%25D0%25BE%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25BA%25D0%25BE_%25D0%25A1%25D0%25B5%25D1%2580%25D0%25B3%25D0%25B5%25D0%25B9_%25D0%2598%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B5%25D0%25B2%25D0%25B8%25D1%2587_%25D0%2593%25D0%25BB%25D1%2583%25D0%25B1%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25B5_%25D0%25BE%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5%3Fid%3DZi48DwAAQBAJ">Deep Learning</a> , which is recommended to be read in its entirety. </p><br><p>  Parameters <code>mx.opt.adagrad()</code> : </p><br><ul><li>  <code>learning.rate</code> - <code>learning.rate</code> speed; </li><li>  <code>epsilon</code> is a small constant (1e-08) to avoid dividing by 0; </li><li>  <code>wd</code> is the l2-regularization coefficient (adds a penalty for large weights); </li><li>  <code>rescale.grad</code> is the value by which the resulting gradient is multiplied before the weights are updated.  Often taken to be <code>1 / batch_size</code> ; </li><li>  <code>clip_gradient</code> - restriction of gradient values ‚Äã‚Äãby their projection onto the interval <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.913ex" height="2.78ex" viewBox="0 -832 12879.2 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="1490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="1789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="2134" y="0"></use><g transform="translate(2638,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="3327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="3779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="4308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="4832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="5177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="5644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="6244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2C" x="6606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="7051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="7484" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="7783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="8128" y="0"></use><g transform="translate(8632,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="9322" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="9773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="10303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="10826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="11172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="11638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="12239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5D" x="12600" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>‚àí</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-11"> [- clip \ _gradient, clip \ _gradient] </script>  ; </li><li>  <code>lr_scheduler</code> - scheduler changes learning speed. </li></ul><br><p>  Parameters <code>mx.opt.adam()</code> : </p><br><ul><li>  <code>learning.rate</code> - <code>learning.rate</code> speed; </li><li>  <code>beta1</code> is the attenuation coefficient for the first moment estimate; </li><li>  <code>beta2</code> is the attenuation coefficient for the second moment estimate; </li><li>  <code>epsilon</code> is a small constant (1e-08) to avoid dividing by 0; </li><li>  <code>wd</code> is the l2-regularization coefficient (adds a penalty for large weights); </li><li>  <code>rescale.grad</code> is the value by which the resulting gradient is multiplied before the weights are updated.  Often taken to be <code>1 / batch_size</code> ; </li><li>  <code>clip_gradient</code> - restriction of gradient values ‚Äã‚Äãby their projection onto the interval <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x2212;</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&amp;#xA0;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.913ex" height="2.78ex" viewBox="0 -832 12879.2 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2212" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="1057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="1490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="1789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="2134" y="0"></use><g transform="translate(2638,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="3327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="3779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="4308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="4832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="5177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="5644" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="6244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-2C" x="6606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-63" x="7051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6C" x="7484" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="7783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-70" x="8128" y="0"></use><g transform="translate(8632,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-67" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-72" x="9322" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-61" x="9773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-64" x="10303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-69" x="10826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-65" x="11172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-6E" x="11638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMATHI-74" x="12239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/354944/&amp;xid=25657,15700002,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibkJfRTg8r5d0ylBKGCG-hbaI-Rw#MJMAIN-5D" x="12600" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo>‚àí</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>,</mo><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi><msub><mtext>&nbsp;</mtext><mi>g</mi></msub><mi>r</mi><mi>a</mi><mi>d</mi><mi>i</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-12"> [- clip \ _gradient, clip \ _gradient] </script>  ; </li><li>  <code>lr_scheduler</code> - scheduler changes learning speed. </li></ul><br><h4 id="section8">  8. Callback Functions (Callbacks) </h4><br><p>  We will save the learning history using the appropriate callback function: </p><br><pre> <code class="hljs 1c">logger &lt;- mx.metric.logger() epoch.end.callback &lt;- mx.callback.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.train.metric( period = <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-meta"><span class="hljs-meta">#  , </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword"></span></span></span><span class="hljs-meta">    logger = logger)</span></span></code> </pre> <br><p>  After learning, the <code>logger</code> object will contain information like </p><br><pre> <code class="hljs perl">logger$train <span class="hljs-comment"><span class="hljs-comment"># [1] 2.322148818 0.318418684 0.044898842 0.011428233 0.009461375</span></span></code> </pre> <br><p>  Other callbacks: <code>mx.callback.early.stop()</code> is responsible for the early stop, <code>mx.callback.log.speedometer()</code> displays the processing speed with a specified frequency, <code>mx.callback.save.checkpoint()</code> saves the model at specified intervals in a file with given prefix. </p><br><h4 id="section9">  9. Model training </h4><br><p>  Learning is started by calling the <code>mx.model.FeedForward.create()</code> function described above: </p><br><pre> <code class="hljs xml">model <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">-</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mx.model.FeedForward.create</span></span></span><span class="hljs-tag">( </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">symbol</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">linreg,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">X</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">train_data,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ctx</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">mx.cpu(),</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">num.round</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">5,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">initializer</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">initializer,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">optimizer</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">optimizer,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">eval.metric</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">mx.metric.rmse,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">epoch.end.callback</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">epoch.end.callback)</span></span></span><span class="hljs-tag"> ## </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Start</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">training</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">with</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">devices</span></span></span><span class="hljs-tag"> ## [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag">] </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Train-rmse</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">2.39517188021255</span></span></span><span class="hljs-tag"> ## [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span><span class="hljs-tag">] </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Train-rmse</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">0.34100598193831</span></span></span><span class="hljs-tag"> ## [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">3</span></span></span><span class="hljs-tag">] </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Train-rmse</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">0.0498822148288494</span></span></span><span class="hljs-tag"> ## [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">4</span></span></span><span class="hljs-tag">] </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Train-rmse</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">0.0120600163293274</span></span></span><span class="hljs-tag"> ## [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">5</span></span></span><span class="hljs-tag">] </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Train-rmse</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">0.00946668211065784</span></span></span></span></code> </pre> <br><p>  Draw the history of learning: </p><br><pre> <code class="hljs lisp">plot(<span class="hljs-name"><span class="hljs-name">logger</span></span>$train, type = <span class="hljs-string"><span class="hljs-string">"l"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/gc/yd/cc/gcydccwjhlfceacpxitcl02il2e.png"><br><p>  Check how our model works: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">predict</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">model</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">t</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">X</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[1:5, ]</span></span>)) <span class="hljs-selector-tag"><span class="hljs-selector-tag">y</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[1:5]</span></span> ## <span class="hljs-selector-tag"><span class="hljs-selector-tag">Warning</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">in</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mx</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.model</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.select</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.layout</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.predict</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">X</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">model</span></span>): <span class="hljs-selector-tag"><span class="hljs-selector-tag">Auto</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">detect</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">layout</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">input</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">matrix</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">use</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">colmajor</span></span>.. ## <span class="hljs-selector-attr"><span class="hljs-selector-attr">[,1]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[,2]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[,3]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[,4]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[,5]</span></span> ## <span class="hljs-selector-attr"><span class="hljs-selector-attr">[1,]</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.3129134</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.070303</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.975691</span></span> 8<span class="hljs-selector-class"><span class="hljs-selector-class">.280487</span></span> 8<span class="hljs-selector-class"><span class="hljs-selector-class">.931004</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">y</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[1:5]</span></span> ## <span class="hljs-selector-attr"><span class="hljs-selector-attr">[1]</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.3211988</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.0561930</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.9810253</span></span> 8<span class="hljs-selector-class"><span class="hljs-selector-class">.2959409</span></span> 8<span class="hljs-selector-class"><span class="hljs-selector-class">.9414367</span></span></code> </pre> <br><p>  Everything works, you can move on to a more serious example! </p><br><h4 id="section10">  10. Solution of the regression problem on real data </h4><br><p>  Let us consider the solution of the regression problem on the example of predicting the degree of <a href="http://www.cyprotex.com/admepk/in-vitro-permeability/caco-2-permeability">penetrability</a> (in fact, the speed of passive diffusion) of a substance through a monolayer of cells based on the known properties of this substance (for more details, see <a href="http://biostat-r.blogspot.com/2017/04/pipelearner-aco2.html">here</a> ) </p><br><div class="spoiler">  <b class="spoiler_title">Why do you need it</b> <div class="spoiler_text"><p>  There is a special procedure for registration of generic drugs - the so-called <a href="http://www.dec.gov.ua/site/file_uploads/ua/sem/2_sem_bioekv/3.pdf">biowaiver</a> .  It implies an assessment of bioequivalence by conducting tests for solubility and permeability ( <em>in vitro</em> ) instead of comparative pharmacokinetic / pharmacodynamic / clinical trials ( <em>in vivo</em> ).  A monolayer of <a href="https://en.wikipedia.org/wiki/Caco-2">Caco2</a> cells is used as a standard model for assessing the <a href="https://en.wikipedia.org/wiki/Caco-2">penetrability of substances</a> .  If you learn to predict in advance the degree of penetrability, you will be able to more consciously approach the choice of candidate substances that are checked during experiments. </p></div></div><br><p>  The described task is dedicated to the work of the <a href="https://www.ncbi.nlm.nih.gov/pubmed/15446816">ADME evaluation in drug discovery.</a>  <a href="https://www.ncbi.nlm.nih.gov/pubmed/15446816">5. Correlation of Caco-2 permeation with simple molecular properties</a> .  It contains a table containing the characteristics of 77 substances of various structure, as well as experimental data on the permeability of these substances.  It should be noted that the data obtained for the same substance in the course of different experiments can vary considerably.  But we will not go into this aspect of the problem, but simply take the data that the authors of the publication worked with. </p><br><p>  Load the data using code created by the useful function <code>dump()</code> : </p><br><div class="spoiler">  <b class="spoiler_title">Data loading</b> <div class="spoiler_text"><pre> <code class="hljs lisp"># df &lt;- read_excel(<span class="hljs-string"><span class="hljs-string">"caco2.xlsx"</span></span>) # dump(<span class="hljs-string"><span class="hljs-string">"df"</span></span>, stdout()) df &lt;- structure(<span class="hljs-name"><span class="hljs-name">list</span></span>(<span class="hljs-name"><span class="hljs-name">name</span></span> = c(<span class="hljs-string"><span class="hljs-string">"acebutolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"acebutolol_ester"</span></span>, <span class="hljs-string"><span class="hljs-string">"acetylsalic_acid"</span></span>, <span class="hljs-string"><span class="hljs-string">"acyclovir"</span></span>, <span class="hljs-string"><span class="hljs-string">"alprenolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"alprenolol ester"</span></span>, <span class="hljs-string"><span class="hljs-string">"aminopyrin"</span></span>, <span class="hljs-string"><span class="hljs-string">"artemisinin"</span></span>, <span class="hljs-string"><span class="hljs-string">"artesunate"</span></span>, <span class="hljs-string"><span class="hljs-string">"atenolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"betazolol ester"</span></span>, <span class="hljs-string"><span class="hljs-string">"betazolol_"</span></span>, <span class="hljs-string"><span class="hljs-string">"bremazocine"</span></span>, <span class="hljs-string"><span class="hljs-string">"caffeine"</span></span>, <span class="hljs-string"><span class="hljs-string">"chloramphenicol"</span></span>, <span class="hljs-string"><span class="hljs-string">"chlorothiazide"</span></span>, <span class="hljs-string"><span class="hljs-string">"chlorpromazine"</span></span>, <span class="hljs-string"><span class="hljs-string">"cimetidine"</span></span>, <span class="hljs-string"><span class="hljs-string">"clonidine"</span></span>, <span class="hljs-string"><span class="hljs-string">"corticosterone"</span></span>, <span class="hljs-string"><span class="hljs-string">"desiprarnine"</span></span>, <span class="hljs-string"><span class="hljs-string">"dexamethas"</span></span>, <span class="hljs-string"><span class="hljs-string">"dexamethas_beta_D_glucoside"</span></span>, <span class="hljs-string"><span class="hljs-string">"dexamethas_beta_D_glucuronide"</span></span>, <span class="hljs-string"><span class="hljs-string">"diazepam"</span></span>, <span class="hljs-string"><span class="hljs-string">"dopamine"</span></span>, <span class="hljs-string"><span class="hljs-string">"doxorubici"</span></span>, <span class="hljs-string"><span class="hljs-string">"erythromycin"</span></span>, <span class="hljs-string"><span class="hljs-string">"estradiol"</span></span>, <span class="hljs-string"><span class="hljs-string">"felodipine"</span></span>, <span class="hljs-string"><span class="hljs-string">"ganciclovir"</span></span>, <span class="hljs-string"><span class="hljs-string">"griseofulvin"</span></span>, <span class="hljs-string"><span class="hljs-string">"hydrochlorothiazide"</span></span>, <span class="hljs-string"><span class="hljs-string">"hydrocortisone"</span></span>, <span class="hljs-string"><span class="hljs-string">"ibuprophen"</span></span>, <span class="hljs-string"><span class="hljs-string">"imipramine"</span></span>, <span class="hljs-string"><span class="hljs-string">"indomethacin"</span></span>, <span class="hljs-string"><span class="hljs-string">"labetalol"</span></span>, <span class="hljs-string"><span class="hljs-string">"mannitol"</span></span>, <span class="hljs-string"><span class="hljs-string">"meloxicam"</span></span>, <span class="hljs-string"><span class="hljs-string">"methanol"</span></span>, <span class="hljs-string"><span class="hljs-string">"methotrexate"</span></span>, <span class="hljs-string"><span class="hljs-string">"methylscopolamine"</span></span>, <span class="hljs-string"><span class="hljs-string">"metoprolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"nadolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"naproxen"</span></span>, <span class="hljs-string"><span class="hljs-string">"nevirapine"</span></span>, <span class="hljs-string"><span class="hljs-string">"nicotine"</span></span>, <span class="hljs-string"><span class="hljs-string">"olsalazine"</span></span>, <span class="hljs-string"><span class="hljs-string">"oxprenolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"oxprenolol ester"</span></span>, <span class="hljs-string"><span class="hljs-string">"phencyclidine"</span></span>, <span class="hljs-string"><span class="hljs-string">"Phenytoin"</span></span>, <span class="hljs-string"><span class="hljs-string">"pindolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"pirenzepine"</span></span>, <span class="hljs-string"><span class="hljs-string">"piroxicam"</span></span>, <span class="hljs-string"><span class="hljs-string">"pnu200603"</span></span>, <span class="hljs-string"><span class="hljs-string">"practolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"prazocin"</span></span>, <span class="hljs-string"><span class="hljs-string">"progesterone"</span></span>, <span class="hljs-string"><span class="hljs-string">"propranolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"propranolo_ester"</span></span>, <span class="hljs-string"><span class="hljs-string">"quinidine"</span></span>, <span class="hljs-string"><span class="hljs-string">"ranitidine"</span></span>, <span class="hljs-string"><span class="hljs-string">"salicylic acid"</span></span>, <span class="hljs-string"><span class="hljs-string">"scopolamine"</span></span>, <span class="hljs-string"><span class="hljs-string">"sucrose"</span></span>, <span class="hljs-string"><span class="hljs-string">"sulfasalazine"</span></span>, <span class="hljs-string"><span class="hljs-string">"telmisartan"</span></span>, <span class="hljs-string"><span class="hljs-string">"terbutaline"</span></span>, <span class="hljs-string"><span class="hljs-string">"tesosterone"</span></span>, <span class="hljs-string"><span class="hljs-string">"timolol"</span></span>, <span class="hljs-string"><span class="hljs-string">"timolol_ester"</span></span>, <span class="hljs-string"><span class="hljs-string">"uracil"</span></span>, <span class="hljs-string"><span class="hljs-string">"urea"</span></span>, <span class="hljs-string"><span class="hljs-string">"warfarine"</span></span>, <span class="hljs-string"><span class="hljs-string">"zidovudine"</span></span>), log_P_eff_exp = c(<span class="hljs-name"><span class="hljs-name">-5</span></span>.<span class="hljs-number"><span class="hljs-number">83</span></span>, <span class="hljs-number"><span class="hljs-number">-4.61</span></span>, <span class="hljs-number"><span class="hljs-number">-5.06</span></span>, <span class="hljs-number"><span class="hljs-number">-6.15</span></span>, <span class="hljs-number"><span class="hljs-number">-4.62</span></span>, <span class="hljs-number"><span class="hljs-number">-4.47</span></span>, <span class="hljs-number"><span class="hljs-number">-4.44</span></span>, <span class="hljs-number"><span class="hljs-number">-4.52</span></span>, <span class="hljs-number"><span class="hljs-number">-5.4</span></span>, <span class="hljs-number"><span class="hljs-number">-6.44</span></span>, <span class="hljs-number"><span class="hljs-number">-4.81</span></span>, <span class="hljs-number"><span class="hljs-number">-4.52</span></span>, <span class="hljs-number"><span class="hljs-number">-5.1</span></span>, <span class="hljs-number"><span class="hljs-number">-4.41</span></span>, <span class="hljs-number"><span class="hljs-number">-4.69</span></span>, <span class="hljs-number"><span class="hljs-number">-6.72</span></span>, <span class="hljs-number"><span class="hljs-number">-4.7</span></span>, <span class="hljs-number"><span class="hljs-number">-5.89</span></span>, <span class="hljs-number"><span class="hljs-number">-4.59</span></span>, <span class="hljs-number"><span class="hljs-number">-4.47</span></span>, <span class="hljs-number"><span class="hljs-number">-4.67</span></span>, <span class="hljs-number"><span class="hljs-number">-4.75</span></span>, <span class="hljs-number"><span class="hljs-number">-6.54</span></span>, <span class="hljs-number"><span class="hljs-number">-6.12</span></span>, <span class="hljs-number"><span class="hljs-number">-4.32</span></span>, <span class="hljs-number"><span class="hljs-number">-5.03</span></span>, <span class="hljs-number"><span class="hljs-number">-6.8</span></span>, <span class="hljs-number"><span class="hljs-number">-5.43</span></span>, <span class="hljs-number"><span class="hljs-number">-4.77</span></span>, <span class="hljs-number"><span class="hljs-number">-4.64</span></span>, <span class="hljs-number"><span class="hljs-number">-6.27</span></span>, <span class="hljs-number"><span class="hljs-number">-4.44</span></span>, <span class="hljs-number"><span class="hljs-number">-6.06</span></span>, <span class="hljs-number"><span class="hljs-number">-4.66</span></span>, <span class="hljs-number"><span class="hljs-number">-4.28</span></span>, <span class="hljs-number"><span class="hljs-number">-4.85</span></span>, <span class="hljs-number"><span class="hljs-number">-4.69</span></span>, <span class="hljs-number"><span class="hljs-number">-5.03</span></span>, <span class="hljs-number"><span class="hljs-number">-6.21</span></span>, <span class="hljs-number"><span class="hljs-number">-4.71</span></span>, <span class="hljs-number"><span class="hljs-number">-4.58</span></span>, <span class="hljs-number"><span class="hljs-number">-5.92</span></span>, <span class="hljs-number"><span class="hljs-number">-6.16</span></span>, <span class="hljs-number"><span class="hljs-number">-4.59</span></span>, <span class="hljs-number"><span class="hljs-number">-5.41</span></span>, <span class="hljs-number"><span class="hljs-number">-4.83</span></span>, <span class="hljs-number"><span class="hljs-number">-4.52</span></span>, <span class="hljs-number"><span class="hljs-number">-4.71</span></span>, <span class="hljs-number"><span class="hljs-number">-6.96</span></span>, <span class="hljs-number"><span class="hljs-number">-4.68</span></span>, <span class="hljs-number"><span class="hljs-number">-4.51</span></span>, <span class="hljs-number"><span class="hljs-number">-4.61</span></span>, <span class="hljs-number"><span class="hljs-number">-4.57</span></span>, <span class="hljs-number"><span class="hljs-number">-4.78</span></span>, <span class="hljs-number"><span class="hljs-number">-6.36</span></span>, <span class="hljs-number"><span class="hljs-number">-4.45</span></span>, <span class="hljs-number"><span class="hljs-number">-6.25</span></span>, <span class="hljs-number"><span class="hljs-number">-6.05</span></span>, <span class="hljs-number"><span class="hljs-number">-4.36</span></span>, <span class="hljs-number"><span class="hljs-number">-4.37</span></span>, <span class="hljs-number"><span class="hljs-number">-4.58</span></span>, <span class="hljs-number"><span class="hljs-number">-4.48</span></span>, <span class="hljs-number"><span class="hljs-number">-4.69</span></span>, <span class="hljs-number"><span class="hljs-number">-6.31</span></span>, <span class="hljs-number"><span class="hljs-number">-4.79</span></span>, <span class="hljs-number"><span class="hljs-number">-4.93</span></span>, <span class="hljs-number"><span class="hljs-number">-5.77</span></span>, <span class="hljs-number"><span class="hljs-number">-6.33</span></span>, <span class="hljs-number"><span class="hljs-number">-4.82</span></span>, <span class="hljs-number"><span class="hljs-number">-6.38</span></span>, <span class="hljs-number"><span class="hljs-number">-4.34</span></span>, <span class="hljs-number"><span class="hljs-number">-4.85</span></span>, <span class="hljs-number"><span class="hljs-number">-4.6</span></span>, <span class="hljs-number"><span class="hljs-number">-5.37</span></span>, <span class="hljs-number"><span class="hljs-number">-5.34</span></span>, <span class="hljs-number"><span class="hljs-number">-4.68</span></span>, <span class="hljs-number"><span class="hljs-number">-5.16</span></span>), log_D = c(<span class="hljs-name"><span class="hljs-name">-0</span></span>.<span class="hljs-number"><span class="hljs-number">09</span></span>, <span class="hljs-number"><span class="hljs-number">1.59</span></span>, <span class="hljs-number"><span class="hljs-number">-2.25</span></span>, <span class="hljs-number"><span class="hljs-number">-1.8</span></span>, <span class="hljs-number"><span class="hljs-number">1.38</span></span>, <span class="hljs-number"><span class="hljs-number">2.78</span></span>, <span class="hljs-number"><span class="hljs-number">0.63</span></span>, <span class="hljs-number"><span class="hljs-number">2.22</span></span>, <span class="hljs-number"><span class="hljs-number">-0.88</span></span>, <span class="hljs-number"><span class="hljs-number">-1.81</span></span>, <span class="hljs-number"><span class="hljs-number">0.28</span></span>, <span class="hljs-number"><span class="hljs-number">0.63</span></span>, <span class="hljs-number"><span class="hljs-number">1.66</span></span>, <span class="hljs-number"><span class="hljs-number">0.02</span></span>, <span class="hljs-number"><span class="hljs-number">1.14</span></span>, <span class="hljs-number"><span class="hljs-number">-1.15</span></span>, <span class="hljs-number"><span class="hljs-number">1.86</span></span>, <span class="hljs-number"><span class="hljs-number">-0.36</span></span>, <span class="hljs-number"><span class="hljs-number">0.78</span></span>, <span class="hljs-number"><span class="hljs-number">1.78</span></span>, <span class="hljs-number"><span class="hljs-number">1.57</span></span>, <span class="hljs-number"><span class="hljs-number">1.89</span></span>, <span class="hljs-number"><span class="hljs-number">0.58</span></span>, <span class="hljs-number"><span class="hljs-number">-1.59</span></span>, <span class="hljs-number"><span class="hljs-number">2.58</span></span>, <span class="hljs-number"><span class="hljs-number">-0.8</span></span>, <span class="hljs-number"><span class="hljs-number">-0.16</span></span>, <span class="hljs-number"><span class="hljs-number">1.26</span></span>, <span class="hljs-number"><span class="hljs-number">2.24</span></span>, <span class="hljs-number"><span class="hljs-number">3.48</span></span>, <span class="hljs-number"><span class="hljs-number">-0.87</span></span>, <span class="hljs-number"><span class="hljs-number">2.47</span></span>, <span class="hljs-number"><span class="hljs-number">-0.12</span></span>, <span class="hljs-number"><span class="hljs-number">1.48</span></span>, <span class="hljs-number"><span class="hljs-number">0.68</span></span>, <span class="hljs-number"><span class="hljs-number">2.52</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1.24</span></span>, <span class="hljs-number"><span class="hljs-number">-2.65</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">-0.7</span></span>, <span class="hljs-number"><span class="hljs-number">-2.53</span></span>, <span class="hljs-number"><span class="hljs-number">-1.14</span></span>, <span class="hljs-number"><span class="hljs-number">0.51</span></span>, <span class="hljs-number"><span class="hljs-number">0.68</span></span>, <span class="hljs-number"><span class="hljs-number">0.42</span></span>, <span class="hljs-number"><span class="hljs-number">1.81</span></span>, <span class="hljs-number"><span class="hljs-number">0.41</span></span>, <span class="hljs-number"><span class="hljs-number">-4.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.45</span></span>, <span class="hljs-number"><span class="hljs-number">1.98</span></span>, <span class="hljs-number"><span class="hljs-number">1.31</span></span>, <span class="hljs-number"><span class="hljs-number">2.26</span></span>, <span class="hljs-number"><span class="hljs-number">0.19</span></span>, <span class="hljs-number"><span class="hljs-number">-0.46</span></span>, <span class="hljs-number"><span class="hljs-number">-0.07</span></span>, <span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-number"><span class="hljs-number">-1.4</span></span>, <span class="hljs-number"><span class="hljs-number">1.88</span></span>, <span class="hljs-number"><span class="hljs-number">3.48</span></span>, <span class="hljs-number"><span class="hljs-number">1.55</span></span>, <span class="hljs-number"><span class="hljs-number">3.02</span></span>, <span class="hljs-number"><span class="hljs-number">2.04</span></span>, <span class="hljs-number"><span class="hljs-number">-0.12</span></span>, <span class="hljs-number"><span class="hljs-number">-1.44</span></span>, <span class="hljs-number"><span class="hljs-number">0.21</span></span>, <span class="hljs-number"><span class="hljs-number">-3.34</span></span>, <span class="hljs-number"><span class="hljs-number">-0.42</span></span>, <span class="hljs-number"><span class="hljs-number">2.41</span></span>, <span class="hljs-number"><span class="hljs-number">-1.07</span></span>, <span class="hljs-number"><span class="hljs-number">3.11</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">1.74</span></span>, <span class="hljs-number"><span class="hljs-number">-1.11</span></span>, <span class="hljs-number"><span class="hljs-number">-1.64</span></span>, <span class="hljs-number"><span class="hljs-number">0.64</span></span>, <span class="hljs-number"><span class="hljs-number">-0.58</span></span>), rgyr = c(<span class="hljs-number"><span class="hljs-number">4.64</span></span>, <span class="hljs-number"><span class="hljs-number">5.12</span></span>, <span class="hljs-number"><span class="hljs-number">3.41</span></span>, <span class="hljs-number"><span class="hljs-number">3.37</span></span>, <span class="hljs-number"><span class="hljs-number">3.68</span></span>, <span class="hljs-number"><span class="hljs-number">3.84</span></span>, <span class="hljs-number"><span class="hljs-number">2.97</span></span>, <span class="hljs-number"><span class="hljs-number">2.75</span></span>, <span class="hljs-number"><span class="hljs-number">4.02</span></span>, <span class="hljs-number"><span class="hljs-number">4.58</span></span>, <span class="hljs-number"><span class="hljs-number">5.41</span></span>, <span class="hljs-number"><span class="hljs-number">5.64</span></span>, <span class="hljs-number"><span class="hljs-number">3.43</span></span>, <span class="hljs-number"><span class="hljs-number">2.47</span></span>, <span class="hljs-number"><span class="hljs-number">3.75</span></span>, <span class="hljs-number"><span class="hljs-number">3.11</span></span>, <span class="hljs-number"><span class="hljs-number">3.74</span></span>, <span class="hljs-number"><span class="hljs-number">4.26</span></span>, <span class="hljs-number"><span class="hljs-number">2.79</span></span>, <span class="hljs-number"><span class="hljs-number">3.68</span></span>, <span class="hljs-number"><span class="hljs-number">3.4</span></span>, <span class="hljs-number"><span class="hljs-number">3.6</span></span>, <span class="hljs-number"><span class="hljs-number">5.67</span></span>, <span class="hljs-number"><span class="hljs-number">5.75</span></span>, <span class="hljs-number"><span class="hljs-number">3.28</span></span>, <span class="hljs-number"><span class="hljs-number">2.67</span></span>, <span class="hljs-number"><span class="hljs-number">4.85</span></span>, <span class="hljs-number"><span class="hljs-number">4.99</span></span>, <span class="hljs-number"><span class="hljs-number">3.44</span></span>, <span class="hljs-number"><span class="hljs-number">3.39</span></span>, <span class="hljs-number"><span class="hljs-number">3.7</span></span>, <span class="hljs-number"><span class="hljs-number">3.37</span></span>, <span class="hljs-number"><span class="hljs-number">3.11</span></span>, <span class="hljs-number"><span class="hljs-number">3.72</span></span>, <span class="hljs-number"><span class="hljs-number">3.45</span></span>, <span class="hljs-number"><span class="hljs-number">3.44</span></span>, <span class="hljs-number"><span class="hljs-number">4.16</span></span>, <span class="hljs-number"><span class="hljs-number">4.61</span></span>, <span class="hljs-number"><span class="hljs-number">2.48</span></span>, <span class="hljs-number"><span class="hljs-number">3.34</span></span>, <span class="hljs-number"><span class="hljs-number">0.84</span></span>, <span class="hljs-number"><span class="hljs-number">5.33</span></span>, <span class="hljs-number"><span class="hljs-number">3.67</span></span>, <span class="hljs-number"><span class="hljs-number">4.59</span></span>, <span class="hljs-number"><span class="hljs-number">4.37</span></span>, <span class="hljs-number"><span class="hljs-number">3.38</span></span>, <span class="hljs-number"><span class="hljs-number">2.94</span></span>, <span class="hljs-number"><span class="hljs-number">2.5</span></span>, <span class="hljs-number"><span class="hljs-number">4.62</span></span>, <span class="hljs-number"><span class="hljs-number">3.63</span></span>, <span class="hljs-number"><span class="hljs-number">3.87</span></span>, <span class="hljs-number"><span class="hljs-number">2.91</span></span>, <span class="hljs-number"><span class="hljs-number">2.97</span></span>, <span class="hljs-number"><span class="hljs-number">3.71</span></span>, <span class="hljs-number"><span class="hljs-number">3.55</span></span>, <span class="hljs-number"><span class="hljs-number">3.17</span></span>, <span class="hljs-number"><span class="hljs-number">3.89</span></span>, <span class="hljs-number"><span class="hljs-number">4.02</span></span>, <span class="hljs-number"><span class="hljs-number">4.96</span></span>, <span class="hljs-number"><span class="hljs-number">3.58</span></span>, <span class="hljs-number"><span class="hljs-number">3.63</span></span>, <span class="hljs-number"><span class="hljs-number">4.13</span></span>, <span class="hljs-number"><span class="hljs-number">3.25</span></span>, <span class="hljs-number"><span class="hljs-number">5.13</span></span>, <span class="hljs-number"><span class="hljs-number">2.14</span></span>, <span class="hljs-number"><span class="hljs-number">3.63</span></span>, <span class="hljs-number"><span class="hljs-number">3.49</span></span>, <span class="hljs-number"><span class="hljs-number">5.68</span></span>, <span class="hljs-number"><span class="hljs-number">5.29</span></span>, <span class="hljs-number"><span class="hljs-number">3.15</span></span>, <span class="hljs-number"><span class="hljs-number">3.33</span></span>, <span class="hljs-number"><span class="hljs-number">4.02</span></span>, <span class="hljs-number"><span class="hljs-number">3.98</span></span>, <span class="hljs-number"><span class="hljs-number">1.84</span></span>, <span class="hljs-number"><span class="hljs-number">1.23</span></span>, <span class="hljs-number"><span class="hljs-number">3.45</span></span>, <span class="hljs-number"><span class="hljs-number">3.14</span></span>), rgyr_d = c(<span class="hljs-number"><span class="hljs-number">4.51</span></span>, <span class="hljs-number"><span class="hljs-number">5.03</span></span>, <span class="hljs-number"><span class="hljs-number">3.24</span></span>, <span class="hljs-number"><span class="hljs-number">3.23</span></span>, <span class="hljs-number"><span class="hljs-number">3.69</span></span>, <span class="hljs-number"><span class="hljs-number">3.88</span></span>, <span class="hljs-number"><span class="hljs-number">2.97</span></span>, <span class="hljs-number"><span class="hljs-number">2.75</span></span>, <span class="hljs-number"><span class="hljs-number">3.62</span></span>, <span class="hljs-number"><span class="hljs-number">4.52</span></span>, <span class="hljs-number"><span class="hljs-number">5.27</span></span>, <span class="hljs-number"><span class="hljs-number">5.39</span></span>, <span class="hljs-number"><span class="hljs-number">3.38</span></span>, <span class="hljs-number"><span class="hljs-number">2.47</span></span>, <span class="hljs-number"><span class="hljs-number">3.73</span></span>, <span class="hljs-number"><span class="hljs-number">3.11</span></span>, <span class="hljs-number"><span class="hljs-number">3.69</span></span>, <span class="hljs-number"><span class="hljs-number">4.24</span></span>, <span class="hljs-number"><span class="hljs-number">2.79</span></span>, <span class="hljs-number"><span class="hljs-number">3.71</span></span>, <span class="hljs-number"><span class="hljs-number">3.42</span></span>, <span class="hljs-number"><span class="hljs-number">3.66</span></span>, <span class="hljs-number"><span class="hljs-number">5.28</span></span>, <span class="hljs-number"><span class="hljs-number">5.23</span></span>, <span class="hljs-number"><span class="hljs-number">3.28</span></span>, <span class="hljs-number"><span class="hljs-number">2.68</span></span>, <span class="hljs-number"><span class="hljs-number">4.9</span></span>, <span class="hljs-number"><span class="hljs-number">5.01</span></span>, <span class="hljs-number"><span class="hljs-number">3.44</span></span>, <span class="hljs-number"><span class="hljs-number">3.48</span></span>, <span class="hljs-number"><span class="hljs-number">3.48</span></span>, <span class="hljs-number"><span class="hljs-number">3.37</span></span>, <span class="hljs-number"><span class="hljs-number">3.11</span></span>, <span class="hljs-number"><span class="hljs-number">3.79</span></span>, <span class="hljs-number"><span class="hljs-number">3.36</span></span>, <span class="hljs-number"><span class="hljs-number">3.45</span></span>, <span class="hljs-number"><span class="hljs-number">3.16</span></span>, <span class="hljs-number"><span class="hljs-number">4.46</span></span>, <span class="hljs-number"><span class="hljs-number">2.59</span></span>, <span class="hljs-number"><span class="hljs-number">3.36</span></span>, <span class="hljs-number"><span class="hljs-number">0.84</span></span>, <span class="hljs-number"><span class="hljs-number">5.18</span></span>, <span class="hljs-number"><span class="hljs-number">3.74</span></span>, <span class="hljs-number"><span class="hljs-number">4.53</span></span>, <span class="hljs-number"><span class="hljs-number">4.1</span></span>, <span class="hljs-number"><span class="hljs-number">3.43</span></span>, <span class="hljs-number"><span class="hljs-number">2.94</span></span>, <span class="hljs-number"><span class="hljs-number">2.5</span></span>, <span class="hljs-number"><span class="hljs-number">4.37</span></span>, <span class="hljs-number"><span class="hljs-number">3.56</span></span>, <span class="hljs-number"><span class="hljs-number">3.9</span></span>, <span class="hljs-number"><span class="hljs-number">2.91</span></span>, <span class="hljs-number"><span class="hljs-number">2.97</span></span>, <span class="hljs-number"><span class="hljs-number">3.71</span></span>, <span class="hljs-number"><span class="hljs-number">3.4</span></span>, <span class="hljs-number"><span class="hljs-number">3.26</span></span>, <span class="hljs-number"><span class="hljs-number">3.79</span></span>, <span class="hljs-number"><span class="hljs-number">4.09</span></span>, <span class="hljs-number"><span class="hljs-number">4.99</span></span>, <span class="hljs-number"><span class="hljs-number">3.62</span></span>, <span class="hljs-number"><span class="hljs-number">3.53</span></span>, <span class="hljs-number"><span class="hljs-number">4.06</span></span>, <span class="hljs-number"><span class="hljs-number">3.3</span></span>, <span class="hljs-number"><span class="hljs-number">4.57</span></span>, <span class="hljs-number"><span class="hljs-number">2.14</span></span>, <span class="hljs-number"><span class="hljs-number">3.49</span></span>, <span class="hljs-number"><span class="hljs-number">3.54</span></span>, <span class="hljs-number"><span class="hljs-number">5.53</span></span>, <span class="hljs-number"><span class="hljs-number">5.01</span></span>, <span class="hljs-number"><span class="hljs-number">3.15</span></span>, <span class="hljs-number"><span class="hljs-number">3.33</span></span>, <span class="hljs-number"><span class="hljs-number">4.01</span></span>, <span class="hljs-number"><span class="hljs-number">4.13</span></span>, <span class="hljs-number"><span class="hljs-number">1.84</span></span>, <span class="hljs-number"><span class="hljs-number">1.23</span></span>, <span class="hljs-number"><span class="hljs-number">3.5</span></span>, <span class="hljs-number"><span class="hljs-number">3.13</span></span>), HCPSA = c(<span class="hljs-number"><span class="hljs-number">82.88</span></span>, <span class="hljs-number"><span class="hljs-number">77.08</span></span>, <span class="hljs-number"><span class="hljs-number">79.38</span></span>, <span class="hljs-number"><span class="hljs-number">120.63</span></span>, <span class="hljs-number"><span class="hljs-number">38.92</span></span>, <span class="hljs-number"><span class="hljs-number">35.53</span></span>, <span class="hljs-number"><span class="hljs-number">20.81</span></span>, <span class="hljs-number"><span class="hljs-number">54.27</span></span>, <span class="hljs-number"><span class="hljs-number">102.05</span></span>, <span class="hljs-number"><span class="hljs-number">86.82</span></span>, <span class="hljs-number"><span class="hljs-number">43.02</span></span>, <span class="hljs-number"><span class="hljs-number">47.14</span></span>, <span class="hljs-number"><span class="hljs-number">49.56</span></span>, <span class="hljs-number"><span class="hljs-number">45.55</span></span>, <span class="hljs-number"><span class="hljs-number">113.73</span></span>, <span class="hljs-number"><span class="hljs-number">138.76</span></span>, <span class="hljs-number"><span class="hljs-number">4.6</span></span>, <span class="hljs-number"><span class="hljs-number">105.44</span></span>, <span class="hljs-number"><span class="hljs-number">30.03</span></span>, <span class="hljs-number"><span class="hljs-number">75.95</span></span>, <span class="hljs-number"><span class="hljs-number">13.8</span></span>, <span class="hljs-number"><span class="hljs-number">90.74</span></span>, <span class="hljs-number"><span class="hljs-number">163.95</span></span>, <span class="hljs-number"><span class="hljs-number">186.88</span></span>, <span class="hljs-number"><span class="hljs-number">25.93</span></span>, <span class="hljs-number"><span class="hljs-number">75.13</span></span>, <span class="hljs-number"><span class="hljs-number">186.78</span></span>, <span class="hljs-number"><span class="hljs-number">138.69</span></span>, <span class="hljs-number"><span class="hljs-number">44.34</span></span>, <span class="hljs-number"><span class="hljs-number">50.34</span></span>, <span class="hljs-number"><span class="hljs-number">139.45</span></span>, <span class="hljs-number"><span class="hljs-number">67.55</span></span>, <span class="hljs-number"><span class="hljs-number">142.85</span></span>, <span class="hljs-number"><span class="hljs-number">93.37</span></span>, <span class="hljs-number"><span class="hljs-number">39.86</span></span>, <span class="hljs-number"><span class="hljs-number">3.56</span></span>, <span class="hljs-number"><span class="hljs-number">67.13</span></span>, <span class="hljs-number"><span class="hljs-number">93.29</span></span>, <span class="hljs-number"><span class="hljs-number">127.46</span></span>, <span class="hljs-number"><span class="hljs-number">93.21</span></span>, <span class="hljs-number"><span class="hljs-number">25.64</span></span>, <span class="hljs-number"><span class="hljs-number">204.96</span></span>, <span class="hljs-number"><span class="hljs-number">51.29</span></span>, <span class="hljs-number"><span class="hljs-number">44.88</span></span>, <span class="hljs-number"><span class="hljs-number">86.73</span></span>, <span class="hljs-number"><span class="hljs-number">76.98</span></span>, <span class="hljs-number"><span class="hljs-number">36.68</span></span>, <span class="hljs-number"><span class="hljs-number">15.1</span></span>, <span class="hljs-number"><span class="hljs-number">144.08</span></span>, <span class="hljs-number"><span class="hljs-number">48.62</span></span>, <span class="hljs-number"><span class="hljs-number">49.58</span></span>, <span class="hljs-number"><span class="hljs-number">1.49</span></span>, <span class="hljs-number"><span class="hljs-number">65.63</span></span>, <span class="hljs-number"><span class="hljs-number">52.8</span></span>, <span class="hljs-number"><span class="hljs-number">59.71</span></span>, <span class="hljs-number"><span class="hljs-number">99.19</span></span>, <span class="hljs-number"><span class="hljs-number">69.89</span></span>, <span class="hljs-number"><span class="hljs-number">64.79</span></span>, <span class="hljs-number"><span class="hljs-number">86.76</span></span>, <span class="hljs-number"><span class="hljs-number">38.1</span></span>, <span class="hljs-number"><span class="hljs-number">40.42</span></span>, <span class="hljs-number"><span class="hljs-number">36.21</span></span>, <span class="hljs-number"><span class="hljs-number">43.77</span></span>, <span class="hljs-number"><span class="hljs-number">105.15</span></span>, <span class="hljs-number"><span class="hljs-number">61.71</span></span>, <span class="hljs-number"><span class="hljs-number">57.35</span></span>, <span class="hljs-number"><span class="hljs-number">187.69</span></span>, <span class="hljs-number"><span class="hljs-number">133.67</span></span>, <span class="hljs-number"><span class="hljs-number">55.48</span></span>, <span class="hljs-number"><span class="hljs-number">79.52</span></span>, <span class="hljs-number"><span class="hljs-number">42.35</span></span>, <span class="hljs-number"><span class="hljs-number">100.74</span></span>, <span class="hljs-number"><span class="hljs-number">96.25</span></span>, <span class="hljs-number"><span class="hljs-number">66.72</span></span>, <span class="hljs-number"><span class="hljs-number">82.72</span></span>, <span class="hljs-number"><span class="hljs-number">59.47</span></span>, <span class="hljs-number"><span class="hljs-number">96.33</span></span>), TPSA = c(<span class="hljs-number"><span class="hljs-number">87.66</span></span>, <span class="hljs-number"><span class="hljs-number">93.73</span></span>, <span class="hljs-number"><span class="hljs-number">89.9</span></span>, <span class="hljs-number"><span class="hljs-number">114.76</span></span>, <span class="hljs-number"><span class="hljs-number">41.49</span></span>, <span class="hljs-number"><span class="hljs-number">47.56</span></span>, <span class="hljs-number"><span class="hljs-number">26.79</span></span>, <span class="hljs-number"><span class="hljs-number">53.99</span></span>, <span class="hljs-number"><span class="hljs-number">100.52</span></span>, <span class="hljs-number"><span class="hljs-number">84.58</span></span>, <span class="hljs-number"><span class="hljs-number">50.72</span></span>, <span class="hljs-number"><span class="hljs-number">56.79</span></span>, <span class="hljs-number"><span class="hljs-number">43.7</span></span>, <span class="hljs-number"><span class="hljs-number">58.44</span></span>, <span class="hljs-number"><span class="hljs-number">115.38</span></span>, <span class="hljs-number"><span class="hljs-number">118.69</span></span>, <span class="hljs-number"><span class="hljs-number">6.48</span></span>, <span class="hljs-number"><span class="hljs-number">88.89</span></span>, <span class="hljs-number"><span class="hljs-number">36.42</span></span>, <span class="hljs-number"><span class="hljs-number">74.6</span></span>, <span class="hljs-number"><span class="hljs-number">15.27</span></span>, <span class="hljs-number"><span class="hljs-number">94.83</span></span>, <span class="hljs-number"><span class="hljs-number">173.98</span></span>, <span class="hljs-number"><span class="hljs-number">191.05</span></span>, <span class="hljs-number"><span class="hljs-number">32.67</span></span>, <span class="hljs-number"><span class="hljs-number">66.48</span></span>, <span class="hljs-number"><span class="hljs-number">206.07</span></span>, <span class="hljs-number"><span class="hljs-number">193.91</span></span>, <span class="hljs-number"><span class="hljs-number">40.46</span></span>, <span class="hljs-number"><span class="hljs-number">64.63</span></span>, <span class="hljs-number"><span class="hljs-number">134.99</span></span>, <span class="hljs-number"><span class="hljs-number">71.06</span></span>, <span class="hljs-number"><span class="hljs-number">118.36</span></span>, <span class="hljs-number"><span class="hljs-number">94.83</span></span>, <span class="hljs-number"><span class="hljs-number">37.3</span></span>, <span class="hljs-number"><span class="hljs-number">6.48</span></span>, <span class="hljs-number"><span class="hljs-number">68.53</span></span>, <span class="hljs-number"><span class="hljs-number">95.58</span></span>, <span class="hljs-number"><span class="hljs-number">121.38</span></span>, <span class="hljs-number"><span class="hljs-number">99.6</span></span>, <span class="hljs-number"><span class="hljs-number">20.23</span></span>, <span class="hljs-number"><span class="hljs-number">210.54</span></span>, <span class="hljs-number"><span class="hljs-number">59.06</span></span>, <span class="hljs-number"><span class="hljs-number">50.72</span></span>, <span class="hljs-number"><span class="hljs-number">81.95</span></span>, <span class="hljs-number"><span class="hljs-number">46.53</span></span>, <span class="hljs-number"><span class="hljs-number">58.12</span></span>, <span class="hljs-number"><span class="hljs-number">16.13</span></span>, <span class="hljs-number"><span class="hljs-number">139.78</span></span>, <span class="hljs-number"><span class="hljs-number">50.72</span></span>, <span class="hljs-number"><span class="hljs-number">56.79</span></span>, <span class="hljs-number"><span class="hljs-number">3.24</span></span>, <span class="hljs-number"><span class="hljs-number">58.2</span></span>, <span class="hljs-number"><span class="hljs-number">57.28</span></span>, <span class="hljs-number"><span class="hljs-number">68.78</span></span>, <span class="hljs-number"><span class="hljs-number">99.6</span></span>, <span class="hljs-number"><span class="hljs-number">91.44</span></span>, <span class="hljs-number"><span class="hljs-number">70.59</span></span>, <span class="hljs-number"><span class="hljs-number">106.95</span></span>, <span class="hljs-number"><span class="hljs-number">34.14</span></span>, <span class="hljs-number"><span class="hljs-number">41.49</span></span>, <span class="hljs-number"><span class="hljs-number">47.56</span></span>, <span class="hljs-number"><span class="hljs-number">45.59</span></span>, <span class="hljs-number"><span class="hljs-number">86.26</span></span>, <span class="hljs-number"><span class="hljs-number">57.53</span></span>, <span class="hljs-number"><span class="hljs-number">62.3</span></span>, <span class="hljs-number"><span class="hljs-number">189.53</span></span>, <span class="hljs-number"><span class="hljs-number">141.31</span></span>, <span class="hljs-number"><span class="hljs-number">72.94</span></span>, <span class="hljs-number"><span class="hljs-number">72.72</span></span>, <span class="hljs-number"><span class="hljs-number">37.3</span></span>, <span class="hljs-number"><span class="hljs-number">79.74</span></span>, <span class="hljs-number"><span class="hljs-number">85.81</span></span>, <span class="hljs-number"><span class="hljs-number">58.2</span></span>, <span class="hljs-number"><span class="hljs-number">69.11</span></span>, <span class="hljs-number"><span class="hljs-number">63.6</span></span>, <span class="hljs-number"><span class="hljs-number">103.59</span></span>), N_rotb = c(<span class="hljs-number"><span class="hljs-number">0.31</span></span>, <span class="hljs-number"><span class="hljs-number">0.29</span></span>, <span class="hljs-number"><span class="hljs-number">0.23</span></span>, <span class="hljs-number"><span class="hljs-number">0.21</span></span>, <span class="hljs-number"><span class="hljs-number">0.29</span></span>, <span class="hljs-number"><span class="hljs-number">0.27</span></span>, <span class="hljs-number"><span class="hljs-number">0.17</span></span>, <span class="hljs-number"><span class="hljs-number">0.07</span></span>, <span class="hljs-number"><span class="hljs-number">0.16</span></span>, <span class="hljs-number"><span class="hljs-number">0.29</span></span>, <span class="hljs-number"><span class="hljs-number">0.27</span></span>, <span class="hljs-number"><span class="hljs-number">0.26</span></span>, <span class="hljs-number"><span class="hljs-number">0.15</span></span>, <span class="hljs-number"><span class="hljs-number">0.12</span></span>, <span class="hljs-number"><span class="hljs-number">0.28</span></span>, <span class="hljs-number"><span class="hljs-number">0.08</span></span>, <span class="hljs-number"><span class="hljs-number">0.14</span></span>, <span class="hljs-number"><span class="hljs-number">0.33</span></span>, <span class="hljs-number"><span class="hljs-number">0.08</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">0.11</span></span>, <span class="hljs-number"><span class="hljs-number">0.13</span></span>, <span class="hljs-number"><span class="hljs-number">0.17</span></span>, <span class="hljs-number"><span class="hljs-number">0.17</span></span>, <span class="hljs-number"><span class="hljs-number">0.06</span></span>, <span class="hljs-number"><span class="hljs-number">0.23</span></span>, <span class="hljs-number"><span class="hljs-number">0.18</span></span>, <span class="hljs-number"><span class="hljs-number">0.21</span></span>, <span class="hljs-number"><span class="hljs-number">0.06</span></span>, <span class="hljs-number"><span class="hljs-number">0.22</span></span>, <span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">0.16</span></span>, <span class="hljs-number"><span class="hljs-number">0.08</span></span>, <span class="hljs-number"><span class="hljs-number">0.12</span></span>, <span class="hljs-number"><span class="hljs-number">0.24</span></span>, <span class="hljs-number"><span class="hljs-number">0.13</span></span>, <span class="hljs-number"><span class="hljs-number">0.19</span></span>, <span class="hljs-number"><span class="hljs-number">0.24</span></span>, <span class="hljs-number"><span class="hljs-number">0.44</span></span>, <span class="hljs-number"><span class="hljs-number">0.16</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">0.26</span></span>, <span class="hljs-number"><span class="hljs-number">0.16</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-number"><span class="hljs-number">0.24</span></span>, <span class="hljs-number"><span class="hljs-number">0.19</span></span>, <span class="hljs-number"><span class="hljs-number">0.05</span></span>, <span class="hljs-number"><span class="hljs-number">0.07</span></span>, <span class="hljs-number"><span class="hljs-number">0.27</span></span>, <span class="hljs-number"><span class="hljs-number">0.31</span></span>, <span class="hljs-number"><span class="hljs-number">0.29</span></span>, <span class="hljs-number"><span class="hljs-number">0.04</span></span>, <span class="hljs-number"><span class="hljs-number">0.06</span></span>, <span class="hljs-number"><span class="hljs-number">0.23</span></span>, <span class="hljs-number"><span class="hljs-number">0.08</span></span>, <span class="hljs-number"><span class="hljs-number">0.13</span></span>, <span class="hljs-number"><span class="hljs-number">0.15</span></span>, <span class="hljs-number"><span class="hljs-number">0.29</span></span>, <span class="hljs-number"><span class="hljs-number">0.15</span></span>, <span class="hljs-number"><span class="hljs-number">0.07</span></span>, <span class="hljs-number"><span class="hljs-number">0.22</span></span>, <span class="hljs-number"><span class="hljs-number">0.22</span></span>, <span class="hljs-number"><span class="hljs-number">0.14</span></span>, <span class="hljs-number"><span class="hljs-number">0.33</span></span>, <span class="hljs-number"><span class="hljs-number">0.19</span></span>, <span class="hljs-number"><span class="hljs-number">0.15</span></span>, <span class="hljs-number"><span class="hljs-number">0.28</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>, <span class="hljs-number"><span class="hljs-number">0.15</span></span>, <span class="hljs-number"><span class="hljs-number">0.29</span></span>, <span class="hljs-number"><span class="hljs-number">0.06</span></span>, <span class="hljs-number"><span class="hljs-number">0.24</span></span>, <span class="hljs-number"><span class="hljs-number">0.23</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.29</span></span>, <span class="hljs-number"><span class="hljs-number">0.15</span></span>, <span class="hljs-number"><span class="hljs-number">0.18</span></span>), log_P_eff_calc = c(<span class="hljs-name"><span class="hljs-name">-5</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">-4.89</span></span>, <span class="hljs-number"><span class="hljs-number">-5.77</span></span>, <span class="hljs-number"><span class="hljs-number">-5.91</span></span>, <span class="hljs-number"><span class="hljs-number">-4.58</span></span>, <span class="hljs-number"><span class="hljs-number">-4.39</span></span>, <span class="hljs-number"><span class="hljs-number">-4.63</span></span>, <span class="hljs-number"><span class="hljs-number">-4.47</span></span>, <span class="hljs-number"><span class="hljs-number">-5.64</span></span>, <span class="hljs-number"><span class="hljs-number">-5.85</span></span>, <span class="hljs-number"><span class="hljs-number">-5.2</span></span>, <span class="hljs-number"><span class="hljs-number">-5.13</span></span>, <span class="hljs-number"><span class="hljs-number">-4.57</span></span>, <span class="hljs-number"><span class="hljs-number">-4.89</span></span>, <span class="hljs-number"><span class="hljs-number">-5.11</span></span>, <span class="hljs-number"><span class="hljs-number">-5.87</span></span>, <span class="hljs-number"><span class="hljs-number">-4.38</span></span>, <span class="hljs-number"><span class="hljs-number">-5.55</span></span>, <span class="hljs-number"><span class="hljs-number">-4.69</span></span>, <span class="hljs-number"><span class="hljs-number">-4.78</span></span>, <span class="hljs-number"><span class="hljs-number">-4.46</span></span>, <span class="hljs-number"><span class="hljs-number">-4.77</span></span>, <span class="hljs-number"><span class="hljs-number">-5.83</span></span>, <span class="hljs-number"><span class="hljs-number">-6.55</span></span>, <span class="hljs-number"><span class="hljs-number">-4.45</span></span>, <span class="hljs-number"><span class="hljs-number">-5.27</span></span>, <span class="hljs-number"><span class="hljs-number">-6</span></span>, <span class="hljs-number"><span class="hljs-number">-5.13</span></span>, <span class="hljs-number"><span class="hljs-number">-4.57</span></span>, <span class="hljs-number"><span class="hljs-number">-4.44</span></span>, <span class="hljs-number"><span class="hljs-number">-5.79</span></span>, <span class="hljs-number"><span class="hljs-number">-4.59</span></span>, <span class="hljs-number"><span class="hljs-number">-5.62</span></span>, <span class="hljs-number"><span class="hljs-number">-4.94</span></span>, <span class="hljs-number"><span class="hljs-number">-4.78</span></span>, <span class="hljs-number"><span class="hljs-number">-4.28</span></span>, <span class="hljs-number"><span class="hljs-number">-5</span></span>, <span class="hljs-number"><span class="hljs-number">-5.09</span></span>, <span class="hljs-number"><span class="hljs-number">-5.87</span></span>, <span class="hljs-number"><span class="hljs-number">-5.27</span></span>, <span class="hljs-number"><span class="hljs-number">-4.67</span></span>, <span class="hljs-number"><span class="hljs-number">-6.79</span></span>, <span class="hljs-number"><span class="hljs-number">-5.37</span></span>, <span class="hljs-number"><span class="hljs-number">-4.99</span></span>, <span class="hljs-number"><span class="hljs-number">-5.15</span></span>, <span class="hljs-number"><span class="hljs-number">-5.09</span></span>, <span class="hljs-number"><span class="hljs-number">-4.49</span></span>, <span class="hljs-number"><span class="hljs-number">-4.65</span></span>, <span class="hljs-number"><span class="hljs-number">-6.97</span></span>, <span class="hljs-number"><span class="hljs-number">-4.84</span></span>, <span class="hljs-number"><span class="hljs-number">-4.45</span></span>, <span class="hljs-number"><span class="hljs-number">-4.42</span></span>, <span class="hljs-number"><span class="hljs-number">-4.6</span></span>, <span class="hljs-number"><span class="hljs-number">-5.02</span></span>, <span class="hljs-number"><span class="hljs-number">-5.3</span></span>, <span class="hljs-number"><span class="hljs-number">-5.31</span></span>, <span class="hljs-number"><span class="hljs-number">-6.37</span></span>, <span class="hljs-number"><span class="hljs-number">-5.5</span></span>, <span class="hljs-number"><span class="hljs-number">-5.05</span></span>, <span class="hljs-number"><span class="hljs-number">-4.54</span></span>, <span class="hljs-number"><span class="hljs-number">-4.57</span></span>, <span class="hljs-number"><span class="hljs-number">-4.5</span></span>, <span class="hljs-number"><span class="hljs-number">-4.46</span></span>, <span class="hljs-number"><span class="hljs-number">-5.6</span></span>, <span class="hljs-number"><span class="hljs-number">-5.29</span></span>, <span class="hljs-number"><span class="hljs-number">-5.07</span></span>, <span class="hljs-number"><span class="hljs-number">-6.56</span></span>, <span class="hljs-number"><span class="hljs-number">-6.06</span></span>, <span class="hljs-number"><span class="hljs-number">-4.85</span></span>, <span class="hljs-number"><span class="hljs-number">-5.36</span></span>, <span class="hljs-number"><span class="hljs-number">-4.53</span></span>, <span class="hljs-number"><span class="hljs-number">-5.35</span></span>, <span class="hljs-number"><span class="hljs-number">-4.82</span></span>, <span class="hljs-number"><span class="hljs-number">-5.23</span></span>, <span class="hljs-number"><span class="hljs-number">-5.29</span></span>, <span class="hljs-number"><span class="hljs-number">-4.95</span></span>, <span class="hljs-number"><span class="hljs-number">-5.43</span></span>), residuals = c(<span class="hljs-name"><span class="hljs-name">-0</span></span>.<span class="hljs-number"><span class="hljs-number">53</span></span>, <span class="hljs-number"><span class="hljs-number">0.28</span></span>, <span class="hljs-number"><span class="hljs-number">0.71</span></span>, <span class="hljs-number"><span class="hljs-number">-0.24</span></span>, <span class="hljs-number"><span class="hljs-number">-0.04</span></span>, <span class="hljs-number"><span class="hljs-number">-0.08</span></span>, <span class="hljs-number"><span class="hljs-number">0.19</span></span>, <span class="hljs-number"><span class="hljs-number">-0.05</span></span>, <span class="hljs-number"><span class="hljs-number">0.24</span></span>, <span class="hljs-number"><span class="hljs-number">-0.59</span></span>, <span class="hljs-number"><span class="hljs-number">0.39</span></span>, <span class="hljs-number"><span class="hljs-number">0.61</span></span>, <span class="hljs-number"><span class="hljs-number">-0.53</span></span>, <span class="hljs-number"><span class="hljs-number">0.48</span></span>, <span class="hljs-number"><span class="hljs-number">0.42</span></span>, <span class="hljs-number"><span class="hljs-number">-0.85</span></span>, <span class="hljs-number"><span class="hljs-number">-0.32</span></span>, <span class="hljs-number"><span class="hljs-number">-0.34</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">0.31</span></span>, <span class="hljs-number"><span class="hljs-number">-0.21</span></span>, <span class="hljs-number"><span class="hljs-number">0.02</span></span>, <span class="hljs-number"><span class="hljs-number">-0.71</span></span>, <span class="hljs-number"><span class="hljs-number">0.43</span></span>, <span class="hljs-number"><span class="hljs-number">0.13</span></span>, <span class="hljs-number"><span class="hljs-number">0.24</span></span>, <span class="hljs-number"><span class="hljs-number">-0.8</span></span>, <span class="hljs-number"><span class="hljs-number">-0.3</span></span>, <span class="hljs-number"><span class="hljs-number">-0.2</span></span>, <span class="hljs-number"><span class="hljs-number">-0.2</span></span>, <span class="hljs-number"><span class="hljs-number">-0.48</span></span>, <span class="hljs-number"><span class="hljs-number">0.15</span></span>, <span class="hljs-number"><span class="hljs-number">-0.44</span></span>, <span class="hljs-number"><span class="hljs-number">0.28</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">-0.57</span></span>, <span class="hljs-number"><span class="hljs-number">0.31</span></span>, <span class="hljs-number"><span class="hljs-number">0.06</span></span>, <span class="hljs-number"><span class="hljs-number">-0.34</span></span>, <span class="hljs-number"><span class="hljs-number">0.56</span></span>, <span class="hljs-number"><span class="hljs-number">0.09</span></span>, <span class="hljs-number"><span class="hljs-number">0.87</span></span>, <span class="hljs-number"><span class="hljs-number">-0.79</span></span>, <span class="hljs-number"><span class="hljs-number">0.4</span></span>, <span class="hljs-number"><span class="hljs-number">-0.26</span></span>, <span class="hljs-number"><span class="hljs-number">0.26</span></span>, <span class="hljs-number"><span class="hljs-number">-0.03</span></span>, <span class="hljs-number"><span class="hljs-number">-0.06</span></span>, <span class="hljs-number"><span class="hljs-number">0.01</span></span>, <span class="hljs-number"><span class="hljs-number">0.16</span></span>, <span class="hljs-number"><span class="hljs-number">-0.06</span></span>, <span class="hljs-number"><span class="hljs-number">-0.19</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">0.24</span></span>, <span class="hljs-number"><span class="hljs-number">-1.06</span></span>, <span class="hljs-number"><span class="hljs-number">0.86</span></span>, <span class="hljs-number"><span class="hljs-number">0.12</span></span>, <span class="hljs-number"><span class="hljs-number">-0.55</span></span>, <span class="hljs-number"><span class="hljs-number">0.69</span></span>, <span class="hljs-number"><span class="hljs-number">0.17</span></span>, <span class="hljs-number"><span class="hljs-number">-0.01</span></span>, <span class="hljs-number"><span class="hljs-number">0.02</span></span>, <span class="hljs-number"><span class="hljs-number">-0.23</span></span>, <span class="hljs-number"><span class="hljs-number">-0.71</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.14</span></span>, <span class="hljs-number"><span class="hljs-number">0.79</span></span>, <span class="hljs-number"><span class="hljs-number">-0.27</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">-1.02</span></span>, <span class="hljs-number"><span class="hljs-number">0.19</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.22</span></span>, <span class="hljs-number"><span class="hljs-number">-0.14</span></span>, <span class="hljs-number"><span class="hljs-number">-0.05</span></span>, <span class="hljs-number"><span class="hljs-number">0.27</span></span>, <span class="hljs-number"><span class="hljs-number">0.27</span></span>)), row.names = c(<span class="hljs-name"><span class="hljs-name">NA</span></span>, <span class="hljs-number"><span class="hljs-number">-77</span></span>L), class = c(<span class="hljs-string"><span class="hljs-string">"tbl_df"</span></span>, <span class="hljs-string"><span class="hljs-string">"tbl"</span></span>, <span class="hljs-string"><span class="hljs-string">"data.frame"</span></span> ))</code> </pre> </div></div><br><p>  The target variable is <code>log_P_eff_exp</code> - the logarithm of the diffusion rate (measured in cm / s). </p><br><p>  List of predictors: </p><br><ul><li>  log_D - distribution coefficient at pH = 7.4; </li><li>  rgyr is the radius of gyration; </li><li>  rgyr_d is the dynamic radius of gyration; </li><li>  HCPSA is the area of ‚Äã‚Äãa highly charged <a href="https://en.wikipedia.org/wiki/Polar_surface_area">polar surface</a> ; </li><li>  TPSA - topological area of ‚Äã‚Äãthe polar surface; </li><li>  N_rotb - the number of <a href="http://www.molinspiration.com/services/properties.html">turning links</a> . </li></ul><br><p>  Consider the predictor distributions, as well as their pairwise correlations: </p><br><pre> <code class="hljs php">GGally::ggpairs(df, columns = c(<span class="hljs-number"><span class="hljs-number">3</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span>), diag = <span class="hljs-keyword"><span class="hljs-keyword">list</span></span>(continuous = <span class="hljs-string"><span class="hljs-string">"barDiag"</span></span>))</code> </pre> <br><img src="https://habrastorage.org/webt/ef/vw/dd/efvwddzsss11bj36tqjnwbuc7ae.png"><br><p>  The variables <code>rgyr</code> and <code>rgyr_d</code> , as well as <code>HCPSA</code> and <code>TPSA</code> predictably strongly correlate, since in both cases the pairs of variables are different ways of calculating the same physical quantity. </p><br><p>  Let's teach the same neural network as in the previous example.         ,       . </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="hljs django"><span class="xml"><span class="xml">set.seed(42) train_ind </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">sample</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1:77</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">60</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x_train</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">as.matrix</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">df</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train_ind</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2:8</span></span></span></span><span class="xml"><span class="hljs-tag">]) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y_train</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">unlist</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">df</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train_ind</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">9</span></span></span></span><span class="xml"><span class="hljs-tag">]) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x_val</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">as.matrix</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">df</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-train_ind</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2:8</span></span></span></span><span class="xml"><span class="hljs-tag">]) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y_val</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">unlist</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">df</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-train_ind</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">9</span></span></span></span><span class="xml"><span class="hljs-tag">]) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mx.symbol.Variable</span></span></span></span><span class="xml"><span class="hljs-tag">("</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="hljs-tag">") </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fc1</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mx.symbol.FullyConnected</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">num_hidden</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1)</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">linreg</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mx.symbol.LinearRegressionOutput</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fc1</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">initializer</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mx.init.normal</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">sd</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.1)</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">optimizer</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mx.opt.create</span></span></span></span><span class="xml"><span class="hljs-tag">("</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">sgd</span></span></span></span><span class="xml"><span class="hljs-tag">", </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">learning.rate</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1e-6,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">momentum</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.9)</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">logger</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mx.metric.logger</span></span></span></span><span class="xml"><span class="hljs-tag">() </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">epoch.end.callback</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mx.callback.log.train.metric</span></span></span></span><span class="xml"><span class="hljs-tag">( </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">period</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">4,</span></span></span></span><span class="xml"><span class="hljs-tag"> #  ,     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">logger</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">logger)</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">n_epoch</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">20</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">model</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mx.model.FeedForward.create</span></span></span></span><span class="xml"><span class="hljs-tag">( </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">symbol</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">linreg,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">X</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">x_train,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">y_train,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ctx</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">mx.cpu(),</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">num.round</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">n_epoch,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">initializer</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">initializer,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">optimizer</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">optimizer,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">eval.data</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">list(data</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">x_val,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">label</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">y_val),</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">eval.metric</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">mx.metric.rmse,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">array.batch.size</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">15,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">epoch.end.callback</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">epoch.end.callback)</span></span></span></span></span></span></code> </pre> </div></div><br><p> ,    RMSE     : </p><br><pre> <code class="hljs perl">rmse_log &lt;- data.frame(RMSE = c(logger$train, logger$eval), dataset = c(rep(<span class="hljs-string"><span class="hljs-string">"train"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">length</span></span>(logger$train)), rep(<span class="hljs-string"><span class="hljs-string">"val"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">length</span></span>(logger$eval))), epoch = <span class="hljs-number"><span class="hljs-number">1</span></span>:n_epoch) library(ggplot2) ggplot(rmse_log, aes(epoch, RMSE, group = dataset, colour = dataset)) + geom_point() + geom_line()</code> </pre> <br><img src="https://habrastorage.org/webt/bf/wk/7a/bfwk7aih2vlpundxxuwaqcmqmfs.png"><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In the next report, we will solve the classification problem on real data, and also consider other quality metrics and the use of an early stop. </font></font></p></div><p>Source: <a href="https://habr.com/ru/post/354944/">https://habr.com/ru/post/354944/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354934/index.html">Plausible reconstruction of Instagram-like filters</a></li>
<li><a href="../354936/index.html">(Akin's laws) laws of space engineering</a></li>
<li><a href="../354938/index.html">Loud sound of the fire extinguishing system knocked out the drives in the Nasdaq data center</a></li>
<li><a href="../354940/index.html">Extreme Performance Virtual Server (VPS / VDS)</a></li>
<li><a href="../354942/index.html">Cross-language software development</a></li>
<li><a href="../354948/index.html">Postgres auto_explain: query plan autolog</a></li>
<li><a href="../354950/index.html">Two accelerometers, dish sponge and four nuts</a></li>
<li><a href="../354954/index.html">JavaFx, a simple COM port terminal</a></li>
<li><a href="../354956/index.html">VPN for a beer?</a></li>
<li><a href="../354958/index.html">One year in Figme. On the pros and cons of the design tool is subjective</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>