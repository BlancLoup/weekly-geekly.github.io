<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Migrating from 3CX v12 Cloud Server to 3CX v14 Virtual PBX Server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 This guide describes the process of migration of entities (tenants) 3CX v12 Cloud Server to 3CX v14 Virtual PBX Server without changing...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Migrating from 3CX v12 Cloud Server to 3CX v14 Virtual PBX Server</h1><div class="post__text post__text-html js-mediator-article"><h2>  Introduction </h2><br>  This guide describes the process of migration of entities (tenants) 3CX v12 Cloud Server to 3CX v14 Virtual PBX Server without changing the SIP ports that have already been assigned to 3CX v12 entities. <br>  In order to transfer 3CX v12 Cloud Server entities to 3CX v14 Virtual PBX Server, while maintaining the already configured SIP ports, you need to perform the following steps: <br><br><ul><li>  Install software required for migration </li><li>  Back up data </li><li>  Prepare data for recovery </li><li>  Recover data on 3CX v14 Virtual PBX Server </li><li>  Repeat auto configuration / configuration of IP phones and gateways </li></ul><br>  <strong>Important:</strong> this guide is additionally tested by our developers, but at the moment there are no serious problems identified, and it can be used for successful migration. <a name="habracut"></a><br><br><h2>  Migration software </h2><br>  For successful migration, download the <a href="">BulkBackup140.zip</a> ZIP archive, unpack it and run it on the server with 3CX v14 Virtual PBX Server installed but not configured and run <strong>cloudbackup.bat</strong> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Data backup </h2><br>  In 3CX v12 Cloud Server, back up all entities using the Backup and restore tool.  Pay attention to the order of the entities and the SIP ports assigned to them.  For example, the entity stefant1 has SIP port 5060, the entity tomt2 is 6060. It is necessary to restore the entities in the same sequence to save the SIP ports assigned to them - this will simplify the migration of end devices (SIP phones). <br><br><h4> <b><img src="https://habrastorage.org/getpro/habr/post_images/d00/8c8/0a3/d008c80a3d6fea53155da2f0029bd905.png" alt="pasted image 0" width="489" height="528"></b> </h4><br>  After all 3CX v12 entities have been saved to the folder, transfer the files to 3CX v14. <br><img src="https://habrastorage.org/getpro/habr/post_images/d7e/403/81f/d7e40381fca2c6b5c30699d73c943277.png" alt="pasted image 0 (1)" width="356" height="353"><br><br><h2>  Preparing data for recovery </h2><br><h3>  Assigning FQDN names </h3><br>  The name of the ZIP file affects the FQDN names assigned to new entities.  For example, if all restored entities will work on the common domain <strong>contoso.com</strong> , you need to <br><br><ul><li>  use a self-signed or purchased certificate for the domain mask <strong>* .contoso.com</strong> </li><li>  take into account that the names of subdomains of entities in the contoso.com domain will correspond to the names of the ZIP files.  For example, the zip file <strong>stefant1.zip</strong> forms the subdomain <strong>stefant1.contoso.com</strong> . </li></ul><br>  If you need other subdomain names for the entities, just rename the ZIP archives.  For example, if you rename <strong>stefant1.zip</strong> to <strong>stefan.zip</strong> , this entity will be assigned the subdomain <strong>stefan.comtoso.com</strong> . <br><br><h3>  Entity order </h3><br>  Restoration of entities in 3CX v14 should be performed in the same order in which they were located on the 3CX v12.  Thus, the first entity <strong>stefant1</strong> (or renamed <strong>stefan</strong> ) will receive port 5060, which was on her old server.  This is necessary, first of all, to simplify the configuration of SIP phones connected to this entity. <br>  To start the migration, copy the corresponding entity files into the folder <strong>instance1</strong> , <strong>instance2</strong> , etc. that are inside the archive file <strong>RestoreV14.zip</strong> .  This file is created when unpacking the <a href="">BulkBackup140.zip</a> archive <a href="">.</a> In our example, <strong>stefan.zip</strong> should be located in the folder <strong>instance1</strong> , etc., and these folders and files should be included in the <strong>RestoreV14.zip</strong> archive. <br>  <strong>Important:</strong> you should not leave the files of the archives of entities outside the folders, as well as empty folders of entities.  Entity numbers must increase sequentially.  The archive <strong>RestoreV14.zip</strong> contains folders before <strong>instance11</strong> . <br><br><ul><li>  You can increase the number of entity folders to <strong>instance24</strong> . </li><li>  If you transfer fewer entities than created folders, delete unnecessary folders. </li></ul><br><h2>  Data Recovery on 3CX v14 Virtual PBX Server </h2><br>  After creating the <strong>RestoreV14.zip</strong> archive, transfer it to the new server at the root of drive C and run the command in the command line: <br><br><ul><li>  C: \ Program Files \ 3CX Phone System \ Bin&gt; <strong>BulkBackup.exe restore c: \ RestoreV14.zip</strong> </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/d12/f3f/8c8/d12f3f8c8ed439ee7412a1bc00bd2cd0.png" alt="pasted image 0 (2)" width="642" height="151"><br>  Recovery time will depend on the number of extensions, the amount of call history and call records of all entities. <br><br><h3>  Validation Recovery </h3><br>  After the restoration of the configuration and data is completed, launch the <strong>3CX Virtual PBX Manager</strong> utility on the new server and make sure that all the entities have been restored in the correct order. <br><img src="https://habrastorage.org/getpro/habr/post_images/438/5ec/cdb/4385eccdb3a84511f4216f347f96d613.png" alt="pasted image 0 (3)" width="815" height="364"><br>  Now you can log into the management console of each entity using the name created by FQDN.  The login account is the same as the one on the old server. <br>  <strong>Important:</strong> The <strong>SysAdmin account is</strong> no longer used in the 3CX v14 Virtual PBX. <br><br><h2>  Autotune / configure IP phones and gateways </h2><br><h3>  DNS changes </h3><br>  In 3CX v12 Cloud Server, the installed entity was accessed at <br><br><ul><li>  <strong>http (s): //pbx.contoso.com/ [tenant-name] / mangement</strong> , where <strong>[tenant-name]</strong> is the name of the entity.  In our example, this is <strong>stefant1</strong> . After switching to 3CX v14 Cloud PBX and possibly changing the name of the entity (in our example, <strong>stefant1 has been</strong> renamed <strong>stefan</strong> ), the new address of the entity management interface will be: </li><li>  <strong>http (s): // [tenant-name] .contoso.com / management</strong> .  In our example, this is <strong>http (s): //stefan.contoso.com/management</strong> . </li></ul><br>  Since the 3CX v14 Cloud PBX uses a call to an entity by the name of a subdomain, you must make the appropriate changes to the DNS server records.  The procedure for setting up a DNS server is described in the document <a href="http://www.3cx.com/blog/docs/how-to-create-external-fqdn/">How to Create an FQDN to 3CX Phone System that resolves externally</a> . <br>  <strong>Important:</strong> The IIS web server binds the subdomain name (entity name) to the interface IP address and does not process requests for other, clearly not defined subdomains. <br><br><h3>  Autotune SIP devices </h3><br><h4>  3CXPhone clients </h4><br>  For autoconfiguration of 3CXPhone clients, it is enough to resend the 3CX Welcome e-mail and import the autotune file to the clients.  In this case, the 3CXPhone configuration will be updated and it will be re-registered on the new 3CX v14 Virtual PBX server. <br>  <strong>Important:</strong> Before autotuning, 3CXPhone clients should upgrade to v14.  V12 clients will not work with the new server.  See the 3CXPhone client installation instructions for <a href="http://www.3cx.com/user-manual/installation-windows/">Windows</a> , <a href="http://www.3cx.com/user-manual/installation-android/">Android</a> , <a href="http://www.3cx.com/user-manual/installation-iphone/">iOS</a> , <a href="http://www.3cx.com/user-manual/installation-mac/">Mac</a> . <br><br><h4>  PSTN gateways </h4><br>  To configure PSTN gateways, simply go to their web-interface settings and specify the IP address of the new server.  If the gateway is connected via VPN, specify the internal address of the 3CX v14 Virtual PBX server. <br><br><h4>  IP phones </h4><br>  For all IP phones connected via auto-configuration, regardless of how they are connected (local lan, stun or SBC), you must copy the auto-configuration files (files, not folders) from the new v14 server to the old v12 server.  It is recommended to pre-save a backup copy of the original v12 autotune files. <br>  In our example, you need to copy the autotune files from: <br><br><ul><li>  C: \ ProgramData \ 3CX \ <b>Instance1</b> \ Data \ Http \ Interface \ provisioning \ <b>8c6n1icg0k</b> on the new server </li></ul><br>  at: <br><br><ul><li>  C: \ ProgramData \ <b>3CXstefant1</b> \ Data \ Http \ Interface \ provisioning \ <b>8c6n1icg0k</b> on the old server, replacing the original files. </li></ul><br>  After that, <strong>without logging</strong> into the management console of the old server (old entities), reboot the IP phones.  If you log into the management console of the old server, the autotune files will be overwritten!  Phones will receive a new configuration from the old server and switch to the new 3CX v14 Virtual PBX server. <br>  When all IP phones are connected to the new server, the old server can be disconnected. <br><br><h4>  3CX SBC </h4><br>  The 3CX v14 Virtual PBX Server requires the installation of an updated 3CX SBC session border controller.  To install 3CX SBC on a Windows system and Raspberry PI, read the relevant instructions: <br><br><ul><li>  <a href="http://www.3cx.com/docs/3cx-sbc-windows/">Installing 3CX Session Border Controller for Windows</a> </li><li>  <a href="http://www.3cx.com/docs/3cx-sbc-raspberry-pi/">Installing 3CX SBC Session Border Controller for Raspberry Pi</a> </li></ul><br>  After updating 3CX SBC (this is usually done on the user side of 3CX v14 Virtual PBX Server), set the IP and FQDN addresses of the new 3CX v14 Virtual PBX Server in its settings.  After that, the new connected phones will work immediately, and the old IP phones must be reconfigured, as indicated above in the <strong>IP Phones</strong> section. </div><p>Source: <a href="https://habr.com/ru/post/265091/">https://habr.com/ru/post/265091/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265077/index.html">Clustering graphs and searching for communities. Part 1: introduction, overview of tools and Hair Spheres</a></li>
<li><a href="../265079/index.html">Implementing V8 Sorted by Google</a></li>
<li><a href="../265081/index.html">Implement StyleCop in MSBuild</a></li>
<li><a href="../265083/index.html">How does the search for applications on Google Play. Abstract</a></li>
<li><a href="../265089/index.html">How to choose a dress using the main component method</a></li>
<li><a href="../265093/index.html">MOOC courses in robotics</a></li>
<li><a href="../265095/index.html">Cycle optimization: blocks needed</a></li>
<li><a href="../265103/index.html">Tehnokniga, part 1: literature on web technologies, algorithms and data structures, in-depth C ++ programming</a></li>
<li><a href="../265105/index.html">Data Science Week - microanons for those who do not know</a></li>
<li><a href="../265107/index.html">Some experience developing games on Unity3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>