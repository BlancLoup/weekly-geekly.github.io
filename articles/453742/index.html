<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Memcached plugin: NoSQL in MySQL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! My name is Maxim Matyukhin, I'm a Badoo PHP programmer. In our work, we actively use MySQL. But sometimes we lack her performance, so we are co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Memcached plugin: NoSQL in MySQL</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/1v/q0/h5/1vq0h5tev1qw1ivnheyxg7jfiqm.jpeg"><br><br>  Hello!  My name is Maxim Matyukhin, I'm a <a href="https://tech.badoo.com/ru/">Badoo</a> PHP programmer.  In our work, we actively use MySQL.  But sometimes we lack her performance, so we are constantly looking for opportunities to speed up her work. <br><br>  In 2010, Yoshinori Matsunobu introduced a NoSQL plugin for MySQL called HandlerSocket.  It was stated that this plugin allows you to perform more than 750,000 requests per second.  We were curious, and we almost immediately began to use this solution.  We liked the result so much that we began to make <a href="https://www.youtube.com/watch%3Fv%3DecIB5X1M1Z8">presentations</a> and write <a href="https://habr.com/ru/company/badoo/blog/141945/">articles</a> promoting HandlerSocket. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Apparently, we were one of the few users of this plugin - since MySQL version 5.7 it has stopped working.  But in this version there is another plugin from Oracle - InnoDB memcached plugin, which promised similar functionality. <br><br>  Despite the fact that the memcached-plugin appeared in MySQL 5.6 in 2013, there are not so many articles about it and for the most part they repeat the documentation: a simple table is created and queries are made to it through the memcached client. <br><br>  We have a lot of experience with Memcached and are used to the simplicity of interacting with it.  We expected the same simplicity from the InnoDB memcached plugin.  But in fact, it turned out that if the plug-in usage patterns are at least slightly different from those described in the documentation and articles, then a host of nuances and limitations emerges that are definitely worth considering if you are going to use the plug-in. <br><a name="habracut"></a><br><h1>  MySQL HandlerSocket </h1><br>  In this article, we will somehow compare the new memcached plugin with the old HandlerSocket.  Therefore, I remind you what was the last one. <br><br>  After installing the HandlerSocket plugin, MySQL started listening to two additional ports: <br><br><ol><li>  The first port received client requests to read data. <br></li><li>  The second port received client requests to write data. <br></li></ol><br>  The client had to establish a normal TCP connection to one of these ports (no authentication was supported), and after that it was necessary to send an ‚Äúopen index‚Äù command (a special command with which the client informed which table of which index which fields we are going to read (or write)). <br><br>  If the ‚Äúopen index‚Äù command worked successfully, then it was possible to send GETs or INSERT / UPDATE / DELETE commands depending on the port on which the connection was established. <br><br>  HandlerSocket allowed to perform not only GETs on the primary key, but also simple samples from a non-unique index, sampling on a range, supported multiget-s and LIMIT.  At the same time, it was possible to work with the table both from ordinary SQL and through a plugin.  This, for example, made it possible to make some changes in transactions through SQL, and then read this data through a HandlerSocket. <br><br>  It is important that HandlerSocket handled all connections with a limited pool of threads through the epoll, so tens of thousands of connections could easily be supported, while in MySQL itself a thread is created for each connection and their number is very limited. <br><br>  At the same time, this is still the usual MySQL server ‚Äî a familiar technology.  We know how to replicate and monitor it.  Monitoring the HandlerSocket is difficult, as it does not provide any specific metrics;  nevertheless, some standard MySQL and InnoDB metrics are useful. <br><br>  There were, of course, inconveniences, in particular, this plugin did not support working with the timestamp type.  Well, the HandlerSocket protocol is harder to read and therefore harder to debug. <br><br>  Read more about HandlerSocket <a href="https://yoshinorimatsunobu.blogspot.com/2010/10/using-mysql-as-nosql-story-for.html">here</a> .  You can also watch <a href="https://www.youtube.com/watch%3Fv%3DecIB5X1M1Z8">one of our presentations</a> . <br><br><h1>  InnoDB memcached plugin </h1><br>  What does the new memcached plugin offer us? <br><br>  As the name implies, his idea is to use the memcached client to work with MySQL and, through memcached commands, get and save data. <br><br>  You can <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached-benefits.html">read</a> about the main advantages of the plugin <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached-benefits.html">here</a> . <br><br>  We are most interested in the following: <br><br><ol><li>  Low CPU consumption. <br></li><li>  The data is stored in InnoDB, which gives certain guarantees. <br></li><li>  It is possible to work with data both through Memcached, and through SQL;  they can be replicated using built-in MySQL tools. <br></li></ol><br>  To this list, you can add more advantages such as: <br><br><ol><li>  Fast and cheap connection.  A normal MySQL connection is processed by one thread, and the number of threads is limited, and in a memcached plugin, one thread handles all connections in the event loop. <br></li><li>  The ability to request several keys at once with a GET request. <br></li><li>  Compared to MySQL HandlerSocket, then the memcached plugin does not need to use the ‚ÄúOpen Table‚Äù command and all read and write operations occur on one port. <br></li></ol><br><br>  More details about the work of the plugin can be found in the official <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached.html">documentation</a> .  The following pages seemed to be the most useful for us: <br><br><ol><li>  <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached-intro.html">InnoDB memcached Architecture</a> . <br></li><li>  <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached-internals.html">InnoDB memcached plugin internals</a> . <br></li></ol><br>  After installing the plugin, MySQL starts accepting connections on port 11211 (standard memcached-port).  A special database (schema) innodb_memcache also appears in which you will configure access to your tables. <br><br><h1>  Simple example </h1><br>  Suppose you already have a table with which you want to work through the memcached protocol: <br><br><pre><code class="plaintext hljs">CREATE TABLE `auth` (  `email` varchar(96) NOT NULL,  `password` varchar(64) NOT NULL,  `type` varchar(32) NOT NULL DEFAULT '',  PRIMARY KEY (`email`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci</code> </pre> <br>  and you want to receive and change data on the primary key. <br><br>  You must first describe the correspondence between the memcached key and the SQL table in the innodb_memcache.containers table.  This table looks like this (I removed the encoding description to make it easier to read): <br><br><pre> <code class="plaintext hljs">CREATE TABLE `containers` ( `name` varchar(50) NOT NULL, `db_schema` varchar(250) NOT NULL, `db_table` varchar(250) NOT NULL, `key_columns` varchar(250) NOT NULL, `value_columns` varchar(250) DEFAULT NULL, `flags` varchar(250) NOT NULL DEFAULT '0', `cas_column` varchar(250) DEFAULT NULL, `expire_time_column` varchar(250) DEFAULT NULL, `unique_idx_name_on_key` varchar(250) NOT NULL, PRIMARY KEY (`name`) ) ENGINE=InnoDB DEFAULT</code> </pre> <br>  The most important fields: <br><br><ul><li>  name - the prefix of your memcached-key; <br></li><li>  db_schema - the name of the database (schema); <br></li><li>  db_table is your table; <br></li><li>  key_columns - the name of the field in the table by which we will search (usually this is your primary key); <br></li><li>  value_columns - a list of fields from the table that will be available memcached-plugin; <br></li><li>  unique_idx_name_on_key - the index by which you want to search (although you have already specified key_columns, they can be included in different indexes and you must explicitly specify an index). <br></li></ul><br>  The remaining fields are not very important for the beginning. <br><br>  Add a description of our table in innodb_memcache.containers: <br><br><pre> <code class="plaintext hljs">INSERT INTO innodb_memcache.containers SET   name='auth',   db_schema='test',   db_table='auth',   key_columns='email',   value_columns='password|type',   flags='0',   cas_column='0',   expire_time_column='0',   unique_idx_name_on_key='PRIMARY';</code> </pre> <br>  In this example, name = 'auth' is the prefix of our memcached-key.  In documentation, it is often called table_id, and later in the article I will use this term. <br><br>  Now we connect the TELNET to the memcached plugin and try to save and retrieve data: <br><br><pre> <code class="plaintext hljs">[21:26:22] maxm@localhost: ~&gt; telnet memchached-mysql.dev 11211 Trying 127.0.0.1... Connected to memchached-mysql.dev. Escape character is '^]'. get @@auth.max@example.com END set @@auth.max@example.com 0 0 10 1234567|89 STORED get @@auth.max@example.com VALUE @@auth.max@example.com 0 10 1234567|89 END</code> </pre> <br>  At first we sent a GET request, it did not return anything to us.  Then we saved the data with a SET request, and then got it back with a GET. <br><br>  GET returned the following string: 1234567 | 89.  These are the values ‚Äã‚Äãof the "password" and "type" fields, separated by the character "|".  Fields are returned in the order in which they were described in innodb_memcache.containers.value_columns. <br><br>  Perhaps you have now wondered: ‚ÄúWhat will happen if the‚Äú | ‚Äùcharacter is found in the‚Äú password ‚Äù?‚Äù I will describe this later. <br><br>  Through SQL, this data is also available: <br><br><pre> <code class="plaintext hljs">MySQL [(none)]&gt; select * from auth where email='max@example.com'; +-----------------+----------+------+ | email      | password | type | +-----------------+----------+------+ | max@example.com | 1234567  | 89 | +-----------------+----------+------+ 1 row in set (0.00 sec)</code> </pre> <br><h2>  Default table_id </h2><br>  There is also such a mode of operation: <br><br><pre> <code class="plaintext hljs">get @@auth VALUE @@auth 0 21 test/auth END get max@example.com VALUE max@example.com 0 10 1234567|99 END set ivan@example.com 0 0 10 qwerty|xxx STORED get ivan@example.com VALUE ivan@example.com 0 10 qwerty|xxx END</code> </pre> <br>  In this example, with the get @@ auth request, we make table_id auth the default prefix for this connection.  After that, all subsequent requests can be done without specifying table_id. <br><br>  So far everything is simple and logical.  But if you start to understand, it reveals a lot of nuances.  I'll tell you about what we found. <br><br><h1>  Nuances </h1><br><h2>  Caching table innodb_memcache.containers </h2><br>  The memcached plugin reads the innodb_memcache.containers table once at startup.  Further, if an unknown table_id comes over the Memcached protocol, the plugin looks for it in the table.  Therefore, you can easily add new keys (table_id), but if you want to change the settings of an existing table_id, you will have to restart the memcached plugin: <br><br><pre> <code class="plaintext hljs">mysql&gt; UNINSTALL PLUGIN daemon_memcached; mysql&gt; INSTALL PLUGIN daemon_memcached soname "libmemcached.so";</code> </pre> <br>  In the interval between these two requests, the Memcached interface will not work.  Because of this, it is often easier to create a new table_id than to change the existing one and restart the plugin. <br><br>  It was unexpected for us that such an important nuance of the plug-in operation is described on the <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached-porting-memcached.html">Adapting a</a> page of <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached-porting-memcached.html">the memcached Plugin</a> , which is not a very logical place for such information. <br><br><h2>  Flags, cas_column, expire_time_column </h2><br>  These fields are needed to simulate some features of Memcached.  Documentation on them is controversial.  Most of the examples in it illustrate working with tables in which these fields exist.  You may be afraid that you will need to add them to your tables (and this is at least three INT-fields).  But no.  If you do not have such fields in the tables and you are not going to use Memcached functionality such as CAS, expiration or flags, then you do not need to add these fields to the tables. <br><br>  When configuring a table in innodb_memcache.containers, enter '0' in these fields, make exactly the line with zero: <br><br><pre> <code class="plaintext hljs">INSERT INTO innodb_memcache.containers SET   name='auth',   db_schema='test',   db_table='auth',   key_columns='email',   value_columns='password|type',   flags='0',   cas_column='0',   expire_time_column='0',   unique_idx_name_on_key='PRIMARY';</code> </pre> <br>  It's a shame that cas_column and expire_time_column default is NULL, and if you execute INSERT INTO innodb_memcache.containers without specifying the value '0' for these fields, NULL will remain in them and this memcache prefix will simply not work. <br><br><h2>  Data types </h2><br>  From the documentation it is not very clear what data types can be used when working with a plugin.  In several places it is said that the plugin can work only with text fields (CHAR, VARCHAR, BLOB).  Here: <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached-porting-mysql.html">Adapting an Existing MySQL Schema for the InnoDB memcached Plugin</a> suggests storing numbers in string fields, and if you need to work with these numeric fields from SQL, then create a VIEW in which VARCHAR-fields with numbers will be converted into INTEGER-fields : <br><br><pre> <code class="plaintext hljs">CREATE VIEW numbers AS SELECT c1 KEY, CAST(c2 AS UNSIGNED INTEGER) val FROM demo_test WHERE c2 BETWEEN '0' and '9999999999';</code> </pre> <br>  However, in some places the documentation still says that you can work with numbers.  So far we have only real production experience with text fields, but the results of experiments show that the plugin also works with numbers: <br><br><pre> <code class="plaintext hljs">CREATE TABLE `numbers` ( `id` int(10) unsigned NOT NULL AUTO_INCREMENT, `counter` int(10) unsigned NOT NULL DEFAULT '0', PRIMARY KEY (`id`) ) ENGINE=InnoDB INSERT INTO innodb_memcache.containers SET name='numbers', db_schema='test', db_table='numbers', key_columns='id', value_columns='counter', flags='0', cas_column='0',expire_time_column='0',unique_idx_name_on_key='PRIMARY';</code> </pre> <br>  After that via Memcached protocol: <br><br><pre> <code class="plaintext hljs">get @@numbers.1 END set @@numbers.1 0 0 2 12 STORED get @@numbers.1 VALUE @@numbers.1 0 2 12 END</code> </pre> <br>  We see that the memcached plugin can return any data types.  But it returns them in the form in which they lie in InnoDB, so, for example, in the case of timestamp / datetime / float / decimal / JSON, a binary string is returned.  But integers are returned as we see them through SQL. <br><br><h2>  Multiget </h2><br>  Memcached protocol allows you to request multiple keys in one request: <br><br><pre> <code class="plaintext hljs">get @@numbers.2 @@numbers.1 VALUE @@numbers.2 0 2 12 VALUE @@numbers.1 0 2 13 END</code> </pre> <br>  The fact that multiget works is already good.  But it works within the same table_id: <br><br><pre> <code class="plaintext hljs">get @@auth.ivan@example.com @@numbers.2 VALUE @@auth.ivan@example.com 0 10 qwerty|xxx END</code> </pre> <br>  The documentation describes this point here: <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached-multiple-get-range-query.html">https://dev.mysql.com/doc/refman/8.0/en/innodb-memcached-multiple-get-range-query.html</a> .  It turns out that in multiget-e you can specify table_id only for the first key, if all other keys are taken from the default table_id (an example from the documentation): <br><br><pre> <code class="plaintext hljs">get @@aaa.AA BB VALUE @@aaa.AA 8 12 HELLO, HELLO VALUE BB 10 16 GOODBYE, GOODBYE END</code> </pre> <br>  In this example, the second key is taken from the default table_id.  We could specify a lot more keys from the default table_id, and for the first key we specified a separate table_id, and this is only possible in the case of the first key. <br><br>  It can be said that multiget works within a single table, because relying on such logic in the production code is not at all desirable: it is not obvious, it is easy to forget about it, to make a mistake. <br><br>  If to compare with HandlerSocket, there too multiget worked within the limits of one table.  But this restriction seemed natural: the client opens the index in the table and requests one or more values ‚Äã‚Äãfrom it.  But when working with the memcached-multiget plugin with several keys with different prefixes, it is normal practice.  And from MySQL memcached-plugin expect the same.  But no :( <br><br><h2>  INCR, DEL </h2><br>  I have already given examples of GET / SET requests.  INCR and DEL queries have a feature.  It lies in the fact that they only work when using the default table_id: <br><br><pre> <code class="plaintext hljs">DELETE @@numbers.1 ERROR get @@numbers VALUE @@numbers 0 24 test/numbers END delete 1 DELETED</code> </pre> <br><h2>  Limitations of the memcached protocol </h2><br>  Memcached has a text protocol, which imposes some restrictions.  For example, memcached-keys should not contain whitespace characters (space, newline).  If you look again at the description of the table from our example: <br><br><pre> <code class="plaintext hljs">CREATE TABLE `auth` ( `email` varchar(96) NOT NULL, `password` varchar(64) NOT NULL, `type` varchar(32) NOT NULL DEFAULT '', PRIMARY KEY (`email`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci</code> </pre> <br>  then this means that there should be no such characters in the ‚Äúemail‚Äù field. <br><br>  Also, the length of memcached-keys must be less than 250 bytes (bytes, not characters).  If you send more, get an error: <br><br><pre> <code class="plaintext hljs">"CLIENT_ERROR bad command line format"</code> </pre> <br>  In addition, it is necessary to take into account the fact that the memcached plugin adds its syntax to the memcached protocol.  For example, it uses the character "|"  as a field delimiter in response.  You need to ensure that this symbol is not used in your table.  The separator can be configured, but the settings will apply to all tables on the entire MySQL server. <br><br><h2>  Field separator value_columns </h2><br>  If you need to return several columns through the memcached protocol, as in our first example: <br><br><pre> <code class="plaintext hljs">get @@auth.max@example.com VALUE @@auth.max@example.com 0 10 1234567|89 END</code> </pre> <br>  then the column values ‚Äã‚Äãare separated by the standard delimiter "|".  The question arises: ‚ÄúWhat will happen if, for example, in the first field in a line there is a character‚Äú | ‚Äù‚Äù?  The memcached plugin in this case returns the string as is, like this: 1234 | 567 | 89.  In general, it is impossible to understand where there is a field. <br><br>  Therefore, it is important to immediately select the correct separator.  And since it will be used for all keys of all tables, it should be a universal symbol that will not appear in any field with which you will work through the memcached protocol. <br><br><h1>  Summary </h1><br>  This is not to say that the memcached plugin is bad.  But it seems that it was written for a certain work scheme: MySQL-server with one table, to which there is access via the memcached-protocol, and this table_id is made default.  Clients establish a persistent connection with the Memcached plugin and make requests to the default table_id.  Probably, in such a scheme, everything will work without complaints.  If you move away from it, you come across various inconveniences. <br><br>  You might have expected to see any reports about plug-in performance.  But we have not yet decided to use it in high-loaded places.  We used it only in a few not very loaded systems and it works there at about the same speed as the HandlerSocket, but we didn‚Äôt do fair benchmarks.  But still, the plugin provides an interface with which a programmer can easily make a mistake - you need to keep a lot of nuances in your head.  Therefore, we are not yet ready to massively use this plugin. <br><br>  We got some feature requests in the MySQL bug tracker: <br><br>  <a href="https://bugs.mysql.com/bug.php%3Fid%3D95091">https://bugs.mysql.com/bug.php?id=95091</a> <br>  <a href="https://bugs.mysql.com/bug.php%3Fid%3D95092">https://bugs.mysql.com/bug.php?id=95092</a> <br>  <a href="https://bugs.mysql.com/bug.php%3Fid%3D95093">https://bugs.mysql.com/bug.php?id=95093</a> <br>  <a href="https://bugs.mysql.com/bug.php%3Fid%3D95094">https://bugs.mysql.com/bug.php?id=95094</a> <br><br>  Hopefully, the memcached-plugin development team will improve its product. </div><p>Source: <a href="https://habr.com/ru/post/453742/">https://habr.com/ru/post/453742/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../45373/index.html">HollyWar: ‚Äã‚ÄãTemplate engines. Do they need?</a></li>
<li><a href="../453732/index.html">I am from Moreynis. Oblique views or respect?</a></li>
<li><a href="../453734/index.html">Meet Helm 3</a></li>
<li><a href="../453738/index.html">THE AMOUNT OF ALL CONSCIOUS | --1-- |</a></li>
<li><a href="../45374/index.html">WUD 2008: photo, video, presentation</a></li>
<li><a href="../453744/index.html">We use the pseudo-class: not () on the example of the task ‚ÄúSelecting the active row of a table in pure CSS‚Äù</a></li>
<li><a href="../453748/index.html">Prototyping a mobile game, where to start, and how to do it. Part 3 (final)</a></li>
<li><a href="../45375/index.html">parsing MS-office files</a></li>
<li><a href="../453750/index.html">Baltimore‚Äôs recent cyber attack</a></li>
<li><a href="../453756/index.html">Problems of the current methodology for determining the actual threats from FSTEC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>