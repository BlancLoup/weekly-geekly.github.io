<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security audit from REG.RU - what is it and why is it needed?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction  The modern world is characterized by extremely rapid growth of information, globalization and computerization of all sectors of society....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security audit from REG.RU - what is it and why is it needed?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/625/f11/e2c/625f11e2c356c5592b04ba0a28017453.jpg"><br><br><h5>  Introduction </h5>  The modern world is characterized by extremely rapid growth of information, globalization and computerization of all sectors of society.  Information technology is firmly rooted in our lives - most of the world's population is almost always using Internet access for work, education, games, entertainment.  This naturally entails the monetization of all possible services.  Consequently, the total amount of time spent on transactions using plastic cards increases linearly: cashless payments for purchases of goods, transactions in online banking systems, currency exchange and other payment transactions with service providers.  Accordingly, the ‚Äúweb space‚Äù is expanded, in which there is information about cardholders and other authentication data. <br><br>  The increase in the number and variety of services available to the end user via the Internet is directly proportional to the expansion of the field for fraud.  In the context of the problem under consideration, the main types of malicious attacks can be defined as: <br><ul><li>  Attack on the service provider </li><li>  Attack on the end user </li></ul><br>  In the event of an attack on the end user, the fight against cybercriminals is conducted mainly by installing client software that meets the security requirements and informing the user about possible threats.  When an attack is aimed at a vendor, complex protective measures are necessary, a special stage of which is to prevent intrusions.  This important role of intrusion prevention can be explained by the fact that even part of confidential data leaks and its use by hackers leads to significant financial losses for both the service provider and the end user.  Therefore, to reduce the risk of hacking service, interruptions in work, data leakage, as well as to preserve the reputation of the resource, it is recommended to conduct an information security audit. <br><a name="habracut"></a><br><h5>  What is an information security audit? </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/109/5ce/76e/1095ce76ed856f0d9031ec4ecc6b9817.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The concept of "information security audit" appeared relatively recently.  Nevertheless, at present, information security audit is one of the most urgent and dynamically developing areas of strategic and operational management in the field of information systems security and is of constant interest among specialists.  Its main task is to objectively assess the current state of information security (IS) of the company, as well as its adequacy to the set goals and objectives of the business to increase the efficiency and profitability of economic activity.  Therefore, the information security audit of a corporate system is usually understood as a systematic process of obtaining objective qualitative and quantitative assessments of the company's current status in accordance with certain criteria and safety indicators.  It is believed that the results of a qualified audit of the information security company allow you to build an optimal in terms of efficiency and cost, a corporate protection system that is adequate to the current goals and objectives of the business. <br><br>  Thus, it is possible to give a brief definition of information security (IS) audit: <br>  <b>Information security audit</b> is a test of the ability of a resource to successfully counter information security threats. <br><br><h5>  Who needs an information security audit? </h5>  All companies aiming for success.  Successful business does not build on sites subject to hacking.  The level of user confidence is instantly falling and the attendance of the resource is reduced.  As a result, sales are falling, the number of customers is falling, and financial losses occur.  Considering that now absolutely all Internet resources are of interest to intruders (fraudsters are equally interested in hacking resources containing information on plastic cards, passport data, passwords, accounts, etc., and hacking sites used later for dubious purposes: sending out spam, using for black SEO, creating a botnet, etc.), an IS audit is not a waste of money, but an investment in stability. <br><br><h5>  Why not popular? </h5>  In most cases, due to the banal misunderstanding of the real need for services.  Most companies are not ready to give a lot of money for ‚Äújust‚Äù checking for the possibility of the system being compromised.  That's because the owners are not informed about the number and extent of hacker threats.  Often using the principle ‚ÄúNot in any cloud thunder;  but even thunder shall not burst;  but it does, but not for us;  but it‚Äôs not for us to kill us! ‚Äù, companies start thinking about security only when the system has already been compromised and has been seriously damaged.  But to learn and draw conclusions better on the mistakes of others, therefore, below are a few real-life examples where an information security audit could save nerves and money. <br><br><h6>  Site of one of the ministries of a certain country </h6> The story happened 3 years ago during a state penetration penetration test.  At the first inspection of the site, a vulnerability of the type <b>PHP-injection</b> was discovered - that is, all the links were organized by the inclusion of other PHP pages whose name was transmitted by a GET request.  Server settings also could not be called secure ‚Äî there was access to important system files mq = off, allow_url_fopen = On, which was enough to read important information and then get full access to the server. <br>  Such a request made it easy to read the web server logs: <br> <code><a href="http://www.xxx.gov/main.php%3Fquery%3D../../../proc/self/fd/2%2500"></a> www.xxx.gov/main.php?query=../../../proc/self/fd/2%00</code> <br>  As it turned out later, the fault is the plain PHP code: <br><br><pre> <code class="hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> ... $query = $_GET[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'query'</span></span></span><span class="php">]; </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">if</span></span></span><span class="php">(</span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">isset</span></span></span><span class="php">($query) &amp;&amp; !</span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">empty</span></span></span><span class="php">($query)) { </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">require</span></span></span><span class="php">($query.¬ªphp¬ª); } </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  To eliminate the vulnerability, it was recommended to check the variable for the existence of a file, use the <b>strpbrk</b> function to identify special characters - ‚Äú <b>/. \?</b>  ", A ban on reading from under the web <b>/ proc / self /</b> , installation in php.ini: <b>magic_quotes_gpc = on</b> , allow_url_fopen = Off. <br><br>  It would seem that protection should be one of the first priorities, because it is not difficult to imagine what a hacking state site entails.  Penetration into a local network, access to computers on which information is stored, for example, about licensed testing of specialists (keys of answers to the CRIC, external independent assessment, etc.).  Then, perhaps, the authenticity of certificates that all higher educational institutions require, and hence the competence of future doctors, etc., will be questioned. <br><br><h6>  E-commerce </h6>  More and more entertainment resources use their own game currency, which can be converted into real money.  During the test for the penetration of one of these sites, a SQL injection was discovered with an error based output. <br><br>  The essence of the site was that you have a car, you arrange races, improve cars, etc.  Some of these operations required an investment in the account balance.  During the test, the entire database structure was obtained via SQL injection, the old or test versions of the site with the installed Joomla content management system were detected by the directory scanner.  To simulate the actions of intruders, all through the same vulnerability were obtained password hashes from Joomla, successfully picked up by a brutal brute force, access to the server via the "php-shell" download in the Joomla administration center.  As a result, passwords for accessing the database were also obtained, which made it possible to manage the balance of accounts without actually transferring funds.  The balance sheet was organized very simply: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f72/fc7/cbb/f72fc7cbb89bc8601ed0310639bef3b2.jpg"><br><br>  In addition, passwords were stored in clear text. <br><br>  The recommendations for resolving the vulnerabilities were as follows: <br>  ‚Ä¢ Process the input parameters of the function <b>mysql_real_escape_string</b> ; <br>  ‚Ä¢ Disable error output; <br>  Do not leave "useful" directories accessible from the web (old versions, dumps, test scripts, and the like); <br>  ‚Ä¢ Even on test versions of sites do not put passwords that may be in dictionaries; <br>  ‚Ä¢ Process passwords with an irreversible encryption algorithm. <br><br><h6>  Invisible threat </h6>  When analyzing one of the hacked servers, the introduction of i-frame code to sites without a specific source was noted.  The files on the server maintained integrity, their contents were not changed, but malicious code was ‚Äúthrown out‚Äù by users of the sites.  A characteristic feature was the accidental appearance of malicious code absolutely on all server sites: <br> <code><br></code> <br><br>  It was all about the malicious Apache module, DarkLeech, which distributed malware, ‚Äútransparently‚Äù adding a couple of lines of code to the web server‚Äôs returned pages.  The physical names of the modules were: mod_spm_headers.so, mod_spm_mem.so, mod_log.so, and mod_security.so. <br>  There was a line in <b>httpd.conf</b> : <br> <code>LoadModule spm_headers_module modules/mod_spm_headers.so</code> <br> <br>  On the server behind the access logs, vulnerable scripts were discovered through which hacking occurred, malicious modules were disabled, and the operating system kernel was updated, due to the suspicion that intruders were using local root exploits. <br><br>  This once again confirms the importance of the comprehensive protection of a web resource, and not only the protection of the source code, which is provided by a full IS audit. <br><br><h5>  How much is it? </h5>  The cost of an IS audit in most cases is impossible to determine right away - it all depends on the nature of the work (which vulnerabilities are determined - from programmer errors to social engineering).  In addition, some companies calculate the cost of the service depending on the number of problems found, the number of lines of the analyzed code and the form for presenting results (report, video report, recommendations for elimination, additional consultations).  But on average, prices start at $ 100.  At the same time, such a cost of work is typical either for companies that have just entered the market and work without certified specialists and auditing standards, or for amateur teams, which mainly consist of former black-hat or non-professional information security specialists.  Of course, one cannot argue that when contacting such companies, work will be done poorly, but when it comes to confidential information and security, it is better to trust professionals. <br><br>  In this case, the prices will already be very different - from $ 300-500 to $ 5000, depending on the tariff.  For example, in REG.RU prices for these services are as follows: 25,000 rubles.  for the "Budget" rate and 150 000 rub.  for "Corporate" (https://www.reg.ru/web-sites/security-audit/#prices).  Such a high price is explained by conducting a multi-analysis of all parts of the system in order to identify critical points and introduce comprehensive protection measures, as well as the high qualifications of specialists with certificates of Offensive Security Certified Professional (OSCP) and Certified Professional Penetration Tester (eCPPT). <br><br><h5>  findings </h5>  What gives the order of the service " <a href="https://www.reg.ru/web-sites/security-audit/order/plan">Site security audit in REG.RU</a> "? <br><ul><li>  Description and assessment of the current level of information system security; </li><li>  Analysis of risks associated with the possibility of internal and external threats to the resources of the information system; </li><li>  Drawing up a model of a potential intruder; </li><li>  Recommendations on the technical, organizational component of information security (eliminating vulnerabilities in code, developing information security policies) </li><li>  Getting the maximum return on investments in information security systems; </li><li>  Confirmation that the internal controls used are consistent with the organization‚Äôs objectives and allow for efficiency and business continuity. </li><li>  Justification of investment in information security systems. </li></ul><br>  Most owners of hacked sites did not suspect an invasion of their resource.  Part of the system administrators in identifying the invasion did not take any action if there were no visible violations of the site, due to lack of knowledge on this issue.  Security audit is able to provide objective information about the security of the site, which will allow the resource owner to not jeopardize their business and business reputation.  After all, trusting their personal data to any organization, users and partners are confident that it will be able to ensure their confidentiality. </div><p>Source: <a href="https://habr.com/ru/post/201138/">https://habr.com/ru/post/201138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201128/index.html">Tesla is going to build its own battery factory</a></li>
<li><a href="../20113/index.html">Valentine's day MP3 players</a></li>
<li><a href="../201130/index.html">API for the Russian public initiative. Step 2.1: UK experience with electronic petition data</a></li>
<li><a href="../201132/index.html">Test Labs 2013 Part II. November 16th Online conference for testers</a></li>
<li><a href="../201136/index.html">Writing a bot for a flash game</a></li>
<li><a href="../20114/index.html">Chuck</a></li>
<li><a href="../201140/index.html">Universal quadcopter with Kinect on board: able to fly, does not sink in water, rolls along the ground</a></li>
<li><a href="../201142/index.html">Do I need on Habrahabr hub SQLite?</a></li>
<li><a href="../201148/index.html">Novell vs BBS - anti-piracy review at the end of the 20th century</a></li>
<li><a href="../20115/index.html">Ring nets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>