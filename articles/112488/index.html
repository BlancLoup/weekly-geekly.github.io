<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Spring Framework without XML ... really!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the light of the current era of the definition of everything and all the annotations I suggest you an article about the Spring Framework and the po...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Spring Framework without XML ... really!</h1><div class="post__text post__text-html js-mediator-article">  <i>In the light of the current era of the definition of everything and all the annotations I suggest you an article about the Spring Framework and the possibilities of annotating projects.</i>  <i>Note</i>  <i>trans.</i> <br>  In the beginning, there was EJB 2.1, with its huge number of XML files wherever possible.  It would not be a special exaggeration if you say that at least 10 lines of code from the framework and two XML pages were needed to write one line of code for business logic.  Local and remote interfaces, manual JNDI-lookup, multi-level try-catch, checks for RemoteException ... enterprise, in general.  Even the <a href="http://xdoclet.sourceforge.net/xdoclet/status.html">tools</a> were appropriate for the automatic generation of all this "kitchen". <br><a name="habracut"></a><br>  Then a couple of guys created the <a href="http://springframework.org/">Spring framework</a> .  After the castes of the obscure PortableRemoteObject.narrow () this became a breath of fresh air.  The time has passed (by the way, does someone remember how many years ago was the last major release of the JRE?) And Sun realized the lesson.  EJB 3.0 was even simpler than Spring, XML-free, with annotations, dependency injection.  3.1 was another huge step towards simplification.  Logically, EJB can now be viewed as part of what Spring offers, and I‚Äôm quite surprised why there is no EJB implementation in plain Spring (oops, <a href="http://www.springsource.com/pitchfork">wait</a> ...), given its support from JPA 1.0 / 2.0, JSR-250 box , JSR-330, JAX-WS / RS and others.  The spring framework today is perceived as slow, heavy and complex to support the framework, mainly because of the XML descriptors.  In general, Spring in the confrontation of JEE-frameworks as a whipping boy. <br><br>  I do not like politics and do not defend my favorite framework by writing long essays.  Instead, I'll take a simple but not trivial Spring application and rewrite it without XML.  Absolutely no XML, no single line. <br>  For the article, I wrote a very simple <a href="https://github.com/nurkiewicz/spring-no-xml">Spring web application</a> (the regular version in the xml branch, the final version in the master) with JDBC, JMS and JMX, just so that it would be impossible to simplify the task.  Each change will be reflected in a separate commit to the repository, and, step by step, I will get rid of XML until it remains completely.  Let's start. <br><pre><code class="java hljs">&lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> encoding=<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>?&gt; &lt;beans xmlns=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/beans"</span></span> xmlns:xsi=<span class="hljs-string"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span> xmlns:tx=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/tx"</span></span> xmlns:amq=<span class="hljs-string"><span class="hljs-string">"http://activemq.apache.org/schema/core"</span></span> xmlns:context=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/context"</span></span> xsi:schemaLocation=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core-5.4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span></span>&gt; &lt;context:mbean-export /&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"fooService"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"com.blogspot.nurkiewicz.FooService"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"jmsOperations"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"jmsTemplate"</span></span> /&gt; &lt;/bean&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"fooRequestProcessor"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"com.blogspot.nurkiewicz.FooRequestProcessor"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"fooRepository"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"fooRepository"</span></span> /&gt; &lt;/bean&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"fooRepository"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"com.blogspot.nurkiewicz.FooRepository"</span></span> init-method=<span class="hljs-string"><span class="hljs-string">"init"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"jdbcOperations"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"jdbcTemplate"</span></span> /&gt; &lt;/bean&gt; &lt;!-- JDBC --&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"dataSource"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.apache.commons.dbcp.BasicDataSource"</span></span> destroy-method=<span class="hljs-string"><span class="hljs-string">"close"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"driverClassName"</span></span> value=<span class="hljs-string"><span class="hljs-string">"org.h2.Driver"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"url"</span></span> value=<span class="hljs-string"><span class="hljs-string">"jdbc:h2:~/workspace/h2/spring-noxmal;DB_CLOSE_ON_EXIT=FALSE;TRACE_LEVEL_FILE=4;AUTO_SERVER=TRUE"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"username"</span></span> value=<span class="hljs-string"><span class="hljs-string">"sa"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"password"</span></span> value=<span class="hljs-string"><span class="hljs-string">""</span></span> /&gt; &lt;/bean&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jdbcTemplate"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jdbc.core.JdbcTemplate"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"dataSource"</span></span> /&gt; &lt;/bean&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"transactionManager"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"dataSource"</span></span> /&gt; &lt;/bean&gt; &lt;tx:annotation-driven /&gt; &lt;!-- JMS --&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jmsConnectionFactory"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.apache.activemq.pool.PooledConnectionFactory"</span></span>&gt; &lt;constructor-arg&gt; &lt;bean <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.apache.activemq.ActiveMQConnectionFactory"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"brokerURL"</span></span> value=<span class="hljs-string"><span class="hljs-string">"tcp://localhost:61616"</span></span> /&gt; &lt;/bean&gt; &lt;/constructor-arg&gt; &lt;/bean&gt; &lt;amq:queue id=<span class="hljs-string"><span class="hljs-string">"requestsQueue"</span></span> physicalName=<span class="hljs-string"><span class="hljs-string">"requests"</span></span> /&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jmsTemplate"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jms.core.JmsTemplate"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"jmsConnectionFactory"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"defaultDestination"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"requestsQueue"</span></span> /&gt; &lt;/bean&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jmsContainer"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jms.listener.DefaultMessageListenerContainer"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"connectionFactory"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"jmsConnectionFactory"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"destination"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"requestsQueue"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"sessionTransacted"</span></span> value=<span class="hljs-string"><span class="hljs-string">"true"</span></span>/&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"concurrentConsumers"</span></span> value=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"messageListener"</span></span>&gt; &lt;bean <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jms.listener.adapter.MessageListenerAdapter"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"fooRequestProcessor"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"defaultListenerMethod"</span></span> value=<span class="hljs-string"><span class="hljs-string">"process"</span></span>/&gt; &lt;/bean&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/beans&gt;</code> </pre> <br>  A pair of user beans, JDBS with transactions and JMS, send and accept.  The details are not particularly important - one of the bins via JMX sends a JMS message, the message is received and persisted in the database. <br><br>  The most common and well-established approach to reducing the XML layer in Spring is to use the <a href="https://habrahabr.ru/users/service/" class="user_link">Service</a> and <a href="https://habrahabr.ru/users/resource/" class="user_link">Resource</a> annotations along with &lt;context: component-scan /&gt; for user beans ( <a href="https://github.com/nurkiewicz/spring-no-xml/commit/69b0a64b23bdb1a913a5dce81abb4c775d98db7d">changes</a> ): <br><pre> <code class="java hljs">&lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> encoding=<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>?&gt; &lt;beans xmlns=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/beans"</span></span> xmlns:xsi=<span class="hljs-string"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span> xmlns:tx=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/tx"</span></span> xmlns:amq=<span class="hljs-string"><span class="hljs-string">"http://activemq.apache.org/schema/core"</span></span> xmlns:context=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/context"</span></span> xsi:schemaLocation=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core-5.4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span></span>&gt; &lt;context:mbean-export /&gt; &lt;context:component-scan base-<span class="hljs-keyword"><span class="hljs-keyword">package</span></span>=<span class="hljs-string"><span class="hljs-string">"com.blogspot.nurkiewicz"</span></span>/&gt; &lt;!-- JDBC --&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"dataSource"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.apache.commons.dbcp.BasicDataSource"</span></span> destroy-method=<span class="hljs-string"><span class="hljs-string">"close"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"driverClassName"</span></span> value=<span class="hljs-string"><span class="hljs-string">"org.h2.Driver"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"url"</span></span> value=<span class="hljs-string"><span class="hljs-string">"jdbc:h2:~/workspace/h2/spring-noxmal;DB_CLOSE_ON_EXIT=FALSE;TRACE_LEVEL_FILE=4;AUTO_SERVER=TRUE"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"username"</span></span> value=<span class="hljs-string"><span class="hljs-string">"sa"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"password"</span></span> value=<span class="hljs-string"><span class="hljs-string">""</span></span> /&gt; &lt;/bean&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jdbcTemplate"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jdbc.core.JdbcTemplate"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"dataSource"</span></span> /&gt; &lt;/bean&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"transactionManager"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"dataSource"</span></span> /&gt; &lt;/bean&gt; &lt;tx:annotation-driven /&gt; &lt;!-- JMS --&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jmsConnectionFactory"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.apache.activemq.pool.PooledConnectionFactory"</span></span>&gt; &lt;constructor-arg&gt; &lt;bean <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.apache.activemq.ActiveMQConnectionFactory"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"brokerURL"</span></span> value=<span class="hljs-string"><span class="hljs-string">"tcp://localhost:61616"</span></span> /&gt; &lt;/bean&gt; &lt;/constructor-arg&gt; &lt;/bean&gt; &lt;amq:queue id=<span class="hljs-string"><span class="hljs-string">"requestsQueue"</span></span> physicalName=<span class="hljs-string"><span class="hljs-string">"requests"</span></span> /&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jmsTemplate"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jms.core.JmsTemplate"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"jmsConnectionFactory"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"defaultDestination"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"requestsQueue"</span></span> /&gt; &lt;/bean&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jmsContainer"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jms.listener.DefaultMessageListenerContainer"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"connectionFactory"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"jmsConnectionFactory"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"destination"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"requestsQueue"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"sessionTransacted"</span></span> value=<span class="hljs-string"><span class="hljs-string">"true"</span></span>/&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"concurrentConsumers"</span></span> value=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"messageListener"</span></span>&gt; &lt;bean <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jms.listener.adapter.MessageListenerAdapter"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"fooRequestProcessor"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"defaultListenerMethod"</span></span> value=<span class="hljs-string"><span class="hljs-string">"process"</span></span>/&gt; &lt;/bean&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/beans&gt;</code> </pre><br>  Minus 10 lines of XML, nothing special ... And user bins? <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooRepository</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Resource</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> JdbcOperations jdbcOperations; <span class="hljs-meta"><span class="hljs-meta">@PostConstruct</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ log.info(<span class="hljs-string"><span class="hljs-string">"Database server time is: {}"</span></span>, jdbcOperations.queryForObject(<span class="hljs-string"><span class="hljs-string">"SELECT CURRENT_TIMESTAMP"</span></span>, Date.class)); } <span class="hljs-comment"><span class="hljs-comment">//... }</span></span></code> </pre><br>  Setters and init methods are replaced by annotations.  So what's next?  Most people ‚Äî someone who likes ‚Äî annotations stop there, but as you can see, a lot of XML remains.  The question now is how to use annotations in the case of third-party things such as connection pools, etc.? <br>  This is where the fun begins.  First we need to get rid of data source XML and replace it all with ... ( <a href="https://github.com/nurkiewicz/spring-no-xml/commit/47cd52c77aed743c8a9326cd24b2b8e88051b173">changes</a> ) <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.sql.DataSource; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.commons.dbcp.BasicDataSource; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Bean; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.annotation.Configuration; <span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContextConfiguration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DataSource </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dataSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> BasicDataSource ds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicDataSource(); ds.setDriverClassName(<span class="hljs-string"><span class="hljs-string">"org.h2.Driver"</span></span>); ds.setUrl(<span class="hljs-string"><span class="hljs-string">"jdbc:h2:~/workspace/h2/spring-noxmal;DB_CLOSE_ON_EXIT=FALSE;TRACE_LEVEL_FILE=4;AUTO_SERVER=TRUE"</span></span>); ds.setUsername(<span class="hljs-string"><span class="hljs-string">"sa"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ds; } }</code> </pre><br>  @Configuration, <a href="https://habrahabr.ru/users/bean/" class="user_link">Bean</a> , dataSource (), what is it ...?!?  But it works just as you thought: Spring finds the ContextConfiguration class and all methods annotated as <a href="https://habrahabr.ru/users/bean/" class="user_link">Bean</a> .  Each such method is equivalent to the XML &lt;bean ...&gt; (here even <a href="https://habrahabr.ru/users/scope/" class="user_link">Scope</a> , @DependsOn and <a href="https://habrahabr.ru/users/lazy/" class="user_link">Lazy</a> ), so we can remove the XML declaration of the dataSource bean.  Although, in general, you can get rid of the JdbcTemplate and transaction manager ( <a href="https://github.com/nurkiewicz/spring-no-xml/commit/1be359959999f12a5913db96ece82210acf60452">changes</a> ): <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> JdbcOperations </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jdbcOperations</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JdbcTemplate(dataSource()); } <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> PlatformTransactionManager </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transactionManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataSourceTransactionManager(dataSource()); }</code> </pre><br>  Pay attention to how easy it is to inject the data source bin into other bins.  You have a method that creates a data source, and you have two methods that need this data source (JdbcTemplate and transaction manager).  It doesn't get any easier, and maybe your girlfriend would have implemented dependency injection (um, <a href="http://code.google.com/p/google-guice/">Guice?</a> ) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      One thing should bother you now ... If you call the dataSource () twice, does this mean that two independent DataSource instances are being created?  This is not at all what we would like.  It puzzled me, but once again Spring turned out to be a smart animal.  Not finding the <a href="https://habrahabr.ru/users/scope/" class="user_link">Scope</a> annotations, he begins to assume that the data source should be singleton and, using a bit of CGLIB proxying magic on the dataSource () method, limits the number of calls to one.  Well, or more specifically, you can call it many times, but return the same bean.  Cool! <br>  As a result, the XML configuration is reduced to: <br><pre> <code class="java hljs">&lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> encoding=<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>?&gt; &lt;beans xmlns=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/beans"</span></span> xmlns:xsi=<span class="hljs-string"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span> xmlns:tx=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/tx"</span></span> xmlns:amq=<span class="hljs-string"><span class="hljs-string">"http://activemq.apache.org/schema/core"</span></span> xmlns:context=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/context"</span></span> xsi:schemaLocation=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core-5.4.2.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span></span>&gt; &lt;context:mbean-export /&gt; &lt;context:component-scan base-<span class="hljs-keyword"><span class="hljs-keyword">package</span></span>=<span class="hljs-string"><span class="hljs-string">"com.blogspot.nurkiewicz"</span></span>/&gt; &lt;!-- JDBC --&gt; &lt;tx:annotation-driven /&gt; &lt;!-- JMS --&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jmsConnectionFactory"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.apache.activemq.pool.PooledConnectionFactory"</span></span>&gt; &lt;constructor-arg&gt; &lt;bean <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.apache.activemq.ActiveMQConnectionFactory"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"brokerURL"</span></span> value=<span class="hljs-string"><span class="hljs-string">"tcp://localhost:61616"</span></span> /&gt; &lt;/bean&gt; &lt;/constructor-arg&gt; &lt;/bean&gt; &lt;amq:queue id=<span class="hljs-string"><span class="hljs-string">"requestsQueue"</span></span> physicalName=<span class="hljs-string"><span class="hljs-string">"requests"</span></span> /&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jmsTemplate"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jms.core.JmsTemplate"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"jmsConnectionFactory"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"defaultDestination"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"requestsQueue"</span></span> /&gt; &lt;/bean&gt; &lt;bean id=<span class="hljs-string"><span class="hljs-string">"jmsContainer"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jms.listener.DefaultMessageListenerContainer"</span></span>&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"connectionFactory"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"jmsConnectionFactory"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"destination"</span></span> ref=<span class="hljs-string"><span class="hljs-string">"requestsQueue"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"sessionTransacted"</span></span> value=<span class="hljs-string"><span class="hljs-string">"true"</span></span>/&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"concurrentConsumers"</span></span> value=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"messageListener"</span></span>&gt; &lt;bean <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"org.springframework.jms.listener.adapter.MessageListenerAdapter"</span></span>&gt; &lt;constructor-arg ref=<span class="hljs-string"><span class="hljs-string">"fooRequestProcessor"</span></span> /&gt; &lt;property name=<span class="hljs-string"><span class="hljs-string">"defaultListenerMethod"</span></span> value=<span class="hljs-string"><span class="hljs-string">"process"</span></span>/&gt; &lt;/bean&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/beans&gt;</code> </pre><br>  Now you can stop and think about how to rewrite the remaining bins in the configuration.  It's not worth it, everything is transparent ( <a href="https://github.com/nurkiewicz/spring-no-xml/commit/ac2d5a09a247366e89daa27c3f6230f27df8043c">changes</a> ). <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ConnectionFactory </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmsConnectionFactory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> ActiveMQConnectionFactory factory = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveMQConnectionFactory(); factory.setBrokerURL(<span class="hljs-string"><span class="hljs-string">"tcp://localhost:61616"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PooledConnectionFactory(factory); } <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Queue </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">requestsQueue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveMQQueue(<span class="hljs-string"><span class="hljs-string">"requests"</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> JmsOperations </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmsOperations</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> JmsTemplate jmsTemplate = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JmsTemplate(jmsConnectionFactory()); jmsTemplate.setDefaultDestination(requestsQueue()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> jmsTemplate; }</code> </pre><br>  The DefaultMessageListenerContainer declaration contains anonymous inner bins that are used once inside the parent bean.  Private-method in order ( <a href="https://github.com/nurkiewicz/spring-no-xml/commit/8873348272e0f6ae7f6929d9d2062eae5e49d2b9">changes</a> ): <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> AbstractJmsListeningContainer </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmsContainer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> DefaultMessageListenerContainer container = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultMessageListenerContainer(); container.setConnectionFactory(jmsConnectionFactory()); container.setDestination(requestsQueue()); container.setSessionTransacted(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); container.setConcurrentConsumers(<span class="hljs-number"><span class="hljs-number">5</span></span>); container.setMessageListener(messageListenerAdapter()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> container; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> MessageListenerAdapter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">messageListenerAdapter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> MessageListenerAdapter adapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MessageListenerAdapter(fooRequestProcessor); adapter.setDefaultListenerMethod(<span class="hljs-string"><span class="hljs-string">"process"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> adapter; }</code> </pre><br><br>  There is nothing to comment on because plain Java configuration in Spring is trivial and unpretentious - the code speaks for itself.  In case you are confused, we have come to this: <br><br>  &lt;? xml version = "1.0" encoding = "UTF-8"?&gt; <br>  &lt;beans xmlns = " <a href="http://www.springframework.org/schema/beans">www.springframework.org/schema/beans</a> " <br>  xmlns: xsi = " <a href="http://www.w3.org/2001/XMLSchema-instance">www.w3.org/2001/XMLSchema-instance</a> " <br>  xmlns: tx = " <a href="http://www.springframework.org/schema/tx">www.springframework.org/schema/tx</a> " <br>  xmlns: context = " <a href="http://www.springframework.org/schema/context">www.springframework.org/schema/context</a> " <br>  xsi: schemaLocation = " <a href="http://www.springframework.org/schema/beans">www.springframework.org/schema/beans</a> <a href="">www.springframework.org/schema/beans/spring-beans-3.0.xsd</a> <br>  <a href="http://www.springframework.org/schema/tx">www.springframework.org/schema/tx</a> <a href="">www.springframework.org/schema/tx/spring-tx-2.5.xsd</a> <br>  <a href="http://www.springframework.org/schema/context">www.springframework.org/schema/context</a> <a href="">www.springframework.org/schema/context/spring-context.xsd</a> ¬ª&gt; <br><br>  &lt;context: mbean-export /&gt; <br><br>  &lt;context: component-scan base-package = "com.blogspot.nurkiewicz" /&gt; <br><br>  &lt;tx: annotation-driven /&gt; <br><br><br><br>  Honestly, it wasn't all that hard, but it was really hard to get rid of the last few lines of XML.  Believe me - you do not want to do what I did to cope with these beautiful little namespace-powered ads.  But after a couple of minutes, a couple of unsuccessful experiences and a heap of scanned Spring-code, I finally removed the JMX declarations ( <a href="https://github.com/nurkiewicz/spring-no-xml/commit/8457d4c081b08d4308c2cb90e4def1c67e02cab9">changes</a> ) and transactions ( <a href="https://github.com/nurkiewicz/spring-no-xml/commit/83033cf328d70dc41fec510b3f831e286af33301">changes</a> ).  It looks innocent and I am pleased that you didn‚Äôt have to dig into the Spring code to get to it yourself: <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> AnnotationMBeanExporter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">annotationMBeanExporter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AnnotationMBeanExporter(); } <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> TransactionAttributeSource </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">annotationTransactionAttributeSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AnnotationTransactionAttributeSource(); } <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> TransactionInterceptor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transactionInterceptor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TransactionInterceptor(transactionManager(), annotationTransactionAttributeSource()); }</code> </pre><br>  Like this.  It remains to remove the XML instructions for Spring regarding the location of the beans and the web.xml snippet: <br><pre> <code class="java hljs">&lt;context:component-scan base-<span class="hljs-keyword"><span class="hljs-keyword">package</span></span>=<span class="hljs-string"><span class="hljs-string">"com.blogspot.nurkiewicz"</span></span>/&gt; &lt;web-app xmlns=<span class="hljs-string"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee"</span></span> xmlns:xsi=<span class="hljs-string"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span> xsi:schemaLocation=<span class="hljs-string"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span></span> version=<span class="hljs-string"><span class="hljs-string">"3.0"</span></span>&gt; &lt;listener&gt; &lt;listener-<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">org</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">springframework</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">web</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContextLoaderListener</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">listener</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">listener</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">web</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">app</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre><br>  There is no other way to launch Spring normally in a web environment, you must tell the web container that you need Spring.  I know, I know, I promised that there would be no XML at all, well, I lied, and that now ... sorry, OK?  Business ... Yeah, just kidding.  ÔÅä Let's get rid of it.  A couple of seconds!  Well ... although it depends on how quickly you download the newest <a href="http://tomcat.apache.org/download-70.cgi">Tomcat 7</a> or other <a href="http://jcp.org/en/jsr/detail%3Fid%3D315">JSR 315</a> (known as Servlet 3.0) web container ... <br><br>  Web fragments are a technology that allows you to delicately integrate various web frameworks into servlet containers.  If you have experience with frameworks, then you know that they all need a description of a special servlet, filter, or listener in web.xml.  In most cases, this is the only time that servlet dependency occurs and Spring is no exception.  The essence of web fragments is that they are trying to free developers from this.  Servlet 3.0 containers should scan all JARs in / WEB-INF / lib and, if any of the JARs contain web-fragment.xml in / META-INF, it will be registered in web.xml. <br><br>  Understand where I lead?  What if we create a small JAR with a small web fragment just to run Spring without XML?  WAR structure: <br><pre> <code class="java hljs">. |-- META-INF `-- WEB-INF |-- classes | |-- com | | `-- blogspot | | `-- nurkiewicz | | |-- ContextConfiguration.class | | |-- FooRepository.class | | |-- FooRequestProcessor.class | | |-- FooService$<span class="hljs-number"><span class="hljs-number">1</span></span>.class | | `-- FooService.class | `-- logback.xml |-- lib | |-- spring-web-<span class="hljs-number"><span class="hljs-number">3.0</span></span>.5.RELEASE.jar | |-- spring-web-fragment-<span class="hljs-number"><span class="hljs-number">0.0</span></span>.1-SNAPSHOT.jar | | `-- META-INF | | |-- MANIFEST.MF | | |-- web-fragment-context.xml | | `-- web-fragment.xml | `-- spring-beans-<span class="hljs-number"><span class="hljs-number">3.0</span></span>.5.RELEASE.jar `-- web.xml</code> </pre><br>  The sole purpose of the spring-web-fragment is *. Jar in providing the web-fragment.xml container: <br><pre> <code class="java hljs">&lt;web-fragment xmlns=<span class="hljs-string"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee"</span></span> xmlns:xsi=<span class="hljs-string"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span> xsi:schemaLocation=<span class="hljs-string"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-fragment_3_0.xsd"</span></span> version=<span class="hljs-string"><span class="hljs-string">"3.0"</span></span>&gt; &lt;listener&gt; &lt;listener-<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">org</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">springframework</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">web</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContextLoaderListener</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">listener</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">listener</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">param</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">param</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">contextConfigLocation</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">param</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">param</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">classpath</span></span></span><span class="hljs-class">*:/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">META</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">INF</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">web</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fragment</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">xml</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">param</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">param</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">web</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fragment</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre><br>  One new element is the web fragment-context.xml Spring context file.  We cannot use the default (/WEB-INF/applicationContext.xml), because this file is no longer (!).  But our little JAR looks as if he were the best place for it: <br><pre> <code class="java hljs">&lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> encoding=<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>?&gt; &lt;beans xmlns=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/beans"</span></span> xmlns:context=<span class="hljs-string"><span class="hljs-string">"http://www.springframework.org/schema/context"</span></span> xmlns:xsi=<span class="hljs-string"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span> xsi:schemaLocation=<span class="hljs-string"><span class="hljs-string">" http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd "</span></span>&gt; &lt;context:component-scan base-<span class="hljs-keyword"><span class="hljs-keyword">package</span></span>=<span class="hljs-string"><span class="hljs-string">"."</span></span> /&gt; &lt;/beans&gt;</code> </pre><br>  Package declaration in the form of "."  causes alertness.  This is very sad, but I tried to bypass the requirement in the declaration of at least one package.  This requirement may have been justified (I think the CLASSPATH scan takes some time), but I couldn‚Äôt just specify my package, otherwise I would have to change this ad for each new project.  But this goes against the main advantage of the web-fragments approach ‚Äî when creating a JAR with two small XML files, it can be used for all projects.  All that is needed is to include it in your WAR's library list and start annotating the POJO as a <a href="https://habrahabr.ru/users/service/" class="user_link">Service</a> (and / or use @Configuration). <br><br>  If it is available amongst what Spring offers out of the box (if you like the idea, <a href="https://jira.springframework.org/browse/SPR-7872">vote</a> ), then newbies will be able to enjoy the journey to Spring as soon as they add Spring to pom.xml.  In fact, pom.xml can be written in various <a href="http://polyglot.sonatype.org/why.html">languages</a> , like <a href="http://logback.qos.ch/manual/groovy.html">logback.xml</a> .  Hey, no xml!  Are you sure?  Do you like XML or Java?  Or maybe Groovy?  Please be silent.  Spring gives you the opportunity to be as simple and straightforward to use as you want.  Without being so simplified that the functionality will be trimmed. <br></div><p>Source: <a href="https://habr.com/ru/post/112488/">https://habr.com/ru/post/112488/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../112483/index.html">Launchlist for your site</a></li>
<li><a href="../112484/index.html">12 Blade Blade for HP BladeSystem</a></li>
<li><a href="../112485/index.html">A useful keylocker or is it really so mean?</a></li>
<li><a href="../112486/index.html">What is taught in school</a></li>
<li><a href="../112487/index.html">LibreOffice 3.3</a></li>
<li><a href="../112490/index.html">Useful tips: beep in the Windows console</a></li>
<li><a href="../112491/index.html">Dark matter of the internet</a></li>
<li><a href="../112492/index.html">HTC Android Developers Contest 2.0 has started in Ukraine</a></li>
<li><a href="../112493/index.html">Breaking safes with brute force</a></li>
<li><a href="../112495/index.html">Code editor with syntax highlighting of popular languages ‚Äã‚Äã- Touchqode</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>