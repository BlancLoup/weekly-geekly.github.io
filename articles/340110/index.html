<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cocos2d-x - Scenes and special types of nodes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From translator 
 Greetings We continue to translate documentation for the cocos2d-x engine. This article contains two chapters at once, small in size...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cocos2d-x - Scenes and special types of nodes</h1><div class="post__text post__text-html js-mediator-article"><h2>  From translator </h2><br>  Greetings  We continue to translate <a href="http://www.cocos2d-x.org/docs/programmers-guide/scenes/index.html">documentation</a> for the cocos2d-x engine.  This article contains two chapters at once, small in size.  As you have already guessed, in the first we will analyze the ways of working with scenes, and at the end we will consider several more types of nodes. <br><br>  I hope you find a lot of useful things for yourself! <br><br><h2>  What is a scene? </h2><br>  The <b>Scene</b> object is a container containing sprites, labels, nodes, and other objects needed by your game.  <b>Scene</b> is responsible for running the game logic and rendering the content in each frame.  You will need at least one scene to start the game.  Think of your game as a movie.  When <b>Scene is</b> running, users see what is happening in real time.  There can be any number of scenes in your game and you can easily switch between them.  Cocos2d-x is capable of transitions between scenes and you can even do it with cool effects. <br><a name="habracut"></a><br><h2>  Scene creation </h2><br>  It is very simple to create a scene: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> myScene = Scene::create();</code> </pre> <br><h2>  Remember the scene graph? </h2><br>  In the <a href="https://habrahabr.ru/post/339564/">first part of the tutorial,</a> we learned about <b>Scene Graph</b> and how it affects the design of our game.  It is important to remember that it determines the order in which the <b>GUI</b> (graphical user interface) elements are drawn.  Also remember about the z-order! <br><br><h2>  Simple scene </h2><br>  Let's build a simple scene.  Remember that Cocos2d-x uses the <b>right Cartesian coordinate system</b> .  This means that the coordinate <b>0,0</b> is in the lower left corner of the screen / display.  To correctly position the elements of your game, you must calculate everything in advance.  Let's create a simple scene and add a few elements to it: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> dirs = Director::getInstance(); Size visibleSize = dirs-&gt;getVisibleSize(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> myScene = Scene::create(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> label1 = Label::createWithTTF(<span class="hljs-string"><span class="hljs-string">"My Game"</span></span>, <span class="hljs-string"><span class="hljs-string">"Marker Felt.ttf"</span></span>, <span class="hljs-number"><span class="hljs-number">36</span></span>); label1-&gt;setPosition(Vec2(visibleSize.width / <span class="hljs-number"><span class="hljs-number">2</span></span>, visibleSize.height / <span class="hljs-number"><span class="hljs-number">2</span></span>)); myScene-&gt;addChild(label1); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> sprite1 = Sprite::create(<span class="hljs-string"><span class="hljs-string">"mysprite.png"</span></span>); sprite1-&gt;setPosition(Vec2(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)); myScene-&gt;addChild(sprite1);</code> </pre><br>  If we run this code, we should see a simple scene containing a <b>label</b> and a <b>sprite</b> .  This is a bit, but only for now. <br><cut></cut><br><h2>  Transition between scenes </h2><br>  You may need the ability to move between scenes in your game.  Probably at the beginning of a new game, changing the level or at its completion.  Cocos2d-x provides a number of ways to transition between scenes. <br><br><h3>  Ways to replace the scene </h3><br>  There are many ways to change your scenes.  Each has a certain functionality.  Let's go over them. <br>  <b>Given:</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> myScene = Scene::create();</code> </pre><br>  <b>runWithScene ()</b> - used only for the first scene.  With this method we set the scene for the start of the game. <br><br><pre> <code class="cpp hljs">Director::getInstance()-&gt;runWithScene(myScene);</code> </pre><br>  <b>replaceScene ()</b> is an immediate scene replacement. <br><br><pre> <code class="cpp hljs">Director::getInstance()-&gt;replaceScene(myScene);</code> </pre><br>  <b>pushScene ()</b> - suspends the execution of the current scene, adding it to the stack of suspended scenes.  Call only when there is an active scene. <br><br><pre> <code class="cpp hljs">Director::getInstance()-&gt;pushScene(myScene);</code> </pre><br>  <b>popScene ()</b> - this scene will be replaced by the active one.  The current scene will be deleted.  Call only when there is an active scene. <br><br><pre> <code class="cpp hljs">Director::getInstance()-&gt;popScene(myScene);</code> </pre><br><h3>  Scene change with effects </h3><br>  You can add visual effects to change your scenes. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> myScene = Scene::create(); <span class="hljs-comment"><span class="hljs-comment">//   Director::getInstance()-&gt;replaceScene(TransitionFade::create(0.5, myScene, Color3B(0,255,255))); //   X Director::getInstance()-&gt;replaceScene(TransitionFlipX::create(2, myScene)); //   Director::getInstance()-&gt;replaceScene(TransitionSlideInT::create(1, myScene) );</span></span></code> </pre><br><cut></cut><br><h2>  Other types of nodes </h2><br>  You are already using <b>Sprite</b> , <b>Label</b> and <b>Action</b> - objects in your game and this is progress.  In addition to the basic node types described in previous chapters, Cocos2d-x provides more advanced node types with special functionality.  Maybe you want to make a game <b>based on tiles</b> ?  Or maybe a <b>2D platform game</b> ?  Or maybe you want to add <b>particle effects</b> to your game?  Cocos2d-x provides Node objects to help you with this! <br><br><h3>  Tilemap </h3><br>  <b>TileMaps</b> are maps consisting of tiles (tiles).  Each tile can have independent behavior.  <b>TileMaps</b> are stored in an <b>XML</b> -based map format called <b>TMX</b> .  <b>TMX</b> was originally designed for tile maps, but it is also suitable for creating common game levels thanks to the support of various types of objects.  TMX objects are easy to create: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    auto map = TMXTiledMap::create("TileMap.tmx"); addChild(map, 0, 99); //   "99"</span></span></code> </pre> <br><br>  Tile cards can have several layers defined by a z-order.  You can access a specific layer by its name: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//     auto map = TMXTiledMap::create("TileMap.tmx"); auto layer = map-&gt;getLayer("Layer0"); auto tile = layer-&gt;getTileAt(Vec2(1, 63));</span></span></code> </pre><br>  Each tile has a unique position and ID.  This makes it very easy to choose the desired tile.  You can get any by its id (id): <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//     unsigned int gid = layer-&gt;getTileGIDAt(Vec2(0, 63));</span></span></code> </pre><br>  Example of layers in the tile map: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2e7/325/bbc/2e7325bbca904fc06aa626c0208e923b.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e68/13c/b7f/e6813cb7f5629cdd11038af2842bb143.png" alt="image"><br><br>  How to make a map of tiles?  There are many tools that do this.  <a href="http://mapeditor.org/">Tiled</a> is a popular utility.  He is actively developing and has a great community.  Screenshots from above - real projects in <b>Tiled</b> . <br><br><h3>  Particle effects </h3><br>  Maybe your game needs effects like fire, spells or explosions?  How do you implement such complex effects?  Is it possible?  Of course!  Use <b>particle systems</b> .  <b>Particle system</b> is a computer graphics technology that uses a large number of very small sprites or other graphic elements to simulate fuzzy objects that are otherwise very difficult to reproduce using conventional rendering methods.  Some real examples may include very chaotic systems: natural phenomena or processes caused by chemical reactions.  Here are a couple of examples <b>of particle effects</b> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/07e/a82/75c/07ea8275c877b57a70112ea25edc456f.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/d71/7f7/e1e/d717f7e1e97af54df54f27c9c0a28d76.png" alt="image"><br><br><h4>  Particle Effecting Tools </h4><br>  Although you can create effects manually, specifying each property to your taste, for this there are several third-party utilities.  Some of the tools are: <br><br><ol><li>  <a href="https://71squared.com/particledesigner">Particle Designer</a> : a very powerful effect editor for Mac. </li><li>  <a href="http://v-play.net/2014/02/v-play-particle-editor-for-cocos2d-and-v-play/">V-play particle editor</a> : Cross-platform particle system editor for Cocos2d-x. </li><li>  <a href="http://www.effecthub.com/particle2dx">Particle2dx</a> : online particle effects designer. </li></ol><br>  These output tools provide a <b>.plist</b> file that you can read using Cocos2d-x to use your creation inside your game.  As with all the other classes we worked with, we use the <b>create ()</b> method: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   .plist  auto particleSystem = ParticleSystem::create("SpinningPeas.plist");</span></span></code> </pre><br><h4>  Inline particle effects </h4><br>  Are you ready to add effects to your game?  Is it difficult for you to create your own effects?  For simplicity, there are a number of built-in particle effects from which you can choose.  Take a look at this list: <br><br><ul><li>  ParticleFire: point system of particles.  Uses gravity mode. </li><li>  ParticleFireworks: point system of particles.  Uses gravity mode. </li><li>  ParticleSun: point particle system: Uses gravity mode. </li><li>  ParticleGalaxy: point system of particles.  Uses gravity mode </li><li>  ParticleFlower: point particle system.  Uses gravity mode </li><li>  ParticleMeteor: point system of particles.  Uses gravity mode </li><li>  ParticleSpiral: point system of particles.  Uses gravity mode </li><li>  ParticleExplosion: point system of particles.  Uses gravity mode </li><li>  ParticleSmoke: point system of particles.  Uses gravity mode </li><li>  ParticleShow: point system of particles.  Uses gravity mode </li><li>  ParticleRain: a point particle system.  Uses gravity mode </li></ul><br>  Using, for example, <b>ParticleFireworks</b> , you can easily create inline effects: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> emitter = ParticleFireworks::create(); addChild(emitter, <span class="hljs-number"><span class="hljs-number">10</span></span>);</code> </pre><br>  The result is an effect that looks something like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0de/e85/0e6/0dee850e6c9a4bab86b6a7747798c21e.png" alt="image"><br><br>  But what if your <b>particle effect is</b> not exactly what you would like it to be?  Yes, you can manually change it!  Take the same firework and change its properties: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> emitter = ParticleFireworks::create(); <span class="hljs-comment"><span class="hljs-comment">//   emitter-&gt;setDuration(ParticleSystem::DURATION_INFINITY); //   emitter-&gt;setEmitterMode(ParticleSystem::Mode::RADIUS); // : 100    emitter-&gt;setStartRadius(100); emitter-&gt;setStartRadiusVar(0); emitter-&gt;setEndRadius(ParticleSystem::START_RADIUS_EQUAL_TO_END_RADIUS); emitter-&gt;setEndRadiusVar(0); //  ,  start = end addChild(emitter, 10);</span></span></code> </pre><br><h3>  Parallax </h3><br>  <b>Parallax</b> - is a unique type of <b>nodes</b> that simulates <b>parallax scrolling</b> .  <i>Couple ..</i> what?  Yes, parallax.  Simply put, you can view a <b>parallax node</b> as a <b>special effect</b> that creates a different appearance of the position and direction of an object, depending on the point of view.  We meet with parallax all the time when we watch TV or shoot something on camera.  You can recall many games that work this way.  Super Mario Bros is a classic example.  <b>Parallax nodes</b> can be moved by performing a <b>sequence</b> , as well as manually using the mouse, touching, or using the keyboard. <br><br>  Parallax nodes are a bit more complicated than regular nodes.  Why?  Because they require several nodes for their work.  <b>Parallax nodes</b> cannot work by themselves.  You need at least 2 <b>nodes</b> to work.  As usual, in Cocos2d-x, <b>parallax nodes are</b> easy to create: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    auto paraNode = ParallaxNode::create();</span></span></code> </pre><br>  We need several <b>Node</b> objects, they are also easily added: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    auto paraNode = ParallaxNode::create(); //     0.4, 0.5 paraNode-&gt;addChild(background, -1, Vec2(0.4f,0.5f), Vec2::ZERO); //      2.2, 1.0 paraNode-&gt;addChild(middle_layer, 1, Vec2(2.2f,1.0f), Vec2(0,-200) ); //      3.0, 2.5 paraNode-&gt;addChild(top_layer, 2, Vec2(3.0f,2.5f), Vec2(200,800) );</span></span></code> </pre><br>  Okay, looks familiar, right?  Pay attention to a few things!  Each <b>node added is</b> assigned a unique z-order so that they overlap each other.  Also note the additional two parameters of type <b>Vec2</b> in the <b>addChild ()</b> call.  This is the <b>ratio</b> and <b>offset</b> .  These parameters can be considered as the ratio of the speed of internal nodes to the speed of the parent node. <br><br>  It is difficult to show the <b>parallax node</b> in the text, but you can try to write this code yourself, or run a test project - <a href="https://github.com/chukong/programmers-guide-samples">Programmer Guide Sample</a> to see it in action! <br><br>  Next article: <a href="https://habrahabr.ru/post/341066/">Cocos2d-x - Event Manager</a> </div><p>Source: <a href="https://habr.com/ru/post/340110/">https://habr.com/ru/post/340110/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340096/index.html">Another post "why Agile does not work" (with pictures)</a></li>
<li><a href="../340100/index.html">Hilbert curve vs Z-order</a></li>
<li><a href="../340104/index.html">Western Digital released the first 14 terabyte HDD</a></li>
<li><a href="../340106/index.html">How we drove drug dealers out of the runet</a></li>
<li><a href="../340108/index.html">Accelerate the vagrant shared-folder on the Windows host (UPD. Not everything is so smooth)</a></li>
<li><a href="../340114/index.html">Monitoring of all web project layers</a></li>
<li><a href="../340116/index.html">ReactNative, Xamarin, PhoneGap, and Qt architectures. Part 1</a></li>
<li><a href="../340120/index.html">Splunk 7.0. What's new?</a></li>
<li><a href="../340122/index.html">ReactNative, Xamarin, PhoneGap, and Qt architectures. Part 2</a></li>
<li><a href="../340124/index.html">Crossing Task</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>