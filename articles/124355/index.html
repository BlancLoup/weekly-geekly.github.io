<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Solaris: Adding a new LUN to the system</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Given: 
 Solaris 10 server on board and Qlogic HBA. FC has a storage connected to it and 2 new LUs are presented. 
 Task: 
 Rescan LUN, preferably wit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Solaris: Adding a new LUN to the system</h1><div class="post__text post__text-html js-mediator-article"><h3>  Given: </h3><br>  Solaris 10 server on board and Qlogic HBA.  FC has a storage connected to it and 2 new LUs are presented. <br><h3>  Task: </h3><br>  Rescan LUN, preferably without shutting down the HBA and rebooting the server, so as not to interrupt the operation of applications. <br><br>  How to do it? <br>  There are several solutions, depending on the situation and the environment.  I will describe those that are known to me.  Not all of them are guaranteed to work in your environment, but the chance that at least one will allow you to achieve the desired result is quite high.  I tested the solutions on Solaris 10, but some will work on Solaris 7-9, with some amendments. <br><br>  If you are interested in the solutions I found, I ask for cat. <br><a name="habracut"></a><br><h3>  First: </h3><br>  If you have Solaris 8, 9 or 10 and Hlo Qlogic, like me, then it is usually enough to run the following command <br><blockquote>  cfgadm ‚Äìal </blockquote><br>  cfgadm allows you to manage dynamically-variable server hardware resources. <br>  The <strong>‚Äìl</strong> key allows you to display the status of devices. <br>  key - <strong>and</strong> indicates that <strong>‚Äìl</strong> also <strong>displays a</strong> list of dynamic resources. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Everything, disks already appeared: <br> <a href=""><img title="image" src="http://volnyanskiy.ru/wp-content/uploads/2011/06/image_thumb8.png" alt="image" width="590" height="373"></a> <br><br><h3>  The second </h3><br>  It makes sense to proceed to this step if the first one did not give any results.  Enter in the console: <br><blockquote>  luxadm probe ‚Äìp </blockquote><br>  <strong>luxadm</strong> is responsible for managing FC AL devices and performing various control and polling commands <br>  The <strong>probe</strong> subcommand searches and displays all FC devices. <br>  The <strong>‚Äìp</strong> key, in addition to the probe, displays physical paths for found devices.  Useful for diagnosing SAN network zoning and checking path availability. <br> <a href=""><img title="image" src="http://volnyanskiy.ru/wp-content/uploads/2011/06/image_thumb9.png" alt="image" width="593" height="374"></a> <br><br><h3>  Third </h3><br>  If the previous solutions did not help, then continue: <br><blockquote>  devfsadm -c disk </blockquote><br>  <strong>devfsadm</strong> contains the / dev namespace and replaces the outdated set of applications from the devfs package, including drvconfig, disks, tapes, ports, and a couple more. <br>  The <strong>‚Äìc</strong> switch limits the types of devices that need to be polled and requires you to explicitly tell it what to check.  In my case, it's a type of <strong>disk.</strong> <br>  After this operation, the disks also usually appear. <br><br><h3>  Fourth </h3><br>  I described the cfgadm command a little higher.  I made it in a separate decision, because here it will take a little more action to add a device and a few more options. <br><blockquote>  1. cfgadm -c configure cX <br>  or <br>  2. cfgadm -c configure cX :: 216000c0ff804351 <br>  or <br>  3. cfgadm -o force_update -c configure cX </blockquote><br>  The key - <strong>c</strong> is responsible for changing the status of devices on the channels. <br>  The <strong>configure</strong> option configures the hardware so that it can be used on the Solaris OS. <br>  The <strong>‚Äìo</strong> switch allows you to pass certain options to the hardware component, in our case it is force_update, which performs a forced update. <br><br>  Now more options: <br>  In the first option, instead of <strong>"</strong> <strong>cX",</strong> you need to specify the channel number on which the device is located, for this we return to the picture from the first method: <br> <a href=""><img title="image" src="http://volnyanskiy.ru/wp-content/uploads/2011/06/image_thumb10.png" alt="image" width="590" height="373"></a> <br>  Suppose this is channel 2, then the command will look like this: <br><blockquote>  cfgadm -c configure c2 </blockquote><br>  In option 2, we specify which device you need to configure: <br><blockquote>  cfgadm -c configure c2 :: 216000c0ff804351 </blockquote><br>  In the third option, we tell the system to forcefully update the device configuration: <br><blockquote>  cfgadm -o force_update -c configure c2 <br>  or even so <br>  cfgadm -o force_update -c c2 :: 216000c0ff804351 </blockquote><br>  After all these manipulations, you will need to run the command: <br><blockquote>  devfsadm -c disk </blockquote><br><h3>  Fifth </h3><br>  To reload the HBA driver, this method may already be associated with a slight downtime. <br>  In the case of Qlogic, a driver reload is called with the following command: <br><blockquote>  update_drv qlc <br>  or <br>  update_drv -f qlc </blockquote><br>  <strong>update_drv</strong> is just responsible for rescanning driver settings. <br>  The - <strong>f</strong> parameter forces the driver to re-read the configuration, even if the module cannot be unloaded from the kernel.  (At the same time, the driver module itself from the kernel is not unloaded) <br><br><h3>  Sixth </h3><br>  No matter how trite it sounds, restart the server. <br>  To tell Solaris about the need to scan all devices at boot, you can use the following methods: <br>  <strong>A)</strong> In the loaded OS <br><blockquote>  touch / reconfigure <br>  init 6 </blockquote><br>  <strong>B)</strong> From the OpenBoot server bootloader specify the command: <br><blockquote>  boot -r </blockquote><br><br>  Perhaps those who work with the Solaris OS will find these answers quite simple or obvious.  But my acquaintance with Solaris is rather limited, so these tips may well be useful for other people who are starting to work with Solaris servers. </div><p>Source: <a href="https://habr.com/ru/post/124355/">https://habr.com/ru/post/124355/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124349/index.html">Google+ and set theory</a></li>
<li><a href="../124350/index.html">HDOut.tv, watch TV shows online</a></li>
<li><a href="../124351/index.html">Social botnets</a></li>
<li><a href="../124352/index.html">Rewriting web content</a></li>
<li><a href="../124354/index.html">Tulalip project leaked to the network</a></li>
<li><a href="../124356/index.html">Hotmail updated the security system of the service, prohibiting users from choosing simple passwords</a></li>
<li><a href="../124358/index.html">Amazon sells Kindle 3G with ads for $ 139</a></li>
<li><a href="../124359/index.html">Blitz with Arkady Moreynis</a></li>
<li><a href="../124360/index.html">Solution for high-load databases and hosting "1C-Accounting"</a></li>
<li><a href="../124366/index.html">Monitoring VMWare Virtualization Platform (Part 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>