<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The release of the alpha version of the Internet of Things protocol stack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! The festive atmosphere is already knocking on the screens of monitors and arrives by spam to your email addresses. So we decided to fulfill our...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The release of the alpha version of the Internet of Things protocol stack</h1><div class="post__text post__text-html js-mediator-article">  Hello!  The festive atmosphere is already knocking on the screens of monitors and arrives by spam to your email addresses.  So we decided to fulfill our <a href="https://habrahabr.ru/post/317056/">promise</a> and bring our stack to the light. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fbd/7b9/90b/fbd7b990b0dc4329859eb529cca69cc9.png"></div><a name="habracut"></a><br>  Let's get to the main point: what have we done about it?  Immediately make a reservation: we will not compare the MOAR and IPv6 stack, because now talking about IPv6 is almost the same as talking about teenage sex: everyone talks about it, few people know anything about it and only a few have tried it . <br><br><h3>  A few words about our test node </h3><br>  We will call the node one device with one stack instance.  The node was created to test the operation of the stack in relation to external sensors. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We needed the most transportable solution, and initially everything was packed in a simple cardboard box.  But it was not enough for a long time, but we were annoyed to constantly open the box for information, and given that all the elements were attached to the wires, the complexity of use at one point overpowered laziness, and it was suggested to make a case.  Access to a 3D printer quickly put an end to the question of how to make it.  The test device turned out quite successful and made its way with us from Kaliningrad to Helsinki and back by Russian Post. <br><br><h3>  Examples </h3><br>  In the release there is an example on the basis of which it will be possible to understand how to use the stack in your applications.  We will develop the educational base and work to make the adaptation of our solution to your projects as comfortable as possible. <br><br>  Having dealt with peripheral issues, we proceed to consider the structure of the stack. <br><br>  The logical structure of the MOAR stack contains several levels: <br><br>  <b>Interface layer</b> - provides a direct connection to the nearest nodes via some physical or logical channel.  Interface levels can be several, one for each physical or logical data exchange interface.  The level either works with the interface driver, or it performs its role. <br><br>  <b>The link layer</b> - selects the most appropriate method of communication (interface) with each of the nearest nodes and performs related tasks. <br><br>  <b>Routing level (‚Äúrouting‚Äù)</b> - provides algorithms for finding the most optimal data transfer routes. <br><br>  <b>View Level</b> - provides cryptography and data partitioning, as well as inverse transformations. <br><br>  <b>Service Level</b> - provides an API for using the MOAR stack from other applications. <br><br>  At the moment, each level is executed in a separate thread of the main process, but for security purposes it is possible to separate the levels depending on the privileges necessary for their work. <br><br>  Well, we proceed to the description of the installation process and configuration.  First, download the repository, you can do it by <a href="https://github.com/moarstack/moarstack">reference</a> , or, using git, go to the desired folder and execute the command: <br><br><pre><code class="cmake hljs">git clone https://git@github.com:moarstack/moarstack.git</code> </pre> <br>  Most of the directories in the MOAR repository stack have a special purpose: <br><br><blockquote>  <b>./</b> - files presented in the root directory (such as CMakeLists.txt) are designed to build the entire project and all other projects in internal directories (sometimes located in one subdirectory, as is done for levels). <br>  <b>layers /</b> - directories with headers (* .h) and source codes (* .c) for each level, including common files with source codes and header files for all levels.  Also in this directory, you can add other levels to compile with the stack <br>  <b>interface /, channel /, routing /, presentation /, service /</b> - directories with files with source codes and header files related only to a specific level. <br>  <b>shared /</b> - files with definitions common to all levels. <br>  <b>libmoar /</b> - source files and header files that can be used in other projects to link to the MOAR stack and use it for data transfer.  Thus, these files implement the API functionality for the MOAR stack. <br>  <b>moard /</b> - files with source codes and header files that combine all levels into a linux daemon <br>  <b>tools /</b> - source files and header files for additional utilities using the MOAR stack, or ensuring the operation of the MOAR stack.  For example, the mockit utility is a virtual data transmission medium that allows you to debug the work of several instances of the stack, taking into account the attenuation of the radio signal in the medium (in its simplest form). </blockquote><br>  The folder structure is more or less clear; let's proceed to compiling and building the project: <br><br>  Go to the root folder: <br><br><pre> <code class="cmake hljs">d moarstack_linux</code> </pre> <br>  and sequentially execute the following commands: <br><br><pre> <code class="cmake hljs">cmake . make</code> </pre> <br>  After a successful build, the config, lib and bin directories should appear in the root.  In the current implementation, the installation into the system is not provided, however, the moard can be run as a daemon, and, of course, you can use screen or LSB scripts for autorun. <br><br>  Consider the configuration files: <br><br>  Along the path <code>config/moarstack/</code> is the main configuration file moar.conf <br><br>  <code>moardSettings.LogPath = /var/log/moard.log</code> - the location of the log file <br>  <code>moardSettings.LayersEnabledDir = layers_enabled</code> - directory relative to moar.conf where the configuration of the other layers is located <br>  <code>nodeaddress.address = 0123456789abcdef</code> - node address in hex, 8 bytes (must be different for nodes, in the current implementation of the stack static addressing. In a strong simplification, this address can be represented as an analogue of the IP address in the TCP / IP stack) <br>  <code>ifaceSocket.FileName = /tmp/moarIfaceChannel.sock</code> - socket for interaction of interface levels with the channel level <br>  <code>serviceSocket.FileName = /tmp/moarServiceApi.sock</code> - a socket for interaction of the service level with applications, the API works through it <br><br>  Now consider the configs of the levels, by the way they are located at: <br><br>  <code>config/&lt;moardSettings.LayersEnabledDir&gt;/*.conf</code> - level configs <br><br>  common fields for level configuration files: <br><br>  <code>libraryLocation.FileName =</code> - the file name of the compiled dynamic library.  It can be either a relative or full path, or just the file name.  In the latter case, the search for the library in the file system is assigned to ld.so. <br>  When building and debugging the stack in Clion, you should pay attention to the location of the compiled files, depending on the IDE version it may differ, it is possible that the environment variable LD_LIBRARY_PATH can be set in the settings of the assembly target with the appropriate paths <br><br>  Finally, we come to the first run of the stack.  There are not many arguments to launch moard (just for this reason, --help xD is empty): <br>  <code>--help -h</code> - in the future there will be a page with a description of the arguments <br>  <code>--config=&lt;filename.conf&gt; -c &lt;file.conf&gt;</code> - the name of the configuration file, besides the obvious, allows you to run multiple copies of the stack with different parameters <br><br>  MOAR stack start sequence: <br><br>  0. We read moard arguments, if on the way to -c there is no file we drop out with an error. <br>  1. If the -c argument is not used, look for the default configuration file in <code>../config/moarstack/moar.conf</code> (if not found, we fall out with an error) <br>  2. If the configuration file is found, load it, go to <code>&lt;moardSettings.LayersEnabledDir&gt;/</code> and read there all the <code>*.conf</code> files there. <br>  3. Load the modules in the paths specified in <code>*.conf</code> . <br>  4. If a library with a level of this type has already been loaded, then subsequent attempts to load a level of the same type are ignored.  (Except for interface) <br>  5. Everything!  You can interact with the stack API via the socket specified in <code>serviceSocket.FileName</code> <br><br><h4>  Why did you choose Linux and why did you not include a stack for the MCU in the release? </h4><br>  The MOAR stack is a software solution that can be installed on any device running Linux.  We do not limit MOAR stack users to our solution only, and we want you to treat it as a tool for your own projects, and not as a platform with a rigidly defined architecture.  Publishing technical documentation is only the first step.  Forgive us, Arduino fans, but we believe that making our solutions without restrictions on existing development kits is more interesting and not much more difficult.  And if someone decides to try to assemble another meteorological station with a soldering iron and a MOAR stack, then we will be happy. <br><br>  With open source publishing the stack version for the MCU, the situation is more complicated.  Unfortunately, we live in a world where you have to pay for food, and sometimes we ourselves want to eat.  The stack under the MCU has a more specialized structure and purpose, which are not fully compatible with open source ideas, therefore, we intend to make solutions for MCUs commercial.  As a result, the code published in open source will lag behind commercial versions by about a year. <br><br><h3>  Feedback. </h3><br>  Starting today, the MOAR stack will be in alpha stage for some time, and we do not recommend using it in work projects to avoid problems with their performance.  For those who decide to try our stack, we suggest using repositories with source codes and documentation.  There you can find recommendations for its use.  We found the creation of a separate website or forum inappropriate at the moment: the available channels of communication will be sufficient for prompt editing and feedback. <br><br>  For this, let me leave: we congratulate you on the New Year and for our part we promise to please you with new releases next year. </div><p>Source: <a href="https://habr.com/ru/post/318342/">https://habr.com/ru/post/318342/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318332/index.html">Admin Generator</a></li>
<li><a href="../318334/index.html">NancyFX framework and REST-style services</a></li>
<li><a href="../318336/index.html">Creating custom go-profiles with pprof. Remember stacks</a></li>
<li><a href="../318338/index.html">Can a company with tens of thousands of employees be Agile: MTS experience</a></li>
<li><a href="../318340/index.html">Burnout freelancer on Upwork. Causes, tools, solutions</a></li>
<li><a href="../318350/index.html">How to teach salespeople to speak with developers</a></li>
<li><a href="../318352/index.html">First steps with STM32 and mikroC compiler for ARM architecture - Part 2, start ...</a></li>
<li><a href="../318354/index.html">Release Python 3.6 - yes, now it‚Äôs with us</a></li>
<li><a href="../318358/index.html">Brochure about Ecto - an interface for working with databases on Elixir</a></li>
<li><a href="../318362/index.html">How will your personal data be sold to a startup, in which he invested 70m rubles of IIDF</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>