<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In turbo mode. How to build DevOps in 2 months</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For a short period of time, DevOps in the ‚ÄúUnified Frontal System‚Äù (EFS) program has come a long way, covering the daily practice of all teams. But th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In turbo mode. How to build DevOps in 2 months</h1><div class="post__text post__text-html js-mediator-article">  For a short period of time, DevOps in the ‚ÄúUnified Frontal System‚Äù (EFS) program has come a long way, covering the daily practice of all teams.  But the intensive development work on DevOps continues, and in the near future, the life cycle of the ESF will undergo new changes aimed at accelerating the commissioning of software (continuous delivery) and improving its quality (end-to-end auto-testing).  But more about that later, but for now a little history. <br><br><img src="https://habrastorage.org/web/363/c90/e6c/363c90e6c40a4d9cae1bdc72ffb1ba2e.png"><br><a name="habracut"></a><br><h2>  Part one.  Continuous Integration (CI) and Continuous Deployment (CD) </h2><br>  There was a time when all the applications of the ESF Program were collected locally and deployed to the DEV environment manually: <br><br><ul><li>  Java applications using Apache Maven on the IBM WebSphere Application Server application server; <br></li><li>  JS code - using npm + webpack / gulp on nginx. <br></li></ul><br>  The functional subsystems that make up the EFS have become more and more, common elements of the architecture have been added - IBM WebSphere eXtreme Scale, Oracle database.  The teams began to move to storing code in Atlassian Bitbucket, where they immediately lined up work with branches based on gitflow. <br>  There is a need for frequent builds and automatic deploe.  As a system of continuous integration, they settled on Jenkins - thanks to convenient integration with Bitbucket, ease of configuration, and many additional plug-ins. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first builds in Jenkins were launched when a new pull request appeared and simply collected Java or JS code, sending a notification to Bitbucket about the success or failure of the build run. <br><br>  The next step was the launch of Unit tests during the assembly and distribution of the resulting distributions in NEXUS for the deployment of subsystems to the testing stands.  We also started running static source code analysis in Sonar. <br><br>  Our Continuous Deployment started from the end - with a roll on industrial environments.  At the beginning of June 2017, an urgent task arrived - you need to roll out all the functional subsystems of the ESF to industrial environments within a month.  But we had with us a working solution ‚Äî the installer, which made it possible to install systems of this level on any environments on the IBM WAS reliably and with a guarantee of installation. <br><br>  In principle, the Installer was already ready to implement abstract bank systems of any size, but the following steps had to be performed: <br><br><ul><li>  find information and contacts of the developers of each individual functional subsystem; <br></li><li>  configure configuration files; <br></li><li>  to test the decision and ... <br></li><li>  ... actually implement! <br></li></ul><br>  It took about two weeks to search all the necessary contacts and get information, in parallel, the developers began to fill out the configurations.  It remained only to verify, correct errors and give for testing.  Testing and debugging configurations took another two weeks.  And on July 8, 2017 we went into commercial operation. <br><br>  How did it happen so quickly? <br><br>  It‚Äôs all about the paradigm of building the installer: modularity and separation of the kernel code from the instructions, and already instructions from the final configurations. <br><br>  The system consists of three components: <br><br><ol><li>  a kernel, mostly on Jython, that interprets instructions and configurations; <br></li><li>  instructions in Json format, where each object is an entity in IBM WAS, be it a DataSource or MQ or something else; <br></li><li>  configurations in the simplest format java properties, which themselves are key-value pairs. <br></li></ol><br>  The kernel accepts the subsystem code to be set as the calling parameter.  Further, according to the system code, it finds a set of instructions in the corresponding JSON file and the parameters of a specific environment from property files.  Combining, all objects begin to be interpreted, actually giving control to a particular library function. <br><br>  The advantages of such a system: <br><br><ul><li>  Separating the code from the instructions makes it possible to roll up the settings and automatically calibrate them.  This feature of the installer currently does not provide any of the solutions available for IBM WAS on the market; <br></li><li>  really quick start: it takes dozens of minutes to train developers, not days.  And with the new GUI system of the interface, which would allow to do all these procedures on a click, developers would not have to distract from the business tasks; <br></li><li>  reliability: once-debugged code can be reused many times and be sure that it will accurately and accurately serve the environment. <br></li></ul><br>  Most relevant for industrial environments. <br><br><h2>  Part two.  Today </h2><br><h2>  Deploy system scripts or hybrid scripts </h2><br><h3>  Initial data </h3><br>  Functional subsystems of the ESF in the amount of 70 pieces, eager to move from stage CI to stage CD. <br><br>  Accordingly, the distribution kit as part of directories: <br><br><ul><li>  BH - binary war files for installing applications on WAS; <br></li><li>  PL - static JavaScript CSS, images, fonts to be cached using NGINX; <br></li><li>  DB - contains SQL procedures for creating database objects and filling them with data wrapped in liquibase; <br></li><li>  XS - binary war files for installing applications that provide configuration for working with the eXtreme Scale server. <br></li></ul><br>  System software for the correct functioning of the developed application software consisting of: <br><br><ul><li>  OS; <br></li><li>  Oracle DBMS; <br></li><li>  application server (IBM WebSphere Application Server (WAS)); <br></li><li>  MiddleWare class software that provides guaranteed message delivery (IBM WebSphere MQ); <br></li><li>  distributed cache for non-persistent data caching (IBM WebSphere eXtreme Scale); <br></li><li>  Web server that provides static distribution and balancing on application servers (Nginx). <br></li></ul><br><h3>  Key tasks in developing a deployment script system </h3><br><ul><li>  Configuration management software class MiddleWare; <br></li><li>  Deployment of the distribution subsystem of functional subsystems; <br></li><li>  Automated workflow - for continuous delivery of the developer‚Äôs work to all environments (dev, test, prod). <br></li></ul><br>  Jython (a Java implementation of the scripting language) is used to implement WAS resource configuration libraries and application deployments.  For all other tasks, as well as running Jython scripts (stored as Jinja templates), Ansible is used. <br><br>  Why Ansible? <br><br>  Appearing later than other similar solutions on the market for configuration management products, Ansible offers the lowest entry threshold.  You can learn how to work with Ansible in a relatively short time.  Creating separate modules that extend the capabilities of the product is not difficult, since the product code is written in Python.  The scripting language - playbooks - is quite simple and uses the YAML markup language as the basis. <br>  Also an important advantage is the use of SSH for managing nodes, the absence of additional agents on nodes. <br><br><h3>  Deployment Script System Architecture (SSD) </h3><br>  The system of deployment scripts of functional subsystems is a package of scripts that includes the functionality implemented in the form of a role model and configuration parameters consisting of two blocks: environment parameters and parameters of the functional subsystem. <br><br>  The model of the deployment script system is fully consistent with the concept of DevOps and involves the integration of the script code and the distribution of the application to move along the pipeline from development to commercial operation.  Work and script integration is based on a bundle of Ansible-Nexus-Jenkins software. <br><br><img src="https://habrastorage.org/web/3a1/74b/364/3a174b3648ed4befb9b6015e30079895.jpg"><br><br>  The scheme is <a href="">larger.</a> <br><br>  Let us consider in more detail the functions and components of SSD. <br><br><h3>  Main functions: </h3><br><ul><li>  setting up resources for WAS application servers (DataSource, factories and MQ queues and the like); <br></li><li>  management of applications of functional subsystems of the ESF: installation, removal, update, start-stop; <br></li><li>  installation and configuration of basic and fine-tuning WAS application servers; <br></li><li>  updating the database tables used by the ESF applications; <br></li><li>  update of the statics of the EFS application for the Nginx server; <br></li><li>  detailed logging of all processes for performing the above described functionality; <br></li><li>  Encryption of all confidential information with the possibility of delimiting access to encrypted information. <br></li></ul><br>  The package of the deployment scripts system can be divided conditionally into 4 fragments of interest to the various groups participating in the cycle of IT systems: <br><br><ol><li>  <b>The kernel</b> is the software part, the functionality that is developed within the framework of separate Ansible roles.  Implemented by script developers. <br></li><li>  <b>Ansible playbooks</b> - runners for launching a specific functionality implemented in roles using the parameters of a specific functional subsystem.  Used by system administrators to run scripts, as well as when integrating with Jenkins.  The launch of the playbook is based on the corresponding inventory of the functional subsystem describing the composition of the hosts and the configuration parameters used for the development of roles. <br><br>  A role is a separate module that is developed independently and implements limited functionality.  This flexibility allows you to increase the additional functionality for use by runners, and to use only the functionality that the administrator needs at the moment.  For example, only statics, update only applications, restart servers, etc. <br></li><li>  <b>Developer</b> parameters are parameter files intended for developers of functional subsystems to implement the definition of resources required for their applications.  Included in the distribution of the supplied functional subsystem (conf directory). <br></li><li>  <b>System settings</b> - settings for system administrators of a specific environment: connection parameters to web servers, database URLs, logins, passwords, etc., passwords are stored in encrypted form. <br></li></ol><br>  The parameters of the environment administrators consist of the parameters of a specific functional subsystem stored in the inventory (WAS topology settings, WAS settings of a specific FI, etc.), and general parameters (environment reference book) used by all functional subsystems of the EFS and stored at the environment level (encrypted files passwords and authentication of resources, connections to the necessary servers, queue names, etc.). <br>  The maximum number of settings used by the administrators of the environment is made at the environment level and is not corrected in each individual functional subsystem, but in the environment directory. <br><br><h2>  To be continued </h2><br>  In the near future, we are planning to finalize the DevOps process with the goal of making it more automated, more friendly for all participants ‚Äî developers, testers, dev and test environments, admins, prom, and most importantly ‚Äî more reliable.  We plan to implement many graphic systems that help every step of the way and take the routine actions of employees for themselves, for management - a control and monitoring panel, where in real time you can see the development process, auto-heat dynamics on testing stands, passing autotests. <br><br>  For us, building DevOps is an interesting new process that does not have universal instructions.  We will be happy to chat, discuss your experience and answer questions in the comments! </div><p>Source: <a href="https://habr.com/ru/post/338228/">https://habr.com/ru/post/338228/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338216/index.html">AStA: we collect APK on the device itself</a></li>
<li><a href="../338218/index.html">Broadcast of the conference ‚ÄúHPE Genesis: Future Computing Infrastructure‚Äù</a></li>
<li><a href="../338220/index.html">The philosophy of static code analysis: three simple steps</a></li>
<li><a href="../338222/index.html">How to translate cryptocurrency into another blockchain: a little about sidechains</a></li>
<li><a href="../338226/index.html">Optimize web servers for increased bandwidth and reduced latency</a></li>
<li><a href="../338230/index.html">Kubernetes 1.8: a review of major innovations</a></li>
<li><a href="../338232/index.html">From surgeon to developer: how to change profession in 40 years?</a></li>
<li><a href="../338236/index.html">ServiceNow Platform: Starter Kit</a></li>
<li><a href="../338238/index.html">Sales at the Unity Asset Store. Personal experience</a></li>
<li><a href="../338240/index.html">How to increase service indicators by 7 times in three months using HADI-cycles and prioritization of hypotheses</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>