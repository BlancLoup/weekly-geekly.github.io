<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AI interfaces and where they live</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently we wrote a column on Habr about how we released our own online toy. One of the chips that we were seriously confused about was the AI ‚Äã‚Äãgener...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AI interfaces and where they live</h1><div class="post__text post__text-html js-mediator-article"><p>  Recently we wrote a <a href="https://habr.com/ru/company/uteam/blog/447310/">column</a> on Habr about how we released our own online toy.  One of the chips that we were seriously confused about was the AI ‚Äã‚Äãgeneration of avatars for your character ‚Äúon the fly‚Äù from a photo (as long as it works in the prototype and is not part of the game).  At the same time, the technology itself is interesting and may be applicable not only here.  As promised, we tell about it in more detail and let us feel the prototype alive! </p><br><p>  Under the cat you can also find: why you made a choice in favor of an atypical AI learning system - without marking up the data, and why we consider this a scientific innovation;  our fakapu when creating AI-avatars that do not need to be repeated;  how and where domain adaptation is used today. </p><br><img src="https://habrastorage.org/webt/l_/99/co/l_99co05f8rjk18vz4jstw7mv-g.jpeg" alt="image"><br><a name="habracut"></a><br><h2>  If there is no time to read the post </h2><br><p>  Follow the <a href="https://avatars.web-tycoon.com/">link</a> to look at the work of AI right now. </p><br><blockquote>  <i>Note:</i> <i><br></i>  <i>1. The converter does not work out quickly, so please be patient, non-production power is used.</i> <i><br></i>  <i>2. The system was trained only in the male field, so that from the female photos you will get men, probably effeminate.</i>  <i>Portrait similarity should not be expected, because</i>  <i>the number of elements used is obviously limited, we will tell about it below.</i> </blockquote><br><h2>  Where did the idea to create AI avatars come from? </h2><br><p>  It appeared not out of the blue.  Work on machine learning in the uKit Group has been going on for several years.  Thus, the <a href="https://webscore.ai/ru">WebScore AI</a> project, which assesses the site‚Äôs visual appeal in real time, was open to all comers about a year ago and is being successfully used for the company's internal purposes. </p><br><p>  The use of neural networks in game devs is a topic that periodically acquires a considerable HYIP.  Let us recall No Man's Sky or RimWorld, which received their portion of gaming attention, and not only the community due to a fully generated universe, which has almost infinite variability from the words of the authors themselves.  True, in reality, the generation of worlds was procedural, and therefore it has nothing to do with neural networks.  However, the trend is obvious here - the market is ready for this and is waiting, rubbing their hands! </p><br><p>  We thought that the ability to upload your photo into the game and immediately get a personal, most similar to you avatar, which no one else has - it is fun and can be an interesting enticing feature.  In addition, the technology can clearly find its use outside the game. </p><br><p>  It is worth noting that the similarity of the character with a real person in Web Tycoon will be relative.  This is a deliberate step, because we will collect avatars from the elements drawn by our designers.  And there are several reasons for this.  First, at the exit, we want to get game avatars in the style of the game, while maintaining the flat favorite.  Secondly, we are of course reinsured, because it allows us to always receive a portrait image, regardless of what the user has uploaded. </p><br><img src="https://habrastorage.org/webt/mx/qd/zv/mxqdzvnlqj9cag-di5sornoqmdy.png" alt="image"><br><br><p>  After all, not everyone wants to see a realistic <a href="">cucumber</a> among rivals. </p><br><h2>  Training models without tagged data </h2><br><p>  Such an approach to machine learning can be called innovative, because, in fact, AI is trained at all without the original labeled data.  Due to what is this happening?  The key to success is the availability of tools for generating synthetic data.  Ahead of possible questions: we cannot give ours. </p><br><p>  Why did you decide to teach our AI that way?  The data markup is a monotonous and very voluminous work of assessors.  And if designers suddenly decide to add to the game, for example, a third type of glasses (there were two at the time of writing the system), then it will be necessary to mark everything again, because each example marked up now becomes potentially not optimal. </p><br><p>  In addition, in our case, it was necessary to take into account such a moment as subjectivity: if you give 10 people to collect for one photo on the avatar, we will get 10 different avatars on the way out.  We checked. </p><br><p>  Original photo: </p><br><img src="https://habrastorage.org/webt/dx/no/ci/dxnociumngnvsmjvbcexuwbdmdm.png" alt="image"><br><br><p>  And the results from two different designers of our company: </p><br><img src="https://habrastorage.org/webt/p1/wl/nk/p1wlnkivljc0frnkjstwncrk1uy.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Man vs Machine </h2><br><p>  Learning was not easy.  At first, our AI capitulated in all respects: </p><br><img src="https://habrastorage.org/webt/5c/m3/hq/5cm3hqtrmgzjhfz8pkex4a51vf4.png" alt="image"><br><br><p>  If someone suddenly did not understand, then the original photo here is the same.  Bags under the eyes of AI turns into sunglasses.  Hussar antennae - as a gift.  Real workaholics can regard this as a feature, not a bug. </p><br><p>  Further some more indicative results. </p><br><img src="https://habrastorage.org/webt/h9/hv/mp/h9hvmpqsgt_xeijf7zp4al1wxmk.png" alt="image"><br><br><img src="https://habrastorage.org/webt/cb/ih/jt/cbihjtqkihmnjlgsxr6dc9frs_u.png" alt="image"><br><br><p>  Glasses just do not add and can even dress up!  There are certain problems with color rendering. </p><br><h2>  Directly about the development process </h2><br><p>  As a starting point, we took a few ready-made Style Transfer solutions, but they quickly had to be abandoned because they did not fit us in their pure form.  We also tried to use generative models by themselves, but quickly rested on the fact that most of the solutions we came across either did not have examples of implementation or did not give a result. </p><br><p>  As a result, CycleGAN became the first successful generative model, which we took as a basis, finishing it to fit our needs.  Perceptual Loss was called to help the standard CycleGAN.  This is a very noticeable beauty of the resulting images. </p><br><p>  Below you can see CycleGAN in action: </p><br><img src="https://habrastorage.org/webt/zl/yr/4c/zlyr4cwdqut7oiqrihq_rvghazu.gif" alt="image"><br><br><p>  Or another example, clear and familiar to everyone who has ever used the Prisma application: </p><br><img src="https://habrastorage.org/webt/s_/2g/0e/s_2g0enplniq7gj6vo9cj21dwyu.jpeg" alt="image"><br><br><p>  The main difficulty has traditionally been to force the generative model to learn normally.  The whole family of such models has a lot of rather characteristic sores, which in recent years everyone is trying to solve: long training time, mode collapse, sensitivity to initialization. </p><br><p>  There were also purely engineering problems that, in theory, many should face, but for some reason very few people write about it.  For example, we needed to do a fast parallel data load with augmentation, and the standard set of augmentations presented in keras / tf / pytorch was not enough for us.  Plus, initially I wanted to augment on the CPU.  The augmentation on the CPU has its undeniable advantages, the main of which, in our opinion, is the ability to ‚Äúunload‚Äù the video card, thereby dividing the duties between the two computers. </p><br><h2>  How to solve problems </h2><br><p>  In the case of GAN training, we mainly worked with loss functions (loss functions).  So, we have added identity loss and color loss.  They were simultaneously played with the architecture of the generator inside CycleGAN, as a result of which they came to a 12-block reznet (the original one was a bit short for us). </p><br><p>  In the case of duplicate code, we wrote higher-level wrappers on the models, allowing us to reuse the code used in several models at once.  The code for date generators was also summarized in a similar way for the same reasons. </p><br><p>  To solve the third problem (loading with augmentations on the CPU) I had to invent and write my own chip, but about this next time.  We can only say that it is due to her technology can be successfully used for other projects that are not related to avatars. </p><br><h2>  Fakapy when creating AI-interfaces </h2><br><p>  The main mistake is an incorrect assessment of the complexity of the task.  At first glance, it often seems that there is a huge amount of ready-made solutions that are 99% suitable for you.  They only need to take and safely transfer to your case.  So, it's not like that.  Separately, it is worth showing what it is like to observe how in GAN, which has been successfully studying for several days, suddenly something literally explodes, which is why it begins to generate complete game. </p><br><p>  Like this: </p><br><img src="https://habrastorage.org/webt/jt/mf/mn/jtmfmn4oxizs9vzfxvaedcnrwhk.gif" alt="image"><br><br><p>  Another serious problem was that at the initial stages we forgot about the fixation of a random seed, and we remember that the GANs are extremely sensitive to initialization.  A very shameful failure on our part, put a like for frankness. </p><br><h2>  Where is Domain Adaptation used today? </h2><br><p>  Domain adaptation slowly but surely penetrates into AI tasks.  This steady trend is due to the fact that despite the rapid growth of available information in the modern world, the markup still remains a long and expensive exercise.  The development of Transfer Learning and its generalizations in the face of Domain Adaptation solves this problem. </p><br><p>  An example of the practical application of domain adaptation is the work of Apple to expand the dataset of photographs of human eyes by adapting synthetically generated images.  In their study, they showed that the effective approach is the generation of initially tagged artificial data, followed by approximation to real data using Domain Adaptation methods. </p><br><img src="https://habrastorage.org/webt/4p/bx/ml/4pbxmlnu7eg1loz7hbzgppbjenq.png" alt="image"><br><br><p>  Or another interesting example.  In 2017, a group of scientists came up with an unusual approach to collecting data about streets, roads, pedestrians and other environments, which should contain self-driving cars for their training. </p><br><p>  They offered to take this information from GTA V. </p><br><img src="https://habrastorage.org/webt/mz/uq/ef/mzuqef2pd0bhjw2e2j8fhq5irro.png" alt="image"><br><br><p>  To this end, over 480,000 tagged virtual images of normal driving on the highway were generated in the virtual environment of Grand Theft Auto V.  Using these images, the system was trained to read all the main variables necessary for basic autonomous driving: determine the distance to cars and other objects in front, the strip marking and the driving angle (angular course relative to the centerline of the strip).  A Tesla fatal accident in Florida was also analyzed. </p><br><h2>  Future for NST and GAN </h2><br><p>  Can we talk about this with confidence?  Perhaps yes.  Neural Style Transfer uses Prisma.  By analogy with this, new applications are being created, and not only for entertainment needs.  GANs can also be used as a tool for solving a wide variety of tasks: coloring images, generating images from noise, even generating images from text. </p><br><p> Returning to the game dev theme.  Here, the possibilities of domain adaptation are potentially limitless: if in a case with training of unmanned vehicles, the textures of the game world of GTA V were taken, from which something very similar to the photos of the real world was obtained, then absolutely nothing prevents from doing the opposite: to generate game textures from panoramic images of real cities . </p><br><p>  Plus the car is that it does not get tired.  A computer can now generate a huge number of different views in a split second.  Our task is to learn how to do it effectively and efficiently, and then it remains only to separate the wheat from the chaff and get high. </p><br><p>  Any questions?  We are pleased to answer them in the comments. </p></div><p>Source: <a href="https://habr.com/ru/post/449494/">https://habr.com/ru/post/449494/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../44948/index.html">SMS notifications with your own hands</a></li>
<li><a href="../449484/index.html">We create air quality control sensor on InfluxDB, Grafana, Docker and Raspberry Pi</a></li>
<li><a href="../449486/index.html">Mass outcome of browser games</a></li>
<li><a href="../44949/index.html">Perpetuum mobile Magnetogenerator free energy.</a></li>
<li><a href="../449490/index.html">Slurm: intense by Kubernetes. Program and bonuses</a></li>
<li><a href="../449496/index.html">Hackathon DevDays'19 (part 2): a parser of sound messages for Telegram and grammar checker in IntelliJ IDEA</a></li>
<li><a href="../449498/index.html">Analysts: Microsoft's estimate will soon exceed $ 1 trillion</a></li>
<li><a href="../4495/index.html">Investors admitted: a lot of money, but there are not enough startups</a></li>
<li><a href="../449500/index.html">How not to succumb to panic, if a lot of programmers came to visit?</a></li>
<li><a href="../449502/index.html">Antiquities: an incredible videotape</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>