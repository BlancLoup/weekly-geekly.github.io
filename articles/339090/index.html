<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ggplot2: how to easily combine multiple graphs in one, part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will show step by step how to combine several ggplot graphs in one or several illustrations using the helper functions available in the R...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ggplot2: how to easily combine multiple graphs in one, part 3</h1><div class="post__text post__text-html js-mediator-article">  This article will show step by step how to combine several <b>ggplot</b> graphs in one or several illustrations using the helper functions available in the R <a href="http://www.sthda.com/english/rpkgs/ggpubr/index.html"><b>ggpubr</b></a> , <a href="https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html"><b>cowplot</b></a> and <a href="https://github.com/danielinteractive/gridextra"><b>gridExtra packages</b></a> .  We also describe how to export the resulting graphs to a file. <br>  <a href="https://habrahabr.ru/post/336492/">First part</a> <br>  <a href="https://habrahabr.ru/post/337598/">The second part of</a> <br><a name="habracut"></a><br><h2>  Mix table, text and ggplot2 graphics </h2><br>  In this section, we will show how to display a table and text along with a graph.  We will use the iris dataset. <br><br>  Start by creating these graphs: <br><br><ol><li> <b>density graph of</b> Sepal.Length.  R function: <code>ggdensity()</code> [in <b>ggpubr</b> ] </li><li>  <b>summary table</b> containing descriptive statistics (mean, standard deviation, etc.) Sepal.Length <br><ul><li>  Function R for calculating descriptive statistics: <code>desc_statby()</code> [in <b>ggpubr</b> ] </li><li>  R function to create a table with text: <code>ggtexttable()</code> [in <b>ggpubr</b> ] </li></ul></li><li>  <b>paragraph text</b> .  R function: <code>ggparagraph()</code> [in <b>ggpubr</b> ] </li></ol><br>  We conclude by combining all three graphs using the <code>ggarrange()</code> function [in <b>ggpubr</b> ]. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql">#   "Sepal.Length" #:::::::::::::::::::::::::::::::::::::: density.p &lt;- ggdensity(iris, x = "Sepal.Length", fill = "Species", palette = "jco") #    Sepal.Length #:::::::::::::::::::::::::::::::::::::: #      <span class="hljs-keyword"><span class="hljs-keyword">stable</span></span> &lt;- desc_statby(iris, measure.var = "Sepal.Length", grps = "Species") <span class="hljs-keyword"><span class="hljs-keyword">stable</span></span> &lt;- <span class="hljs-keyword"><span class="hljs-keyword">stable</span></span>[, c("Species", "length", "mean", "sd")] #    ,  "medium orange" ( ) <span class="hljs-keyword"><span class="hljs-keyword">stable</span></span>.p &lt;- ggtexttable(<span class="hljs-keyword"><span class="hljs-keyword">stable</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>, theme = ttheme("mOrange")) #   #:::::::::::::::::::::::::::::::::::::: <span class="hljs-type"><span class="hljs-type">text</span></span> &lt;- paste("iris data set gives the measurements in cm", "of the variables sepal length and width", "and petal length and width, respectively,", "for 50 flowers from each of 3 species of iris.", "The species are Iris setosa, versicolor, and virginica.", sep = " ") <span class="hljs-type"><span class="hljs-type">text</span></span>.p &lt;- ggparagraph(<span class="hljs-type"><span class="hljs-type">text</span></span> = <span class="hljs-type"><span class="hljs-type">text</span></span>, face = "italic", size = <span class="hljs-number"><span class="hljs-number">11</span></span>, color = "black") #     ggarrange(density.p, <span class="hljs-keyword"><span class="hljs-keyword">stable</span></span>.p, <span class="hljs-type"><span class="hljs-type">text</span></span>.p, ncol = <span class="hljs-number"><span class="hljs-number">1</span></span>, nrow = <span class="hljs-number"><span class="hljs-number">3</span></span>, heights = c(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>))</code> </pre> <br><img src="https://habrastorage.org/webt/59/d0/f8/59d0f8d99f5bd954291631.png"><br><h2>  Adding a graphic element to ggplot </h2><br>  To add tables, graphs or other elements based on tables to the ggplot workspace, there is a function <code>annotation_custom()</code> [in <b>ggplot2</b> ].  Simplified format: <br><br><pre> <code class="hljs lisp">annotation_custom(<span class="hljs-name"><span class="hljs-name">grob</span></span>, xmin, xmax, ymin, ymax)</code> </pre> <br><ul><li>  <b>grob</b> : external graphic element to display </li><li>  <b>xmin</b> , <b>xmax</b> : x-location in coordinates (horizontal location) </li><li>  <b>ymin</b> , <b>ymax</b> : y-location in coordinates (vertical location) </li></ul><br><h3>  Place the table in ggplot </h3><br>  We use the density.p and stable.p graphics created in the previous section. <br><br><pre> <code class="hljs pgsql">density.p + annotation_custom(ggplotGrob(<span class="hljs-keyword"><span class="hljs-keyword">stable</span></span>.p), xmin = <span class="hljs-number"><span class="hljs-number">5.5</span></span>, ymin = <span class="hljs-number"><span class="hljs-number">0.7</span></span>, xmax = <span class="hljs-number"><span class="hljs-number">8</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/59/d0/fa/59d0fa516bce7002084486.png"><br><h3>  Place the scatterplot in ggplot </h3><br><ol><li>  Create a scatter plot for y = ‚ÄúSepal.Width‚Äù by x = ‚ÄúSepal.Length‚Äù from the iris dataset.  R: <code>ggscatter()</code> [ <b>ggpubr</b> ] <b>function</b> . </li><li>  Create a separate scatterplot of x and y variables with a transparent background.  R function: <code>ggboxplot()</code> [ <b>ggpubr</b> ]. </li><li>  Transform a scatterplot into a graphical object called ‚Äúgrob‚Äù in Grid terminology.  R function: <code>ggplotGrob()</code> [ <b>ggplot2</b> ]. </li><li>  Place the scatter plots inside the scatter plots.  R: <code>annotation_custom()</code> [ <b>ggplot2</b> ] <b>function</b> . </li></ol><br>  Since the scatterplot placed inside is superimposed at several points, a transparent background is used for it. <br><br><pre> <code class="hljs django"><span class="xml"><span class="xml">#     ("Species") #:::::::::::::::::::::::::::::::::::::::::::::::::::::::::: sp </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ggscatter</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">iris</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Sepal.Length"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Sepal.Width"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Species"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">palette</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"jco"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">3,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">alpha</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.6)</span></span></span></span><span class="xml"><span class="hljs-tag"> #    </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">/</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag"> #</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span></span></span><span class="xml"><span class="hljs-tag"> #    </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xbp</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ggboxplot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">iris</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Sepal.Length</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.3,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fill</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"lightgray"</span></span></span></span><span class="xml"><span class="hljs-tag">) + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rotate</span></span></span></span><span class="xml"><span class="hljs-tag">() + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">theme_transparent</span></span></span></span><span class="xml"><span class="hljs-tag">() #     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ybp</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ggboxplot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">iris</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Sepal.Width</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.3,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fill</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"lightgray"</span></span></span></span><span class="xml"><span class="hljs-tag">) + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">theme_transparent</span></span></span></span><span class="xml"><span class="hljs-tag">() #     #   ‚Äú</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">grob</span></span></span></span><span class="xml"><span class="hljs-tag">‚Äù   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Grid</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xbp_grob</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ggplotGrob</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xbp</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ybp_grob</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ggplotGrob</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ybp</span></span></span></span><span class="xml"><span class="hljs-tag">) #       #</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmin</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">iris</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Sepal.Length</span></span></span></span><span class="xml"><span class="hljs-tag">); </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmax</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">iris</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Sepal.Length</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ymin</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">min</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">iris</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Sepal.Width</span></span></span></span><span class="xml"><span class="hljs-tag">); </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ymax</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">iris</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Sepal.Width</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">yoffset</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">/</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">15</span></span></span></span><span class="xml"><span class="hljs-tag">)*</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ymax</span></span></span></span><span class="xml"><span class="hljs-tag">; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xoffset</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">/</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">15</span></span></span></span><span class="xml"><span class="hljs-tag">)*</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmax</span></span></span></span><span class="xml"><span class="hljs-tag"> #  </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xbp_grob</span></span></span></span><span class="xml"><span class="hljs-tag">    </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">sp</span></span></span></span><span class="xml"><span class="hljs-tag"> + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">annotation_custom</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">grob</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">xbp_grob,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmin</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">xmin,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmax</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">xmax,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ymin</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">ymin-yoffset,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ymax</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">ymin+yoffset)</span></span></span></span><span class="xml"><span class="hljs-tag"> + #  </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ybp_grob</span></span></span></span><span class="xml"><span class="hljs-tag">    </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">annotation_custom</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">grob</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">ybp_grob,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmin</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">xmin-xoffset,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xmax</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">xmin+xoffset,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ymin</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">ymin,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ymax</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">ymax)</span></span></span></span></span></span></code> </pre> <br><img src="https://habrastorage.org/webt/59/d0/ff/59d0ff305bbb9254062271.png"><br><br><h3>  Add a background image to ggplot2 graphics </h3><br>  <b>Import background image.</b>  Use either the <code>readJPEG()</code> function [in the <b>jpeg</b> package] or the <code>readPNG()</code> function [in the <b>png</b> package] depending on the format of the background image. <br><br>  To test the example below, make sure the <b>png</b> package is installed.  You can install it using the <code>install.packages(‚Äúpng‚Äù)</code> command. <br><br><pre> <code class="hljs mel">#   img.<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> &lt;- <span class="hljs-keyword"><span class="hljs-keyword">system</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>.path(<span class="hljs-string"><span class="hljs-string">"images"</span></span>, <span class="hljs-string"><span class="hljs-string">"background-image.png"</span></span>), package = <span class="hljs-string"><span class="hljs-string">"ggpubr"</span></span>) img &lt;- png::readPNG(img.<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>)</code> </pre> <br>  <b>Combine ggplot with background image.</b>  R function: <code>background_image()</code> [in <b>ggpubr</b> ]. <br><pre> <code class="hljs lisp">library(<span class="hljs-name"><span class="hljs-name">ggplot2</span></span>) library(<span class="hljs-name"><span class="hljs-name">ggpubr</span></span>) ggplot(<span class="hljs-name"><span class="hljs-name">iris</span></span>, aes(<span class="hljs-name"><span class="hljs-name">Species</span></span>, Sepal.Length))+ background_image(<span class="hljs-name"><span class="hljs-name">img</span></span>)+ geom_boxplot(<span class="hljs-name"><span class="hljs-name">aes</span></span>(<span class="hljs-name"><span class="hljs-name">fill</span></span> = Species), color = <span class="hljs-string"><span class="hljs-string">"white"</span></span>)+ fill_palette(<span class="hljs-string"><span class="hljs-string">"jco"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/59/d1/19/59d119729c402936444527.png"><br>  Change the transparency of the fill in the scatter diagrams by specifying the argument alpha.  The value must be between [0, 1], where 0 is full transparency, and 1 is lack of transparency. <br><br><pre> <code class="hljs lisp">library(<span class="hljs-name"><span class="hljs-name">ggplot2</span></span>) library(<span class="hljs-name"><span class="hljs-name">ggpubr</span></span>) ggplot(<span class="hljs-name"><span class="hljs-name">iris</span></span>, aes(<span class="hljs-name"><span class="hljs-name">Species</span></span>, Sepal.Length))+ background_image(<span class="hljs-name"><span class="hljs-name">img</span></span>)+ geom_boxplot(<span class="hljs-name"><span class="hljs-name">aes</span></span>(<span class="hljs-name"><span class="hljs-name">fill</span></span> = Species), color = <span class="hljs-string"><span class="hljs-string">"white"</span></span>, alpha = <span class="hljs-number"><span class="hljs-number">0.5</span></span>)+ fill_palette(<span class="hljs-string"><span class="hljs-string">"jco"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/59/d1/1a/59d11a28b196f810686056.png"><br><br>  Another example, overlaying a map of France on ggplot2: <br><br><pre> <code class="hljs mel">mypngfile &lt;- download.<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>(<span class="hljs-string"><span class="hljs-string">"https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/France_Flag_Map.svg/612px-France_Flag_Map.svg.png"</span></span>, destfile = <span class="hljs-string"><span class="hljs-string">"france.png"</span></span>, mode = <span class="hljs-string"><span class="hljs-string">'wb'</span></span>) img &lt;- png::readPNG(<span class="hljs-string"><span class="hljs-string">'france.png'</span></span>) ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + background_image(img)+ geom_point(aes(<span class="hljs-keyword"><span class="hljs-keyword">color</span></span> = Species), alpha = <span class="hljs-number"><span class="hljs-number">0.6</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">size</span></span> = <span class="hljs-number"><span class="hljs-number">5</span></span>)+ color_palette(<span class="hljs-string"><span class="hljs-string">"jco"</span></span>)+ theme(legend.position = <span class="hljs-string"><span class="hljs-string">"top"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/59/d1/1a/59d11a821d341405106490.png"><br><br><h2>  We have graphics on several pages. </h2><br>  If you have a long list of ggplot-s, say, n = 20, you might want to organize them by placing them on several pages.  If there are 4 graphics on the page, for 20 you will need 5 pages. <br><br>  The <code>ggarrange()</code> function [in <b>ggpubr</b> ] provides a convenient solution to place several ggplot-s on several pages.  After setting the nrow and ncol arguments, the <code>ggarrange()</code> function automatically calculates the number of pages it takes to place all the graphs.  It returns a list of ordered ggplot-s. <br><br>  For example, the code below <br><br><pre> <code class="hljs xml">multi.page <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">-</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ggarrange</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bxp</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dp</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bp</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sp</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">nrow</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ncol</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">2)</span></span></span></span></code> </pre> <br>  returns two pages with two graphs on each.  You can display each page like this: <br><pre> <code class="hljs lua">multi.page<span class="hljs-string"><span class="hljs-string">[[1]]</span></span> #   <span class="hljs-number"><span class="hljs-number">1</span></span> multi.page<span class="hljs-string"><span class="hljs-string">[[2]]</span></span> #   <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br>  Ordered graphs can be exported to a pdf file using the <code>ggexport()</code> function [in <b>ggpubr</b> ]: <br><br><pre> <code class="hljs lisp">ggexport(<span class="hljs-name"><span class="hljs-name">multi</span></span>.page, filename = <span class="hljs-string"><span class="hljs-string">"multi.page.ggplot2.pdf"</span></span>)</code> </pre> <br>  <a href="https://www.slideshare.net/kassambara/multipageggplot2">PDF file</a> <br><br>  Multipage output can be obtained with the <code>marrangeGrob()</code> function [in <b>gridExtra</b> ]. <br><br><pre> <code class="hljs xml">library(gridExtra) res <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">-</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">marrangeGrob</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">list</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bxp</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dp</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bp</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sp</span></span></span><span class="hljs-tag">), </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">nrow</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ncol</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">2)</span></span></span><span class="hljs-tag"> #   </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pdf-</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ggexport</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">res</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">filename</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"multi.page.ggplot2.pdf"</span></span></span><span class="hljs-tag">) #   </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">res</span></span></span></span></code> </pre> <br><h2>  Nested positioning with ggarrange () </h2><br>  Let us arrange the graphs created in the previous sections. <br><br><pre> <code class="hljs lisp">p1 &lt;- ggarrange(<span class="hljs-name"><span class="hljs-name">sp</span></span>, bp + font(<span class="hljs-string"><span class="hljs-string">"x.text"</span></span>, size = <span class="hljs-number"><span class="hljs-number">9</span></span>), ncol = <span class="hljs-number"><span class="hljs-number">1</span></span>, nrow = <span class="hljs-number"><span class="hljs-number">2</span></span>) p2 &lt;- ggarrange(<span class="hljs-name"><span class="hljs-name">density</span></span>.p, stable.p, text.p, ncol = <span class="hljs-number"><span class="hljs-number">1</span></span>, nrow = <span class="hljs-number"><span class="hljs-number">3</span></span>, heights = c(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.3</span></span>)) ggarrange(<span class="hljs-name"><span class="hljs-name">p1</span></span>, p2, ncol = <span class="hljs-number"><span class="hljs-number">2</span></span>, nrow = <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/59/d1/1d/59d11d49ed582984919556.png"><br><br><h2>  Export graphs </h2><br>  Function R: <code>ggexport()</code> [in <b>ggpubr</b> ]. <br><br>  First, create a list of 4 ggplot-s corresponding to the variables Sepal.Length, Sepal.Width, Petal.Length and Petal.Width in the iris data set. <br><br><pre> <code class="hljs lua">plots &lt;- ggboxplot(iris, x = <span class="hljs-string"><span class="hljs-string">"Species"</span></span>, y = c(<span class="hljs-string"><span class="hljs-string">"Sepal.Length"</span></span>, <span class="hljs-string"><span class="hljs-string">"Sepal.Width"</span></span>, <span class="hljs-string"><span class="hljs-string">"Petal.Length"</span></span>, <span class="hljs-string"><span class="hljs-string">"Petal.Width"</span></span>), color = <span class="hljs-string"><span class="hljs-string">"Species"</span></span>, palette = <span class="hljs-string"><span class="hljs-string">"jco"</span></span> ) plots<span class="hljs-string"><span class="hljs-string">[[1]]</span></span> #    plots<span class="hljs-string"><span class="hljs-string">[[2]]</span></span> #     ..</code> </pre> <br>  You can then export individual graphs to a file (pdf, eps or png) (one graph per page).  You can arrange the graphics (2 per page) when exporting. <br><br>  Export individual graphs to pdf (one per page): <br><br><pre> <code class="hljs lisp">ggexport(<span class="hljs-name"><span class="hljs-name">plotlist</span></span> = plots, filename = <span class="hljs-string"><span class="hljs-string">"test.pdf"</span></span>)</code> </pre> <br><br>  Arrange and export.  Set nrow and ncol to display several graphs on the same page: <br><br><pre> <code class="hljs lisp">ggexport(<span class="hljs-name"><span class="hljs-name">plotlist</span></span> = plots, filename = <span class="hljs-string"><span class="hljs-string">"test.pdf"</span></span>, nrow = <span class="hljs-number"><span class="hljs-number">2</span></span>, ncol = <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/339090/">https://habr.com/ru/post/339090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339078/index.html">Periods of sidereal days in radioactive decay</a></li>
<li><a href="../339080/index.html">Dive into Ethereum development. Part 3: user application</a></li>
<li><a href="../339082/index.html">The digest of interesting materials for the mobile developer # 223 (September 25 - October 1)</a></li>
<li><a href="../339084/index.html">Liquibase: an example of an automated roll forward of changes to a relational database</a></li>
<li><a href="../339086/index.html">Rethinking drag & drop</a></li>
<li><a href="../339092/index.html">Classic 2D quest or how our two years of development went. Part 3</a></li>
<li><a href="../339094/index.html">Heading "We read articles for you." September 2017</a></li>
<li><a href="../339096/index.html">Electronic documents in the Russian courts, as a criterion for the electronic maturity of Russia</a></li>
<li><a href="../339098/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ282 (September 25 - October 1, 2017)</a></li>
<li><a href="../339100/index.html">The most important IT event of the fall: Dell EMC Forum 2017</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>