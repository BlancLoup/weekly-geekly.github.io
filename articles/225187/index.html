<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zetes: Java with a multi-platform GUI, but without an Oracle JVM</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="annotation 
 This article describes a framework that allows you to create graphical cross-platform applications written in the Java language, but comp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zetes: Java with a multi-platform GUI, but without an Oracle JVM</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3fc/0df/0a9/3fc0df0a97fd83e90d7aeae64f246cc3.png" alt="image"><br><br><h4>  annotation </h4><br>  This article describes a framework that allows you to create graphical cross-platform applications written in the Java language, but completely independent of Oracle JRE or OpenJDK.  The main ideology of the framework is, if possible, to remove from the developer the concerns about providing a ‚Äúnative‚Äù look and feel for the application under each operating system. <br><br>  In fact, at the output you will receive an executable file that relies only on system APIs, which will not be labeled "written in Java" anywhere. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All components of the framework have liberal licenses (BSD or Apache), which allows them to be used in any (including commercial) developments. <br><br>  The framework is in the public alpha version stage, which means some of its working capacity, but unverified.  Use is encouraged (I will try to listen to complaints about problems and help solve them), but performance is not guaranteed. <br><br>  A ready-made, assembled version of applications that demonstrate the framework's work under all platforms is <a href="">here</a> . <br><br>  All interested in the details of mercy please under the cat. <br><a name="habracut"></a><br><br><h2>  1. Introduction </h2><br>  There will be a small lyrical introduction.  You can safely skip this section if you are not interested in why this project was born and how it developed.  The technical side of the question begins with section 2. <br><br><h3>  1.1.  About the name </h3><br>  Zetes (in Russian translation - Zet) is one of the "invisible" Olympic gods - the <a href="http://en.wikipedia.org/wiki/Boreads">Boread</a> brothers who participated in the Argonauts' campaign.  Pretty charismatic character with wings on his feet and head. <br><br><h3>  1.2.  The first steps </h3><br>  Just over a year ago I wrote <a href="http://habrahabr.ru/post/176237/">my first article on Habr</a> .  The material was new to me, but it immediately seemed very interesting to me.  It was about an alternative implementation of the Java virtual machine, called <a href="http://oss.readytalk.com/avian/index.html">Avian</a> .  This project allows you to embed a virtual machine directly into the executable file and is distributed under the BSD license, which allows the user to use the resulting solution with impunity for any purpose.  Finally, as a Java developer, I felt complete freedom.  And he did not fail to share this joy, for which he received thanks and an invite.  In the comments there were people who dreamily expressed in the sense that it would be nice to bring some cross-platform GUI here and, I must admit, I myself also had such thoughts, as well as Avian developers ... <br><br>  I wanted to simplify the process of GUI-applications development as much as possible without loss in quality.  I started thinking.  Before me were examples of projects written in Java and running on Windows, Linux and OS X. For example, Eclipse.  Or SmartGIT.  They all had a good (though not perfect) UI, and also all used the SWT graphic library.  This library was fully supported by Avian.  It remains only to put it all together, slightly ‚Äúundercut‚Äù some details, and can be used for small but ambitious projects. <br><br>  Alas, in the process of work inevitable difficulties appeared.  Most of them were due to the imperfections of the standard class library, which is part of Avian.  A project being developed by a small group of people cannot yet boast full compatibility.  Sometimes the most basic things are missing there ... For example, I personally added sockets.  Having tried to start some more or less complex programs and frameworks with the ‚Äúnative‚Äù classpath and failed, I realized that very few Java developers would want to delve into finishing the classes of the standard library, and my passion was pretty bad. <br><br>  It took quite some time before I returned to this topic.  The solution to the problem was to find some alternative Java Core class library.  Unfortunately, the only library I know at the time is the GNU Classpath.  But her license did not suit me.  Perhaps my research will seem to people who are knowledgeable to be the result of naivety.  But, alas, naivety did take place, because it took me about another month (not active, but periodic searches) to come across the now defunct Apache Harmony project.  This project contained all the necessary classes and had to work under all the axes that interested me, but, alas, it was dead.  Add it to Avian was a very time consuming task for one person.  I approached Avian developers with an idea, they pointed out to me that they would not add classes from there directly to Avian, since the BSD license is more relaxed than Apache.  However, it is possible <em>to build Avian with the necessary components taken from the Android Classpath</em> .  This knowledge struck like a bolt from the blue.  Surely!  Android contains the implementation of the Java Classpath, not only the licensing-free Orale, but also suffered in litigation between companies (although in the light of recent events, I think we should all be more careful with such statements).  And the Apache license allows you to use this library.  Added to this is that the Android Classpath is a descendant of the Apache Harmony itself.  So there are no options left. <br><br>  Being in a state of euphoria, I pumped out everything I needed and assembled at home on an Apple machine.  After a little finishing, it all worked.  The executable file was significantly ‚Äústouter‚Äù, and the build took 15 minutes, but as a result I got a working full-fledged autonomous Java.  At that moment I started to write this article in my mind, but the joy disappeared as soon as I tried to put it all together under Windows.  Alas‚Ä¶ <br><br><h3>  1.3.  Finishing Android Classpath </h3><br>  Of course, Android is based on Linux.  And of course, the entire native part of the Classpath is rooted in Posix.  I faced a serious task - to port Android Classpath to Win32.  It was about 3 months ago.  Since the entire assembly is based on MinGW, some basic Posix functions were present (those that are exactly repeated in Windows).  But, alas, some of them work a little differently (for example, WinSock, although it tends to coincide with the BSD Sockets, but, alas, in some places it is quite different from them, especially in the part related to input-output).  The other part is completely absent in Windows in the form in which it is needed.  For example, unnamed pipes in Windows are very limited and do not allow the use of non-blocking I / O, which is necessary for some Java API functions. <br><br>  Fortunately, Comrade <a href="https://habrahabr.ru/users/justaman/" class="user_link">JustAMan</a> helped me in my research, without him I would, at best, still wander around the Posix-docks.  We wrote and tested something ourselves using simple applications, as well as a small <a href="http://www.simpleframework.org/">Simple Framework</a> .  We borrowed other things from open sources, carefully avoiding the GPL code.  Thank God, we are not the only ones in the world who are engaged in such things ... <br><br>  Our goal, of course, was not to recreate the Posix API emulation (Cygwin, which, however, does not have the most liberal license, does a wonderful job of this).  We just wanted LUNI to work (abbreviation from Android. Means Lang Utils Net IO - the four main packages that make up the java core). <br><br>  At the moment, this work in its main part is completed and is in the bugfix stage.  There are still some troubles with the ways, but these are all trivialities. <br><br>  What we have as a result, we bring to your attention. <br><br><h2>  2. Why is all this necessary </h2><br>  The question I‚Äôm probably most afraid of.  An honest answer is this: I do this because I'm interested.  And I hope that it will be useful to someone else.  But, despite the fact that only its users can justify the usefulness of a library (which so far is very small), I will try, at least, to explain its main ideology. <br><br>  Zetes' task is to continue Java in the direction of desktop development.  Despite the fact that the language itself is cross-platform (and even, in some way, portable in compiled form), when developing multisystem applications on it, if the developer wants his application to look at least some kind of "native", he has to take into account "cultural differences".  Examples of darkness.  On Windows (and on Linux + X + GTK), an application must create at least one window to draw a menu bar.  In OS X, the menu is separate from the windows and it perfectly exists in their absence.  In Windows, the Exit item is usually placed in the File, and the About item - in the Help.  In OS X, both are located in the system menu.  But it is - little things.  There is a difference and more serious.  For example, in OS X, a GUI application cannot run in duplicate ‚Äî each program <em>must</em> support either the Multi Document Interface or the Single Document Interface.  That is, when opening a new document, the shell simply transfers its name to an already running application.  This behavior is convenient (if implemented), but on Windows and Linux, it needs to be simulated using other system mechanisms. <br><br>  These (and, in the future, all <em>such</em> discrepancies) should be assumed by Zetes.  Next in line, for example, is the development of a universal cross-platform API that allows an application to store its settings in the Windows system registry, and in the corresponding Library folders on OS X, and in GConf on Linux. <br><br>  <b>In other words, the task of the framework is to bring the API of popular systems ‚Äúto a common denominator‚Äù, adding useful functions of some to useful functions of some.</b> <br><br>  And, anticipating the questions that will inevitably arise, I will say: no, this library will not cover mobile OS, at least for now.  They are <em>too</em> different from the desktop as an ideology, and approaches to programming. <br><br><h2>  3. So what is Zetes? </h2><br>  The framework allows you to take a created java-application and build / package it into a native executable file that depends only on the system libraries (in the case of using SWT, only a few SWT libraries are attached to the application).  You only need the build utility.  The only thing that you have to write besides the program itself is the simplest makefile, which defines such things as the name of the final executable file, as well as the name of the java class containing the entry point (the main function). <br><br>  With more advanced use, the build system will allow you to add source files to C ++, as well as include external libraries, both dynamic and static.  So, in the end, the content should be both clean Java developers who don‚Äôt even know what JNI is and wise wolves that use JNI everywhere. <br><br><h2>  4. What is Zetes made of? </h2><br>  In order to cover as large a class of tasks as possible, the framework was divided into three parts: <br><br><h3>  4.1.  ZetesFeet </h3><br>  At the core is the ZetesFeet library.  It contains Avian, as well as one of two class library options - Avian Classpath or Android Classpath. <br><br>  The pros and cons of each library are shown in the table: <br><table><tbody><tr><td>  Comparison criterion </td><td>  Avian Classpath </td><td>  Android Classpath </td></tr><tr><td>  Completeness and Compliance </td><td>  It contains only the very minimum, although it expands.  However, it is not possible to launch any serious ready project on this platform. </td><td>  Contains the implementation of all core Java Core classes.  Theoretically, it should support any not too confused application.  In practice, there may be complications associated with the transfer of the library on Win32.  Of course, all such errors will be corrected as soon as possible. </td></tr><tr><td>  Executable file size </td><td>  An executable file that does not contain SWT classes is slightly larger than a megabyte. </td><td>  The executable file is blown up to 25 megabytes.  This is mainly not due to the Android classes themselves (which take up about 5MB), but because of the encoding tables, part of ICU4C, the language support library of the Android Classpath </td></tr><tr><td>  License </td><td>  BSD (Compatible with GPL) </td><td>  Apache (also open, but incompatible with the GPL) </td></tr></tbody></table><br>  In other words, if you just want running Java without problems and writing your ‚Äúbikes‚Äù, use the Android Classpath. <br><br>  In addition, ZetesFeet should include all Zetes classes that are not specific to any type of application, but are useful when creating any. <br><br>  Over ZetesFeet built two libraries, alternative to each other. <br><br><h3>  4.2.  ZetesHands </h3><br>  The first of them - ZetesHands - allows you to create console applications.  If you want to make a new system utility, or, for example, any DSL interpreter, go here.  Non-graphical applications use ZetesHands.  On Windows, this application receives a console window.  On OS X, it is compiled into an executable file, but the bundle is not created for it. <br><br><h3>  4.3.  Zeteswings </h3><br>  The second library, ZetesWings, is used to create GUI applications.  The assembly process involves adding icons, the framework itself contains the base classes that the developer must override in order to create his application.  On Windows, the console does not allocate such an application; in OS X, it is built into the bundle when building.  "Cultural differences" when working with GUIs (examples of which were given above) are taken into account here.  The main ideology of the API is common for user interface tasks.  This is a <a href="http://ru.wikipedia.org/wiki/Model-View-Controller">document-view</a> architecture. <br><br>  In order to build an application using Zetes, in its makefile you need to add a link to either ZetesHands.mk or ZetesWings.mk, depending on which of the add-ons you have chosen. <br><br><h2>  5. How to use it?  Let's look at an example - the Tiny Viewer image viewer </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/fed/504/458/fed5044580e2aadfa3f5c4fe7769803c.png"><br><br>  Here I will describe the simplest use case.  First of all, we need an assembled version of Zetes.  You can take it from the <a href="">release page on GitHub</a> .  Create a folder for our experiments with Zetes.  Let's call it, say, <code>zetes-works</code> .  Go into it and inside create a folder <code>zetes</code> , into which we unpack the folder <code>target-**</code> from the downloaded archive.  Now let's go back to <code>zetes-works</code> and create a folder called <code>tinyviewer</code> .  The application we are going to create will be called TinyViewer.  It demonstrates the main features of ZetesWings.  The application is a simple image viewer.  It allows you to simultaneously download multiple files, showing each in a separate window.  The finished version of this program is among the examples presented by me in the <a href="https://github.com/bigfatbrowncat/zetes-examples">zetes-examples</a> repository.  For the impatient at the end of the article there is a link to the compiled release version of the sample applications. <br><br><h3>  5.1.  makefile </h3><br>  Let's start with the makefile.  As I promised, it will be simple and short. <br><br><pre> <code class="hljs ruby">ZETES_PATH = ../zetes APPLICATION_NAME = Tiny\ Viewer BINARY_NAME = tinyview ENTRY_CLASS = tinyviewer/TinyViewerApplication <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> $(ZETES_PATH)/common-scripts/globals.mk <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> $(ZETES_WINGS_PATH)/ZetesWings.mk <span class="hljs-symbol"><span class="hljs-symbol">all:</span></span> package</code> </pre><br><br>  Disassemble line by line.  First of all, the <code>ZETES_PATH</code> variable is <code>ZETES_PATH</code> , which sets the path to the <code>Zetes</code> library relative to the project directory.  Next comes <code>APPLICATION_NAME</code> , the human-readable name of the application  Then - <code>BINARY_NAME</code> - the name of the executable file and <code>ENTRY_CLASS</code> - the name of the class containing the entry point - the function <code>public static void main(String... args);</code>  .  The class name is given by slashes (/), and not by periods, as is customary for Java developers.  That is, in fact, the class will be called <code>tinyviewer.TinyViewerApplication</code> . <br><br>  The next two lines are the connection, in fact, of the ‚Äúmeat‚Äù - an assembly engine included in Zetes and allowing us to write a short makefile.  The first of the connected files - <code>globals.mk</code> - contains general definitions, constants and rules, the <code>ZetesWings.mk</code> file is specifically for ZetesWings.  In the case of using ZetesHands, we would include, respectively, its makefile. <br><br>  Next comes the definition of the main rule.  Since building a complex user project may contain some advanced steps, you must define the basic rule all by yourself.  In this case, we simply execute the package - a rule that will assemble the application and pack it into the archive (or, on OS X, into the dmg image).  If you do not want to pack it, and you only want to get a working application, write <code>all: app</code> . <br><br><h3>  5.2.  Main classes </h3><br>  Since ZetesWings is designed to write cross-platform applications, it takes over some of the architecture of your application.  In particular, the model of document-views (Document-View) is determined by him.  Therefore, in order to make applications, you need to create a class inherited from the following abstractions: <br><ol><li>  <code>ApplicationBase</code> is the main class of the application that defines the global parameters of its behavior.  In fact, it is created in one instance (although it is not a singleton in the strict sense).  It is also advisable to put an entry point into it ( <code>main</code> function) </li><li>  <code>ViewWindowsManagerBase</code> is a class that manages windows-View.  Creates windows for documents, stores links to them.  Communication between the windows through it. </li><li>  <code>MenuConstructorBase</code> - the class that controls the menu - both global (in OS X) and the window menu.  Responsible for the appearance / disappearance / deactivation of menu items, for the correct definition of hot keys.  Working with the main menu of the application to bypass this class is extremely undesirable.  All requests for improvement are accepted.  The main task is to ensure the ‚Äúcultural independence‚Äù of the menu from the platform </li><li>  <code>ViewWindowBase</code> - a window showing the contents of a document.  This implementation is closely related to the notion of <code>Shell</code> from SWT </li><li>  <code>Document</code> - document.  The most abstract of all the entities described.  Must be able to report its title (to form the window title and menu item) with the <code>getTitle()</code> function, and also forcefully clean its resources using the <code>dispose()</code> function </li></ol><br>  All the listed classes (except for the simple <code>Document</code> interface) are templates that have a connection between them.  And now we need to make the heir from each of them and tie these heirs together. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb6/4d0/6e0/fb64d06e06695dde674e69bf0b4a8d20.png"><br>  Associated templates are very convenient - they set up an application skeleton, as it were, a kind of ‚Äúshape‚Äù into which ready-made classes can be expanded, and they will work together.  I hope you enjoy this approach as much as I do. <br><br><h4>  5.2.1.  ImageDocument </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/784/b9c/d24/784b9cd245b7d0ff7a777f6eb1bef7fb.png"><br>  Construction will lead to dependencies "from the bottom up."  Let's start with the document class.  In our case, this is an image that must be loaded using SWT and stored in memory.  Our class will look like this: <br><br><div class="spoiler">  <b class="spoiler_title">ImageDocument.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> tinyviewer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileInputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.InputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.graphics.Image; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.graphics.ImageData; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.widgets.Display; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.abstracts.Document; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageDocument</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Document</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Image image; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String fileName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Image </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputStream stream)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Display display = Display.getDefault(); ImageData data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImageData(stream); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.transparentPixel &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image(display, data, data.getTransparencyMask()); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image(display, data); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { stream.close(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Image </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String fileName)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadImage(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(fileName)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ImageDocument</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String fileName)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fileName = fileName; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.image = loadImage(fileName); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fileName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Image </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> image; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispose</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (image != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !image.isDisposed()) image.dispose(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">finalize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Throwable </span></span>{ dispose(); <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.finalize(); } }</code> </pre></div></div><br>  Everything here is almost obvious.  The <code>loadImage</code> function <code>loadImage</code> responsible for loading the image and is called in the constructor.  The <code>getTitle()</code> function returns the file name, and <code>dispose()</code> frees the image resources.  Just in case, <code>finalize()</code> also redefined to <code>dispose()</code> to be called. <br><br>  Since we deal only with viewing the image, we do not create any modifying methods. <br><br><h4>  5.2.2.  ImageView </h4><br>  This class is not directly related to Zetes, but, nevertheless, our application cannot do without it.  This is a specially written SWT component that displays a picture on the screen. <br><br><div class="spoiler">  <b class="spoiler_title">ImageView.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> tinyviewer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.events.PaintEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.events.PaintListener; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.graphics.GC; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.graphics.Image; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.graphics.Point; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.graphics.Rectangle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.widgets.Canvas; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.widgets.Composite; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageView</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Canvas</span></span></span><span class="hljs-class"> </span></span>{ Image image = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; Image zoomedImage = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> zoom = <span class="hljs-number"><span class="hljs-number">1.0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ImageView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Composite arg0, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arg1)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(arg0, arg1); addPaintListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PaintListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">paintControl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PaintEvent e)</span></span></span><span class="hljs-function"> </span></span>{ draw(e.gc); } }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GC gc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (image != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { checkZoomedImage(); Point viewSize = getSize(); Point imageSize = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point(zoomedImage.getBounds().width, zoomedImage.getBounds().height); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> xpos = viewSize.x &gt; imageSize.x ? viewSize.x / <span class="hljs-number"><span class="hljs-number">2</span></span> - imageSize.x / <span class="hljs-number"><span class="hljs-number">2</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ypos = viewSize.y &gt; imageSize.y ? viewSize.y / <span class="hljs-number"><span class="hljs-number">2</span></span> - imageSize.y / <span class="hljs-number"><span class="hljs-number">2</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; gc.drawImage(zoomedImage, xpos, ypos); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Point </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">desiredSize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (image == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(image.getImageData().width * zoom), (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(image.getImageData().height * zoom)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkZoomedImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (zoomedImage == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || zoomedImage.isDisposed()) { Rectangle bounds = image.getBounds(); zoomedImage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image(image.getDevice(), (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(bounds.width * zoom), (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(bounds.height * zoom)); GC gc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GC(zoomedImage); gc.drawImage(image, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, bounds.width, bounds.height, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(bounds.width * zoom), (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(bounds.height * zoom)); gc.dispose(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Image image)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.image = image; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (zoomedImage != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) zoomedImage.dispose(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.redraw(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Image </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getImage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> image; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setZoom</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> zoom)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.zoom = zoom; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (zoomedImage != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) zoomedImage.dispose(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.redraw(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getZoom</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> zoom; } }</code> </pre></div></div><br>  All its complexity consists in several linear expressions, positioning the image in the center of the window in case it is smaller than this window.  Everything related to zoom - the ability to zoom in / out the image - is not currently used.  If dear readers find in this class any nonsense, I beg you to explain in detail to me in the comments where I am wrong.  Alas, SWT is very poorly documented, so many things had to be found out literally by the ‚Äúscientific point‚Äù. <br><br><h4>  5.2.3.  ImageViewWindow </h4><br>  Let's move on to the next class - the window-View class that displays the image.  This class uses the <code>ImageView</code> class.  In essence, the window will simply be a frame around this very <code>ImageView</code> . <br><br><div class="spoiler">  <b class="spoiler_title">ImageViewWindow.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> tinyviewer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.HashSet; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.SWT; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.custom.ScrolledComposite; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.dnd.DND; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.dnd.DropTarget; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.dnd.DropTargetAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.dnd.FileTransfer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.dnd.Transfer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.events.ControlEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.events.ControlListener; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.graphics.Image; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.graphics.Point; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.layout.FillLayout; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.widgets.Shell; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.wb.swt.SWTResourceManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.base.ViewWindowBase; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageViewWindow</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewWindowBase</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageDocument</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ScrolledComposite scrolledComposite; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropTarget scrolledCompositeDropTarget, imageViewDropTarget; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ImageView imageView; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HashSet&lt;DropTargetAdapter&gt; dropTargetAdapters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashSet&lt;DropTargetAdapter&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addDropTargetListener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DropTargetAdapter dropTargetAdapter)</span></span></span><span class="hljs-function"> </span></span>{ dropTargetAdapters.add(dropTargetAdapter); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (imageViewDropTarget != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !imageViewDropTarget.isDisposed()) { scrolledCompositeDropTarget.addDropListener(dropTargetAdapter); imageViewDropTarget.addDropListener(dropTargetAdapter); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeDropTargetListener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DropTargetAdapter dropTargetAdapter)</span></span></span><span class="hljs-function"> </span></span>{ dropTargetAdapters.remove(dropTargetAdapter); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (imageViewDropTarget != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !imageViewDropTarget.isDisposed()) { scrolledCompositeDropTarget.removeDropListener(dropTargetAdapter); imageViewDropTarget.removeDropListener(dropTargetAdapter); } } <span class="hljs-comment"><span class="hljs-comment">/** * Create contents of the window. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@wbp</span></span></span><span class="hljs-comment">.parser.entryPoint */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Shell </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constructShell</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Shell shell = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Shell(SWT.TITLE | SWT.CLOSE | SWT.MIN | SWT.MAX | SWT.RESIZE | SWT.BORDER | SWT.DOUBLE_BUFFERED); shell.setBackground(SWTResourceManager.getColor(SWT.COLOR_BLACK)); shell.setMinimumSize(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point(<span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>)); shell.setImages(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image[] { SWTResourceManager.getImage(ImageViewWindow.class, <span class="hljs-string"><span class="hljs-string">"/tinyviewer/wingphotos16.png"</span></span>), <span class="hljs-comment"><span class="hljs-comment">// Necessary in Windows (for taskbar) SWTResourceManager.getImage(ImageViewWindow.class, "/tinyviewer/wingphotos64.png"), // Necessary in Windows (for Alt-Tab) SWTResourceManager.getImage(ImageViewWindow.class, "/tinyviewer/wingphotos512.png") // Necessary in OS X }); shell.setLayout(new FillLayout(SWT.HORIZONTAL)); scrolledComposite = new ScrolledComposite(shell, SWT.H_SCROLL | SWT.V_SCROLL | SWT.NO_BACKGROUND); scrolledComposite.setExpandHorizontal(true); scrolledComposite.setExpandVertical(true); imageView = new ImageView(scrolledComposite, SWT.NONE); imageView.setBounds(0, 0, 200, 127); imageView.setVisible(false); imageView.setBackground(shell.getDisplay().getSystemColor(SWT.COLOR_BLACK)); // Drop targets scrolledCompositeDropTarget = new DropTarget(scrolledComposite, DND.DROP_MOVE); scrolledCompositeDropTarget.setTransfer(new Transfer[] { FileTransfer.getInstance() }); imageViewDropTarget = new DropTarget(imageView, DND.DROP_MOVE); imageViewDropTarget.setTransfer(new Transfer[] { FileTransfer.getInstance() }); for (DropTargetAdapter adapter : dropTargetAdapters) { scrolledCompositeDropTarget.addDropListener(adapter); imageViewDropTarget.addDropListener(adapter); } scrolledComposite.setContent(imageView); scrolledComposite.setMinSize(imageView.desiredSize()); scrolledComposite.setBackground(shell.getDisplay().getSystemColor(SWT.COLOR_BLACK)); scrolledComposite.addControlListener(new ControlListener() { @Override public void controlResized(ControlEvent arg0) { updateImageViewSize(); } @Override public void controlMoved(ControlEvent arg0) { } }); return shell; } private void updateImageViewSize() { Point desired = imageView.desiredSize(); Point clientAreaSize = new Point(scrolledComposite.getClientArea().width, scrolledComposite.getClientArea().height); int width = Math.max(clientAreaSize.x, desired.x); int height = Math.max(clientAreaSize.y, desired.y); Point newSize = new Point(width, height); Point oldSize = imageView.getSize(); if (!oldSize.equals(newSize)) { imageView.setSize(newSize); } } @Override public void setDocument(ImageDocument document) { super.setDocument(document); imageView.setImage(getDocument().getImage()); scrolledComposite.setMinSize(imageView.desiredSize()); updateImageViewSize(); imageView.setVisible(true); getShell().forceActive(); } @Override public boolean supportsFullscreen() { return true; } @Override public boolean supportsMaximizing() { return true; } }</span></span></code> </pre></div></div><br>  First of all, you should pay attention to the fact that the class is inherited from the <code>ViewWindowBase</code> template, to which our document class is passed as a parameter.  That is, the window is associated with a document of this type.  Clearly shows the relationship between classes. <br><br>  The window tasks are extremely simple: show the loaded image (this is done in the overloaded <code>setDocument</code> function).  Then just please the user with his appearance, until he closes it.  In addition, as the <code>DropTarget</code> objects indicate to us, the window responds to the event of ‚Äúthrowing‚Äù a file of the specified type into it.  In the same window, the file will not open (it would be just not interesting), it will be loaded as a new document and a separate window will be created for it.  Note that this class is not responsible for opening new windows, so it brings the listener to the outside with the methods <code>addDropTargetListener</code> and <code>removeDropTargetListener</code> .  The use of these methods will be shown below. <br><br>  I will not focus your attention on a specific implementation, especially since it is far from perfect.  I can only say what the main redefined methods are for: <br><br>  <code>constructShell()</code> is called when creating a window to form a <code>Shell</code> object from SWT.  This object is our window.  Annotation <code>@wbp.parser.entryPoint</code> above method - an instruction for the visual painter of SWF windows in Eclipse to edit this particular method when modifying a window through its graphical representation in design-time.  So, theoretically, you will be able to draw a window and buttons with the mouse;) (although I myself prefer to write with code ‚Äî this is better).  This is where internal events are assigned.  About <code>setDocument()</code> I have already said.  And the <code>supportsFullscreen()</code> and <code>supportsMaximizing()</code> methods manage the corresponding features in Zetes.  For example, a window that returns <code>false</code> on <code>supportsFullscreen()</code> will not have a deployment button with arrows on OS X, and will also not create a menu item "Fullscreen" on any platform. <br><br><h4>  5.2.4.  ImageViewWindowsManager </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/f65/b17/d72/f65b17d72646b7a71b6672b1f2e7129c.png"><br>  This class deals with window management.  He creates and destroys them. <br><br><div class="spoiler">  <b class="spoiler_title">ImageViewWindowsManager.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> tinyviewer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.dnd.DropTargetAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.dnd.DropTargetEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.dnd.FileTransfer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.base.ViewWindowsManagerBase; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageViewWindowsManager</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewWindowsManagerBase</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageDocument</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageViewWindow</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropTargetAdapter viewWindowDropTargetAdapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DropTargetAdapter() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DropTargetEvent event)</span></span></span><span class="hljs-function"> </span></span>{ String fileList[] = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; FileTransfer ft = FileTransfer.getInstance(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ft.isSupportedType(event.currentDataType)) { fileList = (String[]) event.data; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; fileList.length; i++) { ImageDocument document; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { document = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImageDocument(fileList[i]); openWindowForDocument(document); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { e.printStackTrace(); } } } } }; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> ImageViewWindow </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createViewWindow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ImageViewWindow vw = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImageViewWindow(); vw.addDropTargetListener(viewWindowDropTargetAdapter); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vw; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DropTargetAdapter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getViewWindowDropTargetAdapter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> viewWindowDropTargetAdapter; } }</code> </pre></div></div><br>  It inherits from the <code>ViewWindowsManagerBase</code> generic class, which is associated with both the <code>ImageViewWindow</code> window class and the <code>ImageDocument</code> document <code>ImageDocument</code> . <br><br>  In our case, windows are managed in a completely standard way.  The only thing we added was the assignment of a listener for <code>DropTarget</code> in the picture window (remember, did we refer to this in the last section?).  Here we have defined the <code>createViewWindow()</code> factory <code>createViewWindow()</code> in such a way that when creating a new window, a Drag-n-drop handler is immediately attached to it. <br><br><h4>  5.2.5.  TinyViewerMenuConstructor </h4><br>  This class manages the main menu of the application.  All responsibility for the menu (both global in OS X, and window in other platforms) lies on it.  <em>Therefore, when using Zetes, direct management of menu classes via SWT is highly undesirable</em> .  Of course, here, alas, there is a leaky abstraction, but since it is impossible to completely encapsulate SWT for a number of obvious reasons, at least at this stage in the development of our library, we have to put up with it. <br><br><div class="spoiler">  <b class="spoiler_title">TinyViewerMenuConstructor.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> tinyviewer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.HotKey; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.base.MenuConstructorBase; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.actions.Action; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.actions.Handler; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TinyViewerMenuConstructor</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MenuConstructorBase</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageViewWindow</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Handler&lt;ImageViewWindow&gt; fileOpenHandler; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Action&lt;ImageViewWindow&gt; openAction; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TinyViewerMenuConstructor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ImageViewWindowsManager viewWindowsManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(viewWindowsManager); openAction = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Action&lt;&gt;(<span class="hljs-string"><span class="hljs-string">"&amp;Open"</span></span>); openAction.setHotKey(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HotKey(HotKey.MOD1, <span class="hljs-string"><span class="hljs-string">'O'</span></span>)); getFileActionCategory().addFirstItem(openAction); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Handler&lt;ImageViewWindow&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFileOpenHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fileOpenHandler; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setFileOpenHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Handler&lt;ImageViewWindow&gt; fileOpenHandler)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fileOpenHandler = fileOpenHandler; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (openAction.getHandlers().get(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { openAction.getHandlers().put(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, fileOpenHandler); } } }</code> </pre></div></div><br>  This class is associated only with the window and with the window manager (with the second through the constructor).  Since, in fact, the view in our ideology is the window itself, and the menu is only an auxiliary interface element, completely controlled by the active view, it is the view that must perform any manipulations on the data (that is, the document).  That is, if we need to add, say, the ‚ÄúCopy‚Äù command, then our window should have, for example, the <code>actionCopy</code> function, which the menu handler should call.  That is, once again: the <em>menu itself does nothing, it always asks for it either a window or a window manager (in our case, <code>ImageViewWindowsManager</code> )</em> . <br><br><div class="spoiler">  <b class="spoiler_title">Read more about the menu structure in ZetesWings</b> <div class="spoiler_text">  Here you need to say a few words about how the menus are organized in ZetesWings.  The main pillar is the <code>Action</code> class.  This class implements the menu item.  It consists of a title (‚Äútitle‚Äù), a hot key combination (‚ÄúhotKey‚Äù) and handlers (‚Äúhandlers‚Äù), the latter being assigned as <code>Map</code> , where the keys are <code>ViewWindow</code> .  The bottom line is simple.  When a window is created, it adds its handlers to those actions that interest it.  In addition, there is one handler that is not associated with any window (with the <code>null</code> key).  This handler is called when <em>there is no</em> active window (in OS X it is possible that there is a menu and no windows). <br><br>  The priority is this.  When the user selects a menu item, the handler for the window is first searched.  If not, then the global handler is searched. <br>  If there are no both handlers, then the menu item is simply hidden (for example, in a window that does not contain editing elements, the Copy command is meaningless, just as it is meaningless when there are no windows, unlike, say, Open).  In this case, the "handler" (that is, the object of the <code>Handler</code> class) is not just a listener.  It contains options such as <code>isEnabled()</code> , <code>isVisible()</code> , <code>isChecked()</code> .  In addition, it is able to overlap the action header with its own (for the case of a context-sensitive header).  In this case, it has its own <code>getTitle()</code> . <br></div></div><br>  When creating a <code>TinyViewerMenuConstructor</code> creates <code>Action</code> objects for the main menu.  In our case, there is only one non-standard element - ‚ÄúOpen‚Äù.  We create it and assign it a <code>HotKey(HotKey.MOD1, 'O')</code> hot key <code>HotKey(HotKey.MOD1, 'O')</code> .  <code>MOD1</code> is such a modifier, which under OS X corresponds to the Command key, and under other platforms, Control.  Users of both traditions know that most hotkeys with Ctrl in Windows are pressed in Cmd in OS X. <br><br><h4>  5.2.6.  TinyViewerApplication </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/fed/98b/95d/fed98b95d99994fc435ad8f0a7cf421a.png"><br>  The last (and main) in our hierarchy is the <code>TinyViewerApplication</code> application <code>TinyViewerApplication</code> .  It is associated with all the classes listed above.  Plus, it is associated with the heir of <code>AboutBox</code> (in our case, <code>DefaultAboutBox</code> ), which implements the ‚ÄúAbout Application‚Äù window. <br><br><div class="spoiler">  <b class="spoiler_title">TinyViewerApplication.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> tinyviewer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.SWT; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.graphics.Point; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.widgets.Display; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.widgets.FileDialog; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.swt.widgets.Shell; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.base.ApplicationBase; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.DefaultAboutBox; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> zetes.wings.actions.Handler; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TinyViewerApplication</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApplicationBase</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DefaultAboutBox</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageDocument</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageViewWindow</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TinyViewerMenuConstructor</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ImageViewWindowsManager</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Tiny Viewer"</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DefaultAboutBox </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAboutBox</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ImageViewWindow window)</span></span></span><span class="hljs-function"> </span></span>{ DefaultAboutBox res = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultAboutBox(window); res.setApplicationName(getTitle()); res.setIconResourceName(<span class="hljs-string"><span class="hljs-string">"/tinyviewer/wingphotos64.png"</span></span>); res.setDescriptionText(<span class="hljs-string"><span class="hljs-string">"A simple image file viewer.\nThis application shows the power of Avian + SWT"</span></span>); res.setCopyrightText(<span class="hljs-string"><span class="hljs-string">"Copyright \u00a9 2013, Ilya Mizus"</span></span>); res.setWindowSize(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point(<span class="hljs-number"><span class="hljs-number">370</span></span>, <span class="hljs-number"><span class="hljs-number">180</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ImageDocument </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadFromFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String fileName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImageDocument(fileName); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { e.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Handler&lt;ImageViewWindow&gt; fileOpenHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Handler&lt;ImageViewWindow&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ImageViewWindow window)</span></span></span><span class="hljs-function"> </span></span>{ Shell dummyShell = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Shell(Display.getDefault()); FileDialog fileDialog = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileDialog(dummyShell, SWT.OPEN | SWT.MULTI); fileDialog.setText(<span class="hljs-string"><span class="hljs-string">"Open image"</span></span>); fileDialog.setFilterNames(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[] { <span class="hljs-string"><span class="hljs-string">"Image (*.png; *.bmp; *.jpg; *.jpeg)"</span></span>, <span class="hljs-string"><span class="hljs-string">"All files"</span></span> }); fileDialog.setFilterExtensions(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[] { <span class="hljs-string"><span class="hljs-string">"*.png; *.bmp; *.jpg; *.jpeg"</span></span>, <span class="hljs-string"><span class="hljs-string">"*.*"</span></span> }); String firstFile = fileDialog.open(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (firstFile != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { String[] names = fileDialog.getFileNames(); ArrayList&lt;ImageDocument&gt; documents = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;ImageDocument&gt;(); <span class="hljs-comment"><span class="hljs-comment">// Creating documents for files for (int i = 0; i &lt; names.length; i++) { String fileName = fileDialog.getFilterPath() + "/" + names[i]; try { documents.add(new ImageDocument(fileName)); } catch (IOException e) { // TODO Show a message box here e.printStackTrace(); } } getViewWindowsManager().openWindowsForDocuments(documents.toArray(new ImageDocument[] {})); } dummyShell.dispose(); } }; public TinyViewerApplication() { } @Override public ImageViewWindowsManager createViewWindowsManager() { return new ImageViewWindowsManager(); } @Override public TinyViewerMenuConstructor createMenuConstructor(ImageViewWindowsManager viewWindowsManager) { TinyViewerMenuConstructor menuConstructor = new TinyViewerMenuConstructor(viewWindowsManager); menuConstructor.setFileOpenHandler(fileOpenHandler); return menuConstructor; } @Override public boolean needsAtLeastOneView() { return false; } public static void main(String... args) { new TinyViewerApplication().run(args); } }</span></span></code> </pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This class is responsible for loading documents. </font><font style="vertical-align: inherit;">In our application, it is this object </font></font><code>fileOpenHandler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that </font><font style="vertical-align: inherit;">contains the object </font><font style="vertical-align: inherit;">, which is the global handler of the ‚ÄúOpen‚Äù menu item. </font><font style="vertical-align: inherit;">In addition, it contains several factory methods for our ‚Äúglobal‚Äù objects (menu constructor, window manager and ‚Äúabout program‚Äù window). </font><font style="vertical-align: inherit;">It also announced an interesting method </font></font><code>needsAtLeastOneView()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which can be a little different.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Read more about needsAtLeastOneView ()</font></font></b> <div class="spoiler_text">  ,  Windows   Linux          .         ‚Äî   ,    ,  .  OS X   ‚Äî  ,     .     ‚Äî    .  ,        . <br><br>       ZetesWings.   <code>needsAtLeastOneView()</code>  <code>false</code> ,      OS X       . <br><br>    OS X  ,        /   (, ).       <code>needsAtLeastOneView()</code> ,  <code>true</code> .     ,  .  ,         OS X      ,      . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> At this point, our review of the source code of this project can be considered complete. </font></font><br><br><h3>  5.3.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Auxiliary files and resources </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are left with only some additional files, without which the project can not do. </font><font style="vertical-align: inherit;">These files - resource files - are located in 4 folders:</font></font><br><br><ol><li> <code>src/res</code> ‚Äî   <code>src/java</code> ‚Äî        Java     Java-.      3       SWT : <br><pre> <code class="java hljs">shell.setImages(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image[] { SWTResourceManager.getImage(ImageViewWindow.class, <span class="hljs-string"><span class="hljs-string">"/tinyviewer/wingphotos16.png"</span></span>), SWTResourceManager.getImage(ImageViewWindow.class, <span class="hljs-string"><span class="hljs-string">"/tinyviewer/wingphotos64.png"</span></span>), SWTResourceManager.getImage(ImageViewWindow.class, <span class="hljs-string"><span class="hljs-string">"/tinyviewer/wingphotos512.png"</span></span>) });</code> </pre> <br></li><li> <code>win-res</code> ‚Äî      ,      Windows EXE. ,  ,  <code>win.rc</code> <br><div class="spoiler"> <b class="spoiler_title">win.rc</b> <div class="spoiler_text"><pre> <code class="java hljs">MainIcon ICON <span class="hljs-string"><span class="hljs-string">"win-res/wingphotos.ico"</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> VERSIONINFO FILEVERSION <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> PRODUCTVERSION <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> BEGIN BLOCK <span class="hljs-string"><span class="hljs-string">"StringFileInfo"</span></span> BEGIN BLOCK <span class="hljs-string"><span class="hljs-string">"040904E4"</span></span> BEGIN VALUE <span class="hljs-string"><span class="hljs-string">"CompanyName"</span></span>, <span class="hljs-string"><span class="hljs-string">"bigfatbrowncat\0"</span></span> VALUE <span class="hljs-string"><span class="hljs-string">"FileDescription"</span></span>, <span class="hljs-string"><span class="hljs-string">"A tiny multi document photo viewer app"</span></span> VALUE <span class="hljs-string"><span class="hljs-string">"FileVersion"</span></span>, <span class="hljs-string"><span class="hljs-string">"0.1\0"</span></span> VALUE <span class="hljs-string"><span class="hljs-string">"InternalName"</span></span>, <span class="hljs-string"><span class="hljs-string">"TinyViewer\0"</span></span> VALUE <span class="hljs-string"><span class="hljs-string">"LegalCopyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"Ilya Mizus\0"</span></span> VALUE <span class="hljs-string"><span class="hljs-string">"OriginalFilename"</span></span>, <span class="hljs-string"><span class="hljs-string">"tinyviewer.exe\0"</span></span> VALUE <span class="hljs-string"><span class="hljs-string">"ProductName"</span></span>, <span class="hljs-string"><span class="hljs-string">"TinyViewer\0"</span></span> VALUE <span class="hljs-string"><span class="hljs-string">"ProductVersion"</span></span>, <span class="hljs-string"><span class="hljs-string">"0.1\0"</span></span> END END BLOCK <span class="hljs-string"><span class="hljs-string">"VarFileInfo"</span></span> BEGIN VALUE <span class="hljs-string"><span class="hljs-string">"Translation"</span></span>, <span class="hljs-number"><span class="hljs-number">0x409</span></span>, <span class="hljs-number"><span class="hljs-number">1251</span></span> END END</code> </pre></div></div><br></li><li> <code>osx-bundle</code> ‚Äî     .app,   OS X  ¬´application bundle¬ª          .       <a href="https://developer.apple.com/library/mac/documentation/corefoundation/conceptual/cfbundles/BundleTypes/BundleTypes.html">bundle</a> </li><li> <code>resources</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- files placed in this folder under all systems, except OS X, will be copied to the application folder. </font><font style="vertical-align: inherit;">Under OS X, they will be placed in the Resources folder located inside the bundle. </font><font style="vertical-align: inherit;">These files are available from the application as resources through the class </font></font><code>WinLinMacApi</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">In this project, this folder is missing, but it is present in other projects from among </font></font><a href="https://github.com/bigfatbrowncat/zetes-examples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zetes-examples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ol><br><br><h3>  5.4.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Build and Run </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This application can be compiled with both the Android classpath and the Avian classpath. </font><font style="vertical-align: inherit;">The assembly instructions are located in the same place as the source code, in the </font></font><a href="https://github.com/bigfatbrowncat/zetes-examples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zetes-examples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If someone has problems - ask questions, I will answer with pleasure.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6. Conclusion </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First of all, I want to sincerely thank all those who have had the patience (and who have enough interest) to finish reading this place. </font><font style="vertical-align: inherit;">I am very glad that this topic is interesting not only for me. </font><font style="vertical-align: inherit;">The more of you, the more I have of enthusiasm. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, I, of course, can not fail to note that, although this version of the framework is very stable and, probably, can even be used with some caution to create simple applications, much of it will be processed and changed. </font><font style="vertical-align: inherit;">I myself will try in the near future to create on its basis something more useful than a few example projects. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Any suggestions / advice / critical comments are accepted and will definitely be considered.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7. References </font></font></h2><br><ul><li> <a href="https://github.com/bigfatbrowncat/zetes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zetes library page on github</font></font></a> </li><li> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page with the collected release of zetes 0.1</font></font></a> </li><li> <a href="https://github.com/bigfatbrowncat/zetes-examples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zetes-examples demo projects page on GitHub</font></font></a> </li><li> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page with the collected release of zetes-examples 0.1</font></font></a> </li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally, I would like to thank once again my friend and colleague </font></font><a href="https://habrahabr.ru/users/justaman/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JustAMan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , without the help and moral support of which neither this work nor this article, I think, would never have been completed. </font><font style="vertical-align: inherit;">In addition, I want to say a huge thank you to my beloved wife, who not only allows me to do any nonsense at my computer in the evenings, but even checks my articles and puts commas correctly forgotten by me. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anyone who is not indifferent to this topic and who is interested in its development, please put asterisks to my githage projects </font></font><a href="https://github.com/bigfatbrowncat/zetes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zetes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><a href="https://github.com/bigfatbrowncat/zetes-examples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zetes-examples</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">so I can see the interest of the community. </font><font style="vertical-align: inherit;">Since the project is non-commercial and develops exclusively on my enthusiasm, I like vitally. </font><font style="vertical-align: inherit;">Of course, if anyone has a desire to make a contribution to the code, I will be glad!</font></font><br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/225187/">https://habr.com/ru/post/225187/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225173/index.html">Designing the physical infrastructure of the data center - from science to art</a></li>
<li><a href="../225175/index.html">New invariant number. The study of the natural number series (NPS)</a></li>
<li><a href="../225177/index.html">Rule number N + 0: do not be afraid to dig deeper</a></li>
<li><a href="../225179/index.html">Speech recognition in Asterisk using the Yandex SpeechKit HTTP API</a></li>
<li><a href="../225183/index.html">Non-obvious features of the storage</a></li>
<li><a href="../225189/index.html">Multimodule Java-project with Gradle. Step by step</a></li>
<li><a href="../225191/index.html">Chinese Internet: a brief overview of near-social services</a></li>
<li><a href="../225193/index.html">The history of joint trips in Russia and abroad</a></li>
<li><a href="../225195/index.html">Crucial MX100: 256GB SSD for 110 dollars</a></li>
<li><a href="../225197/index.html">Google has released a 64-bit version of Chrome for Windows</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>