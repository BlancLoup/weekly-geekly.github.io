<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Qt and SQLite and in general, DB programming in Qt</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. 

 Below is a discussion of how to use SQLite in Qt . The author tried as much as possible to consider programming databases in Qt. 

 You c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Qt and SQLite and in general, DB programming in Qt</h1><div class="post__text post__text-html js-mediator-article">  Good day. <br><br>  Below is a discussion of how to use <a href="http://ru.wikipedia.org/wiki/Sqlite">SQLite</a> in <a href="http://ru.wikipedia.org/wiki/Qt">Qt</a> .  The author tried as much as possible to consider programming databases in Qt. <br><br>  You can read about these two great products by following the links above, and we will specifically consider programming DB in Qt, in particular, using the example of SQLite.  I can only say that SQLite is somewhat different from ‚Äúordinary‚Äù databases, such as MySQL, in that it does not have a client-server architecture.  That is, the database engine is not a separate working process with which the program interacts.  SQLite is the library with which your program is built and, thus, the engine becomes an integral part of the program.  That is, imagine you decided to save all the data with which your program ‚Äúcollides‚Äù into a regular file.  One day you decide to save the data in a file, but by organizing it from a "relational" point of view.  After that, you realized that the new file structure should be "recognized in a special way."  From this, at a minimum, it follows that you need to provide some API that provides a link between this data file and the application.  In general, following the logical formulation of the above scenario, you have a database system that does not require a database server and the client itself.  It turns out quite fast compared to the "client-server" database system, and the program itself is simplified. <br><a name="habracut"></a><br>  I am on friendly terms with Qt and I recently needed its database functionality.  With MySQL, I am also on quite friendly terms and tried to use Qt with MySQL in a program I was developing at that time.  Having a lack of time and nerves to ‚Äúlink‚Äù MySQL with Qt, I decided to use SQLite, for which Qt has, so to speak, built-in support, that is, there was no need to install / configure anything new (this does not apply to the case if your Qt compiled with the support of "read" modules, without connecting the module QtSql).  And yet, if I have to install the program in another computer, I will not ‚Äúhave to‚Äù install MySQL server, etc.  (controversial topic - I know). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Fiy </h4><br>  At the moment I use the <a href="http://www.sqlabs.net/sqlitemanager.php">SQLiteManager</a> program to create databases, tables, etc., I use it recently, but I immediately liked the program.  In my ‚Äúworkhorse‚Äù, the (a?) <a href="http://qt.nokia.com/downloads/sdk-windows-cpp">Qt Windows SDK</a> is installed and I use QtCreator, I‚Äôll say straight away - just shine ( <i>not IMHO, really an excellent IDE</i> ). <br><br><h4>  And so, Qt and databases </h4><br>  As already implicitly mentioned above, Qt has a separate module that provides a convenient "service" of using the database - <b>QtSql</b> .  If you have experience with Qt, then you know about the .pro file, if not, please <a href="http://doc.qt.nokia.com/latest/qmake-project-files.html">get acquainted</a> .  Just remember to add the following line to the .pro file: <br><pre><code class="cpp hljs">QT += sql</code> </pre> <br>  This is to use the QtSql module, and to work with its classes, you need to include the title of the same name. <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;QtSql&gt;</span></span></span></span></code> </pre><br>  The Qt books talk about three levels of the QtSql module: <br><ol><li>  Driver level </li><li>  Program level </li><li>  User interface level </li></ol><h5>  Driver level </h5><br>  The driver level includes classes for obtaining data at the physical level, such as: <br><ul><li>  QSqlDriver </li><li>  QSqlDriverCreator &lt;T *&gt; </li><li>  QSqlDriverCreatorBase, </li><li>  QSqlDriverPlugin </li><li>  QSqlResult </li></ul>  <i>QSqlDriver</i> is an abstract base class designed to access specific databases.  It is important that the class should not be used "directly", you need / you can use <i>QSqlDatabase</i> instead.  Although, if you want to create your own SQL driver, you can inherit from <i>QSqlDriver</i> and implement purely virtual, and virtual functions you need. <br>  <i>QSqlDriverCreator</i> is a template class that provides <a href="http://ru.wikipedia.org/wiki/Factory">a</a> SQL driver <a href="http://ru.wikipedia.org/wiki/Factory">factory</a> for a specific driver type.  The template parameter must be a subclass of <i>QSqlDriver</i> . <br>  <i>QSqlCreatorBase</i> is the base class for the SQL driver factories; to return an instance of a specific class of the QSqlDriver class that you want to provide, you need to "rephrase" the <i>createObject ()</i> method. <br>  QSqlDatabase is responsible for loading and managing database driver plugins.  When a database is added (this is done by the <i>QSqlDatabase :: addDatabase ()</i> function), the necessary driver plugin is loaded (using <i>QSqlDriverPlugin</i> ).  QSqlDriverPlugin provides an abstract base class for custom <i>QSqlDriver</i> plug-ins. <br>  <i>QSqlResult</i> itself speaks about itself (like all Qt-shny classes), this class provides an abstract interface for accessing data from specific databases.  From a practical point of view, we will use <i>QSqlQuery</i> instead of <i>QSqlResult</i> , since <i>QSqlQuery</i> provides a wrapper (‚Äúgeneric‚Äù) for the database-specific implementation of <i>QSqlResult</i> . <br>  So, since the level of drivers, as it turned out, is important to use when creating your own driver, then I give an example of code (for the most interested), which can be used as a frame for the driver: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XyzResult</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> QSqlResult { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: XyzResult(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QSqlDriver *driver) : QSqlResult(driver) {} ~XyzResult() {} <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: <span class="hljs-function"><span class="hljs-function">QVariant </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* index */</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QVariant(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isNull</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* index */</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> QString &amp; </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* query */</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* index */</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchFirst</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetchLast</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">numRowsAffected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-function"><span class="hljs-function">QSqlRecord </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">record</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QSqlRecord(); } }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">XyzDriver</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> QSqlDriver { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: XyzDriver() {} ~XyzDriver() {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasFeature</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DriverFeature </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* feature */</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">open</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> QString &amp; </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* db */</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> QString &amp; </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* user */</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> QString &amp; </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* password */</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> QString &amp; </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* host */</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* port */</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> QString &amp; </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* options */</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-function">QSqlResult *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createResult</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XyzResult(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } };</code> </pre><br><br><h5>  Program level </h5><br>  To connect to the database, first of all you need to activate the driver using the static method <i>QSqlDatabase :: addDatabase ()</i> .  The method receives a string as an argument that identifies the <a href="http://doc.qt.nokia.com/stable/sql-driver.html">identifier of the database driver</a> .  We need "QSQLITE". <br><br><pre> <code class="cpp hljs">QSqlDatabase sdb = QSqlDatabase::addDatabase(<span class="hljs-string"><span class="hljs-string">"QSQLITE"</span></span>); sdb.setDatabaseName(<span class="hljs-string"><span class="hljs-string">"db_name.sqlite"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!sdb.open()) { <span class="hljs-comment"><span class="hljs-comment">//.... }</span></span></code> </pre><br>  The static function addDatabase has an overloaded ‚Äúbrother‚Äù that receives not the driver name, but the driver itself ( <i>QSqlDriver</i> *). <br>  Connection is carried out by the open () method.  The <i>QSqlDatabase</i> class represents a database connection.  The connection provides access to the database through a supported database driver.  It is important that you can have multiple connections to the same database. <br>  If an error occurred during the connection (the <i>open ()</i> method <i>)</i> , you can get information about the error through the <i>QSqlDatabase :: lastError ()</i> method (returns <i>QSqlError</i> ). <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!sdb.open()) { qDebug() &lt;&lt; sdb.lastError().text(); }</code> </pre><br>  Consider how Qt allows you to execute SQL commands.  To do this, you can use the <i>QSqlQuery</i> class.  The class can be used not only to execute <a href="http://ru.wikipedia.org/wiki/Data_Manipulation_Language">DML (Data Manipulation Language)</a> expressions, such as <b>SELECT</b> , <b>INSERT</b> , <b>UPDATE</b> and <b>DELETE</b> , but also <a href="http://ru.wikipedia.org/wiki/DDL">DDL (Data Definition Language)</a> expressions, such as <b>CREATE TABLE</b> .  Note that a DB-specific command that is not an SQL standard can also be executed (for example, for PSQL - ‚ÄúSET DATESTYLE = ISO‚Äù). <br>  Successfully executed queries set the state of the request to ‚Äúactive‚Äù, so <i>isActive () will</i> return <i>true</i> , otherwise, the state is set to inactive.  Requests are executed in the form of a regular string, which is passed to the constructor or to the <i>QSqlQuery :: exec ()</i> method.  In the first case, when passed to the constructor, the command will be launched automatically (when the object is constructed). <br>  What is very interesting is the navigation feature provided by <i>QSqlQuery</i> .  For example, after a <i>SELECT</i> query, you can navigate through the collected data using the <i>next (), previous (), first (), last (),</i> and <i>seek ()</i> methods. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">QSqlQuery </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">query</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"SELECT country FROM artist"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (query.next()) { QString country = query.value(<span class="hljs-number"><span class="hljs-number">0</span></span>).toString(); do_something(country); }</code> </pre><br>  The <i>next ()</i> method allows moving to the next data line, and calling <i>previous ()</i> on the previous line, respectively.  <i>first (), last ()</i> extract, respectively, the first record from the result.  <i>seek ()</i> takes an integer index, extracting the record from the result by the received index and ‚Äúpositions the query‚Äù on the retrieved record.  You can check the size, or rather the number of rows of data (result) using the <i>size ()</i> method.  It is important to remember that the first record is at position 0, the query must be in the active state, and <i>isSelect</i> () returns <i>true</i> (this happens if the last query was a <i>SELECT</i> ) before calling the seek () method.  I advise you to read more about the <i>seek</i> () method <a href="http://doc.qt.nokia.com/latest/qsqlquery.html">in the official documentation</a> . <br>  As mentioned above, if you pass a query string to the constructor of the <i>QSqlQuery</i> class, the query will be executed when the object is created ‚Äî during construction.  Using the <i>exec</i> () method, you can, so to speak, track the execution time of queries.  Design <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">QSqlQuery </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">query</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"SELECT country FROM artist"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>;</code> </pre>  can also be represented as: <br><pre> <code class="cpp hljs">QSqlQuery query; query.exec(<span class="hljs-string"><span class="hljs-string">"SELECT country FROM artist"</span></span>);</code> </pre>  So, <i>exec</i> () receives a request in the form of a <i>QString</i> .  When the query is executed, in case of success, this method returns true and sets the state to the active, in the opposite case, all ‚Äúopposite‚Äù to the specified operations.  Of course, it should also be remembered that the query string must obey the syntactic rules of the requested database (in particular, the SQL standard). <br>  What is interesting, so after execution, the request is positioned on the invalid (th?) Record, that is, to adequately use the results, you must use, say, the <i>next</i> () method. <br>  The <i>exec</i> () method has an overloaded alternative that takes no arguments.  Calling this option <i>exec</i> () executes the previously prepared request.  Please note - "prepared."  To do this, use the <i>prepare</i> () method, which returns <i>true</i> if the request is successfully prepared. <br>  The importance or, one may say, the uniqueness of the method is that the request may contain ‚Äúplaceholders‚Äù for binding to values ‚Äã‚Äãusing <i>bindValue</i> (). <br><pre> <code class="cpp hljs">QSqlQuery my_query; my_query.prepare(<span class="hljs-string"><span class="hljs-string">"INSERT INTO my_table (number, address, age)"</span></span> <span class="hljs-string"><span class="hljs-string">"VALUES (:number, :address, :age);"</span></span>); my_query.bindValue(<span class="hljs-string"><span class="hljs-string">":number"</span></span>, <span class="hljs-string"><span class="hljs-string">"14"</span></span>); my_query.bindValue(<span class="hljs-string"><span class="hljs-string">":address"</span></span>, <span class="hljs-string"><span class="hljs-string">"hello world str."</span></span>); my_query.bindValue(<span class="hljs-string"><span class="hljs-string">":age"</span></span>, <span class="hljs-string"><span class="hljs-string">"37"</span></span>);</code> </pre><br>  You can also use the option of anonymous parameters: <br><br><pre> <code class="cpp hljs">QSqlQuery my_query; my_query.prepare(<span class="hljs-string"><span class="hljs-string">"INSERT INTO my_table (number, address, age)"</span></span> <span class="hljs-string"><span class="hljs-string">"VALUES (?, ?, ?);"</span></span>); my_query.bindValue(<span class="hljs-string"><span class="hljs-string">"14"</span></span>); my_query.bindValue(<span class="hljs-string"><span class="hljs-string">"hello world str."</span></span>); my_query.bindValue(<span class="hljs-string"><span class="hljs-string">"37"</span></span>);</code> </pre><br>  Finally, you can simply use the inline arguments that QString provides: <br><br><pre> <code class="cpp hljs">QSqlQuery my_query; my_query.prepare( QString(<span class="hljs-string"><span class="hljs-string">"INSERT INTO my_table (number, address, age) VALUES (%1, '%2', %3);"</span></span>) .arg(<span class="hljs-string"><span class="hljs-string">"14"</span></span>).arg(<span class="hljs-string"><span class="hljs-string">"hello world str."</span></span>).arg(<span class="hljs-string"><span class="hljs-string">"37"</span></span>) );</code> </pre><br>  Copy-paste-to-your-ide example: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;QtGui/QApplication&gt; #include &lt;QtSql&gt; int main(int argc, char *argv[]) { QCoreApplication app(argc, argv); QSqlDatabase dbase = QSqlDatabase::addDatabase("QSQLITE"); dbase.setDatabaseName("my_db.sqlite"); if (!dbase.open()) { qDebug() &lt;&lt; "-   !"; return -1; } QSqlQuery a_query; // DDL query QString str = "CREATE TABLE my_table (" "number integer PRIMARY KEY NOT NULL, " "address VARCHAR(255), " "age integer" ");"; bool b = a_query.exec(str); if (!b) { qDebug() &lt;&lt; "    ,  !"; } // DML QString str_insert = "INSERT INTO my_table(number, address, age) " "VALUES (%1, '%2', %3);"; str = str_insert.arg("14") .arg("hello world str.") .arg("37"); b = a_query.exec(str); if (!b) { qDebug() &lt;&lt; "   ,  ,   ?"; } //..... if (!a_query.exec("SELECT * FROM my_table")) { qDebug() &lt;&lt; "   ,  ."; return -2; } QSqlRecord rec = a_query.record(); int number = 0, age = 0; QString address = ""; while (a_query.next()) { number = a_query.value(rec.indexOf("number")).toInt(); age = a_query.value(rec.indexOf("age")).toInt(); address = a_query.value(rec.indexOf("address")).toString(); qDebug() &lt;&lt; "number is " &lt;&lt; number &lt;&lt; ". age is " &lt;&lt; age &lt;&lt; ". address" &lt;&lt; address; } return app.exec(); }</span></span></span></span></code> </pre><br>  To get the result of the query, call the <i>QSqlQuery :: value ()</i> method in which the column number should be passed, for which the example used the <i>record</i> () method.  This method returns an object of class <i>QSqlRecord</i> , which contains information related to the <i>SELECT</i> query.  Using the <i>QSqlRecord :: indexOf ()</i> call, we get the column index. <br>  The <i>value ()</i> method returns values ‚Äã‚Äãof type <i>QVariant</i> (a class whose objects can contain values ‚Äã‚Äãof different types), so you converted the resulting value using the methods <i>QVariant :: toInt ()</i> and <i>QVariant :: toString ()</i> . <br><br><h5>  User interface level </h5><br>  The <i>QtSql</i> module supports the ‚ÄúInterview‚Äù concept by providing a number of models for use in views.  To thoroughly get acquainted with this concept - take a <a href="http://doc.qt.nokia.com/latest/model-view-programming.html">look here</a> . <br>  As an example, the <i>QSqlTableModel</i> class allows you to display data in tabular and hierarchical form.  As stated in the literature, the interview is the easiest way to display the data in the table; here you will not need a cycle to go through the rows of the table.  Here is a tiny example: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;QtGui/QApplication&gt; #include &lt;QtSql&gt; #include &lt;QTableView&gt; int main(int argc, char *argv[]) { QCoreApplication app(argc, argv); QSqlDatabase dbase = QSqlDatabase::addDatabase("QSQLITE"); dbase.setDatabaseName("my_db.sqlite"); if (!dbase.open()) { qDebug() &lt;&lt; "-    !"; return -1; } QTableView view; QSqlTableModel model; model.setTable("my_table"); model.select(); model.setEditStrategy(QSqlTableModel::OnFieldChange); view.setModel(&amp;model); view.show(); return app.exec(); }</span></span></span></span></code> </pre><br>  Once connected, a <i>QTableView</i> table view object and a <i>QSqlTableModel</i> table model object are created.  The <i>setTable</i> () method sets the current database in the model, and the <i>select</i> () call fills it with data. <br>  The <i>QSqlTableModel</i> class provides the following editing strategies (settable with <i>setEditStrategy</i> ()): <br><ul><li>  <b>OnRowChange</b> - writes data as soon as the user moves to another row in the table. </li><li>  <b>OnFieldChange</b> - makes a record after the user moves to another cell in the table. </li><li>  <b>OnManualSubmit</b> - records data on the call to the <i>submitAll</i> () slot.  If the <i>revertAll</i> () slot is <i>called</i> , the data is returned to its original state. </li></ul><br>  <i>I think the post came up to the epilogue, and I just left hoping that someone would find what he was looking for, and someone would need the information ‚Äúfor later‚Äù.</i> </div><p>Source: <a href="https://habr.com/ru/post/128836/">https://habr.com/ru/post/128836/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128827/index.html">Pattern Observer: lists and matryoshka from listeners</a></li>
<li><a href="../128829/index.html">Google Voice is tested in Europe</a></li>
<li><a href="../128832/index.html">Foursquare reaches 1 billion check-ins</a></li>
<li><a href="../128833/index.html">Hackers have cracked SSL encryption used by millions of sites</a></li>
<li><a href="../128835/index.html">Hyperlinks in ExtJS 2.x / 3.x. To help the young fighter</a></li>
<li><a href="../128840/index.html">Fitting room on the basis of augmented reality VIPodium</a></li>
<li><a href="../128841/index.html">Diablo 3 beta test launched</a></li>
<li><a href="../128843/index.html">HTC Rhyme: stylish and elegant</a></li>
<li><a href="../128844/index.html">We write the simplest service to steal an Android communicator</a></li>
<li><a href="../128846/index.html">Developing Mobile Applications with Adobe Flash + AIR: Feature Overview</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>