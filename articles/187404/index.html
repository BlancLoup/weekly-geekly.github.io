<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The art of understanding with a half-word. Query expansion in Yandex</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will talk about the mechanism that allows Yandex search to find exactly what the user had in mind, no matter how briefly and carelessly he fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The art of understanding with a half-word. Query expansion in Yandex</h1><div class="post__text post__text-html js-mediator-article">  Today we will talk about the mechanism that allows Yandex search to find exactly what the user had in mind, no matter how briefly and carelessly he formulated his query. <br><br>  In the search world, such a mechanism is called <b>a search query extension</b> .  The term is quite broad, includes reformulations, synonyms, transliteration, and even cognates (the latter are sometimes mistakenly called morphology support). <br><br>  What parts does this mechanism consist of?  What helps him to guess?  And why on each of his rare mistakes there are thousands of requests, on which he greatly helped? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="http://habrahabr.ru/company/yandex/blog/187404/"><img src="https://habrastorage.org/getpro/habr/post_images/2e5/5c8/91c/2e55c891c465bf95398f3837f084ac62.jpg" alt="image"><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif"></a> <br>  <i>Why not just take and expand the query.</i> <br><a name="habracut"></a><br>  Using primitive search implementations in a small online store or on a local forum, it is often necessary to reformulate the initial query manually - to replace words with synonyms, to vary cases, tenses of verbs, and so on. <br><br>  Noticing this many years ago, search engine developers decided that it is possible to greatly simplify the life of the user, if you immediately, automatically, search not only for a given query, but also for its various variations and reformulations.  Now no one is surprised by the exact search results in the hands of the user, not experienced in the <a href="http://help.yandex.ru/search/%3Fid%3D1111313">intricacies of the search query</a> - however, the struggle to save time and increase freedom in formulating a query continues. <br><br>  Today we consider only the query expansion mechanisms, that is, the addition of the original query in other words.  <a href="http://yandex.ru/yandsearch%3Ftext%3D%25D0%25B1%25D1%2580%25D0%25B8%25D1%2587%25D0%25BC%25D1%2583%25D0%25BB%25D0%25B0%2520%25D1%2582%25D0%25B5%25D0%25BA%25D1%2581%25D1%2582%2520%25D0%25BF%25D0%25B5%25D1%2581%25D0%25BD%25D0%25B8%26lr%3D213">We</a> will try to tell you about ways to change the query (correcting typos <a href="">in the word "classmates"</a> and the inflection of <a href="http://yandex.ru/yandsearch%3Ftext%3D%25D0%25B1%25D1%2580%25D0%25B8%25D1%2587%25D0%25BC%25D1%2583%25D0%25BB%25D0%25B0%2520%25D1%2582%25D0%25B5%25D0%25BA%25D1%2581%25D1%2582%2520%25D0%25BF%25D0%25B5%25D1%2581%25D0%25BD%25D0%25B8%26lr%3D213">Bric-Mulla, Bric-Mulloy</a> ). <br><br>  We divide extensions into several types, each of which has parallels in linguistics, but also differs in its own way from its prototype: <br><br><h4>  Abbreviations (Russian Federation → Russian Federation) </h4><br>  Expanding abbreviations is perhaps the most deceptive type of extensions - it seems at first glance accurate and unambiguous (“obviously”, “MSU” is “Moscow State University”), but it quickly turns out that there are “Mordovian” and “Mariupol”, and "International Humanitarian", and others. <br><br>  We distinguish between several types of abbreviations: <br><ul><li>  Acronyms ("MSU", "OSAGO") - consist of the first letters of the words that form them.  Acronyms, especially 2-3 letter letters, have the most options for decoding.  The greater the ambiguity of the acronym, the less weight we give it when ranking. </li><li>  Composite ("matmeh", "agricultural") - are parts of words, usually roots.  Sometimes the roots are connected by an additional letter (as " <u>benzo</u> about <u>saw</u> " = " <u>benz and</u> new <u>saw</u> ") </li><li>  Punctuation ("city", "second-hand", "district") - when the punctuation mark is included in the abbreviation. </li><li>  The separation of prefixes, each of which is reduced to the initial letter: “auto-”, “motorcycle”, “all-”, “heat-”.  For example, this is how “thermal power plants” = " <u>t</u> heat electric <u>center</u> " </li></ul><br><div class="spoiler">  <b class="spoiler_title">How to consider regionality;</b>  <b class="spoiler_title">how to cut off false hypotheses</b> <div class="spoiler_text">  In addition to the ambiguity, in this kind of extensions, the consideration of regionality is interesting, because in each region the abbreviation may have its own decoding.  Users from “Mordovia” who have their own “MSU” ( <a href="http://www.mrsu.ru/">named after Ogarev</a> ) are interested in its Moscow namesake no less than residents of other regions of Russia.  But regional data may not be enough, you have to find a balance between a local object and its more famous counterpart from another region - so that it is easy to find one and the other. <br><br>  When collecting options for extensions, there are quite a few false hypotheses that we struggle with with different heuristics: <br><ul><li>  "Photo" = " <u>photo</u> b oma" (when abbreviated, all the words of the phrase should be reduced to parts of approximately the same length) </li><li>  “ <u>good</u> and <u>give</u> ” = “ <u>good</u> about <u>give</u> ”, “mother” = “ <u>mother</u> and <u>any</u> ” (one vowel cannot disappear, at least a whole syllable) </li><li>  "Chemical technology of natural energy sources" = "htn" (the first letter of the word with a separable prefix, "e", must also be present in the abbreviation) </li><li>  "Burned out" = " <u>with</u> Korea, all the time it is no longer under the monte" (many omissions, the first letters are outside the abbreviation) </li><li>  “Naza” = “importunate” (the abbreviation of one word is not translated into such a long word) </li></ul></div></div><br><br><h4>  Transliteration (Peugeot → Peugeot) </h4><br>  Unlike abbreviations, the intuition turns out to be right: transliteration accounts for several tens of percent of all the benefits of extensions.  She has good accuracy and fullness;  It helps well in any context. <br><br>  Users do not like to switch the keyboard layout, and when searching for a foreign surname or locality, it is easier to type them in Russian (“Demonzho” instead of “Demongeot” and “Cologne” instead of “Cologne”) than to remember the correct spelling in the original.  The opposite situation is also frequent: residents of Russian-speaking diasporas abroad are more accustomed to chatting in forums in Russian, but with the use of transliteration.  Search for such forums is also needed for Cyrillic queries.  Transliteration comes in handy and when the query word is contained in the address of the found site. <br><br>  In practice, we need not even transliteration, but the so-called <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B0%25D0%25BA%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D1%2582%25D1%2580%25D0%25B0%25D0%25BD%25D1%2581%25D0%25BA%25D1%2580%25D0%25B8%25D0%25BF%25D1%2586%25D0%25B8%25D1%258F">practical transcription</a> is the most close transmission of the original sound by means of another language.  Otherwise, for example, French words will be distorted beyond recognition. <br><br><div class="spoiler">  <b class="spoiler_title">Realization: by letters, by syllables, by chains (segments) of vowels-consonants</b> <div class="spoiler_text"><h5>  Implementation options </h5><br><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif">  We confine ourselves to a superficial review, leaving the nuances for an independent post.  The most famous and easiest way is transliteration using <b>letter-</b> by- <b>letter rules</b> .  There are <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D1%2580%25D0%25B0%25D0%25BD%25D1%2581%25D0%25BB%25D0%25B8%25D1%2582%25D0%25B5%25D1%2580%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F_%25D1%2580%25D1%2583%25D1%2581%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25B0%25D0%25BB%25D1%2584%25D0%25B0%25D0%25B2%25D0%25B8%25D1%2582%25D0%25B0_%25D0%25BB%25D0%25B0%25D1%2582%25D0%25B8%25D0%25BD%25D0%25B8%25D1%2586%25D0%25B5%25D0%25B9">several standards for the translation</a> between Latin and Cyrillic, most are one-to-one (completely or for almost all letters).  Unfortunately, this method gives a very poor quality for the names - even Renault and Pegueot will never become Renault and Peugeot. <br><br>  A more advanced way is <b>by syllables</b> .  The translation of each syllable, regardless of context, works fairly accurately.  But there are difficulties: <br><ol><li>  Each language has its own rules for dividing into syllables, and their implementation with sufficiently high accuracy is non-trivial. </li><li>  The same syllables are also pronounced differently in different languages, therefore for each language it is necessary to thoroughly describe the rules. </li><li>  For these reasons, it is especially important to accurately determine the language. </li></ol><br><h5>  Segment method </h5><br>  We have chosen the third path, the <b>partitioning</b> method.  A segment is a group of consecutive vowels / consonants.  We need to find a large number of examples of pairs of words, when we reliably know that one is a transcription of the other.  And by these examples, using machine learning, build rules for converting some segments into others. <br><br>  Here is how it works.  For each pair of the training sample, the words are divided into segments.  For each example of correct transcription between the segments of the original word and its transcription, a correspondence is established - it turns out that in almost all cases the number of segments in the Russian and foreign words is equal. <br><img src="https://habrastorage.org/getpro/habr/post_images/638/d8b/a00/638d8ba00d88ad82711e6177deb2adc7.png" alt="image"><br><br>  Further, the transcription segments with the corresponding segments of the original enter the training sample: both by themselves and with the surrounding context (neighboring segments).  As a result, machine learning determines the probabilities of different transcription variants of each segment: <br><img src="https://habrastorage.org/getpro/habr/post_images/f46/f64/474/f46f644743bd0b6b25fc13cfdbc0a55a.png" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">About segment ambiguity</b> <div class="spoiler_text"><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif">  There are a couple of tricks, because of which the segments may not be one-to-one.  The first is simple: some words begin with unpronounceable consonants, like “L'Humanite”&gt; “L'Humanite”.  Such segments are converted to empty.  The second is more complicated: in the middle of the word there are “quick” vowels (as in “stat <u>e</u> ment” the highlighted “e” is not read) or consonants (as in the “guillaume” above).  Aligning to segments with fluent letters with the help <a href="http://ru.wikipedia.org/wiki/%25D0%25E0%25F1%25F1%25F2%25EE%25FF%25ED%25E8%25E5_%25CB%25E5%25E2%25E5%25ED%25F8%25F2%25E5%25E9%25ED%25E0">of Lowenstein's algorithm</a> helps: first we establish letter-by-letter correspondence, and then we glue adjacent letters into segments, taking into account the differences in word splitting in another language. <br><img src="https://habrastorage.org/getpro/habr/post_images/601/ae8/653/601ae8653363ac8a9c841f4e3b53e283.png" alt="image"><br><br>  From this example, it is clear that the “d” is more correctly considered a vowel.  We consider consonants “”, “”, hyphen and apostrophe - because they break the sound. <br></div></div><br><h5>  About quality </h5><br>  In our experience, the segment method gives the best accuracy.  It works well for all common languages ​​- including such as complex as Chinese and Vietnamese (of course, in their letter writing).  And even allows with acceptable accuracy to restore from the Russian writing in the original language.  The method does not require the definition of the language of the word. <br><br>  On test collections of names, surnames, place names, popular brands and names of musical groups, the method shows accuracy up to 99%.  If, however, we evaluate the accuracy of the entire set of hypotheses that are expanded according to real queries and the search index, it falls as we increase the dictionary with less and less accurate hypotheses.  Now users have access to about 3 million extensions based on transliteration, their accuracy is about 90%. <br></div></div><br><br><h4>  Spelling options (ike <u>i</u> → ike <u>a</u> ) </h4><br>  Orfarifariate are words that have identical meaning, but they can be written this way and that, and both spellings are considered literate. <br><br>  Firstly, these are <b>foreign words</b> that are recorded by the ear and often do not have a single canonical spelling (“ike <u>i</u> ” / “ike <u>a</u> ”; “ <u>interpret</u> n” / “sense <u>and</u> n”). <br><div class="spoiler">  <b class="spoiler_title">35 ways to write Scarlett Johansson</b> <div class="spoiler_text">  "Scarlett Johansson" <br>  Scarlett Johanson <br>  Scarlett Johansson <br>  "Scarlett Johansson" <br>  "Scarlett Johansson" <br>  "Scarlett Johanson" <br>  "Scarlett Johonson" <br>  "Scarlett Johanson" <br>  "Scarlett Johannson" <br>  Scarelt Johansson <br>  "Scarlett Johansson" <br>  "Scarlett Yohhanson" <br>  "Scarlett Johansen" <br>  Scarlett Yohansson <br>  "Scarlett Johannson" <br>  "Scarlett Johansan" <br>  "Scarlett Johanson" <br>  Scarlett Johanson <br>  Scartlett Johansson <br>  Scarlett Johansson <br>  "Scarlett Johasson" <br>  "Scarlett Johansen" <br>  "Scarlet Oahsen" <br>  "Scarlet Öhsensen" <br>  "Scarlett Johanson" <br>  "Scarlett Yohansan" <br>  "Scarlett Johansson" <br>  "Scarlett Johansson" <br>  Scarlet Johansson <br>  "Scarlet Yohnson" <br>  "Scarlet Ehanson" <br>  Scarlet Ohansan <br>  Scarlett Johansson <br>  Scarlett Johanson <br>  Scarlett Johansson <br></div></div><br>  Unlike transliteration, here we are dealing with pairs in the same language.  A few words that with the help of transcription can lead to one Latin spelling are called orthophants. <br><br>  Secondly, <b>Russian words that admit different spellings</b> (“ <u>bild</u> rd” → “bill <u>iard</u> rd”, “birthday <u>and</u> i” → “birthday <u>i</u> ”) <br><br>  What is interesting orfovariant? <br><div class="spoiler">  <b class="spoiler_title">It is necessary to distinguish them from typos and padonkaffsky slang.</b>  <b class="spoiler_title">And there is also an outdated spelling.</b> <div class="spoiler_text"><ol><li>  It is necessary to clearly separate them with typos: <br><ul><li>  for typos, the user is used to seeing the explicit message: “A typo was corrected in the request” and be able to switch to the search for the original request.  For orfovariant such a warning would be inappropriate, because  all possible spellings are valid. </li><li>  when we are sure that the user is sealed, we simply replace the request with the correct one.  For orfovariant can not do so, we will lose most of the useful documents with a different spelling ("birth" instead of "birth").  But to expand other spellings will be correct.  Unlike typos - there are illiterate documents can upset the user who asked the request without errors. </li></ul><br></li><li>  It is important to be able to distinguish orthophyrians from Internet slang ( <a href="http://ru.wikipedia.org/wiki/%25C6%25E0%25F0%25E3%25EE%25ED_%25EF%25E0%25E4%25EE%25ED%25EA%25EE%25E2">“padonkaffsky / olbansky yezig”</a> ) and memes (“kotegi”; “kote”).  Slang and common spellings cannot be extended with each other: <br><ul><li>  when requested with a meme, documents with commonly used spelling cannot be shown, they will interfere with the meme interested; </li><li>  and vice versa, if you add his analogue memes to the commonly used spelling, it will worsen the issue on requests for “universal” topics. </li></ul></li></ol><br>  Fortunately, the slang has a rather specific context of use, it helps to distinguish it from orphars. <br><br>  The third type stands out by itself - an <b>outdated spelling</b> : “great-power”, “pious” (for example, “king”).  Thanks to the extensions, there are both original Old Russian texts with a parallel translation into the modern language, and the translations themselves without the original - the latter is easier for the unprepared reader to print and read. <br></div></div><br><br><h4>  Word Formation (Moscow-Moscow) </h4><br>  The types of extensions described above (abbreviations, transliteration, inflection, or hyphenation) tried to reflect the exact words of the query in all possible ways, considering the meaning to be inviolable.  But it quickly became clear that it was necessary to more boldly allow semantic additions to the original request.  Thus, the extensions were supplemented by word formation (“Moscow subway” → “Moscow <u>subway</u> station”) and synonyms (“hippo” → “hippo”). <br><br>  The idea of ​​expanding on the principle of <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BB%25D0%25BE%25D0%25B2%25D0%25BE%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">word formation</a> is to add cognate words to the query, including even other parts of speech (“Moscow metro” → “Moscow Metro”). <br><br>  The mechanism of word formation is often called simply morphology, although this is not quite true: in addition to the word <i>education</i> , morphology also includes the word <i>change</i> (the very same “Bric-Mulloy”).  The word change rarely adds new semantic shades to the request, it usually looks for the original word of the request in all forms (as they say, “the whole <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B0%25D1%2580%25D0%25B0%25D0%25B4%25D0%25B8%25D0%25B3%25D0%25BC%25D0%25B0_(%25D0%25BB%25D0%25B8%25D0%25BD%25D0%25B3%25D0%25B2%25D0%25B8%25D1%2581%25D1%2582%25D0%25B8%25D0%25BA%25D0%25B0)">paradigm</a> ”), so in this post we will not touch it. <br><br>  Word-formation, on the contrary, may add semantically distant variants — contrary to general considerations, words with one root need not be close in meaning.  Only a small number of types of word formation is in practice a good search engine extensions, so you need to be careful. <br><br><div class="spoiler">  <b class="spoiler_title">A few examples</b> <div class="spoiler_text"><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif">  Among the useful types are &lt;noun&gt; → &lt;single-root adjective&gt;, for example, “Moscow” → “Moscow”: “mayor of Moscow” → “Moscow mayor”.  But even here there are subtleties, primarily related to named entities: <br><ul><li>  Names of organizations: [Moscow Department Store] ≠ [Moscow Department Store], these are two different stores in Moscow, both very well-known </li><li>  surnames of people: an official who works in the government may have the surname “Moscow” - and this will affect the query [Moscow government] </li><li>  geographical names: in Moscow there is a city "Moscow" - for him the query [Moscow mayor] means not the same as [mayor of Moscow] </li></ul><br>  Couples &lt;noun&gt; → &lt;name of the figure&gt; (“bicycle” → “cyclist”) - strongly lead away from the meaning of the initial request.  If &lt;noun&gt; → &lt;adjective&gt; “bicycle” → “cycling” is useful (for example, [buying a bicycle] → [bicycle shop]), then “cycling” → “cyclist” will make the search worse, because on request [buying a bicycle] extradition will be added, for example, documents about the "landing of the cyclist", about the "injuries of the cyclist", etc. <br><ul><li>  [drawing class]: good to expand with the word “draw”, but bad “draftsman” </li><li>  [deputy commander for rear]: good "rear", bad "rear man" </li><li>  [order floss in Ukraine]: good "order", bad "customer" </li></ul><br>  Similarly, there are a lot of bad examples for the change of gender.  Take the “worker” → “worker”: if the request [agreement with the worker] gives a wide class of documents about any items of agreement, expanding it with the word “worker”, undesirable documents get into the issue, for example, about the regulatory framework for going on maternity leave (which in general, about any employee, most likely, will not help). <br><br>  Thus, the similarity of words in form is often deceptive, and from the point of view of search, the content varies greatly even with the most seemingly innocent transformations. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">In other languages, everything is different</b> <div class="spoiler_text">  It is curious that the Russian language is far from always the most difficult from the point of view of word formation.  For example, in Turkish, single-root words with a formally different meaning are simply part of one vocabulary paradigm: <br><ul><li>  "Yüz" - one hundred, "yüzde" - percent, </li><li>  “Top” - a ball / core, “topçu” - a footballer / gunner. </li></ul><br>  And if in Russian we can safely use all the forms of the word for which we prepared the extension, then in Turkish we have to calculate contextual proximity not between different words, but between the forms of the same word.  And limit the use of distant forms of the same word to prevent distortion of meaning. <br></div></div><br><h4>  Synonyms (mobile → cellular) </h4><br>  Is it possible to base academic synonyms from traditional dictionaries, and just load them into the search?  Indeed, in the dictionaries collected extensive rows of reliable synonyms. <br><div class="spoiler">  <b class="spoiler_title">It turns out that the search language is completely different from the standard written language.</b> <div class="spoiler_text"><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif">  Often dictionaries give exact synonyms, but supply them with stylistic mark: <i>arch.</i>  <i>rass</i>  , <i>scientific</i>  the <i>poet</i>  And some words, even being modern and, formally, commonly used, are used in written language only in some senses or genres: <br><ul><li>  "Magician" → "sorcerer": the second is used mainly in folklore texts, and only in a negative way </li><li>  “Entrance” → “front door”: the second one is not used in official addresses;  limits the range of documents to the Petersburg region - by origin or place of action. </li><li>  "Doctor" → "doctor": the second is used primarily for the profile of education, but not to denote the profession or type of service </li><li>  "Trainer" → "tamer": the second deals only with dangerous animals <br>  As a result, a person will receive documents with a pronounced stylistics (archaic / scientific / dialectal ...) than he wanted - which will not always be useful in solving his problems. </li></ul></div></div><br>  Therefore, we have gone from a purely vocabulary, linguistic understanding of synonyms, the statistical search for equivalents works much better.  Any options are collected that may not be synonymous in an academic sense, but help to find what the user is looking for.  This is the main criterion of quality - the usefulness of extensions for ranking (and not their dictionary affinity by meaning). <br><br>  But collections of statistically collected synonyms in the traditional sense (as words with identical meaning) are few.  For narrowly specific queries, on which there is very little information on the Internet, it is useful to replace some words of the query with more general concepts ( <a href="http://ru.wikipedia.org/wiki/%25D0%2593%25D0%25B8%25D0%25BF%25D0%25B5%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BC">“hyper-names”</a> ). <br><br><div class="spoiler">  <b class="spoiler_title">An example of a common replacement;</b>  <b class="spoiler_title">why it is impossible to replace the general with the private</b> <div class="spoiler_text"><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif">  For example, the query [conjunctivitis in miniature schnauzers]: the word "miniature schnauzer" has a very precise synonym for "miniature", but adding it will not greatly improve the output.  But if you add his generalization as an extension, [conjunctivitis in dogs], there are many useful things, because the care and treatment procedures are similar for different breeds of dogs. <br><br>  And in the opposite direction, from the general to the particular, to expand is risky.  By requesting [clothes for children], different users are looking for stores for different ages, so it would be more correct to show the most versatile sites covering the whole possible range of different situations of the user.  If we try to expand the request with more specific concepts of “schoolchild” or “infant”, this may complicate the user to solve his problem. <br></div></div><br><br><h4>  How to build extension options </h4><br>  In the next section, the most interesting is how extensions are used in the search, but first let's look at how we prepare extension hypotheses. <br><br>  From the above, it is easy to guess that the options for possible extensions for our needs can be built only through the analysis of real data that exists “in the wild” on the Internet.  It is necessary to respond to a user's request quickly, so we prepare such options (the so-called "extension dictionary") in advance — and at the time of the search, we simply select all the pairs for the query words from the ready dictionary. <br><br><h5>  Collecting hypotheses </h5><br><div class="spoiler">  <b class="spoiler_title">To compile a dictionary, we use a number of sources:</b> <div class="spoiler_text"><ul><li><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif">  brackets in documents: “Scarlett Johansson (Scarlett Johansson)” </li><li>  the occurrence of both words in the same contexts ( <a href="http://ru.wikipedia.org/wiki/N-%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC">N-grams</a> - chains of N consecutive words: "... theater tickets": "price" → "cost") - separately in the texts, separately in the queries.  It is sometimes called “interchangeability statistics”. </li><li>  reference - when several links leading to the same page are called differently: “bike shop → bicycle shop” </li><li>  parallel texts (marked up with machine alignment) <br>  Our <a href="http://translate.yandex.ru/">machine translation service is</a> trained in so-called <a href="http://ru.wikipedia.org/wiki/%25C1%25E8%25F2%25E5%25EA%25F1%25F2">parallel texts</a> - “text and its translation” pairs, between which the correspondence of sentences, phrases, and words meaning the same is marked by statistical methods.  We consider such a transition of one word to another as a good hypothesis for expanding a query. </li><li>  user statistics - how often the user tries to reformulate the query using this replacement, and documents with which synonyms to the query word prefers </li><li>  traditional synonym dictionaries, other dictionary sources </li><li>  Wikipedia: For what term is <a href="http://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B8%25D0%25BA%25D0%25B8%25D0%25BF%25D0%25B5%25D0%25B4%25D0%25B8%25D1%258F:%25D0%259F%25D0%25B5%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B0%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F">redirection</a> to another term? </li></ul></div></div><br>  For the Russian language, this gives about 150 million pairs of extension hypotheses. <br><br><h5>  Frequency filtering </h5><br>  Couples that are found too rarely both in queries and in texts on the Internet are not a very reliable source, therefore, after collecting hypotheses, we limit them by frequency of occurrence. <br><br>  It makes little sense to somehow take into account the form (case, declension) in which the word came together with one or another couple (at least for the Russian language).  Therefore, we leave the only form of the word (as a rule, the initial one). <br><br>  As a result, this usually results in about 100 million pairs. <br><br><h5>  Selection of the most likely extensions </h5><br>  But 100 million raw hypotheses are ore, which cannot simply be given to the request processing stage. <br><div class="spoiler">  <b class="spoiler_title">There is no point in helping high-frequency queries;</b>  <b class="spoiler_title">it is necessary to exclude distant substitutions</b> <div class="spoiler_text"><ol><li><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif">  We select extensions that are most helpful to the user.  The value of extensions directly depends on the frequency of the request.  For high-frequency queries we have a lot of different data, and adding even a large number of extensions practically does not change the ranking.  And in the case of rare requests or those formulated with an error, the contribution of extensions to improving the issue is very noticeable - we are trying to expand them first of all. </li><li>  Even for non-frequency requests, you need to balance the quality and speed of response to a request.  Ideally, you need to expand any request with the widest possible cloud of extensions - and the ranking stage will choose exactly what really improves the issue relevance.  In practice, the size of the cloud has to be limited for the sake of speed of response - by removing options that are far in meaning from the original. </li></ol><br>  Like so much more in this topic, the degree of closeness is calculated by machine learning. <br><br>  On the one hand, for each hypothesis of extension (A, B) we calculate about 60 factors, which somehow correlate with the fact that the hypothesis is a useful extension.  Among these factors is contextual proximity, built on N-grams;  user selection of the same documents for different requests;  Levenshtein distance (for example, for orfovariant). <br><br>  On the other hand, special experts ( <a href="http://ru.wikipedia.org/w/index.php%3Ftitle%3D%25D0%2590%25D1%2581%25D0%25B5%25D1%2581%25D1%2581%25D0%25BE%25D1%2580%26stable%3D0">assessors</a> ) prepare a training sample of characteristic examples “which word B is a good extension of the word A, and which pairs cannot be considered synonymous." <br><br>  Preparing a training set is a difficult task, the quality of the final dictionary directly depends on its solution.  Even experienced assessors often differ in evaluating extensions.  Assessors have to think not only about the closeness of words in terms of language, but also to predict how a particular pair will affect the usefulness of issuing requests in the whole segment. </div></div><br>  As a result of this selection, we get 10 million extensions - and this “dictionary” is used in processing requests.  This is discussed in the next section. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0bb/66e/2d7/0bb66e2d76ad4cb73c0e20078de383d8.png" alt="image"><br><br><h4>  How extensions are involved in the search </h4><br>  When we receive a search query from a user, we select extensions from the dictionary that are suitable for the context. <br><br>  For example, [mgu] has expanded in [mgu ^ mgu ^ msu ^ "Moscow State University"]. <br><br>  And already by the advanced query, the search finds documents with different variants of the wording, including the original (“exact form”).  A number of factors are involved in document ranking, taking into account both the original word and the extensions.  Other things being equal, the coincidence of the exact form (“MGU”) takes precedence over the occurrence of an extension (even full writing, like the “Moscow State University”) - although other factors may turn out to be stronger than an exact match. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/837/c68/91f/837c6891fdd0d6e163d2d8c0df80a76a.png" alt="image"><br><br>  We try to highlight in the <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BD%25D0%25B8%25D0%25BF%25D0%25BF%25D0%25B5%25D1%2582">snippet</a> not only the words of the request, but all the synonyms used, which helps the user to understand why he sees a particular document. <br><br>  How to determine which extensions are relevant for a given request, and which are not;  what exactly, in what cases and in what volume to add?  The more types of extensions, the harder it is to build an algorithm for mixing them.         ,       —    .   ,          :     ,          .           ,         20%      .     « ». <br><div class="spoiler"> <b class="spoiler_title">      </b> <div class="spoiler_text"><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif"> ,      <a href="http://www.osp.ru/os/2013/02/13034553/"></a>    ,      ()   ,          . <br><br>  ,     : <br><ul><li>       ; </li><li>    ; </li><li>  ; </li><li>   (   ) —   ; </li><li>          (.. Mutual Information) —     . </li></ul><br>      ,         ,   .   -     ,   -   «» . <br></div></div><br>       ,     ,  27% ,      . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/989/82d/765/98982d765d57725b7b0e2bfa80107426.png" alt="image"><br><br>     ,      : <br><div class="spoiler"> <b class="spoiler_title"> ; ;  </b> <div class="spoiler_text"><ul><li><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif">  proper names: <br> [ ] → [ ] (  « » = « ») <br> [  ] (  « » = « ») </li><li>  .       : <br> [    ] → «, , »; «»; «»; «, , , ,  » <br> [    ] → «, , »; «»; «», «» </li><li>     —       : <br> [ <i></i> ] <br> [ <i></i> ] <br>      ,      ,      (« » → « »). </li><li>  ,   ( <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D0%25BC%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25BC%25D0%25B8%25D1%258F"></a> )  . ,    : <br> [    ]: «» → «» <br> [   ]: «» → «» <br> [    ]: «» → «» <br> [    ]: «» → «» <br> [  ]: «» → «» <br> [ ]: «» → «» (., «») <br> [     ]: «» → «» <br> [   ]: «» → «» (  [] —   «   ») </li></ul><br>    «  »     —       . </div></div><br><h5>     </h5><br>   ,        ,    .           ,    ,      .       ,     . <br><br>   ,              ,     .    <i></i>  <i></i>     :            ,    . <br><br><h5>     </h5><br>     .      ,  «»  «», «Google»  «», «»  «Facebook»    .    <a href="http://wordstat.yandex.ru/%3Fcmd%3Dwords%26page%3D1%26t%3D%25D0%25B1%25D0%25B8%25D0%25BB%25D0%25B0%25D0%25B9%25D0%25BD%26geo%3D%26text_geo%3D"></a> ,    <a href="http://wordstat.yandex.ru/%3Fcmd%3Dwords%26page%3D1%26t%3D%25D0%25BC%25D1%2582%25D1%2581%26geo%3D%26text_geo%3D"></a>    : «», « », «», «», «».          (,    ..),     —       . <br><br>  ,     «» → «»       ,   .          ,    .  For example: <br><img src="https://habrastorage.org/getpro/habr/post_images/069/3f8/4c5/0693f84c516d279a5e7532ac12d4b9b0.png" alt="image"><br> <i>(       —       )</i> <br><br> ,     ,      :      ,     . <br><div class="spoiler"> <b class="spoiler_title">       </b> <div class="spoiler_text">        ,        (, - «» → «»   «» → «   »),     .       ,    ,       .               :           ,     ,       . <br></div></div><br><br><h5>    </h5><br>       ,    .      ,      ,      ?       . ,   [' ]    [ ],       . <br><br><br><h4>      </h4><br>    —     :             ;     ,     . <br><br>  ,        :   .     , -    ,     . <br><br>   —    .     ,       ,     . <br><br>       —    .        ,      . , «war <u>k</u> raft» —   ( «War <u>c</u> raft»),  -          —     ( [ ])  «» → «war <u>k</u> raft»   ,      . <br><br>     ,     «», «»  «»,        . <br><div class="spoiler"> <b class="spoiler_title">        ,    </b> <div class="spoiler_text">     ,       ,                .  ,    -   ,      ́   ,    ,     .             ,             . <br></div></div><br><div class="spoiler"> <b class="spoiler_title">       </b> <div class="spoiler_text"><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif">             ,                (    ).        <a href="http://romip.ru/romip2009/15_yandex.pdf">pfound</a> .   ,    ,  ,       ,  .        ,    —    ,    .     ,       — ,     .            : <br><img src="https://habrastorage.org/getpro/habr/post_images/386/482/d07/386482d0785694ddab4cc87e9fe460b6.png" alt="image"><br> : pRel —  i-  ( ,       ). pLook —   i-   . </div></div><br>  ,       ,      .          —    .  ,    ,             .           30%     ,   15%  —   . <img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif"><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif"><br><br><h4>  Literature </h4><br><ol><li>  , <a href="http://www.slideshare.net/Tatiana.lando/query-expansion">    </a> . , 2010 (). </li><li> Voorhees, <a href="http://www.iro.umontreal.ca/~nie/IFT6255/voorhees-94.pdf">Query Expansion using Lexical-Semantic Relations</a> —         TREC     WordNet. </li><li> Jones et al. <a href="http://classes.soe.ucsc.edu/ism293/Spring09/material/papers/lec5/jones-www2006-generating-query-subs.pdf">Generating Query Suggestions</a> —   Yahoo!        . </li><li> Dang, Xue, Croft. <a href="http://maroo.cs.umass.edu/pub/web/getpdf.php%3Fid%3D882">Context-based Quasi-Synonym Extraction</a> —      N- (, <a href="http://storage.googleapis.com/books/ngrams/books/datasetsv2.html"></a> ). </li><li> Dang, Croft. <a href="http://ciir-publications.cs.umass.edu/getpdf.php%3Fid%3D900">Query Reformulation Using Anchor Text</a> —           Microsoft Research. </li><li>  R.S. , .. .       . .,  , 1985 —   . </li></ol></div><p>Source: <a href="https://habr.com/ru/post/187404/">https://habr.com/ru/post/187404/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../187394/index.html">Unity3D and MySQL</a></li>
<li><a href="../187396/index.html">Authentication via social networks for JavaServer Faces (JSF)</a></li>
<li><a href="../187398/index.html">Some recommendations on the organization of autonumbering when writing scientific articles and dissertations using Microsoft Word</a></li>
<li><a href="../187400/index.html">How to take over the world, or javascript next now (part one)</a></li>
<li><a href="../187402/index.html">DarkJPEG: steganography for all</a></li>
<li><a href="../187406/index.html">Full-screen, scalable div, respecting the proportions of width, height and text</a></li>
<li><a href="../187408/index.html">Security Specialist talked about hacking Apple Developer Center</a></li>
<li><a href="../187410/index.html">My vision of a smart home</a></li>
<li><a href="../187412/index.html">Cloud Storage Integration</a></li>
<li><a href="../187416/index.html">Programmer Rule # 1: Leave your emotions at home!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>