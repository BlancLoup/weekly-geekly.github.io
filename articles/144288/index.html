<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Noise reduction as a diffusion task</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Habr. 

 Recently, it just so happened that I read a lecture in my old lyceum on the topic of why they study mathematics and what can then be d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Noise reduction as a diffusion task</h1><div class="post__text post__text-html js-mediator-article">  Hello, Habr. <br><br>  Recently, it just so happened that I read a lecture in my old lyceum on the topic of why they study mathematics and what can then be done with it a little more applied.  For schoolchildren of the 10th grade, it turned out to be a bit complicated, perhaps.  I hope this topic will be interesting to someone from the community (here the option is a bit more complicated than what I read in the lyceum, but I do not think this is a problem). <br><br>  So.  It will be about image processing, in particular, about one of the simplest, but descriptively beautiful, method of suppressing noise in an image. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Not so long ago, I discovered for myself how much physics is in image processing.  I was very interested in this, in view of the fact that these two branches of science in my head never crossed.  In this article I will present how to remove noise from an image by solving the problem of mass transfer on a plane. <br><a name="habracut"></a><br><h4>  Image view </h4><br>  First, we specify what we will consider the image.  For ease of description, we will now consider only b / w images. <br>  We will represent them as a saturation matrix. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5cd/da4/a33/5cdda4a3311a4e4eff9d191c77145319.png" alt="image"><br><br>  Thus, each pixel of the image corresponds to an element of the matrix.  The values ‚Äã‚Äãin the matrix are <code>float</code> numbers from the interval <code>[0,255]</code> . <br><br>  Take some image and add noise to it (this is easier than looking for an image already with noise, since you can check how well the algorithm copes with noise by setting different noise intensity).  We get something like this: <br><br><img src="https://lh4.googleusercontent.com/-9xePNAgV8cs/T7TULtblDOI/AAAAAAAAGsw/LPFMm36VXQQ/s500/feed_fingers_noise.png"><br><br><h4>  Image as a function </h4><br>  To further explain the method, I need to enter some notation: <br>  First, we will further consider our image as a function of pixel coordinates.  So, if we want to say that a pixel with <code></code> and <code></code> coordinates is white, then we can write it as <code>I(x,y)==255</code> <br><br>  Further, if we have a function, then we can take a derivative from it and then it will be useful to us.  Since we have a discrete function, that is, it is defined in the cells, with a fixed step between them, we can write it as (since the function is two-dimensional, then the derivatives, respectively, are two): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f92/d92/edc/f92d92edc4b4e4b5b25c938a48aea450.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b6/1c9/991/9b61c999137692e2a86633a7d6080a6f.png" alt="image"><br><br>  Here <code>k==1</code> because the difference between adjacent pixels = 1 pixel. <br><br>  Thus, the derivatives will also be matrices of the same size as the original image: <br><br><img title="x-derivative" width="45%" src="https://habrastorage.org/getpro/habr/post_images/87e/4e7/025/87e4e7025e52269bb18560ee31f33160.png"><br><img title="coordinate derivative" width="45%" src="https://habrastorage.org/getpro/habr/post_images/726/b2c/ecb/726b2cecb42dc72164f5d5f2aa01744c.png"><br><br>  Having derivatives in both coordinates it is logical to calculate the gradient: <br><img src="https://habrastorage.org/getpro/habr/post_images/fa8/018/361/fa80183619771de15e6466a4fe1fe642.jpg" alt="image"><br><br>  And its value: <br><img src="https://habrastorage.org/getpro/habr/post_images/8b2/e38/724/8b2e387249a7e595c1eb15379ffdff7d.jpg" alt="image"><br><br>  The magnitude of the gradient can be displayed as an image: <br><img width="50%" src="https://habrastorage.org/getpro/habr/post_images/e3b/9e1/279/e3b9e12792fa8f57300d094b3fc28ccf.png"><br><br>  Now, carefully look at the magnitude of the gradient.  It has great value where we store the information we need. <br>  To rid the image of noise, it is logical to blur it.  However, when blurring lost important details.  That is, we would like to limit the blur in areas where the gradient is large enough.  There was only a question how to do it. <br><br><h4>  Connection to the diffusion process </h4><br>  This is where the wonderful physical process of diffusion comes to our aid.  Imagine the image matrix as an indicator of the presence of mass in one or another point of the plane.  The diffusion process consists in the fact that the mass ‚Äúspreads‚Äù from the points with its large concentration to the points with small.  In the process of diffusion there is the concept of flow, which obeys the so-called Fick's law: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f68/563/3ee/f685633ee79a1c2833c085cfc3227611.jpg" alt="image"><br><br>  Where <code>D</code> is the diffusion tensor, which specifies the direction and magnitude of the diffusion. <br><br>  We also write the law of conservation of mass, which says that the difference between the incoming and outgoing flows is equal to the change in mass at the point: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fdb/ccc/01b/fdbccc01be26ca1bf793725c662edb2f.jpg" alt="image"><br><br>  If the flow is not limited, that is, <code>D==1</code> - the mass will spread in all directions evenly, that is, we will get the equivalent of Gaussian blur, which means we will lose important image details.  We are interested in the method by which the flow can be limited. <br>  One of the simplest methods is to limit the magnitude of the flow, without limiting its direction.  About him and we will continue. <br><br>  Let us introduce into consideration some decreasing function, to the input of which we will supply the magnitude of the gradient.  This function at this stage will be a diffusion tensor: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/96b/9ce/6e3/96b9ce6e39bcdde321113c1f3225d39c.jpg" alt="image"><br><br>  Then the mass conservation equation takes the form: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/55c/2dd/3ff/55c2dd3ff5308bd5cf9dd8824fc9305b.jpg" alt="image"><br><br>  Next, we write out all the formulas (I‚Äôll, perhaps, omit this step) and write the final equation with which you can find the solution to the problem: <br><br><img width="90%" src="https://habrastorage.org/getpro/habr/post_images/a0c/ddc/492/a0cddc4920b1b66658565692d421f7c6.png"><br><br>  Thus, we have obtained an iteration scheme that is stable for the parameter values ‚Äã‚Äãof <code>tau&lt;=0.25</code> .  It is rather slow, since the method is basic and the more successful algorithms are based on it. <br><br><h4>  Result </h4><br>  In the end, we get an image that has retained almost all the important details and lost almost all the noise. <br><br>  <u>UPD:</u> I sincerely apologize, the images were mixed up.  Replaced the image that was previously that is obtained as a result of image processing with as much noise as presented in the article.  Once again, I apologize. <br><br><img width="45%" src="https://lh5.googleusercontent.com/-57tT5XpgUZs/T7u6RHadyiI/AAAAAAAAG3Q/9oszqm9-GUc/s500/test.jpg"><br><br>  For comparison - the original and the version with noise (once again): <br><img width="45%" src="https://lh5.googleusercontent.com/-c05J0nOM-nc/T7TV0xgR3hI/AAAAAAAAGs4/VPEmZXbyv5A/s500/feed_fingers.png"><br><img width="45%" src="https://lh4.googleusercontent.com/-9xePNAgV8cs/T7TULtblDOI/AAAAAAAAGsw/LPFMm36VXQQ/s500/feed_fingers_noise.png"><br><br>  Literature: <br><ul><li>  P. Perona, J. Malik: Scale-space and edge detection using anisotropic diffusion.  IEEE <br>  Transactions on Pattern Analysis and Machine Intelligence 12 (7): 629-639, 1990. </li><li>  J. Weickert: Anisotropic Diffusion in Image Processing.  Teubner, Stuttgart, 1998. The book is <br>  not available anymore, but it is the PhD of Joachim Weickert, <br>  book, is available on his website. </li><li>  T. Brox: Lectures on Computer Vision.  Freiburg im Breisgau, 2011 </li></ul><br><br>  PS If you find inaccuracies - I will be glad to hear criticism and suggestions. </div><p>Source: <a href="https://habr.com/ru/post/144288/">https://habr.com/ru/post/144288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../144280/index.html">Augmented Reality is Easy</a></li>
<li><a href="../144281/index.html">A look into the future</a></li>
<li><a href="../144282/index.html">Secure authentication between client and server without entering username and password</a></li>
<li><a href="../144284/index.html">Clodo Cloud Load Balancers</a></li>
<li><a href="../144285/index.html">Improvement suggestion: translations</a></li>
<li><a href="../144289/index.html">Antitrust investigation against google</a></li>
<li><a href="../144290/index.html">Diskless iSCSI boot</a></li>
<li><a href="../144291/index.html">Adaptive layout: CSS & JS framework Skeleton</a></li>
<li><a href="../144292/index.html">The standard for wireless communications on the human body</a></li>
<li><a href="../144293/index.html">SIPML5 - SIP client for a browser based on WebRTC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>