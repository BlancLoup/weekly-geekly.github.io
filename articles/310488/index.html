<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Do Tango robots dance</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Project Tango from Google - a project to create mobile devices that can analyze the space around them in three dimensions. Thanks to the Device Lab pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Do Tango robots dance</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://get.google.com/tango">Project Tango</a> from Google - a project to create mobile devices that can analyze the space around them in three dimensions.  Thanks to the <a href="https://special.habrahabr.ru/google/lab/">Device Lab</a> project, I was able to play around with one of these devices. <br><br><img src="https://habrastorage.org/files/af5/8f8/ada/af58f8ada4d042709e9c7e7606f131ea.jpg"><br>  <i>Article author Sergei Melekhin, in the framework of the competition " <a href="http://special.habrahabr.ru/google/lab">Device Lab from Google</a> ."</i> <br><a name="habracut"></a><br>  It seemed to me interesting to make a robot that will use Tango for orientation in space and to avoid collisions with obstacles. <br><br><h2>  Three basic functions of Tango </h2><br>  <b>Motion tracking</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The definition of the change in position of the device in space <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/410/cca/03c/410cca03cedc71ddfecb7354103946f4.gif"></div><br>  All modern smartphones have an accelerometer and a gyroscope, which allow you to determine the change in the position of the device, but they are not extremely accurate and determine the absolute position of the device with their help is <a href="https://en.wikipedia.org/wiki/Inertial_navigation_system">problematic</a> . <br><br>  <b>Depth perception</b> <br>  Due to the presence of special sensors - an infrared camera and an infrared laser projecting a two-dimensional grid onto the space in front of the device, Tango can receive a cloud of points, that is, a three-dimensional image of the space in front of the device. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/09f/b51/f36/09fb51f36b22a5d9b14b2d4d1fa53547.gif"><br><br>  <b>Area learning</b> <br>  By combining motion tracking, depth perception and adding black algorithmic magic that unites the point cloud in real time in the manner of a panorama, we can build a complete model of the surrounding space in the device‚Äôs memory and then accurately determine its position within this model. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ae5/9e2/e7c/ae59e2e7c3d1387158921c66846b4d1b.gif"></div><br><h2>  Main applications </h2><br><ul><li>  Augmented reality (virtual objects really ‚Äústick‚Äù to real surfaces, not hover over them or sink inside, as happens without Tango) <br></li><li>  Accurate indoor navigation <br></li><li>  Games <br></li><li>  Room mapping <br></li><li>  Creation of 3D models (still rather rough, but still) <br></li></ul><br>  In fact, the best way to understand what Tango can without a device is to look at existing applications in the <a href="https://play.google.com/store/apps/collection/promotion_3001310_project_tango_featured">Play Market</a> : <br><br><img src="https://habrastorage.org/files/7ce/cd6/2fa/7cecd62fab06465c9542c4e0846a89b5.png"><br><br><img src="https://habrastorage.org/files/9a7/9fc/169/9a79fc169c4643d4a80f6e395731ec86.png"><br><br><h2>  Tangobot </h2><br>  On Monday, I received a long-awaited device.  Of course, it was discharged to zero.  I charged up to 100% and turned on. <br><br><img src="https://habrastorage.org/files/05c/413/935/05c413935e96407ab11683172b99a609.png"><br><br>  At first I tried everything that was already installed on the device, then I downloaded everything in the Play Market in a row.  The greatest enthusiasm caused Tango Constructor, allows you to scan the surrounding space and save the textured 3D model. <br><br>  But it was enough and played - I have only 3 days to make a robot and teach it to navigate in space. <br><br>  First of all - the documentation.  At <a href="https://developers.google.com/tango/">https://developers.google.com/tango/</a> there is everything you need to start developing for Tango as soon as possible.  I started by learning the standard examples <a href="https://github.com/googlesamples/tango-examples-java">here</a> . <br><br>  For my project, I decided not to go into Area Learning, but simply to analyze Point Cloud in real time.  Of course, the first option would be much more interesting, but I was afraid not to meet the deadline. <br><br>  For the ‚Äúcarcass‚Äù of the robot, I took the Arduino Mega with a Motor Shield and two motors.  I programmed Arduino so that it listens and executes commands that come in via a serial port (which is emulated on USB).  Platform cut out of 3mm plywood by laser, in itself - fascinating. <br><br><img src="https://habrastorage.org/files/e2d/0d0/4d8/e2d0d04d86224914827b18ea0705870e.png"><br><br>  Sketch for arduinka can be taken <a href="http://goo.gl/1B5A9g">here</a> .  The device itself Tango carries on board Android 4.4, so the control program will be an Android application.  To communicate with the Arduino, I used the <a href="https://github.com/mik3y/usb-serial-for-android">usb-serial-for-andoid library</a> . <br><br>  The protocol of communication with Arduino chose the simplest - only 5 single-byte commands: <br><br><ul><li>  F - go forward <br></li><li>  B - go back <br></li><li>  L - turn left <br></li><li>  R - turn to the right <br></li><li>  S - stop <br></li></ul><br>  In the Tango configuration, I ask that I need a point cloud "KEY_BOOLEAN_DEPTH": <br><br><pre><code class="hljs pgsql">private TangoConfig setupTangoConfig(Tango tango) { // <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> a <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Tango <span class="hljs-keyword"><span class="hljs-keyword">Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> the Depth Sensing API. TangoConfig config = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> TangoConfig(); config = tango.getConfig(config.CONFIG_TYPE_DEFAULT); config.putBoolean(TangoConfig.KEY_BOOLEAN_DEPTH, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> config; }</code> </pre> <br>  Tango returns a point cloud map as a one-dimensional floating-point array.  The first in a row (and in index - zero) array element is the x coordinate of the first point, the second is at the first point, the third is the z coordinate of the first point.  The fourth element is the x coordinate already for the second point.  Well, and so on. <br><br>  I am not strong in robotics and geometry, so the algorithm for analyzing the depth map has sucked from my finger.  Hmm, well, that is, derived empirically. <br><br>  To the obstacle, I attribute points that fall into the parabolic region in front of the device, given by a quadratic formula: <br><br><img src="https://habrastorage.org/files/fa0/e6f/e30/fa0e6fe30d044823840aa1309d7766b2.png"><br><br>  The coefficients are chosen so that the parabola is stretched deep into and wide (along y), slightly shifted down (10 cm). <br><br>  And at the same time, these points should be closer than 50 cm. If there are at least five of these points, and we see two ‚Äúframes‚Äù in a row (trying to avoid false positives), then we turn the robot to the left. A simple algorithm, but it works decently for spaces not much complex configuration (for example in the office). <br><br>  In order to be able to control the robot remotely, I added support for <a href="https://firebase.google.com/">Firebase</a> to the project and when changing the stateString parameter on the server I send the corresponding Arduino command. <br><br><img src="https://habrastorage.org/files/ddb/9ce/4f1/ddb9ce4f1f4741ea80b9411fd2512565.png"><br><br>  The robot rolls around, dodges walls and furniture, is controlled remotely, which makes me very happy. <br><br>  So he rides: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/t-jHMsi5oX4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  I was pleased with the simplicity of development - it took me two days to do the software, despite the fact that I was not an Android or even a Java developer - I spent time on the war with gradle and did not understand why it was impossible to iterate over the iterator. <br><br>  So I can say that the future has come - the threshold for entering the development of products based on Tango is extremely low.  The Tango SDK is very simple and logical; ordinary user devices with <a href="http://shop.lenovo.com/ru/ru/tango/">Tango</a> support appear on the market. <br><br>  The project can be made more interesting if you use not a point cloud, but a model built using Area Learning.  You can try to classify the surrounding objects using TensorFlow, the benefit of 192 Cuda cores on the device allow. <br><br>  Thank you for your attention, and fewer obstacles on your way! <br><br><div class="spoiler">  <b class="spoiler_title">Sources</b> <div class="spoiler_text"><ul><li>  <a href="https://github.com/C-Pro/TangoBot">Source code of the program</a> </li><li>  Source code for the <a href="https://github.com/C-Pro/TangoBotRemote">‚Äúcontrol panel‚Äù</a> </li><li>  <a href="">Sketch for Arduino</a> </li></ul><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/310488/">https://habr.com/ru/post/310488/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310478/index.html">Stable version of Android Studio 2.2 released</a></li>
<li><a href="../310480/index.html">Why does the network of mobile operators sometimes ‚Äúfall‚Äù?</a></li>
<li><a href="../310482/index.html">Another type of XSS attack on the site</a></li>
<li><a href="../310484/index.html">Compress mobile graphics to ETC1 format and open utility</a></li>
<li><a href="../310486/index.html">We make a startup simply and technologically. Eddystone Beacon</a></li>
<li><a href="../310490/index.html">Using SuiteCRM EntryPoints</a></li>
<li><a href="../310492/index.html">Vladislav Kochetkov, President of FINAM Holding: ‚ÄúWe are better able to teach than aggressively sell‚Äù</a></li>
<li><a href="../310494/index.html">CIKM Cup 2016 - an international competition in the field of Data Science</a></li>
<li><a href="../310496/index.html">Just a label on the site</a></li>
<li><a href="../310498/index.html">Quick integration of Google Chromecast in Android app</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>