<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Do you remember how it all started‚Ä¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will try to talk about how the audio path of the Highscreen Boost 3 smartphone, which was introduced in September and went on sale i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Do you remember how it all started‚Ä¶</h1><div class="post__text post__text-html js-mediator-article">  In this article I will try to talk about how the audio path of the <a href="http://highscreen.ru/catalog/smartfony/highscreen-boost-3/">Highscreen Boost 3</a> smartphone, which was introduced in September and went on sale in November 2015, was born.  The Internet already has a lot of reviews and other materials on this smartphone, but very often the information relating to the development is far from the truth. <br><br> <a href="http://geektimes.ru/company/highscreen/blog/266920/"><img src="https://habrastorage.org/files/533/c9e/8bb/533c9e8bb0d14426a329713804867a73.png" alt="image"></a> <br><a name="habracut"></a><br>  A few words about how quality solutions are generally born in technology and where myths about them are born from.  Imagine a mountain river in the gorge, to which you need to go down and collect a bucket of water.  Your task is to collect a bucket of water and climb up with him.  So, the final quality is the amount of water that you can convey without splashing on a difficult path, and the way you walk this path is much stronger, and the cost of the error is much higher than the amount of water that you take in a river.  Myths are a product of the analytical abilities of the human brain, which tries to find a causal connection between events, and if it does not see the obvious connection, then it can think it up (The tribe went hunting, along the way the leader fell into the mud and all was smeared. Hunting successful, and the beginning of all the tribe before the mud to be smeared ... They carried water from the gorge with different buckets, red and green. On average, those who wore red brought more. Oh! So, the red bucket is better. I listened to some individual 2 DAC devices XXX and YYY. Device on DAC X  XX liked it more, it means that the DAC XXX is better ...) And in fact it turns out that most of the water-carriers with a red bucket walked a longer, but much more convenient path, and the developer of the device on the DAC XXX took into account all the nuances of implementation. <br><br>  It all started in January 2015 with a letter from Vobis Computer (Highscreen trademark) with a proposal to participate in the development of the audio part of a new smartphone, because ‚Äú... We also tried to use Wolfson 8918 in several of our models, but we quickly realized that we understand little in real sound ... ".  Thinking, I agreed, voicing my conditions.  Apparently, my conditions turned out to be the most delicious for Vobis, because the choice fell on me.  Well, then, as they say, it went on ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Formulation of the problem </h2><br>  In general, as is usually the case, it all started with the simple word ‚ÄúI want.‚Äù  Wishlist were originally expressed as examples of smartphone models from other manufacturers, chip markings used in them, and the desire to do something similar.  More precisely, the benchmark for sound was the Meizu MX 4 Pro and it was said that it was not necessary to swing the 600-ohm headphones directly.  As a result, this was formulated as the choice of the element base, the development of a circuit on this element base, taking into account the limitations, and then patronage help from Highscreen friends in terms of integrating this circuit into the general scheme of the phone. <br><br>  It was necessary to fit the entire audio path on an area of ‚Äã‚Äã2 cm2 with a component height of no more than 1 mm (as they say, try Blackgate capacitors and chips in DIP packages fit). <br><br><h2>  Element selection </h2><br>  It all started with the choice of DAC.  Many people probably think that DACs are chosen according to the numbers of audio characteristics, but the harsh truth regarding mass portable devices is actually trivial: price and power consumption. <br><br>  Considered DACs from Cirrus Logic, Wolfson (now it is the same Cirrus) and ESS.  As a result, the choice fell on ES9018K2M.  Next, a reference design was obtained from ESS for the application of ES9018K2M in the phone.  Functionally, it is simple: these are the DAC, its power supply circuits, generators, the analog path after the DAC, and the switching node of the musical and spoken paths.  And here began the first difficulties in developing its own path.  Engineers advised to choose an easy way to perfection, to take the existing option as a basis, to refine and put it into production.  This option had to be immediately pushed aside, because we were making a real music smartphone! <br><br>  The reference design as a spherical horse in a vacuum is not tied to anything, but there are markings of some microcircuits, for example, the analog path after the DAC is implemented on the OPA1612 opamp (I hope everyone understands where ES9018K2M and OPA1612 come from in portable devices). <br><br>  Operational amplifier, on the basis of which the analog part of the audio section is made.  Then the second problem was waiting for me: blind faith in numbers from datasheets, without understanding the conditions in which they were received.  Yes, OPA1612 is a good op-amp, only when working on a high-impedance load, which the headphones are not, suggested the ADA4897-2 op-amp, which works much better with a low-impedance load and also has a shutdown function, which will be useful in the future.  At the expense of using the ADA4897-2, Highscreen engineers even consulted with ESS Technology, from where they got the answer that they probably will work, but nobody has done so (you can buy what you did in the store and evaluate it yourself).  And if you look at the first digits in the datasheet for distortions, then they are better with the OPA1612, they are only received at a supply voltage of ¬± 15V, which is quite difficult to implement in the phone. <br><br>  For the power supply of the shelter, a chip from TI was originally proposed, which immediately forms 2 supply voltages + 5V and -5V.  We chose most likely for the price and availability, because the maximum current for the proposed solution was only 40 mA.  That is, in each channel of the audio path.  even without current consumption, the current amplitude could be a maximum of 20 mA.  That, to put it mildly, is not enough.  As a result, we settled on a solution that allows us to supply ¬± 5V with currents up to 250 mA, that is, we can count on 100 mA in each channel. <br><br>  Generators for the DAC.  There are 2 of them in the reference design (for sampling frequencies of multiple 44.1k and 48k), but since the MT6753 processor cannot work in slave mode via the I2S interface and the ESS Saber DACs have an ASRC system (asynchronous sample rate converter), It was decided to leave only one generator at 49.152 MHz with low phase noise. <br><br>  Linear stabilizers for powering the DAC and the generator were left unchanged, but there was a nuance with their use. <br><br>  The multiplexer for switching music and conversational paths in the end remained the same, but it was used differently. <br><br><h2>  Circuitry nuances </h2><br>  Nuance first is related to the power supply of the DAC and generators.  In the reference design, they are supplied with some external power from the only source in the phone, that is, from the battery.  About the situation when the battery is discharged and the voltage at the inputs of linear stabilizers becomes less than it should be at their outputs, they do not write in datasheets.  I had to add an intermediate switching regulator to ensure the normal operation of the DAC power subsystem at any level of battery discharge. <br><br>  Most of the nuances are connected, of course, with the analog part of the audio section after the DAC.  This part of the circuit performs the functions of amplification and filtering of RF interference from the DAC.  Usually, the filter after the DAC is tuned to 30-40 kHz, I was told that, according to data from the ESS, a super-dull interference suppression system is used in their DACs, and there is nothing up to 400 kHz.  So let's tune the filter to these same 400 kHz.  Arguments that the real filter thing is not perfect and has a certain decay slope, resulting in two second-order filters with cut-off frequencies of 40 and 400 kHz will push the interference at 500 kHz with a difference of 40 dB, forced Highscreen engineers to ponder.  In the end, did the right thing. <br><br>  Further, why did we have a shutdown function in the OS.  Breaking a spear in the fight for fractions of percent THD, indicated in datasheets at the OS, many developers often shamelessly send a signal from the OS output through a multiplexer, the distortions of which are a couple of orders of magnitude more distortions of the OS (ardent hello to the ESS reference design repeaters unchanged).  In order to solve this problem, I sent the signal from the OU output directly bypassing the multiplexer, and to switch the paths I switched off the OU. <br><br>  Then I was lurking a surprise after the sounding of the maximum output power of the path, 100 mW at a load of 32 ohms.  The figure is ridiculous in general, but Highscreen engineers wanted to insure themselves and decided that the headphones for the smartphone could burn at a power of more than 10 mW and suggested reducing the output power.  Of course, you can't just insert a resistor between the OU and the connector - imagine what the frequency response of headphones with complex impedance, multi-driver fittings, for example, would become.  In addition, it was necessary to make sure that all this wealth was reasonably consumed.  That is why the device is present in three volume modes in the engineering menu. <br><br><h2>  Nuances of practical implementation </h2><br>  Well, everything, the scheme was settled, breathed with relief, let's do it.  Yeah, right ...  It turned out that at the right time it is impossible to find the required number of certain values ‚Äã‚Äãof resistors and capacitors, which are used in the filter after the DAC (there are quality resistors and capacitors, not quite the mass market).  Of course, the replacement of one nominal pulls the recalculation of all the others, so I had to make up a label with the interrelationships of the nominal elements in the scheme, such as increasing it 2 times, reducing 2 times here.  As a result, I received all the available nominal values ‚Äã‚Äãand on the basis of them I counted the filter. <br><br>  Next, the wiring board and the first samples.  Hurried and wrong, of course, the time is burning, the smartphone had to come out in September for a planned <a href="http://highscreen.ru/fest-report/">rock festival</a> ... New versions of the boards were made extremely quickly, since the speed of production allows. <br><br><img src="https://habrastorage.org/files/766/61d/532/76661d532f044a97aa2b2ef8ac1bfa29.jpg" alt="image"><br><br><h2>  Total </h2><br>  As a result, it was possible to see, touch and listen at the presentation in September, or now in stores.  As it was said in one old French film: ‚ÄúI‚Äôm an old soldier and I don‚Äôt know the words of love ...‚Äù I will repeat my words that I said at the presentation: ‚ÄúYou can write and tell a lot how this or that device sounds, but your own ears in a minute tell about his sound much more. " <br><br>  I wish you all high-quality sound in headphones! <br><br>  Text writer: Mikhail Orlov. </div><p>Source: <a href="https://habr.com/ru/post/369131/">https://habr.com/ru/post/369131/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../369121/index.html">Raspberry Pi Zero + Xbox controller = game console</a></li>
<li><a href="../369123/index.html">Smart Plinth 1.0</a></li>
<li><a href="../369125/index.html">Rooti Labs introduced a tracker for constant pressure monitoring.</a></li>
<li><a href="../369127/index.html">For anonymous WiFi will be fined? A new bill has been submitted to the government.</a></li>
<li><a href="../369129/index.html">How to take photos in RAW format on almost any Android phone</a></li>
<li><a href="../369133/index.html">India has experienced a 6.5 meter return scale model</a></li>
<li><a href="../369135/index.html">Postman robots will appear in the US and the UK in 2016</a></li>
<li><a href="../369137/index.html">24-ply cardboard house is assembled in 1 day, withstand at least 50 years</a></li>
<li><a href="../369139/index.html">France plans to stimulate the development of cheap electric cars</a></li>
<li><a href="../369143/index.html">The role of information technology in business process reengineering</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>