<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recovery PDP 11/04. Terminal LA30 Decwriter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuation of the translation of the article on the restoration of one old interesting machine. In the first part, we adjusted the main board unit. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recovery PDP 11/04. Terminal LA30 Decwriter</h1><div class="post__text post__text-html js-mediator-article">  <i>Continuation of the translation of the article on the restoration of one old interesting machine.</i>  <i>In the <a href="http://habrahabr.ru/post/243551/">first</a> part, we adjusted the main board unit.</i>  <i>In the <a href="http://habrahabr.ru/post/243553/">second</a> - the tape station TU60.</i>  <i>Many heavy pictures.</i>  <i>Italic my comments.</i> <br><br><h3>  LA30 Decwriter </h3><br>  Now I have started the final part of my quest - to get a good terminal, which would be as vintage as the main system.  I am lucky that I have LA30 in storage, which I am now going to begin to recover.  Our copy was made in early 1973. Although, the print heads were apparently replaced in 1979. <br><br>  LA30, apparently, was one of the first dot-matrix printers, which makes it interesting, in itself, even in isolation from the PDP-11. <br><img src="https://habrastorage.org/files/118/37f/1c4/11837f1c4dd84b65ab801a541242186e.png"><br><a name="habracut"></a><br>  Printing terminal with a really nice vintage look!  It is also heavy.  The body is made of casting (it seems to me) of aluminum, and the top cover is made of fiberglass, reinforced with ordinary plastic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The decwriter on the right has a data rate switch, which is why I think it was the LA30S for the serial port, but on the information plate behind it is written LA30P.  In addition, it does not have two cards that are needed to connect via a serial port. <br><img src="https://habrastorage.org/files/2da/cb3/903/2dacb3903aa4479e9c280b433b958b03.png"><br><br>  All printer control logic is transistor ( <i>TTL</i> ), with the exception of ROM for decoding characters, a keyboard coder and an optional UART. <br><img src="https://habrastorage.org/files/b47/0be/72a/b470be72ac3d4294a3686c25bb40fa65.png"><br><br>  After cleaning, the keyboard looks pretty dignified.  The layout is slightly different from modern keyboards.  Microchip keyboard coder is very beautiful, is not it?  Very early BIS, created by SMC. <br><br>  I started working with fixing capacitors.  Although all the capacitors were in quite good condition.  The leakage current is 100¬µA at the worst of them.  Not bad, especially after 40 years.  After that, I cleaned the printheads from old ink. <br><br>  When (and if) I make it work, I will still have a serious problem: this is a parallel terminal that requires the M7910 fee on the PDP-11.  I don't have one like that.  Another option is to find two missing boards - M7731 and M7389, which, I think, is even more difficult.  The last possibility is to assemble a small adapter on the Arudino from the parallel port to the serial port. <br><br><h3>  Allspice? </h3><br><br>  Pictured below is the LA30 printhead.  The time stamp on it contains 1979. This means that the head has been replaced.  It looks like this is the same head that was used in LA36 and LA180. <br><img src="https://habrastorage.org/files/921/8b4/b0a/9218b4b0aa6a4d93b0c66b6bbc652275.png"><br><br>  I tested the printheads, delivering 15V and ~ 2A to each coil for an extremely short amount of time.  Only 2 of the 7 needles reacted.  Therefore, I bought a special recommended oil - Omega 636, and, by the way, it contains something called allspice.  Liquid oil and a few days of rest brought life to three additional needles, and the remaining two need a little pressure for release.  I hope that when I return the heads to the printer, these needles will also work. <br><br><h3>  Homemade keyboard coder </h3><br><br>  KR2376 from SMC, a pMOS chip that performs keyboard coding, was broken.  Looking for a suitable replacement would not be easy and very expensive.  I made my own equivalent on AVR. <br><br>  Since the keyboard is of capacitive type, it means that each and every key is a transistor.  The collector of which is connected to the X-matrix, and the emitter to Y. The base, in turn, is connected to a variable capacitor, which is formed by the moving part of the key and the board itself.  On the other hand, an oscillator is connected to this capacitor. <br><img src="https://habrastorage.org/files/c18/59f/6a5/c1859f6a55464734a8d8a4df36fb808b.png"><br>  <i>The original SMC chip is on the left, and my replacement is on the right.</i> <br><br>  For Arudino, there is a pretty good keyboard library that needed only a few minor edits.  In addition to the faulty encoder, there was a micro-crack on the keyboard board, which I patched with a small amount of solder.  After that, the keyboard worked fine! <br><br>  Software can be downloaded <a href="https://github.com/MattisLind/keyboardDecoder">here</a> . <br><br><h3>  Power Supply </h3><br><br>  The power supply contains a large transformer and four electrolytic capacitors.  One of the transformer windings is connected to an AC capacitor to form a ferroresonant circuit.  Thus, the power supply becomes more resistant to power glitches.  It saves energy in the coil and the capacitor.  But this capacitor is already very old and most likely contains polychlorinated biphenyls.  The nomenclature of the capacitor was recorded in the list of elements of the board, so I decided to replace it just in case, before continuing work.  I found a suitable capacitor from Cornell-Dublier <br><img src="https://habrastorage.org/files/4a6/d01/f28/4a6d01f286224678992625fd24b59de7.png"><br>  <i>Old replacement capacitor</i> <br><br>  While I was waiting for delivery, I rechecked electrolytic capacitors.  They were all right, and as soon as the AC capacitor arrived, I was able to run the power supply under the test load without any problems.  All specifications were excellent. <br><br><h3>  Enhanced encoder board </h3><br><br>  My homemade keyboard coder was a bit clumsy and didn‚Äôt look very cool.  For self-education, I decided to do the layout and order a fee in China.  The result was great! <br><img src="https://habrastorage.org/files/a91/083/1b8/a910831b812e484d8258581dec1da86a.png"><br><br><h3>  We are testing the entire terminal </h3><br><br>  Before starting the full test, I dismantled the printer in order to clean it and lubricate all the places where it was required.  After reassembling the machine and raising it to the ‚ÄúON‚Äù position, of course, nothing happened.  The first problem was that there were two locking keys that must be in the correct position for the unit to be ready for operation.  One of them checked that there is paper in the printer.  When the printer is in the ‚ÄúREADY‚Äù state, the ‚ÄúB INI L‚Äù signal is at a high level and the ‚ÄúREADY‚Äù light on the keyboard glows pleasantly.  In addition, a strobe pulse is generated from the keyboard to the control logic of the printer.  The LA30 version with parallel connection does not have a LINE / LOCAL switch, so this option is not user adjustable, but it turns out that a logic circuit with this feature is present on the M7712 board, but is not used.  When the ‚ÄúLCL ENA L‚Äù signal is sent through the AR2 pin on the M7712 board, it closes the printer for local operation. <br><br>  And, voila, he really prints something when we type the text on the keyboard, but since there is no ribbon in his place, it is very difficult to understand what he is typing. <br><img src="https://habrastorage.org/files/d7c/4df/b24/d7c4dfb248f54112904b8dca537021a5.jpg"><br><br>  Looking through the repository, I found three different colored ribbons in the original packaging, still in heat shrinkage and even in folded paper.  It looks like the top one is for LA30, and the bottom one is for LA36 / LA180.  The average is unknown for sure, but perhaps for LS01 / Centronics 101. By the way, plain paper did not fit LA30.  It needs 250mm paper instead of 216mm. <br><br><h3>  Problem with character generation </h3><br><br>  By inserting paper into the printer, I was able to check it, and he did print something, but this ‚Äúsomething‚Äù was incorrect. <br><img src="https://habrastorage.org/files/15b/fd6/aa9/15bfd6aa9c1b47c69b28b55ca55a2285.jpg"><br><br>  It seems that the last column of each character disappeared and, moreover, despite the keystrokes, only a limited set of characters appears on the paper.  After checking with the ASCII table, you can see that two bits are stuck.  Having traced these bits, we see that the correct values ‚Äã‚Äãare supplied to the input of the symbol generator.  Since the column counter is also located inside this generator, it becomes the main suspect.  First you need to check the triggers marked in red. <br><img src="https://habrastorage.org/files/dd0/ca6/b0f/dd0ca6b0f81a45ba9054dee8f0c78408.png"><br><br>  It turned out that these chips are not working properly.  Replace the broken 7474, produced by National Semiconductor (again NS!) In 1972, with ceramic from Fairchild and Texas Instruments. <br><img src="https://habrastorage.org/files/e99/63e/f3e/e9963ef3eeac415eb33dc9e63d4d2997.png"><br><br><h3>  Visible last character </h3><br><br>  There is one more trouble.  The function "visible last character" does not work for the first time until the machine is warmed up.  It starts functioning some time after the start.  This is a function that moves the printhead two characters to the right after a timeout of 1 second so that the print character can see the last character typed.  Great stuff if you use the machine as a console terminal.  I traced the problem to a dead 1 second timeout generator.  Red area in the diagram. <br><img src="https://habrastorage.org/files/480/3f2/42b/4803f242b32c44d79be82b04f2427320.png"><br><br>  Initially, it looked like a non-working E14 (7440), but when I tested it with the use of a cooling spray, it turned out that this E12 meter (7493) behaves badly.  Again the NS chip!  Replacing it with a chip from TI, released in 1969, I saw that the generator was working. <br><img src="https://habrastorage.org/files/d2e/cf5/b1f/d2ecf5b1f5ca4e12bda26348c80dba3b.png"><br><br><h3>  Works! </h3><br><br>  The last problem is connected with the fact that the stepping motor was stalled during the carriage transfer on the filled line.  Step pulses were just too fast.  The LA30 has a separate unit that controls acceleration during carriage transfer.  I simply lowered the maximum speed by setting one of the potentiometers in the G936 module. <br><br>  With this last edit, the printer is working as it should! <br><img src="https://habrastorage.org/files/452/729/736/4527297363b141bd90b07d625fdcbc24.jpg"></div><p>Source: <a href="https://habr.com/ru/post/243555/">https://habr.com/ru/post/243555/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243543/index.html">High-quality interface JIRA-plugin using the AUI Framework</a></li>
<li><a href="../243545/index.html">SPA-architecture for CRM-systems: part 1</a></li>
<li><a href="../243547/index.html">Python Meetup 10/31/14: asynchrony and soft skills</a></li>
<li><a href="../243551/index.html">PDP Recovery 11/04</a></li>
<li><a href="../243553/index.html">Recovery PDP 11/04. Tape station TU60</a></li>
<li><a href="../243557/index.html">How we united the brand book of partners from Kamchatka to Kaliningrad (Part 2)</a></li>
<li><a href="../243559/index.html">Google will mark mobile sites in search results</a></li>
<li><a href="../243561/index.html">How the cloud makes life easier for startups</a></li>
<li><a href="../243563/index.html">Theoretical minimum * nix-based-systems for WebDev-padawan</a></li>
<li><a href="../243565/index.html">Using RequireJS in AngularJS Applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>