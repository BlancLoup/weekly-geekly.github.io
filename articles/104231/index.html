<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Integer and int</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this topic, I want to describe some basic differences between primitive types and their corresponding object types using the example of int and Int...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Integer and int</h1><div class="post__text post__text-html js-mediator-article">  In this topic, I want to describe some basic differences between primitive types and their corresponding object types using the example of int and Integer.  These differences are quite simple and, if you think a little, they are quite logical, but, as experience has shown, the programmer does not always think about it. <br><br>  The main difference, of course, is that Integer is a full-featured object that takes up space on the heap, and in the code you use links to it that are implicitly converted to values: <br><blockquote><code><font color="#0000ff">int</font> a = <font color="#00007f">1000</font> ; <font color="#7f7f7f"><i>// a - </i></font> <font color="#7f7f7f"><i><br></i></font> Integer b = <font color="#00007f">1000</font> ; <font color="#7f7f7f"><i>// b -   </i></font></code> </blockquote>  When assigning a value to a variable of type Integer, memory is usually allocated in the heap for a new object, as if you had written <code>new Integer(1000)</code> (the so-called <a href="http://download.oracle.com/javase/1.5.0/docs/guide/language/autoboxing.html">autoboxing</a> ).  However, old objects are sometimes reused.  This is illustrated by the following code (JDK 1.6): <br><blockquote> <code>Integer a1 = <font color="#00007f">50</font> ; <br> Integer a2 = <font color="#00007f">50</font> ; <br> Integer b1 = <font color="#00007f">500</font> ; <br> Integer b2 = <font color="#00007f">500</font> ; <br> System. <font color="#007f00">out</font> . <font color="#007f00">println</font> (a1==a2); <br> System. <font color="#007f00">out</font> . <font color="#007f00">println</font> (b1==b2);</code> </blockquote>  The result of the execution will be: <br><blockquote> <code>true <br> false</code> </blockquote> <a name="habracut"></a>  Here, the static method java.lang.Integer.valueOf (int) is actually called, which, as you can see in the <a href="http://www.java2s.com/Open-Source/Java-Document/6.0-JDK-Core/lang/java/lang/Integer.java.htm">source</a> , caches values ‚Äã‚Äãfrom -128 to 127 (in a more recent implementation, the upper boundary of the cache can be changed). <br><br>  However, in most cases, a new object is created, and this can be significant.  Remember also that the Integer object never changes its value.  Consider this seemingly innocent code: <br><blockquote> <code><strong>public</strong> <strong>class</strong> Increment <br> { <br> <strong>public</strong> <font color="#0000ff">static</font> <font color="#0000ff">void</font> <font color="#007f00">main</font> (String[] args) <br> { <br> Integer a= <font color="#00007f">0</font> ; <br> <strong>while</strong> ( <strong>true</strong> ) a++; <br> } <br> }</code> </blockquote>  Let's copy the memory usage, for example, with the trial version of <a href="http://www.ej-technologies.com/products/jprofiler/overview.html">JProfiler</a> : <br><img src="https://habrastorage.org/storage/0de74053/a348c9e3/b2b5bdcb/06227a0e.gif"><br>  Obviously, with each increment, a new Integer object is created, and the old ones are then cleaned up by the garbage collector when they accumulate about a hundred thousand.  Good system load for normal increment operation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, it is clear that the Integer should be used only when it is indispensable.  One such example is parameterized types (generics), for example, standard collections.  But here we must be careful to use memory wisely.  I will give a somewhat exaggerated example based on the problem I encountered in a real project.  In some scientific analysis, it was necessary to associate with certain objects long sets of natural numbers.  You can emulate this with the following code: <br><blockquote> <code><strong>import</strong> java.util.*; <br> <br> <strong>public</strong> <strong>class</strong> MapInteger <br> { <br> <font color="#0000ff">static</font> Map&lt;Integer, Set&lt;Integer&gt;&gt; subSets = <strong>new</strong> HashMap&lt;Integer, Set&lt;Integer&gt;&gt;(); <br> <br> <strong>public</strong> <font color="#0000ff">static</font> <font color="#0000ff">void</font> <font color="#007f00">put</font> (Integer key, <font color="#0000ff">int</font> value) <br> { <br> <strong>if</strong> (!subSets. <font color="#007f00">containsKey</font> (key)) subSets. <font color="#007f00">put</font> (key, <strong>new</strong> HashSet&lt;Integer&gt;()); <br> subSets. <font color="#007f00">get</font> (key). <font color="#007f00">add</font> (value); <br> } <br> <br> <strong>public</strong> <font color="#0000ff">static</font> Collection&lt;Integer&gt; <font color="#007f00">getRandomKeys</font> () <br> { <br> List&lt;Integer&gt; vals = <strong>new</strong> ArrayList&lt;Integer&gt;(); <br> <strong>for</strong> ( <font color="#0000ff">int</font> i= <font color="#00007f">0</font> ; i&lt;( <font color="#0000ff">int</font> )(Math. <font color="#007f00">random</font> ()* <font color="#00007f">500</font> ); i++) <br> { <br> vals. <font color="#007f00">add</font> (( <font color="#0000ff">int</font> )(Math. <font color="#007f00">random</font> ()* <font color="#00007f">1000</font> )); <br> } <br> <strong>return</strong> vals; <br> } <br> <br> <strong>public</strong> <font color="#0000ff">static</font> <font color="#0000ff">void</font> <font color="#007f00">main</font> (String[] args) <br> { <br> <strong>new</strong> Scanner(System. <font color="#007f00">in</font> ). <font color="#007f00">nextLine</font> (); <br> <strong>for</strong> (Integer i= <font color="#00007f">0</font> ; i&lt; <font color="#00007f">100000</font> ; i++) <br> { <br> <strong>for</strong> (Integer key: <font color="#007f00">getRandomKeys</font> ()) <br> <font color="#007f00">put</font> (key, i); <br> } <br> <strong>new</strong> Scanner(System. <font color="#007f00">in</font> ). <font color="#007f00">nextLine</font> (); <br> } <br> }</code> </blockquote>  For each number from the first hundred thousand, we define a set of keys using getRandomKeys (in the real task, the keys, of course, were not accidental) and add the current number to the corresponding sets of subSets.  The key type Integer is chosen to simplify the illustration;  in general, it is not important.  Here are the numbers of objects before the operation: <br><img src="https://habrastorage.org/storage/8d0c6660/36eb7e61/512a49f9/6b38b50c.png"><br><br>  But after: <br><img src="https://habrastorage.org/storage/27047865/1842fdf4/98d02675/3abd944c.png"><br><br>  The forced launch of the garbage collector did not help much: <br><img src="https://habrastorage.org/storage/7b39209a/0e98b5d1/8654346f/47a063f9.png"><br><br>  40 megabytes of memory eat whole numbers - this is sad.  The reason lies in the prototype of the put method: <br> <code>public static void put(Integer key, <b>int</b> value)</code> <br>  Due to the fact that the int type is used here, the values ‚Äã‚Äãof the variable i are automatically converted to int (unboxing) when passed to the method, and then newly converted to Integer (boxing), but a new object is created.  Replace the <code>int value</code> in the prototype with <code>Integer value</code> and run the profiler again.  At the beginning the picture is the same: <br><img src="https://habrastorage.org/storage/344a9e66/0849bf80/6f408fea/ff6aeacd.png"><br><br>  But at the end of significant differences: <br><img src="https://habrastorage.org/storage/ba832833/e3e997eb/497658cb/23180865.png"><br><br>  And after garbage collection: <br><img src="https://habrastorage.org/storage/4a5f95bd/a5de90d1/2ca2dc4b/913d02c1.png"><br><br>  So, replacing one int with an Integer, you can save about 40% of the memory used.  Note that in <code>for(Integer i=0; i&lt;100000; i++)</code> also not by chance that Integer is used: we will write an int here, and the first correction will not help.  We see that the rule to write int wherever you can not write Integer, does not always work: in each case, you need to think.  Sometimes your own implementation of the integer cache can also be useful. </div><p>Source: <a href="https://habr.com/ru/post/104231/">https://habr.com/ru/post/104231/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../104220/index.html">JavaFX Tower Defense Competition: Light Towers</a></li>
<li><a href="../104221/index.html">On the positivity of Facebook and the disadvantages of social services</a></li>
<li><a href="../104224/index.html">MODx - a simple file archive for FileDownload v2.6. Improving the system of editing file descriptions</a></li>
<li><a href="../104227/index.html">Collective travel together is more profitable</a></li>
<li><a href="../104229/index.html">Loading classes in java. Practice</a></li>
<li><a href="../104233/index.html">About Privatbank and Privat24</a></li>
<li><a href="../104234/index.html">EeePC 1018P - ah yes krasava!</a></li>
<li><a href="../104235/index.html">Nokia E7 Video Preview at Nokia World 2010</a></li>
<li><a href="../104238/index.html">What does an Arabic keyboard look like</a></li>
<li><a href="../104239/index.html">Review code in mercurial</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>