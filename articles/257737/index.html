<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Forensic and steganography in a video file: analysis of tasks for the online stage NeoQUEST-2015</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The past online stage of the annual cybersecurity competition NeoQUEST-2015 was extremely rich in interesting and non-trivial tasks! In this article w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Forensic and steganography in a video file: analysis of tasks for the online stage NeoQUEST-2015</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/files/dbe/a13/a63/dbea13a630fa4cb49651a4f890d5a14d.jpg">  The past online stage of the annual cybersecurity competition NeoQUEST-2015 was extremely rich in interesting and non-trivial tasks!  In this article we: <br><ul><li>  let's deal with video steganography and the esoteric programming language Piet, examining the task ‚ÄúTruth is inside‚Äù </li><li>  We climbed into the skin of a computer criminologist, work with TrueCrypt and answer the question ‚ÄúWas there a key?‚Äù. </li></ul><br>  Great news: the date of the "confrontation" of NeoQUEST-2015 is approved!  The event will take place <b>on July 2</b> (Thursday) in St. Petersburg, in <a href="http://club-house.org/">the CLUB HOUSE</a> !  As before, the entrance is free - you just need to register on our <a href="http://neoquest.ru/">site</a> . <br><a name="habracut"></a><br><h5>  <b>1. ‚ÄúTruth inside‚Äù - steganography in video</b> </h5><br>  Download the file apple.avi, the link to which is given in the task.  We draw attention to the hint in the text of the legend to the task, hinting that comparing the received video with the original video on the Apple channel will help you to understand what to do next!  Go to youtube.com, look for our video on the Apple channel. <br><br><img src="https://habrastorage.org/files/8dd/064/787/8dd06478785e439bb795b5d29e2a6a67.jpg"><br><br>  We download it by any service for saving videos from youtube.com in .flv format.  Why in .flv?  Well, not for nothing that the newly installed flv-codecs are mentioned for some reason in the task. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It would be logical to compare these two videos frame by frame, for this we use the software solution <a href="https://www.ffmpeg.org/">ffmpeg</a> .  We split both videos into frames, each in its own directory: <br><br><pre><code class="hljs matlab">ffmpeg -<span class="hljs-built_in"><span class="hljs-built_in">i</span></span> ./youtube.flv ./<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-comment"><span class="hljs-comment">%d.png ffmpeg -i ./apple.avi ./2/%d.png</span></span></code> </pre> <br><br>  For comparison, the synchronization of directories in Total Commander is suitable: <br><br><img src="https://habrastorage.org/files/ee7/c72/cb2/ee7c72cb257c449384bb5b6921c35586.jpg"><br><br>  The screenshot shows frames that are different in both videos, these 24 pieces.  We will try to compare some pair of frames, for example, the 21st.  To do this, use <a href="http://www.imagemagick.org/">ImageMagic</a> : <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">compare</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.exe</span></span> 21<span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> 21<span class="hljs-selector-class"><span class="hljs-selector-class">.2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">diff</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span></code> </pre><br><br><img src="https://habrastorage.org/files/9eb/88a/6d7/9eb88a6d71d145c78fdb40c1715dc110.jpg"><br><br>  In the upper left corner we see a rectangular area.  In a detailed study, we understand that the low bit in the red pixel channel changes.  Information hiding in the lower bits is a fairly common method of steganography.  We have 24 frames, with modified low-order bits in a rectangular area.  24 bits is enough to encode 3 bytes of pixel color. <br><br><img src="https://habrastorage.org/files/4de/f9b/2c3/4def9b2c354f47df82120d4bd9e85ede.jpg"><br><br>  Now we need to collect an image from the lower bits, for this we use Python and, for example, <a href="http://www.pythonware.com/products/pil/">PIL</a> : <br><br><img src="https://habrastorage.org/files/152/936/368/15293636885d4366a040bd5ef6a95df3.jpg"><br><br>  It is not difficult to guess that we have a program in the esoteric programming language <a href="https://ru.wikipedia.org/wiki/Piet">Piet</a> .  We'll have to tinker a bit with the interpreter, after starting which the program displays a message containing the key to the task: <br><br>  ‚ÄúHello!  Secret Key: 8aec4bb34fbdd11c2aef4fea391b4fe2 ¬ª <br><br><h4>  <b>2. ‚ÄúWas there a key?‚Äù - forensic and TrueCrypt</b> </h4><br>  Participants were given a disk dump in which they needed to find the key.  Passage can be divided into the following stages: <br><ol><li>  Mount disk </li><li>  Search for installed software </li><li>  Search for an encrypted logical drive </li><li>  Search volume encryption key </li><li>  Search for the key to the task </li></ol><br><br>  <b>Mount disk</b> <br>  Windows 7 - 8.1 will allow you to mount a disk image without additional software.  On other operating systems, you can use Virtual Box, VMWare and other virtualization software for mounting. <br><br>  After mounting in Windows 8.1, 2 disks will appear. <br>  The contents of the system disk: <br><br><img src="https://habrastorage.org/files/249/132/f32/249132f3243849859a45dcb3612ffd79.jpg"><br><br>  Disk with user data, which, of course, interest us in the first place: <br><br><img src="https://habrastorage.org/files/5b6/e6a/1c7/5b6e6a1c7e21495c8adbc2d36e2b7fc1.jpg"><br><br><h6>  <b>Search for installed software</b> </h6><br>  It is necessary to enable the display of hidden and system files, after which we check the main folders Program Files and Program Files (x86), where the TrueCrypt program is located.  TrueCrypt is a computer program for on-the-fly encryption.  It allows you to create a virtual encrypted logical drive that is stored as a file. <br><br><img src="https://habrastorage.org/files/d11/018/c43/d11018c43953444eb8ad6be5227fc4cb.jpg"><br><br><h6>  <b>Search for an encrypted logical drive</b> </h6><br>  In the description of the program indicated that with it you can create a virtual encrypted logical drive.  To find this disk, use the program <a href="http://www.softpedia.com/get/System/File-Management/TCHunt.shtml">TChunt</a> . <br><br><pre> <code class="hljs">tchunt.exe -d ../ &gt; tchunt.txt</code> </pre><br><br><img src="https://habrastorage.org/files/13a/90e/af9/13a90eaf9d3c49fe8bc37e639e0dd647.jpg"><br><br>  Open the tchunt.txt file <br><br><img src="https://habrastorage.org/files/d45/42c/df4/d4542cdf4c2341d09785b998d25070b3.jpg"><br><br>  The X: \ Users \ JohnSmith \ files file is an encrypted container. <br><br><h6>  <b>Search volume encryption key</b> </h6><br>  In the root of the disk there is a folder Dali.  Among all the images there is a file key.jpg.  Based on this, we can assume that it is not the password that is used, but the key file.  When you try to substitute this file as a key for a container, TrueCrypt reports an invalid password. <br><br><img src="https://habrastorage.org/files/7f9/a42/907/7f9a429074384521ad07ebbe132429c3.jpg"><br><br>  From which it can be concluded that the key is either hidden in the file key.jpg, or deleted, or key.jpg has nothing to do with the encrypted disk.  Check the most simple version - the file is deleted (logical action, if you suddenly come after you!). <br><br><img src="https://habrastorage.org/files/6ee/873/5ad/6ee8735ad6ad4f33b8cfcd3331b66436.jpg"><br><br>  Restore key-x.jpg and try to use it as a key - the virtual disk is successfully mounted! <br><br><img src="https://habrastorage.org/files/a15/3ad/2e0/a153ad2e035d435882a1f3ac700c3b5f.jpg"><br><br><h6>  <b>Search for the key to the task</b> </h6><br>  The disk contains a very large number of files (all with the extension .jpg) and the key is most likely hidden in one of them.  Let's try to check the latest open files with this extension in the system, for this you need to go to the registry of the installed OS.  If the hard disk is mounted on a virtual machine, then just run the regedit command.  If not, then you need to connect the necessary part of the registry - hive. <br><br>  To do this, click File&gt; Load Hive and select X: \ Users \ JohnSmith \ NTUSER.dat.  Next, go on the path: Software \ Microsoft \ Windows \ CurrentVersion \ Explorer \ RecentDocs \ .jpg <br><br><img src="https://habrastorage.org/files/b96/b4b/35c/b96b4b35c47741c49bf0171d16dd6b90.jpg"><br><br>  Among the contents are the names of the last open files.  Enumerate them and check the presence of the key in the image. <br>  The key was on the image of "Peter I on a dog hunt.jpg" <br><br><img src="https://habrastorage.org/files/52f/474/001/52f474001d444cb88ad1ba5515b718a9.jpg"><br><br><h4>  <b>And that is not all!</b> </h4><br>  Ahead is an analysis of the remaining tasks of the online stage NeoQUEST-2015 and the expectation of a bright and sunny (despite the fact that in St. Petersburg) the event NeoQUEST-2015.  The participants will face tense struggle at 8 o'clock, and the guests - contests, reports, practical workshops, gifts and communication with colleagues!  We remind you that for this - just a couple of steps: <a href="http://neoquest.ru/timeline.php%3Fyear%3D2015">register</a> and (for those who are not here) buy tickets to Peter! </div><p>Source: <a href="https://habr.com/ru/post/257737/">https://habr.com/ru/post/257737/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../257725/index.html">How to catch what is not. Part six. Viruses in the bank</a></li>
<li><a href="../257729/index.html">ISO 9241-110 - Principles for the organization of dialogue</a></li>
<li><a href="../257731/index.html">Practical procedure for calculating and constructing the VHF radio route</a></li>
<li><a href="../257733/index.html">Wolfram Language (Mathematica) Virtual Tutorial</a></li>
<li><a href="../257735/index.html">When the clouds are small: High-performance storage devices</a></li>
<li><a href="../257739/index.html">Crying engineer</a></li>
<li><a href="../257741/index.html">The winner of the competition - "Kubotronic"</a></li>
<li><a href="../257743/index.html">Glitter and poverty of standard selects</a></li>
<li><a href="../257745/index.html">This is not forgotten - Oracle Database In-Memory</a></li>
<li><a href="../257747/index.html">Super-fast start with Arduino: you take and do</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>