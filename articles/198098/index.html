<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Write Back in MS SQL Server Analysis Service cubes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, In-Memory BI solutions are becoming increasingly popular. Cubes are no longer in vogue, their structure is morally obsolete, and although they ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Write Back in MS SQL Server Analysis Service cubes</h1><div class="post__text post__text-html js-mediator-article">  Today, <a href="http://en.wikipedia.org/wiki/In-Memory_Processing">In-Memory BI</a> solutions are becoming increasingly popular.  Cubes are no longer in vogue, their structure is morally obsolete, and although they scale pretty well, the requirements for the speed of modern BI systems have increased significantly.  Nevertheless, many companies are still successfully using analytics built on one of the <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_OLAP-%25D1%2581%25D0%25B5%25D1%2580%25D0%25B2%25D0%25B5%25D1%2580%25D0%25BE%25D0%25B2">OLAP servers</a> (Microsoft, Oracle, Cognos, and others).  For example, I really like the Microsoft SQL Server Analysis Service, and I would like to tell you how you can use a function that is a bit unusual for analytics in it - write back to the source (Write Back). <br><br><a name="habracut"></a><h5>  Formulation of the problem. </h5><br>  It is necessary to make a sales plan for the year by month, product and region.  At the same time, it is necessary to see the actual data of the current year and the calculated trend for the next year, which the manager will change.  The data entry tool should be convenient, it should allow you to overlay filters and look at the results for different groupings (in general, by region, product and period) and still not require a lot of time from the user to study. <br><br><h5>  Decision. </h5><br>  We will use MS SQL Server 2008 R2 (Database Engine and Analysis Service) + Excel 2010. Create a database, several tables and fill them with data. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Script database creation and filling tables</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span> [MyDB] <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> PRIMARY ( <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> = N<span class="hljs-string"><span class="hljs-string">'MyDB'</span></span>, FILENAME = N<span class="hljs-string"><span class="hljs-string">'C:\MyDB.mdf'</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">SIZE</span></span> = <span class="hljs-number"><span class="hljs-number">3072</span></span>KB , FILEGROWTH = <span class="hljs-number"><span class="hljs-number">1024</span></span>KB ) <span class="hljs-keyword"><span class="hljs-keyword">LOG</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> = N<span class="hljs-string"><span class="hljs-string">'MyDB_log'</span></span>, FILENAME = N<span class="hljs-string"><span class="hljs-string">'C:\MyDB_log.ldf'</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">SIZE</span></span> = <span class="hljs-number"><span class="hljs-number">1024</span></span>KB , FILEGROWTH = <span class="hljs-number"><span class="hljs-number">10</span></span>%) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> MyDB <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> dbo.Dates (DayDate DATETIME, Month_Num <span class="hljs-built_in"><span class="hljs-built_in">SMALLINT</span></span>, Month_Name <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">50</span></span>), Year_Num <span class="hljs-built_in"><span class="hljs-built_in">SMALLINT</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (DayDate)) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> dbo.Dates (DayDate, Month_Num, Month_Name, Year_Num) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-string"><span class="hljs-string">'20130101'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20130201'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20130301'</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20130401'</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20130501'</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20130601'</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20130701'</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20130801'</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20130901'</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20131001'</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20131101'</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>), (<span class="hljs-string"><span class="hljs-string">'20131201'</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">2013</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> dbo.Regions (Region_Id <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span>, Region_Name <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">250</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (Region_Id)) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> dbo.Regions (Region_Id, Region_Name) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> dbo.SKU (SKU_Id <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span>, SKU_Name <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">250</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (SKU_Id)) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> dbo.SKU (SKU_Id, SKU_Name) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> dbo.Plan_Sale (DayDate DATETIME, Region_Id <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span>, SKU_Id <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span>, Sum_Sale MONEY, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (DayDate, Region_Id, SKU_Id)) <span class="hljs-keyword"><span class="hljs-keyword">GO</span></span></code> </pre> <br></div></div><br><br><img src="https://habrastorage.org/getpro/habr/post_images/05f/4ef/745/05f4ef74551d2beab7f6ac6b460c967a.png"><br><br>  <i>Create a cube.</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/134/cb5/735/134cb573536625e9be1670648ba5fa8e.png"><br><hr><br><br>  <i>Activate Write Back for the partition, specify the data source and the table.</i>  <i>Process the cube.</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/d60/4e7/63b/d604e763b3db4d2f94f8a580cc358ba1.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a9e/def/bd6/a9edefbd6b4366111ca1d4709487b0f5.png"><br><br>  <i>This is how the table will look in the database:</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/df3/c51/0b1/df3c510b158b97cc5147bede4d1fda1b.png"><br><br>  Do not change anything in its structure - the writeback may break.  The changes correcting the initial value will fall into this table.  To get the real value, the data from this table must be added to the data from the original table. <br><br>  As a client, we use Excel.  Prior to Excel version 14.0, you had to write data using a macro, or in version 13.0, add-in (AddIn).  Starting with Excel 2010, the ability to edit data has become part of the functionality.  Two data writing modes are supported: temporary writeback, also known as What If Analysis, and permanent writeback. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d02/e9c/8a7/d02e9c8a7859a531099ed7209859c4eb.png"><br><br><ol><li>  Connect the data source.  In the pivot table, enable these options. <br><img src="https://habrastorage.org/getpro/habr/post_images/ea5/4ae/709/ea54ae709d5420168d56d8836ac77324.png"><br></li><li>  From inside the pivot table that is connected to the cube, click the <b>Work with</b> Pivot Tables tab. <br><img src="https://habrastorage.org/getpro/habr/post_images/4e3/419/6e5/4e34196e5ffba1edb2a73bf695bfda81.png"><br></li><li>  Find the <b>what-if analysis</b> group <b>.</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/dc8/827/61c/dc882761c61e48ab5b8cd990b7641624.png"><br></li><li>  This group has an <b>Enable what-if analysis</b> menu item.  When enabled, it will be possible to enter data into the data area of ‚Äã‚Äãthe pivot table. <br></li><li>  The data you enter will be highlighted with a marker in the lower right corner of the cell.  These data do not get anywhere yet and do not affect the other indicators in the cube. <br><img src="https://habrastorage.org/getpro/habr/post_images/231/298/28f/23129828f37a3f3045265cace36bff19.png"><br></li><li>  6. After making a portion of the data, in the <b>‚Äúwhat if‚Äù analysis</b> group menu <b>,</b> select <b>Accounting changes when calculating the pivot table</b> ‚Äî all fields that depend on the values ‚Äã‚Äãyou enter will be <b>updated</b> (you can turn on the <b>changes automatically when calculating the pivot table</b> , then after each input value data will be updated).  This item can be skipped and immediately publish changes (p.6). <br><img src="https://habrastorage.org/getpro/habr/post_images/8ce/e61/29c/8cee6129cfb34a50e6772364aa025dbd.png"><br></li><li>  After you have taken into account the changes, you must click <b>Publish changes</b> , otherwise the data <u>will not fall into the permanent storage tables and will be lost</u> .  After the publication of the change, the marker in the lower right corner of the cell disappears, the data will be saved in the database. <br></li></ol><br><br>  <i>Let's see what is in our Write Back table in the database:</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/418/076/5f4/4180765f415642cbef1b6d1b450ca5c4.png"><br><br><h5>  Conclusion </h5><br>  The distribution of data can be more complex, for example: the user enters data at the top level of the hierarchy, and the data is distributed into leaf elements using the coefficients set in the leaf elements.  It will all depend on your imagination and tasks. <br>  This is such a simple and most importantly common budgeting tool for a simple user.  Easy to use and quick to set up.  I will answer all questions - write! <br>  <a href="https://www.dropbox.com/sh/m14fu7joosq2u01/s7ywGALsDe">Link to used files</a> . </div><p>Source: <a href="https://habr.com/ru/post/198098/">https://habr.com/ru/post/198098/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../198084/index.html">Coursmos. The first platform for learning in micro-course format</a></li>
<li><a href="../198086/index.html">3CX Phone System 12 Service Pack 2 released</a></li>
<li><a href="../198092/index.html">How we prey on authors - confession publisher</a></li>
<li><a href="../198094/index.html">Time management: a simple experiment</a></li>
<li><a href="../198096/index.html">IB far and wide on ZeroNights</a></li>
<li><a href="../198100/index.html">ActiveRecord and transaction rollback in Yii</a></li>
<li><a href="../198102/index.html">We control the webcam with the joystick</a></li>
<li><a href="../198104/index.html">Under the hood at Dictionary and ConcurrentDictionary</a></li>
<li><a href="../198106/index.html">Old, kind ‚ÄúThe Matrix‚Äù or visualizer for matrix version one</a></li>
<li><a href="../198108/index.html">ICMP port knocking in OpenWRT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>