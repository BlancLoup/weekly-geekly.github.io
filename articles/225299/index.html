<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>KernelCare: patch the kernel on the fly</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The server on which the Linux system is installed and properly configured can not be shut down or restarted for months. However, sooner or later it st...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>KernelCare: patch the kernel on the fly</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/0da/843/66e/0da84366edb246f2c696a3b81d67d890.jpg" width="100%" height="100%"><br><br>  The server on which the Linux system is installed and properly configured can not be shut down or restarted for months.  However, sooner or later it still has to be done: for example, to install kernel updates.  This procedure is often a separate headache for the system administrator.  To reboot, you need to select the time when user activity is minimal.  All users need to pre-send warning letters.  In addition, there is always the risk of an extraordinary situation, due to which downtime servers can be delayed. <br><a name="habracut"></a><br>  There are special software solutions with which you can install patches and kernel updates without rebooting.  As an example, first of all you need to give <a rel="nofollow" href="https://www.ksplice.com/">Ksplice</a> - a product of Oracle, distributed under the GPL v.2 license.  It supports the following Linux distributions: Oracle, Linux, RHEL, Ubuntu (desktop versions only), and Fedora.  In general, Ksplice copes with the tasks assigned to it, but it has one drawback: it may not work with all existing security patches. <br><br>  In early 2014, the developers of RedHat Enterpise Linux offered their solution - <a rel="nofollow" href="http://rhelblog.redhat.com/2014/02/26/kpatch/">Kpatch</a> .  The product is distributed under the GPL2 license;  his original move is <a rel="nofollow" href="https://github.com/dynup/kpatch">posted on github</a> .  Unfortunately, today it is in an extremely ‚Äúraw‚Äù state and cannot be recommended for use.  The same can be said for <a rel="nofollow" href="https://www.suse.com/communities/conversations/kgraft-live-kernel-patching/">now</a> about <a rel="nofollow" href="https://www.suse.com/communities/conversations/kgraft-live-kernel-patching/">kGraft</a> , the solution being developed by the creators of SUSE. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Most recently, our partners from the company CloudLinux (we have already written about their main development - the <a href="http://blog.selectel.ru/cloudlinux-razdelyaj-i-vlastvuj/">same name of the operating system</a> ) offered their own tool with which you can install security patches and updates related to critical errors on the fly without rebooting the server .  It is called <a rel="nofollow" href="http://www.kernelcare.com/">KernelCare</a> . <br><br>  CloudLinux developers carefully monitor all information about kernel vulnerabilities.  As soon as ‚Äúweak spots‚Äù are detected in any of the supported kernels, they prepare a patch with which they can be fixed.  Patches (each of them is specially ‚Äúsharpened‚Äù for the core of a particular distribution) are placed on distribution servers.  The KernelCare agent installed on the client server periodically contacts the distribution servers, downloads and installs all new patches.  All this happens in the background;  server does not need to restart. <br>  The first articles, announcements about KernelCare appeared on the Internet in early 2014.  Starting this month, the product is distributed on a paid subscription, but anyone can install a test version for free.  The validity of the test license is 15 days. <br><br>  The following Linux distributions are currently supported (KernelCare only works with 64-bit OS): <br><ul><li>  RedHat 6.x; </li><li>  CentOS 6.x; </li><li>  CloudLinux 6.x. </li></ul><br><br>  Since April of this year, OpenVZ cores are supported.  By July, it is planned to implement support for Debian and Ubuntu. <br><br><h2>  We test KernelCare </h2><br>  <i>/ Testing was performed on CentOS 6 /</i> <br><br>  Install the kernelcare test version using the following command: <br><br><pre> # rpm -i http://patches.kernelcare.com/kernelcare-latest.el6.x86_64.rpm
</pre><br><br>  Immediately after installation, KernelCare automatically downloads and applies the necessary updates.  After that, a message is displayed on the console: <br><br><pre> Downloading updates
 Patch Level 9 applied
 Kernel is safe
</pre><br><br>  You can view the list of applied patches using the command: <br><br><pre> # / usr / bin / kcarectl --info

 kpatch-state: patch is applied
 kpatch-for: Linux version 2.6.32-358.23.2.el6.x86_64 (mockbuild@c6b9.bsys.dev.centos.org) (gcc version 4.4.7 20120313 (Red Hat 4.4.7-3) (GCC)) # 1 SMP Wed Oct 16 18:37:12 UTC 2013
 kpatch-build-time: Mon May 12 23:50:58 2014
 kpatch-description: 9
</pre><br><br>  With detailed information about everything KernelCare does, you can also use the dmesg command: <br><br><pre> # dmesg | grep 'kcare'

 kcare: registered device with node 10:57
 kcare: allocated 278112 bytes for patch at ffffc900005c4000
 kcare: verifying patch ...
 kcare: verified successfully
 kcare: allocating memory in module space ...
 kcare: allocated 278112 bytes at ffffffffa0207000
 kcare: 865 relocations to fixup ...
 kcare: fixed 865 relocations
 kcare: jumping to ffffffffa020d9a0
 kcare: registered device with node 10:57
 kcare: allocated 278112 bytes for patch at ffffc900005c4000
 kcare: verifying patch ...
 kcare: verified successfully
 kcare: allocating memory in module space ...
 kcare: allocated 278112 bytes at ffffffffa0207000
 kcare: 865 relocations to fixup ...
 kcare: fixed 865 relocations
</pre><br><br>  KernelCare checks for new patches every 4 hours.  All patches are downloaded and applied automatically.  Automatic update can be disabled.  To do this, open the configuration file / etc / sysconfig / kcare.  The file contains one single parameter - AUTO_UPDATE.  Its value should be changed from True to False: <br><br><pre> AUTO_UPDATE = False
</pre><br><br>  When automatic update is disabled, you can download and apply a new patch using the command: <br><br><pre> / usr / bin / kcarectl --update

 Updates already downloaded
 Patch Level 9 applied
 Kernel is safe
</pre><br><br>  All applied changes can be rolled back with the command: <br><pre> kcaretl --unload

 Updates already downloaded
 KernelCare protection disabled
</pre><br><br><h2>  Conclusion </h2><br>  KernelCare is a really handy and useful tool.  Among its undoubted merits are: <br><br><ul><li>  easy installation and configuration; </li><li>  the speed of loading and application of patches; </li><li>  no impact on system performance; </li><li>  the ability to roll back the changes made. </li></ul><br><br>  CloudLinux developers are improving and improving the product, and there is every reason to hope that in the near future it will become more widespread and will find its well-deserved popularity among system administrators. <br><br>  Readers who for one reason or another cannot leave comments here are invited to discuss an article <a href="http://blog.selectel.ru/kernelcare-patchim-yadro-na-letu/">in our blog</a> . </div><p>Source: <a href="https://habr.com/ru/post/225299/">https://habr.com/ru/post/225299/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225289/index.html">My latest file uploader</a></li>
<li><a href="../22529/index.html">Web 2.0 is linking people ...</a></li>
<li><a href="../225291/index.html">Encoding x264 + Vorbis</a></li>
<li><a href="../225293/index.html">Trisection angle and other tasks on the construction</a></li>
<li><a href="../225297/index.html">Meet Swift!</a></li>
<li><a href="../2253/index.html">You can buy Windows Vista from today</a></li>
<li><a href="../22530/index.html">test</a></li>
<li><a href="../225301/index.html">Russian Robotics Olympiad - hurry to take part!</a></li>
<li><a href="../225303/index.html">DevConf :: Ruby - June 14 - the program is generated</a></li>
<li><a href="../225305/index.html">Accelerate the development process with Vagrant</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>