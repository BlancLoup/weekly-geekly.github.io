<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I created a magic piano</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the Hackspace robot technology park ‚Äú Navigator Campus ‚Äù, they often receive orders for technical development, one of such small but interesting de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I created a magic piano</h1><div class="post__text post__text-html js-mediator-article">  In the Hackspace robot technology park ‚Äú <a href="https://vk.com/navigatorcampus">Navigator Campus</a> ‚Äù, they often receive orders for technical development, one of such small but interesting developments will be discussed in this article. <br><br><img src="https://habrastorage.org/files/f63/017/555/f630175556d1403b921ce78fac12ec05.jpg"><br><a name="habracut"></a><br>  Once, <a href="https://vk.com/kramin">Artem Kramin</a> (co-founder of free space for Dial in Kazan) addressed us with the idea of ‚Äã‚Äãthe quest project ‚Äú <a href="https://vk.com/komnataquest">Room</a> ‚Äù.  He wanted to bring a certain element of magic into his quest and to modernize the old piano for this.  The task was set as follows: when playing the correct melody, the door in the next room should open. <br><br>  The functionality of the instrument and its sonority should not suffer in the process of modernization, nothing should interfere with the extraction of sound.  An important requirement is that a musical instrument should not have changes in its appearance, so that the quest participant would not have guessed anything ahead of time. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the process of thinking born solutions such as: <br><ul><li>  microphone use </li><li>  infrared camera </li><li>  buttons or limit switches </li></ul><br><br>  Practically everyone who was interested in the process of developing a miracle instrument was sure that a microphone was used, but the option with it quickly disappeared, because a person who has never had an affair with a piano can play a melody, which means that the melody cannot be played evenly, plus upset, and using the camera was too expensive and time consuming to implement, and hiding it from the participants would be another problem.  In the end, the choice fell on the limit switches. <br><br>  This is the general scheme of the device: <br><img src="https://habrastorage.org/files/5a6/ddc/43d/5a6ddc43d22a4e04ad9292e5a9298078.png"><br><br>  To install the trailers, I drew and cut a frame for fastening in our laser hackspace on a laser cut. <br><br><div class="spoiler">  <b class="spoiler_title">The process of cutting the version of Google Car</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/480/4e8/f4e/4804e8f4e4e348239d316c0dc50e71e9.gif"><br></div></div><br>  The mount is a single element mounted on the guides inside the piano. <br><img src="https://habrastorage.org/files/b17/363/c65/b17363c657414824a23536d10d078a89.jpg"><br><br>  After that I soldered the wires to the limit switches (later it turned out that the red wire could be removed) <br><img src="https://habrastorage.org/files/6c9/c69/993/6c9c699933a0488ba11525847d3dcb47.jpg"><br><br>  Then I bought an EM lock, power supply and power button. <br>  All that I purchased checked for performance. <br><img src="https://habrastorage.org/files/aca/27e/a61/aca27ea612414c88a96923c438a11813.jpg"><br><br><img src="https://habrastorage.org/files/531/0dd/fce/5310ddfcefe2420aae20d3d55d32fc61.jpg"><br><br><img src="https://habrastorage.org/files/a90/6ca/83d/a906ca83d405464c822f46738bc4ca43.jpg"><br><br>  Then I installed and soldered all the necessary circuit elements, it looks rough, but it has been working for a month and a half without failures. <br><img src="https://habrastorage.org/files/952/c29/f32/952c29f3262145209df90efbfa2fdfea.jpg"><br><br><img src="https://habrastorage.org/files/f45/16d/953/f4516d95306140449b40505bf2598d36.jpg"><br><br>  So here is the device assembly. <br><img src="https://habrastorage.org/files/75d/a2f/ff3/75da2fff3f1c4e59bce3cae268fa1af5.jpg"><br><br><img src="https://habrastorage.org/files/2cd/bf0/6ba/2cdbf06ba63040d5b1cb36ed488e02ee.jpg"><br><br>  The whole scheme of work is this: the system is constantly waiting for the first right key to be pressed, then waiting for the second right note, and so on.  In a situation where the quest participant makes a mistake and presses the wrong note, the combination is reset and the ‚Äúcode‚Äù must be dialed again, and if the whole melody is played correctly, the lock opens, locking the room door. <br><br><div class="spoiler">  <b class="spoiler_title">Sketch Sources</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> key1 = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-comment"><span class="hljs-comment">// const int key2 = 5; // const int key3 = 6; // const int key4 = 7; // const int key5 = 8; // const int key6 = 9; // const int key7 = 10; // const int lock = 12; // int lastKey = 0; //   //   void openLock() { digitalWrite(lock, LOW); delay(10000); closeLock(); } //  void closeLock() { digitalWrite(lock, HIGH); } //    key boolean isKeyPressed(int key) { int what = -1; while(true) { int countPressed = 0; if(digitalRead(key1) == HIGH) { if(lastKey != key1) { countPressed++; what = key1; lastKey = key1; } } if(digitalRead(key2) == HIGH) { if(lastKey != key2) { countPressed++; what = key2; lastKey = key2; } } if(digitalRead(key3) == HIGH) { if(lastKey != key3) { countPressed++; what = key3; lastKey = key3; } } if(digitalRead(key4) == HIGH) { if(lastKey != key4) { countPressed++; what = key4; lastKey = key4; } } if(digitalRead(key5) == HIGH) { if(lastKey != key5) { countPressed++; what = key5; lastKey = key5; } } if(digitalRead(key6) == HIGH) { if(lastKey != key6) { countPressed++; what = key6; lastKey = key6; } } if(digitalRead(key7) == HIGH) { if(lastKey != key7) { countPressed++; what = key7; lastKey = key7; } } if(what != -1) { Serial.print("pressed "); Serial.println(what - 3); if((countPressed == 1) &amp;&amp; (key == what)) { break; } if((key != what) || (countPressed &gt;= 1)) { break; } } } if(what == key) { return true; } else { return false; } } void setup() { // pinMode(test,INPUT); Serial.begin(9600); pinMode(key1, INPUT); pinMode(key2, INPUT); pinMode(key3, INPUT); pinMode(key4, INPUT); pinMode(key5, INPUT); pinMode(key6, INPUT); pinMode(key7, INPUT); pinMode(lock, OUTPUT); closeLock(); } //         void loop() { if(isKeyPressed(key2)) { if(isKeyPressed(key3)) { if(isKeyPressed(key6)) { if(isKeyPressed(key2)) { if(isKeyPressed(key4)) { if(isKeyPressed(key6)) { if(isKeyPressed(key1)) { if(isKeyPressed(key7)) { openLock(); } } } } } } } } }</span></span></code> </pre> <br></div></div><br>  After all the preparations, the device was installed in the piano, and the lock is fixed in the doorway (in which secret). <br><img src="https://habrastorage.org/files/1e0/4c6/03f/1e04c603f2474593bee32c0302381c5c.jpg"><br><br><img src="https://habrastorage.org/files/53a/ebd/bba/53aebdbba8ec440a8708da0fabe4e48b.jpg"><br><br><img src="https://habrastorage.org/files/d43/09c/704/d4309c704a404095ba8066e2472e6edd.jpg"><br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/u-21AHjAtzY%3Ffeature%3Doembed&amp;xid=25657,15700023,15700186,15700190,15700253&amp;usg=ALkJrhh0MnKYMeukmhTqMP_kTbGPhJVK0w" frameborder="0" allowfullscreen=""></iframe><br><br>  Bottom line: Artyom was pleased, but I was interested in doing something unusual. <br>  PS Readers from Kazan, even after reading this article, will be interested in completing the quest, because the magic piano is only a small part of the <a href="https://vk.com/komnataquest">Room</a> magic. <br><img src="https://habrastorage.org/files/ecd/0c9/375/ecd0c9375a9f44f09c395e14bacbdce2.jpg"></div><p>Source: <a href="https://habr.com/ru/post/232025/">https://habr.com/ru/post/232025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../232015/index.html">Javascript to typeScript - translation difficulties</a></li>
<li><a href="../232017/index.html">Useful materials for mobile developer # 64 (June 28-August 3)</a></li>
<li><a href="../232019/index.html">Krita: Four-Point Perspective Transformations</a></li>
<li><a href="../232021/index.html">T-shirt printer: from home crafts to serial models of textile printer</a></li>
<li><a href="../232023/index.html">Directive Controllers in AngularJS</a></li>
<li><a href="../232029/index.html">Video experiments in physics and augmented reality for schools</a></li>
<li><a href="../232033/index.html">Control access to electronic documents. From DefView to Vivaldi</a></li>
<li><a href="../232037/index.html">As we wrote the iOS library to work with the Wargaming API</a></li>
<li><a href="../232039/index.html">Overview of the most interesting materials on data analysis and machine learning ‚Ññ7 (July 28 - August 4, 2014)</a></li>
<li><a href="../232041/index.html">Enlarge your pension size or your own financial adviser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>