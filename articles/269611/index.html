<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Platform "1C: Enterprise" - what's under the hood?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 
 In this article we will begin the story about how the 1C: Enterprise 8 platform is built inside and what technologies are used in its deve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Platform "1C: Enterprise" - what's under the hood?</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr! <br>  In this article we will begin the story about how the <a href="http://v8.1c.ru/overview/Platform.htm">1C: Enterprise 8 platform is</a> built inside and what technologies are used in its development. <br><br><img src="https://habrastorage.org/files/2ad/a84/9e2/2ada849e24ed496282f813539b750f7d.png" alt="image"><br><br>  Why do we think this is interesting?  First, because the ‚Äú1C: Enterprise 8‚Äù platform is a large (more than 10 million lines of code) application in C ++ (client, server, etc.), JavaScript (web client), and, more recently, and <a href="http://www.1c.ru/news/info.jsp%3Fid%3D19821">java</a> .  Large projects are interesting, if only by virtue of scale, because the issues invisible in a small code base in such projects stand in full growth.  Secondly, ‚Äú1C: Enterprise‚Äù is a replicable, ‚Äúboxed‚Äù product, and there are very few articles about such developments on Habr√©.  And it is always interesting to find out how they live in other teams and firms. <br><a name="habracut"></a><br>  So let's get started.  In this article we will give an overview of some technologies that are used in the platform, outline the landscape, without deep immersion in the implementation.  After all, for many mechanisms a detailed story will pull on a separate article, and for some - on a whole book! <br>  To begin with, it‚Äôs worth deciding on the basic things - what is the 1C: Enterprise platform and what components it consists of.  The answer to this question is not so simple, because the term ‚ÄúPlatform‚Äù (for brevity, we will call it that way) is understood both as a tool for developing business applications, and an execution environment, and means of administration.  Conventionally, the following components can be identified: <br><ul><li>  server cluster </li><li>  ‚ÄúThin‚Äù client capable of connecting to the server via http and its own binary protocol </li><li>  client for working in a two-tier architecture with a database located on a hard disk or network folder </li><li>  web client </li><li>  application server administration tools </li><li>  development environment (known as Configurator) </li><li>  Runtime for iOS, Android and Windows Phone (1C mobile platform) </li></ul><br>  All of these parts, with the exception of the web client, are written in C ++.  In addition, there is a recently announced <a href="http://www.1c.ru/news/info.jsp%3Fid%3D19821">new generation Configurator</a> written in Java. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Native applications </h3><br>  C ++ 03 is used to develop native applications.  Under Windows, Microsoft Visual C ++ 12 (a profile compatible with Windows XP) is used as a compiler, and under Linux and Android - gcc 4.8, for iOS - clang 5.0.  The standard library is used uniformly for all OS and compilers - STLPort.  This solution reduces the likelihood of errors specific to the implementation of STL.  Now we are planning to switch to the implementation of STL supplied with CLang, since STLPort has stopped its development and is incompatible with C ++ 11 support mode enabled in gcc. <br>  At the same time, the code base of the server is 99% common, and the client's percentage is 95%.  Moreover, even the mobile platform uses the same C ++ code as the ‚Äúbig‚Äù one, although there the percentage of unification is somewhat lower. <br>  Like most C ++ users, we do not claim to use 100% of the capabilities of the language and its libraries.  So, at us Boost is practically not used, and from language possibilities - dynamic type conversion.  In this case, we actively use: <br><ul><li>  STL (in particular, strings, containers and algorithms) </li><li>  multiple inheritance, incl.  multiple inheritance implementation </li><li>  templates </li><li>  exceptions </li><li>  smart pointers (own implementation) </li></ul><br>  Due to the use of multiple inheritance of interfaces (completely abstract classes), the component model becomes possible, which will be discussed below. <br><br><h3>  Components </h3><br>  To ensure modularity, all functionality is divided into components, which are dynamic libraries (* .dll under Windows, * .so - under Linux).  In total components more than one and a half hundreds, we will provide descriptions of some of them: <br><table><tbody><tr><td width="100">  backend </td><td>  Contains the "engine" platform metadata </td></tr><tr><td>  accnt </td><td>  Objects that application developers use to build accounting (charts of accounts and accounting registers) </td></tr><tr><td>  bsl </td><td>  Integrated language performance engine </td></tr><tr><td>  nuke </td><td>  Own implementation of memory allocator </td></tr><tr><td>  dbeng8 </td><td>  File database engine.  A simple file server-based database engine based on ISAM, which also includes a simple SQL processor. </td></tr><tr><td>  wbase </td><td>  Contains the base classes and functions for implementing the Windows user interface ‚Äî window classes, GDI access, and so on. </td></tr></tbody></table><br>  Separating into many components is useful from several points of view: <br><ul><li>  Separation promotes better design, in particular better code isolation. </li><li>  From the set of components, you can flexibly assemble various delivery options: <br><ul><li>  For example, a thin client installation will contain wbase, but there will be no backend </li><li>  on the contrary, wbase will not be available </li><li>  both options will of course contain nuke and bsl </li></ul></li></ul><br>  All the necessary components for this launch option are loaded when the program starts.  This, in particular, is necessary for registering SCOM classes, which will be discussed below. <br><br><h3>  Scom </h3><br>  For decomposition at a lower level, the SCOM system is used - ideologically similar to ATL library.  For those who did not work with ATL, briefly list the main features and features. <br>  For the specially designed SCOM class: <br><ul><li>  Provides factory methods that allow you to create a class from another component, knowing only its name (without disclosing the implementation) </li><li>  Provides an infrastructure of smart pointers with reference counting.  There is no need to manually monitor the lifetime of the SCOM class. </li><li>  Allows you to find out if an object implements a specific interface and automatically bring a pointer to an object to an interface pointer </li><li>  Create a service object, always accessible via the get_service method, etc. </li></ul><br>  For example, you can describe in the json.dll component a class for reading JSON (for example, JSONStreamReader). <br>  Classes, instances can be created from other components you need to register in the SCOM machine: <br><pre><code class="cpp">SCOM_CLASS_ENTRY(JSONStreamReader)
</code></pre><br>
     -,         .<br>
        :<br>
<pre><code class="cpp">IJSONStreamReaderPtr jsonReader = create_instance&lt;IJSONStreamReader&gt;(SCOM_CLSIDOF(JSONStreamReader));
</code></pre><br>
   SCOM  ,   .      SCOM-,       (..   Service Locator),       . SCOM     .         :<br>
<pre><code class="cpp">SCOM_Process* process = core::current_process();
if (process)
         return get_service&lt;IMyService&gt;(process);
</code></pre><br>
,    (SCOM)    ,          ,     .     ,     ‚Äî       SCOM-,    ,   ‚Äî  .      ,        ,    ¬´¬ª - .     ‚Äî  ,   ,    .<br>
 <br>
    SCOM   -    1: .<br>
<br>
<h3> </h3><br>
,  .      Windows,       Windows API.  Linux-  ,    wxWidgets.<br>
        ¬´1:¬ª         .<br>
 <br>
   1:    ,        ,  2009 ,    8.2   ¬´ ¬ª.    ,      ‚Äî         flow- .  ,           ,    DTO (<a href="https://ru.wikipedia.org/wiki/DTO">Data Transfer Objects</a>).<br>
    - ¬´1:¬ª,  ++    JavaScript.          .   ,   , , -    JavaScript API (,      ),         ,   C++.      Internet Explorer  Microsoft Edge (Windows), Google Chrome(Windows), Firefox (Windows  Linux)  Safari (MacOS).<br>
 <br>
 ,            1.         ¬´¬ª    ,             ,    ¬´¬ª  ¬´1:¬ª.<br>
<br>
<img src="https://habrastorage.org/files/7de/29c/1a2/7de29c1a26e74ed1ad6a0aa7a0d3f9e4.png" alt="image"><br>
<i> 1   Linux</i><br>
<br>
<img src="https://habrastorage.org/files/7dd/8eb/dd6/7dd8ebdd666f47568b6cc6a83540cfcb.png" alt="image"><br>
<i> 1   </i><br>
<br>
<div class="spoiler"><b class="spoiler_title"> 1   </b><div class="spoiler_text"> <img src="https://habrastorage.org/files/90f/123/1b2/90f1231b216d46529283f019e54e5398.png" alt="image"><br>
 <i> 1   Windows</i><br>
<br>
<img src="https://habrastorage.org/files/ada/640/505/ada640505881431b8f2accd88d27a80d.png" alt="image"><br>
 <i> 1 ‚Äî -</i><br>
</div></div><br>
<br>
<h3>Open source</h3><br>
       ++    Windows (MFC,   WinAPI),      .    <a href="http://www.wxwidgets.org/">wxWidgets</a>,    :<br>
<ul>
<li><a href="http://curl.haxx.se/libcurl/">cURL</a>    HTTP  FTP. </li>
<li><a href="http://openssl.org/">OpenSSL</a>       TLS </li>
<li><a href="http://www.xmlsoft.org/">libxml2  libxslt</a>   XML</li>
<li><a href="https://github.com/dinhviethoa/libetpan">libetpan</a>      (POP3, SMTP, IMAP)</li>
<li><a href="http://www.codesink.org/mimetic_mime_library.html">mimetic</a>     </li>
<li><a href="http://www.sqlite.org/">sqllite</a>     </li>
<li><a href="http://site.icu-project.org/">ICU</a>  </li>
</ul><br>
   .<br>
 ,      <a href="http://code.google.com/p/googletest/">Google Test</a>  <a href="http://code.google.com/p/googlemock/">Google Mock</a>   -.<br>
      SCOM-  .<br>
 1           .             .           .     .<br>
 <a href="http://curl.haxx.se/libcurl/">cURL</a>  <a href="https://github.com/dinhviethoa/libetpan">libetpan</a>    pull-request,  , ,  <a href="http://openssl.org/">OpenSSL</a>      .<br>
<br>
<h3></h3><br>
         ¬´1: ¬ª.         ,   , . <br>
       <a href="http://v8.1c.ru/overview/Platform.htm"></a>.<br>
        ?<br>
<br>
    1?<br>
   -? <br>
,  ,        ,   ?<br>
 <br>
  !</div><p>Source: <a href="https://habr.com/ru/post/269611/">https://habr.com/ru/post/269611/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269599/index.html">Search for uninitialized class members</a></li>
<li><a href="../269601/index.html">Step-by-step work GOST R 34.12-2015 in ECB mode</a></li>
<li><a href="../269603/index.html">Turn a group of surveillance cameras into a botnet? Nothing is easier</a></li>
<li><a href="../269607/index.html">Fujitsu ETERNUS CD10000 S2: what's new?</a></li>
<li><a href="../269609/index.html">The book "Programming Arduino: Basics of working with sketches"</a></li>
<li><a href="../269613/index.html">Updated Codebattle: a game for programmers</a></li>
<li><a href="../269615/index.html">Analyze it: how to get additional benefit from client logs</a></li>
<li><a href="../269619/index.html">Introduction to working with ORTC in Microsoft Edge</a></li>
<li><a href="../269621/index.html">Duke, take out the trash! - Part 1</a></li>
<li><a href="../269625/index.html">VII Hi-Tech Tour "Cloudy Oktoberfest". How it was?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>