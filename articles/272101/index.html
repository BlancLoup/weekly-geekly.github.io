<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SQLi is still in service</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For hacking TalkTalk, which led to the theft of personal data of about 150,000 users, a vulnerability was discovered that was discovered even before i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SQLi is still in service</h1><div class="post__text post__text-html js-mediator-article">  For hacking TalkTalk, which led to the theft of personal data of about 150,000 users, a vulnerability was discovered that was discovered even before its birth.  This attack method was SQL injection (SQLi).  In this type of attack, hackers usually enter malicious commands into forms on a website in order to force the site database to provide the necessary data. <br><br><img src="https://habrastorage.org/files/b81/d15/b5c/b81d15b5c854499794cc611b60fb8a8b.jpg"><br><br>  This method was used to steal personal data of employees of the World Health Organization, the theft of the Wall Street Journal data and hacking the websites of US federal agencies. <blockquote>  This is the easiest way to hack the site. </blockquote>  This is an expression of one of the hackers, known under the pseudonym w0rm and responsible for hacking the Wall Street Journal.  The invasion then took only a few hours. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For all its simplicity, SQLi at the same time is highly efficient for obtaining digital data of corporations and even government sites. <br><br>  SQL injections were a scourge for the Internet era.  Year after year, they are referred to as one of the best security vulnerabilities responsible for countless data theft on the Internet. <br><br>  Jeff Forristal was probably the very first to publish a hacking <a href="http://phrack.org/issues/54/8.html">instruction</a> and how to protect a server on Windows NT using SQL injections in the Phrack hacker log.  Jeff is currently heading the cybersecurity director position at BlueBOX Security. <br><br><img src="https://habrastorage.org/files/5f5/609/76f/5f560976fac447a1a0e85baa4301ed45.jpg"><br><br>  SQL or Structured Query Language is a programming language used to manage databases.  In essence, it is used when the site has to call a piece of information from its database, or process it or present it to the user.  But Forristal concluded that entering certain commands would force the server to show the information stored on it. <blockquote>  People can combine SQL commands. </blockquote><br>  In the December 1998 issue of Phrack, Forristal wrote about a series of problems with the Microsoft SQL server version.  When Forristal's colleague reported this to Microsoft, <blockquote>  Their response was quite funny. </blockquote><blockquote>  The fact that you can read it does not carry any threat, so do not worry and take hasty measures to stop it. </blockquote>  More than 15 years after this vulnerability was publicly described, SQLi repeatedly won first place in the Top 10 vulnerabilities from OWASP, which appeared every three years.  The Open Web Application Security Project (OWASP) is a non-profit organization that tracks the various threats that websites face. <br><br><img src="https://habrastorage.org/files/c89/305/ead/c89305eadddc4d9c8feb916612ea89e8.jpg"><br><br>  SQL injections are still the number one risk for many web projects. <blockquote>  When you go to a web page, you execute a query that is analyzed and after that you are provided with the data in accordance with the query. </blockquote>  A small example is when an application uses unreliable data in building a subsequent call to vulnerable SQL: <br><pre><code class="php hljs">String query = <span class="hljs-string"><span class="hljs-string">"SELECT * FROM accounts WHERE custID='"</span></span> + request.getParameter(<span class="hljs-string"><span class="hljs-string">"id"</span></span>) + <span class="hljs-string"><span class="hljs-string">"'"</span></span>;</code> </pre> <br>  Likewise, blind trust from an application to the platforms can lead to vulnerable requests. <br>  For example, Hibernate Query Language (HQL): <br><pre> <code class="php hljs">Query HQLQuery = session.createQuery(‚ÄúFROM accounts WHERE custID=<span class="hljs-string"><span class="hljs-string">'‚Äú + request.getParameter("id") + "'</span></span><span class="hljs-string"><span class="hljs-string">");</span></span></code> </pre><br>  In both cases, the attacker modifies the value of the ‚Äúid‚Äù parameter in the browser to send: 'or' 1 '=' 1. <br>  For example: <br><pre> <code class="php hljs">http:<span class="hljs-comment"><span class="hljs-comment">//example.com/app/accountView?id=' or '1'='1</span></span></code> </pre><br>  This changes the meaning of both requests, which makes it necessary to give all the records from the table of accounts.  More dangerous attacks may alter data or even trigger stored procedures. <br><br>  One-time attack can provide one piece or section of information, which means that the attacker will need to repeat such requests until he receives all the data from the database.  Naturally, this approach takes a lot of time.  Thus, hackers can use tools that automate this process by executing queries instead.  <a href="http://onhax.net/havij-adv-sql-injection-tool">Havij has</a> become quite a popular script script script because it is well optimized for Windows and has a convenient GUI (graphical user interface).  The other part uses the <a href="http://sqlmap.org/">SQLMAP</a> scanner released in 2006.  But more rapidly SQLMAP began to develop only when Miroslav Shtampar, a developer from Croatia, and Bernardo Damele, an information security consultant from Italy, joined the work on it.  This scanner, like a search engine bot, searches for input forms on a web page and presents forms with data that could cause a MySQL syntax error. <br><br>  An example of how Troy Hunt (Troy Hunt), the founder of haveibeenpwned.com, teaches his son to use SQLi with Havij. <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Fp47G4MQFvA%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgoFgJrQxYPytFGGTMKxKnTFYShpg" frameborder="0" allowfullscreen=""></iframe><br><br>  Finding a victim for attack is also easy to automate.  Typically, attackers use the most popular Google search engine to search for URLs that are associated with scripts vulnerable to SQLi.  The attacker has scripts that automatically check all URLs for vulnerabilities.  This process is so simple that it can teach even a child.  There are also enough tutorials on YouTube on how to commit a SQLi attack. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/7H358PrFagc%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhglt0Nfxn5DdIjMnUsKPoYFqO8iYA" frameborder="0" allowfullscreen=""></iframe><br><br>  But there are ready-made solutions to stop SQLi attacks and they can be deployed by site developers to avoid consumer or corporate data leakage.  These solutions have existed for many years. <br><br>  One of the easiest ways to solve this problem is to use ‚Äúprepared queries‚Äù.  In this case, the SQL commands that control the database cannot be sent through the user login form. <br><br>  Prepared queries are used to perform the same (or similar) SQL queries repeatedly with high efficiency. <br><br>  Prepared queries basically work like this: <br>  <b>1.</b> Preparation: A SQL query template is created and sent to the database.  Some values ‚Äã‚Äãare not specified, are called parameters and are marked with "?".  Example: INSERT INTO MyGuests VALUES (?,?,?) <br>  <b>2. The</b> database parses, compiles and performs query optimization on the SQL query template and saves the result without executing it. <br>  <b>3.</b> Execution: Later, the application associates values ‚Äã‚Äãwith parameters and the database executes the query.  An application can execute a request as many times as required with different values. <br><br>  Compared to the execution of direct SQL queries, prepared queries have three main advantages: <br><br><ul><li>  Prepared requests reduce the time of parsing, since the preparation of a request is done only once (although the request itself can be executed several times). </li><li>  General parameters save the channel and traffic to the server, since you need to send only the parameters, and not the entire request. </li><li>  Prepared queries are very useful against SQL injections, since the values ‚Äã‚Äãof the parameters that are transmitted later using another protocol will not fully correspond to those sent.  If the original query is different from the query from the external input, the SQL injection will not be executed. </li></ul><br>  Prepared queries in MySQL <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $servername = <span class="hljs-string"><span class="hljs-string">"localhost"</span></span>; $username = <span class="hljs-string"><span class="hljs-string">"username"</span></span>; $password = <span class="hljs-string"><span class="hljs-string">"password"</span></span>; $dbname = <span class="hljs-string"><span class="hljs-string">"myDB"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Create connection $conn = new mysqli($servername, $username, $password, $dbname); // Check connection if ($conn-&gt;connect_error) { die("Connection failed: " . $conn-&gt;connect_error); } // prepare and bind $stmt = $conn-&gt;prepare("INSERT INTO MyGuests (firstname, lastname, email) VALUES (?, ?, ?)"); $stmt-&gt;bind_param("sss", $firstname, $lastname, $email); // set parameters and execute $firstname = "John"; $lastname = "Doe"; $email = "john@example.com"; $stmt-&gt;execute(); $firstname = "Mary"; $lastname = "Moe"; $email = "mary@example.com"; $stmt-&gt;execute(); $firstname = "Julie"; $lastname = "Dooley"; $email = "julie@example.com"; $stmt-&gt;execute(); echo "New records created successfully"; $stmt-&gt;close(); $conn-&gt;close(); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  In this SQL, a question mark (?) Is set where we want to place an integer, string, double, or blob value. <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"INSERT INTO MyGuests (firstname, lastname, email) VALUES (?, ?, ?)"</span></span></code> </pre><br>  Now let's look at the bind_param () function: <br><br><pre> <code class="php hljs">$stmt-&gt;bind_param(<span class="hljs-string"><span class="hljs-string">"sss"</span></span>, $firstname, $lastname, $email);</code> </pre><br>  This function binds the parameters to the SQL query and tells the database what parameters to enter.  The ‚Äússs‚Äù argument restricts the type of data that can be specified for the listed parameters. <br><br>  The argument can be one of four types: <br><br>  i - integer <br>  s - double <br>  s - string <br>  b - BLOB <br><br>  By telling MySQL what type of data to expect, we minimize the risk of SQL injection. <br><br>  Preparing a PDO request <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $servername = <span class="hljs-string"><span class="hljs-string">"localhost"</span></span>; $username = <span class="hljs-string"><span class="hljs-string">"username"</span></span>; $password = <span class="hljs-string"><span class="hljs-string">"password"</span></span>; $dbname = <span class="hljs-string"><span class="hljs-string">"myDBPDO"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $conn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PDO(<span class="hljs-string"><span class="hljs-string">"mysql:host=$servername;dbname=$dbname"</span></span>, $username, $password); <span class="hljs-comment"><span class="hljs-comment">// set the PDO error mode to exception $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); // prepare sql and bind parameters $stmt = $conn-&gt;prepare("INSERT INTO MyGuests (firstname, lastname, email) VALUES (:firstname, :lastname, :email)"); $stmt-&gt;bindParam(':firstname', $firstname); $stmt-&gt;bindParam(':lastname', $lastname); $stmt-&gt;bindParam(':email', $email); // insert a row $firstname = "John"; $lastname = "Doe"; $email = "john@example.com"; $stmt-&gt;execute(); // insert another row $firstname = "Mary"; $lastname = "Moe"; $email = "mary@example.com"; $stmt-&gt;execute(); // insert another row $firstname = "Julie"; $lastname = "Dooley"; $email = "julie@example.com"; $stmt-&gt;execute(); echo "New records created successfully"; } catch(PDOException $e) { echo "Error: " . $e-&gt;getMessage(); } $conn = null; </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br><br>  The advantage of prepared queries is that they set the semantics of the query in such a way that any input data could not dazzle the developer by including a syntax that alters an incorrect query designed to get a string that extracts data from arbitrary tables.  Another way involves using a SQL library that cares about processing incoming requests to them.  Roughly speaking, it cleans up all the data entered by the user in the query, which can be potentially dangerous. <br><br>  If SQLI is so simple that even a child can do it.  And the solutions are pretty simple.  But why then are SQLI-based attacks still successful? <br><br>  Any serious programmer should know about SQLi, but in fact finding a really good programmer in a foreign market is not an easy task.  This is confirmed by personal experience.  My friend almost a year ago went to work in a foreign project.  He considered himself to be a rather mediocre programmer (by the way, his acquaintances, IT experts, and ex-colleagues also considered his friends in the same way).  But he was pleasantly surprised that he was the best at his new job.  He is still on his project is considered a highly qualified specialist.  That is why foreign companies hire mediocre programmers, even if they have no idea about the options for mitigating basic types of vulnerability. <br><br>  But in addition to this, under the pressure of their top management, such programmers are developing more functional software, and not more secure. <br><br>  Ultimately, the responsibility for the security of these sites and the data they contain are reduced to the web developers themselves. </div><p>Source: <a href="https://habr.com/ru/post/272101/">https://habr.com/ru/post/272101/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272089/index.html">Under the hood Redis: Hash table (part 2) and List</a></li>
<li><a href="../272091/index.html">Payment conversion: 4 reasons that reduce the success of payment on your site and how to eliminate them</a></li>
<li><a href="../272093/index.html">Network equipment at risk? Let's understand ...</a></li>
<li><a href="../272095/index.html">Corporate use of Android 5.0: security recommendations</a></li>
<li><a href="../272099/index.html">PHP 7.0.0</a></li>
<li><a href="../272105/index.html">What we should parse site. Webdriver API Basics</a></li>
<li><a href="../272107/index.html">Server administration Resource Management with PowerShell</a></li>
<li><a href="../272115/index.html">Haskell "terrible" abstractions without mathematics and without code (almost). Part I</a></li>
<li><a href="../272117/index.html">PyNSK # 5 - the fifth meeting of the Novosibirsk Python community</a></li>
<li><a href="../272119/index.html">Few nice mancalas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>