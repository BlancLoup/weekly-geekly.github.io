<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to upload custom log to Splunk + logs for Fortinet</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How much data do we generate using information systems every day? Great amount! But do we know all the possibilities for working with such data? Defin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to upload custom log to Splunk + logs for Fortinet</h1><div class="post__text post__text-html js-mediator-article">  How much data do we generate using information systems every day?  Great amount!  But do we know all the possibilities for working with such data?  Definitely not!  In this article, we will describe what types of data we can load for further operational analysis in Splunk, and also show how to connect the loading of Fortinet logs and logs of non-standard structure, which must be divided into fields manually. <br><br> <a href="https://habrahabr.ru/company/tssolution/blog/353426/"><img src="https://habrastorage.org/webt/s2/66/ax/s266axf2gvvdvpmj1qvuvx2tihg.png"></a> <br><a name="habracut"></a><br>  Splunk can index data from various sources that can store logs both locally on the same machine with the Splunk indexer and on the remote device.  To collect data from remote machines, a special agent is installed on them - Splunk Universal Forwarder, which will send data to the indexer. <br><br>  Splunk offer many ready-made applications and add-ons with pre-configured settings to load a specific type of data, for example, an Add-on is for data generated by Windows, Linux, Cisco, CheckPoint, and so on.  In total, over 800 add-ons are currently created, which can be found on the <a href="https://splunkbase.splunk.com/apps/">SplunkBase</a> website. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  <font color="#0075a9">Types of data sources</font> </h2><br>  All incoming data can be divided into several groups according to their sources: <br><br>  <b>Files and directories</b> <br><br>  Most data goes to Splunk directly from files and directories.  You just need to specify the path to the directory from which you want to take data and after that it will monitor it continuously and as new data becomes available, it will be immediately uploaded to Splunk.  Further in this article we will show how this is implemented. <br><br>  <b>Network events</b> <br><br>  Splunk can also index data from any network port, such as remote syslog data or other applications that transmit data on a TCP or UDP port.  We will look at this type of data source in the example of Fortinet. <br><br>  <b>Windows sources</b> <br><br>  Splunk allows you to customize the loading of many different data <br>  Windows, such as event log, registry, WMI, Active Directory, and performance monitoring data.  In more detail about loading data from Windows to Splunk, we wrote in a previous article.  (link) <br><br>  <b>Other data sources</b> <br><br><ul><li>  Metrics </li><li>  Scripts </li><li>  Custom data loading modules </li><li>  HTTP Event Collector </li></ul><br>  Many tools have already been implemented that can load almost any of your data, but if even none of them do not suit you, you can create your own scripts or modules, which we will discuss with one of the following articles. <br><br><h2>  <font color="#0075a9">Fortinet</font> </h2><br>  In this section, we will discuss how to implement the loading of Fortinet logs. <br><br>  1. First you need to download the Add-on from the SplunkBase website at this <a href="https://splunkbase.splunk.com/app/2846/">link</a> . <br><br>  2. Next, you need to install it on your Splunk-indexer <i><b>(Apps - Manage Apps - Install app from file)</b></i> . <br><br>  3. Then we configure the reception of data on the UDP port.  To do this, go through: <i><b>Settings - Data Inputs - UDP - New.</b></i>  Specify the port, the default is 514 port. <br><br><img src="https://habrastorage.org/webt/8y/mm/ji/8ymmjixd3k886vmpwxb9wvjnsl4.png"><br><br>  We select Sourcetype: fgt_log, also we select a necessary index or we create new. <br><br><img src="https://habrastorage.org/webt/pf/im/bk/pfimbkjmqbgnr-nozw1nemcgh7y.png"><br><br>  4. Set up sending data via UDP in Fortinet itself, indicating the same port as in Splunk. <br>  5. Get data and build analytics. <br><br><img src="https://habrastorage.org/webt/bn/qx/mb/bnqxmbbhtspfowdk_nlgsmn93oq.png"><br><br><img src="https://habrastorage.org/webt/i2/o9/up/i2o9uprrlurr1cvjmvg8lp0omfs.png"><br><br><h2>  <font color="#0075a9">Custom log</font> </h2><br>  By a non-standard log, we mean a log that has an unknown sourcetype for Splunk, and therefore does not have pre-written field parsing rules.  In order to get the field values, it will be necessary to first perform several simple manipulations. <br><br>  Using this log as an example, in addition to parsing, we will show how to implement loading data from directories.  There are two development scenarios that depend on where the data lies: on the local indexer machine or on the remote machine. <br><br><h4>  <b>Local machine</b> </h4><br>  If your data is stored on your Splunk local machine, the download is very easy: <br>  <i><b>Settings - Add data - Monitor - Files &amp; Directories</b></i> <br><br><img src="https://habrastorage.org/webt/uo/vl/p9/uovlp9niep4rm9gh2difrv7clzy.png"><br><br>  Select the desired directory, if necessary, we can register Whitelist or Blacklist. <br>  Choose an index or create a new one, the rest by default. <br><br><img src="https://habrastorage.org/webt/rg/tr/jx/rgtrjxrz5afuxe-xqn3oemies1w.png"><br><br><br><h4>  <b>Remote machine</b> </h4><br>  If the directory in which the necessary data is stored is located on the remote machine, then the algorithm of action will be somewhat different.  To collect data, we need an agent on the target machine (Splunk Universal Forwarder), configured by Forwarder Management on the Splunk indexer, the sendtoindexer application, and an application that tells which directories we will be viewing. <br><br>  We described <a href="https://habrahabr.ru/company/tssolution/blog/352944/">in</a> detail how to install the agent and set up data collection from the remote machine <a href="https://habrahabr.ru/company/tssolution/blog/352944/">in the previous article</a> , so we will not repeat it and assume that you already have all those settings. <br><br>  Create a special application that will respond to the fact that the agent sends data from the specified directories. <br><br><img src="https://habrastorage.org/webt/qe/lw/tc/qelwtclkkgkdsulruon-ra6zgzi.png"><br><br>  The application is automatically saved in the <i>..splunk / etc / apps</i> folder, you need to transfer it to the <i>..splunk / etc / deployment-apps</i> folder. <br><br>  In the folder <i>..monitor / local</i> you need to place the configuration file <i><b>inputs.conf</b></i> , in which we will indicate which folders should be sent. <br>  We want to view the test folder in the root directory. <br> <code>[monitor:///test] <br> index=test <br> disabled = 0</code> <br> <br>  More information about the inputs.conf files can be found <a href="http://docs.splunk.com/Documentation/Splunk/7.0.3/admin/Inputsconf">on the official website</a> . <br><br>  Add an application to the Server Class that is related to the target machine.  How and why this should be done, we said <a href="https://habrahabr.ru/company/tssolution/blog/352944/">in the previous article</a> . <br><br>  We recall that this can be done by following the following path: <i><b>Settings - Forwarder Management.</b></i> <br><br>  In order for the data to be loaded it is necessary that there exists an index that was specified in inputs.conf, if not, then create a new one. <br><br><h4>  <b>Data parsing</b> </h4><br>  After loading we received data not divided into fields.  In order to select the fields, go to the Extract Fields menu ( <i><b>All Fields - Extract New Fields</b></i> ) <br><br><img src="https://habrastorage.org/webt/u2/gr/hc/u2grhck2mci2b9yi-d7ujia_tbg.png"><br><br>  You can parse the fields using the built-in toolkit, which, based on regular expressions, selects the fields that you specify.  Or you can write a regular expression yourself if the result of automatic work does not suit you. <br><br>  <b>Step 1.</b> Select the field <br><br><img src="https://habrastorage.org/webt/_0/8d/ch/_08dchisnaojerhsmoolbvkeks0.png"><br><br>  <b>Step 2.</b> Choose the separation method <br>  We will use regular expressions. <br><br><img src="https://habrastorage.org/webt/wa/6w/ik/wa6wikq5rmdv7ierllecwhaelik.png"><br><br>  <b>Step 3.</b> Select the values ‚Äã‚Äãthat will apply to one field and call it. <br><br><img src="https://habrastorage.org/webt/h7/io/zf/h7iozfsrf4r8le-ifd_ia5ogwxi.png"><br><br>  <b>Step 4.</b> Check whether the field is selected in other events correctly; if not, add this event to the selected fields. <br><br><img src="https://habrastorage.org/webt/rp/uq/iw/rpuqiweinb9j4jnyyuwjdcxsarg.png"><br><br>  <b>Step 5.</b> Select the field in all events of different structure. <br><br><img src="https://habrastorage.org/webt/dz/zz/1n/dzzz1njwzoi51jif0f-ntzqczia.png"><br><br>  <b>Step 6. We</b> check if something extra is selected if, for example, there is no such field in the event. <br><br><img src="https://habrastorage.org/webt/x1/qq/cq/x1qqcq-n6jqbd-5zcxkbqrzkibq.png"><br><br>  Then we save the field and now when loading data with the same sourcetype to them such a rule will be applied to highlight the field value. <br><br>  Next we create all the fields we need.  And now the data is ready for further analysis. <br><br><img src="https://habrastorage.org/webt/lq/ar/yb/lqarybkspswvt_kiumygxymmjs0.png"><br><br><h2>  <font color="#0075a9">Conclusion</font> </h2><br>  Thus, we told you from which sources you can upload data to Splunk, showed you how to set up receiving from network ports, as well as how to load and parse a non-standard log. <br><br>  We hope that this information will be useful for you. <br><br>  We are happy to answer all your questions and comments on this topic.  Also, if you are interested in something specifically in this area, or in the field of machine data analysis in general, we are ready to refine the existing solutions for you, for your specific task.  To do this, you can write about it in the comments or simply send us a request through the form on our <a href="https://tssolution.ru/splunk/">website</a> . <br><br>  We are the official <a href="https://partners.splunk.com/locator/partner/333601/ts-solution">Premier Splunk Partner</a> . <br><br><img src="https://habrastorage.org/webt/ey/yy/9n/eyyy9nzwq4rf9kolg17ihjq5bik.png"><br><br><h2>  PS </h2><br>  <b>On June 28, 2018,</b> ‚Äú <a href="http://tssolution.tilda.ws/study-splunk">Splunk Getting Started</a> ‚Äù will be taught <b>in Moscow</b> , where in 6 hours the participants will receive a theoretical base and practical skills for working in Splunk.  Learn more about learning and register at this <a href="http://tssolution.tilda.ws/study-splunk">link</a> . </div><p>Source: <a href="https://habr.com/ru/post/353426/">https://habr.com/ru/post/353426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353414/index.html">Analysis of the main concepts of concurrency</a></li>
<li><a href="../353416/index.html">NumPy in Python. Part 2</a></li>
<li><a href="../353418/index.html">Improving performance through access control</a></li>
<li><a href="../353422/index.html">Three-dimensional engine on Excel formulas for dummies</a></li>
<li><a href="../353424/index.html">Aircraft control system simulation</a></li>
<li><a href="../353428/index.html">Telegram lock - prepare for the worst?</a></li>
<li><a href="../353430/index.html">18 rules of the perfect psd layout - a useful checklist for designers</a></li>
<li><a href="../353432/index.html">How to write an exchange with 50 suppliers and do not go crazy</a></li>
<li><a href="../353434/index.html">Choose Yii2 or laravel</a></li>
<li><a href="../353436/index.html">How the Internet of Things shifts analytics to the periphery</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>