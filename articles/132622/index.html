<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Siri communication protocol hacked</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mobile developers from Applidium managed to understand the communication protocol used by Siri, so now this speech recognition engine can theoreticall...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Siri communication protocol hacked</h1><div class="post__text post__text-html js-mediator-article">  Mobile developers from Applidium <a href="http://applidium.com/en/news/cracking_siri/">managed to understand</a> the communication protocol used by Siri, so now this speech recognition engine can theoretically be run on any device, including Android, if you know where to get the iPhone 4S ID, and Apple will make it to the "black list". <br><br>  The key element of Siri is how the program communicates with the server (Siri only works if you have access to the Internet).  The traffic goes through TCP protocol, port 443, to the server 17.174.4.4.  If you try to contact the server <a href="https://17.174.4.4/">https://17.174.4.4/</a> from the desktop, you will see that it presents a certificate in the name of <i>guzzoni.apple.com</i> ( <a href="http://www.ai.sri.com/~guzzoni/">Didier Guzzoni</a> from SRI is one of the creators of this technology). <br><a name="habracut"></a><br>  Since the traffic is protected by https, you will not listen to it with the sniffer.  The guys from Applidium decided that it was easiest to pick up a fake https server and dns server - and look at requests from Siri.  Of course, <i>it is</i> not possible to forge a real certificate <i>guzzoni.apple.com</i> , but you can try to issue your own valid certificate to <i>guzzoni.apple.com</i> on behalf of your own certificate authority on a fake https server.  Since iPhone allows you to add certificates from arbitrary certification authorities to your phone, this method has worked - and now Siri can successfully exchange commands with your own server! <br><br>  After that, hackers were able to calmly deal with the Siri protocol, it uses unusual methods that do not comply with HTTP standards.  The title looks like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">ACE</span></span> /ace HTTP/<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> Host: guzzoni.apple.com User-Agent: Assistant(iPhone/iPhone4,<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">iPhone</span></span> OS/<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/9A334) Ace/<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> Content-Length: <span class="hljs-number"><span class="hljs-number">2000000000</span></span> X-Ace-Host: 4620a9aa-88f4-4ac1-a49d-e2012910921</code> </pre> <br>  As you can see, the ACE method is used instead of the usual GET, ‚Äú/ ace‚Äù is requested as the url, the <i>Content-Length</i> field is indicated at almost 2 GB.  The <i>X-Ace-host</i> field is somehow tied to the device ID (GUID). <br><br>  The request body itself is sent in binary form.  It starts with 0xAACCEE.  The developers suggested that the archived content goes further, that is, the data is transmitted in a compressed form.  So it turned out: the <a href="http://zlib.net/">zlib</a> archiver successfully recognized the archive in binary code (starting from the fifth byte after the AACCEE header). <br><br>  In the unpacked data the binary code was again found, but with inclusions of the text.  Among individual words, <i>bplist00</i> attracted the attention of developers.  Obviously, this is an indication of a <i>plist</i> binary.  Having studied the data in a little more detail, the developers found several different fragments: <br><ul><li>  Fragments beginning with 0x020000xxxx are ‚Äúplist‚Äù packets, xxxx corresponds to the size of the <i>plist</i> binary data that follows the header. </li><li>  Fragments starting with 0x030000xxxx - ‚Äúping‚Äù packets that iPhone sends to the Siri server to maintain the connection.  Here xx corresponds to the ping number. </li><li>  Fragments starting with 0x040000xxxx - ‚Äúpong‚Äù packets that the Siri server sends to the iPhone in response to pings.  As it is easy to guess, xx corresponds to the sequence number of the packet. </li></ul>  Deciphering <i>plist</i> binary content is not difficult; you can do it yourself on Mac OS X using the console command <i>plutil</i> , or on other platforms using <a href="https://github.com/rodneyrehm/CFPropertyList">CFPropertyList</a> . <br><br>  The developers found out that Siri sends audio files compressed with the <a href="http://www.speex.org/">Speex</a> codec to the server, and also inserts an iPhone 4S device identifier everywhere.  The program and the server exchange a huge amount of information on the slightest cause.  For example, when speech recognition works, Apple servers send timestamps and ‚Äútrust level‚Äù for <i>each</i> word. <br><br>  For independent work with the Siri protocol, you can use the <a href="https://github.com/applidium/Cracking-Siri">toolkit</a> created by Applidium programmers. </div><p>Source: <a href="https://habr.com/ru/post/132622/">https://habr.com/ru/post/132622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132614/index.html">Shared directory on a Linux machine, v2</a></li>
<li><a href="../132615/index.html">Copyright and 3D printing</a></li>
<li><a href="../132617/index.html">Naive young man in the face of the IT paradox</a></li>
<li><a href="../132619/index.html">Arduino in the coffee machine</a></li>
<li><a href="../132620/index.html">Electronic bear pillow helps to stop snoring</a></li>
<li><a href="../132623/index.html">Linux Mint 12 "Lisa" RC Released</a></li>
<li><a href="../132624/index.html">As we did "3D photos"</a></li>
<li><a href="../132625/index.html">Video Controller DEPO Race ReVision. Video wall of 24 ultra-high resolution panels</a></li>
<li><a href="../132626/index.html">Portable video camera Kodak Play Full Ze1 - video footage</a></li>
<li><a href="../132627/index.html">Updated YouTube app for Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>