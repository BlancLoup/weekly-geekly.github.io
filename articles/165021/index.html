<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>nil, Nil, NULL, NSNull. All is nothing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The concept of the absence of something ‚Äî nothing ‚Äî this is not only a philosophical, but also a completely utilitarian unit: people, like the compute...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>nil, Nil, NULL, NSNull. All is nothing</h1><div class="post__text post__text-html js-mediator-article"> The concept of the absence of something ‚Äî <b>nothing</b> ‚Äî this is not only a philosophical, but also a completely utilitarian unit: people, like the computers created by them, often have to operate with ‚Äúempty‚Äù ones that express only the <i>non</i> - <i>existence of</i> something, whether it is lack of money on a bank card , <code>about:blank</code> , black holes or <code>grep "${rootpswrd}" /etc/passwd</code> . <br><br>  To express this ‚Äú <i>non-existence</i> ‚Äù in programming languages, a large number of different mnemonics are used.  We will consider those of them that are used in the superpopular (over the past five years, but we will believe that for long years ahead) the language of Objective-C. <br><br><a name="habracut"></a><br><h2>  Unification </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In Objective-C, there are several different types of nothing but the real <b>thing itself</b> .  The reason for this is the "multi-layeredness" of the language, which unites both the procedural paradigm of the C language and the object-orientedness of Smalltalk. <br>  C defines <b>nothing</b> as <code>0</code> (zero) for most basic ( <abbr title="Data types provided by the programming language as basic built-in units of the language: for example, integer, string, character, floating-point number">primitive</abbr> ) types and as <code>NULL</code> exclusively for pointers. <br><br><blockquote>  In fact, in the context of pointers, both <code>NULL</code> and <code>0</code> applicable, since the first is nothing more than a macro wrapper for the second: <br><pre> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NULL ((void *)0)</span></span></code> </pre><br>  However, you should not use <code>NULL</code> as a replacement for <code>0</code> in those places where zero is an algebraic value: <br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c = b*a; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"Neither b nor a is equal to 0\n"</span></span>); }</code> </pre></blockquote><br><br>  Objective-C (like C tuning) retains all the forms of expression of its progenitor, adding one more to them: <code>nil</code> .  <code>nil</code> is a pointer to a null object: <br><pre> <code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#if</span></span> !defined(<span class="hljs-keyword"><span class="hljs-keyword">nil</span></span>) <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nil</span></span> (id)<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#endif</span></span></code> </pre><br>  That is, technically, it is equivalent to <code>NULL</code> . <br><br>  Perhaps no Objective-C program can do without the use of the Foundation framework, which in turn also introduces another ( <i>already the fourth in a row</i> ) representation of <b>anything</b> to the language - the <code>NSNull</code> class, which has a single (not counting inherited) method <a href="https://developer.apple.com/library/mac/"><code>+null</code></a> which returns a <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25BE%25D1%2587%25D0%25BA%25D0%25B0_(%25D1%2588%25D0%25B0%25D0%25B1%25D0%25BB%25D0%25BE%25D0%25BD_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B5%25D0%25BA%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F)">singleton of</a> class <code>NSNull</code> . <br><br>  But that's not all: in addition to the four above-mentioned mnemonics, the Foundation defines the macro <code>Nil</code> (not to be confused with <code>nil</code> ) - a null pointer of type <code>Class</code> : <br><pre> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> !defined(Nil) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Nil (Class)0 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span></span></code> </pre><br>  An example of using <code>Nil</code> in real life is hard to come up with: only a few <s>geeks</s> deal with classes at <a href="http://habrahabr.ru/post/148922/">runtime</a> .  Anyway, here is a small piece of code that initializes a new class inherited from <code>NSString</code> , with the name <code>NSArray</code> (yes, this is not something else, as explained below) in runtime: <br><pre> <code class="hljs kotlin">#inlcude &lt;objc/runtime.h&gt; Class foo = objc_allocateClassPair([NSString <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">], </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">"NSArray"</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">0); /*      NSArray  </span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">   Nil ‚Äî  */ if </span></span></span></span>(Nil != foo) { int check = class_addMethod(foo, <span class="hljs-meta"><span class="hljs-meta">@selector(makeWorldBetter)</span></span>, (IMP)_makeWorldBetter, <span class="hljs-string"><span class="hljs-string">"v@:"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (check) objc_registerClassPair(foo); }</code> </pre><br><br><h3>  Something about <code>nil</code> </h3><br><br>  Consider a couple of cases when an Objective-C programmer may need <code>nil</code> : <br><ol><li>  Sometimes the developers of a particular function (method) allow the possibility that not all input parameters can be specified by the user.  For example, the <code>-capitalizedStringWithLocale:</code> method of the <code>NSString</code> class takes a locale (an object of the <code>NSLocale</code> class) as an argument, or <code>nil</code> ‚Äî in the latter case, when changing the case of a string, the <a href="http://ru.wikipedia.org/wiki/Unicode">canonical decomposition (NFD) of</a> Unicode characters is used regardless of the locale settings on the user's computer (that is, this method will be equivalent to the method <code>-capitalizedString</code> ). <br></li><li>  Initialization and ‚Äúemptying‚Äù of objects (for example, in order to report an error): <br><pre> <code class="hljs objectivec">- (<span class="hljs-built_in"><span class="hljs-built_in">NSDictionary</span></span>*)dictionaryForLicenseFile:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)path { <span class="hljs-built_in"><span class="hljs-built_in">NSData</span></span> *licenseFile = [<span class="hljs-built_in"><span class="hljs-built_in">NSData</span></span> dataWithContentsOfFile:path]; <span class="hljs-comment"><span class="hljs-comment">/* ¬´,     !¬ª */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!licenseFile) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> dictionaryForLicenseData:licenseFile]; }</code> </pre><br><blockquote>  It should be noted, by the way, that the practice of <a href="http://en.wikipedia.org/wiki/Instance_variable"><abbr title="Class member variables">ivars</abbr></a> initialization common to developers <a href="http://en.wikipedia.org/wiki/Instance_variable"><abbr title="Class member variables">with</abbr></a> zero values ‚Äã‚Äãin the methods of the <code>-init*</code> family <code>-init*</code> <b>not make sense</b> , since their values ‚Äã‚Äãwere already equal to zero even in the <a href="https://developer.apple.com/library/mac/"><code>-alloc</code></a> method: <br><blockquote>  ... memory for all <abbr title="This refers to members other than isa">other</abbr> instance variables is set to 0. </blockquote><br></blockquote><br></li></ol><br>  One of the most remarkable properties of <b>anything</b> (that is, <code>nil</code> ) in Objective-C is the ability to send him absolutely any messages, the answer to which will always be the same <code>nil</code> : <br><pre> <code class="hljs objectivec"> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> foo = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> zero = [foo bar: <span class="hljs-string"><span class="hljs-string">@"Hello, Habr!"</span></span>];</code> </pre><br>  Often this feature is used to reduce the number of checks performed on objects: <br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">/* In a galaxy far, far away‚Ä¶ */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (foo != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> &amp;&amp; [foo testValue: <span class="hljs-number"><span class="hljs-number">0x90</span></span>]) { ‚Ä¶ } <span class="hljs-comment"><span class="hljs-comment">/*         */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([foo testValue: <span class="hljs-number"><span class="hljs-number">0x31</span></span><span class="hljs-number"><span class="hljs-number">040</span></span><span class="hljs-number"><span class="hljs-number">3</span></span>]) { ‚Ä¶ }</code> </pre><br><br><blockquote>  Some novice developers, having learned about this feature of <code>nil</code> , transfer it to <b>non-zero</b> objects, forgetting to check whether the called method exists in this class, and inevitably catch exceptions ( <i>exception</i> ) if it is not: <br><pre> <code class="hljs objectivec"> <span class="hljs-comment"><span class="hljs-comment">/* ¬´  NSPersistentStoreCoordinator¬ª ¬© Brad Cox &amp; Tom Love */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NSData</span></span> *signature = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat: <span class="hljs-string"><span class="hljs-string">@"%lu"</span></span>, <span class="hljs-number"><span class="hljs-number">0xCAFEBABE</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/*   ‚Äî  @catch  :   -bytes   NSString  */</span></span> bytes = [signature bytes];</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">And it would have been okay if only novice developers were doing it ...</b> <div class="spoiler_text">  A few months ago, I discovered a similar bug in <a href="http://deadbeatsw.com/">The Tagger‚Äôs</a> application license verification system, this bug allowed <b>any</b> user (and not just someone who can work with a <abbr title="IDA / gdb + hex-editor">file</abbr> ) to bypass the restriction of the trial version by simply slipping an invalid <code>.lic</code> file (or more precisely <code>.ttl</code> ) to the <code>.ttl</code> . <br>  It goes without saying that I notified the developer about this, but I never received an answer. <br>  By the way, the Cocoa version of the popular class <a href="http://www.tempel.org/UsingAquaticPrime">AquaticPrime</a> (which, as a rule, developers prefer the CoreFoundation version) was responsible for the verification code. <br></div></div><br></blockquote><br><br>  In addition, you shouldn‚Äôt forget about checking the objects for <code>nil</code> equality: many of your methods from standard frameworks, and (I bet) some of your own, are simply not designed to work with ‚Äúzero‚Äù objects.  Take at least <code>+[NSArray arrayWithObjects:]</code> - try to create an array of three objects with <code>nil</code> at the top of the list and look at the result.  Another example: <code>+[NSString stringWithString:]</code> , by calling which with <code>nil</code> as an argument, get an exception. <br><br><h2>  <code>NSNull</code> : nothing or something? </h2><br><br>  NSNull is used inside the Foundation framework and some others in order to circumvent the limitation of standard collections, such as NSArray or NSDictionary, in that they cannot contain <code>nil</code> values. <br><blockquote>  NSNull is a kind of wrapper over NULL and nil, allowing you to store them in Objective-C collection objects. <br></blockquote><br><br>  It may not be entirely clear why you need to store zero objects somewhere.  Consider an example: in your iOS application, you need to parse some JSON file with a piece like this <br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"keys"</span></span>: [<span class="hljs-string"><span class="hljs-string">"X"</span></span>], <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"set_action_motion"</span></span>, <span class="hljs-string"><span class="hljs-string">"args"</span></span>: { <span class="hljs-string"><span class="hljs-string">"action"</span></span>: <span class="hljs-string"><span class="hljs-string">"vi_left_delete"</span></span>, <span class="hljs-string"><span class="hljs-string">"motion"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-string"><span class="hljs-string">"context"</span></span>: [{<span class="hljs-string"><span class="hljs-string">"key"</span></span>: <span class="hljs-string"><span class="hljs-string">"setting.command_mode"</span></span>, <span class="hljs-string"><span class="hljs-string">"modes"</span></span>: [] }] }</code> </pre><br>  Most likely, you will not parse JSON "hands", but take advantage of a ready-made library (like <a href="https://github.com/johnezang/JSONKit">JSONKit</a> ), which at the time converts it into objects of standard Objective-C classes.  However, the value of <code>args["motion"]</code> is <b>nothing</b> , that is, <code>null</code> !  This value will be read into an object of the <code>NSNull</code> class as a result of the parser operation. <br><br><h2>  Again 11001b </h2><br><br>  Incomplete summary table: <br><br><table><tbody><tr><th>  Designation </th><th>  Flick of the wrist ... </th><th>  Poslenie </th></tr><tr><td>  0 </td><td>  0 </td><td>  Zero - he is zero everywhere </td></tr><tr><td>  Null </td><td>  (void *) 0 </td><td>  C pointer zero </td></tr><tr><td>  nil </td><td>  (id) 0 </td><td>  Null pointer to an Objective-C object </td></tr><tr><td>  Nil </td><td>  (Class) 0 </td><td>  Zero pointer of type Class in Objective-C </td></tr><tr><td>  NSNull </td><td>  [NSNull null] </td><td>  Singleton class NSNull - wrappers over nil and Null </td></tr></tbody></table><br><br><h3>  Literature </h3><br><ul><li>  Original article on <a href="http://nshipster.com/">NSHipster</a> : <a href="http://nshipster.com/nil/">nil / Nil / NULL / NSNull</a> by <a href="http://mattt.me/">Mattt Thompson</a> </li><li>  Apple Documentation: <a href="https://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSNull_Class/Reference/Reference.html">NSNull</a> , <a href="https://developer.apple.com/library/mac/">NSString</a> , <a href="https://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html">NSObject</a> , <a href="http://developer.apple.com/library/ios/">Programming with Objective-C</a> , <a href="https://developer.apple.com/library/mac/">Objective-C Runtime Reference</a> , <a href="https://developer.apple.com/library/mac/">Objective-C Runtime Programming Guide</a> </li><li>  Wikipedia: <a href="http://ru.wikipedia.org/wiki/%25D0%25AE%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25BE%25D0%25B4">Unicode</a> , <a href="http://ru.wikipedia.org/wiki/Objective-C">Objective-C</a> </li></ul><br><br>  <i>PS I did not design this topic as a translation, because I pretty much eventually moved away from the original article.</i>  <i>Hopefully for the better.</i> </div><p>Source: <a href="https://habr.com/ru/post/165021/">https://habr.com/ru/post/165021/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165005/index.html">PaperTab: prototype tablet with a flexible 10.7-inch ePaprer display</a></li>
<li><a href="../165007/index.html">3D on Windows desktop (+ sources)</a></li>
<li><a href="../165011/index.html">The first flash drive for 1 terabyte</a></li>
<li><a href="../165013/index.html">It was evening, echo "there was nothing"</a></li>
<li><a href="../165017/index.html">A complete set of packages for development using NodeJS</a></li>
<li><a href="../165023/index.html">Screens Liquavista - left to wait quite a bit?</a></li>
<li><a href="../165025/index.html">Simple way to create complex ASP.NET MVC controls</a></li>
<li><a href="../165027/index.html">Rare Toshiba Satellite Pro 430CDT Laptop</a></li>
<li><a href="../165029/index.html">Does the AVR USB Programmer not work? Set up</a></li>
<li><a href="../165031/index.html">Emulation of the ternary system. Concept version</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>