<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tortilla - all TCP and DNS traffic from a virtual machine via TOR</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A step-by-step guide to directing all TCP and DNS traffic from a virtual machine through TOR. 

 The topic has already been raised in 2012: ‚ÄúHow to se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tortilla - all TCP and DNS traffic from a virtual machine via TOR</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/d48/0fc/0e4/d480fc0e4b5b40b182f3a155d675c92b.jpg"><br>  A step-by-step guide to directing all TCP and DNS traffic from a virtual machine through TOR. <br><br>  The topic has already been raised in 2012: <a href="http://habrahabr.ru/post/145436/">‚ÄúHow to send all tcp traffic from the guest Windows system via Tor‚Äù</a> using tun2socks and the TUN / TAP virtual network adapter from OpenVPN. <br><br>  However, a report <a href="http://www.blackhat.com/us-13/briefings.html">‚ÄúTOR ... ALL-THE-THINGS!‚Äù</a> Was presented at Black Hat USA 2013, in which they announced a new tool from CROWDSTRIKE INC by Jason Geffner called <a href="http://www.crowdstrike.com/community-tools/index.html">Tortilla</a> .  Tortilla is also mentioned in the official Tor FAQ in the section <a href="">What should I do if I can't set a proxy for my application?</a>  .  This is a virtual network adapter that is easy to install and use. <br><a name="habracut"></a><br>  Would need: <br><ol><li>  <a href="">TOR Expert Bundle</a> </li><li>  <a href="">Tortilla</a> </li><li>  Virtual machine </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>All settings are made on the physical computer (host system).</b> <b><br></b>  <b>In the operating system of the virtual machine (guest system) you do not need to configure anything.</b> <br><br><h4>  Installing the TOR Expert Bundle </h4><br>  Download the installer and for correct installation run as administrator. <br><br><img src="https://habrastorage.org/files/c46/292/fe9/c46292fe9af14f48a67abe7321c96530.jpg"><br><br>  When the installation is complete, launch Tor. <br><br><img src="https://habrastorage.org/files/051/9a6/6fc/0519a66fc80644cd8df85676d720cdba.jpg"><br><br>  A window will open where you expect a full connection to be established before the message <code>Bootstrapped 100%: Done.</code> <br><br><img src="https://habrastorage.org/files/128/e74/9be/128e749be2714650877493daa2fbafe0.jpg"><br><br><h4>  Install tortilla </h4><br>  The Tortilla network virtual adapter driver has a special test signature and to install and work in all 64-bit and some 32-bit versions of Windows Vista and later, you need to enable support for such a signature using <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff553484(v%3Dvs.85).aspx">the Microsoft instruction</a> . <br><br>  To do this, you need to run a command prompt as an administrator. <br><br><img src="https://habrastorage.org/files/8c8/1bc/cc8/8c81bccc8c0947e8a922d8cde11ba5f7.jpg"><br><br>  And in the opened command line window execute <code>Bcdedit.exe -set TESTSIGNING ON</code> <br><br><img src="https://habrastorage.org/files/834/d99/be8/834d99be891b4d3aac9090dec63712a2.jpg"><br><br>  Then reboot. <br><br>  Then download and unpack the archive.  Launch Tortilla.  A window will open. <br><br><img src="https://habrastorage.org/files/36d/818/e38/36d818e386cc4072bffefb40afdd6fee.jpg"><br><br>  You will be prompted to install the Tortilla driver, which you need to install anyway. <br><br><img src="https://habrastorage.org/files/1c9/1c4/4ae/1c91c44ae57349308b927eaf83ed79da.jpg"><br><br>  If the suggestion to install the driver does not appear, but an error will immediately appear - this means that you did not include support for the test signature of the drivers (see the beginning of the Tortilla installation). <br><br><img src="https://habrastorage.org/files/35a/2b9/dd7/35a2b9dd7fd341c29542e405cff6e22d.jpg"><br><br>  In the end, after successfully installing the driver and running Tortilla, you should see a window with the message <code>Ready to receive network traffic from virtual machine</code> <br><br><img src="https://habrastorage.org/files/c5a/cec/8dc/c5acec8dcad24b25ae2b245886355d02.jpg"><br><br>  Also in the network connections you will see the new connected virtual network adapter Tortilla Adapter. <br><br><img src="https://habrastorage.org/files/b90/b19/f99/b90b19f994644520afe4cf88eae94e6a.jpg"><br><br><h4>  Configuring the virtual machine network on the example of VMware </h4><br>  In VMware, open the <b>Virtual Network Editor</b> .  There select the <b>VMnet0</b> network and in the settings specify the type of connection <b>Bridged</b> by selecting the network adapter from the list of <b>Tortilla Adapter</b> . <br><br><img src="https://habrastorage.org/files/26e/ee2/584/26eee258413440eb920ebbc0d0237a49.jpg"><br><br>  Then in the settings of the virtual machine, specify the type of connection <b>Custom</b> in the properties of the <b>Network Adapter</b> by selecting <b>VMnet0</b> from the list. <br><br><img src="https://habrastorage.org/files/5a2/ebc/a87/5a2ebca875c44e989f01cab7e18ffe01.jpg"><br><br><h4>  Eventually </h4><br>  After starting the virtual machine in the Tortilla window, you should see what traffic ran through TOR. <br><br><img src="https://habrastorage.org/files/53c/06b/e2f/53c06be2fca341ec9a89986366ad8ad9.jpg"><br><br>  Everything. <br><br>  <b>UPD.</b>  <b>IMPORTANT.</b> <br>  For normal use, use <b>TOR BROWSER BUNDLE</b> . <br>  <a href="">Download the latest version of the TOR Browser Bundle</a> and run it. <br><img src="https://habrastorage.org/files/cba/574/a74/cba574a74f884ffb82f60b91cc83ee2b.jpg"><img src="https://habrastorage.org/files/1d1/727/1cc/1d17271ccd614f9d8716a08fad4725cd.jpg"><br><br>  In the Tortilla.ini file (in the Tortilla directory) write port 9150 instead of port 9050. <br><br><img src="https://habrastorage.org/files/a6d/0ce/fcb/a6d0cefcb10544b09ffc9e0cb95570c1.jpg"><br><br>  Apparently the TOR Expert Bundle is not updated, and for the TOR Browser Bundle, new versions are coming out all the time, apparently related to the modification of the TOR network. <br>  In this regard, the work through the TOR Expert Bundle is associated with constant HTTPS errors, as  Many sites are now moving to encryption, this makes it difficult to work. <br><br>  When working through TOR BROWSER BUNDLE, there are no HTTPS errors and JAVA applications work without failures, the speed has increased. <br><br>  <b>UPD.</b> <br>  Nevertheless, failures remain with HTTPS, but you can reload the TOR connection with the ‚ÄúNew Person‚Äù option by clicking on the green bulb <img src="https://habrastorage.org/files/6ef/d7a/a73/6efd7aa734d0473a98566a8724d37923.jpg">  in the TOR browser. <br><img src="https://habrastorage.org/files/1d6/352/eb9/1d6352eb9a7f494a81977f6e7e528750.jpg"></div><p>Source: <a href="https://habr.com/ru/post/233457/">https://habr.com/ru/post/233457/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../233443/index.html">SVG, Iconfonts vs PNG</a></li>
<li><a href="../233447/index.html">Designing an online store: personal account, shopping cart, delivery, payment, mailing and more</a></li>
<li><a href="../233449/index.html">Pop-up Creator apologizes</a></li>
<li><a href="../233453/index.html">Development of a vector editor on JavaScript (complexity and ideas)</a></li>
<li><a href="../233455/index.html">How to implement back-to-back testing. Yandex experience</a></li>
<li><a href="../233461/index.html">How did you start using [x] in the design of graphical interfaces</a></li>
<li><a href="../233463/index.html">My "Swallow"</a></li>
<li><a href="../233465/index.html">LED "smiley". Technology multiplexing method "Charlie"</a></li>
<li><a href="../233467/index.html">LESS? - opinion of the layman-maker-up or designer with the experience</a></li>
<li><a href="../233469/index.html">Thoughtful event controller on the page</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>