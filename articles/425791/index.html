<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Conference DEFCON 20. How to fuck the bad guys (and the mafia) using a JavaScript botnet. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conference DEFCON 20. How to fuck the bad guys (and the mafia) using a JavaScript botnet. Part 1 

 This guy kept all the chats with those who are int...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Conference DEFCON 20. How to fuck the bad guys (and the mafia) using a JavaScript botnet. Part 2</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://habr.com/company/ua-hosting/blog/425691/">Conference DEFCON 20. How to fuck the bad guys (and the mafia) using a JavaScript botnet.</a>  <a href="https://habr.com/company/ua-hosting/blog/425691/">Part 1</a> <br><br>  This guy kept all the chats with those who are interested in the profile of this girl.  This slide shows my favorite chat, kkbill1980 is the one who pretends to be a girl, and fiat176punt is his victim.  ‚ÄúKkbill1980: hello, sweetie!  - fiat176punto: hello, my sweet mouse! ‚Äù, And so on, very cheerful chat. <br><br><img src="https://habrastorage.org/webt/_x/ug/qk/_xugqkqk-yffsjoawu9eomfzsz8.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Further in the chat, they discuss the details of their love relationship, and the most interesting detail is 700 euros, which the victim must send to her ‚Äúsweet mouse‚Äù as if to book a hotel during a fake girl‚Äôs trip to Germany. <a name="habracut"></a><br><br>  And then the fan writes that this night he sent his beloved a ‚Äúcompletely nude photo‚Äù, to which she replies: ‚ÄúOh, baby, this is wonderful!‚Äù <br><br>  The bottom line is that this scam guy talked to a lot of people at the same time with the help of fake girls profiles on dating sites and extorted money from his victims on one pretext or another.  However, somewhere in the middle of the chat, this guy ‚Äúpunctured‚Äù, apparently confusing the open tabs, and began to write in German. <br><br>  In his mailbox everything was perfectly systematized, and he kept all his chats in a special folder, with which he continued to work even now.  We decided to find in the correspondence all the references to the men who were going to use Western Union to send money to their "lover", and found 158 such messages. <br><br><img src="https://habrastorage.org/webt/-z/mj/wy/-zmjwyxti45xy90ei3mxcsyx-9m.jpeg"><br><br>  The next slide shows a sample of the correspondence of this girl and the victim.  Photos are again mentioned here - the girl asks why the man did not send her the promised ‚Äúnaked‚Äù photos.  And he answers that he does not know why, but the bank manager told him that it was impossible to send money to the address indicated, so let the girl give him some other address. <br><br><img src="https://habrastorage.org/webt/aj/mx/k2/ajmxk2af6-lw9xtls8nhkdzesbq.jpeg"><br><br>  This is because the profile of the girl was given a fake address, which, apparently, did not suit the bank clerk.  To which the fake girl angrily replies: ‚Äúfuck, stop playing games with me!  I gave you the correct address, so take the money from the bank and send it to me through Western Union, otherwise forget about everything and stop playing games with my heart! ‚Äù <br><br>  In general, you can imagine what it was for the correspondence.  And this scheme worked, because for sending money through Western Union it is enough to specify only the city and the name of the recipient of the transfer, and then tell him the secret code. <br><br>  The next case, which interested us, was a crook associated with dogs.  We wondered what he did with dogs if he needed an anonymous proxy server for his work? <br><br><img src="https://habrastorage.org/webt/hu/kg/9n/hukg9nqotfppapewamlqnmgjs70.jpeg"><br><br>  We, as usual, decided to use his username and password to get into his inbox.  And there we found something heavy, so if you love animals, do not look at the next picture.  On the next slide, we even posted the following warning: ‚ÄúAttention!  This picture can hurt your feelings! ‚Äù  But, actually, the picture itself. <br><br><img src="https://habrastorage.org/webt/ic/jf/la/icjflahvhdkvyrqd4qtbk7bz16y.jpeg"><br><br>  He placed this fake Yorkshire terrier, fake, because he placed the same dog for sale all over the world, so this is the most profitable york on earth.  He put this picture and made money on it, as the cheapness of the purebred dog tempted everyone and they made an advance payment. <br><br>  We, naturally, came across and psychopaths.  This slide shows the control panel where you can see how the guy from the same IP address constantly searched video.xnxx.com for video materials on the topic ‚Äúmother‚Äù, ‚Äúrape of the sister‚Äù, ‚Äúforced rape‚Äù, ‚Äúviolence‚Äù and the like .  We decided to give his IP address to the local police, because this guy is obviously insane. <br><br><img src="https://habrastorage.org/webt/mo/r3/jc/mor3jcfxnc3gagqzx1picapzzyi.jpeg"><br><br>  So, many people strive for anonymity on the Internet, so the first thing they do is check their anonymity.  But the problem is that using a proxy, you are anonymous for the final page, but not for the proxy itself.  For example, you claim that your IP address is in the US, we look at your real IP address and make sure that this is the case or not.  No anonymity on the proxy server! <br><br>  Another type of anonymous internet activity caught our attention when we discovered a person who made money from reading blog posts.  This is such a business - you read blog posts from people around the world, and they pay you for it.  Within a month, this man earned as much as $ 24, so this is also a good business.  We called this phenomenon "Strange people in a strange world." <br><br>  Many users of our proxy server were engaged in hacking and corruption of these websites.  One of these users caught our attention - on the control panel you see local files intercepted by us from a hacked site, this hacker used a malicious WebShell script to crack, using which you can distort JavaScript. <br><br>  The next slide shows hacking, we looked at its implementation in real time.  Below you see the attacker's email address. <br><br>  When we studied how this site was hacked, we realized that the hacker used an infected WebShell that loads a JavaScript file, which, in turn, reported the URL of this WebShell.  This JavaScript file was also infected by our proxy server and allowed us to find out where this WebShell is located.  It turns out that the hacker himself was hacked by our hacking. <br><br><img src="https://habrastorage.org/webt/w8/tf/f1/w8tff167tb_crpqmicobwz3a9n8.jpeg"><br><br>  The next slide shows a WebShell request that calls JavaScript. <br><br><img src="https://habrastorage.org/webt/la/kk/8d/lakk8dxmufri_-0cwvzx50s6hac.jpeg"><br><br>  As you remember, interesting in our system was that even after disconnecting the client from our proxy server, it still remained infected with our malicious JavaScript.  Until now, everything was obtained by passive observation of the navigation, so we thought about whether it is possible to infect an Intranet, that is, an internal network that was not viewed through our proxy server. <br><br>  Therefore, one of the points that attracted our attention when reviewing the collected data was the ability to search for information about machines that were not published on the Internet, that is, about applications that are used within the Intranet, as can be seen from the following data in the internal ERP system . <br><br><img src="https://habrastorage.org/webt/e2/a5/dx/e2a5dxv-tnlnvbdu24jscb6yeys.jpeg"><br><br>  We followed a guy from Mexico, he searched for porn on the Internet.  He disconnected from the proxy server, but remained infected, so you see here the internal server that we tried to join.  There is a lot of data, passwords, usernames.  This makes it clear that the use of remote JavaScript files on the Intranet may be undesirable, and opens the door to potential attacks of this kind. <br>  Seeing this, we thought that it would be easy to prepare a targeted attack on any application on the Intranet or the Internet, analyzing previously loaded JavaScript files and forcing clients to download these files from any domain, because we installed forced caching. <br><br><img src="https://habrastorage.org/webt/li/9x/jg/li9xjgnec8ds3w0yegfysukdq7k.jpeg"><br><br>  And of course, the users of our proxy server were addicted to pornography.  There was a lot of porn here, porn is real business.  We even read an interesting story about how ‚Äúfrank‚Äù drawings made by a monk in 700 AD were discovered in a Catholic church.  We collected URLs and collected an extensive collection of usernames and passwords, and of course, we will sell them on the Internet (just kidding). <br><br>  But most of all our attention was attracted by the rape chat on the Internet.  We have always believed that it is very difficult to rape someone on the Internet, but it turned out that this is not the case. <br><br>  So we created a javascript file that infected websites.  We created a "payload."  To prepare a targeted attack on a specific site, i.e., to ensure that a user who is part of a botnet gets infected after visiting a specific site, you need to know which JavaScript files are uploaded to this site.  To do this, you can use the network inspection in Google Chrome or Firefox Firebug and select the file that you want to infect. <br><br><img src="https://habrastorage.org/webt/mn/am/0h/mnam0hgua2hlo6np5m7iqlbajea.jpeg"><br><br>  Of course, if you connect to the network via a proxy server, you will not connect to the banking system, or to your social network profile, Intranet or your personal site, but if you do not clear the cache, then you are in the hands of those who made you download a malicious javascript file.  And if this file is located on the page that you are going to open after visiting the proxy server, you will be hacked. <br><br>  The next slide shows the code on the website of the social network website linkedin.com, where you can see some scripts that are loaded into Java, so if you use a proxy server, then we can create a special payload, download these JavaScript files.  Then these files will be infected, and as soon as you disconnect from the proxy and connect to linkedin.com, the payload will be executed. <br><br>  This is very simple, so we can create targeted attacks on several websites to collect passwords of people who used our proxy server before starting to use the normal, not anonymous Internet. <br><br><img src="https://habrastorage.org/webt/is/bd/7c/isbd7cva5dcy8zomiczaa5y2wog.jpeg"><br><br>  To do this, you first need to select a target: a bank, a social network, an Intranet, analyze the files uploaded to the site and launch the ‚Äúpayload‚Äù.  That is, infect and download the infected file for the selected target, and it will be on every site that the victim will visit in the future. <br><br>  Now I want to show you how we got into the banking system and show how our control panel looks like.  Of course, we turned off our proxy server long ago, but for BlackHat and DefCon conferences, I created a new control panel.  I did not host this proxy server on the Internet.  But after my report on BlackHat, I don‚Äôt know why, someone posted it on the Internet (laughter in the audience). <br><br>  So, we configured this proxy server only for 10 parallel connections, and right now, this morning, I‚Äôm ready to show you all the bots, all our zombies for today, July 28th.  You see here a large number of bots from different countries, USA, Brazil and so on. <br><br><img src="https://habrastorage.org/webt/zz/sy/z-/zzsyz-ibjirqt51q69vqznau_-4.jpeg"><br><br>  We are collecting a lot of information from them right now, but we don‚Äôt use it, we don‚Äôt publish these IP addresses, trust me. <br><br>  So, I want to show you penetration into the banking system.  Now I will show you this website.  This is the United Credit League of California.  As you can see, this site is great for attacks, because it is an HTTP web site. <br><br><img src="https://habrastorage.org/webt/8p/ki/sc/8pkisc32vxvpcdxjdncyupq7lu0.jpeg"><br><br>  Here you see the user login form where you need to enter your email address and password.  Since we can very easily insert our infected JavaScript file into the HTTP site, I ‚Äúhooked‚Äù the form and pulled out user names and passwords from this site. <br><br><img src="https://habrastorage.org/webt/3x/cb/v-/3xcbv-wpjb034ywrbnptgsgkp9s.jpeg"><br><br>  The only thing we needed to do in the control panel of our proxy server was to analyze the target and select one file.  In our example, this is the members.ccul.org page and the gatag.js script file. <br><br><img src="https://habrastorage.org/webt/bw/q-/c8/bwq-c8bybfoegs4bezvhwtkd8ly.jpeg"><br><br>  Then I created a "payload" in our control panel and created a preset for the site that interests us. <br><br><img src="https://habrastorage.org/webt/g2/w_/bp/g2w_bpahx-yqhlrpdoe1gc2wx1u.jpeg"><br><br>  On the next slide, you can see how the target site looks in the control panel - here is the command to perform the function on the members.ccul.org address for the gatag.js script, which will launch our payload. <br><br><img src="https://habrastorage.org/webt/yo/rn/q9/yornq99diadv5wtnuqh_xwckl5s.jpeg"><br><br>  Thus, the guy who uses our proxy server to view porn will load this file into the cache.  He can watch porn, hack sites, do anything, and at the same time he will download this JavaScript file for a targeted attack. <br><br>  After he disconnects from our proxy server and selects the item ‚ÄúDo not use a proxy server‚Äù in the network settings of your computer, our file will still remain in the cache of its browser, because it has already been loaded before and has no expiration date. <br><br><img src="https://habrastorage.org/webt/mv/_1/hq/mv_1hq_yb8i7geuu8gsf0n5cc9o.jpeg"><br><br>  After this guy connects to the target site and enters user data, we will ‚Äúpick up‚Äù this form and display all this data in the control panel of our proxy server.  It is very simple. <br><br><img src="https://habrastorage.org/webt/ag/ff/na/agffnaz8oeb6ogpgblgkw9azyts.jpeg"><br><br>  And now I will give some thoughts about the benefits of a JavaScript botnet: <br><br><ul><li>  we didn‚Äôt care about previously cached objects like E-tag or expiration time, so we didn‚Äôt fight them; </li><li>  we didn‚Äôt care about secure HTTPS connections because we didn‚Äôt want to raise any alarms or fire ‚Äôauthentication certificates.  In addition, Moxie was too busy for us to consult him about the use of these certificates (the speaker refers to Moxie Marlinspike, who spoke at DefCon conferences on the subject of falsifying SSL certificates from CA authorization centers); </li><li>  it took us only one day to configure our proxy server so that it finds IP addresses, creates JavaScript and collects all the information we need </li></ul><br>  And now the question is: how many of you think that bad guys like government intelligence agencies are doing the same thing on the Internet?  The question is, which of you thinks that only one proxy server guarantees Internet security?  Nobody thinks so, right? <br>  So, relying on the proxy server to ensure your anonymity on the Internet is a bad idea.  But thousands and thousands of sites tell people - if you want anonymity on the Internet, use a proxy server.  And this problem has existed for a very, very long time.  So, remember - do not use proxy servers!  Do not believe that they ensure your anonymity. <br><br>  Here are some ways to protect yourself. <br><br><img src="https://habrastorage.org/webt/i3/_j/bq/i3_jbqsp_1qo0qxavx_h_g_xjcc.jpeg"><br><br>  Remember the ‚Äúman in the middle‚Äù scheme, because someone can configure your browser for your needs through a proxy server.  Think twice before using a proxy. <br>  Think about whether you trust the TOR network too much.  Because lately we have heard a lot about fake TOR networks and hacks in this network. <br><br>  After you use an anonymous network or proxy server, clear all information in your browser from sites, clear the cache and delete cookies. <br><br>  Remember that VPN is not a panacea, because in this case, many people connect to this network, then they use a proxy server, and therefore infection of your virtual network can happen very easily, as there is a free exchange of malicious files and traffic. <br><br>  Remember again - the cache is not your friend, so treat it accordingly. <br><br>  This is the end of today's conversation, and I want to tell you that tomorrow at 17-00 I will be speaking on SkyTalks with the theme ‚ÄúPull the Fork‚Äù Domain: Bureaucratic DOS ‚Äù.  Thank you very much! <br><br><img src="https://habrastorage.org/webt/if/-o/4t/if-o4tqhtjkrfkj76dhoxfwdrfc.jpeg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/0QT4YJn7oVI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Thank you for staying with us.  Do you like our articles?  Want to see more interesting materials?  Support us by placing an order or recommending to friends, <b>30% discount for Habr users on a unique analogue of the entry-level servers that we invented for you:</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">The whole truth about VPS (KVM) E5-2650 v4 (6 Cores) 10GB DDR4 240GB SSD 1Gbps from $ 20 or how to share the server?</a>  (Options are available with RAID1 and RAID10, up to 24 cores and up to 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 Cores) 10GB DDR4 240GB SSD 1Gbps until December for free</b> if you pay for a period of six months, you can order <a href="https://ua-hosting.company/vpsnl">here</a> . <br><br>  <b>Dell R730xd 2 times cheaper?</b>  Only we have <b><a href="https://ua-hosting.company/serversnl">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV from $ 249</a> in the Netherlands and the USA!</b>  Read about <a href="https://habr.com/company/ua-hosting/blog/329618/">How to build an infrastructure building.</a>  <a href="https://habr.com/company/ua-hosting/blog/329618/">class c using servers Dell R730xd E5-2650 v4 worth 9000 euros for a penny?</a> </div><p>Source: <a href="https://habr.com/ru/post/425791/">https://habr.com/ru/post/425791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425777/index.html">Generation Z: how to work with 20 year olds</a></li>
<li><a href="../425779/index.html">How captcha told about the vulnerability of Yandex</a></li>
<li><a href="../425781/index.html">"Back to the roots": why the IT giant returns 22-nm process technology</a></li>
<li><a href="../425785/index.html">Microsoft began testing Azure-based xCloud cloud gaming service, but not everything is so smooth with it</a></li>
<li><a href="../425787/index.html">Meet people who have legacy computers in working order.</a></li>
<li><a href="../425793/index.html">Alice will pay more than a million rubles by the end of the year. New competition and Yandex recommendations for developers skills</a></li>
<li><a href="../425795/index.html">How to patch cp under FreeBSD?</a></li>
<li><a href="../425797/index.html">How to patch find under FreeBSD?</a></li>
<li><a href="../425799/index.html">How easy it is to take and view .NET assemblies in SQL Server using ICSharpCode.Decompiler</a></li>
<li><a href="../425801/index.html">Space imagery, aviation, coffee delivery - how to combine the love of the sky with IT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>