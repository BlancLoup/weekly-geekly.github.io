<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calculating the value of the expression "on the knee"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The topic is inspired by recent posts Expression Compiler and Expression Value Calculation . Two approaches are considered - the construction of a sem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calculating the value of the expression "on the knee"</h1><div class="post__text post__text-html js-mediator-article">  The topic is inspired by recent posts <a href="http://habrahabr.ru/blogs/development/50139/">Expression Compiler</a> and <a href="http://habrahabr.ru/blogs/algorithm/50196/">Expression Value Calculation</a> .  Two approaches are considered - the construction of a semantic expression tree for quick calculation and the calculation of the expression itself on the move with the help of two of <i>its</i> stacks.  I want to show a fairly simple way to implement, in fact, the algorithm from the first article, but on the basis of recursion.  Sometimes it is appropriate to shift some of the work with the stack to the compiler, since modern OSs give us a big stack and the possibility of using recursion wisely. <a name="habracut"></a><br><br>  So what is an arithmetic expression?  As it was written in the first mentioned article, the structure of the expression can be defined by the following rules: <br><br><pre>  expression :: = addend ["+" or "-" addend] *
 term :: = multiplier ["*" or "/" multiplier] *
 factor :: = number |  variable |  (expression) |  + multiplier |  -factor </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>To the note: this form of grammar description is often used in technical documentation.</i>  <i>In theory, it is called BNF, those who wish can read in more detail, for example, on <a href="http://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0_%25D0%2591%25D1%258D%25D0%25BA%25D1%2583%25D1%2581%25D0%25B0_%25E2%2580%2594_%25D0%259D%25D0%25B0%25D1%2583%25D1%2580%25D0%25B0">Wikipedia</a> .</i> <br><br>  The problem of analyzing text according to a certain formal grammar is usually solved in two ways: explicit construction of a finite state machine (about this later) and a simple recursive analysis, which we will now implement. <br><br>  Guided by the above scheme, you can easily write the following code to analyze the first rule: <br><br><pre>  calculate_expression ()
	 result = calculate term ()
	 while there are characters
		 if current_character = "+"
			 result = result + calculate term ()
		 or if current_character = "-"
			 Result = Result - Calculate_to ()
		 otherwise
			 mistake
	 return result </pre><br><br>  The analysis of multiplication operations is written in an absolutely similar way, and at the lowest level of analysis we come to recursion - to calculate the value in brackets, we simply call to evaluate_expression (). <br><br><pre>  calculate multiplier ()
	 result = 0
	 if current_character digit
		 result = read_number ()
	 or if current_character letter
		 result = calculate_variable ()
	 or if current_character = "("
		 result = calculate_expression ()
		 if the current character! = ")"
			 mistake
	 or if current_character = "+"
		 Result = Calculate_ Multiplier ()
	 or if current_character = "-"
		 result = -calculate_ multiplier ()
	 otherwise
		 mistake
	 return result </pre><br><br>  Yes, in the given pseudocode, spaces are not taken into account, but this is enough for general introduction to the idea.  Those who wish to familiarize themselves with the working implementation of such an approach in C ++ can suggest reading my code in the Popup Plus plugin for Miranda: <a href="">formula.h</a> and <a href="">formula.cpp</a> . <br><br>  PS If there are people willing to read about how grammars and finite automata can be used to compile other texts, I can write about a simple XPath parser inside a Jabber module from the same Miranda.  Or how to parse XML. </div><p>Source: <a href="https://habr.com/ru/post/50276/">https://habr.com/ru/post/50276/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../50269/index.html">Avatars and photos, style of comments</a></li>
<li><a href="../50270/index.html">iPhone sells poorly in Russia</a></li>
<li><a href="../50272/index.html">Valuehost backup</a></li>
<li><a href="../50273/index.html">Habr-excavation: Friendship</a></li>
<li><a href="../50275/index.html">Spend a million - get the iPhone!</a></li>
<li><a href="../50277/index.html">Mozilla Labs wants to track every click.</a></li>
<li><a href="../50278/index.html">Our first post</a></li>
<li><a href="../50280/index.html">We are fighting with Radarix.com. Part one.</a></li>
<li><a href="../50281/index.html">Editor for habr</a></li>
<li><a href="../50282/index.html">Silverlight training in Moscow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>