<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What makes an owl in ZeroNights 2017 Crackme # 3?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ZeroNights 2017 Crackme # 3 is a fairly simple task, but, nevertheless, there are some interesting moments and an owl in it. 


 Under the cut - disas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What makes an owl in ZeroNights 2017 Crackme # 3?</h1><div class="post__text post__text-html js-mediator-article"><p></p><div style="text-align:center;"><img width="440" height="440" src="https://habrastorage.org/webt/h_/s0/nl/h_s0nlpxv01drw6ux0qepmvjbdy.png"></div><p></p><br><p>  <strong>ZeroNights 2017 Crackme # 3</strong> is a fairly simple task, but, nevertheless, there are some interesting moments and an owl in it. </p><br><p>  Under the cut - disassembly, decompiling, pull request to IntelliJ IDEA and a single debugger launch. </p><a name="habracut"></a><br><p> The task file is available at <a href="">https://events.kaspersky.com/crackme/files/crackme3.zip</a> <br>  The Android application <code>app-release.apk</code> is lonely in the archive.  The APK is, like so much in the modern world, a zip archive.  <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/Initial/1_APKContent">We get and unpack it</a> . </p><br><p>  Inside there is a lot of garbage from one of the standard Android application templates in <code>/res</code> , some native libraries in <code>/lib</code> , files with strange names in <code>/assets</code> and, most importantly, the application code in <code>classes.dex</code> .  Convert <code>classes.dex</code> to a jar file with <a href="https://github.com/pxb1988/dex2jar/">dex2jar</a> . </p><br><p>  <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/Initial/2_ClassesDex/">The code inside is</a> organized into several packages: </p><br><ul><li>  android. * </li><li>  com.scottyab.rootbeer </li><li>  com.googlecode.leptonica </li><li>  com.googlecode.tesseract </li><li>  com.kaspersky.zeronights2017.nightwatcher </li></ul><br><p>  Keeping the original package names is a rather dubious practice for crackme, but this is only easier for us.  It is reasonable to assume that the main logic of the application is in the package <code>com.kaspersky.zeronights2017.nightwatcher</code> .  Moreover, that is where the <code>MainActivity</code> class is <code>MainActivity</code> . </p><br><p>  We decompile and study it: </p><br><div class="spoiler">  <b class="spoiler_title">MainActivity.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// // Source code recreated from a .class file by IntelliJ IDEA // (powered by Fernflower decompiler) // package com.kaspersky.zeronights2017.nightwatcher; import android.app.Activity; import android.graphics.Bitmap; import android.graphics.BitmapFactory; import android.os.Bundle; import android.os.Build.VERSION; import android.view.View; import android.view.View.OnClickListener; import android.widget.Button; import android.widget.EditText; import android.widget.Toast; import com.googlecode.tesseract.android.TessBaseAPI; import java.io.File; public class MainActivity extends Activity { public static EditText a; public static EditText b; public static String c; private String d; private final String e; public MainActivity() { this.d = \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q; this.e = \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.d); } private void a() { Bitmap var1 = BitmapFactory.decodeResource(this.getResources(), 2131099746); TessBaseAPI var2; if (VERSION.SDK_INT &gt; 19) { this.d = this.getFilesDir() + \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.e; var2 = new TessBaseAPI(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.i); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f); var2.a(var1); c = var2.a(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.j); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.g); var2.a(var1); c = c + var2.a(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.k); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h); var2.a(var1); c = c + var2.a(); } else { this.d = this.getFilesDir() + \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.e; var2 = new TessBaseAPI(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.i); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f); var2.a(var1); c = var2.a().split("\n")[0]; this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.j); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.g); var2.a(var1); c = c + var2.a().split("\n")[0]; this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.k); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h); var2.a(var1); c = c + var2.a().split("\n")[0]; } } private void a(File var1, String var2) { if (!var1.exists() &amp;&amp; var1.mkdirs()) { this.a(var2); } if (var1.exists() &amp;&amp; !(new File(this.d + this.e + var2)).exists()) { this.a(var2); } } private void a(String param1) { // $FF: Couldn't be decompiled } protected void onCreate(Bundle var1) { super.onCreate(var1); this.requestWindowFeature(1); this.getWindow().setFlags(1024, 1024); this.setContentView(2131296283); Button var2 = (Button)this.findViewById(2131165217); if ((new \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(this)).\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF()) { Toast.makeText(this, 2131361827, 1).show(); this.finish(); } var2.setOnClickListener(new OnClickListener() { public void onClick(View var1) { MainActivity.a = (EditText)MainActivity.this.findViewById(2131165230); MainActivity.b = (EditText)MainActivity.this.findViewById(2131165280); MainActivity.this.a(); if (!MainActivity.a.getText().toString().matches(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q) &amp;&amp; !MainActivity.b.getText().toString().toUpperCase().matches(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q)) { if (\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF()) { Toast.makeText(MainActivity.this, 2131361829, 1).show(); } else { Toast.makeText(MainActivity.this, 2131361828, 1).show(); } } else { Toast.makeText(MainActivity.this, 2131361828, 1).show(); } } }); } }</span></span></code> uFEFF \ uFEFF (\ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF.d); <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// // Source code recreated from a .class file by IntelliJ IDEA // (powered by Fernflower decompiler) // package com.kaspersky.zeronights2017.nightwatcher; import android.app.Activity; import android.graphics.Bitmap; import android.graphics.BitmapFactory; import android.os.Bundle; import android.os.Build.VERSION; import android.view.View; import android.view.View.OnClickListener; import android.widget.Button; import android.widget.EditText; import android.widget.Toast; import com.googlecode.tesseract.android.TessBaseAPI; import java.io.File; public class MainActivity extends Activity { public static EditText a; public static EditText b; public static String c; private String d; private final String e; public MainActivity() { this.d = \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q; this.e = \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.d); } private void a() { Bitmap var1 = BitmapFactory.decodeResource(this.getResources(), 2131099746); TessBaseAPI var2; if (VERSION.SDK_INT &gt; 19) { this.d = this.getFilesDir() + \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.e; var2 = new TessBaseAPI(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.i); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f); var2.a(var1); c = var2.a(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.j); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.g); var2.a(var1); c = c + var2.a(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.k); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h); var2.a(var1); c = c + var2.a(); } else { this.d = this.getFilesDir() + \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.e; var2 = new TessBaseAPI(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.i); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f); var2.a(var1); c = var2.a().split("\n")[0]; this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.j); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.g); var2.a(var1); c = c + var2.a().split("\n")[0]; this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.k); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h); var2.a(var1); c = c + var2.a().split("\n")[0]; } } private void a(File var1, String var2) { if (!var1.exists() &amp;&amp; var1.mkdirs()) { this.a(var2); } if (var1.exists() &amp;&amp; !(new File(this.d + this.e + var2)).exists()) { this.a(var2); } } private void a(String param1) { // $FF: Couldn't be decompiled } protected void onCreate(Bundle var1) { super.onCreate(var1); this.requestWindowFeature(1); this.getWindow().setFlags(1024, 1024); this.setContentView(2131296283); Button var2 = (Button)this.findViewById(2131165217); if ((new \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(this)).\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF()) { Toast.makeText(this, 2131361827, 1).show(); this.finish(); } var2.setOnClickListener(new OnClickListener() { public void onClick(View var1) { MainActivity.a = (EditText)MainActivity.this.findViewById(2131165230); MainActivity.b = (EditText)MainActivity.this.findViewById(2131165280); MainActivity.this.a(); if (!MainActivity.a.getText().toString().matches(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q) &amp;&amp; !MainActivity.b.getText().toString().toUpperCase().matches(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q)) { if (\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF()) { Toast.makeText(MainActivity.this, 2131361829, 1).show(); } else { Toast.makeText(MainActivity.this, 2131361828, 1).show(); } } else { Toast.makeText(MainActivity.this, 2131361828, 1).show(); } } }); } }</span></span></code> \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// // Source code recreated from a .class file by IntelliJ IDEA // (powered by Fernflower decompiler) // package com.kaspersky.zeronights2017.nightwatcher; import android.app.Activity; import android.graphics.Bitmap; import android.graphics.BitmapFactory; import android.os.Bundle; import android.os.Build.VERSION; import android.view.View; import android.view.View.OnClickListener; import android.widget.Button; import android.widget.EditText; import android.widget.Toast; import com.googlecode.tesseract.android.TessBaseAPI; import java.io.File; public class MainActivity extends Activity { public static EditText a; public static EditText b; public static String c; private String d; private final String e; public MainActivity() { this.d = \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q; this.e = \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.d); } private void a() { Bitmap var1 = BitmapFactory.decodeResource(this.getResources(), 2131099746); TessBaseAPI var2; if (VERSION.SDK_INT &gt; 19) { this.d = this.getFilesDir() + \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.e; var2 = new TessBaseAPI(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.i); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f); var2.a(var1); c = var2.a(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.j); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.g); var2.a(var1); c = c + var2.a(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.k); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h); var2.a(var1); c = c + var2.a(); } else { this.d = this.getFilesDir() + \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.e; var2 = new TessBaseAPI(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.i); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f); var2.a(var1); c = var2.a().split("\n")[0]; this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.j); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.g); var2.a(var1); c = c + var2.a().split("\n")[0]; this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.k); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h); var2.a(var1); c = c + var2.a().split("\n")[0]; } } private void a(File var1, String var2) { if (!var1.exists() &amp;&amp; var1.mkdirs()) { this.a(var2); } if (var1.exists() &amp;&amp; !(new File(this.d + this.e + var2)).exists()) { this.a(var2); } } private void a(String param1) { // $FF: Couldn't be decompiled } protected void onCreate(Bundle var1) { super.onCreate(var1); this.requestWindowFeature(1); this.getWindow().setFlags(1024, 1024); this.setContentView(2131296283); Button var2 = (Button)this.findViewById(2131165217); if ((new \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(this)).\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF()) { Toast.makeText(this, 2131361827, 1).show(); this.finish(); } var2.setOnClickListener(new OnClickListener() { public void onClick(View var1) { MainActivity.a = (EditText)MainActivity.this.findViewById(2131165230); MainActivity.b = (EditText)MainActivity.this.findViewById(2131165280); MainActivity.this.a(); if (!MainActivity.a.getText().toString().matches(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q) &amp;&amp; !MainActivity.b.getText().toString().toUpperCase().matches(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q)) { if (\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF()) { Toast.makeText(MainActivity.this, 2131361829, 1).show(); } else { Toast.makeText(MainActivity.this, 2131361828, 1).show(); } } else { Toast.makeText(MainActivity.this, 2131361828, 1).show(); } } }); } }</span></span></code> (\ uFEFF \ uFEFF! MainActivity.a.getText () \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF.q) &amp;&amp;! <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// // Source code recreated from a .class file by IntelliJ IDEA // (powered by Fernflower decompiler) // package com.kaspersky.zeronights2017.nightwatcher; import android.app.Activity; import android.graphics.Bitmap; import android.graphics.BitmapFactory; import android.os.Bundle; import android.os.Build.VERSION; import android.view.View; import android.view.View.OnClickListener; import android.widget.Button; import android.widget.EditText; import android.widget.Toast; import com.googlecode.tesseract.android.TessBaseAPI; import java.io.File; public class MainActivity extends Activity { public static EditText a; public static EditText b; public static String c; private String d; private final String e; public MainActivity() { this.d = \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q; this.e = \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.d); } private void a() { Bitmap var1 = BitmapFactory.decodeResource(this.getResources(), 2131099746); TessBaseAPI var2; if (VERSION.SDK_INT &gt; 19) { this.d = this.getFilesDir() + \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.e; var2 = new TessBaseAPI(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.i); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f); var2.a(var1); c = var2.a(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.j); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.g); var2.a(var1); c = c + var2.a(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.k); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h); var2.a(var1); c = c + var2.a(); } else { this.d = this.getFilesDir() + \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.e; var2 = new TessBaseAPI(); this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.i); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f); var2.a(var1); c = var2.a().split("\n")[0]; this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.j); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.g); var2.a(var1); c = c + var2.a().split("\n")[0]; this.a(new File(this.d + this.e), \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.k); var2.a(this.d, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h); var2.a(var1); c = c + var2.a().split("\n")[0]; } } private void a(File var1, String var2) { if (!var1.exists() &amp;&amp; var1.mkdirs()) { this.a(var2); } if (var1.exists() &amp;&amp; !(new File(this.d + this.e + var2)).exists()) { this.a(var2); } } private void a(String param1) { // $FF: Couldn't be decompiled } protected void onCreate(Bundle var1) { super.onCreate(var1); this.requestWindowFeature(1); this.getWindow().setFlags(1024, 1024); this.setContentView(2131296283); Button var2 = (Button)this.findViewById(2131165217); if ((new \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(this)).\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF()) { Toast.makeText(this, 2131361827, 1).show(); this.finish(); } var2.setOnClickListener(new OnClickListener() { public void onClick(View var1) { MainActivity.a = (EditText)MainActivity.this.findViewById(2131165230); MainActivity.b = (EditText)MainActivity.this.findViewById(2131165280); MainActivity.this.a(); if (!MainActivity.a.getText().toString().matches(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q) &amp;&amp; !MainActivity.b.getText().toString().toUpperCase().matches(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.q)) { if (\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF()) { Toast.makeText(MainActivity.this, 2131361829, 1).show(); } else { Toast.makeText(MainActivity.this, 2131361828, 1).show(); } } else { Toast.makeText(MainActivity.this, 2131361828, 1).show(); } } }); } }</span></span></code> </pre> </div></div><br><p>  For ease of reading in this and subsequent listings, all symbols with codes greater than 127 are replaced with unicode escape sequences of the <code>\uXXXX</code> . </p><br><p>  Some of the names of classes, fields, and methods were obfuscated, some methods could not be decompiled, but the <code>onCreate()</code> method is simple and straightforward.  From it, we learn that we have at least two input fields and one button, when clicked, one of the messages is displayed to the user, depending on the result returned by the method with the unreadable name. </p><br><p>  Focusing on the number of characters in the class and method names (34 and 62, respectively), we find this method: </p><br><div class="spoiler">  <b class="spoiler_title">Class that validates the key entered</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// // Source code recreated from a .class file by IntelliJ IDEA // (powered by Fernflower decompiler) // package com.kaspersky.zeronights2017.nightwatcher; class \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF { public static boolean \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF() { boolean var0; if ( \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.t / \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.r * \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f - \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h == MainActivity.b.getText().toString().toUpperCase().length() &amp;&amp; \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF .\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF( \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF .\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF( \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF .\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF( MainActivity.c.getBytes() ) + MainActivity.a.getText().toString() ) ).equals(MainActivity.b.getText().toString().toUpperCase()) ) { var0 = true; } else { var0 = false; } return var0; } }</span></span></code> \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF \ uFEFF <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// // Source code recreated from a .class file by IntelliJ IDEA // (powered by Fernflower decompiler) // package com.kaspersky.zeronights2017.nightwatcher; class \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF { public static boolean \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF() { boolean var0; if ( \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.t / \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.r * \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.f - \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.h == MainActivity.b.getText().toString().toUpperCase().length() &amp;&amp; \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF .\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF( \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF .\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF( \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF .\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF( MainActivity.c.getBytes() ) + MainActivity.a.getText().toString() ) ).equals(MainActivity.b.getText().toString().toUpperCase()) ) { var0 = true; } else { var0 = false; } return var0; } }</span></span></code> </pre> </div></div><br><p>  At this could be finished. </p><br><p>  The length of the value from the second input field is checked.  A prefix is ‚Äã‚Äãadded to the value from the first input field, probably constant, some hash is calculated from the resulting line.  The value of the latter is compared with the value of the second input field, converted to upper case.  Everything. </p><br><p>  It is enough to slightly modify the code in the apk-file, adding the logging of the calculated hash before comparing, and the crackme is solved.  But it‚Äôs pretty boring and doesn‚Äôt pull the article, so we‚Äôll go the other way. </p><br><h1>  Other way </h1><br><p>  Instead, let us analyze the logic of the work and write the key generator. </p><br><p>  First you should get rid of obfuscation of identifiers.  Some of them are just single letters, and some are sequences of different lengths from <code>\uFEFF</code> .  Most often this symbol is used as a <a href="https://en.wikipedia.org/wiki/Byte_order_mark">byte order mark</a> at the beginning of text files in one of the unicode encodings.  But it has another, outdated, value - <a href="https://en.wikipedia.org/wiki/Word_joiner">zero-width no-break space (ZWNBSP)</a> or, if in Russian, a space of zero width.  It is thanks to this property in the open file dialog that we see several ‚Äúno-name‚Äù class files. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a_/l5/0f/a_l50fqi-4j-2himlncuzjbm77c.png"></div><br><p>  By the way, a curious fact: From the point of view of the Java Language Specification, the <code>\uFEFF</code> symbol does not stand out in any way and can be part of the identifier from the second position.  But the compiler implementation from Oracle JDK / Open JDK has its own view on some issues and when compiling such characters will be silently cut from the identifier and will not fall into the resulting class file.  We will not find a word about this in JLS, information about this is only in the <a href="">javac source code</a> and bugtracker: <a href="https://bugs.openjdk.java.net/browse/JDK-7144981">JDK-7144981</a> . </p><br><p>  Fernflower, a decompiler <a href="https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine">running as part of IntelliJ IDEA</a> , has support for automatic renaming of identifiers.  To do this, when calling the decompiler from the command line, you must specify the parameter <code>-ren=1</code> . </p><br><p>  But when trying to decompile, we are in a fiasco, the decompiler does not consider such identifiers incorrect.  It's time to look inside and find out the reason. </p><br><p>  This is how the method looked, whether it is necessary to rename the identifier: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toBeRenamed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Type elementType, String className, String element, String descriptor)</span></span></span><span class="hljs-function"> </span></span>{ String value = elementType == Type.ELEMENT_CLASS ? className : element; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || value.length() &lt;= <span class="hljs-number"><span class="hljs-number">2</span></span> || Character.isDigit(value.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>)) || KEYWORDS.contains(value) || elementType == Type.ELEMENT_CLASS &amp;&amp; ( RESERVED_WINDOWS_NAMESPACE.contains(value.toLowerCase(Locale.US)) || value.length() &gt; <span class="hljs-number"><span class="hljs-number">255</span></span> - <span class="hljs-string"><span class="hljs-string">".class"</span></span>.length()); }</code> </pre> <br><p>  Rename identifiers that are too short, too long, starting with a digit, or matching a keyword or reserved file names on Windows. </p><br><p>  We replace the check with the number in the first position to check the correctness of the identifier according to JLS and the absence of these remarkable ‚Äúignorable chars‚Äù in it, we make out a <a href="https://github.com/JetBrains/intellij-community/pull/709">pull request</a> . </p><br><p>  Obfuscation is defeated, but there are methods that could not be decompiled.  Let's do them. </p><br><h1>  Some assembly language </h1><br><p>  For assembly and disassembly, we will use <a href="https://wiki.openjdk.java.net/display/CodeTools/asmtools">asmtools</a> from OpenJDK. </p><br><p>  Let's start with the only problematic method in <code>MainActivity</code> : </p><br><div class="spoiler">  <b class="spoiler_title">MainActivity.jasm - void a (String)</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Method a:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)V"</span></span> stack <span class="hljs-number"><span class="hljs-number">4</span></span> locals <span class="hljs-number"><span class="hljs-number">8</span></span> { aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t0; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lang</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StringBuilder</span></span></span></span>; astore <span class="hljs-number"><span class="hljs-number">5</span></span>; endtry t0; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t1; aload <span class="hljs-number"><span class="hljs-number">5</span></span>; invokespecial Method java/lang/StringBuilder.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; endtry t1; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t2; aload <span class="hljs-number"><span class="hljs-number">5</span></span>; aload_0; getfield Field d:<span class="hljs-string"><span class="hljs-string">"Ljava/lang/String;"</span></span>; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; aload_0; getfield Field e:<span class="hljs-string"><span class="hljs-string">"Ljava/lang/String;"</span></span>; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; aload_1; invokestatic Method \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.<span class="hljs-string"><span class="hljs-string">"\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF"</span></span>:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/String;"</span></span>; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; invokevirtual Method java/lang/StringBuilder.toString:<span class="hljs-string"><span class="hljs-string">"()Ljava/lang/String;"</span></span>; astore <span class="hljs-number"><span class="hljs-number">5</span></span>; endtry t2; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t3; aload_0; invokevirtual Method getAssets:<span class="hljs-string"><span class="hljs-string">"()Landroid/content/res/AssetManager;"</span></span>; astore <span class="hljs-number"><span class="hljs-number">6</span></span>; endtry t3; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t4; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lang</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StringBuilder</span></span></span></span>; astore <span class="hljs-number"><span class="hljs-number">7</span></span>; endtry t4; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t5; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; invokespecial Method java/lang/StringBuilder.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; endtry t5; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t6; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; aload_0; getfield Field e:<span class="hljs-string"><span class="hljs-string">"Ljava/lang/String;"</span></span>; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; aload_1; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; invokevirtual Method java/lang/StringBuilder.toString:<span class="hljs-string"><span class="hljs-string">"()Ljava/lang/String;"</span></span>; invokevirtual Method android/content/res/AssetManager.open:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/io/InputStream;"</span></span>; astore_1; endtry t6; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t7; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">io</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FileOutputStream</span></span></span></span>; astore <span class="hljs-number"><span class="hljs-number">7</span></span>; endtry t7; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t8; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; aload <span class="hljs-number"><span class="hljs-number">5</span></span>; invokespecial Method java/io/FileOutputStream.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)V"</span></span>; endtry t8; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t9; getstatic Field \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.x:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; newarray <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>; astore <span class="hljs-number"><span class="hljs-number">6</span></span>; endtry t9; L125: aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t10; aload_1; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; invokevirtual Method java/io/InputStream.read:<span class="hljs-string"><span class="hljs-string">"([B)I"</span></span>; istore_3; endtry t10; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t11; iload_3; getstatic Field \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.b:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; if_icmpeq L202; endtry t11; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t12; getstatic Field \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.a:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; istore_2; endtry t12; L152: iload_2; iload_3; if_icmpge L179; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t13; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; iload_2; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; iload_2; baload; getstatic Field \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.l:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; ixor; i2b; bastore; endtry t13; iinc <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>; goto L152; L179: aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t14; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; getstatic Field \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.a:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; iload_3; invokevirtual Method java/io/OutputStream.write:<span class="hljs-string"><span class="hljs-string">"([BII)V"</span></span>; endtry t14; goto L125; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t0 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t1 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t2 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t3 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t4 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t5 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t6 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t7 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t8 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t9 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t10 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t11 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t12 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t13 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t14 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t15 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t16 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t17 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t18 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t19 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t20 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t21 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t22 java/io/IOException; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t23 java/io/IOException; astore_1; aload_1; invokevirtual Method java/io/IOException.printStackTrace:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; L201: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; L202: aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t15; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; invokevirtual Method java/io/OutputStream.flush:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; endtry t15; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t16; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; invokevirtual Method java/io/OutputStream.close:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; endtry t16; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t17; aload_1; invokevirtual Method java/io/InputStream.close:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; endtry t17; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t18; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">io</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">File</span></span></span></span>; astore_1; endtry t18; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t19; aload_1; aload <span class="hljs-number"><span class="hljs-number">5</span></span>; invokespecial Method java/io/File.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)V"</span></span>; endtry t19; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t20; aload_1; invokevirtual Method java/io/File.exists:<span class="hljs-string"><span class="hljs-string">"()Z"</span></span>; ifne L201; endtry t20; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t21; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">io</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FileNotFoundException</span></span></span></span>; astore_1; endtry t21; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t22; aload_1; invokespecial Method java/io/FileNotFoundException.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; endtry t22; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t23; aload_1; athrow; endtry t23; }</code> </pre> </div></div><br><p>  We immediately see a bunch of <code>try</code> blocks, dividing a single <code>catch</code> block with the commonplace <code>e.printStackTrace();</code>  hidden in the code somewhere in between. </p><br><p>  It looks too complicated for a code that has not yet shown any attempts at serious obfuscation.  Maybe <code>dex2jar</code> got it wrong when converting? </p><br><p>  It's time to take <a href="https://ibotpeaches.github.io/Apktool/">apktool</a> and look at the original Dalvik bytecode before converting it to Java bytecode.  At the same time and get the resources. </p><br><p>  Suspicions were confirmed, when converting, not everything went smoothly.  Although the <code>catch</code> is indeed common, the <code>try</code> block only turns out to be two: </p><br><div class="spoiler">  <b class="spoiler_title">MainActivity.smali - void a (String)</b> <div class="spoiler_text"><pre> <code class="java hljs">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Ljava/lang/String;)</span></span></span><span class="hljs-function">V .locals 8 .param p1, "arg0" # Ljava/lang/String</span></span>; .prologue :try_start_0 <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>-instance v1, Ljava/lang/StringBuilder; invoke-direct {v1}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V iget-object v2, p0, Lcom/kaspersky/zeronights2017/nightwatcher/MainActivity;-&gt;d:Ljava/lang/String; invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder; move-result-object v1 iget-object v2, p0, Lcom/kaspersky/zeronights2017/nightwatcher/MainActivity;-&gt;e:Ljava/lang/String; invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder; move-result-object v1 invoke-<span class="hljs-keyword"><span class="hljs-keyword">static</span></span> {p1}, Lcom/kaspersky/zeronights2017/nightwatcher/\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF;-&gt;\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(Ljava/lang/String;)Ljava/lang/String; move-result-object v2 invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder; move-result-object v1 invoke-virtual {v1}, Ljava/lang/StringBuilder;-&gt;toString()Ljava/lang/String; move-result-object v2 invoke-virtual {p0}, Lcom/kaspersky/zeronights2017/nightwatcher/MainActivity;-&gt;getAssets()Landroid/content/res/AssetManager; move-result-object v1 <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>-instance v3, Ljava/lang/StringBuilder; invoke-direct {v3}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V iget-object v4, p0, Lcom/kaspersky/zeronights2017/nightwatcher/MainActivity;-&gt;e:Ljava/lang/String; invoke-virtual {v3, v4}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder; move-result-object v3 invoke-virtual {v3, p1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder; move-result-object v3 invoke-virtual {v3}, Ljava/lang/StringBuilder;-&gt;toString()Ljava/lang/String; move-result-object v3 invoke-virtual {v1, v3}, Landroid/content/res/AssetManager;-&gt;open(Ljava/lang/String;)Ljava/io/InputStream; move-result-object p1 <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>-instance v3, Ljava/io/FileOutputStream; invoke-direct {v3, v2}, Ljava/io/FileOutputStream;-&gt;&lt;init&gt;(Ljava/lang/String;)V sget v1, Lcom/kaspersky/zeronights2017/nightwatcher/\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF;-&gt;x:I <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>-array v4, v1, [B :goto_0 invoke-virtual {p1, v4}, Ljava/io/InputStream;-&gt;read([B)I move-result v5 sget v1, Lcom/kaspersky/zeronights2017/nightwatcher/\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF;-&gt;b:I <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v5, v1, :cond_2 sget v1, Lcom/kaspersky/zeronights2017/nightwatcher/\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF;-&gt;a:I :goto_1 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ge v1, v5, :cond_0 aget-<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> v6, v4, v1 sget v7, Lcom/kaspersky/zeronights2017/nightwatcher/\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF;-&gt;l:I xor-<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>/<span class="hljs-number"><span class="hljs-number">2</span></span>addr v6, v7 <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>-to-<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> v6, v6 aput-<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> v6, v4, v1 add-<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>/lit8 v1, v1, <span class="hljs-number"><span class="hljs-number">0x1</span></span> goto :goto_1 :cond_0 sget v1, Lcom/kaspersky/zeronights2017/nightwatcher/\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF;-&gt;a:I invoke-virtual {v3, v4, v1, v5}, Ljava/io/OutputStream;-&gt;write([BII)V :try_end_0 .<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> Ljava/io/IOException; {:try_start_0 .. :try_end_0} :catch_0 goto :goto_0 :catch_0 move-exception v1 move-object v0, p1 .end local p1 # <span class="hljs-string"><span class="hljs-string">"arg0"</span></span>:Ljava/lang/String; .local v0, <span class="hljs-string"><span class="hljs-string">"arg0"</span></span>:Ljava/lang/String; move-object p1, v1 .end local v0 # <span class="hljs-string"><span class="hljs-string">"arg0"</span></span>:Ljava/lang/String; .restart local p1 # <span class="hljs-string"><span class="hljs-string">"arg0"</span></span>:Ljava/lang/String; invoke-virtual {p1}, Ljava/io/IOException;-&gt;printStackTrace()V :cond_1 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> :cond_2 :try_start_1 invoke-virtual {v3}, Ljava/io/OutputStream;-&gt;flush()V invoke-virtual {v3}, Ljava/io/OutputStream;-&gt;close()V invoke-virtual {p1}, Ljava/io/InputStream;-&gt;close()V <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>-instance p1, Ljava/io/File; invoke-direct {p1, v2}, Ljava/io/File;-&gt;&lt;init&gt;(Ljava/lang/String;)V invoke-virtual {p1}, Ljava/io/File;-&gt;exists()Z move-result v1 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-nez v1, :cond_1 <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>-instance p1, Ljava/io/FileNotFoundException; invoke-direct {p1}, Ljava/io/FileNotFoundException;-&gt;&lt;init&gt;()V <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> p1 :try_end_1 .<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> Ljava/io/IOException; {:try_start_1 .. :try_end_1} :catch_0 .end method</code> </pre> </div></div><br><p>  We return to the listing obtained with the help of <code>asmtools jdis MainActivity.class</code> and slightly modify it.  The body of a <code>catch</code> block is moved to the end of the method body, all the <code>try</code> blocks are deleted, and instead of them we add a new one that starts where the first one started and ends where the last <code>try</code> block ended in the original listing. </p><br><div class="spoiler">  <b class="spoiler_title">MainActivity.jasm - fixed void a (String)</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Method a:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)V"</span></span> stack <span class="hljs-number"><span class="hljs-number">4</span></span> locals <span class="hljs-number"><span class="hljs-number">8</span></span> { aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> t0; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lang</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StringBuilder</span></span></span></span>; astore <span class="hljs-number"><span class="hljs-number">5</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload <span class="hljs-number"><span class="hljs-number">5</span></span>; invokespecial Method java/lang/StringBuilder.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload <span class="hljs-number"><span class="hljs-number">5</span></span>; aload_0; getfield Field d:<span class="hljs-string"><span class="hljs-string">"Ljava/lang/String;"</span></span>; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; aload_0; getfield Field e:<span class="hljs-string"><span class="hljs-string">"Ljava/lang/String;"</span></span>; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; aload_1; invokestatic Method <span class="hljs-string"><span class="hljs-string">"\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF"</span></span>.<span class="hljs-string"><span class="hljs-string">"\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF"</span></span>:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/String;"</span></span>; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; invokevirtual Method java/lang/StringBuilder.toString:<span class="hljs-string"><span class="hljs-string">"()Ljava/lang/String;"</span></span>; astore <span class="hljs-number"><span class="hljs-number">5</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload_0; invokevirtual Method getAssets:<span class="hljs-string"><span class="hljs-string">"()Landroid/content/res/AssetManager;"</span></span>; astore <span class="hljs-number"><span class="hljs-number">6</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lang</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StringBuilder</span></span></span></span>; astore <span class="hljs-number"><span class="hljs-number">7</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; invokespecial Method java/lang/StringBuilder.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; aload_0; getfield Field e:<span class="hljs-string"><span class="hljs-string">"Ljava/lang/String;"</span></span>; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; aload_1; invokevirtual Method java/lang/StringBuilder.append:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span></span>; invokevirtual Method java/lang/StringBuilder.toString:<span class="hljs-string"><span class="hljs-string">"()Ljava/lang/String;"</span></span>; invokevirtual Method android/content/res/AssetManager.<span class="hljs-string"><span class="hljs-string">"open"</span></span>:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)Ljava/io/InputStream;"</span></span>; astore_1; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">io</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FileOutputStream</span></span></span></span>; astore <span class="hljs-number"><span class="hljs-number">7</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; aload <span class="hljs-number"><span class="hljs-number">5</span></span>; invokespecial Method java/io/FileOutputStream.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)V"</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; getstatic Field <span class="hljs-string"><span class="hljs-string">"\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF"</span></span>.x:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; newarray <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>; astore <span class="hljs-number"><span class="hljs-number">6</span></span>; L125: aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload_1; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; invokevirtual Method java/io/InputStream.read:<span class="hljs-string"><span class="hljs-string">"([B)I"</span></span>; istore_3; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; iload_3; getstatic Field <span class="hljs-string"><span class="hljs-string">"\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF"</span></span>.b:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; if_icmpeq L202; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; getstatic Field <span class="hljs-string"><span class="hljs-string">"\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF"</span></span>.a:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; istore_2; L152: iload_2; iload_3; if_icmpge L179; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; iload_2; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; iload_2; baload; getstatic Field <span class="hljs-string"><span class="hljs-string">"\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF"</span></span>.l:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; ixor; i2b; bastore; iinc <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>; goto L152; L179: aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; aload <span class="hljs-number"><span class="hljs-number">6</span></span>; getstatic Field <span class="hljs-string"><span class="hljs-string">"\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF"</span></span>.a:<span class="hljs-string"><span class="hljs-string">"I"</span></span>; iload_3; invokevirtual Method java/io/OutputStream.write:<span class="hljs-string"><span class="hljs-string">"([BII)V"</span></span>; goto L125; L202: aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; invokevirtual Method java/io/OutputStream.flush:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload <span class="hljs-number"><span class="hljs-number">7</span></span>; invokevirtual Method java/io/OutputStream.close:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload_1; invokevirtual Method java/io/InputStream.close:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">io</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">File</span></span></span></span>; astore_1; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload_1; aload <span class="hljs-number"><span class="hljs-number">5</span></span>; invokespecial Method java/io/File.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"(Ljava/lang/String;)V"</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload_1; invokevirtual Method java/io/File.exists:<span class="hljs-string"><span class="hljs-string">"()Z"</span></span>; ifne L201; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">io</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FileNotFoundException</span></span></span></span>; astore_1; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload_1; invokespecial Method java/io/FileNotFoundException.<span class="hljs-string"><span class="hljs-string">"&lt;init&gt;"</span></span>:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; aload_1; astore <span class="hljs-number"><span class="hljs-number">4</span></span>; aload_1; athrow; endtry t0; <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> t0 java/io/IOException; astore_1; aload_1; invokevirtual Method java/io/IOException.printStackTrace:<span class="hljs-string"><span class="hljs-string">"()V"</span></span>; L201: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; }</code> </pre> </div></div><br><p>  <a href=""> </a>   class-    <code>asmtools jasm MainActivity.jasm</code> . </p><br><p>       <code>asmtools</code> :  ,  unicode escape                  . </p><br><p> <a href="http://hg.openjdk.java.net/code-tools/asmtools/rev/2904229ed97e"></a>  : </p><br><pre> <code class="diff hljs"><span class="hljs-comment"><span class="hljs-comment">--- a/src/org/openjdk/asmtools/jasm/Parser.java +++ b/src/org/openjdk/asmtools/jasm/Parser.java @@ -416,6 +416,12 @@ case STRINGVAL: v = scanner.stringValue; scanner.scan(); + if (uncond || (scanner.token == Token.FIELD)) { + if ((!v.contains("/")) // class identifier doesn't contain "/" + &amp;&amp; (!v.contains("["))){ // class identifier doesn't contain "[" + v = pkgPrefix + v; // add package + } + } return pool.FindCellAsciz(v); // Some identifiers might coincide with token names. // these should be OK to use as identifier names.</span></span></code> </pre> <br><p>        : </p><br><div class="spoiler"> <b class="spoiler_title"> MainActivity::a(String)</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String var1)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { StringBuilder var5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); String var12 = var5.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.d).append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.e).append(\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(var1)).toString(); AssetManager var6 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getAssets(); StringBuilder var7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); InputStream var9 = var6.open(var7.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.e).append(var1).toString()); FileOutputStream var14 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(var12); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] var13 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.x]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> var3 = var9.read(var13); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (var3 == \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.b) { var14.flush(); var14.close(); var9.close(); File var10 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(var12); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!var10.exists()) { FileNotFoundException var11 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileNotFoundException(); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> var11; } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> var2 = \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.a; var2 &lt; var3; ++var2) { var13[var2] = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)(var13[var2] ^ \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.l); } var14.write(var13, \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF.a, var3); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException var8) { var8.printStackTrace(); } }</code> </pre> </div></div><br><p>       .     , XOR-     ,     . </p><br><p>          <a href="">  </a> . <br>      <code>try</code> -   <code>catch</code> -,    <code>catch</code> -      ,  ,   ,   ,      <code>try {} catch {}</code>         . </p><br><pre> <code class="java hljs">.method <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> \uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF\uFEFF(Ljava/lang/String;)Ljava/lang/String; .locals <span class="hljs-number"><span class="hljs-number">7</span></span> .param p0, <span class="hljs-string"><span class="hljs-string">"\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff\ufeff"</span></span> # Ljava/lang/String; .prologue :try_start_0 <span class="hljs-comment"><span class="hljs-comment">//      java.security.MessageDigest :cond_0 invoke-virtual {v2}, Ljava/lang/StringBuilder;-&gt;toString()Ljava/lang/String; :try_end_0 .catch Ljava/security/NoSuchAlgorithmException; {:try_start_0 .. :try_end_0} :catch_0 .catch Ljava/io/UnsupportedEncodingException; {:try_start_0 .. :try_end_0} :catch_1 move-result-object p0 :goto_1 return-object p0 :catch_0 move-exception p0 :goto_2 invoke-virtual {p0}, Ljava/lang/Exception;-&gt;printStackTrace()V const/4 p0, 0x0 goto :goto_1 :catch_1 move-exception p0 goto :goto_2 .end method</span></span></code> </pre> <br><p>        ( <code>android.*</code> ,  . .) ,        . </p><br><h1>    </h1><br><p> ,       ,      . </p><br><p>    ,      class-   <code>-ren=1</code>   .     32    .   ,          ,      ,      . </p><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/Initial">   GitHub</a> </p><br><p>        Android Studio. </p><br><p>     <code>MainActivity</code>  ,     resource id  .     apktool  <a href="">res/values/public.xml</a> , <a href="">res/values/strings.xml</a>  <a href="">res/values/ids.xml</a> . </p><br><p>    ,       id ¬´email¬ª,  ‚Äî ¬´serial¬ª,  <code>onCreate()</code>     ¬´Your Android device is rooted!¬ª,   <code>method_1297()</code>      <code>owl.png</code> : </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jk/zr/vw/jkzrvw7ui9nclxpeh5brjoqbhry.png"></div><br><p>  ,    <code>EditText</code>  <code>emailEditText</code>  <code>serialEditText</code> ,      : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle var1)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(var1); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.requestWindowFeature(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getWindow().setFlags(<span class="hljs-number"><span class="hljs-number">1024</span></span>, <span class="hljs-number"><span class="hljs-number">1024</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setContentView(<span class="hljs-number"><span class="hljs-number">0x7f09001b</span></span>); Button var2 = (Button)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.findViewById(<span class="hljs-number"><span class="hljs-number">0x7f070021</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> class_108(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)).method_946()) { Toast.makeText(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Your Android device is rooted!"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).show(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.finish(); } var2.setOnClickListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OnClickListener() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View var1)</span></span></span><span class="hljs-function"> </span></span>{ MainActivity.emailEditText = (EditText)MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.findViewById(<span class="hljs-number"><span class="hljs-number">0x7f07002e</span></span>); MainActivity.serialEditText = (EditText)MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.findViewById(<span class="hljs-number"><span class="hljs-number">0x7f070060</span></span>); MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.method_1297(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!MainActivity.emailEditText.getText().toString().matches(class_170.field_1366) &amp;&amp; !MainActivity.serialEditText.getText().toString().toUpperCase().matches(class_170.field_1366)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (class_46.method_502()) { Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Congratulations! You did it!"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).show(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Login Failed."</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).show(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Login Failed."</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).show(); } } }); }</code> </pre> <br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/ResolveResourceIds">   GitHub</a> </p><br><h1> Root check </h1><br><p>        .  <code>class_108</code>   ,     <code>method_350</code>  <code>class_33</code>   <code>com.scottyab.rootbeer</code> . </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class_108</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// $FF: renamed from: a android.content.Context private final Context field_937; public class_108(Context var1) { this.field_937 = var1; } public boolean method_946() { return (new class_33(this.field_937)).method_350(); } }</span></span></code> </pre><br><p>      <a href="https://github.com/scottyab/rootbeer">   GitHub</a> ,             ¬´su¬ª  ¬´busybox¬ª.    <a href="">com.scottyab.rootbeer.RootBeer::isRooted()</a> </p><br><p> ,        ,    <code>if</code> ,   <code>class_108</code> ,    <code>com.scottyab.rootbeer</code> ,      . </p><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/EliminateRootCheck">   GitHub</a> </p><br><h1>   </h1><br><p>    <code>onCreate()</code>       . <br>              ,    <code>class_170::field_1366</code> ,       <code>class_46::method_502()</code> .  -. </p><br><p>  <code>class_170</code>          . </p><br><p>     : </p><br><div class="spoiler"> <b class="spoiler_title">   class_170</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// $FF: renamed from: q java.lang.String public static String field_1366 = method_1453(method_1452(method_1455(method_1457(method_1451(method_1456(method_1454(method_1458("")))))))); // $FF: renamed from: r java.lang.String public static String field_1367 = method_1453(method_1452(method_1455(method_1457(method_1451(method_1456(method_1454(method_1458("#81]A")))))))); // ... public static String method_1451(String var0) { char[] var2 = var0.toCharArray(); for(int var1 = 0; var1 &lt; var2.length; ++var1) { var2[var1] = (char)(var2[var1] ^ 55); } return new String(var2); } public static String method_1452(String var0) { char[] var2 = var0.toCharArray(); for(int var1 = 0; var1 &lt; var2.length; ++var1) { var2[var1] = (char)(var2[var1] ^ 22); } return new String(var2); } public static String method_1453(String var0) { char[] var2 = var0.toCharArray(); for(int var1 = 0; var1 &lt; var2.length; ++var1) { var2[var1] = (char)(var2[var1] ^ 11); } return new String(var2); } public static String method_1454(String var0) { char[] var2 = var0.toCharArray(); for(int var1 = 0; var1 &lt; var2.length; ++var1) { var2[var1] = (char)(var2[var1] ^ 77); } return new String(var2); } public static String method_1455(String var0) { char[] var2 = var0.toCharArray(); for(int var1 = 0; var1 &lt; var2.length; ++var1) { var2[var1] = (char)(var2[var1] ^ 33); } return new String(var2); } public static String method_1456(String var0) { char[] var2 = var0.toCharArray(); for(int var1 = 0; var1 &lt; var2.length; ++var1) { var2[var1] = (char)(var2[var1] ^ 66); } return new String(var2); } public static String method_1457(String var0) { char[] var2 = var0.toCharArray(); for(int var1 = 0; var1 &lt; var2.length; ++var1) { var2[var1] = (char)(var2[var1] ^ 44); } return new String(var2); } public static String method_1458(String var0) { char[] var2 = var0.toCharArray(); for(int var1 = 0; var1 &lt; var2.length; ++var1) { var2[var1] = (char)(var2[var1] ^ 88); } return new String(var2); }</span></span></code> </pre> </div></div><br><p>       ,         <code>main()</code>       : </p><br><div class="spoiler"> <b class="spoiler_title">class_170::main()</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String... args)</span></span></span><span class="hljs-function"> </span></span>{ System.out.print(<span class="hljs-string"><span class="hljs-string">"package com.kaspersky.zeronights2017.nightwatcher;\n\n"</span></span>); System.out.print(<span class="hljs-string"><span class="hljs-string">"public class class_170 {\n\n"</span></span>); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1350 = \"%s\";%n"</span></span>, field_1350.replaceAll(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>, <span class="hljs-string"><span class="hljs-string">"\\\\n"</span></span>)); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1351 = \"%s\";%n"</span></span>, field_1351); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1352 = \"%s\";%n"</span></span>, field_1352); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1353 = \"%s\";%n"</span></span>, field_1353); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1354 = \"%s\";%n"</span></span>, field_1354); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1355 = \"%s\";%n"</span></span>, field_1355); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1356 = \"%s\";%n"</span></span>, field_1356); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1357 = \"%s\";%n"</span></span>, field_1357); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1358 = \"%s\";%n"</span></span>, field_1358); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1359 = \"%s\";%n"</span></span>, field_1359); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1360 = \"%s\";%n"</span></span>, field_1360); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1361 = \"%s\";%n"</span></span>, field_1361); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1362 = \"%s\";%n"</span></span>, field_1362); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1363 = \"%s\";%n"</span></span>, field_1363); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1364 = \"%s\";%n"</span></span>, field_1364); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1365 = \"%s\";%n"</span></span>, field_1365); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1366 = \"%s\";%n"</span></span>, field_1366); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1367 = \"%s\";%n"</span></span>, field_1367); System.out.printf(<span class="hljs-string"><span class="hljs-string">" public static final String field_1368 = \"%s\";%n"</span></span>, field_1368); System.out.print(<span class="hljs-string"><span class="hljs-string">"\n}\n\n"</span></span>); }</code> </pre> </div></div><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/Class170Main">   GitHub</a> </p><br><p>      : </p><br><div class="spoiler"> <b class="spoiler_title"> class_170</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.kaspersky.zeronights2017.nightwatcher; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class_170</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1350 = <span class="hljs-string"><span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam et maximus eros. Mauris laoreet molestie semper. Aliquam erat volutpat. Sed euismod neque ac ante viverra pellentesque. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Cras efficitur ac augue a mattis. Nunc facilisis elementum lobortis. Ut vehicula malesuada pharetra. Pellentesque a interdum eros, nec pulvinar sem. Morbi dapibus in quam ut ullamcorper. Vivamus volutpat vehicula condimentum.\n\nNullam commodo vestibulum cursus. Aliquam semper ligula ac tortor rutrum molestie. Vivamus nec orci auctor quam vehicula tempor et id neque. Suspendisse fermentum velit ut ipsum pellentesque hendrerit. Fusce convallis aliquam ante non elementum. Donec at scelerisque lacus, eu eleifend nulla. Pellentesque congue nisi in dolor dignissim, non lobortis neque luctus. Mauris ac cursus turpis. Phasellus finibus facilisis justo, convallis mattis lorem lobortis et. Nam ac interdum est. Etiam ac molestie ligula. Maecenas vel purus a odio accumsan venenatis. Nunc ligula dui, pharetra id arcu laoreet, mollis semper leo. Phasellus id magna molestie, semper risus nec, vehicula sem.\n\nDonec eget nisl purus. Phasellus non nisi felis. Aliquam ut odio sit amet neque euismod vulputate non vel mauris. Suspendisse sit amet ligula sed leo condimentum vulputate convallis eu dui. Vestibulum tortor lacus, maximus quis tincidunt a, pretium sed lacus. Maecenas porta dui nisi, vel molestie tortor luctus at. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam odio ante, sollicitudin sed diam quis, ultricies pretium ex. Proin nisi arcu, tristique id leo et, lacinia semper nisi. Fusce posuere lacus at ex pretium venenatis. Sed porta nibh mauris, ut vestibulum nulla aliquam non. Nunc id tortor non nisi blandit volutpat. Phasellus malesuada hendrerit orci a semper. Nam a risus ac arcu dictum imperdiet.\n\nCras ut risus eget leo ultricies dictum vitae et enim. Aliquam erat volutpat. Fusce ut porttitor nisi. Praesent vel pulvinar orci. Aenean ac libero sed tortor sagittis tristique commodo in velit. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nam eu enim orci. Nullam consectetur lobortis tellus, ac facilisis ex dapibus sed.\n\nAliquam mollis eget turpis id vestibulum. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Pellentesque vitae lectus non metus convallis aliquam. Donec rutrum tincidunt quam, iaculis gravida nisl dictum id. Donec malesuada dapibus magna tristique convallis. Curabitur at turpis sed tellus accumsan condimentum. Nam accumsan nisi a ex hendrerit, in sagittis turpis feugiat. Morbi congue et est eu venenatis. Phasellus erat dui, rutrum sit amet fringilla sit amet, imperdiet in nulla. Quisque laoreet neque ac augue sodales, at mollis magna mollis. Mauris nec consectetur purus, quis aliquam leo. Sed lobortis magna efficitur vehicula finibus."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1351 = <span class="hljs-string"><span class="hljs-string">"ABCDEFGHIJKLONMPQRSTVUWXYZabcdefghijlkmnopqrstuvwxyz5193406782+/"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1352 = <span class="hljs-string"><span class="hljs-string">"0123456789ABCDEF"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1353 = <span class="hljs-string"><span class="hljs-string">"dGUzc9RhdGEv"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1354 = <span class="hljs-string"><span class="hljs-string">"/whoami/"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1355 = <span class="hljs-string"><span class="hljs-string">"who"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1356 = <span class="hljs-string"><span class="hljs-string">"am"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1357 = <span class="hljs-string"><span class="hljs-string">"i"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1358 = <span class="hljs-string"><span class="hljs-string">"d9hvLnRyYWkuZWRlYXRh"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1359 = <span class="hljs-string"><span class="hljs-string">"YW5udHJhaW0kZGRhdGE="</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1360 = <span class="hljs-string"><span class="hljs-string">"aS05cmFpbmUlZGF5YQ=="</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1361 = <span class="hljs-string"><span class="hljs-string">"[^"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1362 = <span class="hljs-string"><span class="hljs-string">"=]"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1363 = <span class="hljs-string"><span class="hljs-string">"="</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1364 = <span class="hljs-string"><span class="hljs-string">"AA"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1365 = <span class="hljs-string"><span class="hljs-string">"A"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1366 = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1367 = <span class="hljs-string"><span class="hljs-string">"SHA-1"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String field_1368 = <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>; }</code> </pre> </div></div><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/DecipherClass170">   GitHub</a> </p><br><h1>  BASE64 </h1><br><p>        - ,         ¬´Inline all and remove the field¬ª. </p><br><p>       <a href="">class_87</a> :      <code>"AA"</code> , <code>"A"</code> , <code>"="</code> ,  64-   <code>class_170::field_1351</code> ,   <code>"dGUzc9RhdGEv"</code> , <code>"d9hvLnRyYWkuZWRlYXRh"</code> , <code>"YW5udHJhaW0kZGRhdGE="</code>  <code>"aS05cmFpbmUlZGF5YQ=="</code>    ,     <code>class_87::method_802()</code> .      ,  <code>class_87</code>  BASE64 encoder/decoder   .     ,   <code>class_170::field_1351</code>  <code>U</code>  <code>V</code>  ,       . </p><br><p>   ,        ,          . ,    IDEA/Android Studio  .          . </p><br><p>   <code>class_170</code>      . </p><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/InlineClass170">   GitHub</a> </p><br><p>      BASE64-,       ,         . </p><br><p>      :    <code>field_1181</code>   <code>MainActivity</code>    <code>MainActivity::method_1300()</code> .                     ,            . </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method_1300</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String resourceName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { StringBuilder var5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); String var12 = var5.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.field_1180).append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.field_1181).append(CustomBase64.decode(resourceName)).toString(); AssetManager var6 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getAssets(); StringBuilder var7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); InputStream var9 = var6.open(var7.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.field_1181).append(resourceName).toString()); FileOutputStream var14 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(var12); <span class="hljs-comment"><span class="hljs-comment">// ...</span></span></code> </pre> <br><p>            : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method_1299</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File destDir, String resourceName, String outputFileName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!destDir.exists() &amp;&amp; destDir.mkdirs()) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.method_1300(resourceName, outputFileName); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (destDir.exists() &amp;&amp; !(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.field_1180 + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.field_1181 + resourceName)).exists()) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.method_1300(resourceName, outputFileName); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method_1300</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String resourceName, String outputFileName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { String var12 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.field_1180 + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.field_1181 + outputFileName; AssetManager assets = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getAssets(); InputStream inputStream = assets.open(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.field_1181 + resourceName); FileOutputStream outputStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(var12); <span class="hljs-comment"><span class="hljs-comment">// ...</span></span></code> </pre> <br><p>      ,     .      ,     <code>class_170</code> : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String... args)</span></span></span><span class="hljs-function"> </span></span>{ System.out.printf(<span class="hljs-string"><span class="hljs-string">"\"%s\"\t\"%s\"%n"</span></span>, <span class="hljs-string"><span class="hljs-string">"dGUzc9RhdGEv"</span></span> , decode(<span class="hljs-string"><span class="hljs-string">"dGUzc9RhdGEv"</span></span> )); System.out.printf(<span class="hljs-string"><span class="hljs-string">"\"%s\"\t\"%s\"%n"</span></span>, <span class="hljs-string"><span class="hljs-string">"d9hvLnRyYWkuZWRlYXRh"</span></span>, decode(<span class="hljs-string"><span class="hljs-string">"d9hvLnRyYWkuZWRlYXRh"</span></span>)); System.out.printf(<span class="hljs-string"><span class="hljs-string">"\"%s\"\t\"%s\"%n"</span></span>, <span class="hljs-string"><span class="hljs-string">"YW5udHJhaW0kZGRhdGE="</span></span>, decode(<span class="hljs-string"><span class="hljs-string">"YW5udHJhaW0kZGRhdGE="</span></span>)); System.out.printf(<span class="hljs-string"><span class="hljs-string">"\"%s\"\t\"%s\"%n"</span></span>, <span class="hljs-string"><span class="hljs-string">"aS05cmFpbmUlZGF5YQ=="</span></span>, decode(<span class="hljs-string"><span class="hljs-string">"aS05cmFpbmUlZGF5YQ=="</span></span>)); }</code> </pre> <br><p>   : </p><br><table><thead><tr><th>   </th><th>   </th></tr></thead><tbody><tr><td> dGUzc9RhdGEv </td><td> tessdata/ </td></tr><tr><td> d9hvLnRyYWkuZWRlYXRh </td><td> who.traineddata </td></tr><tr><td> YW5udHJhaW0kZGRhdGE= </td><td> am.traineddata </td></tr><tr><td> aS05cmFpbmUlZGF5YQ== </td><td> i.traineddata </td></tr></tbody></table><br><p>   ,    ,  ,  . </p><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/EliminateCustomBase64Decode">   GitHub</a> </p><br><h1>   </h1><br><p>  ,          <code>class_44</code> ,     . </p><br><p>  ,   <code>class_170</code> ,   ,     .    ,            <code>method_465()</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> field_368 = ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) + method_465(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) ) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) * method_465(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ... public static int method_465(int var0, int var1) { return var0 + var1; }</span></span></code> </pre> <br><p> ,   ‚Äî      .   ¬´Inline all and remove the method¬ª  ,    : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> field_368 = ( ( ( ( ( ( ( ( ( ( ( ( ( ( ( <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-number"><span class="hljs-number">0</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span> ) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>) * (<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre> <br><p>  , IntelliJ IDEA/Android Studio    .         <code>Alt-Enter</code> ,      ¬´Compute constant value of ...¬ª.   ‚Äî        . </p><br><p> ,   .    : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> field_368 = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br><p>    <code>class_44</code> ,     . </p><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/InlineClass44">   GitHub</a> </p><br><h1>   </h1><br><p>     <code>class_46::method_502()</code>     .           ,  ,      ,    : </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class_46</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method_502</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> var0; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">2949</span></span> / <span class="hljs-number"><span class="hljs-number">240</span></span> * <span class="hljs-number"><span class="hljs-number">4</span></span> - <span class="hljs-number"><span class="hljs-number">8</span></span> == MainActivity.serialEditText.getText().toString().toUpperCase().length() &amp;&amp; class_135.method_1132( class_135.method_1133( CustomBase64.encode(MainActivity.field_1179.getBytes()) + MainActivity.emailEditText.getText().toString() ) ).equals(MainActivity.serialEditText.getText().toString().toUpperCase())) { var0 = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { var0 = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> var0; } }</code> </pre> <br><p>   : </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SerialValidator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">validateSerial</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ String email = MainActivity.emailEditText.getText().toString(); String serial = MainActivity.serialEditText.getText().toString().toUpperCase(); String expectedSerial = class_135.method_1132( class_135.method_1133( CustomBase64.encode(MainActivity.field_1179.getBytes()) + email ) ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (serial.length() == <span class="hljs-number"><span class="hljs-number">40</span></span>) &amp;&amp; serial.equals(expectedSerial); } }</code> </pre> <br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/RefactorSerialValidator">   GitHub</a> </p><br><p>      40 ,     .           .  , crackme      ,   . </p><br><p>   ,    ¬´email¬ª  ,    BASE64.        <code>class_135::method_1133()</code> ,       . ,        SHA-1      . </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method_1132</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String var0)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { MessageDigest var2 = MessageDigest.getInstance(<span class="hljs-string"><span class="hljs-string">"SHA-1"</span></span>); StringBuilder var3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(var2.digest(var0.getBytes(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)).length); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> var1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; var1 &lt; var2.digest(var0.getBytes(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)).length; ++var1) { var3 .append(HEX_DIGITS.charAt(var2.digest(var0.getBytes(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>))[var1] &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span> &amp; <span class="hljs-number"><span class="hljs-number">15</span></span>)) .append(HEX_DIGITS.charAt(var2.digest(var0.getBytes(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>))[var1] &amp; <span class="hljs-number"><span class="hljs-number">15</span></span>)); } var0 = var3.toString(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> var0; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (UnsupportedEncodingException | NoSuchAlgorithmException var4) { var4.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } }</code> </pre> <br><p>      ,     <code>MainActivity::field_1179</code> . </p><br><h1>   </h1><br><p>      <code>MainActivity::method_1297()</code> : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method_1297</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// 0x7f060062: type="drawable" name="owl" Bitmap var1 = BitmapFactory.decodeResource(this.getResources(), 0x7f060062); TessBaseAPI var2; if (VERSION.SDK_INT &gt; 19) { this.field_1180 = this.getFilesDir() + field_1354; var2 = new TessBaseAPI(); this.method_1299(new File(this.field_1180 + this.field_1181), "d9hvLnRyYWkuZWRlYXRh", "who.traineddata"); var2.method_997(this.field_1180, field_1355); var2.method_996(var1); field_1179 = var2.method_995(); this.method_1299(new File(this.field_1180 + this.field_1181), "YW5udHJhaW0kZGRhdGE=", "am.traineddata"); var2.method_997(this.field_1180, field_1356); var2.method_996(var1); field_1179 = field_1179 + var2.method_995(); this.method_1299(new File(this.field_1180 + this.field_1181), "aS05cmFpbmUlZGF5YQ==", "i.traineddata"); var2.method_997(this.field_1180, field_1357); var2.method_996(var1); field_1179 = field_1179 + var2.method_995(); } else { this.field_1180 = this.getFilesDir() + field_1354; var2 = new TessBaseAPI(); this.method_1299(new File(this.field_1180 + this.field_1181), "d9hvLnRyYWkuZWRlYXRh", "who.traineddata"); var2.method_997(this.field_1180, field_1355); var2.method_996(var1); field_1179 = var2.method_995().split("\n")[0]; this.method_1299(new File(this.field_1180 + this.field_1181), "YW5udHJhaW0kZGRhdGE=", "am.traineddata"); var2.method_997(this.field_1180, field_1356); var2.method_996(var1); field_1179 = field_1179 + var2.method_995().split("\n")[0]; this.method_1299(new File(this.field_1180 + this.field_1181), "aS05cmFpbmUlZGF5YQ==", "i.traineddata"); var2.method_997(this.field_1180, field_1357); var2.method_996(var1); field_1179 = field_1179 + var2.method_995().split("\n")[0]; } }</span></span></code> </pre> <br><p>     ,     -  ,       <code>field_1179</code> . </p><br><p>    ,    <code>(VERSION.SDK_INT &lt;= 19)</code>   ,   <code>else</code> -   . </p><br><p>   .         <code>com.googlecode.tesseract.android.TessBaseAPI</code> .      native-  Android- OCR- <a href="https://en.wikipedia.org/wiki/Tesseract_%2528software%2529">Tesseract</a> . </p><br><p> ,   <a href="https://github.com/rmtheis/tess-two">tess-two</a> .   ,  API . </p><br><p>      <code>TessBaseAPI</code> ,    , native-,      GitHub.          .  ,  .    ,      .     crackme     ,    . </p><br><p>  Result: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">computeSalt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// 0x7f060062: type="drawable" name="owl" Bitmap bitmap = BitmapFactory.decodeResource(this.getResources(), 0x7f060062); TessBaseAPI tessBaseAPI; if (VERSION.SDK_INT &gt; 19) { this.dataPath = this.getFilesDir() + DIRNAME_WHOAMI; tessBaseAPI = new TessBaseAPI(); this.method_1299(new File(this.dataPath + this.DIRNAME_TESSDATA), "d9hvLnRyYWkuZWRlYXRh", "who.traineddata"); tessBaseAPI.init(this.dataPath, LANGANAME_WHO); tessBaseAPI.setImage(bitmap); SALT = tessBaseAPI.getUTF8Text(); this.method_1299(new File(this.dataPath + this.DIRNAME_TESSDATA), "YW5udHJhaW0kZGRhdGE=", "am.traineddata"); tessBaseAPI.init(this.dataPath, LANGANAME_AM); tessBaseAPI.setImage(bitmap); SALT = SALT + tessBaseAPI.getUTF8Text(); this.method_1299(new File(this.dataPath + this.DIRNAME_TESSDATA), "aS05cmFpbmUlZGF5YQ==", "i.traineddata"); tessBaseAPI.init(this.dataPath, LANGANAME_I); tessBaseAPI.setImage(bitmap); SALT = SALT + tessBaseAPI.getUTF8Text(); } else { // ... } }</span></span></code> </pre> <br><p>  ,                  .  ,     <code>"who"</code> , <code>"am"</code> , <code>"i"</code>     ,     crackme     <code>MainActivity::method_1299()</code> . </p><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/DeobfuscateTessBaseAPI">   GitHub</a> </p><br><p>  <code>MainActivity::method_1299()</code>   : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method_1299</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File destDir, String resourceName, String outputFileName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!destDir.exists() &amp;&amp; destDir.mkdirs()) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.method_1300(resourceName, outputFileName); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (destDir.exists() &amp;&amp; !(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dataPath + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.DIRNAME_TESSDATA + resourceName)).exists()) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.method_1300(resourceName, outputFileName); } }</code> </pre> <br><p>    ,          <code>if</code> ,     -   ,  ,   ,   ,      <code>if</code> .     ,   ,        ‚Äî  . </p><br><p> ,      , ,         Tesseract  Android. </p><br><p> <a href="http://imperialsoup.com/2016/04/29/simple-ocr-android-app-using-tesseract-tutorial/">   </a> ,  : </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File dir)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//directory does not exist, but we can successfully create it if (!dir.exists()&amp;&amp; dir.mkdirs()){ copyFiles(); } //The directory exists, but there is no data file in it if(dir.exists()) { String datafilepath = datapath+ "/tessdata/eng.traineddata"; File datafile = new File(datafilepath); if (!datafile.exists()) { copyFiles(); } } }</span></span></code> </pre> <br><p>  <code>MainActivity::method_1300()</code>        ,  <code>xor 0x14</code>  ,       try-catch . </p><br><p>        ,      : </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yz/fw/q2/yzfwq2cjtt8rfh6dxjbg7reyy70.png"></div><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/DecipherTraineddata/6_Tessdata/tessdata">  *.traineddata  GitHub</a> </p><br><h1>   </h1><br><p>       ,      ,  ,   .   Tesseract  4.xx,       <code>*.traineddata</code>  . </p><br><p>     : </p><br><ul><li> <a href="https://github.com/tesseract-ocr/tesseract/wiki/Downloads">https://github.com/tesseract-ocr/tesseract/wiki/Downloads</a> </li><li> <a href="https://github.com/tesseract-ocr/tesseract/wiki/4.0-with-LSTM">https://github.com/tesseract-ocr/tesseract/wiki/4.0-with-LSTM</a> </li></ul><br><p>  ,       0 DPI,     .        ,       ¬´Raw line¬ª  ,    DPI   . </p><br><pre> <code class="bash hljs">$ tesseract --tessdata-dir ./tessdata -psm 13 -l who owl.png stdout Warning. Invalid resolution 0 dpi. Using 70 instead. 7F6B45B $ tesseract --tessdata-dir ./tessdata -psm 13 -l am owl.png stdout Warning. Invalid resolution 0 dpi. Using 70 instead. 6E8AC25D6A9 $ tesseract --tessdata-dir ./tessdata -psm 13 -li owl.png stdout Warning. Invalid resolution 0 dpi. Using 70 instead. 9E7DB916E40FD0</code> </pre> <br><p>           <code>*.traineddata</code> ,    ‚Äî   ,       ¬´ ¬ª. </p><br><p>       <code>"7F6B45B6E8AC25D6A99E7DB916E40FD0"</code>     <code>SALT</code> ,   <code>com.googlecode.tesseract</code>   ,  , . </p><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/FarewellTesseract">   GitHub</a> </p><br><h1> Keygen </h1><br><p>      . </p><br><p>      <code>K2017Crackme3Keygen</code> ,      E-Mail,      crackme,       <code>SerialValidator::validateSerial()</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kaspersky.zeronights2017.nightwatcher.CustomBase64; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kaspersky.zeronights2017.nightwatcher.MainActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kaspersky.zeronights2017.nightwatcher.class_135; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">K2017Crackme3Keygen</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String... args)</span></span></span><span class="hljs-function"> </span></span>{ System.out.print(<span class="hljs-string"><span class="hljs-string">"E-Mail: "</span></span>); String email = System.console().readLine(); String expectedSerial = class_135.method_1132( class_135.method_1133( CustomBase64.encode(MainActivity.SALT.getBytes()) + email ) ); System.out.printf(<span class="hljs-string"><span class="hljs-string">"Serial: %s"</span></span>, expectedSerial); } }</code> </pre> <br><p>     <code>CustomBase64.encode(MainActivity.SALT.getBytes())</code>      <code>TRUE_SALT</code> ,        ,   : </p><br><div class="spoiler"> <b class="spoiler_title">K2017Crackme3Keygen.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.nio.charset.StandardCharsets; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.MessageDigest; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.NoSuchAlgorithmException; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">K2017Crackme3Keygen</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String LOREM_IPSUM = <span class="hljs-string"><span class="hljs-string">"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam et maximus eros. Mauris laoreet molestie semper. Aliquam erat volutpat. Sed euismod neque ac ante viverra pellentesque. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Cras efficitur ac augue a mattis. Nunc facilisis elementum lobortis. Ut vehicula malesuada pharetra. Pellentesque a interdum eros, nec pulvinar sem. Morbi dapibus in quam ut ullamcorper. Vivamus volutpat vehicula condimentum.\n\nNullam commodo vestibulum cursus. Aliquam semper ligula ac tortor rutrum molestie. Vivamus nec orci auctor quam vehicula tempor et id neque. Suspendisse fermentum velit ut ipsum pellentesque hendrerit. Fusce convallis aliquam ante non elementum. Donec at scelerisque lacus, eu eleifend nulla. Pellentesque congue nisi in dolor dignissim, non lobortis neque luctus. Mauris ac cursus turpis. Phasellus finibus facilisis justo, convallis mattis lorem lobortis et. Nam ac interdum est. Etiam ac molestie ligula. Maecenas vel purus a odio accumsan venenatis. Nunc ligula dui, pharetra id arcu laoreet, mollis semper leo. Phasellus id magna molestie, semper risus nec, vehicula sem.\n\nDonec eget nisl purus. Phasellus non nisi felis. Aliquam ut odio sit amet neque euismod vulputate non vel mauris. Suspendisse sit amet ligula sed leo condimentum vulputate convallis eu dui. Vestibulum tortor lacus, maximus quis tincidunt a, pretium sed lacus. Maecenas porta dui nisi, vel molestie tortor luctus at. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam odio ante, sollicitudin sed diam quis, ultricies pretium ex. Proin nisi arcu, tristique id leo et, lacinia semper nisi. Fusce posuere lacus at ex pretium venenatis. Sed porta nibh mauris, ut vestibulum nulla aliquam non. Nunc id tortor non nisi blandit volutpat. Phasellus malesuada hendrerit orci a semper. Nam a risus ac arcu dictum imperdiet.\n\nCras ut risus eget leo ultricies dictum vitae et enim. Aliquam erat volutpat. Fusce ut porttitor nisi. Praesent vel pulvinar orci. Aenean ac libero sed tortor sagittis tristique commodo in velit. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nam eu enim orci. Nullam consectetur lobortis tellus, ac facilisis ex dapibus sed.\n\nAliquam mollis eget turpis id vestibulum. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Pellentesque vitae lectus non metus convallis aliquam. Donec rutrum tincidunt quam, iaculis gravida nisl dictum id. Donec malesuada dapibus magna tristique convallis. Curabitur at turpis sed tellus accumsan condimentum. Nam accumsan nisi a ex hendrerit, in sagittis turpis feugiat. Morbi congue et est eu venenatis. Phasellus erat dui, rutrum sit amet fringilla sit amet, imperdiet in nulla. Quisque laoreet neque ac augue sodales, at mollis magna mollis. Mauris nec consectetur purus, quis aliquam leo. Sed lobortis magna efficitur vehicula finibus."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String ALPHABET = <span class="hljs-string"><span class="hljs-string">"ABCDEFGHIJKLONMPQRSTVUWXYZabcdefghijlkmnopqrstuvwxyz5193406782+/"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String HEX_DIGITS = <span class="hljs-string"><span class="hljs-string">"0123456789ABCDEF"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TRUE_SALT = <span class="hljs-string"><span class="hljs-string">"N5Y9QjQ1QjZFMEFDOjUENlE0MVV3REI0OTZFNDBGRDA="</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String... args)</span></span></span><span class="hljs-function"> </span></span>{ System.out.print(<span class="hljs-string"><span class="hljs-string">"E-Mail: "</span></span>); String email = System.console().readLine(); String expectedSerial = calculateSha1Hex(method_1133(TRUE_SALT + email)); System.out.printf(<span class="hljs-string"><span class="hljs-string">"Serial: %s"</span></span>, expectedSerial); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method_1131</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s1, String s2)</span></span></span><span class="hljs-function"> </span></span>{ StringBuilder stringBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">256</span></span>; i++) { stringBuilder.append(String.valueOf(s1.charAt(i) ^ s2.charAt(i % s2.length()))); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> encodeCustomBase64(stringBuilder.toString().getBytes()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">method_1133</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span></span>{ StringBuilder stringBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">256</span></span>; i++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> var2 = ((i &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span> | i) &lt;&lt; <span class="hljs-number"><span class="hljs-number">240</span></span> * i) % <span class="hljs-number"><span class="hljs-number">2000000</span></span> % <span class="hljs-number"><span class="hljs-number">2949</span></span>; stringBuilder.append(LOREM_IPSUM.substring(var2, <span class="hljs-number"><span class="hljs-number">1</span></span> + var2)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> method_1131(stringBuilder.toString(), s); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateSha1Hex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes = s.getBytes(StandardCharsets.UTF_8); MessageDigest messageDigest = MessageDigest.getInstance(<span class="hljs-string"><span class="hljs-string">"SHA-1"</span></span>); StringBuilder stringBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(messageDigest.digest(bytes).length); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; messageDigest.digest(bytes).length; i++) { stringBuilder .append(HEX_DIGITS.charAt(messageDigest.digest(bytes)[i] &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xf</span></span>)) .append(HEX_DIGITS.charAt(messageDigest.digest(bytes)[i] &amp; <span class="hljs-number"><span class="hljs-number">0xf</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stringBuilder.toString(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (NoSuchAlgorithmException e) { e.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">encodeCustomBase64</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] bytes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[] alphabetChars = ALPHABET.toCharArray(); StringBuilder stringBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> var1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> var2; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; bytes.length; i += <span class="hljs-number"><span class="hljs-number">3</span></span>) { var2 = (bytes[i] &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xffffff</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span> + i &lt; bytes.length) { var2 |= (bytes[<span class="hljs-number"><span class="hljs-number">1</span></span> + i] &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { var1++; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span> + i &lt; bytes.length) { var2 |= bytes[<span class="hljs-number"><span class="hljs-number">2</span></span> + i] &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { var1++; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> var4 = var2; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(var2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; var2 &lt; <span class="hljs-number"><span class="hljs-number">4</span></span> - var1; var2++) { stringBuilder.append(alphabetChars[(<span class="hljs-number"><span class="hljs-number">0xfc0000</span></span> &amp; var4) &gt;&gt; <span class="hljs-number"><span class="hljs-number">18</span></span>]); var4 &lt;&lt;= <span class="hljs-number"><span class="hljs-number">6</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(var2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; var2 &lt; var1; var2++) { stringBuilder.append(<span class="hljs-string"><span class="hljs-string">"="</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stringBuilder.toString(); } }</code> </pre> </div></div><br><p>   . </p><br><p> <a href="https://github.com/Maccimo/ZeroNights2017Crackme3/tree/Keygen">   GitHub</a> </p><br><h1>  Check </h1><br><p>        <code>Habrahabr</code> . <br>    crackme   ¬´email¬ª,     . </p><br><pre> <code class="bash hljs">$ java K2017Crackme3Keygen E-Mail: Habrahabr Serial: 3C882D5EC917F92D6637F986BA6DAE02CD7E49E3</code> </pre> <br><p>    crackme: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3y/fy/au/3yfyaueb3hikbuqq5hwujfxoiqo.jpeg"></div><br><p>  ,  . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/351142/">https://habr.com/ru/post/351142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351132/index.html">Thymeleaf Tutorial: Chapter 6. Iterations</a></li>
<li><a href="../351134/index.html">Low-level code optimization on the Elbrus platform: vector addition uint16_t using intrinsics</a></li>
<li><a href="../351136/index.html">10 nuances that you need to pay attention to when choosing a VPS hosting</a></li>
<li><a href="../351138/index.html">How to optimize DevOps using machine learning</a></li>
<li><a href="../351140/index.html">Battery change: UPS on Li-Ion technology</a></li>
<li><a href="../351144/index.html">About life, freedom and the pursuit of happiness user API</a></li>
<li><a href="../351146/index.html">Notes on meeting VR platform requirements</a></li>
<li><a href="../351148/index.html">Richard Hamming: Chapter 5. The History of Computers ‚Äî A Practical Application</a></li>
<li><a href="../351150/index.html">Web-based devices</a></li>
<li><a href="../351152/index.html">Immersing in templates and taming Windows GPO</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>