<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to find packages and modules for import into Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apparently, it should start with the discussion of the CPython interpreter version 2.7.x (examples were tested on version 2.7.3). 

 The official site...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to find packages and modules for import into Python</h1><div class="post__text post__text-html js-mediator-article">  Apparently, it should start with the discussion of the CPython interpreter version 2.7.x (examples were tested on version 2.7.3). <br><br>  The official site has descriptions of import instructions and modules in Python: <br><ul><li>  <a href="http://docs.python.org/2/reference/simple_stmts.html">docs.python.org/2/reference/simple_stmts.html#import</a> </li><li>  <a href="http://docs.python.org/2/tutorial/modules.html">docs.python.org/2/tutorial/modules.html</a> </li></ul><br>  It follows from them that in Python there are packages (package), modules (module) and names defined in modules (names).  It should also be noted that in some parts of the documentation modules are called submodules if they are located inside a package. <br><br>  In Python, the import statement allows you to import packages, modules, and names into the namespace in which the import statement is executed.  There are two interesting features: <br><ol><li>  The syntax of the import statement does not always explicitly indicate what exactly should be imported: package, module or name </li><li>  The syntax of the import statement cannot explicitly indicate that the path to the module is an absolute path (although it is possible to explicitly indicate that the path is relative and you can also change the semantics of the instruction, in terms of using the default absolute path, see <a href="http://www.python.org/dev/peps/pep-0328/">www.python.org/dev/ peps / pep-0328</a> ) </li></ol><br>  Of these two features are the following ambiguities for writing import abcd: <br><ol><li>  Import abcd package or import abcd module </li><li>  Import the package / module abcd from the CURRENT PACKAGE (from the package of the module in which import abcd is executed), or FROM the PACKAGE in accordance with the list of directories specified in sys.path </li></ol><br>  More ambiguity examples: <br><ul><li>  from abcd import defg: (import the defg module from the abcd package, or import the defg package from the abcd package, or import the defg name from the abcd package, or import the defg name from the abcd module) X (from the same package, or from the package according to sys.path) </li><li>  import abcd.defg: (import the defg package from the abcd package, import the defg module from the abcd package) X (from the same package, or from a package in accordance with sys.path) </li></ul><br>  To resolve these declarative ambiguities, there must be an imperative algorithm.  Such an algorithm is described in some form in the official Python documentation. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Name search algorithm for import abcd </h1><br>  The search for the name abcd for import occurs according to the following algorithm: <br><table><tbody><tr><th>  No </th><th>  What are we looking for? </th><th>  Where are we looking * </th><th>  Comment </th></tr><tr><td>  one </td><td>  abcd package </td><td>  in the current module package (the module in which import abcd is executed) </td><td>  only if the current module itself is contained in the package ** </td></tr><tr><td>  2 </td><td>  abcd module </td><td>  in the current module package (the module in which import abcd is executed) </td><td>  only if the current module itself is contained in the package ** </td></tr><tr><td>  3 </td><td>  abcd module </td><td>  in built-in modules </td><td>  reference to the documentation is specified in *** </td></tr><tr><td>  four </td><td>  abcd package </td><td>  in directories listed in sys.path </td><td>  reference to the documentation is given in **** </td></tr><tr><td>  five </td><td>  abcd module </td><td>  in directories listed in sys.path </td><td>  reference to the documentation is given in **** </td></tr></tbody></table><br><br>  Further search is terminated if the package is successfully searched for at one of the above listed steps. <br><br>  * Information about the priority of the search package above the module installed empirically, the documentation is not explicitly stated. <br><br>  ** In this case, the __package__ variable of this module is equal to the package name, otherwise it is equal to None. <br>  Link to the documentation: <br>  <a href="http://docs.python.org/2/tutorial/modules.html">docs.python.org/2/tutorial/modules.html#intra-package-references</a> <br>  ‚ÄúIn fact, such references are in the standard module search path.‚Äù <br><br>  (!!!) Here it is worth noting the absence of mention of this fact elsewhere in the same document (http://docs.python.org/2/tutorial/modules.html#the-module-search-path), which is misleading (see <a href="http://bugs.python.org/issue16891">bugs.python.org/issue16891</a> ). <br><br>  (!!!) The second thing to note is that this search step is present only if the module in which import abcd is executed is imported from the package itself (that is, using the import &lt;package name&gt;. &lt;Module name &gt;).  If this module is imported without specifying a package, or the module is executed as a script, this step will be skipped.  This is reflected in the document <a href="http://www.python.org/dev/peps/pep-0302/">www.python.org/dev/peps/pep-0302/#id23</a> : <br>  ‚ÄúThe built-in __import__ function (it can be used in import.c) will be a package or a submodule of a package.  If the package is a submodule  For example, if a package is named "spam" it doesn‚Äôt import eggs, it is a module named "spam.eggs".  If you fail, the module named "eggs". <br><br>  *** <a href="http://docs.python.org/2/tutorial/modules.html">docs.python.org/2/tutorial/modules.html#the-module-search-path</a> <br>  ‚ÄúWhen you first searched for a module with that name.‚Äù <br><br>  **** <a href="http://docs.python.org/2/tutorial/modules.html">docs.python.org/2/tutorial/modules.html#the-module-search-path</a> <br>  ‚ÄúIf you‚Äôve found a file of sys.path. <br><br><h1>  Name search algorithm for import abcd.defg </h1><br><br>  First, the package or module abcd is searched according to the algorithm described for import abcd. <br><br>  If the search is successful, the package or module defg is searched according to the following algorithm: <br><table><tbody><tr><th>  No </th><th>  What are we looking for? </th><th>  Where are we looking * </th><th>  Comment </th></tr><tr><td>  one </td><td>  package defg </td><td>  in abcd package </td><td>  link to the documentation is listed in ** </td></tr><tr><td>  2 </td><td>  defg module </td><td>  in abcd package </td><td>  link to the documentation is listed in ** </td></tr></tbody></table><br>  * If as a result of the search abcd, the latter turned out to be a module, then the import will end with an error ImportError: No module named defg, since  the module cannot contain other modules or packages: <br>  <a href="http://docs.python.org/2/reference/simple_stmts.html">docs.python.org/2/reference/simple_stmts.html#import</a> : ‚ÄúA package can contain other modules or modules.‚Äù <br>  ** <a href="http://www.python.org/dev/peps/pep-0302/">www.python.org/dev/peps/pep-0302/#id23</a> <br>  ‚ÄúDeeper down in the mechanism, a dotted name import is split up by its components.  For "import spam.ham", it is a first submodule of "spam". <br><br><h1>  Name search algorithm for from abcd.defg import ghi </h1><br><br>  First, the package or module abcd.defg is searched in accordance with the algorithm described for import abcd.defg: <br><table><tbody><tr><th>  No </th><th>  What are we looking for? </th><th>  Where are we looking </th></tr><tr><td>  one </td><td>  name ghi </td><td>  in the package or module defg </td></tr><tr><td>  2 </td><td>  ghi package </td><td>  in the defg package </td></tr><tr><td>  3 </td><td>  ghi module </td><td>  in the defg package </td></tr></tbody></table><br><h1>  Name overlap </h1><br><br>  I want to note one interesting feature that follows from the consistent application of the above algorithms.  Imagine the following situation: there is a module called abcd and a package called abcd, which contains, in turn, the module defg, the module abcd and the package abcd are located in different directories, and the module abcd is placed in the same package as the module in which execute import instruction abcd.defg.  In this case, the import will fail.  This is due to the fact that the Python interpreter will first find the abcd module, then try to look for the defg module in it, which is impossible. <br><br>  It would be more reasonable to determine from the syntax of the import statement that abcd can only be a package (since all elements up to a point can only be packages) and search for abcd only as a package.  In this case, the abcd package would be imported from another directory, and the defg module would be found in it and the program would continue to run without errors. <br><br>  Unfortunately, this Python behavior is not implemented.  See <a href="http://bugs.python.org/issue16891">bugs.python.org/issue16891#msg179353</a> . <br><br>  The author of the article encountered this problem, but due to the diversity of the description in the official Python documentation, it took some time to figure out the reasons for this behavior of the interpreter.  As a result, the following discussion has emerged on <a href="http://stackoverflow.com/questions/14183541/why-python-finds-module-instead-of-package-if-they-have-the-same-name">stackoverflow.com/questions/14183541/why-python-finds-module-instead-of-package-if-they-have-the-same-name</a> and <a href="http://bugs.python.org/issue16891">bugs.python.org/issue16891</a> , and also written this article. <br><br>  In the event of such name conflicts, the following solutions are possible: <br><ol><li>  Rename a module or package so that the package name does not match the module name, i.e.  exclude name matching </li><li>  Sometimes it can help to include the absolute default paths for import using the from __future__ import absolute_import statement (in fact in this case, it only increases control over the sequence of searching for packages and modules by making changes to sys.path) </li></ol><br><br><h1>  Application: source code </h1><br>  This repository contains source code that demonstrates the algorithms described above: <a href="https://bitbucket.org/dmugtasimov/python_import">bitbucket.org/dmugtasimov/python_import</a> . </div><p>Source: <a href="https://habr.com/ru/post/166463/">https://habr.com/ru/post/166463/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../166443/index.html">An app that overtakes Instagram</a></li>
<li><a href="../166451/index.html">International Web Camp will come to Russia as part of Windows Azure Summit</a></li>
<li><a href="../166453/index.html">SeoPult Max - by leader pattern</a></li>
<li><a href="../166457/index.html">Internet in numbers: world statistics for 2012</a></li>
<li><a href="../166459/index.html">Students are expelled for using a web vulnerability scanner</a></li>
<li><a href="../166465/index.html">Elophant: at least some access to API League of Legends</a></li>
<li><a href="../166467/index.html">IBM's Watson program went to study in honey. institute</a></li>
<li><a href="../166469/index.html">Dialog boxes in Android. Part 1</a></li>
<li><a href="../166471/index.html">Study for a programmer or a crisscross puzzle</a></li>
<li><a href="../166473/index.html">Ultimatum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>