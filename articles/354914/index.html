<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Setting security for applications on the SAP Cloud Platform cloud platform</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Our cloud platform SAP Cloud Platform has a whole set of embedded services. In this article we will focus on the security topic - we will look at the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Setting security for applications on the SAP Cloud Platform cloud platform</h1><div class="post__text post__text-html js-mediator-article">  Our cloud platform SAP Cloud Platform has a whole set of embedded services.  In this article we will focus on the security topic - we will look at the security services in the Neo environment, as well as the capabilities of the SAP Cloud Platform to ensure the security of the applications and services you have developed. <br><br>  In this article we will discuss the following topics in order to better understand the capabilities of the SAP Cloud Platform security services, as well as what is meant by these or other terms: <br><ul><li>  user authentication </li><li>  authorization management </li><li>  Securely transfer identification information between different environments and applications (‚Äúidentity pooling‚Äù or identity federation) </li><li>  single sign-on technology on the SAP Cloud Platform </li><li>  security difference between business users and platform users </li></ul><br><br><img src="https://habrastorage.org/webt/o9/g5/au/o9g5auwjphpeqzxh4fbpwtbqiec.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Then we will look at a practical example on the free trial account of the SAP Cloud Platform - anyone can create it.  In this section, we describe how the security configuration for an application works, depending on its execution environment (for example, HTML5 and Java). <br><br>  The outline of our article on SAP Cloud Platform security services in the Neo environment: <br><ul><li>  <b>Part 1 (theoretical)</b> .  Security Services Overview </li><li>  <b>Part 2.</b> Setting up security for HTML5 applications </li><li>  <b>Part 3.</b> Configuring Security for Java Applications </li></ul><br><br>  <i>(hereinafter - again a lot of text)</i> <i><br></i> <a name="habracut"></a><br><br><h3>  Part 1. Overview of security services </h3><br><br>  One of the key concepts of the SAP Cloud Platform is that authentication and authorization management in any scenario running on the platform is carried out through the so-called Identity Provider (IdP).  This system is designed for secure user management.  Users can be of different types - regular employees, administrators and others.  The task of securely managing these users, especially securely managing their credentials, is often delegated to the identity provider.  It provides identification information to applications that depend on it to secure the authentication and management of user accounts. <br><br><img src="https://habrastorage.org/webt/-f/n6/ky/-fn6ky-9jofqcbisdqk6he6hn7k.png"><br><br>  No one wants to keep track of thousands of user accounts, create new users and new passwords over and over.  Most of us have a huge list of passwords and user accounts for various applications that we have to work with daily.  Isn't it easier to centralize user management?  This will allow you to reuse existing accounts.  For this purpose, and there is an identity provider that securely stores the user account and manages it.  The SAP Cloud Platform offers integration with any identity provider that you, as an application developer, want to use to manage user accounts. <br>  For example, in a productive scenario, users are employees who use the new application based on the SAP Cloud Platform.  In this case, the user's corporate directory is the identity provider. <br><br>  For a B2C scenario, the user account can be a social network account - Twitter, Facebook, Google, etc.  In this case, social networks take on the role of an identity provider. <br><br>  The SAP Cloud Platform also offers an identity provider from SAP as an option.  Therefore, if you want to get started quickly and you do not have an identification provider that allows you to quickly set up several accounts for testing, then you can always use the SAP ID service as a standard identification provider.  It manages a fairly large number of user accounts for SAP.  For example, the user of the SAP ID service is your trial account user in the SAP Cloud Platform or, if you are an SAP client, your S-user.  However, SAP ID has some limitations from the point of view of the developer who wants to deploy the application on the SAP Cloud Platform platform and use this service as a provider.  You cannot control the process of registering a user in the SAP ID and cannot simply remove a user from this user base, because this is an SAP user base. <br><br>  So, the first option of the provider is the SAP ID: <br>  SAP Online Identity Provider <br><ul><li>  Free service </li><li>  Default Identity Provider for Business Applications Running in Free SAP CP Trial Accounts </li><li>  Default Identity Provider for the SAP Cloud Platform control panel and console client </li></ul><br><br><img src="https://habrastorage.org/webt/1o/hs/4u/1ohs4ucjghn33oz7ejiatylngm8.png"><br><br>  If you want to have your own tenant with full control, then you can use the cloud identity provider, which is provided as part of the service in the SAP Cloud Platform and is called the Identity Authentication service.  This service is similar to the SAP ID, but it is provided as your own tenant, which you as a customer can use to fully manage the user base in this tenant.  You can also customize the look, user interfaces, place your own logo.  And most importantly, you can control the level of security in terms of the password policy that you set for your tenant and for users in it.  For example, if you use it for a client scenario, then the requirements may not be as strict as for employees who need to change their passwords every three months (or something like that).  Thus, the integrated SAP Cloud Platform service is more functional in comparison with the free SAP ID.  However, it is paid - on the free trial account Identity Autentification service will not be available. <br><br>  The second option is Identity Authentication: <br><ul><li>  Cloud Identification Lifecycle Management Solution </li><li>  Recommended and pre-configured identity provider for a business application in a productive SAP Cloud Platform account </li><li>  Custom Identity Provider for SCP Control Panel and Console Client </li><li>  Paid service </li></ul><br><br><img src="https://habrastorage.org/webt/dn/fz/xc/dnfzxcvjtcx4i8ixxbn0nia4toi.png"><br><br>  What if you need the ability to integrate with your existing corporate identity provider?  In the SAP Cloud Platform, this is a prerequisite.  In this scenario, both the SAP provider and third-party providers are supported ‚Äî for example, Microsoft Active Directory.  The only condition for integration with the selected provider is that it must be compatible with the SAML 2.0 security markup language, a well-known standard in this space.  This protocol is supported not only by SAP, but also by almost any other identity provider. <br>  In this way, you can very easily integrate the platform and your applications running on the SAP Cloud Platform with your identity provider. <br><br>  The third option is a corporate identity provider: <br><ul><li>  Customizable identity provider for SAP CP business applications in any account (trial and production) </li><li>  Includes integration with corporate identity and access control (IAM) </li><li>  Prerequisite: SAML 2.0 compliance </li></ul><br><br><img src="https://habrastorage.org/webt/gu/y2/3d/guy23dmwmozsimpfnjxal99qc4s.png"><br><br>  Now consider the different types of users and options for using the identity provider depending on this. <br><br>  In fact, there are almost no restrictions.  There are two types of users: business users and platform users.  This terminology can be found in almost any topic related to the SAP Cloud Platform.  Business users are authorized as an end user for applications running on the SAP Cloud Platform.  For example, if you use SuccessFactors, then you have a business user managing employee data.  A private user who logs in, for example, through your Twitter account, can also be used as a business user.  Thus, a business user is the end user. <br><br>  Platform users are users who perform administrative tasks on the platform.  There are far fewer such users compared to business users.  Typically, they are the developers or administrators of your application and, as a rule, work with tools such as the control panel (Cloud Cockpit), the console client, or the Eclipse tools for interacting with the platform. <br><br>  The figure below shows the options for the use of identity providers, depending on the type of user, as well as some recommendations. <br><br><img src="https://habrastorage.org/webt/qm/mt/rw/qmmtrwog7jj2ptwa45foo3klrso.png"><br><br>  A business user can use the SAP ID service as a provider.  However, for productive scenarios, it is recommended to use the SAP Cloud Platform Identity Authentication service or the corporate provider to have full control and use the SAP ID for testing. <br><br>  The platform user can also use all three types of identity providers: SAP ID, SAP Cloud Platform Identity Authentication and your corporate IDP.  But such a user has some restrictions on the use of corporate IDP: in this scenario, it will not be possible to use the console client for the Neo environment to authenticate users of the platform.  As a result, you get a fairly rich set of options. <br><br>  Now let's talk a little about authorization in the SAP Cloud Platform.  If you are a user of the platform, then you are assigned roles at the platform level.  In the Neo environment, these may be predefined roles ‚Äî for administrators, developers, or support users.  In the Neo SAP Cloud Platform environment, a set of predefined roles is provided, and if you, for example, use a productive account and are an administrator in it, you can assign any of these roles to your account participants.  By the way, users of the platform are the members of the account.  In the control panel there is a tab in the menu called ‚ÄúMembers‚Äù (or ‚ÄúParticipants‚Äù) - this is where you can add users to the platform and assign roles to them. <br><br><img src="https://habrastorage.org/webt/dk/_g/bf/dk_gbfncewydaog8yav3atwbduq.png"><br><br>  For business users, this process is a little different.  You should be able to assign roles to thousands or even tens of thousands of business users.  Here we are not talking about roles at the platform level, but about the roles defined by your business applications.  To assign a role to a business user, you can log into the SAP Cloud Platform control panel through your user platform and ‚Äústatically‚Äù add business users to those roles defined by business applications. <br><br>  But imagine that at some point in time this model no longer scales, especially if you need to assign a huge number of business roles to an equally large number of business users.  For this task in the Neo environment, you can use "groups".  Basically, these groups cover one or several application roles in one object on the platform, and after adding a business user to such a group, the user is automatically assigned to all these business roles from the applications assigned to this group.  You can use some properties that users can set here.  For example, if users belong to a department that operates mainly in Moscow, then they should only see data from Moscow. <br><br>  Thus, assigning roles to a business user through the settings of your application in the SAP Cloud Platform dashboard can only be done statically - this means that you assign the user with the identifier ‚Äúabc‚Äù to the role ‚Äúxyz‚Äù, and as long as you do not change (for example, delete the user ID), the role will be assigned. <br>  Assigning a business user to a group can also be done statically ‚Äî that is, you assign that user to the ‚Äúabc‚Äù group, and then you will not have to assign each role separately.  This can be done dynamically, i.e.  based on an attribute that is shared by thousands or millions of business users.  This attribute can be used in a runtime environment when a user is authorized in an application on the SAP Cloud Platform to assign a user to a group dynamically based on this attribute and its value. <br><br>  For the administrator (platform user), this means that you do not need to perform actions to assign roles each time. <br><br>  As soon as the attribute changes, and the value of these attributes of the union usually changes in the basic user base, then when the user logs on to the system, the next time the role is assigned or not, depending on the value of this attribute. <br><br><img src="https://habrastorage.org/webt/gt/21/of/gt21off6b7bbypnlbh6jjwzjd30.png"><br><br><h3>  Part 2. Setting up security for HTML5 applications <br></h3><br><br><img src="https://habrastorage.org/webt/gd/kh/m1/gdkhm1lny9g6jdff5e5ypejivr4.png"><br><br>  Many users of the SAP Cloud Platform usually use HTML5 and Java to build their applications in the Neo environment.  The implementation of the user interface of a business application with modern technology based on the Fiori and SAPUI5 libraries occurs in the HTML5 part of the application.  More complex business logic can be in a backend system ‚Äî for example, on a corporate network or a specific SAP system, usually implemented in Java.  Both HTML5 and Java applications make sense if they interact with each other.  Each of them implements different, but complementary functions. <br><br>  In this part we will look at the HTML5 application.  xProject is a simple project management application.  For example, employees can use the application on the SAP Cloud Platform to manage projects and track time spent on various tasks in the enterprise. <br><br>  If you are a member of a working group of a specific project, then this application should allow you to log in and record the time spent on various projects in the enterprise.  There is also a group of users who are administrators in this application. <br><br>  Thus, we have business users who are divided into two groups.  There is also an HTML5 application that is used as an interface, and a Java application for the backend.  In our case, the Java part of the application offers a RESTful API that uses the HTTP protocol to provide this business function to the component that wants to use it.  Web applications offer APIs for the user interface, as well as for other customers who can use the business functionality offered by the Java part of the application. <br><br><img src="https://habrastorage.org/webt/hk/t_/vt/hkt_vtr1htbiedy3qc4fgpfjzj0.png"><br><br>  Consider in detail the HTML5 application and authentication of business users.  As we have already found out, we have a choice of identity providers.  The concept of the SAP Cloud Platform is to delegate authentication to an identity provider.  For this scenario, we will use the SAP ID as the identity provider, so the HTML5 application delegates the SAP ID authentication.  We will consider end-user authentication, their authorization on the HTML5 side, and the process of obtaining specific user information by using user information from the SAP ID service in the HTML5 application.  This makes it possible to read user attributes - for example, the user name.  But the SAP ID service uses a limited set of attributes: first name, last name, email address, and display name.  We can use these attributes on the HTML5 side for display to the user. <br><br>  For testing, we need an HTML5 demo application called xProject, which can be found in <a href="https://github.com/raepple/xprojectHTML5">the GitHub repository</a> :. <br>  Use the instruction in the README.md in this repository to download the application to the SAP Cloud Platform. <br><br>  To create a trial account in the SAP Cloud Platform, <a href="https://account.hanatrial.ondemand.com/cockpit">follow the link</a> .  Then select ‚ÄúNeo Trial‚Äù as the medium on the home page (if a trial account is used) and go to the tab ‚ÄúApplications‚Äù -&gt; ‚ÄúHTML5 Applications‚Äù.  Next you need to implement the steps described in GitHub. <br><br>  As a result, you get a running HTML5 application. <br><br><img src="https://habrastorage.org/webt/l8/dc/zt/l8dcztpvoq7pqgviq3_zfeplgh0.png"><br><br>  In the Web IDE, you can familiarize yourself with the code and functions responsible for the security of the application. <br><br>  Go to the Web IDE and open the file "neo-app.json".  This file is a deployment descriptor for HTML5 applications.  It is here that properties are added to implement authorization, so that not every user is allowed to access applications, but only those who are project members or project managers in the xProject application. <br><br><img src="https://habrastorage.org/webt/t2/_b/ln/t2_blnirlf85vk-sa_rwvqot_t0.png"><br><br>  Consider the code snippet of the ‚Äúneo-app.json‚Äù file: <br><br> <code><i>} <br> "authenticationMethod": "none", <br> ... <br> "routes": [‚Ä¶ <br> ], <br> "securityConstraints": [ <br> { <br> "permission": "accessProjectData", "description": "Access Project Data", "protectedPaths": [ <br> "/protected/" <br> ] <br> } <br> ], <br> ... <br> }</i></code> <br> <br>  The first step is to identify the authentication methods.  If you want to secure the HTML5 application in such a way that each individual source is protected, then you must use ‚ÄúSAML‚Äù as the authentication method, which is the first property in this snippet. <br><br>  But, apparently, in our case "none" is used.  This means that we also have publicly available sources in the script.  Thus, if you have sources that should be accessible to everyone (for example, it can be the home page of the application), this is the parameter specified.  In the event that you use ‚Äúnone‚Äù as an authentication method, then you also need to specify in the deployment descriptor file what exactly should be protected and accessible only to users belonging to a particular role.  In our case, the application defines the path that precedes ‚Äúprotected‚Äù (therefore, it is written ‚Äú/ protected /‚Äù), and everything under it should be accessible only to users who have a specific role. <br><br>  In the HTML5 deployment descriptor, you specify this secure access by declaring a permission called Access Project Data.  Later in the control panel (cockpit), we will assign a role to this permission, which can then be assigned to users through this path.  But at the same time, this means that users who do not have this permission also get access to the application - but only to its public parts. <br>  Now let's look at another code snippet, which is also presented in the neo-app.json file: <br><br> <code><i>} <br> ... <br> "logoutPage": "/logout.html", ... <br> "cacheControl": [ <br> { <br> "directive": "private", <br> "maxAge": 0, <br> "path": "/protected/*html" <br> }, <br> ... <br> }</i> <br></code> <br><br>  After logging into the application, you can also log out, and this property in the deployment descriptor is called ‚ÄúlogoutPage‚Äù. <br><br>  It determines what the page should be for redirecting the user after clicking on the exit button from the application.  To ensure that your browser does not display the cached page after exit, you need to define the maximum period of "0" for these pages in HTML5.  This means that they will not be cached.  Otherwise, you may be faced with the fact that after clicking on ‚ÄúLogout‚Äù the user will not actually log out, because the browser will actually show you the cached page.  Or the user will be logged out, but the page will display the information as if the user is still in it.  A little later, we will look at how you can check whether this exit request is being executed and how this exit request can be traced in the browser. <br><br>  Let's move on to the following code snippet, presented in the neo-app.json file: <br><br> <code>... <br> <i>"routes": [ <br> { <br> "path": "/services/userapi", <br> "target": { <br> "type": "service", <br> "name": "userapi" <br> } <br> },</i> <br> ...</code> <br> <br>  After successful login, the user should see some data.  As already mentioned, when using the SAP ID service, we only have a very limited set of available information about the user: first name, last name, and email address.  To see them, you need to specify access to the API for HTML5 applications, which gives information about the user by writing the path "/ services / userapi" in the file "neo-app.json". <br><br>  After that, you can use the JSON model, which refers to the specified path to access information about the current user.  The JSON model uses data from the SAP ID service or any other identity provider and displays the user information in your HTML5 application. <br><br>  Let's return to the SAP Cloud Platform control panel, where we can access the HTML5 application downloaded from GitHub and assign roles to users. <br><br>  Go to the control panel environment Neo.  Select "HTML5 Applications" in the "Applications" tab, then click on the application with the name "xproject".  You will see a window with detailed information about the application: <br><br><img src="https://habrastorage.org/webt/sg/rt/-v/sgrt-velpede5qfgavebkpz-5_k.png"><br><br>  In the Overview tab, find the description of the permissions for accessing the Application Permissions application.  As you can see, here is the resolution described in the ‚Äúneo-app.json‚Äù file with the name ‚ÄúaccessProjectData‚Äù. <br><br><img src="https://habrastorage.org/webt/yh/pl/1m/yhpl1m_waafofu95jeyqb0lngnk.png"><br><br>  Now the permission ‚ÄúaccessProjectData‚Äù is assigned by default to all users who have an account developer role.  These are users who have such a role in the members section of your Members account at the platform level (there is no such tab in the trial account, because it can have only one participant and all possible roles have already been assigned to it). <br><br>  Of course, you can not change anything - in this case, you as the account developer will have access to the application and the system.  But we will do it a little differently and add our business role.  Then we assign users to whom we want to give access. <br><br>  To do this, go to the tab "Roles".  As you can see, initially the list of roles is empty.  Click on "New Role" to create a new business role. <br><br><img src="https://habrastorage.org/webt/jj/mh/76/jjmh76ezhee0g2maj_jkdzwlveu.png"><br><br>  In the window that opens, enter the name of the role: ‚ÄúEmployee‚Äù and save the changes. <br><br><img src="https://habrastorage.org/webt/fn/9f/t0/fn9ft0e8jpg8qgxuvinnbkhip0a.png"><br><br>  Now you need to assign this role to the business user.  To do this, click "Assign": <br><br><img src="https://habrastorage.org/webt/o9/e1/u5/o9e1u5s_g71q-fwy28r1wckebvs.png"><br><br>  After that, a window will appear where you will need to enter a user ID. <br><br>  Enter in the user ID field of another trial account.  After assigning this business role to permissions, a user of another account in the Neo environment will have access to this application.  And since the information about this user is stored in the SAP ID, we will use it in our scenario as an identification provider.  We are similar to using its login credentials. <br><br>  If you do not have a second trial account, you can create one and enter the user ID of this account in this field. <br>  For example, the user id of my second account is p1943269512.  I enter this data in the ‚ÄúUser ID‚Äù field.  Please note that the username must be entered without trial at the end. <br><br>  Then you need to click "Assign". <br><br><img src="https://habrastorage.org/webt/7c/js/fc/7cjsfc2cawt511yjwba_8n3gc2k.png"><br><br>  This is how the page will look after assigning a user to the role ‚ÄúEmployee‚Äù.  As you can see, the user who will be allowed to access the application is different from the user under which we are in the control panel in the SCP where the application is deployed. <br><br><img src="https://habrastorage.org/webt/bo/rl/o2/borlo29kedyv_cn5hcu7wxdtarm.png"><br><br>  Now we need to go back to the ‚ÄúOverview‚Äù tab and assign the ‚ÄúEmployee‚Äù business role to the ‚ÄúaccessProjectData‚Äù permission.  To do this, find the tab "Application Permissions" and click on "Edit" to edit. <br><br><img src="https://habrastorage.org/webt/1w/py/ja/1wpyjavaasi2spa5bqzn_ch0s3c.png"><br><br>  Opposite the permission ‚ÄúaccessProjectData‚Äù, select ‚ÄúEmployee‚Äù instead of ‚ÄúAccountDeveloper‚Äù as the role and click ‚ÄúSave‚Äù. <br><br><img src="https://habrastorage.org/webt/8q/pe/07/8qpe07jqew1ykh7rro-eqd7hyu0.png"><br><br>  Let's try to run the application.  To do this, simply click on the link to the application in the Overview tab. <br><br><img src="https://habrastorage.org/webt/nk/kt/qi/nkktqinsgxxfqqafcpltra_uiha.png"><br><br>  Please note that the application window must be opened in incognito mode; otherwise, when you try to log in, you can use the account information of the account where you deployed the application, and not the ones you specify.  In this case, you will get the error "HTTP Status 403 - Forbidden". <br><br><img src="https://habrastorage.org/webt/dv/mo/td/dvmotdssqx_dnrgs2qv7lsqg7a4.png"><br><br>  You will see the initial page of the application, which is available to all users.  To gain access to other resources that are under a secured path, you need to authenticate.  When you click the Login button, this action will force the HTML5 runtime to redirect the user to the identity provider (in our case, this is the SAP ID). <br><br>  Click on the "Login" button to log in: <br><br><img src="https://habrastorage.org/webt/xn/sk/t0/xnskt05ceacvxmdjwv7c_yvytww.png"><br><br>  In the window that appears, enter the name and password of the user that we added to the role ‚ÄúEmployee‚Äù, and then click ‚ÄúLogin‚Äù. <br><br><img src="https://habrastorage.org/webt/f0/c7/-v/f0c7-vy5wx19u-oqpa3mdbzrngi.png"><br><br>  After successful login, we receive an error message about access to the backend, as well as red ‚ÄúRole not assigned‚Äù inscriptions.  This happens because for the time being HTML5 does not interact with a Java application acting as a backend. <br><br><img src="https://habrastorage.org/webt/pw/uf/ct/pwufctykkbqgcuaia4cnwtvov0g.png"><br><br>  Thus, we logged in as a user to an HTML5 site, authenticated, and received permission to access this page.  Obviously, the user information that was used to log in is now shared between the SAP ID service and the HTML5 application using the user interface API.  The user information that you see in the welcome window comes from the SAP Service ID. <br><br>  Now let's look at logging out using SAML tracing.  You can open it in the Developer Tools section of Google Chrome or install and open it in Mozilla Firefox.  Press the "Exit" button as an icon in the upper right of the screen. <br><br><img src="https://habrastorage.org/webt/fi/9n/_l/fi9n_ldwe48ei0kggnoyqubmuwe.png"><br><br>  Check if an exit request was sent in the SAML trace window. <br><br><img src="https://habrastorage.org/webt/hv/ya/gd/hvyagdfc8a7hq8wb8b9_4xgd7hw.png"><br><br>  As can be seen from the SAML protocol, the request has been sent, which means you can be sure that you have logged out.  If you now click "Login", then you will need to pass authentication again. <br><br><h3>  Part 3. Setting Security for Java Applications <br></h3><br><br>  The Java application contains business logic, cares about the integrity of our data and allows users to manage their projects and report the time they spent on these projects. <br><br>  In the HTML5 application setup, we looked at end-user authentication and used the SAP ID service for this.  As a result, we have an authenticated user, which should now be transferred to the Java part of our xProject application.  And now we need to understand how the end user is authenticated in a Java application?  How does an authenticated user, or a different "principal", gain access to the Java application from the user interface (from the HTML5 application)?  When does a user interface use a Java application-related API to use Java business logic?  And the main question: how to implement this mechanism for accessing Java via HTML5?  This method is also called ‚ÄúPrincipal Propagation‚Äù. <br><br>  Since the user gets access to the project data in this scenario, we need to apply a role-based authorization model in the Java application backend and implement the ability to set the user permission to view the data. <br><br>  In the HTML5 application, our authorization model was pretty tough.  We defined one permission, ‚ÄúaccessProjectData‚Äù, to which the ‚ÄúEmployee‚Äù business role was assigned, and we added a business user to this role.  Thus, this user has access to the part of the user interface of the application after successful login using the SAP ID service. <br><br>  Now we want to access our data, which is managed and stored on the side of the Java application of our application.  We need to organize a more detailed concept of authorization using two roles. <br><br><img src="https://habrastorage.org/webt/mq/lo/co/mqlocoiofdt_bx5lljcu_bb3mha.png"><br><br>  Consider a script authorization model.  When it comes to accessing data in the backend, we need to apply a more detailed authorization model, compared to the model on the HTML5 side.  For our script, we use two different roles that are defined in Java.  One is for project members, and the other is for project managers.  Project participants can designate their time in projects that are assigned to them, and project managers in the application can also create new projects and execute the administrative part in a business application.  Project managers can assign project participants, delete them, and so on.  Thus, all administrative elements will be available only to users who are assigned the role of project manager, and the remaining elements - to project participants. <br><br><img src="https://habrastorage.org/webt/zp/js/z8/zpjsz8qwr8jfoon-rrk-_qlmxcc.png"><br><br>  We need a Java demo application called xProject, which can be found <a href="https://github.com/raepple/xproject">in the GitHub repository</a> . <br><br>  Following the steps in README.md in this repository, upload this application to the SAP Cloud Platform through the Eclipse NEON development environment.  Note that you will need to install the ‚ÄúSAP Cloud Platform Tools for Java‚Äù in Eclipse.  To do this, go to the menu Help -&gt; Install new Software ... in the window that opens, enter the URL <a href="https://tools.hana.ondemand.com/neon/">tools.hana.ondemand.com/neon</a> and install the necessary components. <br><br>  Authentication requirements are typically specified in the deployment descriptor for setting up security for a Java application.  Like the ‚Äúneo-app.json‚Äù file for an HTML5 application, we also have a corresponding deployment descriptor for Java-based applications ‚Äî it's called ‚Äúweb.xml‚Äù. <br><br>  Referring to the source code of this application in Eclipse, to consider the authorization and authentication methods described in the aforementioned file "web.xml". <br><br><img src="https://habrastorage.org/webt/7j/9m/il/7j9mil77hkmbuzbtw4ohtfrud9k.png"><br><br>  Its most important part is the login-config property, which describes the authentication method, i.e.  What authentication mechanism should be used to authenticate your business users: <br><br>  <i>...</i> <i><br></i>  <i>&lt;login-config&gt;</i> <i><br></i>  <i>&lt;auth-method&gt; FORM &lt;/ auth-method&gt;</i> <i><br></i>  <i>&lt;/ login-config&gt;</i> <i><br></i>  <i>...</i> <i><br></i> <br><br>  In our scenario, as can be seen from the fragment, the FORM method is used.  FORM allows you to use SAML based authentication, since  we always delegate authentication to the identity provider of your choice, compatible with SAML 2.0.  The FORM method also describes ‚Äúapplication-to-application SSO‚Äù or ‚Äúsingle sign-on to the application‚Äù, which provides interaction between applications.  Therefore, the input configuration must always be specified in ‚Äúweb.xml‚Äù. <br>  To access the HTML5 component that calls the Java backend APIs, you need the following fragment in the same file: <br> <code><i>"routes": [ <br> ... <br> { <br> "path": "/api/projects", <br> "target": { <br> "type": "destination", <br> "name": "projectAPI" <br> }, <br> "description": "Project API" <br> }, <br> ... <br> ], <br> ...</i></code> <br> <br>  These APIs are called through so-called ‚Äúdestinations‚Äù or ‚Äúdestinations‚Äù.  You set up your destination whenever you make a call to a component that is on or outside the SAP Cloud Platform.  That is, you need to specify the name of the destination in the application call component.  In our case, this will be part of HTML5. <br><br>  In the deployment descriptor ‚Äúneo-app.json‚Äù, the path to the API for retrieving project data from the backend is configured as a destination that refers to a destination named ‚ÄúprojectAPI‚Äù.  Then we will use this name in the SAP Cloud Platform control panel when we create a destination.  In fact, we will need two destinations: one to retrieve project data, and the other to get data for a schedule that people will watch through the application.  These two items are necessary for an HTML5 application to successfully invoke a Java backend.  They will be created in the SCP control panel so that the HTML5 application can understand which URLs will access the Java application.  That's why we need to specify the actual URL and the technical endpoint of the URL API provided by the Java application. <br><br>       HTML5,        .   - ,      ‚Äì   . <br><br>        ¬´web.xml¬ª: <br><br> <i><code>... <br> &lt;security-role&gt; <br> &lt;role-name&gt;ProjectManager&lt;/role-name&gt; <br> &lt;/security-role&gt; <br> &lt;security-role&gt; <br> &lt;role-name&gt;ProjectMember&lt;/role-name&gt; <br> &lt;/security-role&gt; <br> ... <br> &lt;security-constraint&gt; <br> &lt;web-resource-collection&gt; <br> &lt;web-resource-name&gt;Protected APIs&lt;/web-resource-name&gt; <br> &lt;url-pattern&gt;/api/v1/*&lt;/url-pattern&gt; <br> &lt;/web-resource-collection&gt; <br> &lt;auth-constraint&gt; <br> &lt;role-name&gt;ProjectManager&lt;/role-name&gt; <br> &lt;role-name&gt;ProjectMember&lt;/role-name&gt; <br> &lt;/auth-constraint&gt; <br> &lt;/security-constraint&gt; <br> ...</code> <br></i> <br><br>    ,       Java-:     .         .          ¬´web.xml¬ª  Java    . <br><br>      SCP,        .  ,      ,      API-  Java   ,         ,    .  ,         ,   ‚Äî      . <br><br> ,      SCP     GitHub.       SCP. <br><br>      SAP Cloud Platform, <a href="https://account.hanatrial.ondemand.com/cockpit"> </a> .  ¬´Neo Trial¬ª       (   )     ¬´Applications¬ª -&gt; ¬´Java Applications¬ª. <br><br><img src="https://habrastorage.org/webt/3e/vk/so/3evksogw3yjg85ftvibw5l8to04.png"><br><br>  , Java-   ¬´xproject¬ª       SCP. <br>          . <br>    ¬´Security¬ª -&gt; ¬´Trust¬ª.  ,   ¬´Principal Propagation¬ª  ¬´ ¬ª   .   ,    ¬´Edit¬ª. <br><br><img src="https://habrastorage.org/webt/e0/gc/kf/e0gckf6xvndxkkhwewgyewtkbx8.png"><br><br>    ¬´Principal Propagation¬ª  ¬´Enabled¬ª,    . <br><br><img src="https://habrastorage.org/webt/mi/n2/sr/min2sruthfeigrzdy8a-5ongd7k.png"><br><br>  ¬´Principal Propagation¬ª         .   ,       ,           .  ,   ¬´Application-to-application SSO¬ª. <br><br>    ¬´Connectivity¬ª -&gt; ¬´Destinations¬ª,    .      API-. <br>        ¬´projectAPI¬ª  ¬´timesheetAPI¬ª <a href="https://github.com/raepple/xproject"> GitHub</a> ,         . <br><br><img src="https://habrastorage.org/webt/xm/ds/dp/xmdsdpyxoevepncrqfl6qkechk0.png"><br><br>     ¬´Import Destinations¬ª    . <br><br><img src="https://habrastorage.org/webt/ff/3n/ey/ff3neyjqwsevlhtol87kc5gkndk.png"><br><br>      ¬´projectAPI¬ª. <br><br>    URL   : <a href="https://xprojectxyz.hanatrial.ondemand.com/xproject/api/v1/web/projects/">xprojectXYZ.hanatrial.ondemand.com/xproject/api/v1/web/projects</a> . <br><br>   ¬´XYZ¬ª                   .      Java- ¬´xproject¬ª,     ¬´Applications¬ª -&gt; ¬´Java Applications¬ª. <br><br>   ¬´Overview¬ª    Java-.  Here's what it looks like: <br><br><img src="https://habrastorage.org/webt/cv/sx/my/cvsxmyi1jekdtemtmesehqh5rts.png"><br><br>         ¬´api/v1/web/projects/¬ª.     : <a href="https://xprojectp2000075844trial.hanatrial.ondemand.com/xproject/api/v1/web/projects/">xprojectp2000075844trial.hanatrial.ondemand.com/xproject/api/v1/web/projects</a> . <br><br>     URL    ¬´projectAPI¬ª,     ¬´Save¬ª. <br><br><img src="https://habrastorage.org/webt/gq/pt/k9/gqptk9o0wr9e8t0nsuamsptjipe.png"><br><br> ,     ¬´AppToAppSSO¬ª,     ¬´Principle Propagation¬ª. <br>          ¬´timesheetAPI¬ª:  URL  Java-   ¬´api/v1/web/timesheets/¬ª.      : <br><br> <a href="https://xprojectp2000075844trial.hanatrial.ondemand.com/xproject/api/v1/web/timesheets/">xprojectp2000075844trial.hanatrial.ondemand.com/xproject/api/v1/web/timesheets</a> . <br><br>     URL   ¬´timesheetAPI¬ª   . <br><br><img src="https://habrastorage.org/webt/qm/un/ub/qmunubbqgbvdri7nmf5mtqc3ojg.png"><br><br> ,         HTML5-   . <br><br>   -    Java-.     ,    ¬´Applications¬ª -&gt; ¬´Java Applications¬ª,    ¬´xproject¬ª. <br>     ¬´Security¬ª -&gt; ¬´Roles¬ª. <br><br><img src="https://habrastorage.org/webt/m_/93/vb/m_93vbqgtz12mzvzszwjeupwqa8.png"><br><br>  ,      ,       Java,   ¬´web.xml¬ª.  ,       ,   ¬´Predefined¬ª  ¬´¬ª.           ,       ¬´Employee¬ª  HTML5 . <br>     :   ¬´ProjectMember¬ª    ,   ¬´Assign¬ª.         ¬´ProjectManager¬ª. <br><br><img src="https://habrastorage.org/webt/f0/gl/9o/f0gl9omwshybfh5goimr9sqfuuo.png"><br><br>  Done!   .   -. <br><br>  HTML5 ,    ¬´Applications¬ª -&gt; ¬´HTML5 Applications¬ª,   . <br><br><img src="https://habrastorage.org/webt/ie/fj/so/iefjsosnwefjtpvrtkf1v6qfuek.png"><br><br>      -. <br><br><img src="https://habrastorage.org/webt/z_/3f/8v/z_3f8vztyokyulxh3kyg1bgaoqw.png"><br><br>  ¬´Login¬ª     ,     . <br><br><img src="https://habrastorage.org/webt/fa/vz/rz/favzrzq4hoet9pwwjzlva6n9etq.png"><br><br>      HTML5     .    ¬´Application-to-application SSO¬ª      ,   ,     HTML5 ,      Java.    ,  Java  ,    .   ,         ,         .     ,         .     . <br><br>      : <br><br><img src="https://habrastorage.org/webt/ah/hy/ik/ahhyikrylilcdalvoalycrsfgko.png"><br><br>       ,    .   ,       . <br><br><h3>  Conclusion </h3><br> ,    xProject,    : HTML5  Java.    ,             Neo SAP Cloud Platform. <br><br>       HTML5,     , , ,  ,     .         .            ,     ,     . <br><br>       Java- ,     .     ¬´Principal Propagation¬ª,       HTML5   Java   .   Java     ‚Äî     ,        . </div><p>Source: <a href="https://habr.com/ru/post/354914/">https://habr.com/ru/post/354914/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354898/index.html">Fractal manifold method in Data Science problems</a></li>
<li><a href="../354902/index.html">As I wrote a graphic bot and what it turned into</a></li>
<li><a href="../354906/index.html">Distribution of programs on Go. Part 1</a></li>
<li><a href="../354910/index.html">By the Day of Radio. Oh connection, you are the world</a></li>
<li><a href="../354912/index.html">PyTorch Tour</a></li>
<li><a href="../354916/index.html">Experience using Mikrotik CHR for organizing virtual routing</a></li>
<li><a href="../354930/index.html">BigInt - long arithmetic in javascript</a></li>
<li><a href="../354934/index.html">Plausible reconstruction of Instagram-like filters</a></li>
<li><a href="../354936/index.html">(Akin's laws) laws of space engineering</a></li>
<li><a href="../354938/index.html">Loud sound of the fire extinguishing system knocked out the drives in the Nasdaq data center</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>