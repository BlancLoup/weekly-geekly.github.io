<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Honest realtime on React and Redux, as the basis of auto auction</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In our first article about the software infrastructure of the CarPrice service, - if you haven‚Äôt read it, we recommend reading it , - you mentioned th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Honest realtime on React and Redux, as the basis of auto auction</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/8f3/937/9e9/8f39379e9ad94bc8974411c18a6267ce.jpg"><br><br>  In our first article about the software infrastructure of the CarPrice service, - if you haven‚Äôt read it, we recommend <a href="https://habrahabr.ru/company/carprice/blog/329424/">reading it</a> , - you mentioned the site for dealers.  What it is and how it works, we asked to tell one of its developers, Nikita Lebedev. <br><a name="habracut"></a><br>  <b>Nikita, please tell us what is being discussed.</b> <br><br>  For those who do not know, - CarPrice has created an auction service for individuals selling their used cars to auto dealers.  The owner of the car arrives at one of our many branches, our employee conducts an inspection of his car, makes a card that is put up for auction dealership.  Dealers bargain for this car for half an hour, gradually increasing the price.  At the end of the auction, the owner decides whether the proposed amount suits him, and either leaves with the money or calmly refuses the sale. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Recently, we have released a new version of the site, which hosts auctions for dealers.  The user can view offers, simultaneously bargain for several cars, betting on different lots, as if moving between gaming tables - therefore, inside our company, the informal name Poker Stars has firmly established itself on this project. <br><br>  <b>What has changed in the new release?</b> <br><br>  Previously, everything was scattered across individual tabs, users had to switch between them all the time.  Now this is a full-fledged one-page web application, all blocks of information are placed on one screen. <br><br>  Clicking on any of the auctions opens the car card: <br><br><img src="https://habrastorage.org/web/6ba/876/1fa/6ba8761fae384fa2a1a735b0f2f5756b.jpg"><br><br>  Here, in a compact and visual form, all information about the car, entered by our inspector during the inspection, is displayed.  A schematic scan of the body is shown, in which the state of certain elements is shown in different colors.  It indicates which parts are painted, damaged or badly damaged.  In the gallery there are general photos of the car, photos of damage, videos on which you can listen to the sound of the starter and the engine running.  Next comes the most detailed form with all kinds of characteristics of the machine. <br><br><img src="https://habrastorage.org/web/bb4/9a2/c79/bb49a2c79f3f464eaa323ec0428f2955.jpg"><br><br><img src="https://habrastorage.org/web/8ad/d23/a93/8add23a93e6d4257b30dc47d9ff56005.jpg"><br><br><img src="https://habrastorage.org/web/632/451/517/6324515173c445c8aa4bf68f7c56826b.jpg"><br><br><img src="https://habrastorage.org/web/d8c/600/987/d8c60098782548e2bb07762f65c4bdc1.jpg"><br><br>  We also use several third-party services and databases that help us to find out if the car was used in a taxi, what its real mileage is, and other information that will help you make a decision when buying. <br><br>  <b>Tell me more about the technical side of the project.</b> <br><br>  This is a web application written in React / Redux and corresponding to the paradigm of this technology: it consists of separate functional components.  Even the user interface is assembled from individual component cards.  In fact, each card is a separate application that works by itself.  It can be painlessly removed and pasted elsewhere in the common application.  That is, something like microservice architecture, only in the client part and at the level of the user interface. <br><br>  All this works completely independently of the server side.  That is, the auction application consists of static files that are collected by the WebPack and then distributed to Nginx. <br><br>  <b>What is the scheme of interaction between the frontend and the backend of the application?</b>  <b>What modules communicate with which systems, what data do they transmit?</b> <br><br>  We use an integrated approach, in the application we have both communication via HTTP REST API, and full real-time communication via WebSocket (pub / sub template).  This is due to both historical factors (the application worked this way initially) and functional requirements (we have places where real time and the transfer of events from the server are not needed, and vice versa).  It was very important for us to implement honest real-time, since this is an auction, and we have intensive trading, especially in the last minutes.  We abandoned the schemes, when updates are transmitted from the server once in a while (for example, per second, as is often done in messengers), our client receives updates from the server as quickly as possible.  It was very important to preserve the convenience of the interface: when active trading begins for the car, events fly very quickly and the user no longer has time to enter a new bid manually.  Fields and buttons (we have the opportunity to bid from different places in the application, and the type of bid is different) they update the information themselves when receiving events from the server, or, for example, they may become inactive if the dealer does not have rights to continue trading further.  This greatly simplifies the work with the interface, but it was not so easy to implement, because under such scenarios the connectivity of the components greatly increases. <br><br>  <b>Tell me more about the tools used in the development.</b> <br><br>  We deliberately abandoned the "bike" in favor of the most popular solutions for web applications that are now on the market.  As a framework, the ideology and foundation is used by React / Redux.  The project is built using Webpack, we use Yarn as a dependency manager, NodeJS and Express for the dev / mock server.  In production, statics are distributed by a docked Nginx. <br><br>  This is not to say that this stack is completely free from flaws, but without the advantages that it gives out of the box (reactivity, flexible debugging, good encapsulation and reuse of components), it is difficult to build an application that meets modern standards and requirements (rich interactive interface with lots of information on one screen and the possibility of real-time updates). <br><br>  <b>Were the components of the previous application used, or was the new one created from scratch?</b> <br><br>  Initially, we had one large monolithic application, we are gradually rewriting critical and strongly expanding modules out of it.  Now in production both the monolithic application, and new services and frontends work in conjunction.  As for the interface, it changes greatly in the process of redesign, and the interaction of old and new pages is always a difficult task, each time requiring a unique solution. <br><br>  <b>Were any technologies or tools that were considered unsuitable for use in the application?</b> <br><br>  Our architecture allows quite flexible working with different tools without violating the main principles of the application.  For example, we experimented with CSS modules and BEM naming of CSS classes using LESS.  As a result, we chose the first as a more convenient option.  The same thing happened with the implementation of the hot reboot on the dev server, the technology was still not completely settled, and we tried several implementation options. <br>  What was the most difficult in the implementation of this application? <br><br>  The application implemented quite a lot of behavioral logic, often nontrivial.  Our task was to competently decompose it into modules, provide for all user interactions, think over all use cases.  When all components are strongly interconnected and very actively interact with each other, it is important to foresee what each user (or other users) conducts to, what effect it has on the application.  In the client part, the Redux-architecture helped us a lot.  Our auction is a real time-ecosystem, and it was important that those events that arrive from other users do not conflict with those generated by the user. <br><br>  <b>As I understand it, the main advantage of the new application is its modular interface.</b>  <b>Could you tell us more about its development?</b> <br><br>  Today, there are two popular approaches to splitting an application into modules: <br><br><ul><li>  First, the MVC approach (fairly well known), when all functional roles (models, controllers, views) are located in the appropriate folders.  And in order to trace the entire life cycle of a module, it is necessary to take from each folder its model, controller, and view, respectively (everything can be optional). </li><li>  the second, pod or component architecture (an approach that is gaining popularity), when everything lies together and forms a single module.  Everything that belongs to the module (static files, graphic images, video) is added there. </li></ul><br>  In our auction application, we use the second approach.  Our typical module is a React view, CSS file, Redux action, Redux reducer + static files.  We do not separate <a href="https://medium.com/%40dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0">containers and components</a> , the component itself becomes a container if it has a need for action and reducer. <br><br>  <b>What is the difference between a container and a component, why did you ignore this pattern?</b> <br><br>  A container is a component that works directly with stor, makes requests to the server, and so on.  And just a component can only receive data from the parent and render to a certain place.  Often they are divided into different folders at the application level.  Such an approach seemed to us redundant, I think, a flat list of components - this is what the whole front-end development has been going to for the past five years.  The developer himself understands that the component becomes complicated (becomes a container), and this can be seen when the input point of the component is opened, since for this you need to implement several Redux methods. <br><br>  <b>I heard that Redux uses functional programming practices to build an application, is that so?</b>  <b>What about OOP?</b> <br><br>  Yes, Redux was written under the influence of functional languages, approaches and ideas.  For example, all reducer's are pure functions, and store is an immutable object.  All sets of action'ov and reducer'ov - just functions that we import to the input points of the component, there are practically no classes, there are practically no instances (only in React'e and self-written modules).  OOP approaches do well with constantly swelling logic, but in this case, the application can be kept compact, despite the fact that it has a lot of functionality. <br><br>  Component reuse and insulation is one of the main advantages of this approach. <br><br>  New versions of JavaScript, which support is actively added to browsers and NodeJS, help a lot with this.  It is still not a fully functional language, and probably never will be.  But innovations, sugar, and general multi-paradigm of the language make it possible to greatly reduce the pain when writing frontends and create platforms such as React / Redux. <br><br>  <b>What tools are used in the work?</b> <br><br>  <a href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd%3Fhl%3Den">Redux DevTools</a> and <a href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi%3Fhl%3Den">React Developer Tools</a> are added to standard Chrome <a href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi%3Fhl%3Den">Developer Tools</a> .  The first one is a very powerful debugging tool that allows you to browse the store, roll back actions and, accordingly, what was done in the application over time (this is called a time machine).  The second allows you to work with an XML-like React-component tree, similar to what we write in JSX, and not with the usual DOM.  This allows you to operate on larger parts of the application than simple HTML elements.  We also use ESLint with a standard, slightly modified AirBnb-config to bring the code of different developers to approximately the same form. <br><br>  <b>What path does the application take from developing some new functionality to its release to users?</b> <br><br>  The developer deploys the application locally, runs the Webpack Dev server and server with mocks on different ports (or configures configs for production or staging environments) and starts working.  After passing the code review, the tester in the CI collects a Docker container with the necessary branch and checks it.  Then <a href="https://github.com/drone/drone">Drone is</a> launched (we will soon tell about it in a separate post), CI collects the container for production and runs it on the combat server.  In the future, we plan to build one container for testing and deployment. <br><br>  <b>How has the approach to the development of the frontend and backend changed in the last 2-3 years?</b>  <b>What ideas / concepts, previously considered normal practice, do you consider today as obsolete, and what has come to their place?</b>  <b>What techniques have you adopted, and, perhaps, used to create this application?</b> <br><br>  I would cover a larger period.  Over the past 4-6 years, the requirements for interfaces on the web have seriously increased, in most new complex products, the basic version is made for the browser, some of the old ones have also migrated.  Applications have become much more complicated, and the monolithic architecture, which previously prevailed, gives way to microservices on the backend and components on the frontend.  Beckend and frontend in a typical large project were first separated from each other, reducing complexity and entropy, and then they began to divide the areas of responsibility within themselves.  If earlier, even going to a popular visited site, it was possible to understand that a simple HTML string template engine, a database, a web server and a bit of logic linking all this work inside, but now, under the hood, there is often a system of numerous components. , with a clever system of communication and a stack of various technologies. <br><br>  <b>And the last question.</b>  <b>Buying a car is a pretty crucial step, even for people who do it professionally.</b>  <b>How did dealers respond to the new interface?</b> <br><br>  Even a successful redesign is always, to some extent, a pain for users, who are accustomed to the usual patterns of behavior, even if they can be greatly simplified and have bugs.  We gradually introduced new pages and groups connected users to the updated interface.  We have a feedback system, and our managers analyzed the wishes and feedback of users.  We consider that we have coped quite successfully with this difficult task. </div><p>Source: <a href="https://habr.com/ru/post/335700/">https://habr.com/ru/post/335700/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335690/index.html">Service out of the box: set up ServiceNow "in 60 seconds"</a></li>
<li><a href="../335692/index.html">Colorful code: how color helps in working with code</a></li>
<li><a href="../335694/index.html">Digital agency / production performance indicators (examples from the West)</a></li>
<li><a href="../335696/index.html">The idea of ‚Äã‚Äãblack and white cinema, correct bees and unarmed ninjas in site optimization</a></li>
<li><a href="../335698/index.html">MongoDB for growth</a></li>
<li><a href="../335702/index.html">Study of the safety of the transport system of Tbilisi - or how to ride a vehicle and earn money</a></li>
<li><a href="../335704/index.html">Mamba: open-source crypto-fiber</a></li>
<li><a href="../335706/index.html">Reducing prices for local SSD drives in ‚Äúdisplaced‚Äù instances and instances on demand</a></li>
<li><a href="../335708/index.html">5 reasons why you should build a small business - not a startup</a></li>
<li><a href="../335710/index.html">Introduction to the development of smart contracts Ethereum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>