<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Restore base 1C using HEX editor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is for those who are desperate to restore their base and climbed behind backups. Namely: what to do when the 1C base was killed, the so-c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Restore base 1C using HEX editor</h1><div class="post__text post__text-html js-mediator-article"> This article is for those who are desperate to restore their base and climbed behind backups.  Namely: what to do when the 1C base was killed, the so-called ‚Äúutility testing the physical integrity of the database‚Äù <b>chdbfl.exe</b> and her friend 1C platform. <br><br>  Who does not know, <b>chdbfl.exe</b> is a standard program for restoring and testing the physical integrity of the 1C database, included in the platform bundle.  And everyone has long known that <b>chdbfl.exe</b> only makes things worse in most cases (in my practice it is like that). <br><br>  It all started with a very banal error.  Since programmers from 1C love to be wise, during the next update of <i>1C: Accounting, the</i> following fell out: <br><a name="habracut"></a><br><img src="https://habrastorage.org/storage2/032/cf6/e4c/032cf6e4c72d7dce0058d344e2b8090a.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now I know that this error is fixed by clearing the cache, but at that time I used exactly <b>chdbfl.exe</b> and the <b>Configurator</b> (Testing and Correction).  The error went away and I was easily updated.  But the next day the accountant‚Äôs alarm bell rang: ‚ÄúCome!‚Äù <br><br>  Upon arrival, I was met by 1C with a pop-up dump at the opening of the document ‚ÄúReceipt of goods and services‚Äù.  It was decided to reiterate the above points.  And lo and behold!  The problem was solved.  I proudly left the organization, but at the same time took the base for testing on my computer.  But it was not there.  Now another document fell out with a dump.  It was decided to postpone everything until tomorrow and try to do something on my computer.  And this time the same steps helped me as before.  "Now everything" - I thought.  But not really. <br><br>  After 2 weeks, another bell rang: - Reports are burning, come urgently! <br><br>  This time it was all much more serious.  When recalculating the results, 1C produced the following: <br><br><img src="https://habrastorage.org/storage2/6b7/166/3a6/6b71663a6d7c29d132e521b8ad17c47d.jpg"><br><br>  Reports that require results gave the following: <br><br><img src="https://habrastorage.org/storage2/b8d/8fe/fa1/b8d8fefa1ec2bd629d8518df59b37673.jpg"><br><br>  As before, I used the same utilities as before, but it did not give a result.  As did not give the result all sorts of upload / download / save.  The update also did not take place for an unknown reason: <br><br><img src="https://habrastorage.org/storage2/36c/52c/d28/36c52cd2885c5c385c6067b67a04596e.jpg"><br><br>  It stumped me for 2 days.  During these days, almost everything was tried.  Many advised to look at the chart of accounts and remove the extra subconto from this account.  But!  Everything was typical, no changes were made. <br><br>  The decision came suddenly and inspired by this <a href="http://gustelev.livejournal.com/162890.html">little article</a> .  I downloaded all the programs from the article and began to "pick".  I opened the database file in <b>Tool_1CD</b> and after half an hour of smoking and understanding it turned out that: <br><br>  <b>-</b> _Acc - the main table of accounts. <br>  <b>-</b> _Acc_ExtDim - table of types of subconto of the chart of accounts, created for the plan of accounts in the event that the maximum number of subconto is greater than zero. <br><br>  In my case, these are the <b>_ASS13</b> and <b>_ASS13_EXTDIM446 tables,</b> respectively: <br><br><img src="https://habrastorage.org/storage2/7d4/a52/275/7d4a52275988b986d4db714dac82b137.jpg"><br><br>  So, the fun begins.  Remember the <b>_IDRREF</b> field of our account in the <b>_13</b> table: <br><br><img src="https://habrastorage.org/storage2/be5/336/122/be53361226f2edfdc132aa729847db09.jpg"><br><br>  Go to <b>_13_EXTDIM446</b> and try to find this identifier in the <b>_13_IDRREF</b> field: <br><br><img src="https://habrastorage.org/storage2/489/585/05c/48958505ccf955bf74be2aae37dc31e4.jpg"><br><br>  Here they are, our cherished subconto.  But there must be three of them!  Somehow, in an incomprehensible and strange way, the <b>Configurator</b> during restructuring and <b>chdbfl.exe</b> duplicated the subconto of this account and therefore an error popped up.  Extras need to somehow be removed.  For this we need another field from the same table, <b>_KEYFIELD</b> .  We remember all the values ‚Äã‚Äãof extra subconto.  You should have the following: <br><br>  - <code>5724b6a1-5590-484e-a7c1-920ebbd1a385 000001b0</code> <br>  - <code>5724b6a1-5590-484e-a7c1-920ebbd1a385 000001b1</code> <br>  - <code>5724b6a1-5590-484e-a7c1-920ebbd1a385 000001b2</code> <br>  For the next step, we need a HEX editor.  Open our database file in it.  Then I slowed down a bit.  I was looking for as soon as possible and wherever possible the line <i>5724b6a1-5590-484e-a7c1-920ebbd1a385</i> .  The truth was almost near.  It was necessary to look not all at once, but over the decades of numbers.  But here again a trick.  There were a lot of such values.  And in some random way I found what I needed, but in a completely different form.  So, the sequence <i>5724b6a1-5590-484e-a7c1-920ebbd1a385 000001b0</i> in the HEX editor was this - <i>a7c1920ebbd1a385484e55905724b6a1000001b0</i> . <br><br><img src="https://habrastorage.org/storage2/252/c68/34c/252c6834c57bf9ddb9994129d0313ded.jpg"><br><br>  And so with every subconto.  The lines we need are: <br>  - <code>a7c1920ebbd1a385484e55905724b6a1000001b0</code> <br>  - <code>a7c1920ebbd1a385484e55905724b6a1000001b1</code> <br>  - <code>a7c1920ebbd1a385484e55905724b6a1000001b2</code> <br><br><img src="https://habrastorage.org/storage2/7d1/703/42c/7d170342cdffc346def66772d4b40b0e.jpg"><br><br>  It remains the case for small.  Change the first digit of the code to 9 (you can take any other, but you need to control the uniqueness of this code) and save the database file.  We open all this in <b>1C: Enterprise</b> (for sure, we can once again get rid of <b>testing and fixing</b> and <b>chdbfl.exe</b> ) and rejoice in the restored and working base. </div><p>Source: <a href="https://habr.com/ru/post/155105/">https://habr.com/ru/post/155105/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../155089/index.html">EPAM Systems Becomes AWS Official Partner</a></li>
<li><a href="../155097/index.html">We select the video card for miniITX-system</a></li>
<li><a href="../155099/index.html">x-acl lightweight utility to organize Access Control List (ACL)</a></li>
<li><a href="../155101/index.html">What do users think about paperless technology</a></li>
<li><a href="../155103/index.html">The new infrastructure of the Pirate Bay: still indestructible and elusive</a></li>
<li><a href="../155107/index.html">JQuery tutorial for beginners</a></li>
<li><a href="../155109/index.html">Page Object Model + Webdriver. An example of implementation on a single test</a></li>
<li><a href="../155111/index.html">Extending Asterisk with PHP</a></li>
<li><a href="../155113/index.html">Metropolis or Windows 8 through the eyes of Delphi programmers</a></li>
<li><a href="../155115/index.html">How does apache cassandra work?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>