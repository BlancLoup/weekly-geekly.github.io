<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cheat Sheet Management Services CentOS 7 with systemd</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Systemd is a system and services manager in the Linux operating system. When developing, they sought to design backwards compatible with the SysV init...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cheat Sheet Management Services CentOS 7 with systemd</h1><div class="post__text post__text-html js-mediator-article">  Systemd is a system and services manager in the Linux operating system.  When developing, they sought to design backwards compatible with the SysV init initialization scripts and provide useful features, such as parallel launch of system services at boot time, activation of daemons on demand, support for system state snepshots, and dependency-based service management logic.  On CentOS 7, systemd replaces Upstart as the default init system. <br><br>  In this article we will look at the process of managing services in systemd for a CentOS 7 user. This knowledge will also be useful in other distributions, because systemd has been used in Fedora for a long time and is planned in Ubuntu 14.10 and Debian 8. Good or not, we'll leave it behind the scenes. <br><br><img src="https://infoboxcloud.ru/community/uploads/images/00/00/01/2014/10/22/e9f531.png" alt="CentOS 7 Systemd Infobox" width="400">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the process of reading the article, you can try systemd on <a href="http://infobox.ru/vps/linux/">classic VPS</a> and <a href="http://infobox.ru/vps/cloud/">cloud VPS</a> from Infobox.  We strive to add support for modern operating systems in a timely manner so that you can use the latest technologies for more efficient operation.  The very idea of ‚Äã‚Äãwriting the article was born after another user question about the use of services in CentOS 7. <br><a name="habracut"></a><br><h4>  <b>Introduction</b> </h4><br>  Systemd brings the concept of systemd units.  Units are represented by configuration files located in one of the directories: <br><ul><li>  <strong>/ usr / lib / systemd / system /</strong> - units from installed RPM packages. </li><li>  <strong>/ run / systemd / system /</strong> - units created in runtime.  This directory is more priority than the directory with installed units from the packages. </li><li>  <strong>/ etc / systemd / system /</strong> - units created and managed by the system administrator.  This directory is more priority than the directory of units created in runtime. </li></ul><br>  Units contain information about system services, listening sockets, saved snapshots of system states and other objects related to the initialization system. <br><br>  Systemd unit types: <br><ul><li>  <strong>.service</strong> - system service </li><li>  <strong>.target</strong> - systemd unit group </li><li>  <strong>.automoun</strong> t - file system <strong>auto-mount</strong> point </li><li>  <strong>.device</strong> - the device file recognized by the kernel </li><li>  <strong>.mount</strong> - file system mount point </li><li>  <strong>.path</strong> - file or directory in the file system </li><li>  <strong>.scope</strong> - a process created externally </li><li>  <strong>.slice</strong> - a group of hierarchically organized units that controls system processes </li><li>  <strong>.snapshot</strong> - systemd manager's saved state </li><li>  <strong>.socket</strong> - interprocess communication socket </li><li>  <strong>.swap</strong> - SWAP device or swap file (paging file) </li><li>  <strong>.timer</strong> - systemd timer </li></ul><br><br><h4>  <b>The main systemd functions in CentOS 7</b> </h4><br><ul><li>  <strong>Socket based activation</strong> .  At boot time, systemd listens for sockets for all system services, supports this type of activation, and transfers sockets to these services immediately after starting the services.  This allows systemd to not only start services in parallel, but also makes it possible to restart services without losing any messages sent to them while the services were unavailable.  The corresponding socket remains available and all messages are lined up. </li><li>  <strong>D-Bus based activation</strong> .  System services that use D ‚Äì Bus for interprocess communication can be started on demand when a client application tries to communicate with them. </li><li>  <strong>Activation based on devices</strong> .  System services that support device-based activation can be started when a certain type of equipment is connected or becomes available. </li><li>  <strong>Path based activation</strong> .  System services can support this type of activation if the state of a folder or directory changes. </li><li>  <strong>Nepshot system states</strong> .  The system can save the state of all units and restore the previous state of the system. </li><li>  <strong>Manage mount and automount points</strong> .  Systemd tracks and manages mount and automount points. </li><li>  <strong>Aggressive parallelization</strong> Systemd runs system services in parallel due to the use of socket-based activation.  In combination with services that support on-demand activation, parallel activation significantly reduces system load time. </li><li>  <strong>Transactional activation logic units</strong> .  Before activating and deactivating units, systemd calculates their dependencies, creates a temporary transaction and checks the integrity of this transaction.  If the transaction is not complete, systemd automatically tries to correct it and remove unnecessary tasks from it before generating an error message. </li><li>  <strong>Backward compatibility with SysV initialization</strong> .  SystemD fully supports SysV init scripts as described in the Linux Standard Base specification (LSB), which simplifies the transition to systemd. </li></ul><br><br><h4>  <b>Service Management</b> </h4><br>  In previous versions of CentOS, SysV or Upstart was used.  Initialization scripts were located in the <strong>/etc/rc.d/init.d/</strong> directory.  Such scripts were usually written on Bash and allowed the administrator to manage the state of services and daemons.  In CentOS 7, the initialization scripts were replaced by service units. <br><br>  By the way of using, service units <strong>.service</strong> resemble initialization scripts.  To view, start, stop, restart, enable or disable system services, use the <strong>systemctl</strong> command.  The <strong>service</strong> and <strong>chkconfig</strong> commands are still included in the system, but only for compatibility reasons. <br><br><img src="https://infoboxcloud.ru/community/uploads/images/00/00/01/2014/10/21/517fc9.png" width="800"><br>  When using systemctl, it is not necessary to specify the file extension. <br><br>  The following are the main <strong>systemctl commands</strong> : <br><ul><li>  <strong>systemctl start name.service</strong> - start the service. </li><li>  <strong>systemctl stop name.service</strong> - service stop </li><li>  <strong>systemctl restart name.service</strong> - restart service </li><li>  <strong>systemctl try-restart name.service</strong> - restart the service only if it is running </li><li>  <strong>systemctl reload name.service</strong> - reload service configuration </li><li>  <strong>systemctl status name.service</strong> - check whether the service is running with a detailed <strong>display of the status</strong> of the service </li><li>  <strong>systemctl is-active name.service</strong> - check if the service is running with a simple answer: active or inactive </li><li>  <strong>systemctl list-units - type service</strong> - all - display the status of all services </li><li>  <strong>systemctl enable name.service</strong> - activates the service (allows you to start during system startup) </li><li>  <strong>systemctl disable name.service</strong> - deactivates the service </li><li>  <strong>systemctl reenable name.service</strong> - deactivates the service and immediately activates it </li><li>  <strong>systemctl is ‚Äì enabled name.service</strong> - checks if the service is activated </li><li>  <strong>systemctl list-unit-files --type service</strong> - displays all services and checks which ones are activated. </li><li>  <strong>systemctl mask name.service</strong> - replaces the service file with a symlink for / dev / null, making the unit inaccessible for systemd </li><li>  <strong>systemctl unmask name.service</strong> - returns the service file, making the unit available to systemd </li></ul><br><br><h4>  <b>We work with targets (targets) Systemd</b> </h4><br>  Previous versions of CentOS with SysV init or Upstart included a predefined set of launch levels (runlevels) that represented specific modes for operations, numbered from 0 to 6. In CentOS 7, the concept of launch levels was replaced by systemd targets. <br><br>  The systemd <strong>.target</strong> target <strong>files</strong> are intended to group together other systemd units through a chain of dependencies.  For example, the <strong>graphical.target</strong> unit, used to start a graphics session, starts the GNOME Display Manager ( <strong>gdm.service</strong> ) and Accounts Service ( <strong>accounts ‚Äì daemon.service</strong> ) system services and activates <strong>multi-user.target</strong> .  In turn, <strong>multi‚Äìuser.target</strong> launches other system services, such as Network Manager ( <strong>NetworkManager.service</strong> ) or D-Bus ( <strong>dbus.service</strong> ), and activates other target units of <strong>basic.target</strong> . <br><br>  CentOS 7 has predefined targets, similar to the standard set of launch levels.  For compatibility reasons, they also have aliases for these purposes, which are directly displayed in the SysV launch levels. <br><br><ul><li>  <strong>poweroff.target (runlevel0.target)</strong> - shutting down and shutting down the system </li><li>  <strong>rescue.target (runlevel1.target)</strong> - setting the recovery shell </li><li>  <strong>multi‚Äìuser.target (runlevel2.target, runlevel3.target, runlevel4.target)</strong> - setting up a non-graphical multi-user system </li><li>  <strong>graphical.target (runlevel5.target)</strong> - setting up a graphical multi-user system </li><li>  <strong>reboot.target (runlevel6.target)</strong> - shutdown and reboot the system </li></ul><br>  The runlevel and telinit commands are still available, but left on the system for compatibility reasons.  It is recommended to use systemctl to modify or configure system targets. <br><br>  To determine which target unit is used by default, the following command is useful: <strong>systemctl get ‚Äì default</strong> . <br><br>  To view all loaded target units, use the <strong>systemctl list-units - type target command</strong> , and to view all target units in general with the command: <strong>systemctl list-units --type target --all</strong> . <br><br>  To change the default target, <strong>use the systemctl</strong> command <strong>set-default name.target</strong> . <br><br>  To change the current target: <strong>systemctl isolate name.target</strong> .  The team will launch the target unit and all its dependencies and immediately stop all the others. <br><br><h4>  <b>Shutting down and rebooting the system</b> </h4><br>  On CentOS 7, the systemctl replaces a significant number of power management commands.  The former commands are kept for compatibility, but it is recommended to use systemctl: <br>  <strong>systemctl halt</strong> - stops the system <br>  <strong>systemctl poweroff</strong> - shuts down the system <br>  <strong>systemctl reboot</strong> - reboot the system <br><br><h4>  <b>Managing systemd on a remote machine</b> </h4><br>  Systemd allows you to control a remote machine via SSH.  To manage, use the command: <br>  <strong>systemctl --host user_name @ host_name command</strong> , where user_name is the user name, host_name is the name of the host that is being remotely managed, and command is the executable systemd command. <br><br><h4>  <b>Typical systemd .service</b> </h4><br>  This section will help you if you need to quickly make support for service management from systemd.  Detailed information on all the parameters of the .service file is in the <a href="http://www.freedesktop.org/software/systemd/man/systemd.service.html">corresponding section</a> of the systemd documentation. <br><br><pre><code class="xml hljs">[Unit] Description=Daemon to detect crashing apps After=syslog.target [Service] ExecStart=/usr/sbin/abrtd Type=forking [Install] WantedBy=multi-user.target</code> </pre> <br>  Let's take a look at the <strong>[Unit]</strong> section.  It contains general information about the service.  This section is not only in service units, but also in other units (for example, when controlling devices, mount points, etc.).  In our example, we give a description of the service and indicate that the daemon should be running after Syslog. <br><br>  The next section <strong>[Service]</strong> directly contains information about our service.  The <strong>ExecStart</strong> parameter <strong>used</strong> points to the executable file of our service.  In <strong>Type,</strong> we specify how the service notifies systemd when the launch is complete. <br><br>  The final <strong>[Install]</strong> section contains information about the target for which the service should start.  In this case, we say that the service should be started when the goal of <strong>multi‚Äìuser.target</strong> is activated. <br><br>  This is the minimum operating systemd service file.  After writing your own, for testing, copy it into /etc/systemd/system/service_service.service.  Run the <strong>systemctl daemon-reload</strong> commands.  Systemd finds out about the service and you can start it. <br><br><h4>  <b>Additional Information</b> </h4><br>  <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/chap-Managing_Services_with_systemd.html">An excellent systemd guide from RedHat</a> that forms the basis of this article. <br>  <a href="http://www.freedesktop.org/software/systemd/man/systemd.service.html">Documentation on writing your systemd service unit</a> . <br>  <a href="http://www2.kangran.su/~nnz/pub/s4a/s4a_latest.pdf">"Systemd for administrators"</a> from the systemd developer in Russian. <br><br><h4>  <b>Conclusion</b> </h4><br>  In this article, we learned how to manage CentOS 7 services. Of course, this is not the only systemd function and its other sides will be considered in the future.  OS itself almost from the time of release is available on <a href="http://infobox.ru/vps/linux/">classic VPS</a> and <a href="http://infobox.ru/vps/cloud/">cloud VPS</a> from Infobox.  Try systemd right now.  This knowledge will be useful in connection with the transition of many distributions to systemd. <br><br>  If you find an error in the article, the author will gladly correct it.  Please write in the LAN or <a href="">in the mail</a> about it. <br>  In case you cannot post comments on Habr√©, you can write them in the <a href="https://infoboxcloud.ru/community/blog/iaas/201.html">InfoboxCloud Community blog</a> or <a href="https://www.facebook.com/groups/infoboxcloud/">in our group on Facebook</a> . <br><br>  Successful use of CentOS 7! </div><p>Source: <a href="https://habr.com/ru/post/241237/">https://habr.com/ru/post/241237/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../241223/index.html">How to write your own application with Yandex.Disk REST API</a></li>
<li><a href="../241227/index.html">SED: look for who benefits</a></li>
<li><a href="../241229/index.html">Pythonista. Writing in Python for iOS</a></li>
<li><a href="../241231/index.html">Persistent queue</a></li>
<li><a href="../241235/index.html">The inability to create a new calendar event through the Kerio Connect client using Google Chrome and Apple Safari browsers</a></li>
<li><a href="../241245/index.html">Internet office switch</a></li>
<li><a href="../241247/index.html">Irrational use of Digitalocean</a></li>
<li><a href="../241253/index.html">Python Meetup 09/26/14: Improving code and speeding up Python</a></li>
<li><a href="../241255/index.html">Pooling database connections on node.js</a></li>
<li><a href="../241257/index.html">Make an anonymous access point based on Raspberry Pi and TOR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>