<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why the UEFI Secure boot is a challenge for Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A recent publication on Habr√© on the limitations of UEFI caused a wide discussion, in continuation of the topic, I want to share a translation of the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why the UEFI Secure boot is a challenge for Linux</h1><div class="post__text post__text-html js-mediator-article">  <i>A recent <a href="http://habrahabr.ru/blogs/os/136206/">publication</a> on Habr√© on the limitations of UEFI caused a wide discussion, in continuation of the topic, I want to share a translation of the current <a href="http://mjg59.dreamwidth.org/9844.html">post</a> from the blog of Matthew Garrett, one of the developers of RedHat.</i> <br><br>  I wrote about the <a href="http://mjg59.dreamwidth.org/6054.html">technical details of the</a> Linux support for the UEFI Secure boot specification.  Despite the fact that I explicitly stated that it ignores licensing issues and key distribution, however, relying on it, people say that Secure boot support can be added to Linux with minimal effort.  In a sense, they are right.  The technical details of the implementation are quite simple.  But the difficulties are not in them. <a name="habracut"></a><br><br><h5>  Safe boot requires that all code that interacts with hardware is trusted. </h5><br>  Currently, if you can execute an untrusted code before booting the OS, you can do whatever you want with the OS.  Secure boot provides a mechanism that allows you to be sure that you run only trusted code, which is designed to protect against such scenarios.  So, your UEFI drivers are digitally signed, the bootloader is also digitally signed and can only download the signed kernel.  If you used only trusted code to boot, then you can be sure that your OS is safe.  But, unlike downloading trusted code, Secure boot does not give you the opportunity to be sure that only trusted code is executed.  This should be provided by OS policies. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At first glance, this is not a big problem.  But really is her.  Imagine that you have a signed Linux bootloader and a signed Linux kernel and these signatures are made using a global trusted key.  They will be loaded on any hardware using Secure boot.  Now imagine that an attacker writes a kernel module that creates a fake UEFI environment, interrupts the code execution by the kernel, and calls the Windows bootloader ‚Äî something like kexec, but a bit more complicated.  The Windows loader is sure that it is running in Secure boot, but in fact, everything that in his opinion is trustworthy is a fake UEFI code written by an attacker.  The user's encryption key is recorded, the Windows kernel is modified to hide the Linux code, and despite the fact that everything looks great, your credit card details are already on the way to China.  In this scenario, the signed Linux kernel is simply used as a malware loader.  The only sign that something is wrong is a slightly longer OS load. <br><br>  A signed kernel is not enough.  A signed Linux kernel should prevent the loading of any unsigned kernel modules.  Virtualbox in Linux?  Goodbye.  Binary Nvidia Drivers?  Goodbye.  Anything beyond the standard kernel modules?  Also to new meetings.  Self build new drivers?  Next time.  All this obviously will not make people happier. <br><br>  (The same applies, of course, to Windows. Windows 7 allows you to disable digital signature verification of drivers, but Windows 8 will not allow this if the system uses the Secure boot mechanism). <br><br><h5>  Licensing </h5><br>  GPLv3 has different requirements for the availability of keys used for signing.  According to the new Microsoft requirements, the system must support the installation of user keys, which will allow users to use their own OS loaders, which may well be enough to comply with the license requirements.  But we become addicted to Microsoft - if they remove this requirement, then users lose their freedom and we find ourselves in an awkward position with the question of licensing.  Discussions about what exactly we can do in this case are still ongoing, but at the current moment this problem has not been solved. <br><br><h5>  Key distribution </h5><br>  The UEFI specification does not define who will be the central certification authority.  Microsoft insists everyone have their own key.  Of course, we can generate our own keys, but not everything is so simple with equipment manufacturers.  There is no way to ensure that all iron producers support them.  And, obviously, if we generate a key, we cannot simply transfer its private part to third parties.  This means that it will be impossible for people to release their own distributions based on others without obtaining their private key.  To obtain the key, some identification verification procedure will be required, which is likely to be costly, and it is also likely that a legally registered organization may be required to ensure verification of identification data.  I think these will be certificates of Extended Validation, not Startssl Free.  Thus, Linux distributions created by enthusiasts will be in the past. <br><br><h5>  Doesn't Custom mode solve this problem? </h5><br>  Microsoft's certification requirements indicate that all systems must support Custom mode; the implementation of this feature should allow users to set their own keys.  Linux vendors will be able to supply their own keys along with the distribution and install their own policies.  Everyone is happy.  In fact, everything is not so good.  People have to spend an incredible amount of time and effort to install Linux, instead of just inserting a CD into the drive.  The need to change the firmware and reconfigure it adds an additional barrier and limits the ability to install Linux only by more technically competent users.  And this is even worse.  Here is a complete description of the requirements for Custom mode: <br>  1. For a user physically located behind the device, it should be possible to use the Custom mode, to modify the contents of the Secure boot and PK signature database <i>(for example, the translator: PK is a private key)</i> . <br>  2. If the user removes PK, then when leaving the Custom mode, the system will function in the Setup Mode with the Secure Boot disabled by default. <br>  3. The firmware setup menu should notify you when the Secure boot is enabled, as well as about the Standard or Custom mode.  The setup menu should also provide the ability to return from Custom to Standard mode, with restoring the factory default settings. <br><br>  Something is missing here, for example: <br>  - Any description of UI.  This makes it virtually impossible to document the Linux installation process when the first step (a) is confused and (b) depends on the manufacturer.  Iron producers are trying to isolate themselves by offering their own unique firmware interfaces.  Custom mode in them may look completely different. <br>  - Any description of the key format.  Simple binary key representation?  Or structure EFI_SIGNATURE_DATA?  The key is encoded in base64, then protected by ROT13?  We just don't know. <br>  - Any way to use the Custom mode when unattended-installation options of the OS.  The firmware interface requires the physical presence of the user.  Do you want to install the OS on several thousand machines over the network?  This is not a scalable approach. <br>  - ... and one trifle, in fact, there are no requirements anywhere that the user could add the key himself, iron producers can take advantage of this, allowing only to delete the keys.  This is not bad as long as users can delete the PK, because then they will return back to Setup mode and will be able to install our keys from the installer, but in practice this will still cause problems. <br><br>  All the same, Custom mode does not solve all the problems.  Custom mode with a strictly defined UI and key format would be much better, but still does not solve the problem with the automatic unattended-installation option of the OS. <br><br><h5>  Conclusion </h5><br>  We can write the code required to support Secure boot in Linux in a short time ‚Äî in fact, most of it has already been completed.  But significant practical problems remain, and to date we do not have a working solution for any of them. </div><p>Source: <a href="https://habr.com/ru/post/136504/">https://habr.com/ru/post/136504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136495/index.html">Withdrawal of funds from freelance exchanges</a></li>
<li><a href="../136499/index.html">Jerry Yang permanently left Yahoo</a></li>
<li><a href="../136500/index.html">We investigate protection on the basis of certificates (utm5)</a></li>
<li><a href="../136501/index.html">Two startups</a></li>
<li><a href="../136502/index.html">NXP Semiconductors Introduces Solar Lighting System</a></li>
<li><a href="../136505/index.html">impress.js - CSS3 presentations tearing up the template</a></li>
<li><a href="../136506/index.html">ABBYY Labs - what's new?</a></li>
<li><a href="../136507/index.html">CyanogenMod9 Alpha arrives on the path of the HP Touchpad</a></li>
<li><a href="../136508/index.html">Samsung was not interested in buying RIM</a></li>
<li><a href="../136510/index.html">Announced date and venue of JavaOne Russia 2012</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>