<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CakePHP: Add ‚Äúkamenty‚Äù to the blog.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="<p /> So, we decided to start programming ‚Äúby concepts‚Äù and finally deal with some kind of framework. 
 <p /> A painful choice arises before us, what ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CakePHP: Add ‚Äúkamenty‚Äù to the blog.</h1><div class="post__text post__text-html js-mediator-article"> &lt;p /&gt; So, we decided to start programming ‚Äúby concepts‚Äù and finally deal with some kind of framework. <br>  &lt;p /&gt; A painful choice arises before us, what kind of framework for this to use.  To do this, you can find a bunch of articles, reviews, benchmarks for speed, performance, usability and installation, or you can simply type in the "php framework" in Google and click <a name="habracut"></a>  "I'm lucky." <br>  &lt;p /&gt; Hooray, we have just chosen to develop a framework called CakePHP! <br>  Of course, we don‚Äôt have time to read about its advantages and disadvantages, we need to implement our project as quickly as possible.  Therefore, we write a tutorial in a search and get into an article about <a href="http://manual.cakephp.org/appendix/blog_tutorial">how to stick a small blog in 5 minutes</a> . <br>  &lt;p /&gt; This article begins with a description of how to install CakePHP in your project.  Tells about what you need to keep in each daddy and why they are needed. <br>  Then he goes straight to the point, invites you to create a table, set up access to MySQL (for some reason, in that order, and not vice versa), check whether the mod_rewrite is configured correctly in the Apache.  And then offers to start creating a blog. <br>  This blog is a table that contains posts.  We can add, edit and delete posts.  It should be noted that all this is really very simple.  Almost as simple as on the rails. <br>  &lt;p /&gt; This article is written in simple and understandable English and contains all the code needed to create a blog.  Know yourself copy, yes paste. <br>  &lt;p /&gt; But creating this blog on this tutorial, we suddenly realize that we don‚Äôt have the most important thing for which all blogs are kept.  These are kamenty (or ‚Äúcomments‚Äù for lovers of the purity of the language).  In a panic, we begin to google, looking for an extended tutorial, but we are convinced that apart from the components of transcendental complexity, we cannot find anything.  And then we decide on a desperate step: add the functionality of the kaments themselves. <br>  &lt;p /&gt; To do this, first create a table in which kament will be stored <br> <code>CREATE TABLE `comments` ( <br> `id` int(11) NOT NULL auto_increment, <br> `post` int(11) default NULL, <br> `comment` text NOT NULL, <br> `created` datetime NOT NULL, <br> `modified` datetime NOT NULL, <br> PRIMARY KEY (`id`) <br> ) ENGINE=MyISAM DEFAULT CHARSET=utf8; <br> INSERT INTO `comments` VALUES (1, 1, 'This is a comment to the first post.', NOW( ), '0000-00-00 00:00:00'); <br> INSERT INTO `comments` VALUES (2, 2, 'The comment to second post.', NOW( ), '0000-00-00 00:00:00'); <br></code> <br>  &lt;p /&gt; This request created the comments table for us and added two comments to it.  For the first and second entries, respectively. <br>  &lt;p /&gt; Now we need to make these kamenty visible.  We heard about MVC, so we immediately go to the post controller (posts_controller.php).  And we add the following line there: <br> <code>var $uses = array('Post', 'Comment'); <br></code> <br>  &lt;p /&gt; The $ uses variable of the controller is responsible for the models that the controller will use.  If this variable is not set, then by default it will use only the model whose controller it actually is.  That is, PostsController will only use Post. <br>  &lt;p /&gt; Here, as you can see, we indicate to the controller that it will use the Post and Comment models. <br>  &lt;p /&gt; Now we‚Äôll edit the function of the controller, which is responsible for displaying the actual post. <br> <code>function view($id) <br> { <br> $this-&gt;Post-&gt;id = $id; <br> $this-&gt;set('post',$this-&gt;Post-&gt;read()); <br> //   : <br> $this-&gt;set('comments' , $this-&gt;Comment-&gt;findAllByPost($id)); <br> } <br></code> <br>  &lt;p /&gt; With this new line, we add a new comment variable to the view and set its value to the $ this-&gt; Comment-&gt; findAllByPost ($ id) result. <br>  &lt;p /&gt; Here I must say a few words about the great findAllByPost method. <br>  &lt;p /&gt; Smart CakePHP provides classes inherited from AppModel to use methods of type findAllBy &lt;field name&gt; (&lt;value&gt;).  Who will find all records from the table corresponding to the model, where &lt;field name&gt; = &lt;value&gt;.  Great, right? <br>  &lt;p /&gt; Therefore, $ this-&gt; Comment-&gt; findAllByPost ($ id) will return all emails belonging to the displayed post. <br>  &lt;p /&gt; Now in the view.thtml file, which is located in the app / views / posts folder, we will add a display of these features.  To do this, at the very end of this file add: <br> <code>&lt;?php <br> foreach($comments as $comment): <br> echo ''.$comment['Comment']['comment'].'&lt;br/&gt;'; <br> endforeach; <br> ?&gt; <br></code> <br>  &lt;p /&gt; Here I‚Äôll scroll through all the pages we‚Äôve passed to the sideview in the previous piece of code and display them on the screen.  Cool?  Cool! <br>  &lt;p /&gt; But in kamenta the most important thing is that they can be left.  Therefore, we need a form for adding kamentov at the bottom of the post.  The form helper will help us with this. <br>  var $ helpers = array ('Html', 'Form'); <br>  &lt;p /&gt; This line in the posts_controller.php file tells the controller which helpers it will use in its work.  Html and Form help our post controller respectively. <br>  &lt;p /&gt; Add the following to the same view.thtml file: <br> <code>&lt;?php <br> echo $form-&gt;create('Comment'); <br> echo $form-&gt;hidden('post', array('value' =&gt; $post['Post']['id'])); echo $form-&gt;input('comment', array('type'=&gt;'textarea')); <br> echo $form-&gt;submit('Submit'); <br> <br> echo $form-&gt;end(); <br> ?&gt; <br></code> <br>  &lt;p /&gt; This is our little helper created a form of adding a stone.  In it, the post id is specified as a hidden field (hidden), and a user is asked to enter a textarea. <br>  &lt;p /&gt; Now we need something that can control the addition of this kament.  This will be the comment controller: <br> <code>&lt;?php <br> class CommentsController extends AppController <br> { <br> var $name = 'Comments'; <br> function add() <br> { <br> if (!empty($this-&gt;data)) <br> { <br> if ($this-&gt;Comment-&gt;save($this-&gt;data)) <br> { <br> $this-&gt;Session-&gt;setFlash('Redirecting'); <br> $this-&gt;redirect('/posts/view/'.$this-&gt;data['Comment']['post']); <br> } <br> else <br> $this-&gt;Session-&gt;setFlash('You fail'); <br> } <br> } <br> } <br></code> <br>  &lt;p /&gt; There is only one handler for one add event in the controller controller.  It is identical to the same handler for adding a post controller, only redirects to another place. <br>  &lt;p /&gt; Hooray!  We now have a real blog with kamentami.  But not simple, but written on a real framework, according to the true MVC architecture.  With my own hands. <br></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/22343/">https://habr.com/ru/post/22343/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../223419/index.html">Microwaves guard weather forecasts, or what a scatterometer</a></li>
<li><a href="../22342/index.html">The Large Hadron Collider</a></li>
<li><a href="../223421/index.html">How to optimize a site for mobile devices using PageSpeed ‚Äã‚ÄãInsights</a></li>
<li><a href="../223425/index.html">5 reasons to use AngularJS in your corporate application</a></li>
<li><a href="../223427/index.html">History of Chinese Astronautics</a></li>
<li><a href="../223431/index.html">VoxImplant Android SDK: telephony and voice real-time communication in your application</a></li>
<li><a href="../223433/index.html">History of wearable technology</a></li>
<li><a href="../22344/index.html">GoogleTalk, part I (first steps, general setup)</a></li>
<li><a href="../223441/index.html">Number recognition: from A to 9. Part 3</a></li>
<li><a href="../223445/index.html">Meet AppCode 3.0: Built-in UI Designer, Reveal Plugin, and More</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>