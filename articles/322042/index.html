<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wiring diagrams in Autocad using .NET</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After graduation, I came to work at an engineering company as an electrical engineer. All calculations were carried out in Excel, after which it was n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wiring diagrams in Autocad using .NET</h1><div class="post__text post__text-html js-mediator-article">  After graduation, I came to work at an engineering company as an electrical engineer.  All calculations were carried out in Excel, after which it was necessary to draw charts based on calculated data, which took a lot of time.  In addition, errors were accumulating when transferring data from Excel to Autocad.  When you change the source data, you had to correct the calculations, and then the scheme.  In general, a bunch of useless work that took a lot of time. <br><br>  It is good that AutoCAD provides ample opportunities for developers in the field of automation of the design process and helps to save hundreds and thousands of hours of work. <br>  A special plugin based on .NET was developed, which exported data from Excel and created electrical circuits in AutoCAD. <br><a name="habracut"></a><br>  The principle of operation of the plugin is quite simple.  The working DWG file contains blocks-elements of the circuits with attributes that contain information about the installed capacity, rated current, etc.  The plugin reads data from the Excel calculation table and builds a block diagram, filling the attributes with numbers from the calculation table. <br><br>  Recently, I began to ask questions with requests to add something, add, change.  But unfortunately, there is not enough time for revision, and every engineer has his own wishes.  In this regard, I post the source: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ‚Üí <a href="https://github.com/NabiyevTR/SingleDiagram">https://github.com/NabiyevTR/SingleDiagram</a> <br><br>  I hope that the plugin will help save time for design engineers and improve the quality of documentation. <br><br><h3>  Instructions for working with the plugin </h3><br>  ‚Üí <a href=""><b>Download plugin</b></a> <br><br><h4>  System requirements </h4><br><ul><li>  Autodesk AutoCAD 2015 </li><li>  Microsoft Office Excel 2010 and later </li></ul><br><h4>  Archive composition </h4><br><ul><li>  The plugin files are located in the <b>Program Files</b> folder.  Here you need the <b>OneLine3.dll</b> library <b>file</b> .  The remaining files are auxiliary, needed for the plugin to work. </li><li>  The file <b>SHIELD.xslm</b> contains a calculation table, on the basis of which a single-line diagram is built </li><li>  File <b>SCHEME.dwg</b> is a file that contains the necessary elements for creating a single-line diagram.  This is where we will load the plugin. </li><li>  The file <b>SLD_Buttons.cuix</b> is an adaptation file.  In order not to write commands on the command line, you can load it into AutoCAD and use the buttons. </li></ul><br><h4>  Work with plugin </h4><br><ol><li>  Unzip the archive on a local disk.  If the plugin is hosted on the server, AutoCAD will not allow it to run. </li><li>  Launch AutoCAD and open the <b>SCHEME.dwg</b> file. </li><li>  Now you need to load the plugin in AutoCAD.  At the command prompt, enter <b>_NETLOAD</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a21/729/b0f/a21729b0f8864b45940de795ee5594f1.png"></div><br></li><li>  In the window that opens, specify the path to the <b>OneLine3.dll</b> file. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/387/0eb/dfb/3870ebdfb2124017b71b494d8e2297c1.png"></div><br></li><li>  AutoCAD will display a warning that the file being downloaded is outside the safe location.  Click the <b>Download</b> button. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5d2/6e2/e87/5d26e2e871904e1790f78b82440aecd8.png"></div><br></li><li>  Now that the plugin is loaded, you need to run it.  Type <b>_DSLD</b> in the command line. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d3c/542/e1b/d3c542e1bfd64c27b17dfdd590643744.png"></div><br></li><li>  A window has appeared.  Now you need to click the <b>Open</b> button. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6bc/377/053/6bc3770537124026a98dca5b5598a1ca.png"></div><br></li><li>  In the window that opens, specify the path to the file with the calculations <b>SHIELD.xslm</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/427/450/e93/427450e93a6a462e80bcdb60b3f6b8a2.png"></div><br></li><li>  Loaded data from the table.  The left column shows the sheets from the file <b>SHIELD.xslm</b> .  Select a shield (s) and transfer them to the second column by pressing <b>button 1</b> .  Then click the button <b>Draw</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e4f/382/f0f/e4f382f0fee7420da913929d84e671ba.png"></div><br></li><li>  But the result of our work. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e88/c9e/b1f/e88c9eb1f03b4060b11d60850786f3e0.png"></div><br></li></ol><br><h3>  Questions that may arise when working with the program </h3><br>  Of course, this plugin can not solve all the problems.  Unfortunately, there are no universal solutions.  In this section, I will try to answer questions that you may have while working with this program. <br><div class="spoiler">  <b class="spoiler_title">I downloaded the plugin, but nothing happens when I invoke the command.</b>  <b class="spoiler_title">The command line says: Failed to load the assembly.</b>  <b class="spoiler_title">Error Details: System.IO.FileLoadException: Failed to load file or assembly ...</b> <div class="spoiler_text">  AutoCAD 2015 and later versions do not allow libraries loaded via the Internet to be connected.  To avoid this, you need to make a change to the acad.exe.config file, add the line: <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">loadFromRemoteSources</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br>  It should turn out like this: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">startup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">useLegacyV2RuntimeActivationPolicy</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">supportedRuntime</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"v4.0"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">startup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--All assemblies in AutoCAD are fully trusted so there's no point generating publisher evidence--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">runtime</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">generatePublisherEvidence</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">loadFromRemoteSources</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">runtime</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">I need to make changes to the schemes created earlier.</b>  <b class="spoiler_title">How to do it?</b> <div class="spoiler_text">  There are two ways to make changes.  The first is to make changes in the calculation file and generate the schema again using the plugin. <br><br>  The second way is to make changes in the drawing itself.  This can be done through <b>Properties</b> , highlighting the necessary element. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3c3/409/cf3/3c3409cf30ca4414b9d7b16e4666dd75.png"></div><br>  You can change the data through the <b>Attribute Editor by</b> double-clicking the left mouse button on the edited block. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7e6/a5a/46f/7e6a5a46f8f342b68a0d5db3f4741d6f.png"></div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">How to replace a circuit breaker with a differential circuit breaker?</b> <div class="spoiler_text">  All blocks are made dynamic.  Just change the block type. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/109/3e2/81d/1093e281dba843729818e0a8f42ba478.png"></div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">How to change the font?</b> <div class="spoiler_text">  Open and change the style <b>SLD_Style</b> .  After that, it is advisable to execute the <b>_REGEN</b> and <b>_REGENALL commands</b> . <br></div></div><br><div class="spoiler">  <b class="spoiler_title">I try to partition objects with the _EXPLODE command, but all data is lost.</b> <div class="spoiler_text">  Use the <b>_BURST</b> command. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">I do not need to show the brand of the switch.</b>  <b class="spoiler_title">How to make it not displayed?</b> <div class="spoiler_text">  Select the block and open it in the block editor. <br><br>  Remove unnecessary attribute. <br><br>  Close the block editor, saving changes. <br><br>  <b>Enter _ATTSYNC</b> and select an editable block.  After synchronization, the deleted attribute should disappear. <br><br>  Similarly, you can delete and move other attributes. <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/322042/">https://habr.com/ru/post/322042/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322030/index.html">How I got a job at the Stack Exchange</a></li>
<li><a href="../322032/index.html">Laboratory: ProContent 2.0. Closer to the user</a></li>
<li><a href="../322034/index.html">Interesting clustering algorithms, part two: DBSCAN</a></li>
<li><a href="../322036/index.html">Highly reliable PostgreSQL cluster based on Patroni, Haproxy, Keepalived</a></li>
<li><a href="../322040/index.html">Five things that mobile application developers need to know about cross-marketing</a></li>
<li><a href="../322044/index.html">How IT professionals work. Boris Tikhomirov, Director of PROMT Mobile and Internet Projects</a></li>
<li><a href="../322046/index.html">Containers and safety: seccomp</a></li>
<li><a href="../322048/index.html">MOOC ‚ÄúProgramming and development of web applications‚Äù: announcement and interview with the author of the course of ITMO University</a></li>
<li><a href="../322052/index.html">Lambda calculus on javascript</a></li>
<li><a href="../322054/index.html">Generators lie, or the battle of advertising and morality in the network</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>