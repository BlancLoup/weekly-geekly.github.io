<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Downloading Kaspersky Rescue Disk 10 over the network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article offered for familiarization will tell you how to make a downloadable (pxe-bootable) option from the popular computer virus treatment tool....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Downloading Kaspersky Rescue Disk 10 over the network</h1><div class="post__text post__text-html js-mediator-article">  The article offered for familiarization will tell you how to make a downloadable (pxe-bootable) option from the popular computer virus treatment tool.  The material will be useful to system administrators, employees of service centers and, perhaps, someone else who often has to reanimate computers infected with viruses. <br><br>  The article is relevant for the version of Kaspersky Rescue Disk 10.0.31.4 (the latest version at the time of publication). <br><br><h4>  Formulation of the problem </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The task is reduced to several points: <ol><li>  Adapt Kaspersky Rescue Disk 10 (hereinafter referred to simply as KRD10) to boot from the network. </li><li>  Provide a local mirror of updates from which it would be possible to periodically update the anti-virus database without downloading a fresh iso-image each time. </li><li>  Change some of the default antivirus settings.  For example, checking archives sometimes takes a lot of time, and every time it is tedious to remove the same checkbox in the settings before the scan. </li><li>  <b>Automate the</b> implementation of the above points as much as possible, reducing the number of buttons required to a minimum. </li></ol><a name="habracut"></a><br><h4>  System requirements </h4><br><br>  Server requirements: <ul><li>  The operating system is Ubuntu 10.04 or newer.  I tested the scripts with Ubuntu 10.04 Server x32 and Ubuntu 11.10 Desktop x32.  If you have a different Linux distribution, you may need to change something. </li><li>  Dhcp and tftp services are running. </li><li>  Pxelinux is configured (there is a pxelinux.0 boot loader, a pxelinux.cfg / defult configuration file, etc.). </li></ul>  You can read more about how to deploy a network boot in fifteen minutes. <br><br>  Client requirements: <ul><li>  PXE BOOT ROM network adapter. </li><li>  Not less than 512MB RAM. </li></ul><br><h4>  Prepare.sh script </h4><br><br>  The prepare.sh script is run <b>once</b> to prepare everything you need, namely: <br><ul><li>  Install the missing packages (or make sure they are available). </li><li>  Download iso-image KRD10. </li><li>  Download antivirus database update utility. </li><li>  Download and compile from the source squashfs-tools. </li></ul>  The latter is necessary for the reason that in Ubuntu from the repositories, squashfs-tools are installed by default without xz-compression support.  If you have any version of squashfs-tools already installed, <b>there is no need to remove them from the system, there will be</b> no conflict. <br><br>  Listing prepare.sh: <br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh #   krd10_src="http://rescuedisk.kaspersky-labs.com/rescuedisk/updatable/kav_rescue_10.iso" retranslator_src="http://utils.kaspersky.com/updater/retranslator_5.0.0.9/Linux/retranslator-5.0.0-9.tar.gz" squashfs_src="http://jaist.dl.sourceforge.net/project/squashfs/squashfs/squashfs4.2/squashfs4.2.tar.gz" #    echo &amp;&amp; echo "STEP 1 : Do you have zlib, lzma, g++ and patch?" apt-get -q -y install zlib1g-dev liblzma-dev lzma g++ patch #    echo &amp;&amp; echo "STEP 2 : I need to download some files..." # KRD10 wget -nc -c $krd10_src if [ "$?" -ne "0" ]; then echo echo "Can't download Kaspersky Rescue Disk 10 iso image!" echo exit 1 fi #     wget -nc -c $retranslator_src if [ "$?" -ne "0" ]; then echo echo "Can't download RETRANSLATOR!" echo exit 1 fi #  squashfs-tools wget -nc -c $squashfs_src if [ "$?" -ne "0" ]; then echo echo "Can't download SQUASHFS package!" echo exit 1 fi #  echo &amp;&amp; echo "STEP 3 : Let's see what's inside..." tar -xzf retranslator-5.0.0-9.tar.gz tar -xzf squashfs4.2.tar.gz #    echo &amp;&amp; echo "STEP 4 : Patching config files..." #      patch -p0 -i retranslator.patch #  Makefile (   XZ-) patch -p0 -i squashfs.patch #  squashfs4.2 echo &amp;&amp; echo "STEP 5 : Building squashfs4.2 with XZ support..." make -C ./squashfs4.2/squashfs-tools/</span></span></code> </pre> <br><br>  Patch retranslator.patch <br><pre> <code class="bash hljs">--- ./retranslator/retranslator.bak 2010-07-14 02:51:11.000000000 +1100 +++ ./retranslator/retranslator.conf 2012-01-08 18:30:56.438109054 +1100 @@ -35,23 +35,23 @@ <span class="hljs-comment"><span class="hljs-comment"># # Optional specification of components to be retranslated. # -RetranslateComponentsList=AVS, CORE, BLST, Updater +RetranslateComponentsList=EMU,KDB,QSCAN,RD # # Optional specification of OS filter. # -#os2=Win;Mac;Linux +os2=Linux # # Optional specification of instruction set filter. # -#instrset=kernel:i386,x64;user:i386; +instrset=kernel:i386;user:i386; # # Optional specification of application filter. # -#application=WKS 6.0.4.1424; +application=RD 10.*.*.*; # # Optional specification of build filter. @@ -182,5 +182,5 @@ # this level if you are reporting bugs in the product. Do not forget to turn # it off afterwords. Debug messages have 'D' mark in the log file. # -ReportLevel=9 +ReportLevel=3</span></span></code> </pre><br><br>  Patch squashfs.patch <br><pre> <code class="bash hljs">--- ./squashfs4.2/squashfs-tools/Makefile.bak 2011-03-01 06:04:15.000000000 +1000 +++ ./squashfs4.2/squashfs-tools/Makefile 2012-03-13 12:20:20.823261029 +1100 @@ -26,7 +26,7 @@ <span class="hljs-comment"><span class="hljs-comment"># To build using XZ Utils liblzma - install the library and uncomment # the XZ_SUPPORT line below. # -#XZ_SUPPORT = 1 +XZ_SUPPORT = 1 ############ Building LZO support ##############</span></span></code> </pre> <br><br>  If everything went without errors, then in the folder ./squashfs4.2/squashfs-tools/ there will be two executable files - mksquashfs and unsquashfs, and in the folder ./retranslator, a ready-to-work local mirror of the anti-virus databases will appear. <br><br><h4>  Script make_rescue.igz.sh </h4><br><br>  This is the <b>main</b> script, the result of which are three files: the kernel ‚Äúrescue‚Äù, the ramdisk ‚Äúrescue.igz‚Äù and the configuration file ‚Äúmenu.cfg‚Äù for pxelinux. <br><br>  Listing make_rescue.igz.sh: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh #   ,     ,     crontab. cd $(cd $(dirname $0) &amp;&amp; pwd) #  . krd10_iso="http://rescuedisk.kaspersky-labs.com/rescuedisk/updatable/kav_rescue_10.iso" #   tftp (      pxelinux.0  ..), #    . tftproot_dir="/storage/tftproot" #    tftproot_dir,    . dest_dir="apps/kaspersky" #  download_iso="1"  ,       KRD10. #   ,   . download_iso="0" #  update_liveos="0"      KRD10    . update_liveos="1" #  compress_lzma="1"     . #    , - . compress_lzma="0" #   KRD10    . echo &amp;&amp; echo "STEP 1 : Downloading iso image..." if [ "${download_iso}" = "1" ]; then if [ -e "kav_rescue_10.iso" ]; then mv -f kav_rescue_10.iso kav_rescue_10.iso.bak fi wget -nv ${krd10_iso} else echo "This step was skipped." fi #    echo &amp;&amp; echo "STEP 2 : Downloading anti-virus bases..." #     (sed      " "   ). if [ -e "retranslator/bases/bases/av/kdb/i386/old/kdb.stt" ]; then old_base=`cat retranslator/bases/bases/av/kdb/i386/old/kdb.stt | sed 's/\x0D$//'` else old_base="did not update yet" fi ./retranslator/retranslator #    . new_base=`cat retranslator/bases/bases/av/kdb/i386/old/kdb.stt | sed 's/\x0D$//'` echo "Old base version : ${old_base}" echo "New base version : ${new_base}" #    (  ,  -  )  . base_ver=`echo ${new_base} | sed 's/.*;//'` #  iso . echo &amp;&amp; echo "STEP 3 : Mounting iso image..." mkdir iso &amp;&amp; mount -o loop kav_rescue_10.iso iso/ #    disk_ver=`cat iso/rescue/KRD.VERSION | sed 's/; $//'` echo "Disk version : ${disk_ver}" #  rescue.igz. echo &amp;&amp; echo "STEP 4 : Decompressing rescue.igz..." mkdir tmp cp iso/boot/rescue.igz ./tmp/rescue.lzma mkdir initrd cd initrd &amp;&amp; lzcat -S lz ../tmp/rescue.lzma | cpio -i --no-absolute-filenames &amp;&amp; cd ../ #   ! echo &amp;&amp; echo "STEP 5 : Patching some files..." #    ,     LiveCD #   ,     7. patch -p0 -i init.patch patch -p0 -i dmsquash-live-root.patch #  ,        . echo &amp;&amp; echo "STEP 6 : Patching LiveOS..." if [ "${update_liveos}" = "1" ]; then #    xz-!  -  squashfs-root. ./squashfs4.2/squashfs-tools/unsquashfs iso/rescue/LiveOS/squashfs.img #    ,  . mkdir mnt &amp;&amp; mount -o loop -t auto squashfs-root/LiveOS/ext3fs.img mnt #   -  (.   config.xml.patch ). patch -p0 -i config.xml.patch #      ./mnt   #      . umount mnt &amp;&amp; rm -rf mnt ./squashfs4.2/squashfs-tools/mksquashfs squashfs-root squashfs.img -comp xz rm -rf squashfs-root else echo "This step was skipped." fi #     " ". echo &amp;&amp; echo "STEP 7 : Building livecd.squash..." mkdir -p livecd/rescue/help cp iso/rescue/help/*.txt livecd/rescue/help/ cp -r iso/rescue/help/English livecd/rescue/help cp -r iso/rescue/help/Russian livecd/rescue/help cp iso/rescue/KRD.VERSION livecd/rescue/ cp iso/livecd livecd/ #     ,  ,    ... if [ "${update_liveos}" = "1" ]; then mkdir livecd/rescue/LiveOS &amp;&amp; mv squashfs.img livecd/rescue/LiveOS/ # ...    "". else cp -r iso/rescue/LiveOS livecd/rescue fi #     ! mkdir -p livecd/rescue/bases/Stat cp retranslator/bases/index/u0607g.xml livecd/rescue/bases/Stat/ cp retranslator/bases/bases/av/kdb/i386/*.ini livecd/rescue/bases/ cp retranslator/bases/bases/av/kdb/i386/*.kdc livecd/rescue/bases/ cp retranslator/bases/bases/av/kdb/i386/*.kdl livecd/rescue/bases/ cp retranslator/bases/bases/av/kdb/i386/*.xml livecd/rescue/bases/ mv livecd/rescue/bases/kdb-i386-0607g.xml livecd/rescue/bases/kdb-0607g.xml cp retranslator/bases/bases/av/kdb/i386/old/kdb.stt livecd/rescue/bases/Stat/ cp retranslator/bases/bases/av/kdb/i386/old/kavbase.mft livecd/rescue/bases/ cp retranslator/bases/bases/av/emu/i386/* livecd/rescue/bases/ cp retranslator/bases/bases/av/qscan/i386/u/* livecd/rescue/bases/ # WindowsUnlocker    . mkdir livecd/rescue/bases/data cp retranslator/bases/AutoPatches/rd/rd-0607g.xml livecd/rescue/bases/ cp retranslator/bases/AutoPatches/rd/windowsunlocker livecd/rescue/bases/data/ # . ./squashfs4.2/squashfs-tools/mksquashfs livecd initrd/livecd.squash #   rescue.igz. echo &amp;&amp; echo "STEP 8 : Building rescue.igz..." if [ "${compress_lzma}" = "1" ]; then #  lzma  echo "Lzma compress enabled." cd ./initrd &amp;&amp; find . | cpio -o -Hnewc | lzma -c &gt; ../rescue.igz &amp;&amp; cd ../ else #  lzma  echo "Lzma compress disabled." cd ./initrd &amp;&amp; find . | cpio -o -Hnewc &gt; ../rescue.igz &amp;&amp; cd ../ fi #   ,   . echo &amp;&amp; echo "STEP 9 : Moving image and cleaning temp dirs..." if [ ! -d ${tftproot_dir}/${dest_dir} ]; then mkdir -p ${tftproot_dir}/${dest_dir} fi cp -f iso/boot/rescue ${tftproot_dir}/${dest_dir}/ mv -f rescue.igz ${tftproot_dir}/${dest_dir}/ rm -rf tmp rm -rf livecd rm -rf initrd umount iso &amp;&amp; rm -rf iso #    pxelinux.    ,  ... echo &amp;&amp; echo "STEP 10 : Pxelinux config..." echo "LABEL kaspersky_rescue_disk_10" &gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo "MENU LABEL Kaspersky Rescue Disk ${disk_ver}-${base_ver}" &gt;&gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo "KERNEL ${dest_dir}/rescue" &gt;&gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo "APPEND initrd=${dest_dir}/rescue.igz root=live rootfstype=auto vga=791 init=/init kav_lang=ru udev liveimg doscsi nomodeset quiet splash" &gt;&gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo "TEXT HELP" &gt;&gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo "Disk version : ${disk_ver}" &gt;&gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo "New base version : ${new_base}" &gt;&gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo "Old base version : ${old_base}" &gt;&gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo "Rescue.igz build date : `date +%H:%M/%d.%m.%y`" &gt;&gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo "ENDTEXT" &gt;&gt; ${tftproot_dir}/${dest_dir}/menu.cfg echo &amp;&amp; cat ${tftproot_dir}/${dest_dir}/menu.cfg</span></span></code> </pre> <br><br>  Patch init.patch <br><pre> <code class="bash hljs">--- ./initrd/init.bak 2012-03-11 23:30:56.000000000 +1100 +++ ./initrd/init 2012-03-12 00:09:33.165699617 +1100 @@ -270,7 +270,7 @@ <span class="hljs-comment"><span class="hljs-comment"># [ $main_loop -gt $RDRETRY ] \ # &amp;&amp; { flock -s 9 ; emergency_shell "No root device \"$root\" found"; } 9&gt;/.console_lock if [ $main_loop -gt $RDRETRY ]; then - CDROM_DEVICES="/dev/sr*" + CDROM_DEVICES="/livecd.squash" for i in $CDROM_DEVICES do /sbin/dmsquash-live-root $i @@ -288,7 +288,7 @@ unset RDRETRY if ! ismounted "/run/initramfs/live"; then - CDROM_DEVICES="/dev/sr*" + CDROM_DEVICES="/livecd.squash" for i in $CDROM_DEVICES do /sbin/dmsquash-live-root $i</span></span></code> </pre> <br><br>  Patch dmsquash-live-root.patch <br><pre> <code class="bash hljs">--- ./initrd/sbin/dmsquash-live-root.bak 2012-03-11 23:30:56.000000000 +1100 +++ ./initrd/sbin/dmsquash-live-root 2012-03-12 00:07:12.531467569 +1100 @@ -28,47 +28,47 @@ overlay=$(getarg rd.live.overlay overlay) <span class="hljs-comment"><span class="hljs-comment"># CD/DVD media check -[ -b $livedev ] &amp;&amp; fs=$(blkid -s TYPE -o value $livedev) -if [ "$fs" = "iso9660" -o "$fs" = "udf" ]; then - check="yes" -fi -getarg rd.live.check check || check="" +#[ -b $livedev ] &amp;&amp; fs=$(blkid -s TYPE -o value $livedev) +#if [ "$fs" = "iso9660" -o "$fs" = "udf" ]; then +# check="yes" +#fi +#getarg rd.live.check check || check="" -if [ -n "$check" ]; then - [ -x /bin/plymouth ] &amp;&amp; /bin/plymouth --hide-splash - checkisomd5 --verbose $livedev || : - if [ $? -ne 0 ]; then - die "CD check failed!" - exit 1 - fi - [ -x /bin/plymouth ] &amp;&amp; /bin/plymouth --show-splash -fi +#if [ -n "$check" ]; then +# [ -x /bin/plymouth ] &amp;&amp; /bin/plymouth --hide-splash +# checkisomd5 --verbose $livedev || : +# if [ $? -ne 0 ]; then +# die "CD check failed!" +# exit 1 +# fi +# [ -x /bin/plymouth ] &amp;&amp; /bin/plymouth --show-splash +#fi # determine filesystem type for a filesystem image -det_img_fs() { - local _img="$1" _loop=$(losetup -f) _fs - losetup $_loop $_img; _fs=$(det_fs $_loop); losetup -d $_loop - echo $_fs -} +#det_img_fs() { +# local _img="$1" _loop=$(losetup -f) _fs +# losetup $_loop $_img; _fs=$(det_fs $_loop); losetup -d $_loop +# echo $_fs +#} for arg in $CMDLINE; do case $arg in ro|rw) liverw=$arg ;; esac; done # mount the backing of the live image first mkdir -m 0755 -p /run/initramfs/live -if [ -f $livedev ]; then - # no mount needed - we've already got the LiveOS image in initramfs - # check filesystem type and handle accordingly - case `det_img_fs $livedev` in - squashfs) SQUASHED=$livedev ;; - auto) die "cannot mount live image (unknown filesystem type)" ;; - *) FSIMG=$livedev ;; - esac -else - mount -n -t $fstype -o ${liverw:-ro} $livedev /run/initramfs/live +#if [ -f $livedev ]; then +# # no mount needed - we've already got the LiveOS image in initramfs +# # check filesystem type and handle accordingly +# case `det_img_fs $livedev` in +# squashfs) SQUASHED=$livedev ;; +# auto) die "cannot mount live image (unknown filesystem type)" ;; +# *) FSIMG=$livedev ;; +# esac +#else + mount -n -t auto -o ro $livedev /run/initramfs/live if [ "$?" != "0" ]; then die "Failed to mount block device of live image" exit 1 fi -fi +#fi # overlay setup helper function do_live_overlay() {</span></span></code> </pre> <br><br>  The config.xml.patch patch changes only two settings: first, it turns on file checking ‚Äúby format‚Äù, and, second, it turns off the archive check: <br><pre> <code class="bash hljs">--- ./mnt/etc/kl/config.xml.bak 2012-02-07 09:03:33.000000000 +1100 +++ ./mnt/etc/kl/config.xml 2012-03-13 12:45:20.000000000 +1100 @@ -795,8 +795,8 @@ &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"ExcludeByMask"</span></span>&gt;0&lt;/tDWORD&gt; &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"MandatoryScanPeriod"</span></span>&gt;7&lt;/tDWORD&gt; &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"RootkitScan"</span></span>&gt;1&lt;/tDWORD&gt; - &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"ScanArchived"</span></span>&gt;1&lt;/tDWORD&gt; - &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"ScanFilter"</span></span>&gt;1&lt;/tDWORD&gt; + &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"ScanArchived"</span></span>&gt;0&lt;/tDWORD&gt; + &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"ScanFilter"</span></span>&gt;0&lt;/tDWORD&gt; &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"ScanFixed"</span></span>&gt;1&lt;/tDWORD&gt; &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"ScanMail"</span></span>&gt;0&lt;/tDWORD&gt; &lt;tDWORD name=<span class="hljs-string"><span class="hljs-string">"ScanMailBases"</span></span>&gt;0&lt;/tDWORD&gt;</code> </pre> <br><br><h4>  Pxelinux setup </h4><br><br>  Upon completion of the script, the file $ {tftproot_dir} / $ {dest_dir} /menu.cfg will have something like this: <br><pre> <code class="hljs pgsql">LABEL kaspersky_rescue_disk_10 MENU LABEL Kaspersky Rescue Disk <span class="hljs-number"><span class="hljs-number">10.0</span></span><span class="hljs-number"><span class="hljs-number">.31</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">-201206200949</span></span> KERNEL apps/kaspersky/rescue APPEND initrd=apps/kaspersky/rescue.igz root=live rootfstype=auto vga=<span class="hljs-number"><span class="hljs-number">791</span></span> init=/init kav_lang=ru udev liveimg doscsi nomodeset quiet splash <span class="hljs-type"><span class="hljs-type">TEXT</span></span> HELP Disk <span class="hljs-keyword"><span class="hljs-keyword">version</span></span> : <span class="hljs-number"><span class="hljs-number">10.0</span></span><span class="hljs-number"><span class="hljs-number">.31</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span> <span class="hljs-built_in"><span class="hljs-built_in">New</span></span> base <span class="hljs-keyword"><span class="hljs-keyword">version</span></span> : <span class="hljs-number"><span class="hljs-number">8154585</span></span>;<span class="hljs-number"><span class="hljs-number">201206200949</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Old</span></span> base <span class="hljs-keyword"><span class="hljs-keyword">version</span></span> : <span class="hljs-number"><span class="hljs-number">8151532</span></span>;<span class="hljs-number"><span class="hljs-number">201206190812</span></span> Rescue.igz build <span class="hljs-type"><span class="hljs-type">date</span></span> : <span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>/<span class="hljs-number"><span class="hljs-number">20.06</span></span><span class="hljs-number"><span class="hljs-number">.12</span></span> ENDTEXT</code> </pre> <br><br>  It remains to add this line to your pxelinux.cfg / default (of course, changing the path to your own): <br><br> <code>INCLUDE apps/kaspersky/menu.cfg</code> <br> <br>  And to make it completely clear, I‚Äôll give you part of my pxelinux.cfg / default <br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> vesamenu.c32 PROMPT <span class="hljs-number"><span class="hljs-number">0</span></span> TIMEOUT <span class="hljs-number"><span class="hljs-number">100</span></span> ONTIMEOUT <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> MENU TITLE -= PXE Boot Menu =- MENU BACKGROUND menu.jpg MENU COLOR border <span class="hljs-number"><span class="hljs-number">30</span></span>;<span class="hljs-number"><span class="hljs-number">44</span></span> <span class="hljs-string"><span class="hljs-string">#00000000</span></span> <span class="hljs-string"><span class="hljs-string">#00000000</span></span> none MENU COLOR unsel <span class="hljs-number"><span class="hljs-number">37</span></span>;<span class="hljs-number"><span class="hljs-number">44</span></span> <span class="hljs-string"><span class="hljs-string">#90</span></span>ffffff <span class="hljs-string"><span class="hljs-string">#00000000</span></span> std MENU COLOR sel <span class="hljs-number"><span class="hljs-number">7</span></span>;<span class="hljs-number"><span class="hljs-number">37</span></span>;<span class="hljs-number"><span class="hljs-number">40</span></span> <span class="hljs-string"><span class="hljs-string">#70</span></span>ffffff <span class="hljs-string"><span class="hljs-string">#20</span></span>ff8000 all MENU COLOR hotsel <span class="hljs-number"><span class="hljs-number">1</span></span>;<span class="hljs-number"><span class="hljs-number">7</span></span>;<span class="hljs-number"><span class="hljs-number">37</span></span>;<span class="hljs-number"><span class="hljs-number">40</span></span> #e0ffffff <span class="hljs-string"><span class="hljs-string">#20</span></span>ff8000 all <span class="hljs-keyword"><span class="hljs-keyword">LABEL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> MENU <span class="hljs-keyword"><span class="hljs-keyword">LABEL</span></span> Boot from <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> drive localboot <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LABEL</span></span> memtest86p MENU <span class="hljs-keyword"><span class="hljs-keyword">LABEL</span></span> MemTest86+ v4.<span class="hljs-number"><span class="hljs-number">20</span></span> KERNEL memdisk APPEND initrd=apps/memtest.bin INCLUDE apps/drweb/menu.cfg INCLUDE apps/kaspersky/menu.cfg</code> </pre> <br><br>  My menu looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/abe/5a7/7dc/abe5a77dccf996f3da63d8f87ea61b70.jpg" alt="image"><br><br>  Loading process: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/08c/a48/960/08ca48960afc0b866ecc5d9b38141b13.jpg" alt="image"><br><br>  Hooray, everything works: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/682/03e/2aa/68203e2aa39a46a19bcefe9fb2354b3b.jpg" alt="image"><br><br><h4>  Conclusion </h4><br>  Finally it remains to add the task to the crontab.  If you want to update the image daily, say, at eight in the morning, the config will be like this: <br><br><pre> <code class="hljs ruby">SHELL=<span class="hljs-regexp"><span class="hljs-regexp">/bin/sh</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> * * * <span class="hljs-regexp"><span class="hljs-regexp">/storage/projects</span></span><span class="hljs-regexp"><span class="hljs-regexp">/kaspersky_rescue_disk_10/make</span></span>_rescue.igz.sh &gt; <span class="hljs-regexp"><span class="hljs-regexp">/storage/projects</span></span><span class="hljs-regexp"><span class="hljs-regexp">/kaspersky_rescue_disk_10/results</span></span>.log <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  Do not forget to change the way to your own! <br><br>  PS download the archive with all the scripts and patches <a href="http://ifolder.ru/31232356">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/140002/">https://habr.com/ru/post/140002/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139992/index.html">Masters abroad: how to enroll and get a scholarship?</a></li>
<li><a href="../139993/index.html">Proved that Super Mario is an NP-full challenge.</a></li>
<li><a href="../139994/index.html">HP hardware stress tests</a></li>
<li><a href="../139997/index.html">14 ReSharper navigation and editing features</a></li>
<li><a href="../139999/index.html">PIRO - rocket for your PivotalTracker account</a></li>
<li><a href="../140003/index.html">Photo hosting and privacy of your photos</a></li>
<li><a href="../140005/index.html">Did you like Habr's spring update?</a></li>
<li><a href="../140006/index.html">Screencasts in Linux, personal experience</a></li>
<li><a href="../140007/index.html">Scaling printed layouts in three clicks</a></li>
<li><a href="../140008/index.html">Live Broadcast Microsoft Innovation Day 2012</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>