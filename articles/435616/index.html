<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How Peer Zoning simplified our lives and helped balance the load of EMC VPLEX</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Our storage infrastructure had two problems. Firstly, this is 960 ‚ÄúSingle initiator - Single target‚Äù zones on the SAN, which complicated the administr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How Peer Zoning simplified our lives and helped balance the load of EMC VPLEX</h1><div class="post__text post__text-html js-mediator-article">  Our storage infrastructure had two problems.  Firstly, this is 960 ‚ÄúSingle initiator - Single target‚Äù zones on the SAN, which complicated the administration of the SAN network.  And secondly, the unbalanced load on the directors of EMC VPLEX.  Thanks to the introduction of Peer zoning, we reduced the number of zones by 120 times, saved engineers twice the time and got a more or less even load of EMC VPLEX directors.  Next, tell you how we did it. <br><br>  In the customer's infrastructure: <br><br><ul><li>  one EMC VPLEX in each data center in Metro configuration; </li><li>  a total of 120 servers connected to them; </li><li>  Two SAN factories, each with two Brocade SAN switches. </li></ul><br>  On the diagram, it looks like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/oi/kv/96/oikv96lm4lvabbxkbn_jaotnw7o.jpeg"><br><br><a name="habracut"></a>  The diagram is simplified - it shows only one server and its connection to factories (the other servers are connected in the same way), only the front-end (FE) ports from EMC VPLEX are shown, back-end storage is not shown, and EMC VPLEX engines and directors are not shown. <br><br>  In the current configuration: <br><br><ul><li>  each EMC VPLEX has 4 engines </li><li>  each engine has two directors </li><li>  each director of 4 FE ports. </li></ul><br>  Total 4 * 2 * 4 = 32 FE ports, 16 of which, for fault tolerance, are connected to Fabric1 and the other 16 ports are connected to Fabric2. <br><br>  Each server has two HBAs: HBA0 and HBA1.  Connection to the factories is similar - for fault tolerance, HBA0 is connected to Fabric1, HBA1 - to Fabric2. <br><br>  According to the best practices of EMC VPLEX, each HBA server has a zone for one FE-port of each of the four engines.  When we used Single initiator zoning, it was 4 zones per factory, only 8 paths through two factories for one server. <br><br>  In the figure it looks like this: <br><br><img src="https://habrastorage.org/webt/cz/2k/dh/cz2kdh0uqvcfyo4qqusxmxbkkja.jpeg"><br><br>  A year ago, we used Single initiator zoning and did zoning on the principle of ‚ÄúSingle initiator - Single target‚Äù in each zone.  And so, if you count, there were 4 zones * 120 servers = 480 zones per one factory, and 8 zones * 120 servers = 960 zones respectively on two factories.  The introduction of Peer Zoning helped to reduce the number of zones by 120 (!) Times, reducing them to 8 - by 4 peer-zones in each factory. <br><br>  Unlike Single initiator zoning, Peer-zone consists of principal (target) and members (initiators).  Members within the same Peer zone only interact with the principal.  Moreover, each member does not see another member.  The same principal: one principal does not interact with another principal. <br><br>  We combined the FE ports of the VPLEX into groups and created 4 Peer zones in each factory. <br><br>  <b>How we implemented it</b> <br><br>  To comply with all EMC best practices, we did it as follows. <br>  The PELEX_VPLEX_Fabric1_Group1 zone as a principal includes VPLEX ports: <br><br>  Engine1_directorB_FC01 <br>  Engine2_directorA_FC01 <br>  Engine3_directorB_FC01 <br>  Engine4_directorA_FC01 <br><br>  The PELEX_VPLEX_Fabric1_Group2 zone as a principal includes VPLEX ports: <br><br>  Engine1_directorA_FC01 <br>  Engine2_directorB_FC01 <br>  Engine3_directorA_FC01 <br>  Engine4_directorB_FC01 <br><br>  The PELEX_VPLEX_Fabric2_Group1 zone as a principal includes VPLEX ports: <br><br>  Engine1_directorA_FC00 <br>  Engine2_directorB_FC00 <br>  Engine3_directorA_FC00 <br>  Engine4_directorB_FC00 <br><br>  And so on. <br><br>  Schematically: <br><br><img src="https://habrastorage.org/webt/t4/4i/hq/t44ihqffzwx8b_1iwbgaijejpuw.jpeg"><br><br>  Now, when adding new servers to the SAN, it is enough to add the WWN of new servers to the existing Peer zones. <br><br>  As a result of the introduction of Peer zoning, the administration of the SAN network zones has been greatly simplified, which at least twice saved the time of the engineers. <br><br>  And besides, we managed to achieve load balancing directors. <br>  Below are the Current Utilization charts taken from EMC ViPR SRM each of the directors of both EMC VPLEX cluster-1 and cluster-2. <br><br>  Yellow marks the start date of the phased implementation of PeerZoning on the front-end. <br><br><img src="https://habrastorage.org/webt/0g/ow/z0/0gowz0oshckiz-cs90xty8rclfa.png"><br><br><img src="https://habrastorage.org/webt/ur/dk/hr/urdkhr44dksj12z-tsjw7rbppzu.png"></div><p>Source: <a href="https://habr.com/ru/post/435616/">https://habr.com/ru/post/435616/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435606/index.html">How to write unit tests for actors? SObjectizer approach</a></li>
<li><a href="../435608/index.html">HF screens do it yourself</a></li>
<li><a href="../435610/index.html">Easter eggs for ZX Spectrum - in the music album and movie</a></li>
<li><a href="../435612/index.html">Trust Codda or your objects?</a></li>
<li><a href="../435614/index.html">Rust news # 4 (December 2018)</a></li>
<li><a href="../435618/index.html">My experience in preparing for employment at Google</a></li>
<li><a href="../435620/index.html">Ideas futurists who came true</a></li>
<li><a href="../435622/index.html">AT & T "switched" to 5G, changing the icon on the screen</a></li>
<li><a href="../435624/index.html">A selection of interesting reports from the conference 35C3</a></li>
<li><a href="../435626/index.html">How we found the critical vulnerability of AspNetCore.Mvc and switched to our own serialization</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>