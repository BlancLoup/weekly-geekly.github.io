<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Install and configure Puppet + Foreman on Ubuntu 14.04 (step-by-step tutorial)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, residents of Habr! 

 When the number of managed servers reaches several dozen, or even hundreds, you have to find a solution to automatical...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Install and configure Puppet + Foreman on Ubuntu 14.04 (step-by-step tutorial)</h1><div class="post__text post__text-html js-mediator-article"><img width="250" align="left" hspace="5" vspace="5" src="https://habrastorage.org/files/016/555/391/0165553913f74afd8bcc685997e403b6.png" alt="image">  Good day, residents of Habr! <br><br>  When the number of managed servers reaches several dozen, or even hundreds, you have to find a solution to automatically configure and manage such a fleet.  This is where Puppet comes to the rescue.  Why Puppet?  Puppet is cross-platform, has a rich community, has many ready-made modules (4800+), has Enterprise versions.  All these advantages do not give doubt to the power of this product.  But to manage such a ‚Äúcombine‚Äù from the console is not so easy.  Therefore, Foreman was developed for easy management and configuration of Puppet.  Next, install and configure this bundle using the example of managing SSH keys. <br><a name="habracut"></a><br>  <b>Requirements:</b> <br><br><ul><li>  clean server for <b>puppet-master</b> ; </li><li>  commands on the <b>puppet-master</b> server are executed as <b>root</b> ; </li><li>  commands on the <b>puppet agent</b> servers are executed through <b>sudo</b> . </li></ul><br>  <b>Used software:</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Ubuntu OS 14.04.5 LTS; </li><li>  Puppet 3.8.7; </li><li>  Foreman 1.11.4. </li></ul><br>  <b>Goals:</b> <br><br><ul><li>  get a convenient way to automatically manage the network infrastructure; </li><li>  get a convenient way to manage ssh keys. </li></ul><br>  <b>Note</b> <br><br>  All screenshots and a piece of configuration are hidden by spoilers.  For a better understanding of where commands are executed, a server type (master or agent) is added before each command. <br><br><h2>  1. Installing Foreman + Puppet on puppet masters </h2><br>  Add the Foreman / Puppet installer repository and install it into the system: <br><br><pre><code class="bash hljs">master ~ $ apt-get -y install ca-certificates master ~ $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ &amp;&amp; wget https://apt.puppetlabs.com/puppetlabs-release-trusty.deb master ~ $ dpkg -i puppetlabs-release-trusty.deb master ~ $ sh -c <span class="hljs-string"><span class="hljs-string">'echo "deb http://deb.theforeman.org/ trusty 1.11" &gt; /etc/apt/sources.list.d/foreman.list'</span></span> master ~ $ sh -c <span class="hljs-string"><span class="hljs-string">'echo "deb http://deb.theforeman.org/ plugins 1.11" &gt;&gt; /etc/apt/sources.list.d/foreman.list'</span></span> master ~ $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ &amp;&amp; wget -q http://deb.theforeman.org/pubkey.gpg -O- | apt-key add - master ~ $ apt-get update &amp;&amp; apt-get -y install foreman-installer</code> </pre> <br>  Run the installer: <br><br><pre> <code class="bash hljs">master ~ $ foreman-installer</code> </pre><br>  The result should be similar to the following: <br><br><div class="spoiler">  <b class="spoiler_title">Foreman installation result</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/95f/495/94b/95f49594b709481f99709d543ec7e3ca.png"><br></div></div><br>  Link type <b>puppet. &lt;Domain.com&gt;</b> and login with a password will be useful to us further. <br><br>  Set up a configuration for viewing file changes in Foreman: <br><br><pre> <code class="bash hljs">master ~ $ nano /etc/puppet/puppet.conf &gt; show_diff = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre><br>  Open the link recommended in the previous step in your browser: <b>puppet. &lt;Domain.com&gt;</b> <br>  And enter the username: <b>admin</b> and password, which we saw in the console after installation. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot of the authorization form</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/482/86e/73c/48286e73c27c4f9f8e59a5f1fccee343.png"><br></div></div><br>  If the authorization is successful, then Foreman is installed and working properly.  Now you can proceed to the next chapter. <br><br><h2>  2. Configure Foreman </h2><br>  By default, Foreman uses its SSL certificate generated by Puppet and your browser will not accept it.  You can add a root certificate ( <code>/var/lib/puppet/ssl/certs/ca.pem</code> ) to your browser so that insecure connection warnings disappear (for Chromium add here: Settings / SSL / Certification Authorities). <br><br>  When you first log in, you will see the <b>Dashboard</b> page, where the total statistics for all hosts will be shown.  When adding hosts, there will be useful statistical information here. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot Panel</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/9f0/401/7df/9f04017dfa5746d8a64ea609f8f25bf3.png"><br></div></div><br>  At subsequent logins, you will be redirected to the host list page. <br><br><h3>  2.1.  Change Password </h3><br>  The first step is to change the user password: <br><br><div class="spoiler">  <b class="spoiler_title">Change password</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/356/5fd/5ad/3565fd5addd7419db55e7b8a89f4b987.png"><br></div></div><br>  The default password and so complex, but it is better to make your own. <br><br><h3>  2.2.  Adding a module using the example of NTP </h3><br>  The time must be precisely set on the main server puppet-master.  For this you need to use NTP.  If the time is incorrect, the puppet-master may erroneously issue agent certificates from the distant past or future, which other nodes will consider obsolete. <br><br>  Sometimes, in order to be able to manage Puppet modules through Foreman, you need to install modules that are not developed by Puppet-Labs, but by the developers of the Puppet community.  This follows from the fact that Foreman uses HTTP Restful API requests for Puppet, but not all modules define management using such an API. <br><br>  Install the <b>saz / ntp</b> module on the puppet master: <br><br><pre> <code class="bash hljs">master ~ $ puppet module install saz/ntp</code> </pre> <br>  <b>Note</b> <br><br>  The <b>saz / ntp</b> module works great on Foreman version 1.11.  For other versions of Foreman, you can use modules from the site <a href="https://forge.puppetlabs.com/">forge.puppetlabs.com</a> to search for <b>ntp</b> . <br><br>  You should see the following: <br><br><div class="spoiler">  <b class="spoiler_title">The result of installing saz / ntp</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/900/327/68a/90032768a9294c1ba9a2b55837729817.png"><br></div></div><br>  Now the module has been installed only for the puppet-master.  Now you need to enter the web interface and add it to Foreman.  Go to <b>Configure ‚Üí Classes</b> and click <b>Import from puppet. &lt;Domain.com&gt;</b> : <br><br><div class="spoiler">  <b class="spoiler_title">Configure ‚Üí Classes</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/836/c80/74a/836c8074a1bf43b4acfe4a0d4d6b0d70.png"><br></div></div><br>  As a result, you will see a list of available classes, check the ones you need and click <b>Update</b> : <br><br><div class="spoiler">  <b class="spoiler_title">Update</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/539/5af/113/5395af113fac451db9c3177e5712dedc.png"><br></div></div><br>  In order to use the ntp servers <a href="http://www.pool.ntp.org/">closest</a> to you, go to the website <a href="http://www.pool.ntp.org/">www.pool.ntp.org</a> .  There, in the right block, select the pool we need (Africa, Asia, etc.) and retrieve the list of servers to the clipboard. <br><br>  Next, go to the settings of the <b>ntp</b> class by clicking on its name.  Go to the <b>Smart Class Parameter</b> tab and look for the <b>server list</b> tab in the left <b>list</b> : <br><br><div class="spoiler">  <b class="spoiler_title">server list</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/9a1/5a9/eb0/9a15a9eb05124291bff005e198be1dd1.png"><br></div></div><br>  Check the <b>Override</b> item and in the <b>Default value,</b> following the example of the previous value, add the server from the step above.  I added the following value: <br><br><pre> <code class="bash hljs">[<span class="hljs-string"><span class="hljs-string">"0.asia.pool.ntp.org"</span></span>,<span class="hljs-string"><span class="hljs-string">"1.asia.pool.ntp.org"</span></span>,<span class="hljs-string"><span class="hljs-string">"2.asia.pool.ntp.org"</span></span>,<span class="hljs-string"><span class="hljs-string">"3.asia.pool.ntp.org"</span></span>]</code> </pre><br>  Click <b>Submit</b> at the bottom of the page, thus we have redefined the class parameter. <br><br><h3>  2.3.  Adding the accounts and ssh module </h3><br>  Using the example of the previous module, install the <b>accounts</b> module: <br><br><pre> <code class="bash hljs">master ~ $ puppet module install camptocamp-accounts</code> </pre><br>  If the installation was successful, you will see the following: <br><br><div class="spoiler">  <b class="spoiler_title">The result of the installation accounts</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/a04/d55/0be/a04d550beb534a9bb1785314c0d204bb.png"><br></div></div><br>  Install the <b>ssh</b> module: <br><br><pre> <code class="bash hljs">master ~ $ puppet module install saz/ssh</code> </pre><br>  After that we go to <b>Foreman</b> and import new classes.  Later, after creating the host groups, we will configure the <b>accounts</b> and <b>ssh</b> classes. <br><br><h3>  2.4.  Adding the module mysql and apache </h3><br>  To explain the subsequent names of the <b>database</b> and <b>web</b> groups, add <b>apache</b> and <b>mysql</b> modules.  We add modules by the example of the previous ones.  You can download them with the following commands: <br><br><pre> <code class="bash hljs">master ~ $ puppet module install puppetlabs-apache master ~ $ puppet module install puppetlabs-mysql</code> </pre><br><h2>  3. Adding network nodes </h2><br>  To add a host to Puppet, you need to install a puppet agent on this host.  To install the puppet agent, download and install the <b>puppet-labs</b> repository: <br><br><pre> <code class="bash hljs">agent ~ $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ &amp;&amp; wget https://apt.puppetlabs.com/puppetlabs-release-trusty.deb agent ~ $ sudo dpkg -i puppetlabs-release-trusty.deb agent ~ $ sudo apt-get update</code> </pre><br>  Then install the puppet agent: <br><br><pre> <code class="bash hljs">agent ~ $ sudo apt-get -y install puppet</code> </pre><br>  To run Puppet as an agent, you need to comment out the settings of the puppet wizard zone.  Also add a configuration for the agent that will set the address of our puppet wizard.  Here is the configuration file <code>/etc/puppet/puppet.conf</code> in the form: <br><br><div class="spoiler">  <b class="spoiler_title">puppet.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs">[main] logdir=/var/<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>/puppet vardir=/var/lib/puppet ssldir=/var/lib/puppet/ssl rundir=/var/run/puppet factpath=<span class="hljs-variable"><span class="hljs-variable">$vardir</span></span>/lib/facter <span class="hljs-comment"><span class="hljs-comment">#templatedir=$confdir/templates #[master] # These are needed when the puppetmaster is run by passenger # and can safely be removed if webrick is used. #ssl_client_header = SSL_CLIENT_S_DN #ssl_client_verify_header = SSL_CLIENT_VERIFY [agent] server = puppet.domain.com #  puppet.domain.com - hostname  IP-  master-</span></span></code> </pre><br></div></div><br>  Replace the value of the variable <b>START</b> from <b>no</b> to <b>yes</b> to start the puppet agent after rebooting the OS.  And also we will start the puppet-agent: <br><br><pre> <code class="bash hljs">agent ~ $ sudo sed -is/START=no/START=yes/g /etc/default/puppet agent ~ $ sudo service puppet start</code> </pre><br>  With a small infrastructure, the puppet agent can be run as a daemon.  There is also a way to start via CRON: <a href="https://docs.puppet.com/puppet/3.6/services_agent_unix.html">docs.puppet.com/puppet/3.6/services_agent_unix.html#running-puppet-agent-as-a-cron-job</a> . <br><br>  <b>Note</b> <br><br>  The default puppet agent looks for the domain of the puppet master in its zone, unless the <b>server</b> parameter is explicitly specified (in the puppet.conf file).  For example: <b>server.domain.com</b> will search for the <b>puppet.domain.com</b> server.  Therefore, if you still follow the instructions, then everything should work for you. <br><br>  After that, go to Foreman in <b>Infrastructure ‚Üí Smart Proxies ‚Üí Certificates</b> : <br><br><div class="spoiler">  <b class="spoiler_title">Infrastructure ‚Üí Smart Proxies ‚Üí Certificates</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/f12/f30/a35/f12f30a3564a4040a35fae4b1eec1781.png"><br></div></div><br>  There should appear a network node on which we have just installed the puppet agent.  You can use a filter (top left) to see only unsigned certificates.  To sign, you must click the <b>Sign</b> button: <br><br><div class="spoiler">  <b class="spoiler_title">Certificates ‚Üí Sign</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/d0b/abd/7f1/d0babd7f12b44fef8f45a8843a063a8b.png"><br></div></div><br>  Within a few minutes, the server <b>server. &lt;Domain.com&gt;</b> (the server on which we just installed the agent) will appear in the list of <b>Hosts ‚Üí All hosts</b> . <br><br><h2>  4. Adding host groups </h2><br>  Go to the menu item <b>Configure ‚Üí Host Groups</b> .  Click <b>New Host Group</b> .  Tab <b>Host Group</b> should get the following: <br><br><div class="spoiler">  <b class="spoiler_title">Configure ‚Üí Host Groups</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/6bc/84e/9a8/6bc84e9a818d4bbeb41b42912fa9769f.png"><br></div></div><br>  The <b>root</b> group will be the root.  She will be the parent of all other groups.  She will have full access to everything.  And it will include the main classes. <br><br>  Next, go to the <b>Puppet Classes</b> tab and add the necessary classes by clicking on <b>+</b> : <br><br><div class="spoiler">  <b class="spoiler_title">Puppet classes</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/899/fc1/0fd/899fc10fd69f4d5585d8b9ca1a0ff8ae.png"><br></div></div><br>  Click <b>Submit</b> . <br><br>  Let's add two more groups on the same principle.  Only now we will select the <b>root</b> group as the <b>Parent</b> , because the <b>accounts</b> , <b>ntp</b> and <b>ssh</b> classes are inherited and you do not need to add them again.  Let's add the class <b>mysql :: server</b> only for the <b>database</b> group, and the <b>apache</b> class for the <b>web</b> group. <br><br><div class="spoiler">  <b class="spoiler_title">Add database group</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/e0a/2d6/d14/e0a2d6d1450941ff83a824976cdfe2f0.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">List of all groups</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/636/b58/c11/636b58c11c33442b9efdd4ff56a3d415.png"><br></div></div><br><h2>  5. Adding a node to a group </h2><br>  To include a node in a group, you must go to its settings. <br><br><div class="spoiler">  <b class="spoiler_title">Host settings</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/8ed/643/e02/8ed643e021e6491093e47be03fc6f4ce.png"><br></div></div><br>  After that, in the first tab, add a group, as in the screenshot below: <br><br><div class="spoiler">  <b class="spoiler_title">Add group to host</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b92/cff/c66/b92cffc66a7d4efe81840cbb58b336ce.png"><br></div></div><br>  After that click <b>Submit</b> and <b>mysql</b> will appear on the host in a few minutes.  In the same way, you can assign the <b>web</b> group to the other two servers: <br><br><div class="spoiler">  <b class="spoiler_title">List of hosts with assigned groups</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/49b/93c/0d1/49b93c0d101a4c0f9b19b6fd01b0dc70.png"><br></div></div><br>  The entire configuration extends to puppet agents automatically for a short time. <br><br>  If you do not want to wait, then you can run the <code>puppet agent --test</code> command on clients and see with your own eyes how the configuration is created. <br><br><h2>  6. Setting permissions using the accounts module </h2><br>  Actually now you can once again look at the scheme that we led at the beginning and create logic on the basis of it. <br><br>  Go to the menu item <b>Configure ‚Üí Classes</b> .  Click on <b>accounts</b> to go to the module settings.  Of all the settings, we will need the <b>accounts</b> , <b>ssh keys</b> , <b>users</b> tabs. <br><br>  <b>Note</b> <br>  Accounts tab - it contains hashes "server user ‚Üí public key names from <b>ssh keys</b> tab".  Tab <b>ssh keys</b> - it contains hashes "key name ‚Üí type and value".  <b>Users</b> tab - it contains the users that you need to create or specify for already existing some parameters. <br><br>  Open the last <b>users</b> tab and set it up as in the screenshot: <br><br><div class="spoiler">  <b class="spoiler_title">users</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/780/b8c/3ff/780b8c3ff4d7472eb31a2f0d9d60c7b2.png"><br></div></div><br>  This parameter sets up the user's home directory.  Here we used the <b>Merge overrides</b> and <b>Merge default</b> parameters, which will allow to merge the configuration for the end node of the network. <br><br>  Fill in the <b>ssh keys</b> tab as follows: <br><br><div class="spoiler">  <b class="spoiler_title">ssh keys</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/1f7/080/75c/1f708075ca024c338e00fd55739d2692.png"><br></div></div><br>  In the <b>Default value</b> field, you must enter all public keys of accounts that will be used in the <b>accounts</b> tab.  These are public keys of users who will have access to certain servers.  Indenting two spaces before the <b>type</b> and <b>public</b> parameters is required. <br><br>  An example of how one public key looks like (the rest are added one after another below): <br><br><pre> <code class="bash hljs">admin: <span class="hljs-built_in"><span class="hljs-built_in">type</span></span>: ssh-rsa public: AAAAB3NzaC1yc2EAAAADAQABAAABAQDXibuyi2MFzERps7mD2J38mhd4phXQlOEZrmui9rDdcYD0XeEnvdRTZPcsMOw6DRT1ERpzbcFehj+G29YxoiXZ541gVjVvsATAqojN3zEkMz5b0AgBNcKDFi9h/qwlK9YDv2trKEcRHQ4kBN332Z6oqdBFerUMys5dvc3RVlE+x2kVmYNmGIlma5twC9w/wRNoD+nUK+3bk+I+Og40f//uFAKFeY4DMoCrdOsHJrPak5nD9vL6a2m/Fe3jfgmpBCcnV3LS2mr+PdRYbtju7nzfu8WT0ugMAUi+dDMRFh3DmfCzXbOi2TPi+mP//L/A19thXffd/QzW7wmAgxlj+km1</code> </pre><br>  Fill up the uppermost <b>accounts</b> tab as follows: <br><br><div class="spoiler">  <b class="spoiler_title">accounts</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/291/c56/15b/291c5615b336413295321cb790cace96.png"><br></div></div><br>  This parameter should: <b>root</b> has access everywhere from the <b>root</b> account (the <b>root</b> account is an element from the <b>ssh keys</b> tab), the <b>dbadmin</b> account has root access only to servers from the <b>database</b> group, and only the <b>web</b> group has <b>admin</b> user <b>admin</b> and can connect only under the <b>admin</b> user. <br><br>  On the <b>users</b> tab, add the <b>admin</b> user to the <b>www-data</b> group. <br><br><div class="spoiler">  <b class="spoiler_title">users</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/137/872/3c5/1378723c589547edab7d08cf72ca2563.png"><br></div></div><br><h3>  6.1 Setting up the ssh class </h3><br>  In the <b>accounts</b> class, we set up ssh access by keys.  Therefore, for more complete security, it is necessary to prohibit password access.  This is done using the <b>ssh</b> class.  Go to its settings and open the <b>Smart Class Parameter</b> tab.  Further <b>client options are</b> as follows: <br><br><div class="spoiler">  <b class="spoiler_title">client options</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/608/edb/df6/608edbdf6a774126a29bd7e470c59c1a.png"><br></div></div><br>  The <b>server options</b> tab is as follows: <br><br><div class="spoiler">  <b class="spoiler_title">server options</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/c31/8c1/560/c318c15605f143a0b05d51758f2814ee.png"><br></div></div><br>  And fill in the tab <b>storeconfigs enabled</b> as follows: <br><br><div class="spoiler">  <b class="spoiler_title">storeconfigs enabled</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/705/ab8/be9/705ab8be9f254a07a7564e29f7bbde08.png"><br></div></div><br>  <b>Storeconfigs</b> stores all customer facts, so you can query the database and get lists of hosts that meet certain criteria.  For more security, we have disabled it. <br><br><h2>  7. Results </h2><br>  As you complete this tutorial, your infrastructure added to Puppet management will become quickly configurable and scalable.  And the main goal - managing public ssh keys will be as convenient as possible. <br><br>  A screenshot of the list of <b>admin</b> user keys on one of the <b>root / web</b> machines: <br><br><div class="spoiler">  <b class="spoiler_title">Ssh key list</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/923/ec9/354/923ec9354b784d8788eac312c893e9d3.png"><br></div></div><br>  Remember, when setting up the <b>accounts</b> class for the <b>ssh keys</b> parameter, we included <b>Merge overrides</b> and <b>Merge default</b> .  This is necessary so that at the end for a certain network node a single structured file with ssh keys is collected. <br><br>  Check whether you can authenticate as the user ‚Äú <b>admin</b> ‚Äù with the added key: <br><br><div class="spoiler">  <b class="spoiler_title">Ssh connection check</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/369/f96/ba1/369f96ba1e514227a035d1fb6ded3fa5.png"><br></div></div><br>  If you also passed the test successfully, the infrastructure is ready and you can gradually connect the rest of your servers to the puppet master and configure other services via Puppet. <br><br>  Resources used: <a href="https://docs.puppet.com/puppet/">Puppet</a> <a href="https://theforeman.org/documentation.html">documentation, Foreman documentation</a> . </div><p>Source: <a href="https://habr.com/ru/post/323708/">https://habr.com/ru/post/323708/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323694/index.html">How Discord stores billions of messages</a></li>
<li><a href="../323696/index.html">Lectures Technopark. The course "Algorithms and data structures" (autumn 2016)</a></li>
<li><a href="../323702/index.html">Find for spy: AAB-testing as the best option for split-test</a></li>
<li><a href="../323704/index.html">Product Design Digest February 2017</a></li>
<li><a href="../323706/index.html">Tips for a novice rocker</a></li>
<li><a href="../323710/index.html">I gave up on coffee, and that's what happened.</a></li>
<li><a href="../323714/index.html">Reliable authorization for web service in one evening</a></li>
<li><a href="../323716/index.html">A revolution in radio engineering? RF-ARM-FPGA SoC</a></li>
<li><a href="../323718/index.html">The digest of interesting materials for the mobile # 194 developer (March 6-12)</a></li>
<li><a href="../323722/index.html">US Air Force uses IBM's neuromorphic chip to detect tanks and ground air defense systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>