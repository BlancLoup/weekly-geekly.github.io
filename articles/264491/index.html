<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Optimize graphics with WebP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Interface Developer Blog What week is it? What is the school week now? Even or odd?  According to the Web Perfomance Today website, the average page w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Optimize graphics with WebP</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/261/0e0/502/2610e05020e843bd8663a6bf104bf933.png"><h3>  <sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><a href="http://ymatuhin.ru/"><font color="white">Interface Developer Blog</font></a></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub> <sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><a href="http://whataweek.github.io/"><font color="white">What week is it?</font></a></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub>  <sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><a href="http://whataweek.github.io/"><font color="white">What is the school week now?</font></a></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub>  <sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><sub><a href="http://whataweek.github.io/"><font color="white">Even or odd?</font></a></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub></sub> </h3>  According to the <a href="http://www.webperformancetoday.com/2015/01/14/mobile-page-growth/">Web Perfomance Today</a> website, the average page weight in 2015 is <b>1109 KB</b> .  According to forecasts, by 2018 there will be about <i>2 MB</i> .  Image loading takes an average of <b>64% (711 KB) of the</b> total page load time.  Therefore, it is necessary to start optimizing the page loading speed with graphics. <br><a name="habracut"></a><br>  Graphics are optimized in two ways: <br><ul><li>  decrease in the number of requests </li><li>  weight reduction graphics </li></ul><br>  To reduce requests, sprites are used and graphics are pasted in via <code>base64</code> .  To reduce the weight of the graph is compressed (with and without loss of quality). <br>  Unfortunately, compression often leads to poor quality and a small gain in size.  Perhaps this is why Google in 2010 created its own image compression format - <b>WebP</b> . <br><br><h2>  Support </h2><br>  We believe <a href="http://caniuse.com/">Can I Use</a> , which says that WebP is supported at <b>64.77%</b> in the world and <b>56.22%</b> in Russia, which gives us reason to use it.  From browsers it is Chrome, Opera, Opera Mini, Android Browser, Chrome for Android. <br><br><h2>  Testing Compression </h2><br>  Before using WebP, check how effective it is.  I downloaded 12 <code>png</code> and <code>jpg</code> images.  And compared the sizes before and after optimization: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Original files - <b>6.7</b> MB </li><li>  After compression - <b>5.4</b> MB </li><li>  Original WebP format - <b>1.6</b> MB </li><li>  After compression in WebP format - <b>1.8</b> MB </li></ul><br><br>  The gain in size turned out to be <i>3.8 MB</i> , i.e. <b>70.3%</b> .  Since images are on average <i>64%</i> , the gain in page loading speed will be <b>~ 44.8%</b> for users whose browsers support WebP! <br><br><h2>  We use WebP </h2><br>  You can use the new format through the <code>img</code> tag and through the <code>css</code> property <code>background</code> .  Of course, let's not forget about users without the support of this format. <br><br>  To determine WebP support, you can use <a href="http://modernizr.com/">Modernizr</a> or a <a href="https://gist.github.com/ymatuhin/a9601bd608b8de4e4dcc">snippet</a> .  After that write a fallback: <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.no-webp</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.logo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(logo.png); } <span class="hljs-selector-class"><span class="hljs-selector-class">.webp</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.logo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(logo.webp); }</code> </pre><br>  Through <code>img</code> it would seem possible to make two images too, and hide one of them.  But the problem is that the browser will still request both PNG and WebP, which, on the contrary, will increase the page load time. <br><br>  Another way is to request an image in WebP format, if it does not load, then display PNG. <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image.webp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onerror</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"this.onerror=null; this.src='image.png'"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  This method has a similar problem - if the browser does not support WebP, it will make 2 requests for each picture, which will increase the loading time. <br><br><h2>  Another variant </h2><br>  Not finding a native solution, I wrote a small library <a href="http://ymatuhin.github.io/simple-webp/">simple-webp</a> , which solves the problem of two queries. <br><br>  Usage example: <br><ul><li>  Add to cap <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"simple-webp.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre> </li><li>  Instead of standard images, write by template <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">noscript</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-webp</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"example.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">noscript</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </li></ul><br><br>  The library checks the support of the WebP format, then adds / removes the <code>webp/no-webp</code> to <code>html</code> and if the browser supports WebP, the library will replace the extension of your image with <code>.webp</code> and load it.  Otherwise, the browser will load the image in the original format. <br><br>  For example, if the browser supports WebP, then instead of <code>example.png</code> load, if not - <code>example.png</code> . <br><br>  <code>Noscript</code> necessary to prevent downloading images, and if JavaScript is disabled, the user will still see the image. <br><br>  The library is publicly available on <a href="https://github.com/ymatuhin/simple-webp">Github</a> , occupies 2 KB in uncompressed form. <br><br><blockquote>  PS In the examples for optimization, I used the application under OS X - ImageOptim.  To convert to WebP - WebPonoize. <br><br>  PSS Download the archive with images on which I made a comparison can be on the <a href="">link</a> . <br></blockquote><br><br>  <b>UPD # 1</b> In the <a href="https://habrahabr.ru/users/veg/" class="user_link">VEG</a> <a href="http://habrahabr.ru/post/264491/">comments</a> <a href="https://habrahabr.ru/users/veg/" class="user_link">,</a> pointed out an incorrect test, and provided links with tests from Mozilla <a href="https://people.mozilla.org/~josh/lossy_compressed_image_study_october_2013/">2013</a> and <a href="https://people.mozilla.org/~josh/lossy_compressed_image_study_july_2014/">2014</a> .  They show that the level of compression in WebP and other formats is approximately the same.  The profit from WebP is that with strong compression the images look better. <br><br>  <b>UPD # 2</b> The way through NOSCRIPT has a big disadvantage in SEO, because  images are not indexed.  <a href="https://habrahabr.ru/users/pepelsbey/" class="user_link">pepelsbey</a> in the <a href="http://habrahabr.ru/post/264491/">comments</a> suggested to use <code>.</code> </div><p>Source: <a href="https://habr.com/ru/post/264491/">https://habr.com/ru/post/264491/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264481/index.html">Tor for everyone: if they block torproject</a></li>
<li><a href="../264483/index.html">Databoom: create applications - we will support</a></li>
<li><a href="../264485/index.html">Webix + databoom = rapid application prototyping</a></li>
<li><a href="../264487/index.html">Acceleration and optimization of PHP-site. What technologies should be chosen when setting up a server for PHP</a></li>
<li><a href="../264489/index.html">Recognition of Cyrillic Yandex Captcha</a></li>
<li><a href="../264493/index.html">Android numeric entry field</a></li>
<li><a href="../264495/index.html">How to make a fuel plugin (for example, NFS). Part 1</a></li>
<li><a href="../264497/index.html">Video from LoveQA mitap</a></li>
<li><a href="../264499/index.html">Online Programming Programming Basics</a></li>
<li><a href="../264501/index.html">Zabbix - welcome to listen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>