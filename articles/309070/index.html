<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Smart home software</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day everyone. As a hobby, I wrote a program that can be used as part of the ‚Äúsmart home‚Äù system. In order to immediately interest the reader, I w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Smart home software</h1><div class="post__text post__text-html js-mediator-article">  Good day everyone.  As a hobby, I wrote a program that can be used as part of the ‚Äúsmart home‚Äù system.  In order to immediately interest the reader, I will demonstrate some small part of software use scenarios: <br><br><img src="http://noant.github.io/Pyrite/Paper/Img/main.JPG" alt="image"><br><a name="habracut"></a><br><table><tbody><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Gif/pyriteGif3_3.gif" alt="image"></a> <br></td><td>  Turning on and off ZWave bulbs through a mobile application <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Gif/pyriteGif1_1.gif" alt="image"></a> <br></td><td>  When the device appears on the network (when the user comes home) <br>  turning on the ZWave light, Modbus RTU relay module, starting the computer via WakeOnLan and turning on the TV <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Gif/pyriteGif2_2.gif" alt="image"></a> <br></td><td>  Launching the browser, switching to Yandex. Radio, <br>  flipping tracks (hotkey emulation) <br></td></tr></tbody></table><br>  <b>In short:</b> <br><br>  <b>1.</b> The main part of the software is a server that runs on Windows, written in C #; <br>  <b>2.</b> Client on Android OS, written in Java; <br>  <b>3.</b> Clients are planned for UWP and IOS, a web client. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Some features of the software:</b> <br><br>  <b>1.</b> Script Builder.  Creation of complex scenarios with cycles and conditions; <br>  <b>2.</b> Work with devices ZWave and Modbus; <br>  <b>3.</b> Nesting scripts.  You can use one script in another as a procedure; <br>  <b>4.</b> Run a remote script.  In the current server script, you can run a remote script; <br>  <b>5. The</b> ability to add to the system its functionality through the creation of modules; <br>  <b>6.</b> Run scripts using a smartphone. <br><br><h3>  <font color="steelblue">Script Designer</font> </h3><br>  The program allows you to create a complex scenario, as well as a single action. <br><br>  <u>A single action</u> is a script that contains only one action.  It is not possible to create cycles and conditions in it, but you can only ‚Äúmuzzle‚Äù a certain action on a button in the client's UI. <br><br>  I will give my own way of using them as an example: I created the ‚ÄúRosettes‚Äù category, in it I collected all the lamps, a household fan, lamps, a TV and a computer.  Now, to enable one of these devices, open the client on the android, go to the ‚ÄúRosettes‚Äù category and select the appropriate menu item. <br><br>  Usually, it is inconvenient to use single actions, since various devices are conveniently run under some condition or at least not one by one.  This is what the ‚Äúcomplex scenario‚Äù is for, which is further discussed below. <br><br>  <u>The designer of a complex script</u> allows you to create scripts with cycles and conditions.  It has two modes: viewing and editing. <br><table><tbody><tr><td>  Sample Script in View Mode <br></td><td>  Sample script in edit mode <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/scen_example_view.jpg" width="450" alt="image"></a> <br></td><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/scen_example_edit.jpg" width="450" alt="image"></a> <br></td></tr></tbody></table><br>  <i>IF and OTHERWISE in the constructor</i> .  In these constructions, you can create chains of conditions with the logical operators NOT, OR, I. The constructor allows you to create a group of conditions and use the operators directly with the group.  If the condition is left empty, then it is automatically calculated as a lie. <br><br>  There are a number of built-in checks (such as checking for date, time, etc.), as well as a number as plug-ins. <br><br>  <i>Cycle bye in the constructor</i> .  The cycle consists of a condition and a body.  The condition is created in the same way as it is created in the IF design (groups of conditions, operators NOT, OR, AND). <br><table><tbody><tr><td>  Operator IF and possible conditions <br></td><td>  Operator bye <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/if_example.jpg" alt="image"></a> <br></td><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/while_example.jpg" alt="image"></a> <br></td></tr></tbody></table><br><table><tbody><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/action_example.jpg" alt="image"></a> <br></td><td>  The bodies IF, OTHERWISE and WHILE it is necessary to fill with something.  Actually, this content is the most important thing in the script. </td></tr></tbody></table><br><table><tbody><tr><td>  Main Script Designer Window <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/constructor_window.jpg" width="960" alt="image"></a> <br></td></tr></tbody></table><br>  You can also configure the following script options: <br><br>  - Run from the outside (on / off), allows you to prevent or allow the launch of the script from another machine or from the client; <br>  - Automatic script launch at system startup; <br>  - Select the category of the script, allows you to display in the client UI a menu item to run the script in a specific category. <br><br><h3>  <font color="steelblue">Work with ZWave and Modbus devices</font> </h3><br>  Currently, the system supports ZWave (based on openzwave) and Modbus RTU (based on nmodbus) devices. <br><br>  <u>ZWave</u> is a wireless communication protocol used in home automation.  To implement the protocol, miniature low-power radio frequency modules are used.  Now on the ZWave market there is a rather extensive list of devices, such as ZWave light bulbs, sockets, relay modules, switches, locks, temperature sensors (humidity, movement, leakage), thermostats, air conditioning control devices, etc.  Multi-sensors are also common - devices that combine several sensors (for example, a light sensor, presence, temperature, door sensor, etc.), which is very attractive in terms of financial costs and location in the room. <br><br>  In my program, the ZWave module allows you to perform all standard operations with devices, such as deleting, adding devices, resetting the controller.  You can also use multiple ZWave controllers, the end user will not see the difference.  For example, you can read the temperature from the sensor, which is connected to the controller "A", and start the air conditioner using the controller "B".  There are no restrictions, any action and verification are carried out in standard ways and are added to the script designer. <br><table><tbody><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/zwave.jpg" alt="image"></a> <br></td><td>  The market for ZWave devices is quite wide.  There are many actuators, such as relay modules, light bulbs, devices for working with air conditioning, temperature controllers, floor heating regulators, sockets, switches.  There are also many sensors: door opening sensor, temperature, leakage sensor, presence sensor, etc.  You can use a USB stick as a ZWave controller. <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/PyriteUI/zwave_main_window.png" alt="image"></a> <br></td><td>  The main window of the ZWave module <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/PyriteUI/zwave_select_controller_window.png" alt="image"></a> <br></td><td>  Controller selection and operations window <br></td></tr><tr><td> <a href=""><img width="450" src="http://noant.github.io/Pyrite/PyriteUI/zwave_select_node_window.png" alt="image"></a> <br></td><td>  Node selection (sensors, switches, etc.) <br></td></tr><tr><td> <a href=""><img width="450" src="http://noant.github.io/Pyrite/PyriteUI/zwave_select_value_window.png" alt="image"></a> <br></td><td>  Choice of node parameter (on / off, various numeric parameters such as temperature, humidity, etc.) <br></td></tr></tbody></table><br>  <u>Modbus</u> is a wired protocol used for communication between electronic devices that support it.  In the context of our program, it can be useful for working with relay modules, for which I use it at home. <br><table><tbody><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/relay_module_modbus.jpg" alt="image" width="200"></a> <br></td><td>  Modbus relay module.  Connects to the controller via the COM port. <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/PyriteUI/module_modbus_action.png" alt="image" width="200"></a> <br></td><td>  The main window of the Modbus RTU module <br></td></tr></tbody></table><br><h3>  <font color="steelblue">Scripting Nesting</font> </h3><br>  Scripting nesting is used to decompose smart home scenarios.  Often there are situations when one action is involved in many scenarios (for example, disconnecting all household devices can occur by clicking on the menu item in the program, by exiting all wi-fi devices from the network, just by timer), and therefore every time (or edit) the same algorithm in each of the scenarios does not seem convenient.  For this there is a built-in action that allows you to run an already created script in the current one.  It can also be convenient when new home appliances are often added (or other frequent changes in the ‚Äúsmart home‚Äù operation algorithm); to change the operation of all scenarios, it will be enough to change only one scenario that is used in them. <br><table><tbody><tr><td>  Action "Existing Script" in the list <br></td><td>  Select an existing script <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/existing_scen.jpg" alt="image"></a> <br></td><td><a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/existing_scen_window.jpg" alt="image"></a> <br></td></tr></tbody></table><br><h3>  <font color="steelblue">Run remote scripts</font> </h3><br>  By running remote scripts, you can run a script from one server to another.  As an example, I would like to cite my use of this functionality: I <i>created a script (on a home server) called ‚Äúlight + multimedia‚Äù, which turns on the light in the room, starts my desktop (using WakeOnLan), turns on the TV to which the desktop is connected and waits On it (the desktop), an instance of our program will be launched, then it will launch ‚Äúenable music‚Äù and ‚Äú20 units sound‚Äù scripts on it by running remote scripts.</i> <br><table><tbody><tr><td>  "Run remote script" listed <br></td><td>  Choosing a server and its script <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/remote_scenario.jpg" alt="image"></a> <br></td><td> <a href=""><img width="500" src="http://noant.github.io/Pyrite/Paper/Img/remote_scenario_window.jpg" alt="image"></a> <br></td></tr></tbody></table><br><h3>  <font color="steelblue">Writing your own modules</font> </h3><br>  In addition to the fact that the user can create complex scripts with standard tools, the program allows you to ‚Äúextend‚Äù it with custom modules in C #.  All elements of actions and checks in scripts (such as ‚ÄúCheck by date‚Äù, ‚ÄúShow message‚Äù, ‚ÄúModbus action‚Äù, ‚ÄúZWave action‚Äù, etc.) are classes inherited from ICustomAction and ICustomChecker.  By following certain rules, any user can create his own module, which can be either very simple (for example, sounding the current air temperature outside the window) or complex, which can be covered by a whole framework.  It is enough to inherit from the ICustomAction or ICustomChecker interfaces, arrange several attributes, compile the DLL and add to the program via the ‚ÄúMODULES‚Äù tab ( <a href="http://noant.github.io/Pyrite/PyriteMods.htm">complete instructions for</a> creating modules). <br><table><tbody><tr><td>  MODULES tab <br></td></tr><tr><td> <a href=""><img width="950" src="http://noant.github.io/Pyrite/PyriteUI/module.png" alt="image"></a> <br></td></tr></tbody></table><br><h3>  <font color="steelblue">Running Scripts with a Smartphone</font> </h3><br>  <i>* for now only Android OS</i> <br><br>  Scripts are displayed on the main screen and in categories.  The category is a virtual ‚Äúfolder‚Äù.  When the script is run, the status of the corresponding button is updated. <br><table><tbody><tr><td>  Connection Settings Screen <br></td><td>  Script launch screen <br></td></tr><tr><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/android_2.jpg" alt="image" width="300"></a> <br></td><td> <a href=""><img src="http://noant.github.io/Pyrite/Paper/Img/android_1.jpg" alt="image" width="300"></a> <br></td></tr></tbody></table><br>  In addition, it is possible to run scripts from the quick launch menu on the PC. <br><table><tbody><tr><td>  Quick Start Menu <br></td></tr><tr><td> <a href=""><img width="950" src="http://noant.github.io/Pyrite/PyriteUI/fast_window.png" alt="image"></a> <br></td></tr></tbody></table><br>  In the future, a client is planned for UWP, IOS, web, as well as a voice module for managing devices (plans for the near future) and creating scenarios using voice (strategic plans). <br><br>  Video at last: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/kjGzwHfzssI%3Ffeature%3Doembed&amp;xid=25657,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj4N3D2TAlRtbALwVpjpbx-9Zl-2g" frameborder="0" allowfullscreen=""></iframe><br><br>  ¬ª <a href="http://noant.github.io/Pyrite/">Program Page</a> <br>  ¬ª <a href="http://noant.github.io/Pyrite/downloads.html">Download link</a> <br>  ¬ª <a href="http://noant.github.io/Pyrite/description.html">Instructions for use</a> <br>  ¬ª <a href="http://noant.github.io/Pyrite/PyriteMods.htm">Instructions for creating your own modules</a> <br><br>  <b>PS:</b> If you find an error in the program, then please send it to the <a href="">mail</a> . </div><p>Source: <a href="https://habr.com/ru/post/309070/">https://habr.com/ru/post/309070/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309058/index.html">OK Google, what about good interfaces?</a></li>
<li><a href="../309060/index.html">The benefits of standardization</a></li>
<li><a href="../309062/index.html">Android to the State Duma will bring or mobilization of civic consciousness</a></li>
<li><a href="../309064/index.html">Example of exploiting one old vulnerability</a></li>
<li><a href="../309068/index.html">What we know about 5G networks</a></li>
<li><a href="../309072/index.html">Perimeter defense: old attacks are not worse than new ones</a></li>
<li><a href="../309074/index.html">Type inference in programming</a></li>
<li><a href="../309076/index.html">Unreachable web: how we made such a mess</a></li>
<li><a href="../309078/index.html">Tips for working with Steam GreenLight or how not to get bogged down in a swamp</a></li>
<li><a href="../309080/index.html">On the process of creating a server - from idea to detail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>