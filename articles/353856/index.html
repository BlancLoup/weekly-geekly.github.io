<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Comparison of LAN scanning tools</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When I worked in several government organizations as a quotational, vegetable penster, severe bearded uncle in sweaters taught me to use only Nmap to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Comparison of LAN scanning tools</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/lq/oo/d_/lqood_oy_o45orui_268gyscicw.jpeg"></div><br>  When I worked in several government organizations as a <s>quotational, vegetable</s> penster, severe bearded uncle in sweaters taught me to use only Nmap to scan the network.  Changing the place of work, Dobby became free from prejudice and decided to choose a scanner on his own based on pseudo-objective data comparing the real functionality of popular scanners that he could find on the network on his own, or by asking his colleagues what their favorite scanner was.  Actually, I decided to write an article about the results of the internal comparison of network scanners.  Objectivity is not guaranteed, but I tried to make quantitative analysis.  Who cares what came of it, welcome under cat. <br><a name="habracut"></a><br>  An old and experienced <s>wolf, a</s> bezopasnik offered his favorite and familiar console Nmap.  One more of our people from ‚Äúgosuhi‚Äù, <a href="https://habr.com/users/combonik/" class="user_link">combonik</a> , said that there is no difference, open source or vendor, the main thing is the web interface for work.  Our manager also said that vendor scanners are the best, arguing that such scanners have constant support, a convenient interface for work and constant updates. <br><br>  In order to smooth out our contradictions, it was decided to conduct a blitz testing of network vulnerability scanners.  Holivar among hacks <a href="https://hacken.io/">pentesters</a> led us to a new task - to conduct a comparative characteristic of the scan results.  Four scanners were chosen to compare the scan performance: Rapid7 Nexpose, Tenable Nessus, OpenVAS 9, and Nmap.  They were chosen on the basis of analytics online publications and personal experience.  Personally, I bet on Nessus, but alas, I did not guess. <br><br>  <b>Rapid7 Nexpose</b> is a vulnerability scanner that actively scans the IT infrastructure for erroneous configurations, holes, malicious codes, and provides recommendations for fixing them.  All infrastructure components, including networks, operating systems, databases and web applications, are included in the analysis.  According to the results of the verification, Rapid7 Nexpose in priority mode classifies detected threats and generates reports on their elimination.  [2] 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Tenable Nessus Scanner</b> is a scanner designed to assess the current state of security of a traditional IT infrastructure, mobile and cloud environments, containers, etc.  According to the results of the scan, it reports the found vulnerabilities.  It is recommended to use as part of the Nessus Security Center.  [3] <br><br>  <b>OpenVAS</b> is an open source vulnerability scanner.  OpenVAS is designed to actively monitor computer network nodes for security issues, assess the severity of these problems, and monitor their elimination.  Active monitoring means that OpenVAS performs some actions on the host: scans open ports, sends specially formed packets to simulate an attack, or even logs in on the host, gains access to the management console, and executes commands on it.  Then OpenVAS analyzes the collected data and makes conclusions about the presence of any security problems.  These problems, in most cases, relate to non-upgraded software installed on a node, in which there are known and described vulnerabilities, or insecurely configured software.  [1,6] <br><br>  <b>Nmap</b> is a free utility designed for a variety of customizable scanning of IP networks with any number of objects, determining the state of objects of the scanned network (ports and their corresponding services).  Initially, the program was implemented for UNIX systems, but now versions are available for many operating systems. [4,5] <br><br><h3>  Test environment </h3><br>  For testing, I assembled a test network on VMware Workstation 12 Pro into the circuit shown in Figure.  one. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qx/rr/lx/qxrrlx_71cnnuuao8f4iiwb9mlk.png"></div><br>  <i>Fig.</i>  <i>1. Network diagram</i> <br><br>  Raised virtuals: <br><br><ul><li>  Windows 7 with all installed updates, running the XAMPP application, deployed MySQL and Apache services.  Also deployed test system DVWA. </li><li>  Metasploitable 2 is an operating system with pre-installed vulnerable services and applications that is used for testing. </li><li>  Ubuntu 16.04 with installed IDS Suricata [10] and configured iptables [9]. </li><li>  Kali Linux is a Linux distribution that is used for penetration testing. </li><li>  The list of vulnerable services in Metasploitable 2 is shown in Table 1. </li></ul><br><br>  Table 1 <br><table><tbody><tr><td>  Service </td><td>  Port </td><td>  Status </td></tr><tr><td>  Vsftpd 2..four </td><td>  21 </td><td>  Open </td></tr><tr><td>  OpenSSH four.7p1 Debian 8ubuntu 1 (protocol 2.zero) </td><td>  22 </td><td>  Open </td></tr><tr><td>  Linux telnetd service </td><td>  23 </td><td>  Open </td></tr><tr><td>  Postfix smtpd </td><td>  25 </td><td>  Open </td></tr><tr><td>  ISC BIND 9.four.2 </td><td>  53 </td><td>  Open </td></tr><tr><td>  Apache httpd 2.2.eight Ubuntu DAV / 2 </td><td>  80 </td><td>  Open </td></tr><tr><td>  A RPCbind service </td><td>  111 </td><td>  Open </td></tr><tr><td>  Samba smbd .x </td><td>  139, 445 </td><td>  Open </td></tr><tr><td>  r companies </td><td>  512, 513, 514 </td><td>  Open </td></tr><tr><td>  GNU Classpath grmiregistry </td><td>  1099 </td><td>  Open </td></tr><tr><td>  Metasploitable root shell </td><td>  1524 </td><td>  Open </td></tr><tr><td>  A NFS service </td><td>  2048 </td><td>  Open </td></tr><tr><td>  ProFTPD 1..1 </td><td>  2121 </td><td>  Open </td></tr><tr><td>  MySQL 5.zero.51a-3ubuntu5 </td><td>  3306 </td><td>  Open </td></tr><tr><td>  PostgreSQL DB eight..zero - eight..7 <br></td><td>  5432 </td><td>  Open </td></tr><tr><td>  VNC protocol v1. </td><td>  5900 </td><td>  Open </td></tr><tr><td>  X11 service </td><td>  6000 </td><td>  Open </td></tr><tr><td>  Unreal ircd </td><td>  6667 </td><td>  Open </td></tr><tr><td>  Apache Jserv protocol 1. </td><td>  8009 </td><td>  Open </td></tr><tr><td>  Apache Tomcat / Coyote JSP engine 1.1 </td><td>  8180 </td><td>  Open </td></tr></tbody></table><br>  In practice, when internal networks are scanned on the firewall and IPS, rules are created that exclude scanning blocking.  Therefore, Suricata was used in detection mode, and permission rules were written on the firewall. <br><br>  Iptables configuration [9]: <br><br><pre><code class="hljs delphi">#!/bin/sh echo <span class="hljs-number"><span class="hljs-number">1</span></span> &gt; /proc/sys/net/ipv4/ip_forward iptables -A INPUT -i lo -j ACCEPT iptables -I <span class="hljs-keyword"><span class="hljs-keyword">FORWARD</span></span> -j ACCEPT iptables -A <span class="hljs-keyword"><span class="hljs-keyword">FORWARD</span></span> -i ens34 -o ens33 -j ACCEPT iptables -t nat -A POSTROUTING -o ens33 -s <span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">234.0</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> -j MASQUERADE iptables -A <span class="hljs-keyword"><span class="hljs-keyword">FORWARD</span></span> -i ens33 -m state --state ESTABLISHED, RELATED -j ACCEPT iptables -A <span class="hljs-keyword"><span class="hljs-keyword">FORWARD</span></span> -i ens33 -o ens34 -j REJECT</code> </pre> <br>  Nessus Scanner was launched in the ‚ÄúBasic Network Scanning‚Äù mode.  [3] <br>  Rapid 7 Nexpose was launched in the "Full audit without Web Spider" mode.  [2] <br>  OpenVAS 9 was launched in ‚Äúdefault‚Äù mode.  [1,6] <br>  Nmap was started by two commands: [4,5] <br><br><ul><li>  <i>nmap -sV -T4 -O -F --version-light 192.168.234.130-131</i> </li><li>  <i>nmap -Pn --script vuln 192.168.234.130-131</i> </li></ul><br><h3>  Test results </h3><br>  Nexpose discovered 527 vulnerabilities (see Diagram 1), of which: <br>  <a href="https://github.com/Medwed1993/ScannerReports/blob/master/Nexpose_report.pdf">Report</a> <br><br>  167 - received the status of ‚Äúcritical‚Äù - vulnerabilities must be closed first. <br>  349 - received the status of ‚Äúsevere‚Äù - vulnerabilities are difficult to operate, but can lead to serious consequences. <br>  46 - received the status of ‚Äúmoderate‚Äù - the found vulnerabilities can provide an attacker with information about the system, which he can use during the attack. <br><br>  Vulnerabilities not only of tested systems were found, but also potential vulnerabilities in the virtualization system. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kg/wl/xa/kgwlxangavhbsimtwhymqoo8oyk.png"></div><br>  Tenable Nessus discovered 168 vulnerabilities (see Diagram 2), of which: <br>  <a href="https://github.com/Medwed1993/ScannerReports/blob/master/Nessus_report.pdf">Report</a> <br><br>  3 - received the status of ‚Äúcritical‚Äù <br>  9 - received the status of "high" <br>  33 - received the status of ‚Äúmedium‚Äù <br>  5 - received the status of "low" <br>  118 received the status of ‚Äúinfo‚Äù <br><br>  Vulnerabilities of ‚Äúcritical‚Äù and ‚Äúhigh‚Äù should be closed first. <br>  Vulnerabilities of the ‚Äúmedium‚Äù level are difficult to operate, but with proper study they can cause damage. <br>  Vulnerabilities of ‚Äúlow‚Äù and ‚Äúinfo‚Äù levels can provide an attacker with information about the system, which he can use when conducting an attack through other vectors. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5v/m5/8y/5vm58yoaq7rncwho0zfkeirlpy8.png"></div><br>  OpenVAS 9 found 53 vulnerabilities (see Diagram 3), of which: <br>  <a href="https://github.com/Medwed1993/ScannerReports/blob/master/OpenVAS_report.pdf">Report</a> <br>  <a href="https://github.com/Medwed1993/ScannerReports/blob/master/OpenVAS_IDS">IDS Results</a> <br><br>  16 - received the status of "high" <br>  33 - received the status of ‚Äúmedium‚Äù <br>  4 - received the status of "low" <br><br>  High level vulnerabilities must be closed first. <br>  Vulnerabilities of the ‚Äúmedium‚Äù level are difficult to operate, but with proper study they can cause damage. <br>  Vulnerabilities of the ‚Äúlow‚Äù level can provide an attacker with information about the system, which he can use when conducting an attack through other vectors. <br><br><img src="https://habrastorage.org/webt/lt/hp/r_/lthpr_sziv-f8jl1bmvrwgvviqk.png"><br><br>  Separately, we should note the results obtained using the Nmap scanner.  Scanning was carried out by two teams, which were described above.  The result of the execution was the output of information about the operating system, open services and possible vulnerabilities and links found. <br><br>  Using the ‚Äúvuln‚Äù script has identified the following types of vulnerabilities: <br><br><ul><li>  open telnet </li><li>  http-csrf </li><li>  http-enum </li><li>  http-sql-injection </li><li>  http-vuln-cve2017-1001000 </li><li>  rmi-vuln-classloader </li><li>  mysql-vuln-cve2012-2122 </li><li>  ssl-ccs-injection </li><li>  ssl-dh-params </li><li>  ssl-poodle </li><li>  irc-botnet-channels </li><li>  http-flags </li></ul><br>  <a href="https://github.com/Medwed1993/ScannerReports/blob/master/NMAP_IDS1">Nmap and IDS Results</a> <br>  <a href="https://github.com/Medwed1993/ScannerReports/blob/master/NMAP_IDS2">Nmap results using the vuln script and IDS</a> <br><br><h3>  findings </h3><br>  To draw conclusions, I applied a quantitative assessment method based on the total number of vulnerabilities found.  As a result, it turned out that Nexpose was carrying out the greatest depth of scanning.  Nessus worked rather poorly, as in the network scanning mode, he produced a lot of service data about systems and services, which only provide information for analytics.  From a very weak side, the OpenVAS 9 scanner showed itself with the latest updates.  Separate words are required by Nmap - a very good tool for analytic testing with the possibility of extension using NSE-scripts. <br><br>  During testing, IDS Suricata found NMap and OpenVAS scanners. <br><br>  This testing is not canonical, such as the Gartner or NSS Labs tests.  But despite this, I think the article will be relevant for specialists in the field of system administration and technical audit. <br><br>  <b>PS And what was all this done for?</b> <br><br>  It was necessary to <s>adopt a</s> scanner for the company Hacken.  In addition, the scanning of the internal network is regulated by the standards of information security management in commercial organizations, banking, energy and other areas of activity.  Network scanning is necessary not only to obtain certification for the organization, but also to manage vulnerabilities in the information and telecommunications system, monitor the update of operating systems and other equally important tasks for managing information security.  [8, 11] <br><br><div class="spoiler">  <b class="spoiler_title">Sources</b> <div class="spoiler_text"><ol><li>  <a href="https://habrahabr.ru/post/203766/">habrahabr.ru/post/203766</a> </li><li>  <a href="https://www.rapid7.com/">www.rapid7.com</a> </li><li>  <a href="https://www.tenable.com/products/nessus/nessus-professional">www.tenable.com/products/nessus/nessus-professional</a> </li><li>  <a href="https://nmap.org/">nmap.org</a> </li><li>  <a href="https://habrahabr.ru/post/131433/">habrahabr.ru/post/131433</a> </li><li>  <a href="http://www.openvas.org/">www.openvas.org</a> </li><li>  <a href="https://metasploit.help.rapid7.com/docs/metasploitable-2-exploitability-guide">metasploit.help.rapid7.com/docs/metasploitable-2-exploitability-guide</a> </li><li>  <a href="http://blog.securitymetrics.com/2016/03/vulnerability-scanners-101-what-why-and-how.html">blog.securitymetrics.com/2016/03/vulnerability-scanners-101-what-why-and-how.html</a> <a href="https://eax.me/iptables/">eax.me/iptables</a> </li><li>  <a href="https://suricata-ids.org/">suricata-ids.org</a> </li><li>  <a href="https://www.resolver.com/trust/policies/threat-vulnerability-management-standard/">www.resolver.com/trust/policies/threat-vulnerability-management-standard</a> </li><li>  <a href="http://osxdaily.com/2014/05/20/port-scanner-mac-network-utility/">osxdaily.com/2014/05/20/port-scanner-mac-network-utility</a> </li></ol></div></div></div><p>Source: <a href="https://habr.com/ru/post/353856/">https://habr.com/ru/post/353856/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353844/index.html">DotNext 2018 Piter Conference Program Overview</a></li>
<li><a href="../353848/index.html">What's New in PostgreSQL 11: Embedded Web Search</a></li>
<li><a href="../353850/index.html">Pwn iNt All! We find vulnerabilities in scripting engines and open usermode-mechanisms for protecting Windows. Part 1</a></li>
<li><a href="../353852/index.html">Guide to background work in Android. Part 4: RxJava</a></li>
<li><a href="../353854/index.html">How we broke Ceph</a></li>
<li><a href="../353858/index.html">Open free webcast of the conference Mobius 2018 Piter</a></li>
<li><a href="../353862/index.html">Conference SMARTRHINO-2018</a></li>
<li><a href="../353864/index.html">Different facets of a digital enterprise</a></li>
<li><a href="../353866/index.html">A little about physics in almost Agar IO on aicups.ru</a></li>
<li><a href="../353868/index.html">Map matching and processing of raw GPS data on an industrial scale</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>