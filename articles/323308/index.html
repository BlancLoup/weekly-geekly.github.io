<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We repeat the design of applications that have received Apple award</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! Designers draw applications with beautiful buttons, shadows, animations, gradients and complex transitions between screens. Unfortunately, s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We repeat the design of applications that have received Apple award</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  Designers draw applications with beautiful buttons, shadows, animations, gradients and complex transitions between screens.  Unfortunately, such designs are not easy to turn into working applications.  Is it possible to facilitate our work?  Let's look at examples of applications that have received Apple awards for design: Auxy, Streaks and Zova. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f0/608/9a8/6f06089a873eb840268f795f0e66b5a7.png" alt="image"><br><a name="habracut"></a><br>  This article is for educational purposes only.  Please do not use the source code for other purposes. <br><br>  To create the interface, I will take the <a href="https://github.com/exyte/macaw">Macaw</a> library, which describes the graphics in the form of high-level <a href="https://en.wikipedia.org/wiki/Scene_graph">scene</a> objects.  I advise you to look at ‚Äú <a href="https://github.com/exyte/Macaw/wiki/Getting-started">Getting Started</a> ‚Äù, if you have not yet seen.  Let's go! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Streaks </h2><br>  <a href="https://itunes.apple.com/us/app/streaks/id963034692%3Fmt%3D8">Streaks</a> - To-Do list that cultivates good habits: read every day and do not forget to brush your teeth.  Let's define graphic components and connections between them. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd7/934/c08/dd7934c083d94cefcf614e656f0718f5.png" alt="image"><br><br>  The first element draws a 2 by 3 grid: the X-coordinate of the first column is zero, the second is half the screen width.  The y-coordinate depends on the row number and is equal to <code>row*screen.width/2</code> (square cells). <br><br>  The element "streak" includes content and title.  On click, the user switches the content between the logo, calendar and statistics.  The switching function will be done later. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e9d/804/fd7/e9d804fd721c0d41f5d24003987fd796.png" alt="image"><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// grid cell (column, row) let streak = Group( contents: [self.streak(text: "MEDIUM", imageName: "medium")], place: Transform.move( dx: Double(screen.width / 2) * column, dy: Double(screen.width / 2) * row ) ) // streak: content + title func streak(text: String, imageName: String) -&gt; Group { let title = Text( text: text, font: Font(name: fontName, size: 14), fill: Color.white, align: .mid, place: Transform.move( dx: Double(screen.width) / 4, dy: 0.7 * Double(screen.width) / 2 ) ) let streakContent = Group() return [streakContent, title].group() }</span></span></code> </pre><br>  Let's take a logo, calendar and statistics.  The logo consists of an arc length of 2 * PI and a picture in the center.  The radius depends on the size of the screen.  Elements are positioned relative to the point (0,0). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5c4/3f5/bdc/5c43f5bdc84a5dc1ce6fbbe9f6f57a6b.png" alt="image"><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> ellipse = Ellipse(cx: radius, <span class="hljs-attr"><span class="hljs-attr">cy</span></span>: radius, <span class="hljs-attr"><span class="hljs-attr">rx</span></span>: radius, <span class="hljs-attr"><span class="hljs-attr">ry</span></span>: radius) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> border = Shape( form: Arc(ellipse: ellipse, <span class="hljs-attr"><span class="hljs-attr">extent</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> * M_PI), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: background, <span class="hljs-attr"><span class="hljs-attr">stroke</span></span>: Stroke(fill: Color(val: <span class="hljs-number"><span class="hljs-number">0x744641</span></span>), <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">8</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> image = UIImage(named: imageName)! <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> logoImage = Image( src: imageName, <span class="hljs-attr"><span class="hljs-attr">place</span></span>: Transform.move( <span class="hljs-comment"><span class="hljs-comment">// move image in the point (radius, radius) dx: radius - Double(image.size.width) / 2, dy: radius - Double(image.size.height) / 2 ) ) let logo = [border, logoImage].group()</span></span></code> </pre><br>  The calendar includes the name of the month, day of the week, and the status of days: ‚Äúdone,‚Äù ‚Äúmissed,‚Äù or ‚Äúto be done.‚Äù  ‚ÄúMade‚Äù and ‚Äúto be‚Äù are displayed in simple circles.  ‚ÄúMissing‚Äù - two intersecting lines of black color. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/604/72d/696/60472d6962092d915d9c44ef2bbeb464.png" alt="image"><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// input parameters let x = width / 6 * Double(column) let y = Double(row) * 15 // skip day let line1 = Line(x1: x - 4, y1: y, x2: x + 4, y2: y + 8) let line2 = Line(x1: x - 4, y1: y + 8, x2: x + 4, y2: y) let stroke = Stroke(fill: Color.black, width: 4) let cross = [ Shape(form: line1, stroke: stroke), Shape(form: line2, stroke: stroke) ].group() // done day let done = Shape( form: Circle(cx: x, cy: y + radius, r: radius), fill: doneColor ) // future day let future = Shape( form: Circle(cx: x, cy: y + radius, r: radius), fill: lightColor )</span></span></code> </pre><br>  Statistics is a group of three bars with different Y-coordinates.  The Y-coordinate depends on the bar number, and the width of the bar depends on the size of the screen: in our case it is 80% of half the width (10% indent on each side). <br><br>  The bar contains four elements: two texts and two rectangles with rounded corners.  One rectangle filled. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7f1/886/b8b/7f1886b8b607dcf0a6523550b8e2c170.png" alt="image"><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bar = Group(contents: [ Text( text: <span class="hljs-string"><span class="hljs-string">"LAST 30 DAYS"</span></span>, <span class="hljs-attr"><span class="hljs-attr">font</span></span>: Font(name: fontName, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.white, <span class="hljs-attr"><span class="hljs-attr">align</span></span>: .min ), Text( text: <span class="hljs-string"><span class="hljs-string">"42%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">font</span></span>: Font(name: fontName, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: lightColor, <span class="hljs-attr"><span class="hljs-attr">align</span></span>: .max, <span class="hljs-attr"><span class="hljs-attr">place</span></span>: Transform.move(dx: width, <span class="hljs-attr"><span class="hljs-attr">dy</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) ), Shape( form: Rect(x: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-attr"><span class="hljs-attr">w</span></span>: width, <span class="hljs-attr"><span class="hljs-attr">h</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>).round(r: <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: lightColor ), Shape( form: Rect(x: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-attr"><span class="hljs-attr">w</span></span>: width * <span class="hljs-number"><span class="hljs-number">0.42</span></span>, <span class="hljs-attr"><span class="hljs-attr">h</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>).round(r: <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.white ) ]</code> </pre><br>  Finished with content, move on to the animation switch.  Tap on streak'u switches and centers the new content (elements differ in width).  The first animation hides the old content, the second shows the new. <br><br><pre> <code class="javascript hljs">func animateStreak(newContent: Group, <span class="hljs-attr"><span class="hljs-attr">margin</span></span>: Int) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> animation = streakContent.opacityVar.animation(to: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-attr"><span class="hljs-attr">during</span></span>: <span class="hljs-number"><span class="hljs-number">0.1</span></span>) animation.onComplete { streakContent.contents = newContent streakContent.place = Transform.move(dx: margin / <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">dy</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) streakContent.opacityVar.animation(to: <span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-attr"><span class="hljs-attr">during</span></span>: <span class="hljs-number"><span class="hljs-number">0.1</span></span>).play() } animation.play() }</code> </pre><br>  Stayed the final touch.  We start arc animation from <code>1.5*PI</code> to <code>3.5*PI</code> when creating a new habit.  <a href="https://github.com/exyte/Macaw/wiki/Content-animation">Here</a> we read more about content-animation.  At the end of the animation, open the ‚ÄúAdd Task‚Äù controller. <br><br><pre> <code class="javascript hljs">streak.onTap { tapEvent <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> animation = group.contentsVar.animation({ t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> animatedShape = Shape( form: Arc(ellipse: ellipse, <span class="hljs-attr"><span class="hljs-attr">shift</span></span>: <span class="hljs-number"><span class="hljs-number">1.5</span></span> * M_PI, <span class="hljs-attr"><span class="hljs-attr">extent</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> * M_PI * t), <span class="hljs-attr"><span class="hljs-attr">stroke</span></span>: Stroke(fill: Color.white, <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">8</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [animatedShape] }, <span class="hljs-attr"><span class="hljs-attr">during</span></span>: <span class="hljs-number"><span class="hljs-number">0.5</span></span>).easing(Easing.easeInOut) animation.onComplete { <span class="hljs-comment"><span class="hljs-comment">// open task controller } animation.play() }</span></span></code> </pre><br><h3>  Result </h3><br>  Do not forget to brush your teeth and look at the <a href="https://github.com/exyte/Macaw-Examples/tree/master/DesignAwardedApps/Streaks">Xcode project</a> on GitHub. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26a/74e/a92/26a74ea922d2b957712fbb0ec1d5064a.gif" alt="image"><br><br><h2>  Auxy studio </h2><br>  <a href="https://itunes.apple.com/us/app/auxy-studio-music-beat-maker/id1034348186%3Fmt%3D8">Auxy</a> is a studio for making music and beats on the phone.  Blue squares are sounds, the user adds and deletes them by tap.  When you click on "Play", the white line moves from top to bottom and reproduces it when crossing with sound. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/434/b9a/e0f/434b9ae0f29af2f83ecb9f06e9c32700.png" alt="image"><br><br>  Auxy screen consists of four main components: the Play button, LineRunner, sounds and a grid in the background. <br><br>  The grid contains horizontal and vertical lines.  Every fourth horizontal line is highlighted.  The grid size is 8x16: the cell width of <code>screen.width / columns</code> and the height of <code>screen.height / rows</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2c8/7a1/5ce/2c87a15cec886830f765b501b204f3bc.png" alt="image"><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> columns = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">0.</span></span>.&lt;dimension<span class="hljs-number"><span class="hljs-number">.0</span></span>).map { column <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> x = cell.w * column <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Shape( form: Line(x1: x, <span class="hljs-attr"><span class="hljs-attr">y1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">x2</span></span>: x, <span class="hljs-attr"><span class="hljs-attr">y2</span></span>: size.h), <span class="hljs-attr"><span class="hljs-attr">stroke</span></span>: stroke, <span class="hljs-attr"><span class="hljs-attr">opacity</span></span>: <span class="hljs-number"><span class="hljs-number">0.2</span></span> ) }.group() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rows = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">0.</span></span>.&lt;dimension<span class="hljs-number"><span class="hljs-number">.1</span></span>).map { row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> y = cell.h * row <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Shape( form: Line(x1: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">y1</span></span>: y, <span class="hljs-attr"><span class="hljs-attr">x2</span></span>: size.w, <span class="hljs-attr"><span class="hljs-attr">y2</span></span>: y), <span class="hljs-attr"><span class="hljs-attr">stroke</span></span>: stroke, <span class="hljs-attr"><span class="hljs-attr">opacity</span></span>: row % <span class="hljs-number"><span class="hljs-number">4</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0.2</span></span> ) }.group()</code> </pre><br>  When tapes on the screen add sound to the grid.  The column and line are calculated from the coordinates of the tapa.  The sound contains two rectangles: the front is white with transparency 0.0 and the back is blue.  The front rectangle lights up when the line crosses the sound. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> column = floor(tapLocation.x / cellSize.w) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> row = floor(tapLocation.y / cellSize.h) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rect = Rect(w: cellSize.w, <span class="hljs-attr"><span class="hljs-attr">h</span></span>: cellSize.h) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> background = Shape(form: rect, <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.rgb(r: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">g</span></span>: <span class="hljs-number"><span class="hljs-number">112</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">215</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> foreground = Shape(form: rect, <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.white, <span class="hljs-attr"><span class="hljs-attr">opacity</span></span>: <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sound = Group( contents: [background, foreground], <span class="hljs-attr"><span class="hljs-attr">place</span></span>: Transform.move( dx: column * cellSize.w, <span class="hljs-attr"><span class="hljs-attr">dy</span></span>: row * cellSize.h ) )</code> </pre><br>  The ‚ÄúPlay‚Äù button is the most difficult element.  Two static elements: a filled circle and an indented arc of <code>0.05</code> near <code>PI/2</code> .  "Play" consists of three points: (-1, 2), (2, 0), (-1, -2), "Stop" of four: (-2, 2), (2, 2), (2 , -2), (-2, -2).  Any element of the scene is easily scaled to the desired size.  Vector graphics - power! <br><br><img src="https://habrastorage.org/files/ea7/df1/2f2/ea7df12f2c1742509e98084f6eaf56dc.png"><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> border = Shape( form: Arc( ellipse: Ellipse(rx: radius, <span class="hljs-attr"><span class="hljs-attr">ry</span></span>: radius), <span class="hljs-attr"><span class="hljs-attr">shift</span></span>: -M_PI / <span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">0.05</span></span>, <span class="hljs-attr"><span class="hljs-attr">extent</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> * M_PI - <span class="hljs-number"><span class="hljs-number">0.1</span></span> ), <span class="hljs-attr"><span class="hljs-attr">stroke</span></span>: Stroke(fill: Color.rgba(r: <span class="hljs-number"><span class="hljs-number">219</span></span>, <span class="hljs-attr"><span class="hljs-attr">g</span></span>: <span class="hljs-number"><span class="hljs-number">222</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">227</span></span>, <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">0.3</span></span>), <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">2.0</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> circle = Shape(form: Circle(r: <span class="hljs-number"><span class="hljs-number">25.0</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: olor) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> playButton = Shape( form: MoveTo(x: <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>).lineTo(x: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>) .lineTo(x: <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">-2</span></span>).close().build(), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.rgb(r: <span class="hljs-number"><span class="hljs-number">46</span></span>, <span class="hljs-attr"><span class="hljs-attr">g</span></span>: <span class="hljs-number"><span class="hljs-number">48</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">58</span></span>), <span class="hljs-attr"><span class="hljs-attr">place</span></span>: Transform.scale(sx: <span class="hljs-number"><span class="hljs-number">5.0</span></span>, <span class="hljs-attr"><span class="hljs-attr">sy</span></span>: <span class="hljs-number"><span class="hljs-number">5.0</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> stopButton = Shape( form: MoveTo(x: <span class="hljs-number"><span class="hljs-number">-2</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>).lineTo(x: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>) .lineTo(x: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">-2</span></span>).lineTo(x: <span class="hljs-number"><span class="hljs-number">-2</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">-2</span></span>).close().build(), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.rgb(r: <span class="hljs-number"><span class="hljs-number">46</span></span>, <span class="hljs-attr"><span class="hljs-attr">g</span></span>: <span class="hljs-number"><span class="hljs-number">48</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">58</span></span>), <span class="hljs-attr"><span class="hljs-attr">place</span></span>: Transform.scale(sx: <span class="hljs-number"><span class="hljs-number">4.0</span></span>, <span class="hljs-attr"><span class="hljs-attr">sy</span></span>: <span class="hljs-number"><span class="hljs-number">4.0</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> buttons = [[playButton], [stopButton]] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> buttonGroup = Group(contents: buttons[<span class="hljs-number"><span class="hljs-number">0</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> button = Group(contents: [border, circle, buttonGroup])</code> </pre><br>  When the user clicks "Play": <br><ul><li>  Replace ‚ÄúPlay‚Äù with ‚ÄúStop‚Äù or back. </li><li>  <code>-PI/2+0.05</code> arc cyclic animation: the length is animated from <code>-PI/2+0.05</code> to <code>3*PI/2‚Äì0.1</code> </li></ul><br><pre> <code class="javascript hljs">button.onTap { tapEvent <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// change button content let index = buttons.index { $0 == buttonGroup.contents }! buttonGroup.contents = buttons[(index + 1) % buttons.count] if index == 0 { play() } else { // if stop pressed contentAnimation.stop() // hide animation group animationGroup.opacityVar.animation(to: 0.0, during: 0.1).play() } } func play() { contentAnimation = animationGroup.contentsVar.animation({ t in let shape = Shape( form: Arc( ellipse: Ellipse(rx: radius, ry: radius), shift: -M_PI / 2 + 0.05, extent: max(2 * M_PI * t - 0.1, 0) ), stroke: Stroke(fill: Color.white, width: 2) ) return [shape] }, during: time).cycle() contentAnimation.play() }</span></span></code> </pre><br>  When you click on the "play" line moves cyclically from top to bottom.  When intersecting with sound, we highlight it.  Knowing the time of the animation, we calculate when the line crosses the sound.  This value is the delay of the highlight animation. <br><br><img src="https://habrastorage.org/files/b77/ed2/824/b77ed28244434d7ca657ac65b0619045.png"><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> line = Shape( form: Line(x1: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">y1</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">x2</span></span>: size.w, <span class="hljs-attr"><span class="hljs-attr">y2</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-attr"><span class="hljs-attr">stroke</span></span>: Stroke(fill: Color.rgba(r: <span class="hljs-number"><span class="hljs-number">219</span></span>, <span class="hljs-attr"><span class="hljs-attr">g</span></span>: <span class="hljs-number"><span class="hljs-number">222</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">227</span></span>, <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">0.5</span></span>), <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">1.0</span></span>) ) func run(time: Double) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> lineAnimation = line.placeVar.animation( to: Transform.move(dx: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">dy</span></span>: screen.height), <span class="hljs-attr"><span class="hljs-attr">during</span></span>: time ).easing(Easing.linear) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> hightlight = sounds.map { sound -&gt; Animation <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sound.hightlight().delay(sound.place.dy / screen.height * time) }.combine() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> runAnimation = [soundsAnimation, lineAnimation].combine().cycle() runAnimation?.play() }</code> </pre><br><h3>  Result </h3><br>  Create music and watch the <a href="https://github.com/exyte/Macaw-Examples/tree/master/DesignAwardedApps/Auxy">Xcode project</a> on GitHub. <br><br><img src="https://habrastorage.org/files/ec2/d84/ff6/ec2d84ff67304ac8a6569fd979e4f185.gif"><br><br><h2>  Zova </h2><br>  <a href="https://itunes.apple.com/us/app/zova-fitness-trainer-activity/id919000809%3Fmt%3D8">Zova</a> is a personal fitness trainer.  It has two components: a pie chart in the center and a bar at the bottom of the screen. <br><br><img src="https://habrastorage.org/files/3fb/7f8/ec0/3fb7f8ec037f4b108dcf3aa5215e7e0e.png"><br><br>  The pie chart includes eight circles in the background, one filled circle in the center, live score and an emoji icon. <br><br><img src="https://habrastorage.org/files/0c5/841/3cd/0c58413cdb0e4244a80aad3f24de67fb.png"><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> mainCircle = Shape( form: Circle(r: <span class="hljs-number"><span class="hljs-number">60</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: mainColor, <span class="hljs-attr"><span class="hljs-attr">stroke</span></span>: Stroke(fill: Color.white, <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">1.0</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> score = Text( text: <span class="hljs-string"><span class="hljs-string">"3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">font</span></span>: Font(name: lightFont, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-number"><span class="hljs-number">40</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.white, <span class="hljs-attr"><span class="hljs-attr">align</span></span>: .mid, <span class="hljs-attr"><span class="hljs-attr">baseline</span></span>: .mid ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> icon = Text( text: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">font</span></span>: Font(name: regularFont, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-number"><span class="hljs-number">24</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.white, <span class="hljs-attr"><span class="hljs-attr">align</span></span>: .mid, <span class="hljs-attr"><span class="hljs-attr">place</span></span>: Transform.move(dx: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-attr"><span class="hljs-attr">dy</span></span>: <span class="hljs-number"><span class="hljs-number">30.0</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> shadows = [ Point(x: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">35</span></span>), Point(x: <span class="hljs-number"><span class="hljs-number">-25</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>), Point(x: <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>), Point(x: <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">-25</span></span>), Point(x: <span class="hljs-number"><span class="hljs-number">-25</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">-25</span></span>), Point(x: <span class="hljs-number"><span class="hljs-number">-40</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>), Point(x: <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>), Point(x: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">-35</span></span>) ].map { place <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Shape( form: Circle(r: <span class="hljs-number"><span class="hljs-number">40</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.white.with(a: <span class="hljs-number"><span class="hljs-number">0.8</span></span>), <span class="hljs-attr"><span class="hljs-attr">place</span></span>: Transform.move(dx: place.x, <span class="hljs-attr"><span class="hljs-attr">dy</span></span>: place.y) ) }.group() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> acivityCircle = Group(contents: [shadows, mainCircle, score, icon])</code> </pre><br>  Tap in a pie chart displays available emoji icons in a circle.  If the distance from the center to the icon d, then the coordinates of the icon <code>(cos(alpha) * d, sin(alpha) * d)</code> .  By default, the icon selection menu is hidden (transparency 0.0). <br><br><img src="https://habrastorage.org/files/93b/83f/115/93b83f115e3d43bcab7ed2d86d40d892.png"><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data = [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>] <span class="hljs-comment"><span class="hljs-comment">//      emoji let emojis = data.enumerated().map { (index, item) -&gt; Group in let shape = Shape(form: Circle(r: 20), fill: Color.white) let icon = Text( text: item, font: Font(name: regularFont, size: 14), fill: Color.white, align: .mid, baseline: .mid ) return Group( contents: [shape, icon], place: emojiPlace(index: index, d: 20.0), opacity: 0.0 ) }.group() func emojiPlace(index: Int, d: Double) -&gt; Transform { let alpha = 2 * M_PI / 10.0 * Double(index) return Transform.move( dx: cos(alpha) * d, dy: sin(alpha) * d ) }</span></span></code> </pre><br>  Bar - a group consisting of legends and segments.  The legend consists of a rounded rectangle, a ‚Äúlow‚Äù text, and another rectangle with a gradient color. <br><br><img src="https://habrastorage.org/files/e18/e27/dee/e18e27deea6b4ee49f4f9ff3e4673654.png"><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> border = Shape( form: Rect(w: <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-attr"><span class="hljs-attr">h</span></span>: <span class="hljs-number"><span class="hljs-number">30</span></span>).round(r: <span class="hljs-number"><span class="hljs-number">16.0</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.white ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> text = Text( text: <span class="hljs-string"><span class="hljs-string">"Low"</span></span>, <span class="hljs-attr"><span class="hljs-attr">font</span></span>: Font(name: regularFont, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: mainColor, <span class="hljs-attr"><span class="hljs-attr">align</span></span>: .mid, <span class="hljs-attr"><span class="hljs-attr">baseline</span></span>: .mid, <span class="hljs-attr"><span class="hljs-attr">place</span></span>: Transform.move(dx: <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-attr"><span class="hljs-attr">dy</span></span>: <span class="hljs-number"><span class="hljs-number">15</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> line = Shape( form: Rect(x: <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-attr"><span class="hljs-attr">w</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">h</span></span>: <span class="hljs-number"><span class="hljs-number">40</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: LinearGradient( degree: <span class="hljs-number"><span class="hljs-number">90</span></span>, <span class="hljs-attr"><span class="hljs-attr">from</span></span>: Color.white.with(a: <span class="hljs-number"><span class="hljs-number">0.8</span></span>), <span class="hljs-attr"><span class="hljs-attr">to</span></span>: mainColor ) ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> legend = [border, text, line].group()</code> </pre><br>  A segment consists of a rectangle and a text for us.  The x-coordinate of the elements is zero.  The x-coordinate of a segment depends on its number.  The last segment has a gradient color. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> text = Text( text: text, <span class="hljs-attr"><span class="hljs-attr">font</span></span>: Font(name: regularFont, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: Color.white, <span class="hljs-attr"><span class="hljs-attr">align</span></span>: .min, <span class="hljs-attr"><span class="hljs-attr">baseline</span></span>: .alphabetic, <span class="hljs-attr"><span class="hljs-attr">place</span></span>: Transform.move(dx: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">dy</span></span>: <span class="hljs-number"><span class="hljs-number">-5</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rect = Shape( form: Rect(w: width, <span class="hljs-attr"><span class="hljs-attr">h</span></span>: <span class="hljs-number"><span class="hljs-number">8</span></span>), <span class="hljs-attr"><span class="hljs-attr">fill</span></span>: !last ? color : gradient ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bar = [text, rect].group()</code> </pre><br>  The legend has a ‚Äújumping‚Äù effect: it slowly moves up and down along the vertical axis. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> jumpAnimation = legend.placeVar.animation( to: Transform.move(dx: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-attr"><span class="hljs-attr">dy</span></span>: <span class="hljs-number"><span class="hljs-number">-8.0</span></span>), <span class="hljs-attr"><span class="hljs-attr">during</span></span>: <span class="hljs-number"><span class="hljs-number">2.0</span></span> ).autoreversed().cycle()</code> </pre><br>  Let's go back to the animation.  When tapping a pie chart, we run several animations at the same time: <br><br><ul><li>  Hide the bar and top labels </li><li>  Reduce background circles </li><li>  Raise and hide text with current result. </li><li>  Raise and increase emoji icon </li><li>  Showing and moving from the center of the available emoji icons </li></ul><br>  Good news!  We do not need to worry about reverse animation, it is available automatically: any animation has a <code>reverse()</code> method. <br><br><img src="https://habrastorage.org/files/387/040/f29/387040f2941d4a7b8598151ad6b421a3.png"><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> during = <span class="hljs-number"><span class="hljs-number">0.5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> hideAnimation = [ bar.opacityVar.animation(to: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-attr"><span class="hljs-attr">during</span></span>: during), texts.opacityVar.animation(to: <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-attr"><span class="hljs-attr">during</span></span>: during) ].combine() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> emojisAnimation = emojis.contents.enumerated().map { (index, node) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ node.opacityVar.animation(to: <span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-attr"><span class="hljs-attr">during</span></span>: during), node.placeVar.animation( <span class="hljs-comment"><span class="hljs-comment">// new emoji position to: emojiPlace(index: index, d: 120.0), during: during ) ].combine() }.combine() let circleAnimation = [ shadows.placeVar.animation(to: Transform.scale(sx: 0.5, sy: 0.5), during: during), score.placeVar.animation(to: Transform.move(dx: 0, dy: -20), during: during), score.opacityVar.animation(to: 0.0, during: during), icon.placeVar.animation(to: Transform.move(dx: 0, dy: -30).scale(sx: 2.0, sy: 2.0), during: during), ].combine() let animation = [hideAnimation, emojisAnimation, circleAnimation].combine() let reverseAnimation = animation.reverse()</span></span></code> </pre><br><h3>  Result </h3><br>  Doing sports and watching the <a href="https://github.com/exyte/Macaw-Examples/tree/master/DesignAwardedApps/Zova">Xcode project</a> on GitHub. <br><br><img src="https://habrastorage.org/files/d86/fd6/bda/d86fd6bdafd14814a06462e9f151e210.gif"><br><br><h2>  Summary </h2><br>  Reviving the design, and even more so the design that won the Apple award, is not an easy job.  Developers spend a lot of time making their own graphic elements and animations that work on devices of various sizes.  This work can be simplified using tools that provide the right abstractions and a convenient API.  <a href="https://github.com/exyte/macaw">Macaw</a> is one such library that allows you to focus on the main <a href="https://github.com/exyte/macaw">thing</a> . </div><p>Source: <a href="https://habr.com/ru/post/323308/">https://habr.com/ru/post/323308/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323298/index.html">Windows Server 2016 and Hyper-V Integration Services</a></li>
<li><a href="../323300/index.html">The Turing Competition for Student Theory. computer science and discrete mathematics</a></li>
<li><a href="../323302/index.html">Encryption algorithm based on elementary cellular automata</a></li>
<li><a href="../323304/index.html">We are looking for and analyzing errors in the code Media Portal 2</a></li>
<li><a href="../323306/index.html">How IT professionals work. Leonid Vyhovsky, systems architect, LiveTex</a></li>
<li><a href="../323310/index.html">The book ‚ÄúGrokayem algorithms. Illustrated manual for programmers and curious</a></li>
<li><a href="../323312/index.html">Authentication and voice identification using Microsoft cognitive services</a></li>
<li><a href="../323314/index.html">Proper communication on the example of volleyball</a></li>
<li><a href="../323316/index.html">Gatling load testing</a></li>
<li><a href="../323318/index.html">LocoLaser: translate apps in Google Sheets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>