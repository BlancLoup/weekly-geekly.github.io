<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Own traffic exchange point in the data center. Part 1. How it works</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the 90s, when the Russian Internet was only emerging, providers from one city had to exchange traffic through Europe and pay for it to transit and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Own traffic exchange point in the data center. Part 1. How it works</h1><div class="post__text post__text-html js-mediator-article">  In the 90s, when the Russian Internet was only emerging, providers from one city had to exchange traffic through Europe and pay for it to transit and higher operators (uplinks).  The end user in the end received high prices for Internet access, restrictions on the amount of available traffic, a great response time of web resources.  In order not to drive national traffic to foreign cities and villages, local providers began to unite and create traffic exchange points in major cities. <br><br>  Today we will talk about them: let's tell you why we needed our own <a href="http://www.dtln.ru/uslugi/telecom/dataline-ix">DataLine-IX</a> traffic exchange point, how it is arranged, and share the first results. <br><br><img src="https://habrastorage.org/files/af4/1ea/f40/af41eaf40de646d78c7f7fe47a2385ad.jpg"><br>  <i>ISP-A and ISP-B providers exchange their network traffic through a traffic exchange point.</i>  <i>Without it, the exchange would occur through the ‚Äúbig‚Äù Internet.</i> <br><a name="habracut"></a><br>  The Internet Exchange Point (Internet Exchange Point, IX) is an infrastructure that allows autonomous systems to exchange traffic (peering) directly, bypassing higher-level telecom operators (uplinks).  Peering helps IX participants reduce packet transfer routes between networks and reduce traffic costs.  If you need to connect with several participants at once, then through a traffic exchange point it is easier to do: instead of a separate connection to each participant, one to IX, where these participants are present.  This is the organizational side.  Financially, participant IX also benefits from savings on channels and the purchase of traffic from uplinks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For the end user, there are also pluses: network delays are reduced, the response time of resources on the Internet is reduced. <br><br>  Traffic exchange points are a positive thing.  The more of them, the better the connectivity of the Internet and the more accessible it is for the end user. <br><br>  The first traffic exchange points began to appear in 1994 in major European cities: London (LINX), Frankfurt (DE-CIX), Amsterdam (AMS-IX), Moscow (MSK-IX).  Now around the world there are about 580 IX. <br><br><img src="https://habrastorage.org/files/fa3/edf/96d/fa3edf96d432449ab02371e7ed6140dc.PNG"><br>  <i>The largest traffic exchange points in Russia.</i>  <i>Source: <a href="http://internetexchangemap.com/">internetexchangemap.com</a></i> <br><br>  When in 2015 we thought about our own traffic exchange point, more than 40 operators were present in our data centers (there are 53 of them now).  Worked Meet-Me-Room, which simplifies connection to any operator on our sites.  Its own traffic exchange point would give even more opportunities for our customers, especially for Internet providers and content generators (gaming services, CDN, video hosting, media, social networks): <br><br><ul><li>  Improved connectivity of the DataLine network infrastructure: when connected to our network, client traffic goes through shorter routes with a minimum number of transit sections; </li><li>  reduction of participant IX's expenses for the purchase of IP transit from uplinks: part of the traffic will pass through DataLine-IX; </li><li>  building a more reliable network infrastructure: using DataLine-IX, the participant will be able to organize backup routes and unload channels to other traffic exchange points; </li><li>  access to the traffic of participants who are not present at other traffic exchange points; </li><li>  fast connection to several service providers via a dedicated VLAN. </li></ul><br><h2>  <b>How it works</b> </h2><br>  The infrastructure of the DataLine-IX traffic exchange point is distributed over two sites - OST and NORD. <br><br>  There are 6 Extreme BlackDiamond X8 switches at two sites.  Two of them connect data centers into a single network and form the core of the DataLine-IX network infrastructure (Core).  Two access points (Access) from each site are connected to the core.  New members join the traffic exchange point through these access points. <br><br>  8 links of 10G are organized between the nodes of the core, which are combined into a logical channel with a total bandwidth of 80 Gbps.  The capacity of the channels connecting the core and access nodes is 40 G. <br><br><img src="https://habrastorage.org/files/4ed/14a/cf6/4ed14acf67c44688a76da0307f31d455.png"><br>  <i>Topology of the traffic exchange point DataLine-IX.</i> <br><br><img src="https://habrastorage.org/files/9cd/c07/83b/9cdc0783b9214b70b2ba06ca0f2ff8e3.jpg"><br>  <i>One of the Extreme BlackDiamond X8 at the OST site.</i> <br><br>  On one BlackDiamond X8 switch chassis, 768 ports of 10 GbE (7.68 Tbps) or 192 ports of 40 GbE (7.68 Tbps) can work.  By default, we use 10 GbE ports to connect new members, but we can provide 40 and 100 GbE ports on request.  Here are all available connection standards: <br><br><ul><li>  1 / 10GbE SFP / SFP + (SR / LR / ER / ZR); </li><li>  100/1000/10000 MbE (10GBaseT) RJ45; </li><li>  40GbE QSFP + with SR4 / LR4; </li><li>  100GbE CFP2 with SR10 / LR4. </li></ul><br>  DataLine-IX participants exchange routes with each other through a routing server (Route Server, RS) using the BGPv4 protocol.  RSs also provide member filtering for routes according to Internet Routing Registry (IRR) policies and other attributes of the BGPv4 protocol (AS_PATH, Next-hop, etc.). <br><br>  Routing servers are deployed on two Huawei RH1288 V2-8S servers with a UNIX-based environment. <br><br><img src="https://habrastorage.org/files/dc5/a07/009/dc5a07009c804452bd3a25fabd5860ee.JPG"><br>  <i>Server routing</i> <br><br>  The infrastructure of the traffic exchange point unites the participants into a single broadcast domain (L2-domain), so there is a high risk of <a href="https://habrahabr.ru/company/dataline/blog/253609/">broadcasting storms</a> due to garbage BUM traffic (broadcast, unknown destination address, multicast).  At a minimum, a storm can lead to a decrease in the bandwidth of the participants' channels.  In the worst-case scenario, communication with the routing server will be lost, BGP sessions will break and all infrastructure IX will be closed.  To prevent DataLine-IX from shutting down, we use multi-level protection against BUM traffic, limiting traffic as follows: <br><br><ol><li>  The ban on the reception on the ports of participants of all multicast frames, except for protocols and specific types of messages that ensure the correct operation of network services (LACP, ICMPv6 NS, ICMPv6 NA). </li><li>  Restriction on broadcasting frames (broadcast storm-control / broadcast rate-limit).  In DataLine-IX, they are used by the ARP protocol to determine the MAC address by a known IP address. </li><li>  Filtering the ether-type field.  Transmission of IPv4, IPv6 and ARP frames is usually allowed. </li><li>  Ensuring the reliability of information in ARP messages (ARP inspection).  The participant responds only to ARP requests related to its IP address on a specific interface.  For ARP packets, the rate-limit tool is also used to limit the number of ARP packets per second. </li></ol><br>  On the <b>third and fourth levels of</b> OSI, dynamic routing protocols, other than BGP, and other protocols that threaten the participants and the infrastructure itself IX are filtered.  When sending routing information via BGP, both the prefixes themselves and the set of attributes for this prefix are analyzed (elements AS_PATH, Next-hop, etc.). <br><br>  For new IX participants, the standard setting rules apply: <br><br><ol><li>  On the participant's port in the direction of DataLine-IX, STP, IP redirects, LLDP, CDP, ARP proxy and other link-local protocols should be disabled, except for ARP and IPv6 ND. </li><li>  Ethernet frame announcement allowed: 0x0800 - IPv4, 0x0806 - ARP, 0x86dd - IPv6. </li><li>  One port - one member MAC address. </li><li>  Forbidden announcement network IX to other AS, not members of IX. </li><li>  It is forbidden to announce the default routes and full view. </li></ol><br>  The connection procedure itself is built so that we have the opportunity to double-check the correctness of these settings.  First, the new member connects to the port in the quarantine VLAN.  We analyze its traffic, and if everything is configured correctly, the port is translated into a productive VLAN.  There, the new participant is still isolated from the rest: its prefixes are not announced to the other participants of IX, and the participant himself does not receive anything either.  If everything is OK, then the sessions are transferred to a productive mode of operation. <br><br><h2>  <b>Ways to connect to DataLine-IX</b> <br></h2><br>  New members can choose the following options for connecting to DataLine-IX: <br><br><ul><li>  <b>Shared Peering</b> - traffic exchange with all IX participants via routing servers. <br><br><img src="https://habrastorage.org/files/87c/176/437/87c176437cf84e73bf50f9e89e813297.png"><br>  <i>General peering scheme.</i> <br><br></li><li>  <b>Private Peering</b> - traffic exchange with individual participants IX.  In this case, traffic exchange is organized not through a routing server (RS), but through the establishment of direct BGP sessions between participants.  This method of connecting to a traffic exchange point is useful when you need to improve connectivity with one or more specific participants IX. <br><br><img src="https://habrastorage.org/files/e17/c7e/d07/e17c7ed0704e4a6e9c01b4db977b68cf.png"><br>  <i>Direct peering scheme.</i> <br><br></li><li>  <b>Access to a dedicated VLAN (Private VLAN)</b> - organization of communication channels through a dedicated VLAN with one or several participants.  This method may be needed to combine several ports of one participant in one broadcast domain (VLAN) or to combine several participants in one VLAN. <br><br><img src="https://habrastorage.org/files/e14/767/7f3/e147677f3cad4027bc99b1ae42f0f058.png"><br>  <i>Connection diagram through a dedicated VLAN</i> . <br><br></li><li>  <b>A point-to-point channel (p2p) is</b> organized through a switching fabric IX using the EoMPLS technology.  Thanks to connectivity through a dedicated VLAN, you do not need to lay additional crossings for organizing a p2p channel; you just need to have a connection to DataLine-IX. <br><br><img src="https://habrastorage.org/files/28e/a65/3ab/28ea653ab1d0455299369f4b709baa02.PNG"><br>  <i>P2p wiring diagram</i> </li></ul><br><h2>  <b>What's next?</b> </h2><br>  DataLine-IX is still at a very early stage of development.  At the moment we have 38 participants, the total number of routes is 6889. In addition to increasing the number of participants, the nearest plans include the organization of access nodes in external sites. <br><br><img src="https://habrastorage.org/files/fed/129/a44/fed129a441f746d2af6cb142c042c4f5.png"><br>  <i>DataLine-IX statistics at <a href="http://ru.map-ix.net/">ru.map-ix.net</a></i> <br><br><img src="https://habrastorage.org/files/72d/a1b/a82/72da1ba82b0743dfa24e136d5012fa73.png"><br>  <i>Statistics participants DataLine-IX by occupation.</i> <br><br>  Ask questions in the comments if something interesting is left behind the scenes.  In the second part, we‚Äôll tell you about useful DataLine-IX tools for managing outgoing and incoming announcements, protection against DDoS attacks. </div><p>Source: <a href="https://habr.com/ru/post/317122/">https://habr.com/ru/post/317122/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317112/index.html">Translated documentation Vue.JS 2.x</a></li>
<li><a href="../317114/index.html">Is it possible to do without jsx and why?</a></li>
<li><a href="../317116/index.html">Reporting system: how to get 50 million reports and save Zen</a></li>
<li><a href="../317118/index.html">Mass "alternative" energy in Russia - is it real?</a></li>
<li><a href="../317120/index.html">NFC - let's go ...</a></li>
<li><a href="../317124/index.html">CRM for small business: how to implement one, two, three</a></li>
<li><a href="../317126/index.html">How IT professionals work. Alexey Akulovich, senior developer of the VKontakte project</a></li>
<li><a href="../317128/index.html">Why hold a hackathon in a strip club?</a></li>
<li><a href="../317130/index.html">‚ÄúWhat has the progRess come to?‚Äù Replacing "mental" labor by a mechanical process based on R</a></li>
<li><a href="../317132/index.html">Failover Evolution in PostgreSQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>