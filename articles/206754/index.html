<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Delphi XE5 + Android: First Impressions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Back to the roots 
 I picked up Delphi XE5 on the occasion of the Autumn Mobilization contest. The idea (and the opportunity) to write for Android not...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Delphi XE5 + Android: First Impressions</h1><div class="post__text post__text-html js-mediator-article"><h4>  Back to the roots </h4><br>  I picked up Delphi XE5 on the occasion of the Autumn Mobilization contest.  The idea (and the opportunity) to write for Android not on C-Sharpe or Java, but on a familiar length and width across pascal I definitely liked.  I'll tell you here about my impressions, the problems that have met, and also I will debunk some of the ‚Äúurban legends‚Äù. <br><a name="habracut"></a><br>  Used trial version of Update-1.  Now, like the second update came out and, perhaps, something has changed.  Immediately, I note that it‚Äôs better not to change the default settings.  The previously installed Android-SDK could not be attached to Delphi, so I re-installed it with the one attached to it.  After the first launch, it turned out that Help was not working.  Found a solution <br>  <a href="http://support.embarcadero.com/article/43035">support.embarcadero.com/article/43035</a> <br><br>  Help turned out to be sensible and quite detailed.  Contains not only properties and methods, but also examples and even the description of development methods.  In general, a return to basics, as it was still at Borland. <br><br>  I like the environment very much.  In Visual Studio, everything is somehow amorphous and unintelligible.  Unity is visually not bad, but there is a completely different specificity.  In short, the programmer‚Äôs language still does not describe what the esthete‚Äôs eye sees, even if they belong to one person ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  User interface </h5><br>  FireMonkey pleased with its flexibility.  On any control, you can hang another, on that one more, and so on, achieving very interesting results.  Compared with VCL, property naming is standardized.  No more Captions and other things, if there is text somewhere - it is always Text.  Position - always Position.  Lots of alignment methods.  In addition, there is a TLayout - something ‚Äúimmaterial‚Äù (about this will be below), invisible, on which you can put controls and align them ‚Äúin the void‚Äù, and not necessarily on any panel. <br><br>  When there is a lot of things on the form, the DesignVisible property becomes very useful - hide in design time.  The set of styles for Android was attached only one, but very elegant - white on black, as I like. <br>  There are rumors in the internet that references to the style for controls (StyleLookup) are sometimes ‚Äúnot preserved‚Äù.  For many types of controls (and maybe for all), there is for each its own link ‚Äúby default‚Äù, which will be assigned, even if not specified, and which is not saved, as I understand it, to save space in the form resource. <br><br>  It is possible to add animation to the control, and even several, and even at the same time.  And this is not only moving around the screen, but also changing any material-numerical properties (size, color, scale, etc.).  For each animation, you can specify the time delay of its beginning, which is very convenient in difficult cases, because  You can do without additional timers by simply running all the necessary animations simultaneously from one block of code. <br><br>  Now about gestures.  In principle, everything is simple - we assign the Touch.GestureManager control, tick the gestures of interest, assign an artificial extension of the gesture catching (if the control is small) in the TouchTargetExpantion, create the OnGesture event for it and catch the desired gesture using the EventInfo.GestureID.  But there are subtleties. <br><br>  For example, on a large TLayout, we placed some small (relative to it) controls and no matter how ‚Äúhit‚Äù the user is with a finger on these controls, we need to do something there.  I note that if everything described in the paragraph above is done for this TLayout, then we will catch only those gestures that start with ‚Äúvisible‚Äù objects ‚Äî that is,  on one of those very small controls.  This I determined experimentally.  In principle, there is nothing surprising - as if there is no Layout, it is invisible and virtual, and all the ‚Äúscreen messages‚Äù that he can receive are from the ‚Äúvisible‚Äù objects put on him.  You can do it differently - do not be lazy, assign a manager and create an event for the form (as is done in the demos) and always receive it guaranteed - but then you have to manually deal with the coordinates to determine which control relates to which gesture. <br><br>  Also, under Android, I would strongly recommend explicitly checking the GestureID of each captured gesture and respond only to those that are of interest (no matter which gestures are marked with a check mark). <br><br>  And an example.  Long could not figure out how to show the banner in TWebBrowser.  I found the solution on one forum and creatively reworked it.  But, to be perfectly accurate, not to the end.  Practitioners perfectionists can have fun and look for this shortcoming.  However, the code is absolutely working and it is I who use it: <br><br><pre><code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShowHtml</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WebBrowser: TWebBrowser; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Html: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-meta"><span class="hljs-meta">{$IF DEFINED(ANDROID)}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tempFile: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> = <span class="hljs-string"><span class="hljs-string">'/sdcard/Download/temp.htm'</span></span>; filePrefix: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> = <span class="hljs-string"><span class="hljs-string">'file:/'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> StrList: TStringList; MemStrem: TMemoryStream; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> WebBrowser <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> StrList := TStringList.Create; StrList.Text := Html; StrList.SaveToFile(tempFile); URL := <span class="hljs-string"><span class="hljs-string">''</span></span>; Navigate(filePrefix + tempFile); <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> DeleteFile(filePrefix + tempFile); StrList.Free; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-meta"><span class="hljs-meta">{$ELSE}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-meta"><span class="hljs-meta">{$ENDIF}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br>  HTML is the code for this banner itself. <br><br><h4>  Database </h4><br>  XE5 includes a set of components for universal database access - FireDAC.  In principle, all the names of properties and methods are similar to other similar sets, so everything is clear.  I used it to communicate with SQLite.  Everything is so simple and usual that I do not even know what to tell.  Besides, I don‚Äôt remember anything - at that time I was watching something on the media player, my hands did everything themselves. <br><br>  To feel the difference, those who wish can compare something after the FireDAC with the database from the program on the same Unity.  Come on, Unity, she's a game, out of the same Visual Studio.  After that, you begin to understand where the bullets whistle, and where the natives spread the cocktails ... <br><br>  Well, for those who like to do everything with their own hands, I‚Äôll give a small example of how to fill ListBox without Bindings: <br><br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TSomeForm</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FillList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(aList: TListBox; BegDate, EndDate: TDateTime)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> aItem: TListBoxItem; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> aList.Items.Clear; <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> SomeQuery <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> ParamByName(<span class="hljs-string"><span class="hljs-string">'beg_date'</span></span>).AsDateTime := BegDate; ParamByName(<span class="hljs-string"><span class="hljs-string">'end_date'</span></span>).AsDateTime := EndDate; Open; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> EOF <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> aItem := TListBoxItem.Create(aList); aItem.StyleLookup := <span class="hljs-string"><span class="hljs-string">'listboxitemrightdetail'</span></span>; aItem.Tag := FieldByName(<span class="hljs-string"><span class="hljs-string">'id'</span></span>).AsInteger; aItem.Text := Format(<span class="hljs-string"><span class="hljs-string">'%s (%s) "%s"'</span></span>, [FieldByName(<span class="hljs-string"><span class="hljs-string">'theme'</span></span>).AsString, FieldByName(<span class="hljs-string"><span class="hljs-string">'name'</span></span>).AsString, FieldByName(<span class="hljs-string"><span class="hljs-string">'question'</span></span>).AsString]); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> FieldByName(<span class="hljs-string"><span class="hljs-string">'d_result'</span></span>).AsInteger <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> -<span class="hljs-number"><span class="hljs-number">1</span></span>: aItem.ItemData.Bitmap.Assign(NoImage.Bitmap); <span class="hljs-number"><span class="hljs-number">0</span></span>: aItem.ItemData.Bitmap.Assign(WaitImage.Bitmap); <span class="hljs-number"><span class="hljs-number">1</span></span>: aItem.ItemData.Bitmap.Assign(YesImage.Bitmap); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; aItem.ItemData.Detail := FormatDateTime(<span class="hljs-string"><span class="hljs-string">'dd-mmm-yy'</span></span>, FieldByName(<span class="hljs-string"><span class="hljs-string">'d_date'</span></span>).AsDateTime); aItem.ItemData.Accessory := TListBoxItemData.TAccessory.aMore; aList.AddObject(aItem); Next; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> Close; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br><br>  Among other things, depending on the code in the d_result column, one or another picture is placed in the box-box line: <br><br>  aItem.ItemData.Bitmap.Assign <br><br>  The most important thing to remember here is aList.AddObject (aItem); <br><br>  Well, Next, of course, so as not to hang. <br><br><h4>  Form manipulation </h4><br>  What Delfi teaches is to take action in every form.  Under Android, you can create, show and close forms in the same way as under Windows.  Each new one created or shown in one way or another will be as if ‚Äúmodal‚Äù, i.e.  closing the entire application space.  However, Form.ShowModal should not be done (Android doesn‚Äôt understand this), but in the old way you should simply call Form.Show.  Using the system button Back, the Form.Close is automatically called and the highest form at the moment is closed.  You can then use it again.  When closing the main (first) form of the application, as expected, closes.  I note that you should not close the form with the caFree parameter or explicitly destroy it (Free, Release) - it does not like Android! <br><br>  Reference counting <br><br>  I read in the internet about the problems of people with ARC.  I am sure this is not the case.  If everything is properly designed, then it makes no difference whether the links are considered or not; a garbage collector with a scythe goes on schedule as in .Net or is destroyed immediately as in Delphi.  I wrote everything in the old manner: <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> Create; <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> Free; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br><br>  And it worked like a clock and under Android, and under Windows. <br><br>  If there are any problems with the understanding of this process, without any banishment I recommend a little pee on C-Sharpe.  There, it is generally not customary to explicitly call destructors, either simply exit the procedure where this object was a local variable, or assign a (global) variable to null.  After a while, the spinal cord begins to feel the moment when the rooks with the objects are sent to Valallla, and without any push from your side. <br><br><h4>  Arrays </h4><br>  When developing for a mobile compiler, the code adaptation guide says ‚Äúdo not use static arrays‚Äù.  One exception is also indicated - when a static array is a member of a structure.  And that's all.  It is not entirely clear whether this applies to constant arrays.  For example, such as <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> SomeNames: <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> [<span class="hljs-number"><span class="hljs-number">0</span></span>..<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> = (<span class="hljs-string"><span class="hljs-string">'First'</span></span>, <span class="hljs-string"><span class="hljs-string">'Last'</span></span>);</code> </pre><br><br>  It is possible that this can be done, although I tried to avoid this and formed arrays of strings in initialization dynamically.  In the B-Sharpe there even though it can be done in the description ... In short, the question requires further research and clarification. <br>  It should also be remembered that the elements of a string (string) in the mobile compiler are numbered from zero. <br><br><h4>  Operators </h4><br>  A new operator appeared (I don‚Äôt know in which version) <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> container <span class="hljs-keyword"><span class="hljs-keyword">do</span></span></code> </pre><br>  It seems that all languages ‚Äã‚Äãtend to a common denominator.  By the way, it is possible to sort through them in Pascal not only arrays, but also sets. <br><br>  Questions and valuable comments are welcome. </div><p>Source: <a href="https://habr.com/ru/post/206754/">https://habr.com/ru/post/206754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../206742/index.html">A gift from Skype for the new year</a></li>
<li><a href="../206744/index.html">Working with Group Policy Preferences: How to Stop Using Specific Devices</a></li>
<li><a href="../206746/index.html">Is there life without marketing or PR of a social project?</a></li>
<li><a href="../206748/index.html">Android widget development</a></li>
<li><a href="../206752/index.html">Backing up web projects on Yandex.Disk</a></li>
<li><a href="../206758/index.html">What to write in the subject of the letter: choose words wisely</a></li>
<li><a href="../206762/index.html">A beta version of the product for the visual creation of Windows 8.1 applications Microsoft Project Siena</a></li>
<li><a href="../206768/index.html">About Vagrant, its plugins, and other life stories of vagrants</a></li>
<li><a href="../206770/index.html">Technical Details on BitTorrent Secure P2P Chat</a></li>
<li><a href="../206778/index.html">Interception of Linux kernel functions using exceptions (do-it-yourself kprobes)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>