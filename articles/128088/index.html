<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Refactoring a simple PHP application for MODx</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Posted on Sep 02, 2011 by James Rotering 
 PHP Skill Level: medium 
 MODx Skill Level: Beginner 
 Description: This tutorial shows how to remake a fil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Refactoring a simple PHP application for MODx</h1><div class="post__text post__text-html js-mediator-article"><h6>  <a href="http://www.cmslesstraveled.com/index/tutorials/refactoring-a-simple-php-application-for-modx.html">Posted on Sep 02, 2011 by James Rotering</a> <br>  PHP Skill Level: medium <br>  MODx Skill Level: Beginner </h6><br><blockquote>  <b>Description:</b> This tutorial shows how to remake a file with mixed PHP / HTML code for the MODx Revolution.  It is for people who are comfortable working with PHP, but they still learn the basics of MODx. </blockquote><br>  If you fit most of the following descriptions, this guide should be helpful to you: <br>  - You wrote scripts that combine PHP code and HTML <br>  - you understand PHP loops and arrays <br>  - You wrote a PHP code that connects to the database and retrieves records <br>  - Do you have a general idea of ‚Äã‚Äãhow MODx snippets and other elements work? <br><a name="habracut"></a><br>  For example, I will consider a simplified version of a real project that I recently completed. <br>  The application was developed in PHP / HTML and does the following: <br>  - get list of records from database table <br>  - displays entries in an HTML table <br>  - Displays two drop-down selection fields to filter results by specific column values. <br><br>  If you are interested, you can see the work of the application <a href="http://web.uwsa.edu/fadmin/sfs/acctcodes/%3FfiscalYear%3D2012">here</a> . <br><br><h3>  Starting with a mixed PHP / HTML file </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The source code for this application looked like this (simplified for clarity): <br><br>  <b>File: acctCodes.php (original version)</b> <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>    SFS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>    SFS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  SELECT box --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byCategory"</span></span></span><span class="hljs-tag">&gt;</span></span>  :<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byCategory"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byCategory"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <pre> <code class="php hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//   -     $values = //   -         foreach ($values as $value) { echo '&lt;option value="' . $value . '"&gt;' . $value . '&lt;/option&gt;'; } </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  SELECT box --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byType"</span></span></span><span class="hljs-tag">&gt;</span></span>  :<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byType"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byType"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <pre> <code class="php hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $values = <span class="hljs-comment"><span class="hljs-comment">//   -         foreach ($values as $value) { echo '&lt;option value="' . $value . '"&gt;' . $value . '&lt;/option&gt;'; } </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"acctCodes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,    &lt;th&gt;.    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <pre> <code class="php hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $records = <span class="hljs-comment"><span class="hljs-comment">//   -        foreach ($records as $record) { </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $record[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'category'</span></span></span><span class="php">]; </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $record[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'status'</span></span></span><span class="php">]; </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $record[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'account'</span></span></span><span class="php">]; </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $record[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'acctType'</span></span></span><span class="php">]; </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $record[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'title'</span></span></span><span class="php">]; </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $record[</span><span class="hljs-string"><span class="php"><span class="hljs-string">'definition'</span></span></span><span class="php">]; </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <pre> <code class="php hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  PHP is pretty simple here.  There are three separate blocks of code where the query is executed, then the results are framed into suitable HTML tags and displayed on the page.  The third block is somewhat bizarre - the PHP code is interrupted in order to use normal HTML code inside the loop, and not bulky, unpleasant ‚Äúecho‚Äù statements. <br>  But nothing terribly difficult here happens. <br><br>  However, we will need to do some cleaning in order to prepare for the transition to MODx. <br><br><h3>  Part One: Cleaning (First we get the values ‚Äã‚Äãand then the output) </h3><br><br>  The first step to cleaning this PHP code for MODx (and indeed in general) is to avoid mixing the application logic with the page markup.  Instead of executing each query before using it, we will run all the queries, and then, if necessary, simply display the results using echo. <br><br>  The result is something like this (again, very simplified for clarity): <br><br>  <b>File: acctCodes.php (cleared version)</b> <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//   -     $values = //   -         $options1 = ''; foreach ($values as $value) { $options1 .= '&lt;option value="' . $value . '"&gt;' . $value . '&lt;/option&gt;'; } $values = //   -         $options2 = ''; foreach ($values as $value) { $options2 .= '&lt;option value="' . $value . '"&gt;' . $value . '&lt;/option&gt;'; } $records = //   -        $trrows = ''; foreach ($records as $record) { $trrows .= '&lt;tr&gt;&lt;td&gt;' . $record['category'] . '&lt;/td&gt;&lt;td&gt;' . $record['status'] . '&lt;/td&gt;&lt;td&gt;' . $record['account'] . '&lt;/td&gt;&lt;td&gt;' . $record['acctType'] . '&lt;/td&gt;&lt;td&gt;' . $record['title'] . '&lt;/td&gt;&lt;td&gt;' . $record['definition'] . '&lt;/td&gt;&lt;/tr&gt;'; } </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>    SFS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>    SFS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  SELECT box --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byCategory"</span></span></span><span class="hljs-tag">&gt;</span></span>  :<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byCategory"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byCategory"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $options1; </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  SELECT box --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byType"</span></span></span><span class="hljs-tag">&gt;</span></span>  :<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;&lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">font</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#006699"</span></span></span><span class="hljs-tag">&gt;</span></span>select name="byType" id="byType"&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $options2; </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"acctCodes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,    &lt;th&gt;.    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> </span><span class="hljs-keyword"><span class="php"><span class="hljs-keyword">echo</span></span></span><span class="php"> $trrows; </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  This makes markup much easier to view and edit.  All PHP code is contained in four blocks: the first query sets the values, and the next three simple echo commands display these values ‚Äã‚Äãon the screen. <br>  This is more acceptable for transferring this small web application to MODx. <br><br><h3>  Part Two: Snippets and Placeholders </h3><br><br>  To transfer our cleaned code to MODx, we need to make a few additional changes. <br>  Our HTML code can be immediately copied to the MODx resource.  <font color="#968e5b">(The resource will no longer change! - approx. Lane.)</font> <br>  But we need to replace the PHP code with snippets and some placeholders. <br><br>  The content of our MODx resource will look like this: <br>  <b>Resource MODx: 'acctCodes'</b> <br><pre> <code class="html hljs xml">[[accountCodes]] <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>    SFS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>    SFS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  SELECT box --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byCategory"</span></span></span><span class="hljs-tag">&gt;</span></span>  :<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byCategory"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byCategory"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> [[+options1]] <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  SELECT box --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byType"</span></span></span><span class="hljs-tag">&gt;</span></span>  :<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byType"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"byType"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> [[+options2]] <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"acctCodes"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,    &lt;th&gt;.    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> [[+trrows]] <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  In our resource, four blocks of PHP code have been replaced by MODx tags.  The first, <b>[[accountCodes]]</b> , will call the <b>accountCodes</b> snippet (which we haven't written yet).  The next three tags are placeholders, which will be replaced by the values ‚Äã‚Äãgiven by our snippet. <br>  Now we need to write this snippet. <br><br><h3>  Part Three: Snippet </h3><br><br>  Our <b>‚ÄúaccountCodes‚Äù</b> snippet will contain the code from this first PHP block ‚Äî all requests and loops.  The only thing we are going to add is a few lines of MODx API code for creating placeholders. <br><br>  <b>Snippet: "accountCodes"</b> <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//   -     $values = //   -         $options1 = ''; foreach ($values as $value) { $options1 .='&lt;option value="' . $value . '"&gt;' . $value . '&lt;/option&gt;'; } $values = //   -         $options2 = ''; foreach ($values as $value) { $options2 .= '&lt;option value="' . $value . '"&gt;' . $value . '&lt;/option&gt;'; } $records = //   -        $trrows = ''; foreach ($records as $record) { $trrows .= '&lt;tr&gt;&lt;td&gt;' . $record['category'] . &amp;nbsp; '&lt;/td&gt;&lt;td&gt;' . $record['status'] . '&lt;/td&gt;&lt;td&gt;' . $record['account'] . '&lt;/td&gt;&lt;td&gt;' . $record['acctType'] . '&lt;/td&gt;&lt;td&gt;' . $record['title'] . '&lt;/td&gt;&lt;td&gt;' . $record['definition'] . '&lt;/td&gt;&lt;/tr&gt;'; } $modx-&gt;setPlaceholder('options1', $options1); $modx-&gt;setPlaceholder('options2', $options2); $modx-&gt;setPlaceholder('trrows', $trrows);</span></span></code> </pre> <br><br>  This is our snippet.  Compared to our original PHP code, it is supplemented with three lines of ‚ÄúsetPlaceholder‚Äù at the bottom.  They simply say MODx that if and when he meets the placeholder <b>[[options + options1]]</b> on the page below, he should replace it with the value <b>$ options1</b> .  Placeholders are a simple and elegant way to process output values ‚Äã‚Äãfrom snippets. <br><br>  Now we have done everything we need for the web application to work inside the MODx.  However, we can take a few additional steps that will make our application much sexier using more API functions in MODx.  I would rate our current implementation as ‚Äúsatisfactory‚Äù <font color="#968e5b">(in the original, ‚ÄúC.‚Äù</font> ) Let's continue the work. <br><br><h3>  Part Four: Using Chunks as Output Templates </h3><br><br>  One of the criticisms that can be made to our current PHP code is that it still mixes markup with logic.  Our foreach loop still contains chunks of HTML markup: <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($values <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $value) { $options1 .= <span class="hljs-string"><span class="hljs-string">'&lt;option value="'</span></span> . $value . <span class="hljs-string"><span class="hljs-string">'"&gt;'</span></span> . $value . <span class="hljs-string"><span class="hljs-string">'/option&gt;'</span></span>; }</code> </pre> <br>  This strategy is far from ideal: suppose the boss asks for the HTML encoder Skippy <font color="#968e5b">(in the original ‚ÄúSkippy the HTML code monkey‚Äù)</font> , change the HTML code of this application, adding a few additional attributes for each &lt;option&gt; tag.  But we do not want Skippy <font color="#968e5b">("Skippy the HTML code monkey") to</font> be somewhere near our PHP script, is it? <br><br>  There are several ways to remedy this situation in PHP - pulling HTML code from external files and replacing strings comes to mind.  However, we do not need to worry and figure out a suitable solution.  For this task, MODx offers another simple and elegant solution: <b>chunks with placeholders</b> . <br><br>  The ‚Äúoption‚Äù code from the snippet above can be rewritten as a chunk called ‚Äúoption‚Äù: <br><br>  <b>Chunk: "option"</b> <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"[[+value]]"</span></span></span><span class="hljs-tag">&gt;</span></span>[[+value]]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  This chunk is nothing special - some HTML with a couple of placeholders.  ‚ÄúOption‚Äù is a simple, useful chunk that can be used anywhere - in several snippets in different resources. <br><br>  Now we can change our snippet by adding a bit more MODx API code to use the value of this chunk in our loop: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//   -     $values = //   -         $options1 = ''; foreach ($values as $value) { $modx-&gt;setPlaceholder('value', $value); $options1 .= $modx-&gt;getChunk('option'); }</span></span></code> </pre> <br>  Now our loop creates a placeholder for $ value and adds the value of the 'option' chunk to the output string. <br>  This allows you to completely separate all HTML code from PHP.  If Skippy <font color="#968e5b">(‚ÄúSkippy the HTML code monkey‚Äù)</font> needs to add an attribute to the &lt;option&gt; elements, he can do this by editing the ‚Äúoption‚Äù chunk.  (Just tell him not to touch these placeholders!) <br><br>  Table rows can be made in the same way: <br>  <b>Chunk: "trrows"</b> <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>[[+category]]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>[[+status]]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>[[+account]]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>[[+acctType]]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>[[+title]]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span>[[+definition]]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  and php code to call it <br><pre> <code class="php hljs">each ($records <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $record) { $trrows .= $modx-&gt;getChunk(<span class="hljs-string"><span class="hljs-string">'trrows'</span></span>, $record); }</code> </pre> <br>  Note that in this example we don‚Äôt even have to install any placeholders! <br>  We can pass the associative <b>$ record</b> array into GetChunk () as an argument, and placeholders will automatically ** be set for each key / value pair in the array! <br>  (** MODX Awesomeness! You're soaking in it! **) <font color="#968e5b">(Analogy with the slogan of some laundry detergent? - Lane comment.)</font> <br><br>  So now we can save all our pieces of HTML in chunks and rewrite our snippet like this: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//   -     $values = //   -         $options1 = ''; foreach ($values as $value) { $modx-&gt;setPlaceholder('value', $value); $options1 .= $modx-&gt;getChunk('option'); } $values = //   -         $options2 = ''; foreach ($values as $value) { $modx-&gt;setPlaceholder('value', $value); $options2 .= $modx-&gt;getChunk('option'); } $records = //   -        $trrows = ''; foreach ($records as $record) { $trrows .= $modx-&gt;getChunk('trrows', $record); } $modx-&gt;setPlaceholder('options1', $options1); $modx-&gt;setPlaceholder('options2', $options2); $modx-&gt;setPlaceholder('trrows', $trrows);</span></span></code> </pre> <br>  It is already starting to look very good.  We used the MODx API for the output template and our snippet looks really clean.  Nevertheless, there is one thing that bothers me, and can be potentially problematic - now we have MODx API calls attached to the logic of our application.  If we are 100% sure that we will only ever need the data printed on this web page and in this format, then this is really not a problem.  But if there is a possibility that this data may need to be used differently - somewhere outside the MODx - it would be better to keep the main application logic separate from the MODx entities. <br><br>  Currently, the application receives a rating of "good" <font color="#968e5b">(in the original - "B")</font> .  Let's take the last step and increase our rating to ‚ÄúExcellent‚Äù <font color="#968e5b">(in the original - ‚ÄúA‚Äù)</font> . <br><br><h3>  Part Five: Separate Your Application Logic </h3><br><br>  All we need to do for the last step is to divide our snippet into two parts.  The first part will contain our application logic and return all arrays as members of one large array. <br>  This will be done in pure PHP and ideally should be saved as a file on our server. <br><br>  The second part is the snippet itself.  He will first get the array returned by the logic file, then use chunks to standardize the result lines, and finally set up placeholders to display the results in resources. <br><br>  This is how it all ends: <br><br>  <b>File: acctCodes.php</b> <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//   -     $values = //   -         $values2 = //   -         $records = //   -        return array('values'=&gt;$values, 'values2'=&gt;$values2, 'records'=&gt;$records); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br><br>  <b>Snippet: 'acctCodes'</b> <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $data = <span class="hljs-keyword"><span class="hljs-keyword">include_once</span></span>(MY_INCLUDE_PATH . <span class="hljs-string"><span class="hljs-string">'acctCodes.php'</span></span>); $options1 = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($data[<span class="hljs-string"><span class="hljs-string">'values'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $value) { $modx-&gt;setPlaceholder(<span class="hljs-string"><span class="hljs-string">'value'</span></span>, $value); $options1 .= $modx-&gt;getChunk(<span class="hljs-string"><span class="hljs-string">'option'</span></span>); } $options2 = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($data[<span class="hljs-string"><span class="hljs-string">'values2'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $value) { $modx-&gt;setPlaceholder(<span class="hljs-string"><span class="hljs-string">'value'</span></span>, $value); $options2 .= $modx-&gt;getChunk(<span class="hljs-string"><span class="hljs-string">'option'</span></span>); } $trrows = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($data[<span class="hljs-string"><span class="hljs-string">'records'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $record) { $trrows .= $modx-&gt;getChunk(<span class="hljs-string"><span class="hljs-string">'trrows'</span></span>, $record); } $modx-&gt;setPlaceholder(<span class="hljs-string"><span class="hljs-string">'options1'</span></span>, $options1); $modx-&gt;setPlaceholder(<span class="hljs-string"><span class="hljs-string">'options2'</span></span>, $options2); $modx-&gt;setPlaceholder(<span class="hljs-string"><span class="hljs-string">'trrows'</span></span>, $trrows);</code> </pre> <br>  Now our ducks are abreast <font color="#968e5b">(now we have our ducks in a row)</font> .  Let's take a look at what we did: <br>  - We have the application logic in the file on the server (completely outside of MODx). <br>  - We transfer data directly (without any HTML markup) to our MODx snippet. <br>  - We allow MODx to manage the templating of our output records. <br>  - We set all the placeholder values ‚Äã‚Äãin one snippet at the top of the resource. <br>  - Where it is necessary, we display our data on the page using placeholders. <br><br>  We have come a long way from our original mixed PHP / HTML file, right?  I would rate this final implementation as ‚Äúexcellent‚Äù <font color="#968e5b">(in the original - ‚ÄúA‚Äù)</font> .  However, someone probably has better ideas on how to separate the various problem areas.  But for PHP connoisseurs, like me, this is a good place to start. <br><br>  I hope you learned some of the key problems when writing simple PHP applications for use in MODx.  Feel free to leave any thoughts, questions or suggestions about this guide in the comments <a href="http://www.cmslesstraveled.com/index/archive/2011/php-for-modx.html">here</a> . <br><br>  <font color="#968e5b">Note</font>  <font color="#968e5b">per.</font>  <font color="#968e5b">- as a result were created:</font> <font color="#968e5b"><br></font>  <font color="#968e5b">- resource <b>acctCodes</b> (part 2)</font> <font color="#968e5b"><br></font>  <font color="#968e5b">- <b>accountCodes</b> snippet (p.5)</font> <font color="#968e5b"><br></font>  <font color="#968e5b">- <b>acctCodes.php</b> file ( <b>p.5</b> )</font> <font color="#968e5b"><br></font>  <font color="#968e5b">- chunk <b>option</b> (part 4)</font> <font color="#968e5b"><br></font>  <font color="#968e5b">- chunk <b>trrows</b> (part 4)</font> </div><p>Source: <a href="https://habr.com/ru/post/128088/">https://habr.com/ru/post/128088/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128082/index.html">SharePoint team manager Richard Riley will visit Moscow and speak at Tech ‚àô Ed Russia 2011</a></li>
<li><a href="../128083/index.html">Smarty vs. Twig: performance</a></li>
<li><a href="../128085/index.html">Launch of RadStudio XE2, Delphi XE2 and other Embarcadero products.</a></li>
<li><a href="../128086/index.html">Conference Symfony Camp UA 2011</a></li>
<li><a href="../128087/index.html">C professional holiday!</a></li>
<li><a href="../128090/index.html">Canobuvosti, 108th edition</a></li>
<li><a href="../128091/index.html">Network layer physics engine</a></li>
<li><a href="../128092/index.html">The European Union extends the protection of related rights to music to 70 years</a></li>
<li><a href="../128093/index.html">Guitar, computer, live (part 3: Cantabile Performer, an overview of the main functions: rack and sub-session)</a></li>
<li><a href="../128094/index.html">Features 3D graphics Windows Phone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>