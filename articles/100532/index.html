<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Validation of data in the DataGrid by "columns"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 

 In my WPF projects, I mainly use a DataGrid to display data. This control is very convenient, easy to use and also with the release of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Validation of data in the DataGrid by "columns"</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br><br>  In my WPF projects, I mainly use a DataGrid to display data.  This control is very convenient, easy to use and also with the release of Visual Studio 2010 is part of the 4th framework. <br><br>  So, if it is necessary to change the data in the table (DataGrid), I offered the user a modal window in which the data of the object marked in the table was displayed.  And the user changed this very object depending on the need.  Data validation occurred before the user closes the window.  Everything worked smoothly. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But once it became necessary to provide the ability for the user to change data directly in the table (as in Excel), without calling the modal window.  We must do it. <br><br>  But when implementing this very action, I ran into one problem: data validation.  And if you specifically need to avoid entering the same data into the table.  It must be said that the DataGrid contains support for data validation implemented by the ValidationRule object.  But the fact is that data validation took place within the limits of the actual object.  That is, validation was performed on the ‚Äústring‚Äù DataGrid and not on the ‚Äúcolumn‚Äù.  Google could not help.  So I had to think a little. <br><a name="habracut"></a><br><br><h4>  Implementation </h4><br><br>  So, let's try to validate in the DataGrid by ‚Äúcolumns‚Äù. <br><br>  To begin with we will be defined with object which we will be changes.  This will be a Person object.  But before proceeding with the implementation of this object, create a helper class <a href="http://www.d-projex.net/post/2010/07/16/INotifyPropertyChanged-WPFBase.aspx">WPFBase</a> that implements <a href="http://www.d-projex.net/post/2010/07/16/INotifyPropertyChanged.aspx">INotifyPropertyChanged</a> to report data changes in the Person object: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#000000"><font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br></font> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li></li><li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#000000"><font color="#0000ff">public</font> <font color="#0000ff">class</font> WPFBase : INotifyPropertyChanged { <font color="#0000ff">public</font> <font color="#0000ff">event</font> PropertyChangedEventHandler PropertyChanged; <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged( <font color="#0000ff">string</font> PropertyName) { <font color="#0000ff">if</font> (PropertyChanged != <font color="#0000ff">null</font> ) { <font color="#0000ff">this</font> .PropertyChanged( <font color="#0000ff">this</font> , <font color="#0000ff">new</font> PropertyChangedEventArgs(PropertyName)); } } <font color="#0000ff">public</font> <font color="#0000ff">void</font> OnPropertyChanged(MethodBase MethodeBase) { <font color="#0000ff">this</font> .OnPropertyChanged(MethodeBase.Name.Substring(4)); } } <br></font> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now create a Person class that contains two properties: Name and Vorname.  And we inherit it from WPFBase: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> Person: WPFBase </li><li>  { </li><li>  <font color="#0000ff">private</font> <font color="#0000ff">string</font> _Name; </li><li>  <font color="#0000ff">private</font> <font color="#0000ff">string</font> _Vorname; </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> Vorname </li><li>  { </li><li>  <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _Vorname;  } </li><li>  <font color="#0000ff">set</font> {_Vorname = <font color="#0000ff">value</font> ;  OnPropertyChanged (MethodInfo.GetCurrentMethod ());  } </li><li>  } </li><li></li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name </li><li>  { </li><li>  <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _Name;  } </li><li>  <font color="#0000ff">set</font> {_Name = <font color="#0000ff">value</font> ;  OnPropertyChanged (MethodInfo.GetCurrentMethod ());  } </li><li>  } </li><li></li><li></li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br><br>  You probably noticed that the Person class is designated as <strong>partial.</strong>  This is done for convenience, since we are implementing a couple more interfaces and for readability we divide the class into three parts. <br><br>  So, we implement the IDataErrorInfo interface.  In object-oriented programming, each object is responsible for itself and for the data it contains.  Therefore, let the Person object itself worry about how it is ‚Äústuffed‚Äù.  Let's start: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> Person: IDataErrorInfo </li><li>  { </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> Error </li><li>  { </li><li>  <font color="#0000ff">get</font> </li><li>  { </li><li>  <font color="#0000ff">string</font> error; </li><li>  <font color="#2b91af">StringBuilder</font> sb = <font color="#0000ff">new</font> <font color="#2b91af">StringBuilder</font> (); </li><li></li><li>  error = <font color="#0000ff">this</font> [ <font color="#a31515">"Name"</font> ]; </li><li>  <font color="#0000ff">if</font> (error! = <font color="#0000ff">string</font> .Empty) </li><li>  sb.AppendLine (error); </li><li></li><li>  error = <font color="#0000ff">this</font> [ <font color="#a31515">"Vorname"</font> ]; </li><li>  <font color="#0000ff">if</font> (error! = <font color="#0000ff">string</font> .Empty) </li><li>  sb.AppendLine (error); </li><li></li><li>  <font color="#0000ff">if</font> (! <font color="#0000ff">string</font> .IsNullOrEmpty (sb.ToString ())) </li><li>  <font color="#0000ff">return</font> sb.ToString (); </li><li></li><li>  <font color="#0000ff">return</font> <font color="#a31515">""</font> ; </li><li>  } </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> <font color="#0000ff">this</font> [ <font color="#0000ff">string</font> columnName] </li><li>  { </li><li>  <font color="#0000ff">get</font> </li><li>  { </li><li>  <font color="#0000ff">switch</font> (columnName) </li><li>  { </li><li>  <font color="#0000ff">case</font> <font color="#a31515">"Name"</font> : </li><li>  <font color="#0000ff">if</font> ( <font color="#0000ff">string</font> .IsNullOrEmpty ( <font color="#0000ff">this</font> .Name)) </li><li>  <font color="#0000ff">Return</font> <font color="#a31515">"Enter the name !!!"</font>  ; </li><li>  <font color="#0000ff">break</font> ; </li><li>  <font color="#0000ff">case</font> <font color="#a31515">"Vorname"</font> : </li><li>  <font color="#0000ff">if</font> ( <font color="#0000ff">string</font> .IsNullOrEmpty ( <font color="#0000ff">this</font> .Vorname)) </li><li>  <font color="#0000ff">Return</font> <font color="#a31515">"Enter the surname !!!"</font>  ; </li><li>  <font color="#0000ff">break</font> ; </li><li>  <font color="#0000ff">default</font> : </li><li>  <font color="#0000ff">break</font> ; </li><li>  } </li><li>  <font color="#0000ff">return</font> <font color="#a31515">""</font> ; </li><li>  } </li><li>  } </li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br>  Well, we have ensured that if there is no data in the Name and Vorname properties of the Person object, a message is returned indicating that it is necessary to enter a first or last name. <br><br>  Well, the final touch: let's implement the IDataEditObject interface.  It is necessary so that in case of input of invalid data into the Person object, when the input operation is canceled, the data will return to its original position: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> Person: IEditableObject </li><li>  { </li><li>  <font color="#0000ff">bool</font> inEdit = <font color="#0000ff">false</font> ; </li><li>  Person tempPerson; </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> BeginEdit () </li><li>  { </li><li>  <font color="#0000ff">if</font> (inEdit) </li><li>  <font color="#0000ff">return</font> ; </li><li></li><li>  inEdit = <font color="#0000ff">true</font> ; </li><li>  tempPerson = <font color="#0000ff">new</font> Person (); </li><li>  tempPerson.Name = <font color="#0000ff">this</font> .Name; </li><li>  tempPerson.Vorname = <font color="#0000ff">this</font> .Vorname; </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> CancelEdit () </li><li>  { </li><li>  <font color="#0000ff">if</font> (! inEdit) </li><li>  <font color="#0000ff">return</font> ; </li><li></li><li>  inEdit = <font color="#0000ff">false</font> ; </li><li>  <font color="#0000ff">this</font> .Name = tempPerson.Name; </li><li>  <font color="#0000ff">this</font> .Vorname = tempPerson.Vorname; </li><li>  tempPerson = <font color="#0000ff">null</font> ; </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> EndEdit () </li><li>  { </li><li></li><li>  <font color="#0000ff">if</font> (! inEdit) </li><li>  <font color="#0000ff">return</font> ; </li><li></li><li>  inEdit = <font color="#0000ff">false</font> ; </li><li>  tempPerson = <font color="#0000ff">null</font> ; </li><li>  } </li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br>  Create another class ListPerson inheriting from ObservableCollection &lt;Person&gt;.  The Personen object will be used as a container for Person objects.  Well, for ease of testing, we immediately add to the ListPerson collection several objects: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> ListPerson: ObservableCollection &lt;Person&gt; </li><li>  { </li><li>  <font color="#0000ff">public</font> ListPerson () </li><li>  { </li><li>  <font color="#0000ff">this</font> .Add ( <font color="#0000ff">new</font> Person () </li><li>  { </li><li>  Name = <font color="#a31515">"Ivanov"</font> , </li><li>  Vorname = <font color="#a31515">"Sergey"</font> </li><li>  }); </li><li>  <font color="#0000ff">this</font> .Add ( <font color="#0000ff">new</font> Person () </li><li>  { </li><li>  Name = <font color="#a31515">"Petrov"</font> , </li><li>  Vorname = <font color="#a31515">"Andrew"</font> </li><li>  }); </li><li>  } </li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br>  We add the ListPerson collection to the window resources: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">dt: ListPerson</font> <font color="#ff0000">x: Key</font> <font color="#0000ff">= "ListPerson"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Windows.Resources</font> <font color="#0000ff">&gt;</font> </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br>  And we inform our table where the data is located: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataGrid</font> <font color="#ff0000">ItemsSource</font> <font color="#0000ff">= "{Binding Source = {StaticResource ListPerson}}"</font> <font color="#0000ff">/&gt;</font> </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br>  Now add the following code to the DataGrid: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataGrid.RowValidationRules</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataErrorValidationRule</font> <font color="#ff0000">ValidationStep</font> <font color="#0000ff">= "UpdatedValue"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">DataGrid.RowValidationRules</font> <font color="#0000ff">&gt;</font> </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br>  What does this mean: we added a new rule to the DataGrid rules collection, which reports that after changing the data in the Person object, it is necessary to check whether the object itself does not indicate that the data does not comply with the rules we specified when implementing the IDataErrorInfo interface .  If so, the DataGrid will respond to the error. <br><br>  What we lack is that for which we actually started all this: to prevent the entry of the same data in the table. <br><br>  To do this, create a new class ValidationRule but with our own criteria for checking the validity of the data.  In addition, we will need to create an additional property that refers to the same object container as the DataGrid itself.  In order for XAML to bind data to this property, it is necessary to declare it as a DependencyProperty.  The problem is that for this the object must be inherited from the DependencyObject class.  Our new rule inherits from ValidationRule.  Therefore, we simply simply create an additional class ListPersonHelper and inherit it from DependencyObject.  Okay, stop talking.  Let's look at the code better: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">class</font> ColumnValidation: ValidationRule </li><li>  { </li><li>  <font color="#0000ff">private</font> ListPersonHelper _ListPerson; </li><li></li><li>  <font color="#008000">// This property is auxiliary; it is used to implement DependencyProperty</font> </li><li>  <font color="#0000ff">public</font> ListPersonHelper ListPerson </li><li>  { </li><li>  <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _ListPerson;  } </li><li>  <font color="#0000ff">set</font> {_ListPerson = <font color="#0000ff">value</font> ;  } </li><li>  } </li><li></li><li></li><li>  <font color="#008000">// Check for valid data</font> </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">override</font> ValidationResult Validate </li><li>  ( <font color="#0000ff">object</font> <font color="#0000ff">value</font> , System.Globalization.CultureInfo cultureInfo) </li><li>  { </li><li>  BindingGroup bg = <font color="#0000ff">value</font> <font color="#0000ff">as</font> BindingGroup; </li><li>  Person person = bg.Items [0] <font color="#0000ff">as</font> Person; </li><li></li><li>  <font color="#008000">// If there is an object with the same name or surname in the collection, we report an error!</font> </li><li>  <font color="#0000ff">var</font> result = <font color="#0000ff">from</font> p <font color="#0000ff">in</font> ListPerson.Items </li><li>  <font color="#0000ff">where</font> p! = person &amp;&amp; </li><li>  (p.Name == person.Name </li><li>  ||  p.Vorname == person.Vorname) </li><li>  <font color="#0000ff">select</font> p; </li><li>  <font color="#0000ff">if</font> (result.Any ()) </li><li>  { </li><li>  <font color="#0000ff">return</font> <font color="#0000ff">new</font> ValidationResult ( <font color="#0000ff">false</font> , <font color="#a31515">"First Name or Last Name already in the database"</font> ); </li><li>  } </li><li></li><li>  <font color="#0000ff">return</font> ValidationResult.ValidResult; </li><li>  } </li><li>  } </li><li></li><li>  <font color="#008000">// Helper class for implementing DependencyProperty</font> </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> ListPersonHelper: DependencyObject </li><li>  { </li><li>  <font color="#008000">// You can privatize the data in the XAML property to the Items property, since it is declared as a DependencyProperty</font> </li><li>  <font color="#0000ff">public</font> ListPerson Items </li><li>  { </li><li>  <font color="#0000ff">get</font> { <font color="#0000ff">return</font> (ListPerson) GetValue (ItemsProperty);  } </li><li>  <font color="#0000ff">set</font> {SetValue (ItemsProperty, <font color="#0000ff">value</font> );  } </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> DependencyProperty ItemsProperty = </li><li>  DependencyProperty.Register </li><li>  ( <font color="#a31515">"Items"</font> , </li><li>  <font color="#0000ff">typeof</font> (ListPerson), </li><li>  <font color="#0000ff">typeof</font> (ListPersonHelper), </li><li>  <font color="#0000ff">new</font> UIPropertyMetadata ( <font color="#0000ff">null</font> )); </li><li></li><li></li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br>  We add ListPersonHelper to window resources.  The Items property is set to the same data source as the DataGrid.  In the table's ValidationRules, add our new ColumnValidation rule.  The ListPerson property is pointed to the ListPerson resource.  That's all: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Window</font> <font color="#ff0000">x: Class</font> <font color="#0000ff">= "DPTest.MainWindow"</font> </li><li>  <font color="#ff0000">xmlns</font> <font color="#0000ff">= "http://schemas.microsoft.com/winfx/2006/xaml/presentation"</font> </li><li>  <font color="#ff0000">xmlns: x</font> <font color="#0000ff">= "http://schemas.microsoft.com/winfx/2006/xaml"</font> </li><li>  <font color="#ff0000">xmlns: dt</font> <font color="#0000ff">= "clr-namespace: DPTest"</font> </li><li>  <font color="#ff0000">Title</font> <font color="#0000ff">= "MainWindow"</font> <font color="#ff0000">Height</font> <font color="#0000ff">= "437"</font> <font color="#ff0000">Width</font> <font color="#0000ff">= "684"</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">dt: ListPerson</font> <font color="#ff0000">x: Key</font> <font color="#0000ff">= "ListPerson"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">dt: ListPersonHelper</font> <font color="#ff0000">x: Key</font> <font color="#0000ff">= "ListPersonHelper"</font> </li><li>  <font color="#ff0000">Items</font> <font color="#0000ff">= "{Binding Source = {StaticResource ListPerson}}"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">ControlTemplate</font> <font color="#ff0000">x: Key</font> <font color="#0000ff">= "GridError"</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Grid</font> <font color="#ff0000">Margin</font> <font color="#0000ff">= "0, -2.0, -2"</font> </li><li>  <font color="#ff0000">ToolTip</font> <font color="#0000ff">= "{Binding RelativeSource = {RelativeSource</font> <br><br>  FindAncestor, AncestorType = {x: Type DataGridRow}}, <br><br>  Path = (Validation.Errors) [0] .ErrorContent} " <br>  <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Ellipse</font> <font color="#ff0000">StrokeThickness</font> <font color="#0000ff">= "0"</font> <font color="#ff0000">Fill</font> <font color="#0000ff">= "Red"</font> </li><li>  <font color="#ff0000">Width</font> <font color="#0000ff">= "{TemplateBinding FontSize}"</font> </li><li>  <font color="#ff0000">Height</font> <font color="#0000ff">= "{TemplateBinding FontSize}"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">TextBlock</font> <font color="#ff0000">Text</font> <font color="#0000ff">= "!"</font>  <font color="#ff0000">FontSize</font> <font color="#0000ff">= "{TemplateBinding FontSize}"</font> </li><li>  <font color="#ff0000">FontWeight</font> <font color="#0000ff">= "Bold"</font> <font color="#ff0000">Foreground</font> <font color="#0000ff">= "White"</font> </li><li>  <font color="#ff0000">HorizontalAlignment</font> <font color="#0000ff">= "Center"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">ControlTemplate</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataGrid</font> <font color="#ff0000">ItemsSource</font> <font color="#0000ff">= "{Binding Source = {StaticResource ListPerson}}"</font> </li><li>  <font color="#ff0000">AutoGenerateColumns</font> <font color="#0000ff">= "False"</font> </li><li>  <font color="#ff0000">RowValidationErrorTemplate</font> <font color="#0000ff">= "{StaticResource GridError}"</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataGrid.Columns</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataGridTextColumn</font> </li><li>  <font color="#ff0000">Binding</font> <font color="#0000ff">= "{Binding Path = Vorname}"</font> </li><li>  <font color="#ff0000">Header</font> <font color="#0000ff">= "Vorname"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataGridTextColumn</font> </li><li>  <font color="#ff0000">Binding</font> <font color="#0000ff">= "{Binding Path = Name}"</font> </li><li>  <font color="#ff0000">Header</font> <font color="#0000ff">= "Name"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">DataGrid.Columns</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataGrid.RowValidationRules</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">DataErrorValidationRule</font> </li><li>  <font color="#ff0000">ValidationStep</font> <font color="#0000ff">= "UpdatedValue"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">dt: ColumnValidation</font> </li><li>  <font color="#ff0000">ValidationStep</font> <font color="#0000ff">= "UpdatedValue"</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">dt: ColumnValidation.ListPerson</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">dt: ListPersonHelper</font> </li><li>  <font color="#ff0000">Items</font> <font color="#0000ff">= "{Binding Source = {StaticResource ListPerson}}"</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">dt: ColumnValidation.ListPerson</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">dt: ColumnValidation</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">DataGrid.RowValidationRules</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Datagrid</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Window</font> <font color="#0000ff">&gt;</font> </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br><br>  An example can be downloaded here: <a href="">DataGridColumnValidation.zip (71,37 kb)</a> </div><p>Source: <a href="https://habr.com/ru/post/100532/">https://habr.com/ru/post/100532/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../100518/index.html">Habrayuser Virtual Office</a></li>
<li><a href="../100519/index.html">Friday Puzzle</a></li>
<li><a href="../100520/index.html">Bill Gates presents the Russian version of MS-DOS 4.1</a></li>
<li><a href="../100525/index.html">EROEI</a></li>
<li><a href="../100531/index.html">Funny feature "in contact"</a></li>
<li><a href="../100533/index.html">Youtube increased possible duration for custom videos.</a></li>
<li><a href="../100534/index.html">Medvedev admits that private helicopters will be allowed over Moscow</a></li>
<li><a href="../100535/index.html">Problems in Masterhost</a></li>
<li><a href="../100537/index.html">Happy System Administrator!</a></li>
<li><a href="../100540/index.html">The second wave of iPhone 4 sales begins in Australia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>