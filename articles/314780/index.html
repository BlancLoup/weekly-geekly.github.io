<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We use generics in RAD Studio Delphi. Create a library of sorting lists of similar objects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will create in RAD Studio Delphi a library of classes that implement sorting lists of similar objects. 

 Purpose of the task 
 An applicatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We use generics in RAD Studio Delphi. Create a library of sorting lists of similar objects</h1><div class="post__text post__text-html js-mediator-article">  Today we will create in RAD Studio Delphi a library of classes that implement sorting lists of similar objects. <br><br><h4>  <b>Purpose of the task</b> </h4><br>  An application developer should get a tool to create child classes in which you can: <br><br><ul><li>  operate with list objects; </li><li>  apply different rules for comparing objects; </li><li>  apply various object sorting algorithms. </li></ul><br>  The output should be a class library that allows you to: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  the application developer to sort any of the 100 objects by any of the 100 sorting methods; </li><li>  to develop and maintain new algorithms or new types of objects in one day by a single specialist. </li></ul><a name="habracut"></a><br>  When creating it is necessary to consider that the solution must satisfy the following model: <br><br><ul><li>  The number of sorting algorithms - 100; </li><li>  Types of objects available for sorting - 100; </li><li>  The number of developers simultaneously working with the library to create object types and sorting algorithms is 100. </li><li>  The development time for all sorting algorithms and object types is 2 days. </li></ul><br><h4>  <b>Getting started</b> </h4><br>  Sorting by ascending is a permutation of the elements of a data set so that as a result each subsequent element of the set is greater than the previous one.  Sorting in descending order is the same, only the traversal of the resulting dataset must be started from the end. <br><br><h5>  <b>Comparison of objects</b> </h5><br>  To understand which element of the data set is greater than another, you need to use a comparison operator for basic types.  And what about objects?  The base module <i>System.Generics.Defaults</i> includes the interface we need and the implementation of the class <br><br><pre><code class="delphi hljs">IComparer&lt;T&gt; = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Compare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Left, Right: T)</span></span></span><span class="hljs-function">:</span></span> Integer; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; TComparer&lt;T&gt; = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TInterfacedObject, IComparer&lt;T&gt;) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Default</span></span></span><span class="hljs-function">:</span></span> IComparer&lt;T&gt;; <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Comparison: TComparison&lt;T&gt;)</span></span></span><span class="hljs-function">:</span></span> IComparer&lt;T&gt;; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Compare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Left, Right: T)</span></span></span><span class="hljs-function">:</span></span> Integer; <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br>  In the interface, we see the only <i>Compare</i> method of the form. <br><br><pre> <code class="delphi hljs">TComparison&lt;T&gt; = reference <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Left, Right: T)</span></span></span><span class="hljs-function">:</span></span> Integer;</code> </pre><br>  At the input there are two parameters of the object type, and the output is an integer (0 - objects are equal, -1 - the first is less than the second, 1 - the first is more than the second). <br><br>  To compare our objects, we will use our own comparison functions, which describe the logic of comparison rules for each type of objects.  We enclose such functions in a separate class <i>TAllComparison</i> .  It describes all our comparison functions, they have the same look. <br><br><pre> <code class="delphi hljs"> TComparison&lt;T&gt; = reference <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Left, Right: T)</span></span></span><span class="hljs-function">:</span></span> Integer;</code> </pre><br>  And the TComparer (T) class just serves to compare two objects by calling the <i>Compare</i> method. <br>  You can use the default comparison, or create your own comparison method <i>Construct</i> , which we will do. <br><br>  For convenience, the description of all objects will be stored in a separate <i>AllObjects</i> module.  Here we will store the description of all 100 objects created by us. <br><br><h5>  <b>Operations with objects</b> </h5><br>  For implementing operations with list objects in Delphi, we already have the parameterized class we need, also known as a generic, with the methods we need <br><br><pre> <code class="delphi hljs"> TList&lt;T&gt; = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TEnumerable&lt;T&gt;)</code> </pre><br>  In general, universal parameterized types (generics) appeared in Delphi 2009, but for our example I use RAD Studio Berlin 10.1 UPD1.  If you do not compile something, you will need to finish the example for your version of Delphi. <br><br>  We write the main class of our library the successor of <i>TList (T)</i> <br><br><pre> <code class="delphi hljs"><span class="hljs-comment"><span class="hljs-comment">//         type TAppliedObjectList&lt;T&gt; = class(TList&lt;T&gt;) private type TSorting&lt;T&gt; = reference to function(var Values: array of T; const Comparer: IComparer&lt;T&gt;; Index, Count: Integer): Integer; var FCS: TCriticalSection; //        FComparer: IComparer&lt;T&gt;; //       Target: Array of T; //   ,      // ,        &lt;i&gt;Private&lt;/i&gt; public constructor Create; overload; constructor Create(const AComparer: IComparer&lt;T&gt;); overload; destructor Destroy; override; //           //        //   , ,     &lt;i&gt;MaxInt&lt;/i&gt; function SortBy&lt;T&gt;(const AProc: TSorting&lt;T&gt;): Integer; overload; end;</span></span></code> </pre><br>  The main method of our task is <i>SortBy</i> , we describe its use further. <br><br><h5>  <b>Sort objects</b> </h5><br>  We write the class <i>TAllSort</i> , which contains the description of all 100 sorting methods of the form: <br><br><pre> <code class="delphi hljs">TSorting&lt;T&gt; = reference <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">var</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Values: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">array</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">of</span></span></span></span><span class="hljs-function"><span class="hljs-params"> T; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Comparer: IComparer&lt;T&gt;; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Index</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Count: Integer)</span></span></span><span class="hljs-function">:</span></span> Integer;</code> </pre><br>  At the input, the method gets an array of data from the list, a method for comparing objects, the starting position for sorting, the number of elements in the set.  At the output we get the number of permutations made in the data set. <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-comment"><span class="hljs-comment">//      TSorting&lt;T&gt; TSorting&lt;T&gt; = reference to function(var Values: array of T; const Comparer: IComparer&lt;T&gt;; Index, Count: Integer): Integer; //  ,   100   TAllSort = class public // ***    class function BubbleSort&lt;T&gt;(var Values: array of T; const Comparer: IComparer&lt;T&gt;; Index, Count: Integer): Integer; // ***   class function QuickSort&lt;T&gt;(var Values: array of T; const Comparer: IComparer&lt;T&gt;; Index, Count: Integer): Integer; end;</span></span></code> </pre><br>  For convenience, all sorting methods will be kept in a separate module <i>SortMethods</i> . <br><br><h4>  <b>Demonstration</b> </h4><br>  As a demonstration of the solution, I present 2 sorting mechanisms: ‚ÄúFast‚Äù and ‚ÄúBubble‚Äù.  We will sort 2 types of objects: a list of two-dimensional vectors (ordered pairs) of type Integer and a list with strings. <br><br>  First, sort the array of strings by ‚Äúbubbles‚Äù: <br><br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TfmMainTest</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Button4Click</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-comment"><span class="hljs-comment">//    TAppliedObjectList&lt;String&gt; // ,        MyClass: TAppliedObjectList&lt;String&gt;; i: Integer; begin Memo1.Clear; try //    , //           //  IComparer&lt;T&gt; MyClass := TAppliedObjectList&lt;String&gt;.Create(TComparer&lt;String&gt;.Default); try Memo1.Lines.Text := '         ' + sLineBreak + '  ,     .' + sLineBreak + '       ' + sLineBreak + '        .' + sLineBreak + '         ,' + sLineBreak + '        .' + sLineBreak + '          ,' + sLineBreak + '     ,   .' + sLineBreak + '   ,    ' + sLineBreak + '    .' + sLineBreak + '  ,   ' + sLineBreak + '     .'; //     Memo for i := 0 to Memo1.Lines.Count - 1 do begin MyClass.Add(Memo1.Lines[i]); end; //    "" i := MyClass.SortBy&lt;String&gt;(TAllSort.BubbleSort&lt;String&gt;); //    Memo1.Lines.Add(sLineBreak + 'Turns: ' + i.ToString); //    Memo1.Lines.Add(' :'); for i := 0 to MyClass.Count - 1 do begin Memo1.Lines.Add(MyClass.Items[i]); end; finally //    ,      MyClass.Free; end; except on E: Exception do Memo1.Lines.Add(E.Message); end; end;</span></span></code> </pre><br>  Got the result: <br><br><img src="https://habrastorage.org/files/d5f/139/836/d5f139836aee4058aa9e7432f092068b.png"><br><br>  And now "quickly" sort the array of two-dimensional vectors: <br><br><pre> <code class="delphi hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TfmMainTest</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Button3Click</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Sender: TObject)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-comment"><span class="hljs-comment">//    TAppliedObjectList&lt;TVector2D&gt; // ,       TVector2D MyClass: TAppliedObjectList&lt;TVector2D&gt;; //    TVector2D v: TVector2D; i: Integer; begin Memo1.Clear; try //     , //       //  TAllComparison.Compare_TVector2D MyClass := TAppliedObjectList&lt;TVector2D&gt;.Create (TComparer&lt;TVector2D&gt;.Construct(TAllComparison.Compare_TVector2D)); try //     2D  Memo1.Lines.Add(' :'); v.Create(10, 21); MyClass.Add(v); Memo1.Lines.Add(v.ToString); v.Create(-10, 20); MyClass.Add(v); Memo1.Lines.Add(v.ToString); v.Create(-10, -2); MyClass.Add(v); Memo1.Lines.Add(v.ToString); v.Create(-1, 7); MyClass.Add(v); Memo1.Lines.Add(v.ToString); //   ""  i := MyClass.SortBy&lt;TVector2D&gt;(TAllSort.QuickSort&lt;TVector2D&gt;); //    Memo1.Lines.Add(sLineBreak + 'Turns: ' + i.ToString); //    Memo1.Lines.Add(' :'); for i := 0 to MyClass.Count - 1 do begin Memo1.Lines.Add(MyClass.Items[i].ToString); end; finally //    ,      if Assigned(MyClass) then MyClass.Free; end; except on E: Exception do Memo1.Lines.Add(E.Message); end; end;</span></span></code> </pre><br>  Here is the result with vectors: <br><br><img src="https://habrastorage.org/files/672/7dd/fae/6727ddfaeb3c4911acbf6f599e0a579a.png"><br><br><h4>  <b>Source codes</b> </h4><br>  ¬ª <a href="http://singro.ru/dowsnload_genericsort_sources/">Sample Delphi source codes for working with the TAppliedObjectList class</a> <br><br>  <b>Thanks for attention!</b> </div><p>Source: <a href="https://habr.com/ru/post/314780/">https://habr.com/ru/post/314780/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../314770/index.html">Configuring the internal navigation system using the tools Aruba</a></li>
<li><a href="../314772/index.html">3CX v15 VPS replaces the multi-tenant version of 3CX Phone System 14</a></li>
<li><a href="../314774/index.html">The remote proxy class is not (very) painful</a></li>
<li><a href="../314776/index.html">Know the competitor in person: how we conducted a competitive analysis</a></li>
<li><a href="../314778/index.html">NetApp ONTAP & ESXi 6.x tuning</a></li>
<li><a href="../314782/index.html">TrickBot - a new spam attack on the company</a></li>
<li><a href="../314784/index.html">Oracle database audit</a></li>
<li><a href="../314786/index.html">Topographer was drunk</a></li>
<li><a href="../314790/index.html">Personal experience: how to find a sales manager for a web studio</a></li>
<li><a href="../314792/index.html">The best IT vacancies on My Circle in a week, October 17-23</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>