<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Read more about Sikuli in test automation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Sikuli is an API that allows writing automation scripts on Jython based on the visual component of any program / site, etc. Especially ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Read more about Sikuli in test automation</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  Sikuli is an API that allows writing automation scripts on Jython based on the visual component of any program / site, etc.  Especially nice for automating Flash. <br>  About Sikuli few articles are written and most of them are overview.  Even less Russian-language help, and even fewer code examples.  And the absence of the latter is perhaps the most tragic for a software tester who is faced with the need to automate any flash.  It was precisely this that prompted me to write a more capacious article on Sikuli and describe in some detail some features of use. <br><br><a name="habracut"></a><br><h4>  Installation </h4><br>  To install and properly operate Sikuli, you will need: <br>  <a href="http://javadl.sun.com/webapps/download/AutoDL%3FBundleId%3D71310">1. Java of the sixth version and necessarily 32 bit.</a> <br>  <a href="">2. Distribution</a> <br>  <a href="">3. Service Pack.</a> <br><br>  Due to the fact that Sikuli comes only in 32-bit configuration, in order to work correctly on 64-bit systems, we must install Java 6u38 32x (with the 7th version does not work). <br>  It is also necessary to put the update package.  Installs easily.  The contents of the Sikuli-IDE folder are simply copied from the archive (point 3) into the folder with the installed program C: \ Program Files (x86) \ Sikuli X, by the way, do not change the default installation folder. <br>  If suddenly something is wrong, here is a <a href="https://answers.launchpad.net/sikuli/%2Bfaq/2005">reference</a> to read. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Functionality and features. </h4><br>  <b>Screenshot</b> <img src="https://habrastorage.org/getpro/habr/post_images/097/5d7/578/0975d75786053042c05b814c6331a056.png" alt="image"><br>  It is used to highlight a specific area of ‚Äã‚Äãthe screen and then create a pattern. <img src="https://habrastorage.org/getpro/habr/post_images/ee6/7e5/0fb/ee67e50fbe0a64476629a7c423ddf535.png" alt="image"><br>  When you click on the pattern, the "Template Setup" window appears. <img src="https://habrastorage.org/getpro/habr/post_images/e15/533/6fe/e155336feaefff49c274f282e09689c1.png" alt="image"><br>  Tabbed everything is primitive and clear.  The only thing I will note is that on the ‚Äútarget offset‚Äù tab, the goal is where to move the cursor and make a click / enter.  And the place of the click can lie far beyond the pattern. <br><br>  Now about the features. <br>  *****. png is the name of the desired picture that should be in the folder of a previously saved project. <img src="https://habrastorage.org/getpro/habr/post_images/81d/7cb/666/81d7cb66637b96c45ce9428367c89a91.png" alt="image"><br>  similar = similarity, where 1 = 100% (it is better not to use because it does not always find it), for example, 0.85 (through a dot) = 85%, which in my opinion is the most optimal value. <br>  targetOffset (x, y)) and here it is important that the coordinates "x" and "y" is the offset of the target from the center of the pattern. <br><br>  <b>Area selection</b> / <b>wait ()</b> / <b>Click ()</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/797/974/9f0/7979749f0cfcf1751dae46cd5c9a19d7.png" alt="image"><br>  Great function and most importantly, extremely useful. <br>  Many say that Sikuli has a bad understanding of work and is still mistaken great.  I completely disagree with this, and I believe that a competent approach significantly increases the performance of the program compared to similar IDEs. <br><br>  This function sets the active screen area. <br><img src="https://habrastorage.org/getpro/habr/post_images/376/36a/2c9/37636a2c9674452d7e0a4a6912e5dc00.png" alt="image"><br>  in which the search for the desired pattern will be performed. <br>  You can also like this: <pre><code class="python hljs">Region(x,y,w,h).find(Pattern(<span class="hljs-string"><span class="hljs-string">"*****.png"</span></span>.similar(<span class="hljs-number"><span class="hljs-number">0.85</span></span>)targetOffset(x,y)))</code> </pre> <br>  It is extremely useful if we need the script to react to changes promptly, not to slow down the system. <br>  As an example: <br>  from all of our large screen, we select only a small area where every time a cherished button appears. <img src="https://habrastorage.org/getpro/habr/post_images/b19/6c1/b9d/b196c1b9d4362fa5b4596c51a6d251a9.png" alt="image"><br>  Next, we describe what we need to look for in this area and then what to do with it. <br><img src="https://habrastorage.org/getpro/habr/post_images/e85/3ae/dd9/e853aedd9a3314743c92d1c15513253e.png" alt="image"><br>  In order to optimize the process, we need to run this script and make it click for us 1 time.  After we go to the tab "Message" where we see the coordinates of the click. <br><img src="https://habrastorage.org/getpro/habr/post_images/d34/357/bcf/d34357bcf84bd29344eb2e9d737eec32.png" alt="image"><br>  Then do a cycle and click on the coordinates (this is provided that the button will always appear in the same place). <br>  Similarity in the search do about 70 percent, will find faster, the expectation of 999 ... <br><img src="https://habrastorage.org/getpro/habr/post_images/e28/837/14d/e2883714da931012b9033ae4cc126d61.png" alt="image"><br>  As a result, we have almost instantaneous triggering. <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/LoZCr6swpJk&amp;xid=17259,15700022,15700186,15700190,15700253&amp;usg=ALkJrhj2ypilAnNa1uoKk3F1tjqNilA73g" frameborder="0" allowfullscreen=""></iframe><br><br>  <b>Find ()</b> <br><br>  The find () function searches for a pattern.  But why?  It's simple.  Once found, and then he will know where the found object is always.  How to put into practice: <br>  We have a lot of things either ... <img src="https://habrastorage.org/getpro/habr/post_images/e32/01d/58a/e3201d58acdebe4018ec8f09bfec86d5.png" alt="image"><br>  And the program will have to press this ‚Äúsomething‚Äù long and hard ... <br>  In order for the program to know where to click, you need to set targetOffset () <br><img src="https://habrastorage.org/getpro/habr/post_images/ecc/933/956/ecc9339569cd117dd6642c54e0bbb69e.png" alt="image"><br>  Repeat for each goal, assign variables, optimize if the field with the set is in the same place. <div class="spoiler">  <b class="spoiler_title">deploy here</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/3f5/c03/ef2/3f5c03ef21501c35568c3418c5fc33e3.png" alt="image"></div></div><br>  Further we can use the found zones as we want.  And the click will occur without delay in searching, etc. <br><img src="https://habrastorage.org/getpro/habr/post_images/946/798/c3e/946798c3e300a95361b1d5b82b48eb63.png" alt="image"><br><br>  The rest of the functionality will not be considered it is primitive and simple. <br><br><h4>  Examples </h4><br><div class="spoiler">  <b class="spoiler_title">The script should be sane!</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/cc8/eed/dea/cc8eeddea4818236dd01e9752241eeae.png" alt="image"></div></div><br><div class="spoiler">  <b class="spoiler_title">Creating the function yan ().</b>  <b class="spoiler_title">The first call to the function will call the find () command, subsequent calls will call click ().</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/abc/38f/2c2/abc38f2c231f9d3469c52ff7eb781db2.png" alt="image"></div></div><br><div class="spoiler">  <b class="spoiler_title">Through the dialog box, set the number of cycles.</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/e75/1f3/f62/e751f3f620efa974c22831a13e9488a4.png" alt="image"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">the try / except function and how good it is.</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/c8a/87c/11a/c8a87c11a39097858018df2f97171ee2.png" alt="image"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">And at the end of the bot to send gifts to friends (of which there may be 5k) in the game DOTD</b> <div class="spoiler_text"><pre> <code class="python hljs">Settings.MoveMouseDelay = <span class="hljs-number"><span class="hljs-number">0.02</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f5</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-string"><span class="hljs-string">"f5"</span></span>: click(Pattern(<span class="hljs-string"><span class="hljs-string">"KyddinsmapsD-1.png"</span></span>).targetOffset(<span class="hljs-number"><span class="hljs-number">-41</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)) sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> exists(Pattern(<span class="hljs-string"><span class="hljs-string">"1344731699750.png"</span></span>).similar(<span class="hljs-number"><span class="hljs-number">0.90</span></span>),<span class="hljs-number"><span class="hljs-number">10</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: wait(Pattern(<span class="hljs-string"><span class="hljs-string">"CLOSElah.png"</span></span>).similar(<span class="hljs-number"><span class="hljs-number">0.85</span></span>),<span class="hljs-number"><span class="hljs-number">25</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: click(Pattern(<span class="hljs-string"><span class="hljs-string">"CLOSElah.png"</span></span>).similar(<span class="hljs-number"><span class="hljs-number">0.85</span></span>).targetOffset(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">-6</span></span>)) dragDrop(Location(<span class="hljs-number"><span class="hljs-number">1430</span></span>,<span class="hljs-number"><span class="hljs-number">388</span></span>), Location(<span class="hljs-number"><span class="hljs-number">1431</span></span>,<span class="hljs-number"><span class="hljs-number">435</span></span>)) <span class="hljs-comment"><span class="hljs-comment"># 435 break except: pass def send_frend(): click(Location(849,495)) sleep(1) click(Location(578,695)) sleep(1) def pre_click_frend(): click(Location(713,300)) click(Location(713,315)) def click_frend(): click(Location(713,332)) click(Location(714,348)) click(Location(714,364)) click(Location(715,380)) click(Location(714,396)) click(Location(713,412)) click(Location(713,427)) click(Location(713,444)) click(Location(713,460)) click(Location(713,474)) click(Location(713,490)) click(Location(715,506)) click(Location(714,522)) click(Location(714,537)) click(Location(713,554)) click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)) sleep(1) click(Location(713,288)) click(Location(713,304)) click(Location(713,320)) click(Location(713,336)) click(Location(713,352)) click(Location(713,368)) click(Location(713,384)) click(Location(713,400)) click(Location(713,416)) click(Location(713,432)) click(Location(713,448)) click(Location(713,464)) click(Location(713,480)) click(Location(713,496)) click(Location(713,512)) click(Location(713,528)) click(Location(713,544)) click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)), click(Location(923,541)) sleep(1) click(Location(713,300)), click(Location(713,315)) click(Location(713,332)) click(Location(714,348)) click(Location(714,364)) click(Location(715,380)) click(Location(714,396)) click(Location(713,412)) click(Location(713,427)) click(Location(713,444)) click(Location(713,460)) click(Location(713,474)) click(Location(713,490)) click(Location(715,506)) click(Location(714,522)) click(Location(714,537)) sleep(1) def send_fb(): click(Location(756,760)) sleep(2) try: click(Pattern("0TIIp3BHTb33.png").targetOffset(-2,1)) except: pass def off (event): popup("The program is completed.\nCreator of this miracle: Grumo Van Blum.\nIf you have questions about using this program, please contact us by e-mail: grumovanblum@gmail.com\nGood Luck 8c)") exit() popup("If you want to stop the script, press: 'Ctrl' + 'Alt' + 'Space'") Env.addHotkey(Key.SPACE, KeyModifier.ALT+KeyModifier.CTRL, off) click(Pattern("1344836792562.png").similar(0.88)) n = 0 n = int(input("How many cycles you want to run?")) while n &gt; 0: f5() while "cycle": if n == 0: break else: send_frend() if exists(Pattern("Jd.png").similar(0.96),1): popup("Friends come to an end :)") n=0 continue else: pre_click_frend() sleep(1) if exists(Pattern("Youcanontysd.png").similar(0.95),1): f5() send_frend() pre_click_frend() else: pass click_frend() send_fb() n -= 1 if n == 0: break else: sleep(3)</span></span></code> </pre></div></div><br>  And a video about how it works (shot in debug mode). <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/g6b7ZzKJo7Q&amp;xid=17259,15700022,15700186,15700190,15700253&amp;usg=ALkJrhhz52MauhbZc0bYZHoyBsiXAgp8Ew" frameborder="0" allowfullscreen=""></iframe><br><br><h4>  Utilities Used </h4><br>  <u>Alt + Shift + c stops the script execution and returns the IDE.</u> <br><br>  <u>Set the cursor movement time:</u> <br><pre> <code class="python hljs">Settings.MoveMouseDelay = <span class="hljs-number"><span class="hljs-number">0.02</span></span></code> </pre><br>  <u>Assign an event to key combinations:</u> <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">off</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span><span class="hljs-function">:</span></span> exit() Env.addHotkey(Key.SPACE, KeyModifier.ALT+KeyModifier.CTRL, off)</code> </pre><br>  <u>Calling the dialog box (integer):</u> <br><pre> <code class="python hljs">n = int(input(<span class="hljs-string"><span class="hljs-string">"    ?"</span></span>))</code> </pre><br>  <u>Inaction in 1 sec:</u> <br><pre> <code class="python hljs">sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  <u>If after inserting the copied text you have replaced the code of a pattern or region with a picture, simply press 1 or 2 times the key combination Ctrl + z.</u> <br><img src="https://habrastorage.org/getpro/habr/post_images/685/d83/90f/685d8390f59c32b321ff8fea00e0a90d.png" alt="image"><br><br>  This is not all, and there will be more.  But at this stage I think that I expressed the main idea. <br>  I would be happy to feedback. <br>  If you have questions about Sikuli, then write. <br><br>  Next time I‚Äôll probably tell you how to teach Sikuli to recognize the text and write the error log to a separate file. <br><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/163883/">https://habr.com/ru/post/163883/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../163865/index.html">Started collecting pre-orders for virt2real (Virtuirlka)</a></li>
<li><a href="../163869/index.html">Atari Portfolio - John Connor's laptop</a></li>
<li><a href="../163871/index.html">Cheat Sheet by layout for large and small</a></li>
<li><a href="../163877/index.html">Is progressive improvement so expensive?</a></li>
<li><a href="../163881/index.html">CORE Design Technique</a></li>
<li><a href="../163885/index.html">Using Filters from Box2D in Libgdx</a></li>
<li><a href="../163889/index.html">The authorities of one of the lands of Germany obliged Facebook to allow users to use pseudonyms</a></li>
<li><a href="../163891/index.html">Opened catalog of applications for Raspberry Pi</a></li>
<li><a href="../163893/index.html">Solar system on LibCanvas</a></li>
<li><a href="../163895/index.html">Automatic analysis of code coverage using OpenCover + buns</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>