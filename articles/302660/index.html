<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Asus automatically updates BIOS / UEFI over HTTP without verification</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Asus took up the old again. You can send any executable file or even BIOS firmware to an Asus computer under the guise of an update - this file will b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Asus automatically updates BIOS / UEFI over HTTP without verification</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/405/eef/c83/405eefc838af497193b1a48820436c9f.png"><br><br>  Asus took up the old again.  You can send any executable file or even BIOS firmware to an Asus computer under the guise of an update - this file will be automatically launched for execution with maximum privileges, and the firmware will be installed without any checks.  Nothing needs to be done - the system will hack itself automatically. <br><br>  In short: computers with Asus motherboards <a href="http://teletext.zaibatsutel.net/post/145370716258/deadupdate-or-how-i-learned-to-stop-worrying-and">make requests to the remote server via HTTP</a> on a regular basis.  The reason is LiveUpdate software, which is pre-installed on Asus computers.  It is responsible for downloading new BIOS / UEFI firmware and executable files.  Updates are received in ZIP archives via pure HTTP, unpacked into a temporary folder, and the executable file is launched on behalf of the user.  There is no file verification or authentication when loading them, which allows for a MiTM attack and a banal escalation of privileges to <code>NT AUTHORITY\SYSTEM</code> . <br><a name="habracut"></a><br>  Asus has been distributing LiveUpdate with its laptops and PCs for a long time, more than ten years since Windows XP.  During this time, the principle of its work has not changed.  The client makes unencrypted HTTP requests to Asus update servers ( <i>liveupdate01.asus.com</i> or <i>dlcdnet.asus.com</i> , depending on the version). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For example, on the UX303UA laptop, the latest version of LiveUpdate tries to reach the following addresses.  It does this until it receives a response other than error 404. <br><br><ul><li>  <a href="">http://liveupdate01.asus.com/pub/ASUS/LiveUpdate/Release/Notebook/UX303UA.ide</a> </li><li>  <a href="">http://liveupdate01.asus.com/pub/ASUS/LiveUpdate/Release/Notebook/UX303UA.idx</a> </li><li>  <a href="">http://dlcdnet.asus.com/pub/ASUS/LiveUpdate/Release/Eee%20Book/UX303UA.ide</a> </li><li>  <a href="">http://dlcdnet.asus.com/pub/ASUS/LiveUpdate/Release/Eee%20Book/UX303UA.idx</a> </li></ul><br>  These ‚Äú.idx‚Äù files are quite complex, they allow you to download various updates, including flashing the BIOS via WinFlash (if the program is installed) and installing the drivers. <br><br>  For example, here is an entry in the XML file of the updated ACPI driver for ET1602 laptop: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ATK0110 ACPI Utility"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">l_id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1033"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ATK0110 ACPI Utility"</span></span></span><span class="hljs-tag">&gt;</span></span>ATK0110 ACPI Utility<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">l_id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ATK0110 ACPI Utility"</span></span></span><span class="hljs-tag">&gt;</span></span>ATK0110 ACPI Utility<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">l_id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2052"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ATK0110 ACPI Utility"</span></span></span><span class="hljs-tag">&gt;</span></span>ATK0110 ACPI Utility<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> driver <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hwid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1043.2.15.37"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">date</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"08/13/2004"</span></span></span><span class="hljs-tag">&gt;</span></span> ACPI\ATK0110 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hwid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">os</span></span></span><span class="hljs-tag">&gt;</span></span> WinXP <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">os</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> 1043.2.15.37 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> 837015 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">release-date</span></span></span><span class="hljs-tag">&gt;</span></span> 1219104000 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">release-date</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zip-path</span></span></span><span class="hljs-tag">&gt;</span></span> pub/ASUS/DigitalHome/DAV/B202/ACPI_V104321537.zip <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zip-path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execute</span></span></span><span class="hljs-tag">&gt;</span></span> .\AsusSetup.exe <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execute</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">index</span></span></span><span class="hljs-tag">&gt;</span></span> 1 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">index</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Here the cool thing is the procedure for unpacking and automatically launching the .exe file for execution. <br><br>  These are flowers.  Imagine that you can easily and easily reflash the BIOS. <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BIOS 210"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">l_id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1033"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BIOS 210"</span></span></span><span class="hljs-tag">&gt;</span></span>To solve the issue which charge speed will be slower when battery capacity is above 60%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">l_id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1028"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BIOS 210"</span></span></span><span class="hljs-tag">&gt;</span></span>Ëß£Ê±∫Áï∂ÈõªÊ±†ÂÆπÈáèÂ§ßÊñº60%ÊôÇÔºåÂÖÖÈõªÈÄüÂ∫¶ËÆäÊÖ¢ÁöÑÂïèÈ°å<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">l_id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2052"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BIOS 210"</span></span></span><span class="hljs-tag">&gt;</span></span>Ëß£ÂÜ≥ÂΩìÁîµÊ±†ÂÆπÈáèÂ§ß‰∫é60%Êó∂ÔºåÂÖÖÁîµÈÄüÂ∫¶ÂèòÊÖ¢ÁöÑÈóÆÈ¢ò<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> BIOS <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">os</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">os</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> 210 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> 2717731 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">release-date</span></span></span><span class="hljs-tag">&gt;</span></span> 1422628620 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">release-date</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zip-path</span></span></span><span class="hljs-tag">&gt;</span></span> pub/ASUS/nb/X453MA/X453MAAS210.zip <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zip-path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execute</span></span></span><span class="hljs-tag">&gt;</span></span> X453MAAS.210 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execute</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">index</span></span></span><span class="hljs-tag">&gt;</span></span> 1 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">index</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  There is <i>no</i> procedure for verifying the authenticity of this XML file. <br><br>  In the task scheduler, the frequency is set to perform the task once an hour, in addition, the update program constantly contacts the LiveUpdate server via HTTP.  The resulting file will be unpacked and launched for execution, whatever it is. <br><br>  The vulnerability was discovered by security specialist Morgan [ <a href="https://gist.github.com/indrora/9fde9b24542fed7cecdb">indrora</a> ] Gangwere. <br><br>  <a href="http://teletext.zaibatsutel.net/post/145370716258/deadupdate-or-how-i-learned-to-stop-worrying-and">The timeline of events</a> from the moment of discovery of vulnerability on April 27 until the moment of public disclosure of information is very funny: <br><br><blockquote><pre> <code class="hljs coffeescript">From the vendor that brought you a vulnerable cloud storage platform comes ___ ____ __ __ __ / _ \___ ___ ____/ / / / <span class="hljs-regexp"><span class="hljs-regexp">/__ ___/</span></span> <span class="hljs-regexp"><span class="hljs-regexp">/__ _/</span></span> <span class="hljs-regexp"><span class="hljs-regexp">/____ /</span></span> <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> / -_) _ `<span class="javascript"><span class="javascript">/ _ / </span><span class="hljs-regexp"><span class="javascript"><span class="hljs-regexp">/_/</span></span></span><span class="javascript"> / _ \/ _ / _ </span></span>`/ __/ -_) <span class="hljs-regexp"><span class="hljs-regexp">/____/</span></span>\__<span class="hljs-regexp"><span class="hljs-regexp">/\_,_/</span></span>\_,_<span class="hljs-regexp"><span class="hljs-regexp">/\____/</span></span> .__<span class="hljs-regexp"><span class="hljs-regexp">/\_,_/</span></span>\_,_<span class="hljs-regexp"><span class="hljs-regexp">/\__/</span></span>\__/ Because popping SYSTEM <span class="hljs-regexp"><span class="hljs-regexp">/_/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> easy <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> you trust HTTP Or, <span class="hljs-string"><span class="hljs-string">"How I learned to stop worrying and execute arbitrary executables from HTTP"</span></span> Affected software: LiveUpdate (any version? <span class="hljs-number"><span class="hljs-number">3.3</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> tested) Vulnerability: HTTP MITM to SYSTEM execution + more. CVSS: est. <span class="hljs-number"><span class="hljs-number">9.3</span></span> CVSS:<span class="hljs-number"><span class="hljs-number">3.0</span></span>/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N (NB: This assumes <span class="hljs-string"><span class="hljs-string">"Hijack some HTTP"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> easy <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> you<span class="hljs-string"><span class="hljs-string">'re local) Timeline: 2016-04-27 Initial discovery 2016-04-28 Attempt to contact vendor (security@asus.com - bounce) 2016-04-28 Disclosure to MSFT MSRC attempting vendor coordination 2016-05-09 Attempt to contact vendor (via phone; told to go away) 2016-05-10 Disclosure to CERT/CC (tracked as VU#215055) 2016-05-11 CERT/CC attempts to contact vendor 2016-05-24 CERT/CC: No response from vendor 2016-06-01 CERT/CC: Disclose at will 2016-06-03 Public disclosure</span></span></code> </pre> </blockquote><br>  As you can see, the hacker twice tried to contact the vendor.  The first time he wrote to the address <code>security@asus.com</code> , but received an automatic fail-over. <br><br><blockquote><pre> <code class="hljs pgsql">Delivery <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">following</span></span> recipient failed permanently: <span class="hljs-keyword"><span class="hljs-keyword">security</span></span>@asus.com Technical details <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> permanent failure: Google tried <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> deliver your message, but it was rejected <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the recipient <span class="hljs-keyword"><span class="hljs-keyword">domain</span></span> asus.com <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> mg.asus.com. [<span class="hljs-number"><span class="hljs-number">103.10</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span><span class="hljs-number"><span class="hljs-number">.32</span></span>]. The error that the other <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> returned was: <span class="hljs-number"><span class="hljs-number">550</span></span> #<span class="hljs-number"><span class="hljs-number">5.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> Address rejected.</code> </pre> </blockquote><br>  Then he phoned but was told ... not to call anymore. <br><br><h3>  Poc </h3><br>  Based on the logic of auto-update, you can run any file with a valid signature. <br><br><img src="https://habrastorage.org/files/286/55f/db2/28655fdb229344aa9929cbccab97f04f.png"><br><br>  To demonstrate the attack with escalation of privileges, Morgan Gangver used SysInternals PSEXEC.  He compiled a fake "update." <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">product</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UX303UA"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Garbage File"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">l_id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1033"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Legitimate System Utility"</span></span></span><span class="hljs-tag">&gt;</span></span>Shoutout to Joey.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> AP <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">os</span></span></span><span class="hljs-tag">&gt;</span></span> Win10(64) <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">os</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> 48 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> 199465 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">release-date</span></span></span><span class="hljs-tag">&gt;</span></span> 1459468800 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">release-date</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zip-path</span></span></span><span class="hljs-tag">&gt;</span></span> pub/ASUS/nb/Apps/LiveUpdate/LiveUpdate.zip <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">zip-path</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execute</span></span></span><span class="hljs-tag">&gt;</span></span> update.bat<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execute</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">index</span></span></span><span class="hljs-tag">&gt;</span></span> 22 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">index</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">severity</span></span></span><span class="hljs-tag">&gt;</span></span> 1 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">severity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">assistant</span></span></span><span class="hljs-tag">&gt;</span></span> SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{FA540E67-095C-4A1B-97BA-4D547DEC9AF4}\DisplayVersion <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">assistant</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">product</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  A copy of psexec, a fictional whoami and a script to run are packed into the ‚Äúupdate‚Äù archive. <br><br><img src="https://habrastorage.org/files/08f/e08/75f/08fe0875fb024184836bd7f4ad1a4581.png"><br><br>  Asus LiveUpdate immediately sees a "critical" update. <br><br><img src="https://habrastorage.org/files/405/eef/c83/405eefc838af497193b1a48820436c9f.png"><br><br>  Receiving a "critical" update, it is immediately assigned to execution with all the rights. <br><br><img src="https://habrastorage.org/files/b44/489/2b3/b444892b3a4d48e288deae807cdbc85b.png"><br><br>  Here is the result. <br><br><img src="https://habrastorage.org/files/796/1be/6c6/7961be6c60464505a1f64f8b4c04c2ac.png"><br><br>  Thus, we launched arbitrary code for execution as <code>NT AUTHORITY\SYSTEM</code> , simply giving it to the system in response to an HTTP call.  Everything else does LiveUpdate for you. <br><br>  In general, the awful, in terms of security, firmware upgrade procedure is peculiar not only to Asus motherboards, but also to hardware from other manufacturers.  The firmware of many routers, for example, are updated in an unsafe way. </div><p>Source: <a href="https://habr.com/ru/post/302660/">https://habr.com/ru/post/302660/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../302648/index.html">Aytreker in the service of a presentation consultant</a></li>
<li><a href="../302650/index.html">Inertial sensors: cooking recipes for positioning systems</a></li>
<li><a href="../302652/index.html">Adventure Jam 2016</a></li>
<li><a href="../302654/index.html">How Jack Ma managed to overcome his 7 biggest failures</a></li>
<li><a href="../302656/index.html">1000 and 1 repost: a guide on the "share" button in Russian social networks</a></li>
<li><a href="../302662/index.html">Regular Expression Crossword Algorithm</a></li>
<li><a href="../302664/index.html">Angler EK exploit kit specializes in circumventing EMET security mechanisms</a></li>
<li><a href="../302666/index.html">Google Developers Agency Pro: certification for the best developers of Android applications</a></li>
<li><a href="../302668/index.html">Interview with Baruch Sadogursky: the perfect stack of technologies for enterprise development</a></li>
<li><a href="../302670/index.html">Data Warehouse Testing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>