<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What are Docker images none: none?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I bring to your attention the translation of the article What are Docker none: none images? from the Project Atomic blog. 


 The last few days I spen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What are Docker images none: none?</h1><div class="post__text post__text-html js-mediator-article"><p>  <em>I bring to your attention the translation of the article <a href="https://www.projectatomic.io/blog/2015/07/what-are-docker-none-none-images/">What are Docker none: none images?</a></em>  <em>from the Project Atomic blog.</em> </p><br><p> The last few days I spent on exercises with Docker images <code>&lt;none&gt;:&lt;none&gt;</code> .  To explain what they are, and what they can do, I write this post in which I pose questions: </p><br><ol><li>  What are Docker images <code>&lt;none&gt;:&lt;none&gt;</code> ? </li><li>  What are dangling images? </li><li>  Why do I see a bunch of images <code>&lt;none&gt;:&lt;none&gt;</code> when I do <code>docker images -a</code> ? </li><li>  What is the difference between <code>docker images</code> and <code>docker images -a</code> ? </li></ol><br><p>  Before I start answering questions, remember that there are two kinds of <code>&lt;none&gt;:&lt;none&gt;</code> images <code>&lt;none&gt;:&lt;none&gt;</code> : good and bad. <a name="habracut"></a></p><br><h2>  Good images &lt;none&gt;: &lt;none&gt; </h2><br><p>  To understand them, you need to understand how the Docker image file system works, and how the image layers are organized.  This post will use the Fedora image as an example.  The docker daemon is running on a laptop, and I'm going to download a fedora image from a docker hub. </p><br><p><img src="https://www.projectatomic.io/images/fedora_pull.png" alt="docker images"></p><br><p>  In this screenshot, <code>docker images</code> shows <code>fedora:latest</code> , and <code>docker images -a</code> already has two <code>fedora:latest</code> and <code>&lt;none&gt;:&lt;none&gt;</code> .  If you use Docker, you noticed that the number of images <code>&lt;none&gt;:&lt;none&gt;</code> grows exponentially with the number of loaded images. </p><br><p>  What are the <code>&lt;none&gt;:&lt;none&gt;</code> images for?  To understand this, you need to know how the Docker file system layers are organized.  Each docker image consists of layers, and the layers have parent and child relationships with other layers.  All layers of the docker file system are stored in <code>/var/lib/docker/graph</code> by default.  In Docker terminology, it is called a graph database.  In the example, <code>fedora:latest</code> consists of two layers, which can be found in <code>/var/lib/docker/graph</code> . </p><br><p><img src="https://www.projectatomic.io/images/graph.png" alt="docker graph"></p><br><p>  <code>IMAGE ID</code> corresponds to the layer in the <code>/var/lib/docker/graph</code> directory.  When you do <code>docker pull fedora</code> , the image loads one layer at a time.  First, the docker loads the <code>48ecf305d2cf</code> layer and marks it <code>&lt;none&gt;:&lt;none&gt;</code> , as this is just one of the layers of the <code>fedora:latest</code> image.  In Docker terminology, it is called intermediate because of the <code>-a</code> option. </p><br><p>  Next, Docker loads the <code>ded7cd95e059</code> layer and marks it with <code>fedora:latest</code> .  The fedora: latest image consists of these two layers, forming the parent-child relationship. </p><br><p><img src="https://www.projectatomic.io/images/parent-child.png" alt="parent child"></p><br><p>  To check the existence of a parent-child connection, we can check the JSON file of the <code>ded7cd95e059</code> layer. </p><br><p><img src="https://www.projectatomic.io/images/JSON.png" alt="parent JSON"></p><br><p>  That's right!  Now we understand what the <code>&lt;none&gt;:&lt;none&gt;</code> images mean.  These are intermediate images that can be seen using <code>docker images -a</code> .  They do not overflow the hard drive, but take up a lot of space in the command output.  And quite difficult to understand what they are. </p><br><p>  We responded to (1), (3) and (4).  Let's shed some light on (2). </p><br><h2>  Bad &lt;none&gt;: &lt;none&gt; </h2><br><p>  Other images <code>&lt;none&gt;:&lt;none&gt;</code> are separate images that can overflow the hard disk. </p><br><p>  In Java and Golang programming languages, a separate memory block is a block without references from anywhere in the code.  The garbage collection system of such languages ‚Äã‚Äãperiodically marks the blocks as separate and returns them to the heap, after which these blocks are available for future use.  Like them, a separate Docker file system layer is something that is unused and has no references from any images.  Therefore, we need a way to tell Docker to clean up these separate images. </p><br><p>  We already know what <code>&lt;none&gt;:&lt;none&gt;</code> in <code>docker images -a</code> means.  It is said above that these are intermediate images.  However, in the absence of images <code>&lt;none&gt;:&lt;none&gt;</code> in the <code>docker images</code> output, there are intermediate images available for cleaning.  Where do they come from? </p><br><p>  These intermediate images are the results of the <code>docker build</code> or <code>pull</code> commands.  As a concrete example, </p><br><p>  Let's <code>hello_world</code> image using our previously downloaded basic fedora image.  We will <code>hello_world</code> image using a Dockerfile. </p><br><p><img src="https://www.projectatomic.io/images/hello_world.png" alt="hello world"></p><br><p>  As shown in the top screenshot, we successfully compiled the image of <code>hello_world</code> using the Dockerfile. </p><br><p>  Time passed after the assembly of the image <code>hello_world</code> , and a new version of Fedora was released.  Let's download the new Fedora image. </p><br><p><img src="https://www.projectatomic.io/images/new_fedora.png" alt="new fedora"></p><br><p>  I got a new Fedora look.  Now I want to build a <code>hello_world</code> image with the new Fedora.  Let's build the image again with the same Dockerfile. </p><br><p><img src="https://www.projectatomic.io/images/dangling.png" alt="dangling"></p><br><p>  If you digress and check, the old Fedora image has an IMAGE ID ( <code>ded7cd95e059</code> ) and the new Fedora image from the screenshot above has an IMAGE ID ( <code>5c6d07393f9f</code> ), which means that the Fedora image has been successfully updated.  The important thing to note on the top screenshot is the image of <code>&lt;none&gt;:&lt;none&gt;</code> . </p><br><p>  If you remember, the <code>&lt;none&gt;:&lt;none&gt;</code> <code>docker images -a</code> specified in <code>docker images -a</code> are intermediate (good) images, but this image <code>&lt;none&gt;:&lt;none&gt;</code> is the usual docker image.  This is a separate image and must be cleaned.  When the <code>hello_world</code> image was <code>hello_world</code> using the Dockerfile, its link to the old Fedora became unmarked and detached. </p><br><p>  This command can be used to clean isolated images. </p><br><pre> <code class="hljs mel">docker rmi $(docker images -f <span class="hljs-string"><span class="hljs-string">"dangling=true"</span></span> -q)</code> </pre> <br><p>  Now Docker does not have an automatic garbage collection system.  It will be cool to have one.  In the meantime, this command can be used for manual garbage collection. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/304134/">https://habr.com/ru/post/304134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304110/index.html">Features of the JIT compilers in HotSpot JVM - meeting with Doug Hawkins, St. Petersburg</a></li>
<li><a href="../304112/index.html">Let me introduce the Shadow DOM API based on slots.</a></li>
<li><a href="../304114/index.html">Day zero patient</a></li>
<li><a href="../304116/index.html">Augmented reality and socialization of people at a new level</a></li>
<li><a href="../304132/index.html">Announced by Cubieboard 5 / Cubietruck Plus and HDD-RAID Shield</a></li>
<li><a href="../304136/index.html">The digest of interesting materials for the mobile # 159 developer (June 20-26)</a></li>
<li><a href="../304138/index.html">Important aspects of the browser for developers. Part 1</a></li>
<li><a href="../304140/index.html">Parallax in 2D game. Interesting motion effect when creating a game on JavaScript (canvas)</a></li>
<li><a href="../304142/index.html">Learning C # - A Practical Approach</a></li>
<li><a href="../304144/index.html">Vending machine accepting DASH cryptocurrency returns</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>