<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Transported tablespaces in Oracle 11g</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi habrovchane, in this article I will talk about the moved tablespaces (Transportable tablespaces) in Oracle 11g. The table space can be cloned and t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Transported tablespaces in Oracle 11g</h1><div class="post__text post__text-html js-mediator-article">  Hi habrovchane, in this article I will talk about the moved tablespaces (Transportable tablespaces) in Oracle 11g.  The table space can be cloned and then inserted into another database by copying, and it can also be deleted from one Oracle database and included in another Oracle database on the same platform using a move. <br><a name="habracut"></a><br>  Data migration using tablespace movement is an order of magnitude faster than with export / import or upload / download operations, since tablespace movement consists only of data file copy operations and tablespace metadata integration.  Moving table spaces also allows you to move relevant indexes, so that after importing or loading tabular data, you do not need to rebuild the indexes. <br><br><h5>  Work with export and import utilities </h5><br>  Oracle Database allows you to copy data between databases, and share them with external files.  Copying is done through export and import. <br>  To accomplish this task there are utilities imp.exe and exp.exe <br><br><h5>  Portable Tablespaces </h5><br>  Promptly providing developers with a fresh copy of the production system data.  Use of information published on non-rewritable media (CD-ROM, DVD, etc.).  The rapid movement of data from the operating system to the storage or data mart. <br>  Accelerating the transfer of information is achieved by replacing the resource-intensive export-import processes or unloading-loading by much faster copying of data files from one computing installation to another. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Choosing a self-contained set of table spaces </h6><br>  There are a number of conditions limiting the use of the described possibility. <br>  You can move tablespaces only between databases that: <br><br>  1. Have the same block size (db_block_size), created with the same encoding (character set), in the initialization files (INIT.ORA) of the source and target databases the COMPATIBLE parameter must be set to the value, work on compatible platforms of the same hardware manufacturer . <br>  You can verify the requirements by running the following query in the source and target database: <br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> v$parameter <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'db_block_size'</span></span>,<span class="hljs-string"><span class="hljs-string">'compatible'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> all selct parameter, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> nls_database_parameters <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> parameter <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'%characterset'</span></span></code> </pre> <br>  The results of the queries in the source and target databases should be the same. <br><br>  2. The target database should not have a table space with the same name as the one being connected. <br><br>  3. Transportation is not supported: snapshots and replicable tables, functional indexes, local links to objects, domain indexes. <br><br>  4. Choosing a self-contained set of table spaces <br>  A self-sufficient set of table spaces is a collection of table spaces whose objects do not refer to any objects that are not contained in this set. <br>  To verify self-sufficiency it is convenient to use the procedure TRANSPORT_SET_CHECK (to perform the procedure, the role EXECUTE_CATALOG_ROLE is required). <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> sys.dbms_tts.transport_set_check (ts_list =&gt; <span class="hljs-string"><span class="hljs-string">'USER_DATA'</span></span>, incl_constraints =&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre><br>  The results of her work are recorded in a temporary table and can be viewed through the system view SYS.TRANSPORT_SET_VIOLATIONS: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sys.transport_set_violations</code> </pre><br><h6>  Migrating a tablespace set </h6><br>  First, the table spaces should be transferred to the READ ONLY state (hereinafter referred to as XXX - the name of the table space): <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLESPACE</span></span> TS_XXX <span class="hljs-keyword"><span class="hljs-keyword">READ</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ONLY</span></span>;</code> </pre><br>  Then, using the EXP utility, the dictionary metadata is exported. <br>  In the command line you should change the encoding for correct display of information. <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> nls_lang=russian_cis.ru8pc866</code> </pre><br><pre> <code class="dos hljs">exp transport_tablespace=y tablespaces=(TS_XXX) triggers=y constraints=y grants=y file=d:\exp_xxx log=d:\exp_xxx</code> </pre><br>  oracle will ask for your username and password: <br>  Username: sys / system @ orcl2012 as sysdba <br>  orcl2012 - connection string to the source database. <br>  TRANSPORT_TABLESPACE = Y - indicates that the metadata of transported tablespaces is being exported, TABLESPACES = (USERS, USER_DATA, INDX) - sets the list of transportable tablespaces, TRIGGERS = Y - Export table triggers (if you specify N, then triggers will not be exported) Y - Export integrity constraints (when N, PRIMARY KEY, UNIQUE, FOREIGN KEY and CHECK constraints are not exported, however NOT NULL constraints are exported), GRANTS = Y - Export table access privileges (N cancels privilege export), FILE = exp_tts and log = exp_tts file name  and the data and export the log file name. <br>  After the utility successfully exports the metadata, the output will be a file with the extension .dmp. (Exp_xxx.dmp) <br>  After exporting the metadata, you can move the tablespaces back to the READ WRITE state: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLESPACE</span></span> TS_XXX <span class="hljs-keyword"><span class="hljs-keyword">READ</span></span> WRITE;</code> </pre><br><h6>  Connecting a set of tablespaces to the target database </h6><br>  Before importing, you need to transfer data from the source database to the target: <br>  This can be done using ftp, command line or copying using Windows. <br>  You need to copy the tablespace file (.dbf) from the source database to the target. <br>  At the command prompt. <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">Copy</span></span> \\server1\oradata\orcl\TS_XXX.dbf \\server2\oradata\orcl\</code> </pre><br>  \\ server1 \ oradata \ orcl \ TS_XXX.dbf - path to the file of the table space being moved on the source database <br>  \\ server2 \ oradata \ orcl \ - the path where the table space will be stored on the target database <br>  Now you can connect a set of tablespaces to the target database. <br><pre> <code class="dos hljs">imp transport_tablespace=y DATAFILES=('E:\server2\oradata\orcl\TS_XXX.dbf') TABLESPACES=(TS_XXX) TTS_OWNERS=(XXXCORE) fromuser=(XXXCORE) touser=(XXXCORE) FILE=D:\ exp_xxx.dmp LOG=D:\imp_xxx.log</code> </pre><br>  oracle will ask for your username and password: <br>  sys / system @ ora2015 as sysdba <br>  ora2015 - the connection string to the target database. <br>  TRANSPORT_TABLESPACE = Y - indicates that the metadata of the set of plug-in table spaces is imported, DATAFILES = (...) is a list that defines the names and location of the connected data files, TABLESPACES = (TS_XXX) is a list of table spaces.  If the parameter is not specified, the list is taken from the export file.  If specified, it is checked against the list contained in the export file (in case of a mismatch, an error message will be displayed).  TTS_OWNERS = (XXXCORE) - the list of schemas that owns the objects in the connected table spaces.  If the parameter is not specified, the list is taken from the export file.  If specified, it is checked against the list contained in the export file (in case of a mismatch, an error message will be displayed).  FROMUSER = (XXXCORE), TOUSER = (XXXCORE) - the names of the source and corresponding target schemes. <br>  If the import is completed successfully, you can check the availability of data on the target database. <br><br>  Used literature literature: <br><ul><li>  Tidwell D. XSLT / D. Tidwell - St. Petersburg: Symbol Plus, 2010. - 960 p. </li><li>  <a href="http://www.emanual.ru/">www.emanual.ru</a> </li><li>  <a href="http://docs.oracle.com/cd/B19306_01/server.102/b14231/tspaces.htm">docs.oracle.com/cd/B19306_01/server.102/b14231/tspaces.htm</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/148535/">https://habr.com/ru/post/148535/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148530/index.html">Alternative SQL managers for Cach√© DBMS</a></li>
<li><a href="../148531/index.html">Another algorithm for calculating Fibonacci numbers</a></li>
<li><a href="../148532/index.html">Another calculation of the load on the department</a></li>
<li><a href="../148533/index.html">ASP.NET MVC: customization of client validation mapping using jQuery.Validate.Hooks + Tipsy</a></li>
<li><a href="../148534/index.html">Analogue scope (exit) in C ++</a></li>
<li><a href="../148537/index.html">ownCloud, we do our own secure cloud</a></li>
<li><a href="../148538/index.html">Window N70 Dual Core - a 7-inch tablet on the Rockchip RK3066 platform</a></li>
<li><a href="../148540/index.html">What delivery do you often choose for orders from abroad?</a></li>
<li><a href="../148542/index.html">Automatic news gathering on Twitter feed</a></li>
<li><a href="../148543/index.html">History and description of the already corrected vulnerability in the game WarCraft 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>