<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Monolithic Message-Oriented Application (MMOA)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Just finished the project 
 you have full knowledge 
 how it should be implemented. 
 (C) Tom Demarco 

 I always wanted to try to write an applicatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Monolithic Message-Oriented Application (MMOA)</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/e8f/d2e/291/e8fd2e2915a1cc33e2ce82ca9b074b1d.jpg" alt="Message">  <i>Just finished the project</i> <i><br></i>  <i>you have full knowledge</i> <i><br></i>  <i>how it should be implemented.</i> <br>  (C) Tom Demarco <br><br>  I always wanted to try to write an application, the modules of which communicate with each other through messaging.  In principle, it is quite even in the spirit of the classical understanding of its founders.  However, before Erlang, I was not old enough and I was familiar only with Golang, so it was on him that I tried to create a slightly bizarre, but nonetheless curious, web application architecture. <br><a name="habracut"></a><br>  I conditionally broke the application into parts, which I call services.  Services receive and send messages, and this is the only way they interact with each other.  Of course, there is a significant overhead in this - it will be faster to call a method with the transfer of a message than to send them through channels and a bus.  In addition, in addition to the overhead projector, there is also a complication of architecture, this is also important.  If for the reader these are important and critical requirements, then perhaps he should not continue to bother reading this article, because MMOA is just an experiment and a curious piece of work. <br><br>  However, if you still decided to spend your time reading (for which many thanks), then in addition to the minuses, I will point out one implicit plus, which is in all this strange construction.  The fact is that communication through messages implies a little more freedom and independence of the services included in the monolith.  Probably not obvious.  But whenever possible, I tried to ensure that services and channels of communication with them were formed outside the core of the application.  In the example lying in the distribution kit, it is clearly seen that the service initialization code lies in the main package. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Well, if everything is exactly as I say, then what is actually next?  Monolith - not a monolith, but what is the profit?  (the last phrase was in rhyme, an unexpected surprise!).  Here I am just like a cap, I will say that the service, which is fairly easy to select from the monolith, if necessary, can be distinguished from the monolith.  Dedicated service can be called microservice, which is what it will be by and large.  Why allocate service in microservice?  This is an important question.  Under normal conditions, this is not required, but if, for example, this service suddenly became so heavy that it‚Äôs time for him to move to his own server?  Then it is possible. <br><br>  However, the issue of allocating a service to microservice is quite hypothetical, but the desire to play around with messages and touch them is quite real)) Although MMOA can be called a framework (more likely a microform), however, for me it is in many ways more like a library or a toolkit with some implementation concepts or, frankly, hypotheses.  If I am to avoid tautology, perhaps I will sometimes call MMOA in different ways, please understand and forgive. <br><br><div class="spoiler">  <b class="spoiler_title">Wikipedia about frameworks</b> <div class="spoiler_text">  A framework (sometimes a framework; Anglicism, a neologism from a framework - a framework, a structure) is a software platform defining the structure of a software system;  software that facilitates the development and integration of various components of a large software project. <br></div></div><br><h2>  General principles </h2><img src="https://habrastorage.org/getpro/habr/post_images/7d5/bc3/072/7d5bc307219c78eea29a802704fe0bf6.gif" alt="MMOA"><br><br>  The concept of an MMAA is as follows: fairly independent services are developed (for this framework I have divided into several libraries), these services are combined into a single application and in the process of work they exchange data with each other by sending messages.  The delivery address of the message consists of the name of the service and the subject of the message.  (Themes are in essence events of events in services, however in this case for messages I preferred to call them that way). <br><br>  Initially, after reading smart books, I created a very complex and intricate architecture, but over time, the husks fell off and a small amount of ingredients were left.  I had to cut it alive.  From the remote I will probably mention balancing channels supporting queues with priorities.  Well, let them rest in peace)) <br><br><h2>  Fast start </h2><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/f15/0ac/e1d/f150ace1de91c0a03dc25b69552203ae.gif" alt="MMOA service">  As part of the distribution, there is a ready-made example that vividly demonstrates the work of MMOA on the example of a simple site, following my old tradition, dedicated to the Latin American dance ‚Äúrumba‚Äù.  Go to the <i>examples</i> folder, compile and run the application.  The result of the work look in the browser at <i><a href="http://localhost/">localhost</a></i> .  As a router, I used my <a href="https://github.com/claygod/Bxog">Bxog</a> development, but you can use any router of your choice.  Templating is done by the standard <i>html / template</i> library. <br><br><h3>  Details </h3><br><p>  The demo application has two services: <br><br></p><ul><li>  <i>article</i> - <i>article</i> service.  In order not to complicate the example of working with a DBMS, articles are stored here in a plain text file, which is parsed when the application is loaded.  At the request of the <i>Record</i> service gives the name and text of the article, nothing complicated.  He also has a supported <i>List</i> topic, which gives a list of articles in the database. <br><br></li><li>  <i>menu</i> - this service should give an array id - the name, i.e.  list of articles.  But since the articles have their own service, the <i>menu</i> requests the list from the <i>article</i> and, upon receiving it, sends a response to the aggregator on its own behalf.  This solution (not the most optimal in terms of performance) is intended to show the interaction of services between them.  Initially, I just wanted to hardcorely put an array of key-values ‚Äã‚Äãinto this service and give it on request, but it would not be interesting at all. </li></ul><p></p><br><h2>  MMOA Composition </h2><br>  For convenience and ease of creating services as part of the application, some parts of the MMAA are separated into separate libraries. <br><br><h3>  tools </h3><br>  This library is required when creating both applications and services. <br><br><ul><li>  <i>config.go</i> - the file contains the types used in the application, timer settings and statuses </li><li>  <i>message.go</i> is the main and only unit of information exchange between services, the content of the message is stored in MsgCtx, everything else is an envelope. </li><li>  <i>themes.go</i> is a structure listing all the services in the application and the messages they receive.  The structure was created specifically for convenience (IDE will not let you write the name of a non-existent service or a message subject that it does not support). </li><li>  <i>exchanger.go</i> - all data structures are stored in this file, in the format of which services can exchange data between themselves </li></ul><br><h3>  service </h3><br>  This library is used to create utility services and is required when writing custom services. <br><br><ul><li>  <i>logger.go</i> - a simple library for logging to the console </li><li>  <i>service.go</i> - the basis of the service, listens to the input port, if there is a suitable waiting for the message, determines it there, if not, tries to call the method assigned to the message subject, if not, sends the message to the recycle bin. </li><li>  <i>waiting.go</i> - stores the unit waiting for the arrival of messages, if the unit is full, it is sent to the desired method, if the unit is outdated, it is sent to the basket, and waiting is deleted. </li><li>  <i>aggregate.go</i> - accumulates messages with a given CID (correlation identifier), after adding a message it gives the number of still expected messages. </li></ul><br><h3>  support </h3><br>  This library contains the aggregator and basket service services, as well as a bus for sending messages. <br><br><ul><li>  <i>aggregator.go</i> is an analogue of waiting with the difference that here aggregates accumulate messages for sending to the handler, and unlike waiting units come here from handlers. </li><li>  <i>trash.go</i> - cart, messages with the wrong address, incorrect, and also with expired units are sent here. </li><li>  <i>bus.go</i> ‚Äî the bus accepts messages and forwards them to destination channels.  If the recipient is missing, the message is sent to the basket. </li></ul><br><h3>  Application root </h3><br>  These files are the core of the MMOA, and are not used outside of it. <br><br><ul><li>  <i>cid.go</i> - correlation identifier, a correlation identifier that helps services identify messages. </li><li>  <i>handler.go</i> - the request handler, creates an aggregate for the request and sends messages with requests to the necessary services. </li><li>  <i>controller.go</i> - conducts the initial initialization of the application, creates a bus and service services - an aggregator and a basket. </li><li>  <i>view.go</i> - responsible for templating.  Stores templates for responses of services and for the page. </li></ul><br><h2>  How to add your service </h2><br>  For a bunch of the above words, it can be very incomprehensible how convenient / inconvenient to use the concept described by MMOA, so with a simple example I will describe the process of adding a new service.  For example, we wanted the date to always be displayed on the page. <br><br><h4>  Update the list of services and topics </h4><br>  In the <i>tools / services_themes.go</i> add structure <br><br><pre><code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// ThemeCalendar structure type ThemeCalendar struct { Date TypeTHEME }</span></span></code> </pre> <br>  We add the <i>Calendar ThemeCalendar</i> line to the Themes structure and the <i>Calendar TypeSERVICE</i> line to the <i>ListServices structure.</i> <br><br><h4>  Create a service file </h4><br>  Create the directory <i>example / calendar</i> and the calendar.go file with the following contents: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> calendar <span class="hljs-comment"><span class="hljs-comment">// Monolithic Message-Oriented Application (MMOA) // Calendar // Copyright 2016 Eduard Sesigin. All rights reserved. Contacts: &lt;claygod@yandex.ru&gt; import ( "time" "github.com/claygod/mmoa/service" "github.com/claygod/mmoa/tools" ) func NewServiceCalendar(chIn chan *tools.Message, chBus chan *tools.Message) *ServiceCalendar { the := tools.NewThemes() s := &amp;ServiceCalendar{ service.NewService(the.Service.Calendar, chIn, chBus), } s.MethodWork = s.Work s.setEvents() s.Start() return s } type ServiceCalendar struct { service.Service } func (s *ServiceCalendar) setEvents() { s.Methods[s.The.Calendar.Date] = s.dateEvent } func (s *ServiceCalendar) dateEvent(msgIn *tools.Message) { t := time.Now() msgOut := tools.NewMessage().Cid(msgIn.MsgCid). From(s.Name).To(msgIn.AddsRe). Theme(msgIn.MsgTheme). Field("Day", t.Day()). Field("Month", int(t.Month())). Field("Year", t.Year()) s.ChBus &lt;- msgOut }</span></span></code> </pre><br><h4>  Templates </h4><br>  In the <i>example / data</i> directory, create a <i>date.html</i> file with the line <i><b>{{.Day}}. {{. Month}}. {{. Year}}</b></i> , and change the contents of the general page template to: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>{{.Title}}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content-type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=utf-8"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"file/twocolumn.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"header"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Rumba<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sidebar"</span></span></span><span class="hljs-tag">&gt;</span></span> {{.Sitemap}} {{.Date}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content"</span></span></span><span class="hljs-tag">&gt;</span></span> {{.Record}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h4>  Rule the application </h4><br>  Now it remains for us to add a new library to the import files, create a channel for it, create a new structure, and add a line to the handler's initialization: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-comment"><span class="hljs-comment">// Monolithic Message-Oriented Application (MMOA) // Application // Copyright 2016 Eduard Sesigin. All rights reserved. Contacts: &lt;claygod@yandex.ru&gt; import ( "github.com/claygod/Bxog" "github.com/claygod/mmoa" "github.com/claygod/mmoa/example/article" "github.com/claygod/mmoa/example/calendar" "github.com/claygod/mmoa/example/menu" "github.com/claygod/mmoa/tools" ) const chLen int = 1000 func main() { chBus := make(chan *tools.Message, chLen) chMenu := make(chan *tools.Message, chLen) chArticle := make(chan *tools.Message, chLen) chCalendar := make(chan *tools.Message, chLen) the := tools.NewThemes() app := mmoa.NewController(chBus) sm := menu.NewServiceMenu(chMenu, chBus) app.AddService(sm.Name, chMenu) sa := article.NewServiceArticle(chArticle, chBus) app.AddService(sa.Name, chArticle) sc := calendar.NewServiceCalendar(chCalendar, chBus) app.AddService(sc.Name, chCalendar) hPage := app.Handler("./data/template.html"). ContentType("text/html; charset=UTF-8"). Service(tools.NewPart(sm.Name).Theme(the.Menu.Sitemap).Template("./data/sitemap.html")). Service(tools.NewPart(sa.Name).Theme(the.Article.Record).Template("./data/record.html")). Service(tools.NewPart(sc.Name).Theme(the.Calendar.Date).Template("./data/date.html")). StatusCodeOf(the.Article.Record) m := bxog.New() m.Add("/:id", hPage.Do) m.Start(":80") }</span></span></code> </pre><br><h2>  Performance </h2><br>  As we have already learned, despite the fact that the application is compiled, MMOA, this is not the best solution for tasks where speed is the main and decisive factor, since in the process, the application services send messages to each other through the channels, which is natural is a brake.  In order to at least understand about how productive MMOA is, purely for reference, I spent a simple ab testing a running example from the example folder.  My computer issued the following spherical horse in a vacuum: <br><br><ul><li>  ab -n 10000 -c 1 -&gt; 3127 r / s </li><li>  ab -n 30000 -c 100 -&gt; 6373 r / s </li></ul><br>  Below, the benchmark shows quite well that an application running only with the <i>article</i> service works much faster than with the <i>menu</i> , which sends a request to the <i>article</i> , waits for it, receives an answer and only then sends its answer to the aggregator.  (Note: in parallel mode, the difference is somewhat reduced.) <br><br><ul><li>  BenchmarkOnlyArticle-4 50000 24722 ns / op </li><li>  BenchmarkArticleAndMenu-4 30000 43404 ns / op </li><li>  BenchmarkOnlyArticleParallel-4 100000 13831 ns / op </li><li>  BenchmarkArticleAndMenuParallel-4 100000 20752 ns / op </li></ul><br><h2>  What was / could be </h2><br>  If you wish, you can add priorities to the messages.  By the way, initially they were, but I found their functionality premature.  In addition to services, the handler can be ‚Äúout‚Äù, having simultaneously got rid of the controller.  I also tried this option, but decided that it‚Äôs better to the detriment of flexibility that everything lies inside and does not hurt the eyes.  Handler is generally worth it to simplify and give him a splitter.  There were other ideas, but sometimes you just want to stop. <br><br><h2>  Conclusion </h2><br>  Most likely in MMOA, many readers have something familiar: patterns, microservices, SOA, MQ, etc.  This is good and I dare to assure you, MMOA does not pretend to overthrow or appropriate other people's laurels.  This is only a tool whose ideas you might be interested in.  From myself I will add only one IMHO - in many respects the MMOA is written under the influence of Golang, which I consider to be quite interesting and very suitable for developing a wide variety of applications, and many thanks to the authors of the language for their work. <br><br><h2>  Links </h2><br>  <a href="https://github.com/claygod/mmoa">Github</a> </div><p>Source: <a href="https://habr.com/ru/post/316692/">https://habr.com/ru/post/316692/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316682/index.html">Interview with the designer: Olga Romanova</a></li>
<li><a href="../316684/index.html">Speak the word about Brave React</a></li>
<li><a href="../316686/index.html">Gitlab flow</a></li>
<li><a href="../316688/index.html">‚ÄúDemand for Visual Studio for Mac is big‚Äù - an interview with Alex Thissen</a></li>
<li><a href="../316690/index.html">How IT professionals work. Andrei Shorin, Deputy Director of Operations HeadHunter</a></li>
<li><a href="../316698/index.html">VKontakte will sell advertising under the new scheme and share revenue with community owners.</a></li>
<li><a href="../316700/index.html">KitchenCI + Ansible for Windows and Linux</a></li>
<li><a href="../316702/index.html">Interesting IT-vacancies on My Circle for the week, November 7-13</a></li>
<li><a href="../316706/index.html">The implementation of multiplayer in the game. Comparison of Game Center, Steamworks and GameSparks features</a></li>
<li><a href="../316708/index.html">Function length</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>