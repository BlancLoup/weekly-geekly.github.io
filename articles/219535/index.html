<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PassportVision - an easy way to recognize documents</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Surely you may have got into such a situation: go to any institution (post office, bank, hospital, cash, etc.), where you need to present a passport t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PassportVision - an easy way to recognize documents</h1><div class="post__text post__text-html js-mediator-article">  Surely you may have got into such a situation: go to any institution (post office, bank, hospital, cash, etc.), where you need to present a passport to achieve your goals.  And it seems like a small queue, only 5 people, but it will take a very long time to wait, because Aunt Masha spends a few minutes entering data from each passport into the computer.  You just have to watch how her index finger slowly plans over the keyboard in search of the next key. <br><br>  We were puzzled by such a sad situation in modern society and wrote <a href="http://www.passportvision.ru/">PassportVision</a> , which can recognize data from various documents and give the result to the user in a convenient form.  The task turned out to be not so simple as it might seem at first glance: during the work on the project, we learned a lot of new things about domestic documents, computer vision and user interfaces.  The head is already full of new ideas about the future development of the program, but we decided to find time to share our experience and knowledge gained. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/54f/d29/567/54fd295677df62a169b77b3a793eb0ae.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Today in issue: <ul><li>  Popular misconceptions about passports </li><li>  A little about the technologies used </li><li>  Our interface approach </li><li>  What is the best way to give data to the user </li></ul><a name="habracut"></a><br><h1>  Popular misconceptions about passports </h1> It would seem - what is so difficult to recognize data from a passport?  In the end, 2014 is in the courtyard, humanity has already learned to recognize the text from the image.  Applied a couple of filters, called the method <code>recognize()</code> - and that's it! <br><br>  Alas, everything is not so simple.  First of all, it is worth noting that the passport of a citizen of the Russian Federation is a document with special specifics.  We didn‚Äôt even imagine how amazing passports could be until we looked at a few hundred examples.  So, we offer you a list of misconceptions in the best traditions of misconceptions about <a href="http://habrahabr.ru/post/146901/">names</a> and <a href="http://habrahabr.ru/post/146109/">time</a> . <br><br>  <b>All these assumptions are wrong.</b> <ol><li>  Text in passports is always in one font. </li><li>  There are only two or three fonts with which passports are typed. </li><li>  Okay, but the font can not be bold or italic </li><li>  Well, at the same time bold and italic, he definitely will not </li><li>  All passport data is written in one font. </li><li>  No one fills in a passport by hand. </li><li>  Each passport field is in a strictly defined place. </li><li>  Each passport field is located near its strictly defined place. </li><li>  Well, at least the surname will not crawl three lines down to the middle name </li><li>  And never the data is written on top of the form lettering. </li><li>  Well, the data will not exactly collide with each other. </li><li>  The text is always written horizontally. </li><li>  Ok, but the angle of the text does not exceed 10-15 degrees </li><li>  All data are at the same angle. </li><li>  Text is always black </li><li>  Well, at least all the labels are exactly the same color. </li><li>  Passport always has a machine-readable zone. </li><li>  The computer-readable zone is always present on passports issued after July 1, 2011. </li><li>  The machine-readable zone is always correct and meets standards. </li><li>  All letters in the passport are written in upper case. </li><li>  All passport data is written in the same register style </li><li>  All dates are always in the same format. </li><li>  The name cannot be broken into two lines with a hyphen </li><li>  All passports are printed on identical forms with a fixed background. </li><li>  There can be no numbers at the place of birth and at the place of issue </li><li>  Personal signature cannot be over passport data </li><li>  All passport data is always present. </li><li>  There is no extra data </li><li>  The place of issuance of the passport is always placed in three lines. </li><li>  If ‚ÄúAnna‚Äù is written in the ‚ÄúName‚Äù field, then the gender is necessarily female </li><li>  Passport data is not erased over time </li><li>  Passport has no mechanical damage. </li><li>  Passport can not be soiled with jam </li></ol><br><h1>  A little about the technologies used </h1>  Today, there will be really little about technology.  In the course of writing our program, we are faced with a lot of interesting tasks: both in the field of computer vision, and in the field of building architecture and organization of the working environment.  We are planning to expand this topic in a separate post, and today we will only mark the technology stack. <br><br>  The main programming language is C #.  Perhaps someone will find such a choice strange, but he fully justified himself.  C # is great for creating a large-scale architecture, and the layout of a complex interface is easy enough (thanks to you, the creators of WPF).  The target audience is sitting on Windows, so there are no problems with the platform.  We solve various internal minor tasks using Python scripts. <br><br>  <a href="http://opencv.org/">OpenCV is</a> used for image processing, <a href="https://code.google.com/p/tesseract-ocr/">Tesseract</a> is used for text recognition (or rather, their wrappers are <a href="https://github.com/shimat/opencvsharp">OpenCvSharp</a> and <a href="https://github.com/charlesw/tesseract">Tesseract</a> ).  Performance-critical algorithms are written in C ++, but there are few of them.  We have to work a lot with scanners, and to support both WIA and Twain (for the latter we use <a href="https://github.com/tmyroadctfig/twaindotnet">TwaintDotNet</a> wrapper). <br><br>  General workflow: version control system - Git, repository viewer - <a href="https://www.atlassian.com/software/fisheye">FishEye</a> , continuous integration system - <a href="https://www.atlassian.com/software/bamboo">Bamboo</a> , bug tracker - <a href="https://www.atlassian.com/get-jira">JIRA</a> , code review system - <a href="https://www.atlassian.com/software/crucible">Crucible</a> (yes, we love Atlassian). <br><br><h1>  Our interface approach </h1>  Everything would be fine if we could recognize the data from any passport with absolute certainty.  But alas, it is not.  If you give the program an input of a good passport scan at 300 dpi, then, most likely, it recognizes it without errors.  But if the program encounters a passport photo of sad quality (and in addition the font will be very pale and at an angle, and the inscriptions are not in their places), then we will have problems.  Therefore, there is no choice but to ask the user to check the recognized data.  And here it is very important to design a damn good and user-friendly interface that allows you to quickly check all the data and correct errors.  After all, if the time spent on checking a passport is comparable to the time of manual data entry, the whole idea loses its meaning.  We do not pretend that we managed to create the best interface in the world for such a task, but we can declare with full responsibility that it is good.  In the end, we ourselves <s>eat our dog food</s> using our data checker every day for more than a year.  Therefore, all the shoals and inconveniences very quickly caught the eye and asked themselves to fix it.  So, what we paid special attention to in order to make life easier: <ul><li>  <b>Navigation in the fields.</b>  In the main window on the left is the found image of the passport, and on the right - the recognized fields.  For each field in the image of the passport, a frame is painted on it when clicking on it we move to the field we need.  If we have the same field in the picture in several places (for example, the series and passport number can be found as many as three times), and the recognition results are different - then we turn the TextBox into a ComboBox so that you can easily select the desired option. </li><li>  <b>Suspicious characters.</b>  In the process of recognition, we mark some characters as suspicious - these are characters whose recognition we are not very sure of.  If there are errors, they are almost certainly among the suspicious characters.  Therefore, we paint them with reds and provide easy navigation: by hotkey you can go to the next or previous group of suspicious characters.  Moreover, navigation is quite intelligent: if in the field almost all the characters are suspicious, then when we go to the error, we select not only red letters, but in general the whole field. </li><li>  <b>Tooltips.</b>  Initially, to check a field, one had to first look at the field, then look at the picture with the passport, find that field there.  Then back to TextBox, then back to your passport.  Then think and relate the text.  It is long and uncomfortable.  Therefore, right next to the TextBox we make a tooltip with the corresponding passport fragment.  And in order to search for the necessary characters it was even more convenient, we circle the text selected by the user in the picture.  If the user has already managed to write in the field of his characters, the program knows how to think out pretty well where they should be on the image and still leads around. </li><li>  <b>Autogeneration form.</b>  And what if the user does not need all the fields?  Let's say you need only a full name.  Why force the user to check all the results?  Fortunately, the list of fields can be customized to display only those that you really need. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/43e/994/15d/43e99415d07c771ee6cfcd85e0a5ed24.png"><br><br>  And you know, in general, we sawed UI for a very long time, a lot of things were done, you can‚Äôt tell them briefly.  Better then we will make a separate post in which we will tell in detail about all usability solutions in the program.  If you are engaged in the design of interfaces, then you probably will be interested in reading not only about the final result, but also about the process - how we came to this interface, why we did it and not otherwise. <br><br><h1>  What is the best way to give data to the user </h1>  Well, it would seem, everything is ready: the image is processed, the text is recognized, the user has checked everything.  What else is missing for happiness?  Let's think: once the data is recognized, it means that someone needs it.  And, probably, this someone plans to use them later.  And, presumably, he will use them in some of his own program.  So, the recognized data must somehow be transferred to this program.  A logical question arises: how are we going to do this? <br><br>  <b>PassportVision Office.</b>  Alas, there are many programs, and for each you need to look for your own approach.  A sociological survey showed that the majority of the target audience enters passport data into documents that are prepared in MS Word.  Therefore, we have made a separate edition of PassportVision for working with Word: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ed/850/b76/4ed850b761362c976252e52b7136fd5a.jpg"><br><br>  The idea is as follows: a special tab is added to the ribbon, with which you can create a template with special labels.  So, the data was recognized, the user checked them, clicked OK.  And, as if by magic, the data is inserted into the template instead of the previously prepared tags.  Quite often, the document is issued with the participation of several actors, so for each label you can specify which person the passport belongs to.  We put the first passport in the scanner, then the second - and our document is ready!  Markers behave quite intellectually.  For example, for a date, you can specify the presentation format, and the endings of individual words may depend on the gender of the person. <br><br>  <b>PassportVision Adaptive.</b>  Alas, not everyone uses Word, there are still many programs in the world in which data can be entered.  For everyone to write separate editions is not very appropriate, so we wrote a universal edition that can be adapted to any application.  PassportVision Adaptive emulates the user's work: where, what button to click, where to click.  You only need to make a special macro in which you explain to the program, what would you do if you needed to use the recognition results.  Yes, it is possible that a macro for complex software is not so easy to make, but it is a one-time operation.  Once everything is set up, and the data will fall into the right places of your target program by pressing special keys.  And if problems with writing a macro still arise, we help all clients cope with them. <br><br>  <b>PassportVision SDK.</b>  And some users want to use the recognition results in their own software.  If you are a developer, then you can use a special API to get all the data in the right format.  If your application is not developed under .NET, then do not worry: we carefully wrapped the API in a COM wrapper, so the SDK can be used from under C ++ and Delphi. <br><br>  <b>Other editions of PassportVision.</b>  Development is in full swing, we are trying to make many different editions of the program, so that everyone can choose a solution that is convenient for them.  For example, a version under 1C will soon appear on the screens (there is also often a need to enter passport data), and the Adaptive version will be supplemented with special macros for web forms (you just need to specify which fields to fill in, and magic JavaScript will do the rest ). <br><br><h1>  Instead of conclusion </h1>  If you want to use our program in order to save people from manually entering passport data and make the world a better place, you can <a href="http://www.passportvision.ru/contacts/">contact</a> us and we will tell you more about PassportVision.  And if you are not interested in the automation of workflow, but are interested in how software development is going on in different companies, then especially for you there will be posts with detailed information about work organization, computer vision and usability approaches.  Development is actively continuing, now we are adding support for different types of documents (passports, birth certificates, etc. - they are already working in alpha mode), new product revisions and cool features.  In the course come across some very interesting technical problems, for which you have to come up with exciting solutions.  If you are interested, we will also publish posts about solving the most interesting problems - we hope someone will benefit from this experience. </div><p>Source: <a href="https://habr.com/ru/post/219535/">https://habr.com/ru/post/219535/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../219509/index.html">Skeletal animation for the first time</a></li>
<li><a href="../219521/index.html">Humble Mobile Bundle 5!</a></li>
<li><a href="../219523/index.html">Your best friend, anonymous</a></li>
<li><a href="../219525/index.html">Samsung made a discovery that could turn the entire consumer electronics industry</a></li>
<li><a href="../219533/index.html">Ratchet 2.0 - the most beautiful HTML5 framework is now friendly with both iOS and Android</a></li>
<li><a href="../219537/index.html">What we should fix a bug, which is "no"</a></li>
<li><a href="../219539/index.html">CTOcast # 1: Kirill Safonov (RuTarget)</a></li>
<li><a href="../219541/index.html">Servers for STSS Flagman video surveillance</a></li>
<li><a href="../219543/index.html">Gramafon: a wifi router and music player in one</a></li>
<li><a href="../219545/index.html">7 tips to promote applications for Windows Store</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>