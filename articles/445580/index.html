<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>An exhaustive list of differences between VB.NET and C #. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first part of the article, the topic of VB.NET superiority over C # by TIOBE rating found a lively response in the comments. Therefore, on the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>An exhaustive list of differences between VB.NET and C #. Part 2</h1><div class="post__text post__text-html js-mediator-article">  In the <a href="https://habr.com/ru/company/jugru/blog/443684/">first</a> part of the article, the topic of VB.NET superiority over C # by TIOBE rating found a lively response in the comments.  Therefore, on the <a href="https://habr.com/ru/company/jugru/blog/443684/">advice of</a> <a href="https://habr.com/ru/users/angreload/" class="user_link">AngReload,</a> we will look at StackOverflow <a href="https://stackoverflow.blog/2017/05/09/introducing-stack-overflow-trends/">trends</a> . <br><img src="https://habrastorage.org/webt/j-/h5/pb/j-h5pbwyspgmneebz20tzlway28.png"><br>  C # is still strong!  The revolution that was talked about for so long last time is canceled!  Cheers, comrades!  Or not?  The TIOBE rating is based on search queries, and the SO rating is based on the questions asked.  Perhaps the developers of VB.NET, which include many people in non-IT specialties, simply do not know about the existence of StackOverflow?  Or having got there through Google, and even Bing, do not understand how to ask a question?  Or maybe Miscrosoft documentation is enough for them, and all the few questions have already been answered. <br><br>  Anyway, the share of VB.NET is noticeable and stable, even if not in the first place in terms of volume.  And, of course, such a result would have been impossible without a strong team of designers and language developers.  Below is the second part of the translation of the article of the team member, <a href="https://twitter.com/ThatVBGuy">Anthony Green</a> . <br><a name="habracut"></a><br><h2>  Content </h2><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><h4>  Transformations </h4><br><ul><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">34. Boolean transformations</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">35. Conversions between Enum types, as well as between Enum types and their base types are completely unlimited, even if Option Strict is set to On</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">36. Check overflow (overflow) / negative overflow (underflow) for integer arithmetic is completely controlled by the compilation environment (project settings), but VB and C # use different default values;</a>  <a href="https://habr.com/ru/company/jugru/blog/445580/">overflow is enabled by default in VB</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">37. Converting floating-point numbers to integer types uses banking rounding (bakers rounding) rather than truncating</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">38. It is not an error to convert NotInheritable classes to / from interfaces that they do not implement at compile time.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">39. Attempting to unpack (unbox) null to a meaningful type results in a default type value, not NullReferenceException.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">40. Unboxing supports primitive type conversions.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">41. There are conversions between String and Char</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">42. There is a conversion between String and Char array</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">43 and 44. Conversions from String to numeric and date types support the syntax of literals (as a rule)</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">45. NO conversion between char and integer types</a> </li></ul><br><h4>  Expressions </h4><br><ul><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">46. ‚Äã‚ÄãNothing &lt;&gt; null</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">47. Brackets not only affect the priority of parsing;</a>  <a href="https://habr.com/ru/company/jugru/blog/445580/">they reclassify variables to values</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">48. Me is always classified as a value - even in structures.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">49. Extension methods are available by simple name.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">50. Static imports do not merge method groups (Static imports will not merge method groups)</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">51 and 52. Partial-name qualification and smart name resolution (Partial-name qualification &amp; Smart-name resolution)</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">53. Add methods of the collection initializer may be extension methods.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">54. Array creation uses upper bound, not size.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">55. VB array literals. Magic is not the same thing as implicitly typed array creation expressions in C #</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">56. Fields of an anonymous type can be editable And defaults are editable</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">57. Neither CType nor DirectCast are exactly type conversions in C #</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">58. The priority of some "equivalent" operators does not necessarily coincide.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">59. String concatenation is different;</a>  <a href="https://habr.com/ru/company/jugru/blog/445580/">+ and &amp; differ in the context of string concatenation;</a>  <a href="https://habr.com/ru/company/jugru/blog/445580/">+ in VB &lt;&gt; + in C #</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">60. The division works adequately: 3/2 = 1.5</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">61. ^ not quite Math.Pow</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">62. Operators = / &lt;&gt; are never equality / inequality of references.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">63. Operators = / &lt;&gt; for strings are different (and any other relational operators in this context)</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">64. Nullable meaningful types use three-valued logic (propagate null in relational operators)</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">65. Overloaded operators do not always correspond 1: 1</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">66. Function () a = b differs from () =&gt; a = b</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">67. Lambda Async Function will never be treated as lambda async void</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">68. Requests are real (more real) in VB</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">69 and 70. The As statement in the From query does not always call cast;</a>  <a href="https://habr.com/ru/company/jugru/blog/445580/">As a bonus, the 'As' operator can cause implicit user conversions.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">71‚Äì75.</a>  <a href="https://habr.com/ru/company/jugru/blog/445580/">The Select statement is not needed at all, it may appear in the middle of a query, it may appear several times, and it may declare several range variables with implicit or explicit names.</a> </li><li>  <a href="https://habr.com/ru/company/jugru/blog/445580/">76. CONCLUSION SHOULD ...</a> </li></ul></div></div><br><h2>  Transformations </h2><br><a name="section34"></a><h3>  34. Boolean transformations </h3><br>  A <code>Boolean True</code> conversion to any signed numeric type produces <code>-1</code> , and to any unsigned, the maximum value for this type, whereas there is no such conversion in C #.  However, the <code>Convert.ToInt32</code> method, for example, converts <code>True</code> to <code>1</code> , and this is how it is most often represented in <code>IL</code> .  In the opposite direction, any number other than <code>0</code> is converted to <code>True</code> . <br><br>  <b>Why?</b>  The reason why VB prefers to use from <code>-1</code> to <code>1</code> is that the bitwise negative 0 (all bits are set to 0) is <code>-1</code> in any language (all bits are set to <code>1</code> ), so using this value combines logical and bitwise operations like <code>And</code> , <code>Or</code> and <code>Xor</code> . <br>  Conversions to and from the ‚ÄúTrue‚Äù and ‚ÄúFalse‚Äù strings are also supported (of course, case insensitive). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="section35"></a><h3>  35. Conversions between Enum types, as well as between Enum types and their base types are completely unlimited, even if Option Strict is set to On </h3><br>  From a philosophical point of view, the language refers to <code>Enum</code> types rather as a set of named constants of basic integer type.  The place where this is most obvious is equality.  It is always permissible to compare any integer with the enumeration value, whereas in C # this gives an error. <br><br>  <b>Time stories:</b> The Roslyn API has gone through many internal revisions.  But in each of them, for each language, the <code>SyntaxKind</code> enumeration was <code>SyntaxKind</code> , which tells you which syntax the node represents (for example, <code>IfStatement</code> , <code>TryCastExpression</code> ).  One day, a developer used an API that tried to disengage from the language and returned one of the <code>SyntaxKind</code> values, but only as an <code>Integer</code> , and without receiving an error when comparing the raw <code>Integer</code> and <code>SyntaxKind</code> , this developer immediately came to my office and complained: <i>‚Äúint is implementation detail, I should have been forced to make a ghost! "</i> . <br><br>  Years later, during the next API revision, we completely removed the properties ( <code>Property Kind As SyntaxKind</code> ) that pointed to the language-specific type, and all APIs started to return <code>Integer</code> .  All C # code broke, and all VB code continued to work as if nothing had happened. <br><br>  A little later, we decided to rename this property in <code>RawKind</code> and add language-specific extension methods <code>Kind()</code> .  All the C # code broke because the parentheses were needed to call the methods, but since they are not needed in VB, the entire VB code again continued to work as if nothing had happened. <br><br><a name="section36"></a><h3>  36. Checking overflow (overflow) / negative overflow (underflow) for integer arithmetic is completely controlled by the compilation environment (project settings), but VB and C # use different default values;  overflow is enabled by default in VB </h3><br>  Integral types have a range, so, for example, <code>Byte</code> can represent values ‚Äã‚Äãfrom 0 to 255. So, what happens when you add <code>Byte</code> 1 to <code>Byte</code> 255?  If overflow / underflow is disabled, the value scrolls to 0. If the type is signed, it scrolls to the lowest negative number (for example, -128 for <code>SByte</code> ).  This most likely indicates an error in your program.  If overflow / underflow checking is enabled, an exception is thrown.  To understand what I mean, take a look at this harmless <code>For</code> loop. <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i As Byte = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">255</span></span> Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="https://gist.github.com/AnthonyDGreen/14d391f8a287f9aca124f86a70a3ee90">source code on github</a> <br><br>  By default, this cycle will throw an exception in VB (since the last iteration of the cycle goes beyond the <code>Byte</code> boundary. But with the overflow check turned off, it loops because after 255 i becomes 0 again. <br>  Underflow is the opposite situation, when subtraction is lower than the minimum for the type of value leads to the maximum value. <br><br>  A more common situation for overflow is simply the addition of two numbers.  Take the numbers 130 and 150, both as <code>Byte</code> .  If you fold them, the answer will be 280, which does not fit into Byte.  But your processor perceives it is not.  Instead, he reports that the answer is 24. <br><br>  By the way, this has nothing to do with transformations.  Adding two bytes gives bytes;  it's just the way binary mathematics works.  Although you can also get an overflow by doing the conversion, for example, when you try to convert Long to Integer.  Without an overflow check, the program simply cuts off the extra bits and stuffs as much as it fits into this variable. <br><br>  <b>What is the difference?</b>  Performance.  An overflow CLR check requires a little more computational time than the unchecked option, like all other security checks.  VB is based on the philosophy that developer productivity is more important than computing performance, so by default you have security checks enabled.  The C # development team <i>today can</i> make a different decision on the default settings of the project, but when you consider that the first C # developers came from C / C ++ developers, this group of people would probably require the code to do nothing extra that could cost processor cycles ;  <b>This is not a simple philosophical difference</b> . <br><br>  <b>Nuance:</b> even if overflow / underflow checking is disabled, converting <code>PositiveInfinity</code> , <code>NegativeInfinity</code> , <code>NaN</code> <code>Single</code> or <code>Double</code> to <code>Decimal</code> values ‚Äã‚Äãwill throw an exception, since none of these values ‚Äã‚Äãcan in principle be represented in Decimal. <br><br><a name="section37"></a><h3>  37. Converting floating-point numbers to integer types uses banking rounding (bankers rounding) rather than truncating </h3><br>  If you convert the number 1.7 into an integer in VB, the result will be 2. In C #, the result will be 1. I cannot say anything about the mathematical rules outside of America, but I go round from real number to integer instinctively.  And none of those whom I know outside the circle of programmers consider that the closest integer to 1.7 is 1. <br><br>  In fact, there are several rounding methods, and the type of rounding used in VB (and in the Math.Round method) is by default called bank rounding or statistics rounding.  Its essence is that for a number in the middle between two integers, VB rounds to the nearest even number.  So 1.5 is rounded up to 2, and 4.5 is rounded up to 4. What actually works is not the way we were taught in school - I was taught to round up from 0.5 (technically, round off from zero).  But, as the name implies, banking rounding has the advantage that with a large number of calculations, you divide by rounding in half, rather than always distributing or always holding money.  In other words, on a large set, this limits the distortion of data to the limiting statistical deviation. <br><br>  <b>Where does the difference come from?</b>  Rounding is more intuitive and practical, truncation is faster.  If you consider using VB in LOB applications and especially in applications such as Excel macros running on VBA, simply dropping the numbers after the comma can cause ... problems. <br><br>  I think it is obvious that the method of transformation is always an ambiguous question and should be explicitly stated, but if you need to choose a single ... <br><br><a name="section38"></a><h3>  38. It is not an error to convert NotInheritable classes to / from interfaces that they do not implement at compile time. </h3><br>  Generally speaking, if you check a NonInheritable class for an interface implementation, you can understand at compile time whether such a transformation is possible, because you know all the interfaces of this type and all its basic types.  If the type is inheritable, you cannot be sure that such a conversion is impossible, because the type of the runtime object referenced may actually have a more derived type that implements this interface.  However, there is an exception due to COM interop, when at compile time it may not be visible that the type has anything to do with the interface, but at runtime it will be so.  For this reason, the VB compiler issues a warning in such cases. <br><br>  <b>Why?</b>  VB and COM grew up together at a time when they were children in the old district.  So in language design there are several solutions in which VB pays great attention to things that existed only in COM at the time of the release of .NET 1.0. <br><br><a name="section39"></a><h3>  39. Attempting to unpack (unbox) null to a meaningful type results in a default type value, not NullReferenceException. </h3><br>  I suppose that technically this is also true for reference types, but yes: <br><pre> <code class="vbscript hljs"><span class="hljs-built_in"><span class="hljs-built_in">CInt</span></span>(CObj(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  <b>Why?</b>  Because <code>CInt(Nothing) = 0</code> , and the language tends to be somewhat consistent, regardless of whether you typed your variables or not.  This applies to any structure, not just built-in significant types.  See the <a href="https://habr.com/ru/company/jugru/blog/443684/">rationale at # 25</a> for more details. <br><br><a name="section40"></a><h3>  40. Unboxing supports primitive type conversions. </h3><br>  Both in VB and in C # you can convert <code>Short</code> to <code>Integer</code> , but what if you try to convert packed <code>Short</code> to <code>Integer</code> ?  In VB <code>Short</code> will be unpacked first and then converted to an <code>Integer</code> .  In C #, if you do not manually decompress short before converting to an <code>int</code> , an <code>InvalidCastException</code> will be thrown. <br>  This applies to all internal transformations, that is, packed numeric types, conversions between strings and numeric types, strings and dates (yes, Decimal and Date are primitive types). <br><br>  <b>Why?</b>  Again, to ensure consistent behavior, whether your program is completely strongly typed, typed as Object, or is in the process of refactoring from one variant to another.  See <a href="https://habr.com/ru/company/jugru/blog/445364/"># 39</a> above. <br><br><a name="section41"></a><h3>  41. There are conversions between <code>String</code> and <code>Char</code> </h3><br><ul><li>  <code>String</code> converted to a <code>Char</code> representing its first character. </li><li>  <code>Char</code> converted to <code>String</code> only reasonable way. </li></ul><br>  Because no one except me remembers the syntax of a character literal in VB (and should not). <br><br><a name="section42"></a><h3>  42. There is a conversion between <code>String</code> and <code>Char</code> array </h3><br><ul><li>  <code>String</code> converted to a <code>Char</code> array, consisting of all its characters. </li><li>  The <code>Char</code> array is converted to a <code>String</code> consisting of all its elements. </li></ul><br>  For definiteness: these transformations create new objects, you do not get access to the internal structure of the <code>String</code> . <br><br>  <b>Funny story:</b> I once found (or perhaps it was reported, and I researched) breaking change between .NET 3.5 and 4.0, because between these versions, the .NET team added the <code>ParamArray</code> modifier to the second overload parameter <code>String.Join</code> , which accepts an array of strings .  The exact preconditions are lost in time (probably for the better), but, as I believe, the reason is that with the <code>ParamArray</code> modifier you can now convert the <code>Char</code> array into a string and pass it as a separate element to the parameter array.  A fun theme. <br><br><a name="section43to44"></a><h3>  43 and 44. Conversions from String to numeric and date types support the syntax of literals (as a rule) </h3><br><ul><li> <code>CInt("&amp;HFF") = 255</code> </li> <li> <code>CInt("1e6") = 1_000_000</code> </li> <li> <code>CDate("#12/31/1999#") = #12/31/1999#</code> </li> </ul><br>  It works with base prefixes and makes it possible to use a very convenient way to convert hexadecimal (or octal) input to a number: <code>CInt("&amp;H" &amp; input)</code> .  Unfortunately, this symmetry is degrading at the time of this writing, because the VB runtime has not been updated to support the binary prefix &amp; B or the digit <code>1_000</code> , but I hope this will be fixed in the next version.  Scientific notation works, but without type suffixes, and date conversions also support standard date formats, so the JSON format used in ISO-8601 also works: <code>CDate("2012-03-19T07: 22Z") = #3/19/2012 02:22:00 AM#</code> . <br><br>  <b>Why?</b>  I do not know any other reason than convenience.  But I would <i>really</i> like to offer support for other common formats that are almost ubiquitous today, such as # FF, U + FF, 0xFF.  I think it could make life much easier in some types of applications ... <br><br><a name="section45"></a><h3>  45. NO conversion between <code>Char</code> and integer types </h3><br>  <b>WHAT?!?!?</b> <br>  After reading about all these additional conversions, are you surprised?  In VB, conversions between <code>Char</code> and <code>Integer</code> are prohibited: <br><br><ul><li>  <code>CInt("A"c)</code> not compiled. </li><li>  <code>CChar(1)</code> not compiled. </li></ul><br>  <b>Why?</b>  It is unclear what should happen.  Usually VB in such situations uses a pragmatic and / or intuitive approach, but for expressing <code>CInt("1")</code> I think half of the readers would expect the number 1 (character value 1), and half would expect the number 49 (ASCII / UTF code for character 1).  Instead of making the wrong choice in half the cases, VB has special functions for converting characters to ASCII / Unicode codes and vice versa, <code>AscW</code> and <code>ChrW</code> respectively. <br><br><h2>  Expressions </h2><br><a name="section46"></a><h3>  46. ‚Äã‚ÄãNothing &lt;&gt; null </h3><br>  The literal <code>Nothing</code> in VB does not mean <i>null</i> .  It means <i>‚Äúthe default value for the type for which it is used,‚Äù</i> and it just so happens that for reference types, the default value is null.  The difference matters only when used in a context in which: <br><br><ol><li>  Nothing takes on a significant type, and ... </li><li>  From the context it is not clear that he does it. </li></ol><br>  Let's look at a few examples that illustrate what that means. <br><br>  The first one is perhaps a bit strange, but I don‚Äôt think that most people will be blown away by the brain with the understanding that this program will print ‚ÄúTrue‚Äù: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> i = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"True"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="https://gist.github.com/AnthonyDGreen/7a54bafdcd5bf604b5bcefd5705c5300">source code on github</a> <br><br>  The reason is quite simple: you compare <code>Integer (0)</code> with the default value of its type (also 0).  The problem occurs in VB2005 / 2008 when you add nullable meaningful types.  Take a look at this example: <br><br><pre> <code class="vbscript hljs"> Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">False</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="https://gist.github.com/AnthonyDGreen/f319719cb13ec4e0803aec7b361f0e39">source code on github</a> <br><br>  It is clear how someone can assume that type <code>i</code> is an <code>Integer?</code>  ( <code>Nullable(Of Integer)</code> ).  But this is not the case, because <code>Nothing</code> gets the type out of context, and the only type in this context comes from the second operand, and this is a simple <code>non-nullable Integer</code> (technically, <code>Nothing</code> never has a type).  Another way to look at this problem is the following example: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() M(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M(i As Integer) Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Non-nullable"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M(i As Integer?) Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Nullable"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="">source code on github</a> <br><br>  Again, here it seems intuitively that <code>Nothing</code> adds a ‚Äúnullable‚Äù hint and that the language will choose an overload that accepts <code>nullable</code> , but it does not (selects <code>non-nullable</code> because it is ‚Äúmost specific‚Äù).  At a minimum, it can be assumed that, like null in C #, the expression <code>Nothing</code> does not apply to <code>Integer</code> , and that the nullable overload will be chosen by the elimination method, but this is again based on the incorrect thought that <code>Nothing = null (Is null?)</code> . <br><br>  <b>Nuance:</b> a new expression has been added to C # 7.1, which corresponds to <code>Nothing</code> in VB.  If you rewrite all three examples above in C # using <code>default</code> instead of <code>null</code> , <b>you will get exactly the same behavior</b> . <br><br>  What can be done about this?  There are several offers, but none have won yet: <br><br><ul><li>  Show a warning every time <code>Nothing</code> converted to a significant type and it is not <code>null</code> in a <code>nullable</code> significant type. </li><li>  Nicely expand <code>Nothing</code> to <code>0</code> , <code>0.0</code> , <code>ChrW(0)</code> , <code>False</code> , <code>#1/1/0001 12:00:00 AM#</code> <code>ChrW(0)</code> <code>#1/1/0001 12:00:00 AM#</code> or <code>New T</code> (the default value for any structure) each time its value in runtime will be one of listed above. </li><li>  Add a new syntax meaning "Null, no, really!", Like <code>Null</code> or <code>Nothing?</code> </li><li>  Add a new syntax as a suffix (?) That wraps the value in nullable to help infer a type, for example <code>If(False, 0?, Nothing)</code> </li><li>  Add nullable conversion operators for built-in types to make it easier to give hints to the type of output, for example, <code>If (False, CInt? (0), Nothing)</code> </li></ul><br>  I would like to hear your thoughts in the comments and / or <a href="https://twitter.com/ThatVBGuy">on Twitter</a> . <br><br>  So let's summarize: <br><br><ul><li>  Old times - VB6 and VBA have ‚ÄúNothing‚Äù, ‚ÄúNull‚Äù, ‚ÄúEmpty‚Äù and ‚ÄúMissing‚Äù, meaning different things. </li><li>  2002 - in VB.NET there is only <code>Nothing</code> (the default value in a specific context), and in C # it is only <code>null</code> . </li><li>  2005 - C # adds <code>default(T)</code> (the default value of type <code>T</code> ), because newly added generics create a situation where you need to initialize a value, but you don‚Äôt know if it is a reference type or meaningful;  VB does not do anything, because this script is already closed <code>Nothing</code> . </li><li>  2017 - C # adds <code>default</code> ( <code>default</code> value in context), since there are many scripts in which specifying <code>T</code> redundant or impossible </li></ul><br>  VB continues to resist the addition of a <code>Null</code> (or equivalent) expression because: <br><br><ul><li>  The syntax will be breaking change. </li><li>  The syntax will not be breaking change, but depending on the context will mean different things. </li><li>  The syntax will be too subtle (for example, <code>Nothing?</code> );  Imagine talking loudly about <code>Nothing</code> and <code>Nothing?</code>  to explain something to a person. </li><li>  The syntax may be too ugly (for example, <code>Nothing?</code> ). </li><li>  The null value expression script is already closed to <code>Nothing</code> , and this function will be completely redundant most of the time. </li><li>  Everywhere, all documentation and instructions should be updated to recommend the use of the new syntax, basically declaring <code>Nothing</code> obsolete for most scenarios. </li><li>  <code>Nothing</code> and <code>Null</code> will still behave the same at runtime for late binding, transforms, etc. </li><li>  It can be like a cannon in stabbing. </li></ul><br>  Something like this. <br><br>  <b>Offtop (but related)</b> <br><br>  Here is an example, very similar to the second one above, but with no type output: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer? = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">False</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="">source code on github</a> <br><br>  This program displays 0. It behaves exactly the same as the second example, for the same reason, but it illustrates a separate, albeit related problem.  Intuitively, what is <code>Dim i as Integer? = If(False, 1, Nothing)</code>  <code>Dim i as Integer? = If(False, 1, Nothing)</code> behaves the same as <code>Dim i As Integer? : If False Then i = 1 Else i = Nothing</code>  <code>Dim i As Integer? : If False Then i = 1 Else i = Nothing</code> .  In this case, this is not the case because the conditional expression <code>(If)</code> does not ‚Äúflow‚Äù (flow through) finite-type information to its operands.  It turns out that it breaks all expressions in VB that rely on what is called finite (contextual) typing ( <code>Nothing</code> , <code>AddressOf</code> , an array of literals, lambda expressions, and interpolated strings) with problems ranging from non-compilability in general to silently creating incorrect values ‚Äã‚Äãand to loud throwing exceptions.  Here is an example of a non-compiled version: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer? = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">False</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> operation As Func(Of Integer, Integer, Integer) = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">True</span></span>, AddressOf Add, AddressOf Subtract) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Add(<span class="hljs-built_in"><span class="hljs-built_in">left</span></span> As Integer, <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> As Integer) As Integer Return <span class="hljs-built_in"><span class="hljs-built_in">left</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Subtract(<span class="hljs-built_in"><span class="hljs-built_in">left</span></span> As Integer, <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> As Integer) As Integer Return <span class="hljs-built_in"><span class="hljs-built_in">left</span></span> - <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="">source code on github</a> <br><br>  This program will not compile.  Instead, it reports an error in an <code>If</code> statement that it cannot determine the type of the expression when both <code>AddressOf</code> expressions <code>AddressOf</code> intended to receive <code>Func(Of Integer, Integer, Integer)</code> delegates <code>Func(Of Integer, Integer, Integer)</code> . <br><br>     ,     <code>Nothing</code>    null (), <code>Nothing</code>    <code>nullability</code> ()  <code>If(,,)</code>       <code>Nothing</code> (  ) () ‚Äî    ,    <b></b>  . <br><br><a name="section47"></a><h3> 47.       ;      </h3><br>      ¬´3¬ª: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer = <span class="hljs-number"><span class="hljs-number">3</span></span> M((i)) Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M(<span class="hljs-keyword"><span class="hljs-keyword">ByRef</span></span> variable As Integer) variable = -variable <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="">   GitHub</a> <br><br>    C#  ¬´-3¬ª.   ,   VB           ‚Äî ,   <i></i> .       ,      <code>M(3)</code> ,   <code>M(i)</code> ,      <code>i</code>  ,       .  C#     (  )      ,    M   . <br><br>  <b>Why?</b>  VB <i></i>   .          Quick Basic (Copyright 1985),     .   ,  <i>  </i>     2002 ,     . <br><br> <b> ‚Ññ1:</b> <a href="http://www.panopticoncentral.net/2003/09/16/how-the-subroutine-got-its-parenthesis/">¬´    ¬ª</a>  ,   Visual Basic .NET. <br> <b> ‚Ññ2:</b>        Roslyn ( ,  <i></i>  ( )     (  )),       :         .  C#       ,       <code>((a + b) * c  a + (b * c))</code> . ,    C#,   C++,  ,      ,    ,    .      : ¬´         VB?¬ª  ¬´       C#?¬ª      <a href="http://source.roslyn.io/">source.roslyn.io</a>  ‚Äî <code>BoundParenthesized</code>    VB     C#.  ,   ,      . <br><br><a name="section48"></a><h3> 48. <code>Me</code>     ‚Äî    </h3><br>  VB.NET      <code>Me</code> .     ,  -  ,    ‚Äî    ,     Me       Structure    .        Me      .  C#    <code>this</code>  ,     <code>this</code> <i> </i>    . <br><br><a name="section49"></a><h3> 49.       </h3><br>  VB,               ,             : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> C <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M() Extension() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Extension(c As C) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="">   GitHub</a> <br><br>  C#         (  something.Extension).  ,          C#,         ,   <code>this.Extension()</code> . <br><br>  <b>Why?</b>   ,               <code>'Me.'</code> , ,         , ,         . VB.NET   .     ,      . <br><br><a name="section50"></a><h3> 50.       (Static imports will not merge method groups) </h3><br> VB   ¬´ ¬ª (Java-,   C#   VB).  ,     <code>Imports System.Console</code>     <code>WriteLine()</code>      .  2015  C#    .   VB      Shared-   ,  <code>System.Console</code>  <code>System.Diagnostics.Debug</code> ,      <code>WriteLine</code> ,    . C#       ,     ,     . <br><br>  <b>Why?</b>  ,  ,   VB    ,  C# (   ).    ,                   (      ,  ),  ‚Ä¶   ,          . <br><br>  ,  VB       ,  VB        , ,        ,        ,       ,        ( <a href="https://habr.com/ru/company/jugru/blog/443684/"> #6</a> ). VB   .  , VB      2002 . <br><br><a name="section51to52"></a><h3> 51  52.         (Partial-name qualification &amp; Smart-name resolution) </h3><br>      : <br><br><ul><li>   ,    ‚Äî          (    ).   <code>System</code>  <code>System.Windows.Forms</code> ‚Äî  ,      ,  <code>System</code>   <code>System.Windows</code>  <code>System.Windows</code>   <code>System.Windows.Forms</code> . </li><li>   ,     ,   ,        .   <code>System</code>  <code>Windows</code> ,  <code>Windows</code>  <code>Form</code> . </li></ul><br>  ,  ,           .       .  VB    Imports   ,  <code>using</code>  C#    . <br><br> ,   VB     <code>System</code> ,          <code>System</code> ,      <code>System</code> .     ,    .      ,    <code>ExtensionAttribute</code> ,   <code>&lt;Runtime.CompilerServices.Extension&gt;</code>  <code>&lt;System.Runtime.CompilerServices.Extension&gt;</code> . <br><br>  C#   . <code>using System</code>   <code>System.Threading</code>       <code>Threading</code> . <br><br>    ,   C#          ,       .  ,     <b></b> <code>System</code> ,           <code>System.Threading</code>  <code>Threading</code> .    ,         ,      ,    ,          . <br><br>    ,  ,   VB,  C# ,          <code>Imports</code> / <code>using</code>  , C#     using    ,         ,     using        . <br><br> <b>    (Quantum Namespaces) ( )</b> <br><br>  ,    !  VB ,      .   ,  <code>System</code>    <code>ComponentModel</code>  <code>System.Windows.Forms</code>    <code>ComponentModel</code> ?  <code>ComponentModel</code>  .   ,        <code>ComponentModel.PropertyChangedEventArgs</code> ,     (  ,          ).     <code>System.Windows.Forms</code> (,  ,     ,         ,   ),        (ambiguity errors). <br><br>   VB2015      (Smart Name Resolution),      <code>System</code>  <code>System.Windows.Forms</code>   <code>ComponentModel</code> ,            ,     <code>System.ComponentModel</code>      <code>System.Windows.Forms.ComponentModel</code> ,      .           ,     ,    ,    ,      .     ,  ,     , .. <code>ComponentModel.PropertyChangedEventArgs</code>   <br> <code>System.ComponentModel.PropertyChangedEventArgs</code> ,   <code>System.Windows.Forms.ComponentModel.PropertyChangedEventArgs</code>  .     ,         . <br><br>       ,        <code>Windows</code>   ,       ( )     ( )    ( ).   <code>WinForms/WPF</code>  <code>UWP</code>        . <br><br><a name="section53"></a><h3> 53.  Add       </h3><br>  <a href="https://habr.com/ru/company/jugru/blog/445364/">  #33</a> ,  VB - ,      . ,     , ‚Äî        , : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Contact <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Name As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> FavoriteFood As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> contacts = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Contact) From { {<span class="hljs-string"><span class="hljs-string">"Leo"</span></span>, <span class="hljs-string"><span class="hljs-string">"Chocolate"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Donnie"</span></span>, <span class="hljs-string"><span class="hljs-string">"Bananas"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Raph"</span></span>, <span class="hljs-string"><span class="hljs-string">"The Blood of his Enemies"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Mikey"</span></span>, <span class="hljs-string"><span class="hljs-string">"Pizza"</span></span>} } <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Add(collection As ICollection(Of Contact), name As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, favoriteFood As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) collection.Add(<span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Contact <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.Name = name, .FavoriteFood = favoriteFood}) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/d8a64dd2af8dec46332825a445567c9d">   GitHub</a> <br><br>  C#       ,          Roslyn C#,    .   ,      ( <b></b> ,    ),        VS2015. <br><br><a name="section54"></a><h3> 54.     ,    </h3><br>    ,      VB   <code>Dim buffer(expression) As Byte</code>  <code>Dim buffer = New Byte(expression) {}</code>     <code>expression + 1</code> . <br><br>       Microsoft BASIC,     <code>DIM</code> ( dimension ‚Äî ). ,  , ,    :    0  expression.     Microsoft BASIC          1 (        ,  1984),         (   ),      2002 . <br><br>    ,     -          ,  ,    VB     ,   BASIC   C     ,    ,    C,      C- .   ,   <code>buffer(10)</code>     0  10,    9! <br><br><a name="section55"></a><h3> 55.   VB <s>- </s>    ,        C# </h3><br>            ,   .     ,    VB      ( )     ,     ‚Äî    .    : <br><br><ul><li> <code>CType({1, 2, 3}, Short())</code> <b></b>  <code>CType(New Integer() {1, 2, 3}, Short ())</code> ,     <code>Integer</code>   <code>Short</code> . </li><li> <code>CType({1, 2, 3}, Short())</code>     <code>New Short() {1, 2, 3}</code> .  No spoons. </li></ul><br>      ,   ,     VB   ,        C#. ,  : <br><br><ul><li> <code>Dim empty As Integer() = {}</code> </li> </ul><br>    : <br><br><ul><li> <code>Dim array As Predicate(Of Char)() = {AddressOf Char.IsUpper, AddressOf Char.IsLower, AddressOf Char.IsWhitespace}</code> </li> </ul><br>    (  ): <br><br><ul><li> <code>Dim byteOrderMark As Byte() = {&amp;HEF, &amp;HBB, &amp;HBF} '   </code> . </li></ul><br>          ,    <code>IList(Of T)</code> , <code>IReadOnlyList(Of T)</code> , <code>ICollection(Of T)</code> , <code>IReadOnlyCollection(Of T)</code>  <code>IEnumerable(Of T)</code> ,          ,     ,    <code>ParamArray IEnumerable</code> . <br><br>  <b>Why?</b>      ,            VB.    ,    .       2008  VB  C#         ¬´¬ª {},        -    ( ,  , ). ,      ,       ,          +   ,       .   . <br><br><a name="section56"></a><h3> 56.         </h3><br>      ,     LINQ.        ,    . <br><br>   ,   , <a href="http://www.panopticoncentral.net/2007/05/11/mutable-and-immutable-anonymous-types-and-keys/%2522"></a> . <br><br><a name="section57"></a><h3> 57.  CType,  DirectCast        C# </h3><br>      /  VB  C#. <br> VB <code>CType</code> : <br><br><ul><li>   ; </li><li>    (   ); </li><li>   , , <code>Long</code>  <code>Integer</code> (.  ¬´¬ª); </li><li>  (unboxes)    ; </li><li> <b></b>    ; </li><li> <b></b>    (  <code>CTypeDynamic</code> ). </li></ul><br> VB <code>DirectCast</code> : <br><br><ul><li> <b></b>   ; </li><li>   ; </li><li> <b></b>    (   <code>Integer  Byte</code> ); </li><li>     ; </li><li>     (  ); </li><li> <b></b>   . </li></ul><br>   C# ‚Äî <code>(Type)expression</code> : <br><br><ul><li>   ; </li><li>   ; </li><li>   ; </li><li>     ; </li><li>    ; </li><li>   . </li></ul><br>    <code>CType</code>      C#   ,         .   ,       .  VB  C#     ,                IL   .      <i></i>    ,   C#,          ,           .    . <br><br>  ,    <code>CType</code> ,     (,        ). <code>CType</code>   ,   <code>DirectCast</code> ,   .  ,      ,        IL   :    <code>Object</code> ( <code>ValueType</code> )       CLR ¬´unbox¬ª     VB-,   ,                 (,  <code>Short</code>  <code>Integer</code> ).  ,      ,   C#.           .         ,      . <br><br>  <b>Why?</b>    .     ,   ,   ,    ,    . <br><br><a name="section58"></a><h3> 58.   ¬´¬ª     </h3><br>       ,       ,  <code>5 Mod 2 * 3</code>   5  VB,  ¬´¬ª   C# <code>5 % 2 * 3</code>   3. <br><br>   , ,      .        ,       (,   (\)  VB),    ,           ,    <b>  </b> . <b> !</b> <br><br><a name="section59"></a><h3> 59.   ; +  &amp;     ; +  VB &lt;&gt; +  C# </h3><br>     ,  + ()  &amp; ()  VB       +  C#. <br> <b> <code>String</code>   :</b> <br> <b>VB</b> <br><br><ul><li> ‚Äú1‚Äù + 1 = 2.0 </li><li> ‚Äú1‚Äù &amp; 1 = ‚Äú11‚Äù </li></ul><br> <b>C#</b> <br><br><ul><li> ¬´1¬ª + 1 == ¬´11¬ª </li></ul><br> <b>   ,    +  &amp;</b> <br> <b>VB</b> <br><br><ul><li> ‚Äúobj: ‚Äú + AppDomain.CurrentDomain ' Error: + not defined for String and AppDomain. </li><li> ‚Äùobj: ‚Äú &amp; AppDomain.CurrentDomain ' Error: &amp; not defined for String and AppDomain. </li><li> ‚Äùobj: ‚Äú + CObj(AppDomain.CurrentDomain) ' Exception, no + operator found. </li><li> ‚Äùobj: ‚Äú &amp; CObj(AppDomain.CurrentDomain) ' Exception, no &amp; operator found. </li></ul><br> <b>C#</b> <br><br><ul><li> ¬´obj: ¬ª + AppDomain.CurrentDomain == ¬´obj: ¬ª + AppDomain.CurrentDomain.ToString() </li><li> ¬´obj: ¬ª + (object)AppDomain.CurrentDomain == ¬´obj: ¬ª + AppDomain.CurrentDomain.ToString() </li><li> ¬´obj: ¬ª + (dynamic)AppDomain.CurrentDomain == ¬´obj: ¬ª + AppDomain.CurrentDomain.ToString() </li></ul><br> <b>  :</b> <br> <b>VB</b> <br><br><ul><li> 1 + 1 = 2 </li><li> 1 &amp; 1 = ‚Äú11‚Äù </li></ul><br> <b>C#</b> <br><br><ul><li> 1 + 1 == 2 </li></ul><br> <b>  String  Enum:</b> <br> <b>VB</b> <br><br><ul><li> ‚ÄúToday: ‚Äù + DayOfWeek.Monday ' Exception: String ¬´Today: ¬ª cannot be converted to Double. </li><li> ‚ÄúToday: ‚Äù &amp; DayOfWeek.Monday = ‚ÄúToday: 1‚Äù </li><li> ‚ÄúToday: ‚Äù &amp; DayOfWeek.Monday.ToString() = ‚ÄúToday: Monday‚Äù </li></ul><br> <b>C#</b> <br><br><ul><li> ¬´Today: ¬ª + DayOfWeek.Monday == ¬´Today: Monday¬ª </li></ul><br> <b> :</b>    ,  +         VB,   -  . +   ,        ,   - .  Why?  Because: <br><br><ul><li> ‚Äú10‚Äù ‚Äî ‚Äú1‚Äù = 9.0, </li><li> ‚Äú5‚Äù * ‚Äú5‚Äù = 25.0, </li><li> ‚Äú1‚Äù &lt;&lt; ‚Äú3‚Äù = 8,  </li><li> ‚Äú1‚Äù + 1 = 2.0,  </li><li> ‚Äú1‚Äù + ‚Äú1‚Äù = ‚Äú11‚Äù </li></ul><br>        .   ‚Äî    . <br><br> <b>:</b>   +,    <i></i>    .     ,  &amp;,      ,     ( <b></b> ,   ).  ,      ,          . <br><br><a name="section60"></a><h3> 60.   : 3 / 2 = 1,5 </h3><br>       ‚Äî       : <i>¬´     ?¬ª</i> .    ¬´¬ª.           : <i>¬´ .      ?¬ª</i> <br>        VB  C#. <br><br>       C, ,  ,     <i>¬´  5    9?¬ª</i> ,     \.   ,  ,   ,       ,     0 (   ,   -   <code>INumeric</code> ). <br><br><a name="section61"></a><h3> 61. ^   <code>Math.Pow</code> </h3><br>        <code>Math.Pow</code> .   ,         .  ,    ( <code>custom</code> )      (  , <code>System.Numerics.BigInteger</code> ). <br><br> <b>:</b> F#        **,     VB  F#   : <code>op_Exponent</code>  <code>op_Exponentiation</code> .  F#      <code>Pow</code>   .         .  ,       . <br><br><a name="section62"></a><h3> 62.  =/&lt;&gt;    /  </h3><br>  C# '=='   ()  ,   ,      (          ).  VB        . VB    ( <code>Is/IsNot</code> )   . <br><br> <b> :</b>  -    Roslyn     ,     .         .          .   VB        ,   =   ,    C#  ,     ,       ,        . <br><br><a name="section63"></a><h3> 63.  =/&lt;&gt;    (       ) </h3><br>    VB    . <br><br> -,      (  )  - (  ),   ,        <code>Option Compare Binary</code>  <code>Option Compare Text</code> . <code>Option Compare Binary</code> , ,         VS. <br><br>          (   ),    ,    <i></i>  API.  : <br><br><ul><li> /: ‚ÄúA‚Äù = ‚Äúa‚Äù/‚ÄúA‚Äù &lt;&gt; ‚Äúa‚Äù </li><li> : ‚ÄúA‚Äù &gt; ‚Äúa‚Äù </li><li>  <code>Select Case: Select Case ‚ÄúA‚Äù : Case ‚Äúa‚Äù</code> </li></ul><br>  : <br><br><ul><li>  <code>Equals: ‚ÄúA‚Äù.Equals(‚Äúa‚Äù)</code> </li><li>  <code>Contains: ‚ÄùA‚Äù.Contains(‚Äúa‚Äù)</code> </li><li>   <code>Distinct: From s In {‚ÄúA‚Äù, ‚Äúa‚Äù} Distinct</code> </li></ul><br>    ,    ,    :   VB      .  ,    <code>Option Compare</code> ,    ¬´Empty¬ª. <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> s As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> s = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Empty"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="">   GitHub</a> <br><br>    s = ""  VB ‚Äî    <code>String.IsNullOrEmpty(s)</code> . <br>  ,          ,     ,  ,        ,  .       ,      ,       . <br><br>  <b>Why?</b>   <code>Option Compare Text</code>    ,   ,    .   ,   ,       . <br>   ,   ,    ,  ,     . <br><br>  ,   ,     .   ,          . ,   ,    (collation)     SQL Server,      .   ,   VB      VB6,   VBA   Office,   Excel  Access,  VBScript  Windows,   -,  -‚Ä¶         .   ,  ,  .NET API     ,    Option Compare Text,        .    ,      .NET API,            . <br><br>   null,    ,    .  VB6    .     <code>String</code>  "".  , VB           <code>String</code>   .            VB,   <code>Left</code>  <code>Mid</code> ,   <code>String</code> .     null   .   <code>Len(CStr(Nothing)) = 0</code>  <code>Left(CStr(Nothing)</code> , <code>5) = ""</code> ,  <code>CStr(Nothing).Length</code>  <code>CStr(Nothing).Trim()</code>  . <br><br>  ,           <code>?</code>  . (       ). <br><br> <b>  :</b> <br>      ,     ,       ,        .   !    VB   ,   ,    <code>"String A" = "String B"</code> ,     <code>Microsoft.VisualBasic.CompilerServices.Operators.CompareString</code> ,         -    ,         ,     .     LINQ-      .      ,         VB (     ).   ,        ,  -    ,    .    LINQ-to-SQL, LINQ-to-Entities   ,         Microsoft.   ,   VB    ,  ! <br><br>    ,        C#,       VB,  LINQ   .  : 1)  ,  VB   ,   ,  2)  ,  VB  ,   ,     LINQ-.   ,      VB (). <br><br> <b>:</b>  ,    ¬´  API¬ª.   <code>Option Compare</code>           VB,   <code>InStr.Replace</code>     <code>Microsoft.VisualBasic.Strings</code> .  ,          ? <br><br> ,  ,                 ,    ? ,  ,     ,        :   ,      ,   . <br><br><a name="section64"></a><h3> 64. Nullable      ( null   ) </h3><br> VB  C# -  nullable.  ,     (null-propagation). <br><br>      SQL, , ,      null.   ,      (, +),         null,      null.    <code>"?."</code> :    <code>obj?.Property obj</code>  null,       null,   . <br><br>   nullable       ,  VB,  C#  .     -   :  . <br><br>  VB,     nullable  ,      null,     null   .   1 + null  null  null + null  null.        ,      (, =  &lt;&gt;)      C#: <br><br><ul><li>    VB,  <code>Is/IsNot</code> ,  <code>Boolean?</code> </li><li>    C# (==, !=, &gt;, &lt;, &gt;=, &lt;=)  <code>bool</code>  <code>bool?</code> </li></ul><br>  VB (    nullable  )  null     <b> null</b> .     <code>Boolean</code>  =  <code>Boolean?</code> ,     <code>True</code> , <code>False</code>  <code>null</code> .   <a href="https://en.wikipedia.org/wiki/Three-valued_logic"> </a> .  C#    <code>non-nullable bool</code> ,    <a href="https://en.wikipedia.org/wiki/Principle_of_bivalence"> </a> . <br><br>  ,    <b></b> .      null.    VB <b>NULL</b> = <b>NULL</b> ‚Äî  <b>NULL</b> ,   TRUE. <br> ,      : <br><img src="https://habrastorage.org/webt/rv/79/03/rv7903incqlt1soaqgm9dnxravg.png"><br>    . <b>Null  ,   ,    ,      <u></u>    C#</b> . <br><br>     .   C#   VB,      <i>¬´    null?¬ª</i>  C# <code>(if (value == null))</code>    .  VB   ,   VB        (=/&lt;&gt;)     <code>(Is/IsNot)</code> ,         VB <code>Is Nothing</code>   <code>non-nullable Boolean</code> . <br><br>      ,    VB    null,     null.     <code>And/AndAlso</code>  <code>Or/OrElse</code> . <br><br>     <code>Integer?</code> (  ),  VB,  C#  null,    : <br><br><ul><li> 1 AND NULL  NULL </li><li> 1 OR NULL  NULL </li></ul><br>     <code>Boolean?</code> ,  VB  . <br><br><ul><li> FALSE AND NULL  FALSE </li><li> TRUE OR NULL  TRUE </li><li> TRUE AND NULL  NULL </li><li> FALSE OR NULL  NULL </li></ul><br>  , <b>  <code>True/False</code>        ,    , <u></u>     null.</b>   ,      <code>AndAlso</code>  <code>OrElse</code>   . <br><br>  C#         (&amp;&amp;/||)   (&amp;/|)   <code>nullable boolean (bool?)</code> .    ,    ,       non-nullable boolean   nullable boolean         . <br><br> <b>   ?</b> <br>   VB  ,  -   : <br><br><pre> <code class="vbscript hljs">Imports System.ComponentModel <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> BindableRange Implements INotifyPropertyChanged <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> _EndDate As <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>? <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> EndDate As <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>? <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> Return _EndDate <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>(value As <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>?) <span class="hljs-comment"><span class="hljs-comment">' This line here: If value = _EndDate Then Return _EndDate = value RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(NameOf(EndDate))) End Set End Property Public Event PropertyChanged As PropertyChangedEventHandler _ Implements INotifyPropertyChanged.PropertyChanged End Class Module Program WithEvents Range As New BindableRange Sub Main() Range.EndDate = Today Range.EndDate = Today Range.EndDate = Nothing Range.EndDate = Nothing End Sub Private Sub BindableRange_PropertyChanged(sender As Object, e As PropertyChangedEventArgs) _ Handles Range.PropertyChanged Console.WriteLine(e.PropertyName &amp; " changed.") End Sub End Module</span></span></code> </pre> <br> <a href="https://gist.github.com/AnthonyDGreen/a4fa8cfc17373c6021df8b30d7436123">   GitHub</a> <br><br> , , , ,     ¬´EndDate change¬ª    . ,  ,  <b> VB null    </b> ?      ,    <code>EndDate</code> ,       ,      ,      <code>Nothing</code> . <br><br>     VB  : <i>¬´,  ,   .   ¬ª</i> : <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> value &lt;&gt; _EndDate <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> _EndDate = value RaiseEvent PropertyChanged(<span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> PropertyChangedEventArgs(NameOf(EndDate))) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span></code> </pre> <br> <b>    !</b>           .     ,     <b>  non-nullable   </b> .     , <b>   </b> .   ,   : <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> AndAlso _EndDate <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> value &lt;&gt; _EndDate <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return</code> </pre> <br> <b>     ?</b> <br>  ,   C#      ,         VB.     (  nullable  ,    ),         ,    null. <br><br>      null ‚Äî  <b>  ¬´¬ª  ¬´ ¬ª</b> .         . <br><br>     <b>null  ¬´ ¬ª  ¬´¬ª</b> .   ,     ,    :          comparer,   ,    comparer  .        Roslyn,         <code>Optional(Of T)</code> ,         ,        ,     null,  ,     . <br><br>      , NULL  ¬´ ¬ª,      VB  : <br><br><ul><li>    , <b>¬´ ,   ?¬ª</b>     ¬´  ¬ª. </li><li> : <i>¬´       ,      ?¬ª</i> ¬´  ¬ª. </li></ul><br> , ,    <b>     SQL- </b> .  ,     NULL  SQL   ,     NULL.        . ,     ,   NULL    .   ,       .     ,      ,   ( ).   ,       ,          ,     ,   ,   NULL   ,     SQL ( ). <br><br>     VB. <b>      nullable    2008 ,   VB      ?</b> <br> LINQ to SQL <br><br>  VB     ,  , ,   ,  ,    ,     LINQ-     .     ! <br><br>   .  SQL Server,   ,   <a href="https://docs.microsoft.com/en-us/sql/t-sql/statements/set-ansi-nulls-transact-sql%3Fview%3Dsql-server-2017">SET ANSI_NULLS OFF</a> ,   SQL-      C#,      <code>WHERE Column = NULL</code> . , ,        OFF (       ).       SQL Server (  )  .  : <i>¬´    ?   .    ,      -  Option ANSI_NULLS Off  VB.NET?¬ª</i> .         : <br><br><img src="https://habrastorage.org/webt/-q/hc/zl/-qhczlj3yptkha7zt5oz5_4mfi0.png"><br><br> ,      ,     ,    ,   ,  SQL Server,     VB. <br>  Something like this. <br><br><a name="section65"></a><h3> 65.      1:1 </h3><br>  ,  VB    ,       , ,    .       VB  -   ,    . <br><br> ,  ,        , ,          .    VB    ,    ,      ,    ,    , VB     . <br><br>  9.8.4      . <br><br><a name="section66"></a><h3> 66. Function() a = b   () =&gt; a = b </h3><br>        .    ,   <code>() =&gt; expression</code>  C#    <code>Function() expression</code>  VB.   <code>Function()</code>    -,  - ,       VB.       <code>a = b</code>    ,   <code>a</code>  <code>b</code> ( <code>Boolean</code> ),    <code>b</code>  <code></code> .  -   (delegate relaxation) VB       ( -)   Sub- (   ).         .   <code>() =&gt; a = b</code>  C#  VB ‚Äî  <code>Sub() a = b</code> .   ‚Äî  - <b></b> ,             . <br><br>    =,   ,   .    (  <code>Sub</code> -)   ,    (  <code>Function</code> -)   . <br><br><a name="section67"></a><h3> 67.  <code>Async Function</code>       <code>async void</code> </h3><br>  C#   <code>async</code> -,     ,  ,    <code>Task</code>  <code>void</code> ,        ,  <code>Task</code> ,   . <br><br>  VB.NET   , ..  <code>void Async</code>    <code>Async Sub</code> ,   <code>Task</code>  <code>Task(Of T)</code> ‚Äî   <code>Async Function</code> .   ,   ,     VB,   (relaxing) <code>Task Async</code>   <code>void</code>        .   <b></b>     <code>Async Sub</code> ,       ,    . <br><br><a name="section68"></a><h3> 68.   ()  VB </h3><br>     ,      VB: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Foo <span class="hljs-comment"><span class="hljs-comment">'Function [Select](Of T)(selector As Func(Of String, T)) As Foo ' Return Me 'End Function Function Where(predicate As Func(Of String, Boolean)) As Integer Return 0 End Function End Class Module Program Sub Main() Dim c As New Foo Dim q = From x In c Where True Select x End Sub End Module</span></span></code> </pre> <br> <a href="">   GitHub</a> <br><br>         VB,  <i></i>  C#. -,  <code>Foo</code>    <code>Select</code> ,         ,          <code>Where</code> .      <code>Select</code> ,    ,      <code>Select</code> ,   <code>Integer</code>      .   C#     ,        <code>.Where</code> ( <code>Select</code> ).        ,    ,   . <br><br>            LINQ  API.  ,     VB  C#, .  ,  C#   ,      ¬´ ¬ª,  ,              ,       ,   .  -   ,   ¬´¬ª  ,     ,      -. <br><br>   ,  VB    <b></b>        ,        ,  C#          ,     . <br><br>  ,      Roslyn, : <b>¬´    (range variables)?¬ª  ¬´     ?¬ª</b> .        . ,  VB      ,     <code>Let</code> ,   C# ‚Äî .      ,         VB,    C# 2012   ,   : <br><br><pre> <code class="vbscript hljs">using System; using System.Collections.Generic; using System.Linq; using System.Text; namespace CSharpExamples { struct Point { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> X { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { return <span class="hljs-number"><span class="hljs-number">0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> Y { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { return <span class="hljs-number"><span class="hljs-number">0</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Foo { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IEnumerable&lt;Point&gt; <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>&lt;T&gt;(Func&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>, T&gt; selector) { return <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } } static <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Program { static void Main(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>[] args) { var c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Foo(); var q = from X <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Y = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> Y.CompareTo(<span class="hljs-number"><span class="hljs-number">-1</span></span>); } } }</code> </pre> <br> <a href="">   GitHub</a> <br><br>  ,    ‚Äî ?    X,   ‚Äî <code>string</code> .   <code>let</code>     <code>Y</code> ,     string.         ,      Point,     <code>X</code>  <code>Y</code>    ,     ,     <code>int</code>      <code>X</code>  <code>Y</code> , ¬´¬ª  .        <code>Y</code>   <code>select</code> ,    <code>int</code>   <code>int</code> `,  ‚Ä¶ . <br><br>      ,   <i>¬´        ?¬ª</i> .  VS2015  C#  ,   ¬´¬ª.   ,  Roslyn         C#,       .          ,          (  ,   ),    -  . <br><br>  <b>Why?</b>                     ,    ,    ,      .   ,         ,   VB  C#          . <br><br><a name="section69to70"></a><h3> 69  70.  <code>As</code>   <code>From</code>    <code>cast</code> ;     <code>'As'</code>      </h3><br> (     , ‚Ä¶) <br><br>    <code>From x As Integer In y</code>  VB,      ,   <code>from int x in y</code>  C#. <br><br> -,  C#     ,    ( )  .    <code>.Cast&lt;T&gt;()</code> .  VB      ,    ,  ,       ,   . <br><br> -,    ,      <code>.Cast</code> (   ).      ,      ,       ,       <code>.Cast</code>  <code>.Select</code> . <br><br>  <b>Why?</b>  No idea.   VB  . ,    <code>For Each x As T In collection</code> ,  <code>As T</code>          .      <code>From</code>   <code>As</code>    <code>For Each</code> ( ,    <code>As</code> ). <br><br><a name="section71to75"></a><h3> 71-75.  <code>Select</code>   ,     ,                </h3><br>  For example: <br><br><ul><li> <code>From x In y Where x &gt; 10</code> .   ,  <code>Select</code> . </li><li> <code>From x In y Select x Where x &gt; 10</code>  . </li><li> <code>From x In y Select x</code>      ,   <code>From x In y Select x = x</code> ,  <code>x</code>  ‚Äî       <code>x</code> ,  <code>x</code>  ‚Äî       <code>Select</code> .  <code>Select</code>  <code></code>    . </li><li> <code>From x In y Select z = x.ToString()</code> ,  <code>x</code>  . </li><li> <code>From x In y Select x.FirstName</code>      ,   <code>From x In y Select FirstName = x.FirstName</code> . </li><li> <code>From x In y Select x.FirstName, x.LastName</code> ‚Äî   <code>From x In y Select New With {x.FirstName, y.LastName}</code> ,   ,       .               <code>IEnumerable(Of $AnonymousType$)</code> ,         . </li></ul><br>  <b>Why?</b>    ( <a href="https://twitter.com/amandaksilver">Amanda Silver</a> ).    ! <br><br><ul><li>  ,  <code>Select</code>    ,      SQL  ,  <code>Select</code>   ,       .      LINQ  VB       Select ,   SQL,        From   . </li><li>  ,     ,      . </li><li>  ,     <code>Select</code>   ,        SQL,       - -        .   VB     comma separated ( )  -. </li><li>  ,  <code>Select</code>   ,       ,     ,    ,  ,     ,          ,         ‚Äî   . </li></ul><br> <b>   ?</b>  ,   ,  - ,         ,  : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> numbers = {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>} <span class="hljs-comment"><span class="hljs-comment">' BC36606: Range variable name cannot match the name of a member of the 'Object' class. Dim q = From n In numbers Select n.ToString() End Sub End Module</span></span></code> </pre> <br> <a href="">   GitHub</a> <br><br> <code>BC36606: Range variable name cannot match the name of a member of the 'Object' class</code>  <code>BC30978: Range variable '‚Ä¶' hides a variable in an enclosing block or a range variable previously defined in the query expression</code> ‚Äî             ,     <code>Object</code> ,        ,   ,     ,   .       ( <code>n.ToString()</code> ),      .   ,            . <br><br><a name="section76"></a><h3> 76+.       </h3><br>        . ‚Ä¶  ‚Ä¶ . ‚Ä¶  20-25     ( <i>       ‚Äî ..</i> ). <br><br><blockquote>  Minute advertising. 15-16   -    .NET- <a href="https://dotnext-piter.ru/%3Futm_source%3Dhabr%26utm_medium%3D445364">DotNext 2019 Piter</a> .   ,       .       ,      .     <a href="https://dotnext-piter.ru/%3Futm_source%3Dhabr%26utm_medium%3D445364">  </a>  <a href="https://dotnext-piter.ru/registration/%3Futm_source%3Dhabr%26utm_medium%3D445364"> </a> . </blockquote></div><p>Source: <a href="https://habr.com/ru/post/445580/">https://habr.com/ru/post/445580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445562/index.html">Bloomberg: McDonald's will buy a personalization technology developer for $ 300 million</a></li>
<li><a href="../445566/index.html">Published a bill on digital profiles of Russians</a></li>
<li><a href="../445568/index.html">Remote monitoring and management of devices based on Linux / OpenWrt / Lede through the 80th port ...</a></li>
<li><a href="../445570/index.html">Event digest for HR-specialists in the field of IT for April 2019</a></li>
<li><a href="../445572/index.html">The US government plans to send people to the moon after 5 years</a></li>
<li><a href="../445582/index.html">CRM-systems: protection or threat?</a></li>
<li><a href="../445584/index.html">OS1: primitive kernel on Rust for x86. Part 2. VGA, GDT, IDT</a></li>
<li><a href="../445586/index.html">Android Academy in Moscow - talk about how it was and share course materials</a></li>
<li><a href="../445588/index.html">3D scanning of a person in 30 seconds will be shown at the exhibition</a></li>
<li><a href="../445590/index.html">English grammar. Who vs. Whom - how to understand which word to use</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>