<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How do you implement authentication, buddy?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Everyone knows about standard user authentication in an application. This is an old-school registration procedure ‚Äî the user enters a mail address, a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How do you implement authentication, buddy?</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/5n/le/nm/5nlenmsnizocjgyyiopxn9wfuxy.jpeg"></p><br><p>  Everyone knows about standard user authentication in an application.  This is an old-school registration procedure ‚Äî the user enters a mail address, a password, etc., ‚Äîand then, upon entering, we compare mail and / or password with the stored data.  If matches, give access.  But times have changed, and today there are many other authentication methods.  If you want to remain a sought-after programmer / developer in this changing, like a kaleidoscope, world of software development, then you should know about all these new methods. </p><br><p>  It cannot be denied that in any application and OS authentication is an extremely important element in ensuring the safety of user data and regulating access to information.  To understand which authentication method is better for you, you need to understand the advantages and disadvantages of all methods, as well as a good idea of ‚Äã‚Äãhow they work. </p><br><p>  Here I will try to talk about the most common authentication methods today.  This is not a detailed technical guide, but only a way to introduce you to them.  Although the methods are described taking into account the use of the web, these ideas can be implemented in other conditions. </p><a name="habracut"></a><br><p>  We assume you already know that most of the web / internet is built on the HTTP protocol.  You also need to know how web applications work, what user authentication means in an application, and what a client-server architecture is. </p><br><p>  Ready?  Go. </p><br><h2 id="autentifikaciya-na-osnove-sessiy">  Session Based Authentication </h2><br><p>  <a href="https://www.quora.com/Why-is-HTTP-protocol-called-stateless-protocol">The HTTP protocol does not track <em>states</em></a> , and if we authenticate the user with a name and password, our application will not know if this is the same person as in the previous request.  We will have to authenticate again.  With each HTTP request, it doesn‚Äôt know anything about what happened before, it just sends the request.  So, if you need personal data, you will have to log in again so that the application knows that this is exactly you.  It can be very annoying. </p><br><p>  To get rid of this inconvenience, they invented session-based authentication, which they implemented stateful <strong>tracking</strong> .  This means that the authentication record or session must be stored both on the server and on the client.  The server must track active sessions in a database or memory, and a cookie is created on the frontend in which the session identifier is stored.  This is cookie-based authentication, the most common and widely known method used for a long time. </p><br><p>  <strong>Session-based authentication procedure:</strong> </p><br><ol><li>  The user enters his name and password in the browser, after which the client application sends a request to the server. </li><li>  The server checks the user, authenticates it, sends a unique user token to the application (storing it in memory or a database). </li><li>  The client application saves tokens in cookies and sends them on every subsequent request. </li><li>  The server receives each request requiring authentication, using a token, authenticates the user and returns the requested data to the client application. </li><li>  When a user logs out, the client application deletes his token, so all subsequent requests from this client become unauthenticated. </li></ol><br><p><img src="https://habrastorage.org/webt/a5/cz/ws/a5czwswt6yvdhan0cm193d4liqq.png"></p><br><p>  This method has several drawbacks. </p><br><ul><li>  Each time a user is authenticated, the server must create an entry.  Usually it is stored in memory, and with a large number of users there is a probability of too high load on the server. </li><li>  Since sessions are stored in memory, scaling is not so easy.  If you repeatedly replicate a server, then all new user sessions will have to be replicated to all new servers.  This makes scaling difficult.  (I thought this could be avoided if you have a dedicated server for managing sessions, but this is difficult to implement, and it is not always possible.) </li></ul><br><h2 id="autentifikaciya-na-osnove-tokenov">  Token-based authentication </h2><br><p>  Token-based authentication has become very popular in recent years due to the proliferation of single-page applications, web APIs and the Internet of things.  Most often <a href="https://jwt.io/introduction/">Json Web Tokens (JWT)</a> are used as tokens.  Although implementations are different, JWT tokens have become de facto standard. </p><br><p>  Authentication based on tokens <strong>does not track state</strong> .  We will not store user information on the server or in a session, and we will not even store JWT used for clients. </p><br><p>  <strong>Token-based authentication procedure:</strong> </p><br><ol><li>  User enters name and password. </li><li>  The server checks them and returns a token (JWT), which may contain metadata like user_id, permissions, etc. </li><li>  The token is stored on the client side, most often in the local storage, but it can also be stored in the session or cookie storage. </li><li>  Subsequent requests to the server usually contain this token as an additional authorization header in the form of <em>Bearer {JWT}</em> .  Another token can be sent in the body of a POST request, and even as a request parameter. </li><li>  The server decrypts JWT, if the token is valid, the server processes the request. </li><li>  When the user logs out, the token on the client side is destroyed, no need to interact with the server. </li></ol><br><p><img src="https://habrastorage.org/webt/mu/rw/kv/murwkv_rxhbsjxkogdetqbwl-hk.png"></p><br><p>  <a href="https://medium.com/vandium-software/5-easy-steps-to-understanding-json-web-tokens-jwt-1164c0adfcec">More detailed description</a> . </p><br><p>  <strong>The method has several advantages:</strong> </p><br><ul><li>  The main advantage: since the method does not handle states in any way, the server does not need to keep records with user tokens or sessions.  Each token is self-sufficient, contains all the data necessary for verification, and also transfers the requested user information.  Therefore, tokens do not complicate scaling. </li><li>  In cookies, you simply store user session IDs, and JWT allows you to store any type of metadata, if it is valid JSON. </li><li>  When using cookies, the backend must perform a search on a traditional SQL database or a NoSQL alternative, and the data exchange probably lasts longer than the decoding of the token.  In addition, since you can store additional data such as user permissions inside JWT, you can save additional requests for retrieving and processing data. <br>  Suppose you have an API resource / api / orders, which returns the last orders created by the application, but only users of the admin category can view them.  If you use cookies, then by making a request, you generate one call to the database to check the session, another call to get user data and check whether the user is admins, and the third call to get data. <br>  And if you use JWT, you can store the user category already in a token.  When the server requests and decrypts it, you can make a single call to the database to get the necessary orders. </li><li>  Using cookies on mobile platforms has many limitations and features.  And tokens are much easier to implement on iOS and Android.  In addition, tokens are easier to implement for applications and services of the Internet of things, which do not provide storage of cookies. </li></ul><br><p>  Thanks to all this, token-based authentication is gaining popularity today. </p><br><h2 id="besparolnaya-autentifikaciya">  Passwordless authentication </h2><br><p>  The first reaction to the term ‚Äúpasswordless authentication‚Äù can be ‚ÄúHow to authenticate someone without a password?  Is that possible?" </p><br><p>  Our belief is embedded in our heads that passwords are the absolute source of protection for our accounts.  But if we look into the matter more deeply, it will become clear that passwordless authentication can be not only secure, but also safer than traditional login by name and password.  You may even have heard that passwords are outdated. </p><br><p>  Passwordless authentication is a way of configuring the login and authentication of users without entering passwords.  The idea is this: </p><br><p>  <em>Instead of entering mail / name and password, users enter only their mail.</em>  <em>Your application sends a one-time link to this address, the user clicks on it and automatically enters your website / application.</em>  <em>For passwordless authentication, the application assumes that a letter has arrived in your inbox with a link if you wrote your own address and not someone else‚Äôs address.</em> </p><br><p>  There is a similar method in which, instead of a one-time link, a code or a one-time password is sent via SMS.  But then you have to combine your application with an SMS service like <a href="https://www.twilio.com/">twilio</a> (and the service is not free).  Code or one-time password can also be sent by mail. </p><br><p>  And one more, less (so far) popular (and only available on Apple devices) method of passwordless authentication: use <a href="https://en.wikipedia.org/wiki/Touch_ID">Touch ID</a> for fingerprint authentication.  <a href="https://auth0.com/blog/how-fingerprint-auth-gives-you-security/">Read more about the technology</a> . </p><br><p>  If you are using <a href="https://slack.com/">Slack</a> , you might already be faced with passwordless authentication. </p><br><p><img src="https://habrastorage.org/webt/ct/a1/w3/cta1w3qcim0z2hwf0imqcs-nmrw.jpeg"></p><br><p>  <a href="https://blog.medium.com/signing-in-to-medium-by-email-aacc21134fcd">Medium provides access to your site only by mail</a> .  I recently discovered that <a href="https://auth0.com/passwordless">Auth0</a> , or Facebook <a href="https://developers.facebook.com/docs/accountkit/">AccountKit</a> , is a great option for implementing a password-free system for your application. </p><br><p>  <strong>What can go wrong?</strong> </p><br><p>  If someone gets access to user mail, he will get access to applications and sites.  But it is not your headache - to worry about the security of user email accounts.  In addition, if someone gets access to someone else's mail, you can intercept accounts in applications with passwordless authentication using the password recovery function.  But we can do nothing with the mail of our users.  Let's go further. </p><br><p>  <strong>What are the advantages?</strong> </p><br><p>  How often do you use the ‚Äúforgot password‚Äù link to reset the damn password, which you could not remember after several unsuccessful attempts to enter the site / application?  We are all in such a situation.  You don‚Äôt remember all the passwords, especially if you care about security and make a separate password for each site (observing all these ‚Äúmust consist of at least eight characters, contain at least one number, lower case letter and special character‚Äù).  Password-free authentication will save you from all this.  I know you are thinking now: "I use a password manager, idiot."  Respect.  But do not forget that the vast majority of users are not such technogs as you.  This must be taken into account. </p><br><p>  Passwordless authentication is good not only for users, but also for you as a developer.  You do not need to implement a password recovery mechanism.  All win. </p><br><p>  If you think that some users prefer an old-fashioned username / password, then give them both options so that they can choose. </p><br><p><img src="https://habrastorage.org/webt/zx/rk/mi/zxrkmifwhtditjzzrt93pupuibi.png"></p><br><p>  Today, passwordless authentication is rapidly gaining popularity. </p><br><h2 id="edinaya-tochka-vhoda-single-sign-on-sso">  Single Entry Point (Single Sign On, SSO) </h2><br><p>  Notice that when you log in to the browser in some Google-service, for example Gmail, and then go to Youtube or another Google-service, do not you have to log in there?  You automatically get access to all the services of the company.  Impressive, right?  After all, although Gmail and Youtube are Google services, they are still separate products.  How do they authenticate the user in all products after a single login? </p><br><p>  This method is called Single Sign On (SSO). </p><br><p>  You can implement it in different ways.  For example, use a central service to orchestrate single sign-on between multiple clients.  In the case of Google, this service is called <a href="https://accounts.google.com/">Google Accounts</a> .  When a user logs in, Google Accounts creates a cookie, which is saved by the user when he walks through the services of the company.  How it works: </p><br><ol><li>  User is a member of one of the Google services. </li><li>  The user gets generated in Google Accounts cuck. </li><li>  The user goes to another Google product. </li><li>  The user is again redirected to Google Accounts. </li><li> Google Accounts sees that the cookie has already been assigned to the user, and redirects the user to the requested product. </li></ol><br><p>  A very simple description of a single entry point: a user logs in once and gets access to all systems without having to log into each of them.  This procedure uses three entities that trust a friend directly and indirectly.  <strong>The user</strong> enters a password (or authenticates otherwise) with the identity provider (IDP) to access the service provider (SP). The user trusts the IDP, and the SP trusts the IDP, so the SP can trust the user. </p><br><p>  It looks very simple, but specific implementations are very complex.  Read more about this <a href="https://auth0.com/blog/what-is-and-how-does-single-sign-on-work/">authentication method</a> . </p><br><h2 id="autentifikaciya-v-socsetyah">  Social Network Authentication </h2><br><p>  I am sure this picture is familiar to everyone: </p><br><p><img src="https://habrastorage.org/webt/gi/_l/09/gi_l09m_eltbyanhsecnqln_pyy.png"></p><br><p>  This is often called <strong>social</strong> sign-in <strong>authentication</strong> or <strong>social login</strong> (Social Login).  You can authenticate users by their accounts in social networks.  Then users will not have to register separately in your application. </p><br><p>  Formally, a social login is not a separate authentication method.  This is a kind of single entry point that simplifies the process of user registration / entry into your application. </p><br><p>  <strong>The best of both worlds</strong> </p><br><p>  Users can log in to your application with one click, if they have an account in one of the social networks.  They do not need to remember logins and passwords.  This greatly improves the experience of using your application.  As a developer, you do not need to worry about the security of user data and think about checking email addresses - they are already checked by social networks.  In addition, social networks already have password recovery mechanisms. </p><br><p>  <strong>How to use</strong> </p><br><p>  As a developer, you must understand how this authentication method works.  Most social networks use authentication via <a href="https://developer.okta.com/blog/2017/06/21/what-the-heck-is-oauth">OAuth2</a> as the authentication mechanism (some use OAuth1, such as Twitter).  Let's understand what OAuth is.  A social network is a <strong>resource server</strong> , your application is a <strong>client</strong> , and the user trying to enter your application is the <strong>owner of the resource</strong> .  A resource is a user profile / authentication information.  When a user wants to log into your application, it redirects the user to the social network for authentication (usually this is a pop-up window with the social network URL).  After successful authentication, the user must give your application permission to access their profile from the social network.  Then the social network returns the user back to your application, but with an access token.  Next time, the application will take this token and request information from the user profile from the social network.  This is how OAuth works (for the sake of simplicity, I omitted technical details). </p><br><p>  To implement such a mechanism, you may need to register your application in different social networks.  You will be given app_id and other keys for configuring connections to social networks.  There are also several popular libraries / packages (like <a href="http://passportjs.org/">Passport</a> , <a href="https://github.com/laravel/socialite">Laravel Socialite</a> , etc.) that will help simplify the procedure and eliminate unnecessary fuss. </p><br><h2 id="dvuhfaktornaya-autentifikaciya-2fa">  Two-factor authentication (2FA) </h2><br><p>  Two-factor authentication (2FA) improves access security by using two methods (also called factors) of verifying the user's identity.  This is a form of <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE%25D1%2584%25D0%25B0%25D0%25BA%25D1%2582%25D0%25BE%25D1%2580%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B0%25D1%2583%25D1%2582%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2584%25D0%25B8%25D0%25BA%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">multi-factor authentication</a> .  Probably, it did not occur to you, but at the ATMs you pass two-factor authentication: the correct information must be recorded on your bank card, and in addition to this you enter the PIN.  If someone steals your card, then without a code he will not be able to use it.  <em>(Not a fact! - Note. Trans.)</em> That is, in a two-factor authentication system, a user gets access only after providing several separate pieces of information. </p><br><p>  Another familiar example is the two-factor authentication of Mail.Ru, Google, Facebook, etc. If this login method is enabled, you first need to enter a login and password, and then a one-time password (verification code) sent via SMS.  If your regular password has been compromised, the account will remain protected, because in the second step of the login, the attacker will not be able to enter the required verification code. </p><br><p><img src="https://habrastorage.org/webt/fr/rs/6o/frrs6ogf36s34ufgucexrlf-uee.png"></p><br><p>  Instead of a one-time password, fingerprints or retinal imagery can be used as the second factor. </p><br><p>  With two-factor authentication, the user must provide two of the three: </p><br><ul><li>  <strong>What you know:</strong> password or PIN. </li><li>  <strong>What you have: a</strong> physical device (smartphone) or an application that generates one-time passwords. </li><li>  <strong>Part of you: a</strong> biologically unique property like your fingerprint, voice, or retinal snapshot. </li></ul><br><p>  Most hackers hunt for passwords and PIN codes.  It is much harder to get access to the token generator or biological properties, so today two-factor provides high security accounts. </p><br><p>  So this is a universal solution?  <a href="https://medium.com/%40the_economist/where-are-the-flaws-in-two-factor-authentication-5f7a468f41a9">Perhaps</a> <a href="https://www.theverge.com/2017/7/10/15946642/two-factor-authentication-online-security-mess">not</a> . </p><br><p>  And yet, two-factor will help strengthen the security of authentication in your application.  How to implement?  Perhaps you should not ride, but use existing solutions like <a href="https://auth0.com/learn/two-factor-authentication/">Auth0</a> or <a href="https://duo.com/">Duo</a> . </p><br><h2 id="autentifikaciya-ili-avtorizaciya">  Authentication or authorization? </h2><br><p>  Some confuse the terms "authentication" and "authorization".  These are different things. </p><br><ul><li>  <strong>Authentication</strong> is the verification of your identity.  When you log in to the application with a username and password, you are authenticated. </li><li>  <strong>Authorization</strong> is a check that you have access to something.  This may be a set of permissions for some actions.  For example, if you created a resource in an application, then you may be the only person allowed to delete this resource (because you are the owner), and other users are not "authorized" for that. </li></ul><br><p><img src="https://habrastorage.org/webt/ae/xl/n2/aexln2nbwbniputq_xdgtiorenq.jpeg"></p><br><p>  Still here? </p><br><p>  Congratulations, you have successfully read a long, tedious and boring article. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/343288/">https://habr.com/ru/post/343288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343276/index.html">Solving Memory Misuse Problems in Node.js</a></li>
<li><a href="../343278/index.html">How we control the quality of the code in the Android Browser. Yandex lecture</a></li>
<li><a href="../343282/index.html">How data centers work: today and tomorrow</a></li>
<li><a href="../343284/index.html">Interview with the main digital strategist Adblock Plus: ‚ÄúWell, I sleep well, Burumych, great!‚Äù</a></li>
<li><a href="../343286/index.html">How high-frequency trading changed the situation on world markets: 4 conclusions of analysts at Credit Suisse</a></li>
<li><a href="../343290/index.html">Creating remakes of games using emulation: proof of concept</a></li>
<li><a href="../343294/index.html">Parser on PHP knee or how I replenished my music collection</a></li>
<li><a href="../343296/index.html">The story of several hard forks: how did the bitcoin network evolve</a></li>
<li><a href="../343298/index.html">Integration tests for Java using TestContainers. Less madness, more order, all automatically</a></li>
<li><a href="../343300/index.html">We compare what is impossible: cheap hosting and cloud on the VMware stack</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>