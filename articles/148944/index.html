<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Discover Cach√© SQL Gateway for building federated systems or multibases</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In complex systems, there is often a question of integrating data from different sources. 
 Such systems are called integrated, federated or multibase...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Discover Cach√© SQL Gateway for building federated systems or multibases</h1><div class="post__text post__text-html js-mediator-article">  In complex systems, there is often a question of integrating data from different sources. <br>  Such systems are called <a href="http://citforum.ru/database/osbd/glava_102.shtml">integrated, federated or multibase</a> . <br><br>  In Cach√©, this integration is performed using a special gateway ( <a href="">Cach√© SQL Gateway</a> ), which basically uses ODBC / JDBC connections to external data sources.  Moreover, the source in this case can be understood not only a DBMS, since there are JDBC / ODBC drivers for MS Excel, DBF, text files, graphic files, WMI, etc. <br><a name="habracut"></a><br>  Briefly, how to use <b>Cach√© SQL Gateway</b> : <br><br><ol><li>  in <b>the System Management Portal</b> ( <a href="">SMP</a> ) create a connection of the desired type, specifying the connection string, login, password, etc.  Here you can check the created connection; </li><li>  using the <b>Binding Wizard, you</b> link the required tables and / or procedures to Cach√© from the external DBMS using the connection from the step above.  In this case, no data is copied anywhere, but only special virtual classes are created, they are also tables; </li><li>  Now, having connected to the <a href="">field</a> - a logical database in Cach√© terms - you will see tables, views, stored procedures (CPs) from external sources in it: Oracle, DB2, MSSQL, MySQL, Excel, DBF, CSV, etc. </li><li>  then you can work with these tables / CPs in both directions, as if they were physically located in Cach√©. </li></ol><br><blockquote>  Note: Anticipating questions about the support of heterogeneous queries to different data sources, I hasten to notice about the presence of <a href="">some limitations</a> in the queries. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In other words, the <b>JOIN</b> between tables from Oracle and MSSQL will fail. <br><br>  These restrictions apply only to so-called related tables.  If you use the <a href="">Migration Wizard of</a> structures and data instead <b>of the Binding Wizard</b> , then there will be no such restrictions. </blockquote><br><hr><h4>  Creating linked tables </h4><br>  As mentioned above, you can use either ODBC or JDBC driver to connect to an external data source.  Consider both options. <br><br>  For <a href="">ODBC,</a> you must first configure system DSNs: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b8e/911/175/b8e91117590ba13bae12913a3e48810e.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2c3/a94/7db/2c3a947db74d003e649cca332540b73f.png"><br><br>  And for <a href="">JDBC</a> , the path to the Java virtual machine ( <font color="#FF0000">hereinafter all the pictures are clickable</font> ): <br><br> <a href="http://db.tt/GVuykqyR"><img src="https://habrastorage.org/getpro/habr/post_images/2ce/1ed/7bf/2ce1ed7bf2e34b66aa393b94bfd77b5f.png"></a> <br><br>  Next, in SMP, you need to create connections for the <b>Cach√© SQL Gateway of the</b> desired type ( <a href="">JDBC</a> or <a href="">ODBC</a> ), on which these or other settings will depend.  Here you can check the newly created connection: <br><br> <a href="http://db.tt/Zt3bB5JG"><img src="https://habrastorage.org/getpro/habr/post_images/482/2a5/e98/4822a5e98ebcbf8d648ac79f427ba551.png"></a> <br><br> <a href="http://db.tt/BHTIS3Bi"><img src="https://habrastorage.org/getpro/habr/post_images/404/c75/d13/404c75d13375611b94c753cdcfce316e.png"></a> <br><br>  Then, using the <a href="">Tables</a> or <a href="">procedures</a> <b>Binding Wizard</b> , you should create the necessary virtual tables or CPs: <br><br> <a href="http://db.tt/vu9evva5"><img src="https://habrastorage.org/getpro/habr/post_images/829/ebc/bbd/829ebcbbd0d097b65c058ee4bac89968.png"></a> <br><br> <a href="http://db.tt/aMJFk9WL"><img src="https://habrastorage.org/getpro/habr/post_images/1cc/426/882/1cc4268829fdf67cd9b1781b017a3eed.png"></a> <br><br>  The wizard will query for each table its new name, new names for each of the fields, primary key, etc.  In most cases, you can leave all the names by default, but there are situations where some of these identifiers are reserved words from the Cach√© DBMS. <br><br>  An example of a generated virtual class for an external <font color="#008000">job_titles</font> table: <br><br>  <font color="#000080">Class dbo.jobtitles Extends% Library.Persistent</font> <font color="#000000">[</font> <font color="#000080">ClassType</font> <font color="#000000">= persistent,</font> <font color="#000080">Not ProcedureBlock</font> <font color="#000000">,</font> <font color="#000080">SqlRowIdPrivate</font> <font color="#000000">,</font> <font color="#000080">SqlTableName</font> <font color="#000000">=</font> <font color="#008000">job_titles</font> <font color="#000000">,</font> <font color="#000080">StorageStrategy</font> <font color="#000000">= GSQLStorage]</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br><br></font>  <font color="#000080">Parameter</font> <font color="#000000">CONNECTION =</font> <font color="#800080">"ems, NOCREATE"</font> <font color="#000000">;</font> <font color="#000000"><br><br></font>  <font color="#000080">Parameter</font> <font color="#000000">EXTDBNAME =</font> <font color="#800080">"Microsoft SQL Server"</font> <font color="#000000">;</font> <font color="#000000"><br><br></font>  <font color="#000080">Parameter</font> <font color="#000000">EXTERNALTABLENAME =</font> <font color="#800080">"dbo.job_titles"</font> <font color="#000000">;</font> <font color="#000000"><br><br></font>  <font color="#000080">Property</font> <font color="#000000">INTERETHNICVALUE</font> <font color="#000080">As% String</font> <font color="#000000">(</font> <font color="#000080">EXTERNALSQLNAME</font> <font color="#000000">=</font> <font color="#800080">"INTERETHNIC_VALUE"</font> <font color="#000000">,</font> <font color="#000080">EXTERNALSQLTYPE</font> <font color="#000000">=</font> <font color="#000080">12</font> <font color="#000000">,</font> <font color="#000080">MAXLEN</font> <font color="#000000">=</font> <font color="#000080">50</font> <font color="#000000">) [</font> <font color="#000080">Required</font> <font color="#000000">,</font> <font color="#000080">SqlColumnNumber</font> <font color="#000000">= 5,</font> <font color="#000080">SqlFieldName</font> <font color="#000000">=</font> <font color="#008000">INTERETHNIC_VALUE</font> <font color="#000000">];</font> <font color="#000000"><br><br></font>  <font color="#000080">Property</font> <font color="#000000">INTERNATIONALVALUE</font> <font color="#000080">As% String</font> <font color="#000000">(</font> <font color="#000080">EXTERNALSQLNAME</font> <font color="#000000">=</font> <font color="#800080">"INTERNATIONAL_VALUE"</font> <font color="#000000">,</font> <font color="#000080">EXTERNALSQLTYPE</font> <font color="#000000">=</font> <font color="#000080">12</font> <font color="#000000">,</font> <font color="#000080">MAXLEN</font> <font color="#000000">=</font> <font color="#000080">50</font> <font color="#000000">) [</font> <font color="#000080">Required</font> <font color="#000000">,</font> <font color="#000080">SqlColumnNumber</font> <font color="#000000">= 4,</font> <font color="#000080">SqlFieldName</font> <font color="#000000">=</font> <font color="#008000">INTERNATIONAL_VALUE</font> <font color="#000000">];</font> <font color="#000000"><br><br></font>  <font color="#000080">Property</font> <font color="#000000">NATIONALVALUE</font> <font color="#000080">As% String</font> <font color="#000000">(</font> <font color="#000080">EXTERNALSQLNAME</font> <font color="#000000">=</font> <font color="#800080">"NATIONAL_VALUE"</font> <font color="#000000">,</font> <font color="#000080">EXTERNALSQLTYPE</font> <font color="#000000">=</font> <font color="#000080">12</font> <font color="#000000">,</font> <font color="#000080">MAXLEN</font> <font color="#000000">=</font> <font color="#000080">50</font> <font color="#000000">) [</font> <font color="#000080">Required</font> <font color="#000000">,</font> <font color="#000080">SqlColumnNumber</font> <font color="#000000">= 6,</font> <font color="#000080">SqlFieldName</font> <font color="#000000">=</font> <font color="#008000">NATIONAL_VALUE</font> <font color="#000000">];</font> <font color="#000000"><br><br></font>  <font color="#000080">Property</font> <font color="#000000">id</font> <font color="#000080">As% Integer</font> <font color="#000000">(</font> <font color="#000080">EXTERNALSQLNAME</font> <font color="#000000">=</font> <font color="#800080">"id"</font> <font color="#000000">,</font> <font color="#000080">EXTERNALSQLTYPE</font> <font color="#000000">=</font> <font color="#000080">4</font> <font color="#000000">) [</font> <font color="#000080">Required</font> <font color="#000000">,</font> <font color="#000080">SqlColumnNumber</font> <font color="#000000">= 2,</font> <font color="#000080">SqlFieldName</font> <font color="#000000">=</font> <font color="#008000">id</font> <font color="#000000">];</font> <font color="#000000"><br><br></font>  <font color="#000080">Property</font> <font color="#000000">priority</font> <font color="#000080">As% Integer</font> <font color="#000000">(</font> <font color="#000080">EXTERNALSQLNAME</font> <font color="#000000">=</font> <font color="#800080">"priority"</font> <font color="#000000">,</font> <font color="#000080">EXTERNALSQLTYPE</font> <font color="#000000">=</font> <font color="#000080">4</font> <font color="#000000">) [</font> <font color="#000080">Required</font> <font color="#000000">,</font> <font color="#000080">SqlColumnNumber</font> <font color="#000000">= 3,</font> <font color="#000080">SqlFieldName</font> <font color="#000000">=</font> <font color="#008000">priority</font> <font color="#000000">];</font> <font color="#000000"><br><br></font>  <font color="#000080">Index</font> <font color="#000000">MainIndex On id [</font> <font color="#000080">IdKey</font> <font color="#000000">,</font> <font color="#000080">PrimaryKey</font> <font color="#000000">];</font> <font color="#000000"><br><br></font>  <font color="#000000">}</font> <br><br><blockquote>  Note: if necessary, you can add the code of the generated class with some plugs from Cach√© - class and / or object methods, calculated fields, superclasses, CP, - which are absent in the original tables. <br>  But we should not forget that when you re-generate the associated tables / CP all your additional code will be lost. </blockquote><br>  Everything, now you can, connecting to Cach√© using any ODBC / JDBC client (see one of the <a href="http://habrahabr.ru/company/intersystems/blog/148530/">previous articles</a> ), see all tables and procedures, both internal and external;  and the difference between them is difficult to determine immediately. <br><br>  Well, of course, you can insert / delete / modify data using the native SQL syntax of any DBMS. <br><br>  <a href="">Cach√© SQL Gateway</a> can also be used for <a href="">DeepSee</a> embedded business intelligence, but that‚Äôs another topic. <br><br><div class="spoiler">  <b class="spoiler_title">Alternative use case</b> <div class="spoiler_text">  Once this technology helped my colleagues working with other DBMS (not Cach√©).  Two new employees came to work with us and they needed access to several different databases on different servers. <br><br>  Since the paper on access for them to the necessary servers "wandered" around the cabinets, and the deadlines were tight, I offered them a temporary version with Cach√© with the consent of my management: they used some kind of Hibernate framework, and I had access to the necessary ones servers.  I created a domain in Cach√©, added the necessary tables from the necessary databases, gave them the necessary rights. <br><br>  Then they connected via Cach√©, serving here as a proxy DBMS, to one virtual database and worked in this way with their tables from separate databases.  Colleagues did not even have to install drivers for their DBMS. </div></div><br><hr><h4>  Program access to external data </h4><br>  In addition to creating linked tables, you can work with external data programmatically: <br><ul><li>  <a href="">Jdbc</a> </li><li>  <a href="">ODBC</a> </li></ul><br>  An example of software ODBC access using a system DSN: <br><br>  <font color="#0000ff">set</font> <font color="#000000">db =</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% SQLGatewayConnection</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">res = db.</font>  <font color="#0000ff">Connect</font> <font color="#000000">(</font> <font color="#008000">"DSNName"</font> <font color="#000000">,</font> <font color="#008000">"username"</font> <font color="#000000">,</font> <font color="#008000">"password"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">rs =</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% ResultSet</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">(</font> <font color="#008000">"% DynamicQueryGW: SQLGW"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">rs.</font>  <font color="#0000ff">Prepare</font> <font color="#000000">(</font> <font color="#008000">"SELECT * FROM users WHERE id =?"</font> <font color="#000000">,, db)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">rs.</font>  <font color="#0000ff">Execute</font> <font color="#000000">(46)</font> <font color="#000000"><br></font>  <font color="#0000ff">while</font> <font color="#000000">rs.</font>  <font color="#0000ff">Next</font> <font color="#000000">()</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">for</font> <font color="#000000">i = 1: 1: rs.</font>  <font color="#0000ff">GetColumnCount</font> <font color="#000000">()</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">write</font> <font color="#000000">rs.</font>  <font color="#0000ff">GetData</font> <font color="#000000">(i)</font> <font color="#000000"><br></font>  <font color="#0000ff">if</font> <font color="#000000">i '= rs.</font>  <font color="#0000ff">GetColumnCount</font> <font color="#000000">()</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">write</font> <font color="#008000">","</font> <font color="#008000"><br></font>  <font color="#800080">}</font> <font color="#0000ff">else</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">write</font> <font color="#000000">!</font> <font color="#000000"><br></font>  <font color="#800080">}</font> <font color="#800080"><br></font>  <font color="#800080">}</font> <font color="#800080"><br></font>  <font color="#800080">}</font> <font color="#800080"><br></font>  <font color="#0000ff">do</font> <font color="#000000">db.</font>  <font color="#0000ff">Disconnect</font> <font color="#000000">()</font> <br><br>  In this case, you no longer need to create connections for the <b>Cach√© SQL Gateway</b> , since "DSNName" is the DSN name defined in the OC itself. <br><br>  The example above demonstrates the so-called high-level access to working with ODBC using the <b>% ResultSet</b> and <b>% DynamicQueryGW classes</b> , but low-level access is also possible.  In this case, only methods of class <a href="">% SQLGatewayConnection are used</a> . <br><br>  The following is an example of querying an external table using low-level access.  This query selects all fields from the <i>INFO</i> table of an external ODBC source (with the name <b>DSNName</b> ) for which the value of the field <i>Age</i> = 21 and the value of the field <i>Name</i> begins with the letter "D". <br><br>  <font color="#0000ff">set</font> <font color="#000000">db =</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% SQLGatewayConnection</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#008000">// establish connection</font> <font color="#008000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">db.</font>  <font color="#0000ff">Connect</font> <font color="#000000">(</font> <font color="#008000">"DSNName"</font> <font color="#000000">,</font> <font color="#008000">"sa"</font> <font color="#000000">,</font> <font color="#008000">"pwd"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#008000">// create a new team</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">AllocateStatement</font> <font color="#000000">(.Stat)</font> <font color="#000000"><br></font>  <font color="#008000">// preparation of the request</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">Prepare</font> <font color="#000000">(Stat,</font> <font color="#008000">"SELECT * FROM INFO WHERE Age =? AND Name LIKE?"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#008000">// preparation of parameters</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">BindParameters</font> <font color="#000000">(Stat,</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(1,1),</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(4.12),</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(4.50),</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(0,0),</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(4.50))</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">SetParameter</font> <font color="#000000">(Stat,</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(21), 1)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">SetParameter</font> <font color="#000000">(Stat,</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(</font> <font color="#008000">"D%"</font> <font color="#000000">), 2)</font> <font color="#000000"><br></font>  <font color="#008000">// query execution</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">Execute</font> <font color="#000000">(Stat)</font> <font color="#000000"><br></font>  <font color="#0000ff">for</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">quit</font> <font color="#000000">: 'db.</font>  <font color="#0000ff">Fetch</font> <font color="#000000">(stat)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">GetOneRow</font> <font color="#000000">(Stat, .Row)</font> <font color="#000000"><br></font>  <font color="#0000ff">for</font> <font color="#000000">j = 1: 1:</font> <font color="#0000ff">$ listlength</font> <font color="#000000">(Row)</font> <font color="#0000ff">write $ listget</font> <font color="#000000">(Row, j) _</font> <font color="#008000">""</font> <font color="#008000"><br></font>  <font color="#0000ff">write</font> <font color="#000000">!</font> <font color="#000000"><br></font>  <font color="#800080">}</font> <font color="#800080"><br></font>  <font color="#008000">// delete command</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">DropStatement</font> <font color="#000000">(Stat)</font> <font color="#000000"><br></font>  <font color="#008000">// disconnect</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">Disconnect</font> <font color="#000000">()</font> <br><br>  So, consider this example in more detail. <br><br>  ‚Ä¢ The <i>Connect</i> method <i>(DSN, User, Password) is</i> used to connect to an ODBC data source (DSN <i>)</i> : <br><br>  <font color="#0000ff">set</font> <font color="#000000">db =</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% SQLGatewayConnection</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#008000">// establish connection</font> <font color="#008000"><br></font>  <font color="#0000ff">do</font> <font color="#000000">db.</font>  <font color="#0000ff">Connect</font> <font color="#000000">(</font> <font color="#008000">"DSNName"</font> <font color="#000000">,</font> <font color="#008000">"sa"</font> <font color="#000000">,</font> <font color="#008000">"pwd"</font> <font color="#000000">)</font> <br><br>  ‚Ä¢ To disconnect, use the <i>Disconnect ()</i> method: <br><br>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">Disconnect</font> <font color="#000000">()</font> <br><br>  ‚Ä¢ Before you execute a query, you must first create a <b>Statement</b> command.  To create a command, the <i>AllocateStatement ()</i> method is used, the <b>Handle</b> argument to the <i>AllocateStatement ()</i> method is passed by reference (before the name of the argument you need to put a ‚Äú.‚Äù): <br><br>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">AllocateStatement</font> <font color="#000000">(.Stat)</font> <br><br>  ‚Ä¢ To remove a command, use the <i>DropStatement ()</i> method: <br><br>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">DropStatement</font> <font color="#000000">(Stat)</font> <br><br>  ‚Ä¢ Before executing a query, it must be "prepared", for which the <i>Prepare</i> method <i>(Stat, sql) is used</i> .  The created command and the SQL query string are passed as arguments to the method.  It is possible to execute queries with parameters, then in the sql line in place of the parameters, the characters "?" Are put: <br><br>  <font color="#008000">// preparation of the request</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">Prepare</font> <font color="#000000">(Stat,</font> <font color="#008000">"SELECT * FROM INFO WHERE Age =? AND Name LIKE?"</font> <font color="#000000">)</font> <br><br>  ‚Ä¢ If an sql query with parameters is transmitted, these parameters must be prepared and assigned to them certain values.  To prepare the parameters, use the <i>BindParameters ()</i> method.  Arguments of the <i>BindParameters ()</i> method: <br><br><ul><li>  created team; </li><li>  Parameter types: 1 - in (input), 2-in / out (input / output), 4-out (output, ...); </li><li> The list of ODBC data types (for example: 4-INTEGER, 9-DATE, 12-VARCHAR, 8-DOUBLE, ...); </li><li>  buffer sizes in bytes; </li><li>  the number of characters after the point (only for Decimal and Float); </li><li>  list of data type lengths in bytes. </li></ul><br>  ‚Ä¢ All arguments to the <i>BindParameters ()</i> method, starting from the second, are of type <b>% List</b> and must be passed as arguments to the <i>$ listbuild ()</i> function.  If there are several parameters in the request, then the values ‚Äã‚Äãof <i>$ listbuild ()</i> are passed the values ‚Äã‚Äãseparated by commas, corresponding to each parameter in the order they appear in the query string, for example: <br><br>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">BindParameters</font> <font color="#000000">(Stat,</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(1,1),</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(4.12),</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(4.50),</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(0,0),</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(4.50))</font> <br><br>  or <br><br>  <font color="#0000ff">#include</font> <font color="#000000">% occODBC</font> <font color="#008000">;</font>  <font color="#008000">do not forget to include the necessary files with macros</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">BindParameters</font> <font color="#000000">(</font> <font color="#000000"><br></font>  <font color="#000000">Stat,</font> <font color="#000000"><br></font>  <font color="#0000ff">$ listbuild</font> <font color="#000000">(</font> <font color="#0000ff">$$$ SQLPARAMINPUT</font> <font color="#000000">,</font> <font color="#0000ff">$$$ SQLPARAMINPUT</font> <font color="#000000">),</font> <font color="#000000"><br></font>  <font color="#0000ff">$ listbuild</font> <font color="#000000">(</font> <font color="#0000ff">$$$ ODBCTYPEinteger</font> <font color="#000000">,</font> <font color="#0000ff">$$$ ODBCTYPEvarchar</font> <font color="#000000">),</font> <font color="#000000"><br></font>  <font color="#0000ff">$ listbuild</font> <font color="#000000">(4.50),</font> <font color="#000000"><br></font>  <font color="#0000ff">$ listbuild</font> <font color="#000000">(0,0),</font> <font color="#000000"><br></font>  <font color="#0000ff">$ listbuild</font> <font color="#000000">(4.50)</font> <font color="#000000"><br></font>  <font color="#000000">)</font> <br><blockquote>  Note: in the code presented initially, numeric parameter type identifiers are used.  In real code, it is better to use macros from the <b>% occODBC.inc</b> or <b>% msql.inc files</b> , for example: <br><br><ul><li>  $$$ GetOdbcTypeNumber ("INTEGER") or $$$ ODBCTYPEinteger will return 4; </li><li>  $$$ SQLPARAMINPUT returns 1 (input); </li><li>  $$$ SQLPARAMINPUTOUTPUT returns 2 (input / output); </li><li>  $$$ SQLPARAMOUTPUT returns 4 (output); </li><li>  etc. </li></ul><br>  A complete list of macros can be found in the corresponding files, using, for example, <b>Cach√© Studio</b> . </blockquote><br>  ‚Ä¢ Assigning a value to a parameter using the <i>SetParameter</i> method <i>(Stat, $ listbuild (val), Numb)</i> .  As arguments, the <i>SetParameter ()</i> method is passed: <br><br><ul><li>  created team; </li><li>  parameter value as an argument of the <i>$ listbuild ()</i> function; </li><li>  the sequence number of the parameter in the query string. </li></ul><br>  ‚Ä¢ The <i>SetParameter ()</i> method is called separately for each parameter passed: <br><br>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">SetParameter</font> <font color="#000000">(Stat,</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(21), 1)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">SetParameter</font> <font color="#000000">(Stat,</font> <font color="#0000ff">$ listbuild</font> <font color="#000000">(</font> <font color="#008000">"D%"</font> <font color="#000000">), 2)</font> <br><br>  ‚Ä¢ To execute the query, the <i>Execute (Stat)</i> method is used, to which the created command is passed as an argument: <br><br>  <font color="#0000ff">set</font> <font color="#000000">sc = db.</font>  <font color="#0000ff">Execute</font> <font color="#000000">(Stat)</font> <br><br><blockquote>  Note: Additional examples of programmatic access to external data using JDBC / ODBC can be found in the source code of the <b>% UnitTest.JDBCSQL</b> and <b>% UnitTest.ODBCSQL classes,</b> respectively. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/148944/">https://habr.com/ru/post/148944/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148937/index.html">Free ebooks from Microsoft</a></li>
<li><a href="../148938/index.html">Simple as java</a></li>
<li><a href="../148939/index.html">Habrastats</a></li>
<li><a href="../148940/index.html">Juggling. Theory. Practice</a></li>
<li><a href="../148942/index.html">3D glasses from John Carmack caused a stir on Kickstarter</a></li>
<li><a href="../148945/index.html">Input attribute placeholder</a></li>
<li><a href="../148946/index.html">Mobile Developer Day in Odessa</a></li>
<li><a href="../148948/index.html">Configuration files Libconfig library</a></li>
<li><a href="../148950/index.html">ReactOS, do you get in touch again?</a></li>
<li><a href="../148951/index.html">Implementing REST API on symfony2: the right way</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>