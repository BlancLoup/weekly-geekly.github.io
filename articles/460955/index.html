<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Educational program for passing parameters by value to constructors and setters (modern C ++, examples)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Judging by the comments habr.com/en/post/460831/#comment_20416435 in the next post and the discussion that unfolded there, the article on Habr√© how to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Educational program for passing parameters by value to constructors and setters (modern C ++, examples)</h1><div class="post__text post__text-html js-mediator-article">  Judging by the comments <a href="https://habr.com/ru/post/460831/">habr.com/en/post/460831/#comment_20416435</a> in the next post and the discussion that unfolded there, the article on Habr√© how to pass arguments to the constructor or setter will not hurt  StackOverflow has a lot of similar material, but I don‚Äôt remember something here. <br><br>  Because the example in that article is completely correct, and the author of the article is absolutely right.  Here is an example: <br><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// . struct person { person(std::string first_name, std::string last_name) : first_name{std::move(first_name)} //  , last_name{std::move(last_name)} // std::move  ! {} private: std::string first_name; std::string last_name; };</span></span></code> </pre> <br>  Such code allows you to cover all (well, almost all) possible options for using the class: <br><a name="habracut"></a><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> first{<span class="hljs-string"><span class="hljs-string">"abc"</span></span>}, last{<span class="hljs-string"><span class="hljs-string">"def"</span></span>}; person p1{first, last}; <span class="hljs-comment"><span class="hljs-comment">// (1)    person p2{std::move(first), last}; // !!!    person p2{std::move(first), std::move(last)}; // (3)   person p3{"x", "y"}; //  </span></span></code> </pre><br>  Compare with the old method, when passed via const &amp;: it is definitely worse, because it excludes option (3): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// . struct person { person(const std::string&amp; first_name, const std::string&amp; last_name) : first_name{first_name} , last_name{last_name} {} private: std::string first_name; std::string last_name; }; std::string first{"abc"}, last{"def"}; person p1{first, last}; //  ,    //      ,  first  last    // ?         //   0 !  const&amp; .</span></span></code> </pre><br>  An alternative with &amp;&amp; is also worse, but in the opposite direction: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// . struct person { person(std::string&amp;&amp; first_name, std::string&amp;&amp; last_name) : first_name{std::move(first_name)} , last_name{std::move(last_name)} {} private: std::string first_name; std::string last_name; }; std::string first{"abc"}, last{"def"}; person p1{std::move(first), std::move(last)}; //  //       ,    &amp;&amp;  : person p2{std::string{first}, std::string{last}}; // FOOOO</span></span></code> </pre><br>  If you are not afraid of a combinatorial explosion, you can give a chance to &amp;&amp; (but why? There will be no real gain in speed, the optimizer does not doze off): <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   . struct person { person(std::string&amp;&amp; first_name, std::string&amp;&amp; last_name) : first_name{std::move(first_name)} , last_name{std::move(last_name)} {} person(const std::string&amp; first_name, std::string&amp;&amp; last_name) : first_name{first_name} , last_name{std::move(last_name)} {} person(std::string&amp;&amp; first_name, const std::string&amp; last_name) : first_name{std::move(first_name)} , last_name{last_name} {} person(const std::string&amp; first_name, const std::string&amp; last_name) : first_name{first_name} , last_name{last_name} {} private: std::string first_name; std::string last_name; };</span></span></code> </pre><br>  Or the same thing, only with templates (but then again, why?): <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//     (   ),      . struct person { template &lt;typename T1, typename T2&gt; person(T1&amp;&amp; first_name, T2&amp;&amp; last_name) : first_name{std::forward&lt;T1&gt;(first_name)} , last_name{std::forward&lt;T2&gt;(last_name)} {} private: std::string first_name; std::string last_name; };</span></span></code> </pre> <br>  Even if you do not have std :: string, but some object of your own written large class, and you want people to make it move (and not copy), then in this case it is better to prohibit the constructor from copying from this large class than to pass it everywhere by &amp;&amp;.  This is more reliable, and the code is shorter. <br><br>  Finally, a couple of options on how to do NOT WORTH: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// . struct person { person(const std::string&amp; first_name, const std::string&amp; last_name) : first_name{first_name} , last_name{last_name} {} private: //   :  ,     //     const std::string&amp; first_name; const std::string&amp; last_name; }; person p{"x", "y"}; // --, </span></span></code> </pre><br>  And so do not: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// . struct person { person(std::string&amp; first_name, std::string&amp; last_name) : first_name{first_name} , last_name{last_name} {} private: //   ,      shared_ptr: //  ,   std::string&amp; first_name; std::string&amp; last_name; };</span></span></code> </pre><br>  Why is this happening, what is the fundamental principle?  It is simple: an object, as a rule, should OWN its properties. <br><br>  If an object does not want to own something, then it can own shared_ptr for this ‚Äúsomething‚Äù.  By the way, in this case shared_ptr should also be passed by value, and not by constant link - there is no difference with the very first example at the beginning of the article: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  (  ). struct person { person(std::shared_ptr&lt;portfolio&gt; pf) : pf{std::move(pf)} // std::move     {} private: std::shared_ptr&lt;portfolio&gt; pf; }; auto psh = std::make_shared&lt;portfolio&gt;("xxx", "yyy", "zzz"); ... person p1{psh}; person p2{std::move(psh)}; // (X)  ,  psh   </span></span></code> </pre><br>  Please note: std :: move for shared_ptr is completely legal, it eliminates the overhead of locking the shared_ptr link counter in memory (hundreds of CPU cycles) and its increment.  It does not affect the lifetime of the object and other links to it.  But (X) can be done, of course, only if the psh link in the code below is no longer needed. <br><br>  Moral: do not use const &amp; in general.  Look according to circumstances. <br><br>  PS <br>  Use {} instead of () when passing constructor parameters.  Fashionable, modern, youth. <br><br>  PPS <br>  In conclusion, one more thing: std :: move () actually does not move anything and in itself translates to zero assembler instructions.  All that std :: move () does is to put a special ‚Äústicky label‚Äù on the link, turning it into an &amp;&amp; - rvalue reference.  And then you can separately ‚Äúmatch‚Äù the type of the function parameter with this label (for example, have a separate function overload for the &amp;&amp; - parameter and a separate one for the &amp; -parameter).  The meaning of the &amp;&amp; - shortcut is to enable the calling code to tell the called: ‚Äúif you want, you can eat the value from this link, I no longer need it;  but only if you eat, leave the bones, then I still need to call the destructor for the remaining skeleton. "  With the same success, it would be possible to transmit ordinary &amp; -links (you can also ‚Äúeat‚Äù an object with them), but with &amp;&amp; it‚Äôs better semantics, because  you will not confuse: where you can eat, and where you can only smell. <br><br>  In this regard, the name std :: move () should be recognized as extremely unsuccessful.  It would be correct to call it std :: eat_me_if_you_want () or std :: bon_appetit ().  But std :: move () is shorter. </div><p>Source: <a href="https://habr.com/ru/post/460955/">https://habr.com/ru/post/460955/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460943/index.html">How to choose promising keys for SEO based on scenario forecasting in Google Data Studio (+ template)</a></li>
<li><a href="../460945/index.html">Experience in using a telegram channel to increase recognition and revenue growth of a gaming studio</a></li>
<li><a href="../460947/index.html">WASM Meet Up 1/08</a></li>
<li><a href="../460951/index.html">Create Android Live Wallpapers</a></li>
<li><a href="../460953/index.html">Pointers are complex, or what is stored in a byte?</a></li>
<li><a href="../460959/index.html">Microsoft's new technology allows 3D copies of a real person to speak any language</a></li>
<li><a href="../46096/index.html">Play Pong ... with your browser windows!</a></li>
<li><a href="../460961/index.html">Setting up Unit tests in mixed Swift + Objective-C projects</a></li>
<li><a href="../460965/index.html">Split Controller without these your storyboards</a></li>
<li><a href="../460967/index.html">Troy Hunt: 10 personal financial lessons for information technology professionals</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>