<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Use Spring Groovy context to create a configurable, interactive graphical UI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the late 90s, he worked in one organization that was engaged in the development of a contact electrical network and the operation of power supply u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Use Spring Groovy context to create a configurable, interactive graphical UI</h1><div class="post__text post__text-html js-mediator-article">  In the late 90s, he worked in one organization that was engaged in the development of a contact electrical network and the operation of power supply units (traction substations), plus monitored and managed this farm using a specialized hardware and software complex from several control centers.  The complex was operated by an automated process control system based on ancient Soviet iron.  Then the task was to translate this complex under windows, including the development of a graphical interface, which would display the entire network and events occurring on it and substations as a map.  And of course, would provide the ability to manage them. <a name="habracut"></a><br><br><h3>  <b>Task Description</b> </h3><br>  Technically, the task was to get data (packet-message) over the network (IP), parse it (get data about the substation and changes on it) and finally display all this in our UI client (display the changes on the map / diagram, for example, change the color of the element and make it blink).  Each substation had a specific set of sensors and counters, the data of which were contained in message packages.  It was necessary t.  to realize the possibility of a choice on the substation map and display it in a schematic form with interactive control elements, with the help of which the operator could send commands. <br><br><h3>  <b>Implementation</b> </h3><br>  As you understand, the graphic elements were quite specific and, accordingly, the use of standard ones was not possible, moreover, in fact, it was necessary to implement animation.  And then a solution was chosen using double buffering, when, with changes, the corresponding frame was drawn and they were changed with a certain frequency.  The first implementation was performed on Delphi.  But in the process of operation, we were faced with the fact that it was often necessary to change the display of the configuration of equipment and the network.  Which, in turn, each time required intervention in the source code (then writing any Delphi configurator was lazy) and even then it didn't work out very nicely).  And in 1999, I first met Java.  Then I was hooked by the technology of reflection with which a simple scripting language was created (similar to Groovy, I really didn‚Äôt hear about it then, and I couldn‚Äôt, since Groovy appeared in 2003) to describe the scheme.  It uses the same Java objects as Groovy. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Below is a fragment of the script where Tp, Bus, Lab, Led, Box is nothing but Java wrapper classes over graphic primitives allowing the implementation of the functionality described above in the task. <br><br>  <i>Root.txt</i> <br><pre><code class="java hljs">setFormFactor:<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> setResolution:<span class="hljs-number"><span class="hljs-number">700</span></span> <span class="hljs-number"><span class="hljs-number">800</span></span> setScale:<span class="hljs-number"><span class="hljs-number">0.45</span></span> setScaleStep:<span class="hljs-number"><span class="hljs-number">0.1</span></span> define:<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-string"><span class="hljs-string">"contr.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"1"</span></span> <span class="hljs-string"><span class="hljs-string">"src/1.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"2"</span></span> <span class="hljs-string"><span class="hljs-string">"src/2.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"3"</span></span> <span class="hljs-string"><span class="hljs-string">"src/3.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"1"</span></span> <span class="hljs-string"><span class="hljs-string">"dev/1.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"2"</span></span> <span class="hljs-string"><span class="hljs-string">"dev/2.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"3"</span></span> <span class="hljs-string"><span class="hljs-string">"dev/3.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"4"</span></span> <span class="hljs-string"><span class="hljs-string">"dev/4.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-string"><span class="hljs-string">"sw/0.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"1"</span></span> <span class="hljs-string"><span class="hljs-string">"sw/1.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"2"</span></span> <span class="hljs-string"><span class="hljs-string">"sw/2.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"3"</span></span> <span class="hljs-string"><span class="hljs-string">"sw/3.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"4"</span></span> <span class="hljs-string"><span class="hljs-string">"sw/4.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"5"</span></span> <span class="hljs-string"><span class="hljs-string">"sw/5.txt"</span></span> define:<span class="hljs-string"><span class="hljs-string">"6"</span></span> <span class="hljs-string"><span class="hljs-string">"sw/6.txt"</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Tp <span class="hljs-number"><span class="hljs-number">31</span></span> { busWidth:<span class="hljs-number"><span class="hljs-number">7</span></span> setColor:col.red col.green add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">523</span></span> <span class="hljs-number"><span class="hljs-number">106</span></span> <span class="hljs-number"><span class="hljs-number">627</span></span> <span class="hljs-number"><span class="hljs-number">160</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">636</span></span> <span class="hljs-number"><span class="hljs-number">164</span></span> <span class="hljs-number"><span class="hljs-number">683</span></span> <span class="hljs-number"><span class="hljs-number">190</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">689</span></span> <span class="hljs-number"><span class="hljs-number">195</span></span> <span class="hljs-number"><span class="hljs-number">741</span></span> <span class="hljs-number"><span class="hljs-number">243</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus <span class="hljs-number"><span class="hljs-number">29</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">730</span></span> <span class="hljs-number"><span class="hljs-number">268</span></span> <span class="hljs-number"><span class="hljs-number">650</span></span> <span class="hljs-number"><span class="hljs-number">268</span></span> setColor:col.black col add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Led <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">627</span></span> <span class="hljs-number"><span class="hljs-number">157</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Led <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">682</span></span> <span class="hljs-number"><span class="hljs-number">187</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Led <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">739</span></span> <span class="hljs-number"><span class="hljs-number">239</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Led <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">734</span></span> <span class="hljs-number"><span class="hljs-number">268</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> setFontSize:<span class="hljs-number"><span class="hljs-number">21</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">"5311"</span></span> <span class="hljs-number"><span class="hljs-number">590</span></span> <span class="hljs-number"><span class="hljs-number">113</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">"5312"</span></span> <span class="hljs-number"><span class="hljs-number">670</span></span> <span class="hljs-number"><span class="hljs-number">159</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">"5313"</span></span> <span class="hljs-number"><span class="hljs-number">714</span></span> <span class="hljs-number"><span class="hljs-number">187</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">"5314"</span></span> <span class="hljs-number"><span class="hljs-number">660</span></span> <span class="hljs-number"><span class="hljs-number">280</span></span> ico:<span class="hljs-number"><span class="hljs-number">655</span></span> <span class="hljs-number"><span class="hljs-number">123</span></span> box { setFontSize:<span class="hljs-number"><span class="hljs-number">24</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">"(1802)"</span></span> <span class="hljs-number"><span class="hljs-number">70</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> recall:<span class="hljs-string"><span class="hljs-string">""</span></span> setFontSize:<span class="hljs-number"><span class="hljs-number">17</span></span> setColor:col.red col.black add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-number"><span class="hljs-number">18</span></span> <span class="hljs-number"><span class="hljs-number">400</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> recall:<span class="hljs-string"><span class="hljs-string">"1"</span></span> setColor:col.white col add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> { setColor:col.black col setFontSize:<span class="hljs-number"><span class="hljs-number">12</span></span> ins:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">".5 -1808 116"</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> } recall:<span class="hljs-string"><span class="hljs-string">"2"</span></span> setColor:col.white col add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">130</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> { setColor:col.black col ins:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">".6 -1808 206"</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> } busWidth:<span class="hljs-number"><span class="hljs-number">10</span></span> setColor:col.blue col add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">180</span></span> <span class="hljs-number"><span class="hljs-number">270</span></span> <span class="hljs-number"><span class="hljs-number">180</span></span> recall:<span class="hljs-string"><span class="hljs-string">"1"</span></span> recall:<span class="hljs-string"><span class="hljs-string">"2"</span></span> recall:<span class="hljs-string"><span class="hljs-string">""</span></span> recall:<span class="hljs-string"><span class="hljs-string">"1"</span></span> recall:<span class="hljs-string"><span class="hljs-string">"2"</span></span> recall:<span class="hljs-string"><span class="hljs-string">"3"</span></span> recall:<span class="hljs-string"><span class="hljs-string">"4"</span></span> moveX:<span class="hljs-number"><span class="hljs-number">74</span></span> busWidth:<span class="hljs-number"><span class="hljs-number">10</span></span> setColor:col.blue col add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">40</span></span> <span class="hljs-number"><span class="hljs-number">300</span></span> PX <span class="hljs-number"><span class="hljs-number">300</span></span> } }</code> </pre> <br>  Here, for example, the method of <b>recall</b> , which refers to the first argument of <b>define</b> - the equivalent of <b>evaluate</b> in Groovy).  Let's see what happens there: <br><br>  <i>src / 1.txt</i> <br><pre> <code class="java hljs">setColor:col.blue col busWidth:<span class="hljs-number"><span class="hljs-number">5</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">65</span></span> <span class="hljs-number"><span class="hljs-number">60</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">120</span></span> { setColor:col.pink col add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box <span class="hljs-number"><span class="hljs-number">88</span></span> -<span class="hljs-number"><span class="hljs-number">45</span></span> <span class="hljs-number"><span class="hljs-number">40</span></span> <span class="hljs-number"><span class="hljs-number">95</span></span> <span class="hljs-number"><span class="hljs-number">40</span></span> { setColor:col.red col.green add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Led <span class="hljs-number"><span class="hljs-number">90</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Led <span class="hljs-number"><span class="hljs-number">87</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box <span class="hljs-number"><span class="hljs-number">86</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> { add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Popup { setFontSize:<span class="hljs-number"><span class="hljs-number">17</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Btn <span class="hljs-number"><span class="hljs-number">86</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> { add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Act ON <span class="hljs-number"><span class="hljs-number">131</span></span> setColor:col.black col ins:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> } add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Btn <span class="hljs-number"><span class="hljs-number">86</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">34</span></span> { add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Act OFF <span class="hljs-number"><span class="hljs-number">131</span></span> setColor:col col.red add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box <span class="hljs-number"><span class="hljs-number">131</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> { add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Act TOG <span class="hljs-string"><span class="hljs-string">""</span></span> } setColor:col.black col ins:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">25</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> } } } setFontSize:<span class="hljs-number"><span class="hljs-number">12</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> } }</code> </pre> <br>  <i>src / 2.txt</i> <br><pre> <code class="java hljs">setColor:col.blue col busWidth:<span class="hljs-number"><span class="hljs-number">5</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">180</span></span> <span class="hljs-number"><span class="hljs-number">60</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">120</span></span> { setColor:col.pink col add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box <span class="hljs-number"><span class="hljs-number">94</span></span> -<span class="hljs-number"><span class="hljs-number">45</span></span> <span class="hljs-number"><span class="hljs-number">40</span></span> <span class="hljs-number"><span class="hljs-number">95</span></span> <span class="hljs-number"><span class="hljs-number">40</span></span> { setColor:col.red col.green add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Led <span class="hljs-number"><span class="hljs-number">96</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box <span class="hljs-number"><span class="hljs-number">92</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> { add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Popup { setFontSize:<span class="hljs-number"><span class="hljs-number">17</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Btn <span class="hljs-number"><span class="hljs-number">92</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> { add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Act ON <span class="hljs-number"><span class="hljs-number">132</span></span> setColor:col.black col ins:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> } add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Btn <span class="hljs-number"><span class="hljs-number">92</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">34</span></span> { add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Act OFF <span class="hljs-number"><span class="hljs-number">132</span></span> setColor:col col.red add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box <span class="hljs-number"><span class="hljs-number">132</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> { add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Act TOG <span class="hljs-string"><span class="hljs-string">""</span></span> } setColor:col.black col ins:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">25</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> } } } setFontSize:<span class="hljs-number"><span class="hljs-number">12</span></span> add:<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> } }</code> </pre><br>  These files describe the two uppermost devices (Fig. 1) and, as you can see, there is some kind of code repeatability.  Accordingly, patterns for all complex blocks / devices are defined in this way and then re-used. <br><br><img src="https://habrastorage.org/web/f87/28d/a7f/f8728da7f58e4bafbe518ed20931ebb3.jpg" alt="image"><br>  <i>Fig.</i>  <i>1. The result of the script fragment</i> <br><br><img src="https://habrastorage.org/web/b13/982/c0e/b13982c0e941437b81983ab1f5e1b418.jpg" alt="image"><br>  <i>Fig.</i>  <i>2. Full contact network and substation map</i> <br><br>  The application in this form is still in use (although several generations of the backend changed during this time!) And the customer is completely satisfied, but all the time I unconsciously did not abandon the idea of ‚Äã‚Äãgetting rid of the existing ‚Äúbicycle‚Äù, although I want to note that in 99th year it was not yet been.  And so, with the advent of Spring 4 and the next context on Groovy, having smoked the manual, it seemed to me that I had already seen it somewhere)) (see above).  It was decided Spring Boot, Groovy-config and JavaFx - a new stack for the new GUI client ... <br><br>  Let's look at the architecture of the new solution.  And let's start with the model, which is an abstract wrapper around the javafx graphics primitives and is essentially the core of the application.  Includes a number of classes and interfaces.  The abstract class Unit is the base for creating a custom graphic element from which the map and schemes are formed. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Unit</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Render</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Logger log = LoggerFactory.getLogger(Unit.class); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer code; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> State&lt;T&gt; state; Node node; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Unit&gt; lays = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LinkedList&lt;&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Map&lt;Integer, State&gt; states)</span></span></span><span class="hljs-function"> </span></span>{ lays.forEach(e -&gt; e.init(states)); initState(states); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Map&lt;Integer, State&gt; states)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (code != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { State&lt;T&gt; state = states.get(code); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { state = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> State&lt;&gt;(code); states.put(code, state); } state.addSlave(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = state; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer code)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.code = code; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Integer </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> code; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> State&lt;T&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setGeom</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] geom)</span></span></span><span class="hljs-function"> </span></span>{ node = createShape(geom); initNodeEvents(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initNodeEvents</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { node.setOnMousePressed(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::mousePressed); node.setOnMouseReleased(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::mouseReleased); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setLays</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Unit&gt; lays)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lays = lays; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Group group)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (node != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { group.getChildren().add(node); } render(); lays.forEach(e -&gt; e.render(group)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mousePressed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MouseEvent e)</span></span></span><span class="hljs-function"> </span></span>{ log.debug(e.toString()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mouseReleased</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MouseEvent e)</span></span></span><span class="hljs-function"> </span></span>{ log.debug(e.toString()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> Node </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createShape</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] geom)</span></span></span></span>; }</code> </pre><br>  It implements the <b>Render</b> interface, which manages image changes. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Render</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre><br>  where render () is the drawing after the state change; <br>  next () - change frame. <br><br>  Each <b>Unit</b> has a List Lays nested <b>Unit</b> , which allows you to draw and control the scene by layers.  It also contains methods for capturing some mouse events. <br>  In our case, the <b>Unit</b> has a <b>FlashingUnit</b> successor: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FlashingUnit</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Unit</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Logger log = LoggerFactory.getLogger(FlashingUnit.class); <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ log.debug(<span class="hljs-string"><span class="hljs-string">"{} next()"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (getState() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; node != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { node.setVisible(!getState().isChanged() || !node.isVisible()); } } }</code> </pre><br>  which implements the frame change (blinking of changed objects) in accordance with our task. <br>  As an example, I cite the implementation of a text graphic element: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Lab</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FlashingUnit</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Integer</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Color[] color; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String text; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Double size; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Text shape; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Node </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createShape</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] geom)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Can't set text without graphic context shape = new Text(geom[0], geom[1], ""); if (size != null) { shape.setFont(Font.font(size)); } return shape; } public void setText(String text) { this.text = text; } public void setSize(Double size) { this.size = size; } public void setColor(Color[] color) { this.color = color; } @Override public void render(Group group) { super.render(group); shape.setText(text); } @Override public void render() { final Color[] c = new Color[]{color[0]}; if (getState() != null) { getState().initValue(0); c[0] = color[getState().getValue()]; } shape.setFill(c[0]); } }</span></span></code> </pre><br>  The state class is responsible for the state of graphic elements: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">State</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Render</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> T value; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> changed; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Render&gt; slaves = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LinkedList&lt;&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">synchronized</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">State</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id = id; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">synchronized</span></span></span><span class="hljs-function"> T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">synchronized</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!value.equals(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; changed = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; render(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">synchronized</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> changed; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">synchronized</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> changed)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.changed = changed; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addSlave</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Render unit)</span></span></span><span class="hljs-function"> </span></span>{ slaves.add(unit); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Platform.runLater(() -&gt; slaves.forEach(Render::render)); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Platform.runLater(() -&gt; slaves.forEach(Render::next)); } }</code> </pre><br>  which stores information about the state and its change of all elements with a common code located in the List slaves and provides a thread-safe update of subordinate elements via the <b>Render</b> interface. <br><br>  The <b>Controller</b> class extends <b>Unit</b> and is a container for all our graphic elements and states of objects belonging in this case to a separate substation with a unique <code>id</code> . <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Unit</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Root root; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Map&lt;Integer, State&gt; states = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Unit scheme; <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Controller</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Root root)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.root = root; } <span class="hljs-meta"><span class="hljs-meta">@PostConstruct</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.init(states); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (scheme != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { scheme.init(states); } root.addController(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id = id; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> State </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> code)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> states.get(code); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setScheme</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Unit scheme)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scheme = scheme; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Unit </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getScheme</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> scheme; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Node </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createShape</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] geom)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ states.values().forEach(Render::render); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ states.values().forEach(Render::next); } }</code> </pre><br>  Finally, the <b>Root</b> class, which contains the mapping of all controllers (substations): <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Root</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Render</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Map&lt;Integer, Controller&gt; controllers = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Controller controller)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (controllers.containsKey(controller.getId())) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DuplicateKeyException(String.format(<span class="hljs-string"><span class="hljs-string">"Controller id %d already exists"</span></span>,controller.getId())); } controllers.put(controller.getId(), controller); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Controller </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> controllers.get(id); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> State </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> controllerId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> code)</span></span></span><span class="hljs-function"> </span></span>{ Controller controller = controllers.get(controllerId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (controller != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> controller.getState(code); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Group group)</span></span></span><span class="hljs-function"> </span></span>{ controllers.values().stream().map(Controller::getScheme) .filter(Objects::nonNull).forEach(r -&gt; r.render(group)); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ controllers.values().forEach(Render::render); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ controllers.values().forEach(Render::next); } }</code> </pre><br>  Here we would like to note that the use of @PostConctruct init () and DI in the <b>Controller</b> allows us to dynamically create the configuration of object states and save the user from unnecessary code in the configuration script. <br><br>  And now let's see how it all looks in Groovy - the config file, which is why we created all this for ourselves: <br><br>  <i>root.groovy</i> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> scheme <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.ldim.granit.ui.model.Controller <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.ldim.granit.ui.model.shape.Box <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.ldim.granit.ui.model.shape.Bus <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.ldim.granit.ui.model.shape.Lab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.ldim.granit.ui.model.shape.Led <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javafx.scene.paint.Color suplyColor = [Color.GREEN, Color.RED] alarmColor = [Color.RED, Color.GREEN] beans { importBeans(<span class="hljs-string"><span class="hljs-string">'classpath:/scheme/srcs.groovy'</span></span>) importBeans(<span class="hljs-string"><span class="hljs-string">'classpath:/scheme/devs.groovy'</span></span>) importBeans(<span class="hljs-string"><span class="hljs-string">'classpath:/scheme/sws.groovy'</span></span>) importBeans(<span class="hljs-string"><span class="hljs-string">'classpath:/scheme/tsns.groovy'</span></span>) importBeans(<span class="hljs-string"><span class="hljs-string">'classpath:/scheme/ctrls.groovy'</span></span>) controller2(Controller) { id = <span class="hljs-number"><span class="hljs-number">2</span></span> lays = [dev1] } tp9scheme(Bus) { code = <span class="hljs-number"><span class="hljs-number">5</span></span> color = suplyColor width = <span class="hljs-number"><span class="hljs-number">6</span></span> geom = [<span class="hljs-number"><span class="hljs-number">653</span></span>, <span class="hljs-number"><span class="hljs-number">764</span></span>, <span class="hljs-number"><span class="hljs-number">698</span></span>, <span class="hljs-number"><span class="hljs-number">687</span></span>, <span class="hljs-number"><span class="hljs-number">701</span></span>, <span class="hljs-number"><span class="hljs-number">631</span></span>] lays = [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus(code: <span class="hljs-number"><span class="hljs-number">29</span></span>, color: suplyColor, width: <span class="hljs-number"><span class="hljs-number">6</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">701</span></span>, <span class="hljs-number"><span class="hljs-number">631</span></span>, <span class="hljs-number"><span class="hljs-number">701</span></span>, <span class="hljs-number"><span class="hljs-number">602</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus(code: <span class="hljs-number"><span class="hljs-number">6</span></span>, color: suplyColor, width: <span class="hljs-number"><span class="hljs-number">6</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">701</span></span>, <span class="hljs-number"><span class="hljs-number">602</span></span>, <span class="hljs-number"><span class="hljs-number">705</span></span>, <span class="hljs-number"><span class="hljs-number">560</span></span>, <span class="hljs-number"><span class="hljs-number">840</span></span>, <span class="hljs-number"><span class="hljs-number">591</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Led(geom:[<span class="hljs-number"><span class="hljs-number">4.5</span></span>, <span class="hljs-number"><span class="hljs-number">701</span></span>, <span class="hljs-number"><span class="hljs-number">631</span></span>, <span class="hljs-number"><span class="hljs-number">701</span></span>, <span class="hljs-number"><span class="hljs-number">602</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab(text: <span class="hljs-string"><span class="hljs-string">'5092'</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">705</span></span>, <span class="hljs-number"><span class="hljs-number">684</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab(text: <span class="hljs-string"><span class="hljs-string">'5094'</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">715</span></span>, <span class="hljs-number"><span class="hljs-number">612</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab(text: <span class="hljs-string"><span class="hljs-string">'5093'</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">764</span></span>, <span class="hljs-number"><span class="hljs-number">544</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab(text: <span class="hljs-string"><span class="hljs-string">'19 '</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">595</span></span>, <span class="hljs-number"><span class="hljs-number">630</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box(code: <span class="hljs-number"><span class="hljs-number">129</span></span>, color: alarmColor, geom: [<span class="hljs-number"><span class="hljs-number">598</span></span>, <span class="hljs-number"><span class="hljs-number">593</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box(code: <span class="hljs-number"><span class="hljs-number">130</span></span>, color: alarmColor, geom: [<span class="hljs-number"><span class="hljs-number">598</span></span>, <span class="hljs-number"><span class="hljs-number">603</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box(color: [Color.GRAY], geom: [<span class="hljs-number"><span class="hljs-number">608</span></span>, <span class="hljs-number"><span class="hljs-number">593</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>], lays: [<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Lab(size: <span class="hljs-number"><span class="hljs-number">11</span></span>, text: <span class="hljs-string"><span class="hljs-string">'9'</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">613</span></span>, <span class="hljs-number"><span class="hljs-number">607</span></span>])])] } tp9(Controller) { id = <span class="hljs-number"><span class="hljs-number">3</span></span> lays = [src1, src2, src3, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus (color: [Color.BLUE], width: <span class="hljs-number"><span class="hljs-number">8</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">176</span></span>, <span class="hljs-number"><span class="hljs-number">380</span></span>, <span class="hljs-number"><span class="hljs-number">176</span></span>]), dev1, dev2, dev3, dev4, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus (color: [Color.BLUE], width: <span class="hljs-number"><span class="hljs-number">8</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">276</span></span>, <span class="hljs-number"><span class="hljs-number">585</span></span>, <span class="hljs-number"><span class="hljs-number">276</span></span>]), sw0, sw1, sw2, sw3, sw4, sw5, sw6, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bus (code: <span class="hljs-number"><span class="hljs-number">12</span></span>, color: suplyColor, width: <span class="hljs-number"><span class="hljs-number">8</span></span>, geom: [<span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">350</span></span>, <span class="hljs-number"><span class="hljs-number">615</span></span>, <span class="hljs-number"><span class="hljs-number">350</span></span>]), lbl0, lbl1, lbl2, lbl3, lbl4, tsn1, tsn2, reqBtn, tstBtn, secBtn, okBtn] scheme = tp9scheme } }</code> </pre><br>  <i>srcs.groovy</i> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> scheme beanName = <span class="hljs-string"><span class="hljs-string">'src1'</span></span> offsetX = <span class="hljs-number"><span class="hljs-number">0</span></span> reserved = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> devCode = <span class="hljs-number"><span class="hljs-number">1</span></span> swCode = <span class="hljs-number"><span class="hljs-number">11</span></span> led1Code = <span class="hljs-number"><span class="hljs-number">11</span></span> led2Code = <span class="hljs-number"><span class="hljs-number">11</span></span> evaluate(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(<span class="hljs-string"><span class="hljs-string">"./src/main/resources/scheme/templates/src.groovy"</span></span>)) beanName = <span class="hljs-string"><span class="hljs-string">'src2'</span></span> offsetX = <span class="hljs-number"><span class="hljs-number">120</span></span> reserved = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> devCode = <span class="hljs-number"><span class="hljs-number">1</span></span> swCode = <span class="hljs-number"><span class="hljs-number">11</span></span> led1Code = <span class="hljs-number"><span class="hljs-number">11</span></span> led2Code = <span class="hljs-number"><span class="hljs-number">11</span></span> evaluate(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(<span class="hljs-string"><span class="hljs-string">"./src/main/resources/scheme/templates/src.groovy"</span></span>)) beanName = <span class="hljs-string"><span class="hljs-string">'src3'</span></span> offsetX = <span class="hljs-number"><span class="hljs-number">240</span></span> reserved = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> devCode = <span class="hljs-number"><span class="hljs-number">1</span></span> swCode = <span class="hljs-number"><span class="hljs-number">11</span></span> led1Code = <span class="hljs-number"><span class="hljs-number">11</span></span> led2Code = <span class="hljs-number"><span class="hljs-number">11</span></span> evaluate(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(<span class="hljs-string"><span class="hljs-string">"./src/main/resources/scheme/templates/src.groovy"</span></span>))</code> </pre><br>  <i>src.groovy</i> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> scheme.templates <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.ldim.granit.ui.model.shape.Box <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.ldim.granit.ui.model.shape.Bus <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.ldim.granit.ui.model.shape.Lab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.ldim.granit.ui.model.shape.Led <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javafx.scene.paint.Color devX = <span class="hljs-number"><span class="hljs-number">40</span></span> devY = <span class="hljs-number"><span class="hljs-number">100</span></span> beans { <span class="hljs-string"><span class="hljs-string">"${beanName}led1"</span></span>(Led) { bean -&gt; bean.scope = <span class="hljs-string"><span class="hljs-string">'prototype'</span></span> code = led1Code color = [Color.GREEN, Color.RED] geom = [<span class="hljs-number"><span class="hljs-number">9</span></span>, devX + <span class="hljs-number"><span class="hljs-number">14</span></span> + offsetX, devY + <span class="hljs-number"><span class="hljs-number">16</span></span>] } <span class="hljs-string"><span class="hljs-string">"${beanName}lbl1"</span></span>(Lab) { bean -&gt; bean.scope = <span class="hljs-string"><span class="hljs-string">'prototype'</span></span> code = devCode text = <span class="hljs-string"><span class="hljs-string">''</span></span> size = <span class="hljs-number"><span class="hljs-number">9</span></span> color = [Color.BLACK, Color.BLACK] geom = [devX + <span class="hljs-number"><span class="hljs-number">5</span></span> + offsetX, devY + <span class="hljs-number"><span class="hljs-number">35</span></span>] } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reserved) { <span class="hljs-string"><span class="hljs-string">"${beanName}led2"</span></span>(Led) { bean -&gt; bean.scope = <span class="hljs-string"><span class="hljs-string">'prototype'</span></span> code = led2Code color = [Color.GREEN, Color.RED] geom = [<span class="hljs-number"><span class="hljs-number">9</span></span>, devX + <span class="hljs-number"><span class="hljs-number">38</span></span> + offsetX, devY + <span class="hljs-number"><span class="hljs-number">16</span></span>] } <span class="hljs-string"><span class="hljs-string">"${beanName}lbl2"</span></span>(Lab) { bean -&gt; bean.scope = <span class="hljs-string"><span class="hljs-string">'prototype'</span></span> code = devCode text = <span class="hljs-string"><span class="hljs-string">''</span></span> size = <span class="hljs-number"><span class="hljs-number">9</span></span> color = [Color.BLACK, Color.BLACK] geom = [devX + <span class="hljs-number"><span class="hljs-number">30</span></span> + offsetX, devY + <span class="hljs-number"><span class="hljs-number">35</span></span>] } } <span class="hljs-string"><span class="hljs-string">"${beanName}btn"</span></span>(Box) { bean -&gt; bean.scope = <span class="hljs-string"><span class="hljs-string">'prototype'</span></span> code = swCode color = [Color.GREEN, Color.RED] press = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> geom = [devX + <span class="hljs-number"><span class="hljs-number">66</span></span> + offsetX, devY + <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>] } <span class="hljs-string"><span class="hljs-string">"${beanName}box"</span></span>(Box) { bean -&gt; bean.scope = <span class="hljs-string"><span class="hljs-string">'prototype'</span></span> code = devCode color = [Color.GRAY, Color.PINK] geom = [devX + offsetX, devY, <span class="hljs-number"><span class="hljs-number">95</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>] lays = reserved ? [ref(<span class="hljs-string"><span class="hljs-string">"${beanName}btn"</span></span>), ref(<span class="hljs-string"><span class="hljs-string">"${beanName}led1"</span></span>), ref(<span class="hljs-string"><span class="hljs-string">"${beanName}lbl1"</span></span>), ref(<span class="hljs-string"><span class="hljs-string">"${beanName}led2"</span></span>), ref(<span class="hljs-string"><span class="hljs-string">"${beanName}lbl2"</span></span>)] : [ref(<span class="hljs-string"><span class="hljs-string">"${beanName}btn"</span></span>), ref(<span class="hljs-string"><span class="hljs-string">"${beanName}led1"</span></span>), ref(<span class="hljs-string"><span class="hljs-string">"${beanName}lbl1"</span></span>)] } <span class="hljs-string"><span class="hljs-string">"${beanName}"</span></span>(Bus) { bean -&gt; bean.scope = <span class="hljs-string"><span class="hljs-string">'prototype'</span></span> color = [Color.BLUE] width = <span class="hljs-number"><span class="hljs-number">4</span></span> geom = [devX + <span class="hljs-number"><span class="hljs-number">77</span></span> + offsetX, devY - <span class="hljs-number"><span class="hljs-number">30</span></span>, devX + <span class="hljs-number"><span class="hljs-number">77</span></span> + offsetX, devY + <span class="hljs-number"><span class="hljs-number">70</span></span>] lays = [ref(<span class="hljs-string"><span class="hljs-string">"${beanName}box"</span></span>)] } }</code> </pre><br>  Now, using Groovy's capabilities, we can create various configurations of hardware circuits from existing graphics primitives without project reassembly.  And to effectively reuse the existing code (I specifically showed here the srcs.groovy and src.groovy files).  The prototype sources are <a href="https://bitbucket.org/Ldim/granit-ui">here</a> . <br><br><h3>  <b>Conclusion</b> </h3><br>  A modern stack of Java technologies makes it possible to implement efficient and non-standard things without the use of bicycles, relatively easily and within a reasonable time.  Without knowing Groovy and JavaFx itself, the prototype of the new application was implemented on the ‚Äúknees‚Äù in a few days.  And, more importantly, we created our application using powerful and open standards for Java production development. </div><p>Source: <a href="https://habr.com/ru/post/328402/">https://habr.com/ru/post/328402/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328386/index.html">Beware of transparent pixels</a></li>
<li><a href="../328388/index.html">Business mail should be unlimited</a></li>
<li><a href="../328390/index.html">Loyalty programs: how shops heat up customer interest</a></li>
<li><a href="../328394/index.html">Google I / O Extended 2017 in 20 cities of Russia</a></li>
<li><a href="../328398/index.html">EPAM FRONT-END OPEN DAY</a></li>
<li><a href="../328404/index.html">How on Instagram disconnected the Python garbage collector and started living</a></li>
<li><a href="../328406/index.html">The tragedy of one hundred percent code coverage</a></li>
<li><a href="../328408/index.html">Essentialism and decision theory</a></li>
<li><a href="../328410/index.html">‚ÄúThey didn‚Äôt come up with anything, improvise‚Äù or Agile in information security</a></li>
<li><a href="../328412/index.html">Your idea is nonsense.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>