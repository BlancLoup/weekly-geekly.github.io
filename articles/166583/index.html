<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>It is so easy to take and hide information</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Each of the readers must have seen films many times where a superhero / supervillain passed on encrypted information. We are accustomed to the word "c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>It is so easy to take and hide information</h1><div class="post__text post__text-html js-mediator-article">  Each of the readers must have seen films many times where a superhero / supervillain passed on encrypted information.  We are accustomed to the word "cipher", "encryption" and any secret transfer of information is now associated with these words.  Although in reality, this is far from the case.  Secure transmission of information is far from being limited to cryptography (encryption), but there are still many methods and means for this. <a name="habracut"></a><br><img src="https://habrastorage.org/storage2/ad3/3af/a46/ad33afa4661b044dd5a355d90b9041a3.jpg"><br>  In particular, the author of this material would like to touch on steganography.  Steganography is the concealment of the fact of information transfer. <br><br>  <b>How is this fundamentally different from cryptography?</b> <br>  In the case of cryptographic transformations, the fact of hiding information is obvious.  That is, when A transmits information to B, then C knows that the information is secret, but does not have (at best) algorithms for its decryption if it falls into his hands. <br><br>  <u>Steganographic transformations of the message allow you to hide the fact of the transfer of secret information from the attacker.</u>  That is, C may also notice the exchange of information between A and B, but will not see anything of value in it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>The steganographic method better cryptographic.</b> <br>  Hiding the fact of information transfer reduces the risk that secret or confidential information will get to the attacker, and even if it does, he may not see anything valuable in it (why - we will explain below). <br><br>  This is only in the films the secret information of the hero is provided with an impenetrable cipher.  In real life, the attacker will send two hefty G. and D. to the hero, who after another broken joint will still know the key for decryption. <br><br>  In the case of a stego message, the attacker will not even be motivated for such actions, because the stego message does not attract attention. <br><br>  <b>So how does it work?</b> <br>  The main principle of steganography is to hide confidential information inside the open, usually all-accessible information.  That is, one type of information (text, images, audio, etc.) is placed inside other information (text, images, audio, etc.).  Thus, a container (information that carries a stego message) looks more than harmless. <br><br>  The most common of the methods that the reader can find on the Internet is hiding text in an image. <br>  Right in this material we will write a program that will hide a small message in the image.  We will write in PHP, so we will have a web program. <br><br>  To get started, let's write an html page without too much design (this is not a web design lesson yet).  Hence the index.php file: <br><br><pre><code class="html hljs xml">: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"url"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"url"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"url"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"code"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"code"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> &gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"img_new"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  I think there is no need to specifically explain that the ‚ÄúAddress‚Äù field will contain the image address, and in the ‚ÄúCode‚Äù field - some hidden information.  The purpose of the buttons is also obvious.  The img_new block will contain the initial information, including the finished container with a stego message in it. <br><br>  When developing we will use the Ajax framework, or rather exactly one of its functions.  Therefore, let's connect this framework and one of our js files to index.php. <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ajax.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stego.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The algorithms will occur in the files stego.php and destego.php.  We link them to our index using two functions of our java script: stego (), de_stego (). <br><br>  So, stego.js: <div class="spoiler">  <b class="spoiler_title">stego.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stego</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url, code</span></span></span><span class="hljs-function">) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#img_new"</span></span>).html(<span class="hljs-string"><span class="hljs-string">""</span></span>); $.ajax({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">"stego.php"</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-string"><span class="hljs-string">'url_img='</span></span>+url+<span class="hljs-string"><span class="hljs-string">'&amp;stego_code='</span></span>+code+<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">cache</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">success</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">html</span></span></span><span class="hljs-function">)</span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#img_new"</span></span>).html(html); } }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">de_stego</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function">) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#img_new"</span></span>).html(<span class="hljs-string"><span class="hljs-string">""</span></span>); $.ajax({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">"destego.php"</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-string"><span class="hljs-string">'url_img='</span></span>+url+<span class="hljs-string"><span class="hljs-string">'&amp;stego_code='</span></span>+code+<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">cache</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">success</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">html</span></span></span><span class="hljs-function">)</span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#img_new"</span></span>).html(html); } }); }</code> </pre></div></div><br><br>  Each of these functions first clears the img_new block, then sends the corresponding data from the fields that the user enters to the server, where they are further processed by our program.  Finally, the data returned is output to the img_new block. <br><br>  Change the buttons so that when you click the corresponding functions are called: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stego(document.getElementById('url').value,document.getElementById('code').value)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"de_stego(document.getElementById('url').value)"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  We now turn to the most interesting, to the transformations.  First consider the file stego.php. <br><br>  Before we add the verification of the image address <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$_POST[url_img]) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"  "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(); }</code> </pre> <br><br>  And image type checking.  We assume that the user will use only the most common formats: jpg, gif, png.  Otherwise, the program will also try to load the image, but success depends on the corresponding PHP build. <br><br><pre> <code class="php hljs">$type_img = explode (<span class="hljs-string"><span class="hljs-string">"."</span></span>, $_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(strtolower($type_img[count($type_img)<span class="hljs-number"><span class="hljs-number">-1</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"png"</span></span>: $img1 = imagecreatefrompng($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"jpg"</span></span>: $img1 = imagecreatefromjpeg($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"jpeg"</span></span>: $img1 = imagecreatefromjpeg($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"gif"</span></span>: $img1 = imagecreatefromgif($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: $img1 = imagecreatefromgd ($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre><br>  It should be noted here that hosters often do not include the GD graphic library in PHP.  If the program will not work for you - contact your hosting provider with this question. <br><br>  Let's continue ... <br><br>  We display the image of the user on the screen in png format.  Why this particular format?  Because we will also display another image in png.  So it will be better to compare the images between them. <br><br><pre> <code class="php hljs">imagepng ($img1, <span class="hljs-string"><span class="hljs-string">"img/img_code1"</span></span>.date(si).<span class="hljs-string"><span class="hljs-string">".png"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">" : &lt;img src='img/img_code1"</span></span>.date(si).<span class="hljs-string"><span class="hljs-string">".png' width='400px'&gt;"</span></span>;</code> </pre> <br><br>  Next, we determine the size of the image, set the initial x, y coordinates, find out the length of the message, and put the messages in the $ code working variable. <br><br><pre> <code class="php hljs">$size = getimagesize($_POST[url_img]); $w = $size[<span class="hljs-number"><span class="hljs-number">0</span></span>]; $h = $size[<span class="hljs-number"><span class="hljs-number">1</span></span>]; $x = $y = <span class="hljs-number"><span class="hljs-number">0</span></span>; $length = strlen($_POST[stego_code]); $code = $_POST[stego_code];</code> </pre> <br><br>  Next comes the fun part.  Namely, the cycle in which our message gets into the image.  First we give the code, and then we will analyze: <br><br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($length--) { $color_pixel = imagecolorat ($img1, $x, $y); $color_pixel_RGB = imagecolorsforindex ($img1, $color_pixel); $color_pixel_RGB[blue] = ord ($code[$length]); $color_new_pixel = imagecolorclosest ($img1, $color_pixel_RGB[red], $color_pixel_RGB[green], $color_pixel_RGB[blue]); imagesetpixel ($img1, $x, $y, $color_new_pixel); $x+=<span class="hljs-number"><span class="hljs-number">50</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($x&gt;$w) {$x=<span class="hljs-number"><span class="hljs-number">0</span></span>; $y++;} }</code> </pre><br><br>  The cycle will be repeated until we reach the end of the message.  In addition, we will start with the last character.  First, we recognize the color of the pixel by the x, y coordinates ($ color_pixel = imagecolorat ($ img1, $ x, $ y);), put in the $ color_pixel_RGB array the ratio of the red, green and blue colors in pixels. <br><br>  Please pay attention to the line: $ color_pixel_RGB [blue] = ord ($ code [$ length]) - This is where the blue color level is replaced with the character number of the message in the ASCII table.  This is convenient because they should not exaggerate the number 255 as well as the value of the variable, respectively, RGB.  The author randomly chose blue.  You can try with any other (green or red), which in this program remain intact, except in one case, which will be next. <br><br>  Later in the cycle, the pixel is applied to the new image and the coordinates are increased.  If they exceed the width of the image, then the value of the coordinate along the height (y) increases, and x equals zero. <br>  This is not a tricky way, we have hidden our message in the image. <br><br>  But how does the program find out when the stego message is deleted that the message has ended?  To do this, in the last pixel message, change the red level to 1. <br><br><pre> <code class="php hljs"> $color_new_pixel = imagecolorclosest ($img1, <span class="hljs-number"><span class="hljs-number">1</span></span>, $color_pixel_RGB[green], $color_pixel_RGB[blue]); imagesetpixel ($img1, $x, $y, $color_new_pixel);</code> </pre> <br><br>  And display a new image on the screen: <br><br><pre> <code class="php hljs"> imagepng ($img1, <span class="hljs-string"><span class="hljs-string">"img/img_code2"</span></span>.date(si).<span class="hljs-string"><span class="hljs-string">".png"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">" : &lt;img src='img/img_code2"</span></span>.date(si).<span class="hljs-string"><span class="hljs-string">".png' width='400px'&gt;"</span></span>;</code> </pre> <br><br>  Thus, the stego.php file is ready and looks like this: <br><div class="spoiler">  <b class="spoiler_title">stego.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$_POST[url_img]) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"—ñ —ñ —ñ"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(); } $type_img = explode (<span class="hljs-string"><span class="hljs-string">"."</span></span>, $_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(strtolower($type_img[count($type_img)<span class="hljs-number"><span class="hljs-number">-1</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"png"</span></span>: $img1 = imagecreatefrompng($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"jpg"</span></span>: $img1 = imagecreatefromjpeg($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"jpeg"</span></span>: $img1 = imagecreatefromjpeg($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"gif"</span></span>: $img1 = imagecreatefromgif($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: $img1 = imagecreatefromgd ($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } imagepng ($img1, <span class="hljs-string"><span class="hljs-string">"img/img_code1"</span></span>.date(si).<span class="hljs-string"><span class="hljs-string">".png"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">" : &lt;img src='img/img_code1"</span></span>.date(si).<span class="hljs-string"><span class="hljs-string">".png' width='400px'&gt;"</span></span>; $size = getimagesize($_POST[url_img]); $w = $size[<span class="hljs-number"><span class="hljs-number">0</span></span>]; $h = $size[<span class="hljs-number"><span class="hljs-number">1</span></span>]; $x = $y = <span class="hljs-number"><span class="hljs-number">0</span></span>; $length = strlen($_POST[stego_code]); $code = $_POST[stego_code]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($length--) { $color_pixel = imagecolorat ($img1, $x, $y); $color_pixel_RGB = imagecolorsforindex ($img1, $color_pixel); $color_pixel_RGB[blue] = ord ($code[$length]); $color_new_pixel = imagecolorclosest ($img1, $color_pixel_RGB[red],$color_pixel_RGB[green], $color_pixel_RGB[blue]); imagesetpixel ($img1, $x, $y, $color_new_pixel); $x+=<span class="hljs-number"><span class="hljs-number">50</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($x&gt;$w) {$x=<span class="hljs-number"><span class="hljs-number">0</span></span>; $y++;} } $color_new_pixel = imagecolorclosest ($img1, <span class="hljs-number"><span class="hljs-number">1</span></span>, $color_pixel_RGB[green], $color_pixel_RGB[blue]); imagesetpixel ($img1, $x, $y, $color_new_pixel); imagepng ($img1, <span class="hljs-string"><span class="hljs-string">"img/img_code2"</span></span>.date(si).<span class="hljs-string"><span class="hljs-string">".png"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">" : &lt;img src='img/img_code2"</span></span>.date(si).<span class="hljs-string"><span class="hljs-string">".png' width='400px'&gt;"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> </div></div><br><br>  Now let's move on to the second function, since what's the point in hiding information, if we cannot then pull it out ourselves? <br><br>  And so the file destego.php. <br><br>  Half the code is the same as the code stego.php: <br><div class="spoiler">  <b class="spoiler_title">destego half</b> <div class="spoiler_text"><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$_POST[url_img]) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"  "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(); } $type_img = explode (<span class="hljs-string"><span class="hljs-string">"."</span></span>, $_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(strtolower($type_img[count($type_img)<span class="hljs-number"><span class="hljs-number">-1</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"png"</span></span>: $img1 = imagecreatefrompng($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"jpg"</span></span>: $img1 = imagecreatefromjpeg($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"jpeg"</span></span>: $img1 = imagecreatefromjpeg($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"gif"</span></span>: $img1 = imagecreatefromgif($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: $img1 = imagecreatefromgd ($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">" : &lt;img src='"</span></span>.$_POST[url_img].<span class="hljs-string"><span class="hljs-string">"' width='400px'&gt;    "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">": "</span></span>; $size = getimagesize($_POST[url_img]); $w = $size[<span class="hljs-number"><span class="hljs-number">0</span></span>]; $h = $size[<span class="hljs-number"><span class="hljs-number">1</span></span>]; $x = $y = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> </div></div><br>  Here we already know the checks for entering information, loading an image and displaying it on the screen. <br><br>  Next is the cycle that pulls our information from the image: <br><br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($color_pixel_RGB[red]!=<span class="hljs-number"><span class="hljs-number">1</span></span>) { $color_pixel = imagecolorat ($img1, $x, $y); $color_pixel_RGB = imagecolorsforindex ($img1, $color_pixel); $text = chr($color_pixel_RGB[blue]).$text; $x+=<span class="hljs-number"><span class="hljs-number">50</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($x&gt;$w) {$x=<span class="hljs-number"><span class="hljs-number">0</span></span>; $y++;} } ;</code> </pre> <br><br>  The cycle will continue until it finds the end of the message indicated by us. <br>  One by one, the pixel will be checked along the same route as when the message was inserted and extract character by character. <br><br>  Display a message. <br><pre> <code class="php hljs"> $text[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $text;</code> </pre><br>  $ Text [0] = "" is necessary because the first character remains empty and can be filled with any "garbage". <br><br>  And so, destego.php looks like this: <br><div class="spoiler">  <b class="spoiler_title">destego.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$_POST[url_img]) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"  "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(); } $type_img = explode (<span class="hljs-string"><span class="hljs-string">"."</span></span>, $_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(strtolower($type_img[count($type_img)<span class="hljs-number"><span class="hljs-number">-1</span></span>])) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"png"</span></span>: $img1 = imagecreatefrompng($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"jpg"</span></span>: $img1 = imagecreatefromjpeg($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"jpeg"</span></span>: $img1 = imagecreatefromjpeg($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"gif"</span></span>: $img1 = imagecreatefromgif($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: $img1 = imagecreatefromgd ($_POST[url_img]); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">" : &lt;img src='"</span></span>.$_POST[url_img].<span class="hljs-string"><span class="hljs-string">"' width='400px'&gt;    "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">": "</span></span>; $size = getimagesize($_POST[url_img]); $w = $size[<span class="hljs-number"><span class="hljs-number">0</span></span>]; $h = $size[<span class="hljs-number"><span class="hljs-number">1</span></span>]; $x = $y = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($color_pixel_RGB[red]!=<span class="hljs-number"><span class="hljs-number">1</span></span>) { $color_pixel = imagecolorat ($img1, $x, $y); $color_pixel_RGB = imagecolorsforindex ($img1, $color_pixel); $text = chr($color_pixel_RGB[blue]).$text; $x+=<span class="hljs-number"><span class="hljs-number">50</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($x&gt;$w) {$x=<span class="hljs-number"><span class="hljs-number">0</span></span>; $y++;} } ; $text[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $text; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> </div></div><br><br>  So, <a href="http://technocrat.org.ua/prog/stego/">our program is on the Internet</a> .  So it looks like: <br><img src="https://habrastorage.org/storage2/b43/a08/003/b43a080034294a608f64c86feaef54a9.png"><br><br>  <a href="">Enter the address of the image</a> . <br>  Enter the message of the author of the material: Sergey Osadchy <br>  Click "Hide" and get the original image: <br><img src="https://habrastorage.org/storage2/fe2/5f0/c21/fe25f0c21aa9d476000241929b43ba53.png"><br><div class="spoiler">  <b class="spoiler_title">Input Image:</b> <div class="spoiler_text"><img src="http://technocrat.org.ua/prog/stego/img/img_code13139.png" alt="image"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Original Image:</b> <div class="spoiler_text"><img src="http://technocrat.org.ua/prog/stego/img/img_code23139.png" alt="image"><br></div></div><br>  As you can see, the image is identical. <br><br>  We copy the address of the original image, paste it into the address of the image and click "Withdraw".  We get: <br><img src="https://habrastorage.org/storage2/ce9/c2d/c51/ce9c2dc512257d6f0858955bace9ad9c.png"><br>  <a href="http://technocrat.org.ua/prog/stego/">You can make sure yourself.</a> <br><br>  So, our web program works.  But it only has an educational function for those who are not familiar or have little knowledge of steganography.  Steganographic method carries a lot of opportunities for the hidden transfer of confidential information.  Algorithms can be complicated and combined with other methods (add keys, cryptography and organizational issues), thus increasing the container's stegacity. <br><br>  In the following articles, the author will tell more about steganography and other methods of protecting information, both during its storage and transmission. <br><br>  PS Do not be too hard on the author.  This is my first article on Habr√©.  Thank! </div><p>Source: <a href="https://habr.com/ru/post/166583/">https://habr.com/ru/post/166583/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../166569/index.html">Build a business, not a ‚Äúexit strategy‚Äù</a></li>
<li><a href="../166571/index.html">Free NetWrix software license codes</a></li>
<li><a href="../166575/index.html">Scalable image display</a></li>
<li><a href="../166577/index.html">New design Lenta.ru</a></li>
<li><a href="../166579/index.html">Acer S275 Mini Monitor Review</a></li>
<li><a href="../166585/index.html">Comfortable work at the computer at night</a></li>
<li><a href="../166587/index.html">Convenient CSS editing (Chrome + Save CSS + autoIt)</a></li>
<li><a href="../166589/index.html">We continue to invent function</a></li>
<li><a href="../166593/index.html">Case in the ocean</a></li>
<li><a href="../166595/index.html">The most reliable storage medium</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>