<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>YACTL: Another Christmas tree garland</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Why? 
 Before the new year, many decorate and decorate Christmas trees with all sorts of trinkets and, of course, a garland of lights. 
 On Habr√©, the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>YACTL: Another Christmas tree garland</h1><div class="post__text post__text-html js-mediator-article"><h2>  Why? </h2><br>  Before the new year, many decorate and decorate Christmas trees with all sorts of trinkets and, of course, a garland of lights. <br>  On Habr√©, there have recently been several variations on homemade garlands, but there are less than 100,500 and therefore I thought that this was clearly not enough.  In order not to anger the spirit of the New Year, I bring my version of Christmas tree garland as a gift to this great spirit. <br><br>  Also, this project was conceived as part of primary education for his son in the style of ‚ÄúI do and tell what, how and why, and the son looks and asks tricky questions on the subject and not so much‚Äù.  For this reason, I tried to make everything as simple and affordable as possible. <br><br><img src="https://habrastorage.org/files/a6d/7bc/658/a6d7bc658b6f4dd9aeed139b9ae09eb1.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h2>  Of what? </h2><br>  Rummaging a bit in my boxes, I found several tapes of individually addressable RGB LEDs.  In the wild, they have different names - WS2801, WS2811, WS2812, Neopixels, etc. <br>  The main highlight of these tapes is that you can control any RGB LED individually and change the RGB color components and brightness. <br><br>  The differences between the tapes are electrical.  If it is very rough, then they can be described something like this: <br>  <a href="http://cdn.durdom.com/WS2801.pdf">WS2801</a> is the very first version.  Data is transmitted via two signal wires - DATA and CLOCK.  The power they have is usually 12 volts.  RGB LED is connected separately. <br>  <a href="http://cdn.durdom.com/WS2811.pdf">WS2811</a> is a newer version.  Data is transmitted over a single wire - DATA.  There is no CLOCK signal, since the WS2811 controller itself considers time intervals and it is necessary to follow them in its code.  Usually powered by 5 volts.  RGB LED is also connected separately. <br>  <a href="http://cdn.durdom.com/WS2812.pdf">WS2812</a> is the same as WS2811, but is built into the LED (for example, 5050), so it makes the tape more compact and with a more dense arrangement of the LEDs.  Usually powered by 5 volts.  Chip-LED has 6 pins. <br>  <a href="http://cdn.durdom.com/WS2812B.pdf">WS2812B</a> is like WS2812, but with the difference that the power supply for the LEDs and the microcircuit itself is combined (all options have a higher power supply separate).  Chip-LED has 4 outputs. <br><br>  Any variations of LED strips can be bought on eBay, Alibaba / AliExpress and in stores of this type. <br><br>  In terms of programming, the difference is very nicely smoothed using the <a href="https://github.com/FastLED/FastLED">FastLED @ GitHub</a> library.  That is, you can easily combine different types of programmable tapes in one project, which I did not hesitate to use.  The son, however, did not appreciate papa's resourcefulness and convenience of the library. <br><br>  I found three tapes here: one based on the WS2801 controller (25 LEDs) and two based on the WS2811 controller (20 and 15 LEDs).  Total 60 LEDs get puppy joy. <br>  Two WS2811 I connected together in series. <br><br>  As the inquisitive mind of the reader has already guessed, a controller is needed to control such LED strips.  Initially, I planned to use the Arduino Pro Mini board because of its compactness and readiness, but for some reason I did not find one in my bottomless bins.  But I found <a href="https://www.pjrc.com/teensy/teensy31.html">Teensy 3.1</a> (Cortex-M4 @ 72MHz, 256KB Flash, 64KB RAM).  This is a little overkill, but better a lot than a little. <br><br>  Since I use 12 and 5 volt tapes together, I powered the whole circuit from a 12V / 1A power supply with conversion to 5 volts to power the second tape and the microcontroller board.  I transformed the pulse DC-DC module KIS-3R33S based on MP2307DN, which gives up to 3A at the output and almost does not heat up.  Of course, the module can be replaced with something like 7805, but it will be necessary to take care of proper cooling (this is about 1-1.5 watts for every 10 LEDs). <br><br><img src="https://habrastorage.org/files/ccf/4cf/046/ccf4cf046fc74760a52c54aa791c9e60.jpg"><br><br><h4>  List of components: </h4><br><ul><li>  Custom addressable LED strips based on WS2801, WS2811, etc. </li><li>  12V / 1A power supply.  At maximum brightness, 60 LEDs consumed about 800 mA.  I turn them on half-brightness and get 400 mA of consumption </li><li>  Module microcontroller Teensy 3.1.  Also Arduino or other suitable module or microcontroller will do. </li><li>  DC-DC converter KIS-3R33S.  There are many options and it all depends on the power requirements. </li></ul><br><br><img src="https://habrastorage.org/files/6fd/685/1e5/6fd6851e5c054b02ab1ca8de9bdb3b93.jpg"><br><br><h2>  How to connect? </h2><br>  There is practically no scheme, since everything is connected quite simply: <br>  Teensy 3.1 is powered by 5 volts.  On these 5 volts sits a WS2811 ribbon.  At 12 volts sits a tape based on WS2801. <br>  WS2801 tape is connected to Teensy 3.1 like this: DATA - 11, CLOCK - 13. <br>  WS2811 tape is connected to Teensy 3.1: DATA - 14. <br><br><img src="https://habrastorage.org/files/e09/84d/a2f/e0984da2f6c5408e978548ca1b56b3d6.png"><br><br>  A bundle of wires and parts was successfully crammed into a box for storing four AA elements.  I usually collect something so simple and quick in such boxes. <br><br><img src="https://habrastorage.org/files/490/caf/d03/490cafd039de48219286fafdfe78f4ef.jpg"><br><br><h2>  What is magic? </h2><br>  Magic in the code that controls all this disgrace and enthralls three-year-old son. <br>  I posted my code on GitHub: <a href="https://github.com/nochkin/LightBottle">github.com/nochkin/LightBottle</a> (I need the <a href="https://github.com/FastLED/FastLED">github.com/FastLED/FastLED</a> library) <br>  In the code, everything is quite simple - a pseudo-random color is chosen, into which the LED smoothly changes and the current color moves on along the LED strip.  On the Christmas tree it looks as if the light falls down.  Or to the top if, for example, to turn over the Christmas tree (son's advice) or hang the ribbons themselves on the contrary (my irrational suggestion). <br><br>  At the very beginning of the code, I derived some variables for configuration: <br>  LEDS1_NUM / LEDS1_PIN - the number of LEDs and pin connecting the first tape <br>  LEDS2_NUM / LEDS2_PIN - the number of LEDs and pin connecting the second tape <br>  LEDS_SATURATION - maximum color saturation <br>  LEDS_BRIGHTNESS - maximum brightness (60 LEDs approximate consumption was 800 mA at brightness of 255, 400 mA at 128 and 200 mA at 64) <br>  hueStep - color change step in one cycle <br>  UPDATE_DELAY - the speed of "running" color on the tape <br><br>  In setup (), both tapes are configured, so if there is only one tape, you can leave only one line that corresponds to the tape controller and reset LEDS2_NUM. <br><br><h2>  And the cartoon? </h2><br>  I attach this video crafts.  I apologize for the phone quality and portrait orientation. <br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/1NjmXqbQnb4%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253,15700258&amp;usg=ALkJrhj8YpBLoFx5icMZlqkcOfVZsKVh2A" frameborder="0" allowfullscreen=""></iframe><br><br>  I also want to send congratulations to all the habrovans.  Cheers cheers! <br><br></div><p>Source: <a href="https://habr.com/ru/post/246977/">https://habr.com/ru/post/246977/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../246967/index.html">Happy New Year!</a></li>
<li><a href="../246969/index.html">When technology outpaces needs: how did they think about IT development in 1985</a></li>
<li><a href="../246971/index.html">Dirty tricks with macros C ++</a></li>
<li><a href="../246973/index.html">Hacker's guide to neural networks. Chapter 2: Machine Learning. We generalize SVM to a neural network.</a></li>
<li><a href="../246975/index.html">Assembler in 30 lines on Excel</a></li>
<li><a href="../246979/index.html">This is correct, but wrong</a></li>
<li><a href="../246981/index.html">Numcap - npm to determine the operator and region by phone number</a></li>
<li><a href="../246983/index.html">Trivium Theory of Measurement</a></li>
<li><a href="../246985/index.html">Efficiency gon</a></li>
<li><a href="../246989/index.html">Print a check document with Python and Parse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>