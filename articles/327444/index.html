<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sports data analysis, or how to become a data science specialist</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="My name is Peter Romov, I am a data scientist at Yandex Data Factory. In this post I will offer a relatively simple and reliable way to start a data a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sports data analysis, or how to become a data science specialist</h1><div class="post__text post__text-html js-mediator-article">  My name is Peter Romov, I am a data scientist at Yandex Data Factory.  In this post I will offer a relatively simple and reliable way to start a data analyst career. <br><br>  Many of you probably know or at least heard about <a href="http://www.kaggle.com/">Kaggle</a> .  For those who have not heard: Kaggle is the platform on which companies hold contests to create predictive models.  Its popularity is so great that experts often understand the contests themselves as ‚ÄúCags‚Äù.  The winner of each competition is determined automatically by the metric that the organizer has appointed.  Among others, Kaggle at various times tried Facebook, Microsoft and the current site <a href="http://blog.kaggle.com/2017/03/08/kaggle-joins-google-cloud/">owner</a> , Google.  Yandex also <a href="https://yandex.com/company/blog/73/">noted</a> <a href="https://www.kaggle.com/c/yandex-personalized-web-search-challenge/">several</a> times.  As a rule, the Kaggle community is given to solve problems that are quite close to real: this, on the one hand, makes the competition interesting, and on the other, it promotes the company as an employer with solid tasks.  However, if you are told that the company-organizer of the competition involved in its service the algorithm of one of the winners - do not believe it.  Usually, solutions from the top are too complex and insufficiently productive, while chasing, in thousandths, the values ‚Äã‚Äãof the metrics are not so necessary in practice.  Therefore, the organizers are more interested in the approaches and the ideological part of the algorithms. <br><br><img src="https://habrastorage.org/files/3f1/810/3aa/3f18103aaa86402db6da527af810657a.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Kaggle is not the only platform for data analysis competitions.  There are others: <a href="https://www.drivendata.org/">DrivenData</a> , <a href="https://www.datascience.net/">DataScience.net</a> , <a href="https://competitions.codalab.org/competitions/">CodaLab</a> .  In addition, competitions are held in the framework of scientific conferences related to machine learning: SIGKDD, RecSys, CIKM. <br><br>  For a successful solution, it is necessary, on the one hand, to study the theory, and on the other hand, to start practicing the use of various approaches and models.  In other words, participation in ‚Äúlogs‚Äù is quite capable of making you data analytics.  The question is - how to learn to participate in them? <br><a name="habracut"></a><br>  Three years ago, several ShAD students began to gather and solve various interesting tasks, including those taken from Kaggle.  For example, among these guys was the current winner of the second place and the recent leader of <a href="https://www.kaggle.com/rankings">the Kaggle rating,</a> Stanislav Semyonov.  Over time, the meetings received the name of machine-training sessions.  They gained popularity, the participants began to regularly take prizes and tell each other about their decisions, share experiences. <br><br>  To understand exactly what we do in training, I will give a few examples.  In each example, first there is a video with a story, and then a text based on the video. <br><br><h3>  The task of classifying car images </h3><br>  <i><a href="http://www.machinelearning.ru/wiki/%3Ftitle%3DAvito-2016">Link to MachineLearning.ru.</a></i> <i><br><br></i>  <i>Last year, Avito held a series of contests.</i>  <i>Including - a car brand recognition contest, the winner of which, Yevgeny Nizhibitsky, told about his decision at the training.</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/lFXl3OjIW84" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>Task setting</b> .  It is necessary to determine the make and model of the car images.  The metric was the accuracy of predictions, that is, the proportion of correct answers.  The sample consisted of three parts: the first part was available for training initially, the second was given later, and the third was required to show the final predictions. <br><br><img src="https://habrastorage.org/files/666/b17/a54/666b17a547014efc80954f9122724e64.jpg" width="370"><img src="https://habrastorage.org/files/df0/f61/23c/df0f6123c26b4891a7ad678d0f7b1bbe.jpg" width="370"><br><br>  <b>Computational resources</b> .  I used my home computer, which had been heating my room all this time, and the servers provided at work. <br><br><img src="https://habrastorage.org/files/a02/8ac/c6d/a028acc6dfc14ab3b7851619f24b3b77.jpg" width="370"><br><br>  <b>Review of models</b> .  Since our task is to recognize, the first thing I want is to take advantage of the progress in the quality of image classification on the well-known <a href="http://image-net.org/">ImageNet</a> .  As is known, modern architectures make it possible to achieve even higher quality than that of humans.  Therefore, I began with a review of recent articles and collected a summary table of architectures, implementations and qualities based on ImageNet. <br><br><img src="https://habrastorage.org/files/932/1b2/ea9/9321b2ea92f244c2acc728769f4e1578.jpg" width="370"><img src="https://habrastorage.org/files/d1f/07e/48e/d1f07e48e9b747079776a1a9728a4364.jpg" width="370"><br><br>  Note that the best quality is achieved on the <a href="https://habrahabr.ru/post/302242/">Inception</a> and <a href="https://habrahabr.ru/post/303196/">ResNet architectures</a> . <br><br>  <b>Fine-tuning networks</b> .  Teaching a deep neural network from scratch is quite a time-consuming exercise, and, moreover, is not always effective in terms of results.  Therefore, the advanced training of networks is often used: the network already trained on ImageNet is taken, the last layer is replaced with a layer with the required number of classes, and then the network is set up with a low learning rate, but with data from the competition.  This scheme allows you to train the network faster and with higher quality. <br><br><img src="https://habrastorage.org/files/02f/dea/90e/02fdea90ec4748a8b0ba15d93e8ec1f3.jpg" width="370"><br><br>  The first approach to additional training GoogLeNet showed approximately 92% accuracy during validation. <br><br>  <b>Crop prediction</b> .  Using the neural network to predict on a test sample, you can improve the quality.  To do this, cut out fragments of a suitable size in different places of the original image, and then average the results.  Crop 1x10 means that the center of the image is taken, four corners, and then everything is the same, but reflected horizontally.  As you can see, the quality increases, but the prediction time increases. <br><br><img src="https://habrastorage.org/files/636/d2f/f76/636d2ff762ea48debe369e9a493738c6.jpg" width="370"><br><br>  <b>Validation of results</b> .  After the issuance of the second part of the sample, I divided the sample into several parts.  All further results are shown on this partition. <br><br><img src="https://habrastorage.org/files/829/af1/058/829af1058f324021ad8e24388c992851.jpg" width="370"><br><br>  <b>ResNet-34 Torch</b> .  You can use the ready-made repository of the authors of the architecture, but to get the predictions on the test in the right format, you need to fix some scripts.  In addition, you need to solve the problems of large memory consumption dumps.  Accuracy during validation is about 95%. <br><br><img src="https://habrastorage.org/files/1b0/525/85b/1b052585bd3845b28c51404add6de664.jpg" width="370"><img src="https://habrastorage.org/files/f4f/e7f/5b7/f4fe7f5b721c465c9be8da40834a5610.jpg" width="370"><br><br><br>  <b>Inception-v3 TensorFlow</b> .  Here, the finished implementation was also used, but the pre-processing of images was changed, and the cropping of images during the generation of the batch was also limited.  The result is almost 96% accuracy. <br><br><img src="https://habrastorage.org/files/a47/c33/7ca/a47c337cacd04f2dae434fe433492a03.jpg" width="370"><img src="https://habrastorage.org/files/4b2/6be/446/4b26be4469cb475e9c1d1e83944ec9d0.jpg" width="370"><br><br>  <b>Ensemble of models</b> .  The result was two ResNet models and two Inception-v3 models.  What quality during validation can be obtained by mixing models?  The class probabilities were averaged using the geometric mean.  Weights (in this case, degrees) were selected on a delayed sample. <br><br><img src="https://habrastorage.org/files/9cc/ace/578/9ccace5787624d3887d5c76677dce4aa.jpg" width="370"><img src="https://habrastorage.org/files/db4/682/07f/db468207f6b84a35a280fb5c9550764d.jpg" width="370"><br><br>  <b>The results</b> .  ResNet training on the GTX 980 took 60 hours, and Inception-v3 on the TitanX - 48 hours.  During the competition, we managed to test new frameworks with new architectures. <br><br><img src="https://habrastorage.org/files/528/19a/2f7/52819a2f73de453a9981afa2fa92fe7e.jpg" width="370"><img src="https://habrastorage.org/files/176/4b3/44c/1764b344ce9c4a23b5c36791a1e2f4f1.jpg" width="370"><br><br><h3>  The task of classifying bank customers </h3><br>  <i><a href="https://www.kaggle.com/c/bnp-paribas-cardif-claims-management">Link to Kaggle</a> .</i> <i><br><br></i>  <i>Stanislav Semenov tells how he and other participants of the Kaggle top joined together and won a prize in the competition on the classification of applications from customers of a large bank - <a href="https://ru.wikipedia.org/wiki/BNP_Paribas">BNP Paribas</a> .</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/g335THJxkto" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>Task setting</b> .  According to the obfuscated data from insurance claims, it is necessary to predict whether it is possible to confirm the request without additional manual checks.  For a bank, this is the process of automating the processing of applications, and for data analysts, it is simply a machine learning task on binary classification.  There are about 230 thousand objects and 130 signs.  Metric - <a href="https://www.kaggle.com/wiki/LogarithmicLoss">LogLoss</a> .  It is worth noting that the winning team deciphered the data, which helped them win the competition. <br><br>  <b>Disposal of artificial noise in the signs</b> .  The first thing is to look at the data.  Several things are immediately apparent.  First, all signs take values ‚Äã‚Äãfrom 0 to 20. Secondly, if you look at the distribution of any of the signs, you can see the following picture: <br><br><img src="https://habrastorage.org/files/bf7/d32/227/bf7d322272f9473e89f95697f601f8f1.png" width="400"><br><br>  Why is that?  The fact is that at the stage of anonymization and noise of data, random noise was added to all values, and then scaling was carried out to the interval from 0 to 20. The inverse transformation was carried out in two steps: first, the values ‚Äã‚Äãwere rounded to a certain decimal place, and then a denominator was selected .  Was this required if the tree still selects a threshold for splitting?  Yes, after the inverse transformation, the differences of variables begin to carry more meaning, and for categorical variables it is possible to carry out one-hot coding. <br><br>  <b>Removal of linearly dependent features</b> .  We also noticed that some signs are the sum of others.  It is clear that they are not needed.  For their definitions, subsets of features were taken.  Regression was built on such subsets to predict some other variable.  And if the predicted values ‚Äã‚Äãwere close to true (it is worth considering the artificial noise), then the sign could be removed.  But the team did not bother with it and used the already ready set of filtered features.  The set was prepared by someone else.  One of the features of Kaggle is the availability of a forum and public solutions, through which participants share their findings. <br><br>  <b>How to understand what to use?</b>  There is a small hack.  Suppose you know that someone in old competitions used some technique that helped him to take a high place (forums usually write short decisions).  If in the current competition this participant is again among the leaders - most likely, the same technique will shoot here. <br><br>  <b>Coding categorical variables</b> .  It was striking that a certain variable V22 has a large number of values, but at the same time, if we take a subsample for a certain value, the number of levels (different values) of other variables decreases markedly.  This includes good correlation with the target variable.  What can be done?  The simplest solution is to build a separate model for each value of V22, but this is the same as splitting all variables in the first split tree. <br><br>  There is another way to use the information obtained - coding the average value of the target variable.  In other words, each value of the categorical variable is replaced by the average value of the target for the objects for which the given attribute takes the same value.  It is impossible to perform such encoding directly for the entire training set: in the process we implicitly enter information about the target variable into the signs.  We are talking about information that almost any model is sure to find. <br><br>  Therefore, these statistics are considered to fold.  Here is an example: <br><br><img src="https://habrastorage.org/files/dc4/c40/383/dc4c403838c648c184ea509d552f8cd6.png" width="250"><br><br>  Suppose that the data is divided into three parts.  For each fold of the training set, we will consider the new feature for the two other folds, and for the test set - for the entire training set.  Then the information about the target variable will not be so clearly included in the sample, and the model will be able to use the knowledge gained. <br><br>  Will there be problems with anything else?  Yes - with rare categories and cross-validation. <br><br>  <b>Rare categories</b> .  Suppose a certain category is encountered only a few times and the corresponding objects belong to class 0. Then the mean value of the target variable will also be zero.  However, on a test sample, a completely different situation may arise.  The solution is a smoothed average (or smoothed likelihood), which is calculated by the following formula: <br><br><img src="https://habrastorage.org/files/686/41f/eea/68641feea22e4a31a3f5eb5a86fd841c.png" width="275"><br><br>  Here global mean is the average value of the target variable over the entire sample, nrows is how many times the specific value of the categorical variable is met, alpha is the regularization parameter (for example, 10).  Now, if some value is rarely met, the global average will have more weight, and if often enough, the result will be close to the initial average for the category.  By the way, this formula allows processing previously unknown values ‚Äã‚Äãof a categorical variable. <br><br>  <b>Cross validation</b> .  Suppose we calculated all smoothed means for categorical variables for other folds.  Can we evaluate the quality of the model by standard cross-validation k-fold?  Not.  Let's take an example. <br><br><img src="https://habrastorage.org/files/f60/c78/821/f60c78821dbb425abacf3ade724dff61.png" width="550"><br><br>  For example, we want to evaluate the model on the third fold.  We are training the model in the first two folds, but they have a new variable with an average value of the target variable, when calculating which we have already used the third test fold.  This does not allow us to correctly evaluate the results, but the problem that has arisen is solved by calculating the statistics on the folds within the folds.  Consider again the example: <br><br><img src="https://habrastorage.org/files/cfe/851/fae/cfe851fae9974d358344f48c4b7e8c82.png" width="290"><br><br>  We still want to evaluate the model on the third fold.  We divide the first two folds (the training sample of our assessment) into some other three folds, we calculate the new feature in the already analyzed script, and for the third fold (this is a test sample of our assessment), we count the first two folds together.  Then no information from the third fold will be used when training the model and the assessment will be honest.  In the competition, which we are discussing, only such cross-validation allowed to correctly assess the quality of the model.  Of course, the ‚Äúexternal‚Äù and ‚Äúinternal‚Äù number of folds can be any. <br><br>  <b>Construction of signs</b> .  We used not only the already smoothed mean values ‚Äã‚Äãof the target variable, but also weights of evidence.  This is almost the same, but with a logarithmic transformation.  In addition, features of the form of the difference in the number of objects of positive and negative classes in a group without any normalization turned out to be useful.  Intuition here is the following: the scale shows the degree of confidence in the class, but what to do with the quantitative traits?  After all, if we process them in a similar way, then all values ‚Äã‚Äãwill be ‚Äúforgotten‚Äù by the regularization of the global average.  One option is to divide the values ‚Äã‚Äãinto bins, which are then considered as separate categories.  Another way is simply to build a certain linear model on one sign with the same target.  Total got about two thousand signs of 80 filtered. <br><br>  <b>Stacking and blending</b> .  As in most competitions, an important part of the solution is the stacking of models.  In short, the essence of stacking is that we transfer the predictions of one model as a sign to another model.  However, it is important once again not to retrain.  Let's just look at an example: <br><br><img src="https://habrastorage.org/files/082/46d/169/08246d1697634ab2bde9fd48d4ffc968.png"><br>  <i>Taken from the <a href="https://alexanderdyakonov.wordpress.com/2017/03/10/c%25D1%2582%25D0%25B5%25D0%25BA%25D0%25B8%25D0%25BD%25D0%25B3-stacking-%25D0%25B8-%25D0%25B1%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B3-blending/">blog of Alexander Dyakonov</a></i> <br><br>  For example, we decided to split our selection into three folds at the stacking stage.  Similar to calculating statistics, we must train the model in two folds, and add predicted values ‚Äã‚Äãfor the remaining fold.  For a test sample, you can average the predictions of models from each pair of folds.  Each stacking level refers to the process of adding a group of new feature-prediction models based on the existing dataset. <br><br>  On the first level, the team had 200-250 different models, on the second - another 20-30, on the third - a few more.  The result is a blending, i.e. a mix of predictions of different models.  Various algorithms were used: gradient boosters with different parameters, random forests, neural networks.  The main idea is to apply the most diverse models with different parameters, even if they provide not the highest quality. <br><br>  <b>Teamwork</b> .  Usually, participants are combined into teams before the end of the competition, when everyone already has their own groundwork.  We teamed up with other "Kaglerami" at the very beginning.  Each team member had a folder in the public cloud where datasets and scripts were located.  The general procedure of cross-validation was approved in advance so that it could be compared with each other.  Roles were distributed as follows: I invented new signs, the second participant built models, the third selected them, and the fourth controlled the entire process. <br><br>  <b>Where to get power</b> .  Testing a large number of hypotheses, building multilevel stacking and learning models can take too much time if you use a laptop.  Therefore, many participants use compute servers with a large number of cores and RAM.  I usually use <a href="https://aws.amazon.com/">AWS</a> servers, and my team members, as it turned out, use cars at work for contests while they are idle. <br><br>  <b>Communication with the organizing company</b> .  After successful performance in the competition, communication with the company takes place in the form of a joint conference call.  Participants talk about their decision and answer questions.  In BNP, people were not surprised by multilevel stacking, but they were interested, of course, in building signs, working in a team, validating results ‚Äî anything that might be useful to them in improving their own system. <br><br>  <b>Whether it is necessary to decipher</b> .  The winning team noticed one feature in the data.  Some signs have missing values, and some do not.  That is, some characteristics are not dependent on specific people.  In addition, we got 360 unique values.  It is logical to assume that we are talking about some time stamps.  It turned out that if we take the difference between two such signs and sort the entire sample by it, then first zeros will go more often, and then ones.  The winners took advantage of this. <br><br>  Our team ranked third.  In total, nearly three thousand teams participated. <br><br><h3>  Ad category recognition task </h3><br>  <i><a href="http://dataring.ru/competitions/avito-category/">Link to DataRing</a> .</i> <i><br><br></i>  <i>This is another Avito contest.</i>  <i>It took place in several stages, the first of which (as, incidentally, also the third) was won by Arthur Kuzin <a href="https://habrahabr.ru/users/n01z3/" class="user_link">N01Z3</a> .</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/aE9YfzSl3LU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>Task setting</b> .  According to the photos from the ad, you must define a category.  Each ad corresponded from one to five images.  The metric took into account the coincidence of categories at different levels of the hierarchy - from general to narrower (the latter level contains 194 categories).  In total, the training sample had almost a million images, which is close to the size of ImageNet. <br><br><img src="https://habrastorage.org/files/50b/6e3/d63/50b6e3d639724a07b68344300c5e11b2.jpg" width="370"><img src="https://habrastorage.org/files/a57/ab6/93a/a57ab693adb144db9278b95e7f287d4c.jpg" width="370"><br><br>  <b>The difficulty of recognition</b> .  It would seem that you just need to learn how to distinguish TV from the car, and the car from the shoes.  But, for example, there is a category ‚ÄúBritish cats‚Äù, and there are ‚Äúother cats‚Äù, and among them there are very similar images - although you can still distinguish them from each other.  What about tires, wheels and wheels?  Here the man can not cope.  These difficulties are the reason for the appearance of some limit on the results of all participants. <br><br><img src="https://habrastorage.org/files/7ab/ce2/06f/7abce206f1fb4b97ac7d1e73be16ea6e.jpg" width="370"><img src="https://habrastorage.org/files/d27/915/a8d/d27915a8dc8f47ec9a742e54a4fc77b8.jpg" width="370"><br><br>  <b>Resources and framework</b> .  I had at my disposal three computers with powerful video cards: a home computer provided by a laboratory at MIPT and a computer at work.  Therefore, it was possible (and had to) train several networks simultaneously.  <a href="https://github.com/dmlc/mxnet">MXNet</a> was chosen as the main neural network learning framework, created by the same guys who wrote the well-known <a href="https://github.com/dmlc/xgboost">XGBoost</a> .  This alone was the reason to trust their new product.  The advantage of MXNet is that an effective iterator is available out of the box with a regular augmentation, which is sufficient for most tasks. <br><br><img src="https://habrastorage.org/files/0c1/efb/b3a/0c1efbb3a80d46caa6bcd0177ce2d305.jpg" width="370"><img src="https://habrastorage.org/files/47b/969/d66/47b969d66d234180a5ed9e4a03b41910.jpg" width="370"><br><br>  <b>Network Architecture</b>  The experience of participating in one of the past competitions showed that the architecture of the Inception series shows the best quality.  I used them here.  Butch normalization was added to GoogLeNet as it accelerated the learning of the model.  The Inception-v3 and Inception BN architectures from the <a href="https://github.com/BVLC/caffe/wiki/Model-Zoo">Model Zoo</a> model library were also used, to which a dropout was added before the last fully connected layer.  Due to technical problems, it was not possible to train the network using a stochastic gradient descent, therefore Adam was used as an optimizer. <br><br><img src="https://habrastorage.org/files/073/de2/911/073de2911565421c8ad606f3896a9d64.jpg" width="370"><img src="https://habrastorage.org/files/adb/8c4/ecf/adb8c4ecf3e44850884a4c4e564e432f.jpg" width="370"><img src="https://habrastorage.org/files/e31/685/9b8/e316859b85a2497980272043383621cc.jpg" width="370"><br><br>  <b>Data augmentation</b> .  To improve the quality of the network, augmentation was used - adding distorted images to the sample in order to increase the diversity of data.  Transformations such as accidental photo cropping, reflection, turning at a small angle, changing the aspect ratio and shifting were involved. <br><br><img src="https://habrastorage.org/files/059/1bd/b6d/0591bdb6d1bb478cb6f39a42b1960798.jpg" width="370"><br><br>  <b>Accuracy and speed of learning</b> .  At first I divided the sample into three parts, but then I abandoned one of the validation steps for mixing the models.  Therefore, subsequently, the second part of the sample was added to the training set, which improved the quality of networks.  In addition, GoogLeNet initially studied at Titan Black, which has half the memory compared to Titan X. So this network was re-trained with a large batch size, and its accuracy increased.  If you look at the time of learning networks, we can conclude that in terms of limited time it is not necessary to use Inception-v3, because with two other architectures, learning goes much faster.  The reason is the number of parameters.  Inception BN learns the fastest. <br><br><img src="https://habrastorage.org/files/46d/776/9e4/46d7769e4d934ea0a47fb4c6a96ca680.jpg" width="370"><br><br>  <b>Building predictions</b> . <br><br>  <i>Like Eugene in the competition with the brands of cars, Arthur used predictions on the crocs - but not on 10 polling stations, but on 24. The plots were angles, their reflections, the center, the turns of the central parts and ten more random ones.</i> <br><br>  If one maintains the state of the network after each epoch, the result is a variety of different models, not just the final network.  Taking into account the time remaining until the end of the competition, I could use the predictions of 11 epoch models ‚Äî since the construction of predictions using the network also lasts quite a lot.  All of these predictions were averaged according to the following scheme: first, using the arithmetic average within the cropping groups, then using the geometric average with weights selected on the validation set.    ,      .               . <br><br><img src="https://habrastorage.org/files/a96/998/425/a969984259314fdd850383a5b1acaa52.jpg" width="370"><img src="https://habrastorage.org/files/e34/2ca/df1/e342cadf1353427696c0d02178eeda96.jpg" width="370"><br><br> <b></b> .         ,        .               ,          .    ,          . ,      ,       . <br><br><img src="https://habrastorage.org/files/b40/281/085/b40281085f7b4fd99cb77405864081d1.jpg" width="370"><img src="https://habrastorage.org/files/850/f7c/3aa/850f7c3aa8b84ddebe58d42fba6f4d5f.jpg" width="370"><br><br> <b>   vs. fine-tuning</b> .     ,            ,     .      . <br><br><img src="https://habrastorage.org/files/d53/c53/69a/d53c5369aa94447fa3c6e2c8c5874e88.jpg" width="370"><br><br><h3>     </h3><br> <i> Black Box Challenge,   <a href="https://habrahabr.ru/company/dca/blog/281707/">  </a> ,       ¬´¬ª.   ,        ¬´¬ª .        ¬´¬ª,            .         ‚Äî reinforcement learning. <br><br>          5vision.      .</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/n9JKAQHGr80" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <b> </b> .         ¬´¬ª,      .    ,          ,    ,          .        .      36 .     .  ‚Äî      . <br><br><img src="https://habrastorage.org/files/739/2ee/a90/7392eea903604912b98249157b6a8add.jpg" width="370"><img src="https://habrastorage.org/files/71b/0a6/a86/71b0a6a86880459f9eb8073af4b49709.jpg" width="370"><br><br> <b> </b> .      ,   35         36-      .      -:    ,    .   ,       :        .  ,  ,     100   ,    .     ¬´   ¬ª  . -    ,       36- .    ,      ,    36- ,   ‚Äî ,      .      ,       . <br><br><img src="https://habrastorage.org/files/7a8/68f/43e/7a868f43ea5944878bf485ee3b1061a6.jpg" width="370"><img src="https://habrastorage.org/files/145/d21/a41/145d21a41d854d1ab3ad7fab456b3dc9.jpg" width="370"><br><br> <b>Q-learning</b> .            .         q-learning.       Q,       . Q ,  ¬´¬ª      .  ¬´¬ª    ,      ,   .     .                  ,  .    <a href="https://habrahabr.ru/post/308094/">     </a> .  q-learning        ( ,         ).   ,  ,   ,    ,  q-learning    . <br><br><img src="https://habrastorage.org/files/01c/79b/32f/01c79b32faa44260bd2bf0a3eb4cac2e.jpg" width="370"><br><br> <b>  black box</b> .    ,       n-step q-learning,        ,   n  .         ,     ‚Äî         ,   - .    ,  q-     ,   ¬´  3¬ª. ,              . <br><br><img src="https://habrastorage.org/files/715/08b/f87/71508bf875674446928724f3322d930b.jpg" width="370"><br><br> <b> </b> .   :    ( )   ,  ,       q-    ‚Äî       .   ,    q-   .   ‚Äî  replay memory (     ,     )     ,  , ‚Äî    . <br><br><img src="https://habrastorage.org/files/115/e80/7eb/115e807eb339416db89f3d6580ec85d9.jpg" width="370"><br><br> <b></b> .      (        )    .       .         ( Q-)   .  ,  -:    ÃÅ      ,    .     ,          . <br><br><img src="https://habrastorage.org/files/3c4/6b7/478/3c46b7478603431ebd7b16e9917e4a2b.jpg" width="370"><img src="https://habrastorage.org/files/d78/fe7/827/d78fe78273904930b6cd8bbfe3ad7b2e.jpg" width="370"><br><br> <b> </b> . ,      . ,   (      ,       ),  , dueling- (        )    . -        ‚Äî       , ,    . <br><br><img src="https://habrastorage.org/files/398/175/4f6/3981754f6f6d41a082887120a38959d0.jpg" width="370"><img src="https://habrastorage.org/files/b85/8e0/522/b858e0522c504ad8b34a5acf3f816fa2.jpg" width="370"><br><br> <b></b> .  5vision   ,        ¬´¬ª. <br><br><img src="https://habrastorage.org/files/d7d/afa/3db/d7dafa3db5f147819b1c392debf61f7b.jpg" width="370"><img src="https://habrastorage.org/files/5fa/e47/623/5fae47623bd74ad5b23164da78a07c3b.jpg" width="370"><br><br><hr><br> ,        ? <br><br><ul><li> .            .  Kaggle        . </li><li> .    <a href="https://habrahabr.ru/post/305026/">   </a> . </li><li> . , ,  .        ,      . </li></ul><br><img src="https://habrastorage.org/files/64f/e0c/bef/64fe0cbefcc94053b216831ebe652019.jpg"><br><br>           .   ‚Äî   ,    (  ) ‚Äî 60-80 .      :    ,  -  .     ,             ,     .    , , ,     . <br><br>  ,   : ,         .     ,   .       ,     <a href="https://www.facebook.com/groups/1413405125598651/"> </a>  <a href="https://vk.com/mltrainings"></a> ,  <a href="https://www.youtube.com/channel/UCeq6ZIlvC9SVsfhfKnSvM9w">YouTube-</a>   . ,     -, ,   .      ,      ‚Äî     . <br><br><img src="https://habrastorage.org/files/67a/409/c45/67a409c4522c483585856428ae510276.jpg"><br><br>  That's all.  , ,  ,  -  ,    ,   ‚Äî    ,     data scientist.      devops,      ,   ,     .  ‚Äî ,      -  . <br><br> <b> ,    </b> : <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you are no longer a beginner and want to ‚Äúpump over‚Äù in a short time on the main topics - </font></font><a href="https://habrahabr.ru/company/yandex/blog/269175/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">take a Yandex course ‚ÄúIntroduction to machine learning‚Äù at Coursera</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For those who wish to study the subject, the </font></font><a href="https://www.coursera.org/specializations/machine-learning-data-analysis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">specialization ‚ÄúMachine learning and data analysis‚Äù</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be more suitable </font><font style="vertical-align: inherit;">.</font></font></li><li> <a href="https://habrahabr.ru/company/ods/profile/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open Data Science community</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (#mltrainings_beginners, #mltrainings_live channels).</font></font></li></ul></div><p>Source: <a href="https://habr.com/ru/post/327444/">https://habr.com/ru/post/327444/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327434/index.html">The first course Mail.Ru Group on the largest educational platform Coursera</a></li>
<li><a href="../327436/index.html">All on the shelves: web analytics with Rambler / Top 100, part 1</a></li>
<li><a href="../327438/index.html">Now you can learn how to design interfaces on Coursera</a></li>
<li><a href="../327440/index.html">Its a web server on NodeJS, and not a single framework. Part 1</a></li>
<li><a href="../327442/index.html">Post effects in mobile games</a></li>
<li><a href="../327446/index.html">Your recruitment is not social: features of social networks, lifehacks and tools for HR</a></li>
<li><a href="../327448/index.html">Learning from the masters: design levels Legend Of Zelda</a></li>
<li><a href="../327450/index.html">Operator overloading in freepascal on the example of ordinary fractions</a></li>
<li><a href="../327452/index.html">Mobile application prototyping: from idea to desktop</a></li>
<li><a href="../327454/index.html">Everything is not so simple with Ctrl + Z: about undo in fast editing ONLYOFFICE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>