<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Gradle: Better Way To Build</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No project using the Java platform (and more) can do without assembly tools (unless it is ‚ÄúHello, world!‚Äù). Sooner or later, but it‚Äôs annoying to coll...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Gradle: Better Way To Build</h1><div class="post__text post__text-html js-mediator-article">  No project using the Java platform (and more) can do without assembly tools (unless it is ‚ÄúHello, world!‚Äù).  Sooner or later, but it‚Äôs annoying to collect the distribution kit.  Yes, and compile from the console would be nice if the project uses several different IDE.  And before building the distribution kit, it would be great to put down the version number in its name.  And the unit tests to get rid of - not for nothing that Kent Beck writes books.  And there Continues Integration looms on the horizon.  And it would be great to teach the CI server to do it all on their own.  In short, there are a lot of tasks. <br><br>  Once there are tasks, then there are solutions.  I think most developers at least once, but have come across Ant.  Many people use Maven.  There are other, not so common tools: GAnt, Buildr, etc. Each of them has its own set of pros and cons, but today I want to introduce you to something new.  <a href="http://www.gradle.org/">Gradle</a> . <br><a name="habracut"></a><br><br>  <a href="http://www.gradle.org/">Gradle</a> tries to combine all the advantages of Ant, Maven and Ivy.  And present what happened with the help of <a href="http://groovy.codehaus.org/">Groovy</a> .  Now, instead of crossing Batch scripts, java and xml configuration files, you can simply write a few lines of <i>code</i> in the Groovy dialect and enjoy life.  Dialect is specifically designed to describe the assembly, testing, deployment, export, and any other actions on the project that can come to your mind. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Because  Gradle runs on a running JVM, it successfully uses the Ant task libraries, Apache Ivy dependency management tools, and other existing tools (TestNG, JUnit, Surefire, Emma, ‚Äã‚Äãetc.).  In principle, it is easy to integrate into the assembly <i>any</i> tool that works in jvm.  In addition to everything, the Groovy dialect used in Gradle gives you complete freedom of action.  Completely complete.  Want conditional expressions?  You are welcome!  Want cycles?  Welcome!  Read and write files?  Work with the network?  Generate your own tasks on the fly?  Anything!  And in a normal, human programming language, not horrible xml constructs. <br><br>  An interesting feature: a properly configured Gradle project can be assembled on a user's machine, on which Gradle is not installed.  All that is required is to put 4 files into the source tree (which Gradle will generate for you): 2 executables for Win / * nix, 1 settings file and a small jar.  Total ~ 20Kb.  After that, the project can be assembled on any machine where there is access to the web.  The script itself will take care of downloading the correct version of Gradle, about setting up and running the build. <br><br>  Migrating to Gradle is very simple.  For example, the maven2 assembly can be converted to a Gradle assembly automatically (while preserving the configured dependencies, artifacts, versions, and subprojects).  And the migration has already begun.  Now this tool is used by projects: <a href="http://www.grails.org/">Grails</a> , <a href="http://static.springsource.org/spring-security/site/">Spring Security</a> , <a href="http://in.relation.to/Bloggers/HibernateGradlePointers">Hibernate Core</a> and even <a href="http://gant.codehaus.org/">GAnt</a> (honestly, GAnt is built using Gradle!). <br><br>  Praised, now need to demonstrate in action. <br><br>  First, create a template java project to demonstrate the use of build-by-convention.  And then we will try to modify it a bit by adding a set of automated integration tests to the file structure to show how much freedom Gradle has in using the 'convention'.  The example intentionally does not mention the source files, since  not their meaning. <br><br>  Suppose we have a project structure (you have already seen it a thousand times): <br><br><pre> / project
    / src
       / main
          / java
          / resources
       / test
          / java
          / resources
</pre><br><br>  Create an empty build.gradle file in the project directory.  Write one line there: <br><br><pre><code class="scala hljs">apply plugin:<span class="hljs-symbol"><span class="hljs-symbol">'jav</span></span>a'</code> </pre> <br><br>  Run the gradle build command and get: <br><br> <code>&gt;gradle build <br> :compileJava <br> :processResources <br> :classes <br> :jar <br> :assemble <br> :compileTestJava <br> :processTestResources <br> :testClasses <br> :test <br> :check <br> :build <br> <br> BUILD SUCCESSFUL <br> <br> Total time: 4.116 secs</code> <br> <br>  In the console, we see the execution of a task sequence (Gradle Tasks), which are a close analogue of Ant Targets.  In the / project / build directory, you can find compiled classes (including neatly packaged jar), test execution reports and other build results. <br><br>  All this is so far no different from what many project participants have used to using Maven.  The same directories, the same pom.xml (only called build.gradle).  But do not rush to uncover rotten tomatoes and let me demonstrate one of the interesting features of Gradle. <br><br>  Add integration tests.  Let's create for them a separate branch of directories: <br><br><pre> / project
    / src
       / main
       / test
       / integTest
          / java
          / resources
</pre><br><br>  and add the following code to build.gradle: <br><pre> <code class="scala hljs">sourceSets { integTest }</code> </pre><br><br>  In terms of the Gradle source set, a set of files and resources that must be compiled and run together.  The above snippet defines a new source set named integTest.  By default, sources and resources will be taken from <code>/project/src/&lt; source set&gt;/java</code> and <code>/project/src/&lt; source set&gt;/resources</code> respectively.  The Java Plugin, which we connected at the beginning, sets two standard source sets: <code>main</code> and <code>test</code> . <br><br>  Three new tasks will be automatically generated: compilation (compileIntegTestJava), resource processing (processIntegTestResource) and integrating their integTestClasses.  Let's try to run: <br><br> <code>&gt;gradle integTestClasses <br> :compileIntegTestJava <br> :processIntegTestResources <br> :integTestClasses <br> <br> BUILD SUCCESSFUL <br> <br> Total time: 1.675 secs</code> <br> <br>  At the cost of two lines, we got 3 new tasks and added a new catalog to the project build.  But as soon as it comes to writing these tests, we find that we need all the dependencies of the main project, and also the compiled classes in addition. <br>  Not a question, we write: <br><br><pre> <code class="scala hljs">configurations { integTestCompile { extendsFrom compile } } sourceSets { integTest{ compileClasspath = sourceSets.main.classes + configurations.integTestCompile } }</code> </pre><br><br>  The <code>Congfigurations</code> block describes <i>dependency configurations</i> .  Each configuration can combine maven artifacts, sets of local files, etc. New configurations can be inherited from existing ones.  In this case, we inherit the dependency configuration for compiling integration tests from the <code>compile</code> configuration.  This configuration is standard (specified plugin) for compiling <code>main</code> <br><br>  The string <code>sourceSets.main.classes + configurations.integTestCompile</code> denotes the union of the filesets.  <code>main.classes</code> - the directory where the * .class files obtained during the <code>main</code> assembly will be located. <br><br>  Probably, in the assembly, JUnit will be useful to us.  And it would be nice to run these tests.  We describe another configuration of dependencies. <br><br><pre> <code class="scala hljs">configurations { integTestCompile { extendsFrom compile } integTestRuntime { extendsFrom integTestCompile, runtime } } repositories { mavenCentral() } dependencies { integTestCompile <span class="hljs-string"><span class="hljs-string">"junit:junit:4.8.1"</span></span> } sourceSets { integTest{ compileClasspath = sourceSets.main.classes + configurations.integTestCompile runtimeClasspath = classes + sourceSets.main.classes + configurations.integTestRuntime } } task integrationTest(<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">Test</span></span>) { testClassesDir = sourceSets.integTest.classesDir classpath = sourceSets.integTest.runtimeClasspath }</code> </pre><br><br>  The <code>Repositories</code> block will connect us to maven central (and other repositories of our choice).  The <code>dependencies</code> block will add artifact dependency to our configuration.  <code>runtimeClasspath = classes + sourceSets.main.classes + configurations.integTestRuntime</code> combines files from <code>integTest.classes</code> , <code>main.classes</code> and <code>integTestRuntime</code> . <br><br>  The task to run the tests still had to write.  However, it was easy: just specify where to get the tests and what classpath to run them with, i.e.  "what".  "How" Gradle will determine on its own. <br><br>  Now we are ready: <br><br> <code>&gt;gradle clean integrationTest <br> :clean <br> :compileJava <br> :processResources <br> :classes <br> :compileIntegTestJava <br> :processIntegTestResources UP-TO-DATE <br> :integTestClasses <br> :integrationTest <br> <br> BUILD SUCCESSFUL <br> <br> Total time: 4.195 secs <br></code> <br><br>  Note that Gradle handled the <code>integTest.compileClasspath</code> dependency on <code>main.classes</code> and compiled source set <code>main</code> before collecting integration tests! <br><br>  As a result, we managed to put together a standard configuration of the project, completely painlessly expand it and describe the dependency scheme between subtasks using inheritance.  All this with a simple and readable language. <br><br>  What hasn't a word been said yet: about working with tasks, about incremental build, about working with subprojects, about working with Maven repositories, about integrating with Ant, about standard plugins, about init-scripts and many other things .  But about this, perhaps, in other articles. </div><p>Source: <a href="https://habr.com/ru/post/107085/">https://habr.com/ru/post/107085/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../107079/index.html">Apple killed CDs today</a></li>
<li><a href="../107080/index.html">RMA-Silicon Trip. Microsoft office</a></li>
<li><a href="../107081/index.html">Prince and the Pauper</a></li>
<li><a href="../107083/index.html">McAfee report published: the most dangerous domain zones in the world</a></li>
<li><a href="../107084/index.html">TabWindow plugin window minimized / expandable in TabPanel</a></li>
<li><a href="../107086/index.html">Bill Gates is 55 years old!</a></li>
<li><a href="../107089/index.html">RIW vs. american conferences</a></li>
<li><a href="../107093/index.html">Real rounding of corners of pictures on the client</a></li>
<li><a href="../107095/index.html">The most famous startup star of the planet is 55 years old!</a></li>
<li><a href="../107096/index.html">Russians prefer to choose goods online and buy offline?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>