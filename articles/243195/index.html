<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rakes, which I stepped on when crossing CRM with Google Calendar</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As usually happens with boxed products, not all solutions are satisfied, and business processes have to be improved with external tools. In our case, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rakes, which I stepped on when crossing CRM with Google Calendar</h1><div class="post__text post__text-html js-mediator-article">  As usually happens with boxed products, not all solutions are satisfied, and business processes have to be improved with external tools.  In our case, it was difficult to work with the built-in calendar.  The main problem was that it was impossible to simultaneously set the task and look at the employment of employees - at the same time there were difficulties in two adjacent departments. <br><br>  <b>We decided to introduce Google calendar:</b> <br><img src="https://habrastorage.org/files/a97/4cd/20d/a974cd20d61f47b98642d7b749d3bbfc.png" alt="image"><br><a name="habracut"></a><br>  Prior to this, I did not work with the Google API, so the first thing I did was find the <a href="https://developers.google.com/google-apps/calendar/v3/reference/calendarList/get">documentation</a> for the search; <br><br>  The first rake: the specified documentation describes the objects that are now wrapped in the source code in other objects.  After studying the code and searching for solutions on the Internet, I wrote the code for connecting to the calendar and added the first calendar. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ‚ÄúIt's great how quickly everything turned out!  We have almost everything ready, it remains a bit: add all the calendars we need and throw events into them ‚Äù, I thought and opened the calendar interface in the browser. <br>  And here I was waited by the second rake: in the interface I did not find the added calendars.  How to understand where they disappeared?  I wrote code that returned a list of created calendars.  It turned out that there were already 10 of them. How so - everything works, calendars are created and even returned.  And in the interface they are not there ... <br><br>  OK Google, what am I doing wrong? <br><br>  I had to dig again.  Found: calendars are added to the service account (147837410720-t2rf13ce77not3h58ubgme3q682nr54@developer.gserviceaccount.com).  In order for the calendars to be visible, it turns out that they had to be added to the main one. <br><br>  <b>Add as follows:</b> <br><pre><code class="php hljs">$service = GoogleAuth::getInstance(); $scope = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Google_Service_Calendar_AclRuleScope(); $scope-&gt;setType(<span class="hljs-string"><span class="hljs-string">'user'</span></span>); $scope-&gt;setValue(<span class="hljs-string"><span class="hljs-string">'  @gmail.com'</span></span>); $rule = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Google_Service_Calendar_AclRule(); $rule-&gt;setRole(<span class="hljs-string"><span class="hljs-string">'owner'</span></span>); $rule-&gt;setScope($scope); $result = $service-&gt;acl-&gt;insert($calId, $rule);</code> </pre> <br>  I relaxed and enjoyed, calendars were created, events were recorded, everything worked like a clock.  But here I was waiting for the next rake! <br><br>  Suddenly, on one heavy Monday, Google stopped accepting a token, producing an error (invalid_grant).  For two days, the whole department searched for a black cat in a dark room.  Found  The recent change of time for winter time led to the lag of our server from the real time, and Google did not like it.  After adjusting the time it worked. <br>  While the calendars are working, we look forward to the next rake from Google. <br><br>  I would be glad if this post helps someone to reduce the time for finding solutions to problems. </div><p>Source: <a href="https://habr.com/ru/post/243195/">https://habr.com/ru/post/243195/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243175/index.html">A full-fledged Minecraft processor: how does it work, how to program on it and what is it for?</a></li>
<li><a href="../243183/index.html">Under what OS and what are you programming?</a></li>
<li><a href="../243187/index.html">Russian SQL language documentation for Firebird 2.5 DBMS</a></li>
<li><a href="../243191/index.html">SMM? Thanks but no thanks</a></li>
<li><a href="../243193/index.html">Payler - LIVE!</a></li>
<li><a href="../243197/index.html">DEV Labs 2014 - online conference for Oracle developers</a></li>
<li><a href="../243199/index.html">Haxe: convert source code</a></li>
<li><a href="../243201/index.html">The smartest marketers in the world. Learn from Amazon</a></li>
<li><a href="../243203/index.html">FreeBSD, dhcp, ip unnumbered and everything is all all ...</a></li>
<li><a href="../243205/index.html">Finger Trees (Part 2. Operations)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>