<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Connecting win form to xna project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you know, xna does not provide a typical GUI, so each developer has to decide whether to draw it themselves, connect ready-made GUI libraries devel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Connecting win form to xna project</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/10a/c89/e3b/10ac89e3b4061eccb3f15d7f828229f7.png"><br><br>  As you know, xna does not provide a typical GUI, so each developer has to decide whether to draw it themselves, connect ready-made GUI libraries developed specifically for xna (there are not too many of them), or try to connect standard winform / wpf (there is already a wonderful wpf connection <a href="http://habrahabr.ru/post/101165/">article</a> ). <br>  I did not begin to understand the numerous options for solving this problem and decided to go as it seemed to me the easiest way - by connecting a winform.  As it turned out, winform has a number of nuances and limitations. <br>  In the end, after an active search, I came to two possible implementations of the interface: <br>  1. The entire interface without the keyboard, i.  buttons, lists, etc.  If you need to enter something from the keyboard - create an external form and receive data from it. <br>  2. The interface is fully functional and you can enter data from the keyboard.  But the creation of external forms is impossible + a couple more nuances. <br>  More details: <br><a name="habracut"></a><br>  <b>one</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/be2/624/341/be2624341978bd33af917f84eff03a0c.png"><br>  In the xna project you need to add links to System.Windows.Forms and System.Drawing.  Then prescribe the code for creating the necessary controls.  Controls will not respond to keystrokes.  I could find the reason for this behavior on the Internet, but unfortunately I did not find a satisfactory solution, quote: <blockquote>  XNA uses its class to listen to the keyboard status, while the textbox uses the Windows.Form.Input </blockquote>  . <br>  The author of the quotation resolved this issue by creating a method that directly receives the pressed buttons through the built-in xna class and directly sends it to the input field of the selected control.  The disadvantage of this approach is that there is no easy way to find out if the ‚ÄúQ‚Äù or ‚ÄúY‚Äù key is pressed (For details on the method, see link 1 at the bottom of the article). <br><br>  Connection of the control to the form: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <font color="black"><font color="#0000ff">using</font> Size_ = System.Drawing.Size;</font>  <font color="black"><font color="#008000">// A reference to System.Drawing has been added to the solution browser, but here only the size and position is needed from the entire namespace</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">using</font> Point_ = System.Drawing.Point;</font> <font color="black"><br></font>  <font color="black">...</font> <font color="black"><br></font>  <font color="black">...</font> <font color="black"><br></font>  <font color="black"><font color="#008000">// Create control</font></font> <font color="black"><br></font>  <font color="black">NumericUpDown nm = <font color="#0000ff">new</font> NumericUpDown ();</font> <font color="black"><br></font>  <font color="black">nm.Location = <font color="#0000ff">new</font> Point_ (0, 50);</font> <font color="black"><br></font>  <font color="black">nm.Size = <font color="#0000ff">new</font> Size_ (125, 20);</font> <font color="black"><br></font>  <font color="black">nm.Value = ( <font color="#0000ff">decimal</font> ) text2;</font> <font color="black"><br></font>  <font color="black">nm.KeyUp + = <font color="#0000ff">new</font> KeyEventHandler (nm_ValueChanged_f);</font> <font color="black"><br></font>  <font color="black">nm.ValueChanged + = <font color="#0000ff">new</font> EventHandler (nm_ValueChanged_f);</font> <font color="black"><br><br></font>  <font color="black"><font color="#008000">// Get the current form</font></font> <font color="black"><br></font>  <font color="black">Form general_form = (Form) Control.FromHandle (Window.Handle);</font> <font color="black"><br></font>  <font color="black"><font color="#008000">// Connect the control to the current form</font></font> <font color="black"><br></font>  <font color="black">general_form.Controls.Add (nm);</font> <br><br>  <font color="gray">* This source code was highlighted with <a href="http://virtser.net/blog/post/source-code-highlighter.aspx"><font color="gray">Source Code Highlighter</font></a> .</font> <br><br>  Sources of a simple application with controls inside the form and creating an external form at the end of the article. <br><br>  <b>2</b> <br><img src="https://habrastorage.org/getpro/habr/post_images/0b5/180/36f/0b518036f830ff0ffcddd4275e79abbc.png"><br>  The method described above unfortunately cannot be applied to applications that require user input of text.  Continuing the search, I found a different connection method winform (link 2 at the end of the article).  Its essence lies in the fact that the initialization of the form, controls, and only then - the game itself.  The peculiarity is that in this way the game will not be able to call the update () and draw () methods - they will need to be called separately. <br>  This method is suitable for many tasks, because  All created controls will correctly respond to keystrokes. <br>  However, this method has nuances.  <u>All</u> controls should be created after (during) the initialization of the form, but prior to the initialization of the game itself (it is necessary to hide the unnecessary at a particular moment through Visible).  The controls created after the initialization of the game form (the form of the application and the game form are different forms, although this is not visible visually), will not accept keystrokes, I could not find out the reason for this, unfortunately.  This also applies to the creation of forms subordinate to the game form - they will be visible, but the textbox and similar controls will not work.  Also, the controls created after the initialization of the game form may not be visible at all if they are subordinate to the form of the application, and not the game form. <br>  To create top-level forms for this approach is useless - they will actually be inoperable (they are very slow). <br>  Of the shortcomings of this approach, I can also point out a barely noticeable drop in performance. <br>  The code is relatively large so I did not post it in the article.  The source code of the example can be downloaded below (example 2). <br><br>  I will be glad to add and constructive criticism! <br><br>  References: <br>  <a href="http://devby.ru/topic/1064-windows-form-v-xna/">1. Solution of unavailability of keyboard input by entering a special method</a> <br>  <a href="http://xboxforums.create.msdn.com/forums/post/10166.aspx">2. The way of connecting the controls ‚Äúvice versa‚Äù - first the initialization of the controls, then the games.</a> <br>  <a href="http://www.xnadev.ru/articles.php%3Farticle_id%3D18">3. Description of the method similar to the 1st in the Russian-speaking community xna</a> <br><br>  <a href="http://rusfolder.com/34403830">Download example 1</a> <br>  <a href="http://rusfolder.com/34403861">Download example 2</a> </div><p>Source: <a href="https://habr.com/ru/post/164907/">https://habr.com/ru/post/164907/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../1649/index.html">Victor Serdyuk appointed director general of DialogueScience, CJSC</a></li>
<li><a href="../16490/index.html">Digg Launches American Presidential Election 2008 Social Network</a></li>
<li><a href="../164901/index.html">We write a simple sniffer for Windows</a></li>
<li><a href="../164903/index.html">My first captcha guessing script</a></li>
<li><a href="../164905/index.html">Leap Motion SDK is available for developers.</a></li>
<li><a href="../164909/index.html">Service-oriented technology or a small introductory orientation in the world of SOA</a></li>
<li><a href="../16491/index.html">Little man in a box</a></li>
<li><a href="../164911/index.html">Understanding the Prestashop REST API</a></li>
<li><a href="../164917/index.html">When someone says "this is impossible," it means - as real as it is!</a></li>
<li><a href="../16492/index.html">Google gop</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>