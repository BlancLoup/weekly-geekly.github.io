<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Webfonts - we deal with antialiasing under Windows (UPD)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think that not only me, but other Chrome users under Windows, on many sites, noticed problems with the display of non-standard fonts. You can read t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Webfonts - we deal with antialiasing under Windows (UPD)</h1><div class="post__text post__text-html js-mediator-article">  I think that not only me, but other Chrome users under Windows, on many sites, noticed problems with the display of non-standard fonts.  You can read the text on such sites, but it hurts your eyes.  I would have continued to endure all this, but on one of my own recent projects this question arose literally.  I decided to understand everything thoroughly. <br><br>  The difference in these two fragments is obvious.  The first is made from a randomly selected site <a href="http://adaptive-images.com/">adaptive-images</a> , and the second from its local copy, in whose css literally <b>one line</b> has been changed. <br><br>  (Those who read the first version of the article can immediately go to the <a href="https://habr.com/post/166291">UPD</a> , which shows a working alternative solution for Chrome) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/254/422/e90/254422e9044431b1899b495c711c3eda.png"><br><a name="habracut"></a><br><br><h2>  The essence of the problem </h2><br>  A small general note - the studies cited in the article were conducted under Windows 7. It will be interesting to find out in the comments on the state of affairs on other platforms. <br><br>  So, the difference between these two fragments is that in the second one, the browser uses a so-called <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B3%25D0%25BB%25D0%25B0%25D0%25B6%25D0%25B8%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">antialiasing</a> when displaying the font.  How to force the browser to use this anti-aliasing?  As it turned out later, everything depends very much on both the browser itself and the settings of the operating system.  Looking ahead, I will say that smoothing is of two types and the results of their work differ from each other.  The first type I have already mentioned, and the second is the so-called <a href="http://en.wikipedia.org/wiki/Subpixel_rendering">sub</a> - <a href="http://en.wikipedia.org/wiki/Subpixel_rendering">pixel rendering</a> .  But let's get everything in order. <br><br>  The search for a solution, as usual, began with the publication of <a href="http://habrahabr.ru/qa/32679/">this</a> issue on one of the core resources.  The answers were encouraging, but none of them helped to the full, although they spread my horizons of knowledge in this area.  The search for a working solution took three hours, during which the wall and, accordingly, its own forehead was damaged, although there was no shortage in articles with ready-made solutions.  As usual, the horned one was hiding somewhere in punctuation marks. <br><br><h2>  Chrome </h2><br>  Fortunately, I am not the first to encounter this problem and a keyword search quickly brought to its solution using SVG fonts that, unlike their TrueType counterpart, are rendered in Chrome using the first type of anti-aliasing.  It would seem - here it is happiness - but it was not there! <br><br>  Surely, there are other ways to get the necessary font-files, but for some reason I chose the <a href="http://www.fontsquirrel.com/">FontSquirrel</a> service.  I do not want to make hasty conclusions, but in my opinion, an error crept into their css generator. <br><br>  As a guinea pig, we‚Äôll take the ready-made <a href="http://www.fontsquirrel.com/fonts/Colaborate">Colaborate</a> font from their website.  The archive contains a set of fonts in various formats, the css and demo.html file. We open the latter in Chrome and start to wonder, and where is the anti-aliasing?  His absence is especially noticeable in the Bold tracing. <br><br>  Open the css and see what is generated for us on the FontSqurell server: <br><br><pre><code class="css hljs">@<span class="hljs-keyword"><span class="hljs-keyword">font-face</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">font-family</span></span>: <span class="hljs-string"><span class="hljs-string">'ColaborateThinRegular'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">src</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.eot'</span></span>); <span class="hljs-attribute"><span class="hljs-attribute">src</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.eot?#iefix'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">'embedded-opentype'</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.woff'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">'woff'</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.ttf'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">'truetype'</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.svg#ColaborateThinRegular'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">'svg'</span></span>); <span class="hljs-attribute"><span class="hljs-attribute">font-weight</span></span>: normal; <span class="hljs-attribute"><span class="hljs-attribute">font-style</span></span>: normal; }</code> </pre> <br>  at first glance, no crime is noticeable.  I will not describe the process of finding a solution, which is interrupted thereby with a bang of the head against the wall, I will give at once a fragment that yields the desired result: <br><br><pre> <code class="css hljs">@<span class="hljs-keyword"><span class="hljs-keyword">font-face</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">font-family</span></span>: <span class="hljs-string"><span class="hljs-string">'ColaborateThinRegular'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">src</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.eot'</span></span>); <span class="hljs-attribute"><span class="hljs-attribute">src</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.eot?#iefix'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">'embedded-opentype'</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.svg'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">'svg'</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.woff'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">'woff'</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'ColabThi-webfont.ttf'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">'truetype'</span></span>); <span class="hljs-attribute"><span class="hljs-attribute">font-weight</span></span>: normal; <span class="hljs-attribute"><span class="hljs-attribute">font-style</span></span>: normal; }</code> </pre><br>  As it was written above, the difference is only in one line.  The definition of the svg font is placed immediately below the definition of eot and the substring #ColaborateThinRegular is removed from it.  Judge for a difference yourself - on the right there is a fragment with the original css (there is no smoothing), on the left after making corrections: <br><div class="spoiler">  <b class="spoiler_title">Two fragments</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/29a/243/05c/29a24305c020105dee0c74c38ab21864.png"></div></div><br>  The explanation for this is quite simple - by moving the description of the svg font, we increased its priority in WebKit browsers (Chrome, Safari) and it was used instead of TTF, which for some reason does not smooth these browsers under Windows. <br><br>  I can not judge the reasons why the generator of this service makes just such a css, and not some other.  It may have worked well before, but something could have changed in WebKit since then.  I think it's worth writing them a bug report, if the comments do not provide some more logical explanation. <br><br>  But that's not all that I learned about web fonts.  Next we will talk about fine tuning in FontSquirrel for sets with Cyrillic characters, anti-aliasing in other browsers and optimizing the speed of web font loading.  I'll start with the last item. <br><br><h2>  Load optimization </h2><br>  As you know, any beauty requires sacrifice.  In the case of custom fonts, donate time to load the page by increasing the size of the loaded data.  You can combat this by compressing our font files.  For svg, the procedure is the following - using gzip, compress our file, rename it - assign it with the svgz extension and add a new MIME-type to the server configuration.  I give an example for Apache (can be specified in .htaccess): <br><br><pre> <code class="dos hljs">AddType font/opentype .svg .svgz AddEncoding gzip .svgz</code> </pre><br>  And change the corresponding line in css (add z) - url ('ColabThi-webfont.svg <b>z</b> ') format ('svg') <br><br>  Please note that font / opentype is not a standard MIME-type, but it‚Äôs this type that helps to get rid of the annoying error in the Chrome console: Resource interpreted as Mont type image / svg + xml <br><br><h2>  FontSquirrel settings </h2><br>  Now about how to configure FontSquirrel to include characters in the font that extend beyond the ASCII-7 table.  The settings shown in the screenshot below are available in Expert mode.  Let me give you an option that worked well in my case, do not forget to include other types of fonts, I only needed SVG. <div class="spoiler">  <b class="spoiler_title">Screenshot with settings</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/7eb/c48/756/7ebc4875666aa69b1a244bb67ac615bf.png"></div></div><br>  I would be grateful for clarifications to these settings, if you can somehow improve them, from experts in their field in the comments. <br><br><h2>  Other browsers </h2><br>  In conclusion, briefly touch on the features of IE, FireFox and Opera.  Let me remind you that we are talking about Windows7. <br><br>  It is worth saying that the antialiasing algorithm used by Chrome for SVG fonts is not the same as subpixel anti-aliasing used by various operating systems for displaying screen fonts.  On Windows, this technology is called <a href="http://ru.wikipedia.org/wiki/ClearType">ClearType</a> .  Look at the difference - the red font is Chrome + SVG Antialiasing, black is FireFox + TTF ClearType.  In this fragment, it is clearly seen that anti-aliasing adds ‚Äúextra‚Äù pixels, making the letters slightly wider.  For some layouts about <a href="http://habrahabr.ru/post/30191/">pixel perfect pixel perfect</a> layout you can forget. <br><div class="spoiler">  <b class="spoiler_title">Antialiasing vs Subpixel rendering</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/8a8/1b6/bf3/8a81b6bf300bf8184ffffb3c679e541a.png"></div></div><br>  By a simple experimental way, it was possible to establish that anti-aliasing in FF and large O directly depend on the ClearType settings in the operating system.  If you turn off this feature, it is impossible to force browsers to smooth fonts, although IE ignores the instructions of the operating system and always smoothes fonts.  As they say, some time ago, the css directive (-webkit-) font-smooth (ing) appeared, but in recent versions of FireFox, its support was somehow <a href="http://stackoverflow.com/questions/11459746/css3-webfont-smoothing-and-antialiasing-in-firefox-and-opera">removed</a> .  If you know how to get around these restrictions, please write about it in the comments.  It is also unclear the answer to the question of how to turn off font smoothing, because there are situations where it is not necessary. <br><br><h2>  Conclusion </h2><br>  In the process of writing this article, a number of feature articles were read and many sites were viewed through the prism of using non-standard fonts, in order to determine for themselves the scope of applicability of this useful technology.  I want to say that the conclusion I made is the following: using non-standard fonts is possible and necessary ( <s>otherwise, bootstrap plays a different role</s> ), but in limited quantities, for decorating some UI elements.  And the main text content should be left alone!  Otherwise, the site may not look the way it was originally intended.  In support of these words I give a link to a thoughtful <a href="http://www.usabilitypost.com/2012/11/05/stop-fixing-font-smoothing/">article</a> , which says about the same thing, but in more detail.  Perhaps the situation will change in the future, but for this to happen, a single font rendering subsystem should appear in browsers, displaying the text in the same way, at least within one platform. <br><br><a name="UPD"></a><br>  <b>UPD</b> Eureka!  After the <a href="http://habrahabr.ru/post/166291/">reminder</a> from <a href="https://habrahabr.ru/users/greatrash/" class="user_link">GreatRash</a> I decided to find out the reason why I didn‚Äôt work ‚Äîwebkit-font-smoothing and found a <a href="http://code.google.com/p/chromium/issues/detail%3Fid%3D152304">bug report</a> in the process.  There are more than a hundred comments, but in the midst of sluggish boozing a real <a href="http://code.google.com/p/chromium/issues/detail%3Fid%3D152304">diamond has</a> met!  This design allows you to abandon the SVG fonts and, at first glance, Chrome began to render the text in the same way as all other browsers, although the distance between the letters remains different, but this, apparently, can also be cured with <a href="http://blog.room34.com/archives/4986">this recipe</a> <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">-webkit-font-smoothing</span></span>: subpixel-antialiased <span class="hljs-meta"><span class="hljs-meta">!important</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">-webkit-backface-visibility</span></span>: hidden; <span class="hljs-attribute"><span class="hljs-attribute">-moz-backface-visibility</span></span>: hidden; <span class="hljs-attribute"><span class="hljs-attribute">-ms-backface-visibility</span></span>: hidden; }</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/166291/">https://habr.com/ru/post/166291/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../166263/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ40 (January 12 - 18, 2013)</a></li>
<li><a href="../166267/index.html">OpenMoko is alive and well</a></li>
<li><a href="../166285/index.html">Save Yota Internet Costs</a></li>
<li><a href="../166287/index.html">Dependency Injection: anti-patterns</a></li>
<li><a href="../166289/index.html">Manage Windows Services with PowerShell</a></li>
<li><a href="../166293/index.html">Tin Mok about the past, present and future of Meizu</a></li>
<li><a href="../166297/index.html">5 predictions about the future, hidden in Intel reporting</a></li>
<li><a href="../166303/index.html">Simple-Science - Simple Experiments (Digest # 14)</a></li>
<li><a href="../166305/index.html">How do SSDs (video)</a></li>
<li><a href="../166307/index.html">MintEye CAPTCHA solution in 23 lines of code</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>