<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Functions in PHP 5.6 - what's new?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From left to right: Rasmus , Build 5.4 , Version 5.5 , Relise 5.6 
 Today I want to share my vision of how work with functions will look like in the u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Functions in PHP 5.6 - what's new?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/ca0/d7a/3e2/ca0d7a3e2068320abca6583749976b17.jpg"><br><blockquote>  From left to right: <a href="http://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B5%25D1%2580%25D0%25B4%25D0%25BE%25D1%2580%25D1%2584,_%25D0%25A0%25D0%25B0%25D1%2581%25D0%25BC%25D1%2583%25D1%2581">Rasmus</a> , <a href="http://php.net/releases/5_4_0.php">Build 5.4</a> , <a href="http://php.net/releases/5_5_0.php">Version 5.5</a> , <a href="http://www.youtube.com/watch%3Fv%3DOdPXskJBFl4">Relise 5.6</a> </blockquote><br>  Today I want to share my vision of how work with functions will look like in the upcoming major release of PHP - 5.6.  To do this, I studied the <a href="https://wiki.php.net/rfc">work proposals</a> and found there many goodies: <br><br><ul><li>  New syntax for functions with a variable number of arguments and a joyful departure into the history of <i>trouble</i> with <i>func_get_args ()</i> : <br><pre><code class="php">function fn($reqParam, $optParam = null, ...$params) { }
</code></pre><br>
 </li>
<li>     :<br>
<pre><code class="php">function create_query($where, $order_by, $join_type = '', $execute = false, $report_errors = false) { }
create_query('deleted=0', 'name', default, default, /*report_errors*/ true);
</code></pre><br>
 </li>
<li>    :<br>
<pre><code class="php">use function foo\bar\baz;
baz();
</code></pre><br>
</li>
<li>     :<br>
<pre><code class="php">&lt;?php
function call_method($obj) {
    $obj-&gt;method();
}

call_method(null); // oops!

try {
    call_method(null); // oops!
} catch (EngineException $e) {
    echo "Cool Exception: {$e-&gt;getMessage()}\n";
}
</code></pre><br>
</li>
<li>  <i>deprecated</i>:<br>
<pre><code class="php">deprecated function myOldFunction() { }
</code></pre><br>
</li>
<li>       :<br>
<pre><code class="php">new foo()-&gt;xyz;
new baz()-&gt;bar(); 
</code></pre><br>
</li>
</ul>        .         .<br>
<br>
    <b></b>:    ,       RFC.        ,            ‚Äî  <a href="http://php.net/mailing-lists.php"></a> <a href="">internals@lists.php.net</a>. <br>
<br>
    RFC,         5.6.<br>
<br>
<h4><b>      </b></h4><i><a href="https://github.com/php/php-src/commit/0d7a6388663b76ebed6585ac92dfca5ef65fa7af"></a>  PHP 5.6, <a href="https://wiki.php.net/rfc/variadics"></a> 36   1</i><br>
<br>
   :  ,      <i>...$params</i>        : <br>
<pre><code class="php">function fn($reqParam, $optParam = null, ...$params) {
    var_dump($reqParam, $optParam, $params);
}
 
fn(1);             // 1, null, []
fn(1, 2);          // 1, 2, []
fn(1, 2, 3);       // 1, 2, [3]
fn(1, 2, 3, 4);    // 1, 2, [3, 4]
fn(1, 2, 3, 4, 5); // 1, 2, [3, 4, 5]
</code></pre><br>
<i>$params</i>   ,     ,   .        <i>$params</i> (  ).    <i>$params</i>   0   . <br>
<a name="habracut"></a><br>
            <i>func_get_args()</i>.   ,              MySQL: <br>
<pre><code class="php">class MySQL implements DB {
    protected $pdo;
    public function query($query) {
        $stmt = $this-&gt;pdo-&gt;prepare($query);
        $stmt-&gt;execute(array_slice(func_get_args(), 1));
        return $stmt;
    }
    // ...
}
 
$userData = $db-&gt;query('SELECT * FROM users WHERE id = ?', $userID)-&gt;fetch();
</code></pre><br>
<div class="spoiler"><b class="spoiler_title">      .</b><div class="spoiler_text">-,     <i>public function query($query)</i>  ,  ,  ,     . ,             .<br>
<br>
-,   <i>func_get_args()</i>  <i></i> ,   ,       <i>$query</i>  <i>array_slice(func_get_args(), 1)</i>.<br>
<br>
 RFC             : <br>
<pre><code class="php">class MySQL implements DB {
    public function query($query, ...$params) {
        $stmt = $this-&gt;pdo-&gt;prepare($query);
        $stmt-&gt;execute($params);
        return $stmt;
    }
    // ...
}
 
$userData = $db-&gt;query('SELECT * FROM users WHERE id = ?', $userID)-&gt;fetch();
</code></pre><br>
 <i>...$params</i>   ,       ,      <i>$query</i>      <i>$params</i>.   ,     . <br>
<br>
<h6>  </h6><br>
<ul>
<li> <i>function fn($arg, ...$args)</i>:       <i>$args</i></li>
<li> <i>function fn($arg, &amp;...$args)</i>:   </li>
<li> <i>function fn($arg, array ...$args)</i>: ,       (    )</li>
</ul><br>
<h6></h6><br>
<ul>
<li> :  ,       ,    .</li>
<li>    <i>array_slice()</i>      <i>func_get_args()</i></li>
<li>      </li>
<li>     </li>
<li>        </li>
</ul><br>
</div></div><br>
<br>
<h4><b>  </b> ‚Äî !</h4><i>  internals@lists.php.net</i><br>
<br>
 ,              :       (  / )   :<br>
<pre><code class="php">class Figure
{
    public function calcPerimeter(array $angles)
    {
        return array_sum($angles);
    }
}

class Square extends Figure
{
    public function calcPerimeter($angle)
    {
        return 4 * $angle;
    }
}

class Rectangle extends Figure
{
    public function calcPerimeter($height, $width)
    {
        return 2 * ($height + $width);
    }
}
</code></pre><br>
      :<br>
<pre><code class="php">$square = new Square();
var_dump($square-&gt;calcPerimeter(array(1, 1, 1, 1))); // 4
var_dump($square-&gt;calcPerimeter(1)); // 4
</code></pre><br>
      . , -      <i>func_get_args()</i>.       ,    ,    ,    <i>if-else</i> (    ). -   <i> </i>,        C++, Java/Scala, Delphi    .  ,         ‚Äî   .       . <br>
<br>
<h4><b>     </b></h4><i><a href="https://wiki.php.net/rfc/skipparams"> </a></i><br>
<br>
   PHP   <a href="http://en.wikipedia.org/wiki/Named_parameter"> </a>,       :<br>
<pre><code class="php">function create_query($where, $order_by, $join_type='', $execute = false, $report_errors = true) {...}
</code></pre><br>
     ,    .  ,       <i>$report_errors</i>,     ?               .     ,     ,     .<br>
<br>
   ,          , ,  ,    :<br>
<pre><code class="php">create_query("deleted=0", "name", default, default, /*report_errors*/ true);
</code></pre><br>
  , <i>$join_type</i>  <i>$execute</i>    . ,        .         ,   ,       .<br>
<br>
<h6></h6><br>
     ,    <i>ZEND_NUM_ARGS()</i>.        ,   PECL,    <i>using zend_parse_parameters</i>       <i>zval-type</i>        ,   .  ,   ,   <i>default</i>     .         ,       .<br>
<br>
<h4><b>    </b></h4><i><a href="https://wiki.php.net/rfc/variadics"></a> 16   4, <a href="https://wiki.php.net/rfc/use_function"></a>   PHP 5.6</i><br>
<br>
PHP        (, , )   <i>use</i>.   ,     .  ,         .<br>
<br>
      ,         ,    :<br>
<pre><code class="php">namespace foo\bar {
    function baz() {
        return 'foo.bar.baz';
    }
}
 
namespace foo\bar {
    function qux() {
        return baz();
    }
}
 
namespace {
    var_dump(foo\bar\qux());
}
</code></pre><br>
    ,    ,    .           :<br>
<pre><code class="php">namespace foo\bar {
    function baz() {
        return 'foo.bar.baz';
    }
}
 
namespace {
    use foo\bar as b;
    var_dump(b\baz());
}
</code></pre><br>
   .   PHP   .<br>
<br>
<div class="spoiler"><b class="spoiler_title">  </b><div class="spoiler_text">   ,      ,       .                .<br>
<br>
      <i>use</i>     ,   ,  ,     .<br>
<br>
   ,     <i>use</i>  <i>function</i>:<br>
<pre><code class="php">namespace foo\bar {
    function baz() {
        return 'foo.bar.baz';
    }
    function qux() {
        return baz();
    }
}
 
namespace {
    use function foo\bar\baz, foo\bar\qux;
    var_dump(baz());
    var_dump(qux());
}
</code></pre><br>
,          ,    :<br>
<pre><code class="php">namespace foo\bar {
    const baz = 42;
}
 
namespace {
    use const foo\bar\baz;
    var_dump(baz);
}
</code></pre><br>
     ,          :<br>
<pre><code class="php">namespace {
    use function foo\bar as foo_bar;
    use const foo\BAZ as FOO_BAZ;
    var_dump(foo_bar());
    var_dump(FOO_BAZ);
}
</code></pre><br>
<br>
<h5>   </h5><br>
<h6>      ?</h6><br>
,     .      , ,  .    ,        .        ,      .        , ,   : <i>igorw\compose()</i>.     .    ,         ,     <i>compose()</i>.           ,   .<br>
<br>
<h6>    </h6><br>
  PHP       ,      .  ,     <i>use</i>,       .<br>
<pre><code class="php">namespace foo\bar {
    function strlen($str) {
        return 4;
    }
}
 
namespace {
    use function foo\bar\strlen;
    use function foo\bar\non_existent;
    var_dump(strlen('x'));
    var_dump(non_existent());
}
</code></pre><br>
 <i>strlen()</i>  . <i>non_existent()</i>       .<br>
<br>
<h6>   <i>use function</i>,    <i>use</i>?</h6><br>
 PHP        .  <i>foo\bar</i>   <i>foo\bar</i>  ,      ,    (  ):<br>
<pre><code class="php">namespace foo {
    function bar() {}
    class bar {}
}
 
namespace {
    foo\bar(); // function call
    new foo\bar(); // class instantiation
    foo\bar::baz(); // static method call on class
}
</code></pre><br>
  <i>use</i>    ,       .<br>
<br>
:<br>
<pre><code class="php">namespace {
    function bar() {}
}
 
namespace foo {
    function bar() {}
}
 
namespace {
    use foo\bar;
    bar();
}
</code></pre><br>
   ,   <i>use</i>.     PHP,    .<br>
</div></div><br>
<br>
<h4><b>   </b></h4><i><a href="https://wiki.php.net/rfc/engine_exceptions"> </a>,   PHP 5.6</i><br>
<br>
 RFC       .<br>
<br>
  ,    :<br>
<pre><code class="php">&lt;?php
function call_method($obj) {
    $obj-&gt;method();
}
call_method(null); // oops!
</code></pre><br>
      :<br>
<pre><code class="php">Fatal error: Call to a member function method() on a non-object in /path/file.php on line 4
</code></pre><br>
 RFC     <i>EngineException</i>.     ,      :<br>
<pre><code class="php">Fatal error: Uncaught exception 'EngineException' with message 'Call to a member function method() on a non-object' in /path/file.php:4

Stack trace:
#0 /path/file.php(7): call_method(NULL)
#1 {main}
  thrown in /path/file.php on line 4
</code></pre><br>
,     :<br>
<pre><code class="php">try {
    call_method(null); // oops!
} catch (EngineException $e) {
    echo "Exception: {$e-&gt;getMessage()}\n";
}
 
// Exception: Call to a member function method() on a non-object
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><h6>  <i>E_RECOVERABLE_ERROR</i></h6><br>
     ,    .    ,    , ,    .<br>
<br>
         (   ).   ,     <i>ErrorException</i>,     ,     .<br>
<br>
<h6>Catch-all     </h6><br>
  <i>EngineException</i>  <i>Exception</i>,     <i>catch</i>   <i>Exception</i>.       .        <i>BaseException</i>,     <i>Exception</i>.  <i>BaseException</i>       ,   .     Python (<i>BaseException</i>)  Java (<i>Throwable</i>).<br>
</div></div><br>
<br>
<h4><b>  <i>deprecated</i></b></h4><i><a href="https://wiki.php.net/rfc/deprecated-modifier"> </a></i><br>
<br>
 RFC    <i>deprecated</i>    ,     <i>ZEND_ACC_DEPRECATED</i>,  ,     <i>E_DEPRECATED</i>.<br>
<br>
  ?<br>
<br>
       ‚Äî      PHP     .     .      <i>ZEND_ACC_DEPRECATED</i>  ,  Zend       <i>E_DEPRECATED</i>.   ,           <i>@deprecated</i> (  )    <i>E_USER_DEPRECATED</i>.        ,         ?<br>
<br>
        <i>deprecated</i>,    ,     .<br>
<br>
 <i>E_USER_DEPRECATED</i>              .<br>
<br>
 ,  <i>ReflectionFunction::isDeprecated()</i>       .   RFC   .<br>
<br>
<pre><code class="php">deprecated function myFunction() {
    // ...
}
myFunction();
</code></pre><br>
<pre><code class="php">Deprecated: Function myFunction() is deprecated in ... on line 5
</code></pre><br>
<pre><code class="php">class MyClass {
    public deprecated static function myMethod() {
        // ...
    }
}
MyClass::myMethod();
</code></pre><br>
<pre><code class="php">Deprecated: Function MyClass::myMethod() is deprecated in ... on line 7
</code></pre><br>
<br>
<h4><b>       </b></h4><i><a href="https://wiki.php.net/rfc/instance-method-call"> </a></i><br>
<br>
  RFC ‚Äî            .        .<br>
<br>
<h6> 1 ( )</h6><br>
<ul>
<li><i>new foo-&gt;bar()</i></li>
<li><i>new $foo()-&gt;bar</i></li>
<li><i>new $bar-&gt;y()-&gt;x</i></li>
</ul><br>
<pre><code class="php">class foo {
	public $x = 'testing';
 
	public function bar() {
		return "foo";
	}
	public function baz() {
		return new self;
	}
	static function xyz() {
	}
}
 
var_dump(new foo()-&gt;bar());               // string(3) "foo"
var_dump(new foo()-&gt;baz()-&gt;x);            // string(7) "testing"
var_dump(new foo()-&gt;baz()-&gt;baz()-&gt;bar()); // string(3) "foo"
var_dump(new foo()-&gt;xyz());               // NULL
new foo()-&gt;www();                         // Fatal error: Call to undefined method foo::www()
</code></pre><br>
<h6> 2 ( )</h6><br>
<ul>
<li><i>(new foo())-&gt;bar()</i></li>
<li><i>(new $foo())-&gt;bar</i></li>
<li><i>(new $bar-&gt;y)-&gt;x</i></li>
<li><i>(new foo)[0]</i></li>
</ul><br>
<pre><code class="php">class foo {
	public $x = 1;
}
 
class bar {
	public $y = 'foo';
}
 
$x = 'bar';
 
$bar = new bar;
 
var_dump((new bar)-&gt;y);     // foo
var_dump((new $x)-&gt;y);      // foo
var_dump((new $bar-&gt;y)-&gt;x); // 1
</code></pre><br>
<br>
<h4></h4><br>
,   .     ,        !      ,      :) <br>
<br>
      ,  ,       RFC. , , -     :)<br>
<br>
   !</div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/198980/">https://habr.com/ru/post/198980/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../198962/index.html">Beaded sorting (Bead sort)</a></li>
<li><a href="../198964/index.html">Helios Kernel - include in javascript, now for nodejs</a></li>
<li><a href="../198970/index.html">Php.net Resource Restored</a></li>
<li><a href="../198974/index.html">Build a simple cartogram Pandas + Vincent</a></li>
<li><a href="../198978/index.html">A century of play - a century of learning. Computer games learning curve</a></li>
<li><a href="../198982/index.html">Accelerate Nginx in 5 minutes</a></li>
<li><a href="../198984/index.html">ViPNet Password Generator helps users create strong passwords</a></li>
<li><a href="../198986/index.html">Derby.js Log in</a></li>
<li><a href="../198988/index.html">Published a preliminary program of the conference Cloud OS Summit</a></li>
<li><a href="../198992/index.html">Planning the hardware for your OpenStack cluster: answers to your questions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>