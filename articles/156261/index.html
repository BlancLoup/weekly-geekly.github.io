<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The implementation of the idea of ‚Äã‚Äãa wireless level gauge</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the process of working with the installation, the task appeared to make the level gauge in the tanks, since there were occasional overflows, and wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The implementation of the idea of ‚Äã‚Äãa wireless level gauge</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage2/f34/2d0/b37/f342d0b37f84dfbff5d983d1db703579.jpg">  In the process of working with the installation, the task appeared to make the level gauge in the tanks, since  there were occasional overflows, and when 8-10 tons of water are in the basement, which was once a pool for testing torpedoes, then pulling it all into buckets on the third floor is a very difficult task.  It would seem that there is nothing special in the task, but several difficulties have appeared. <br><br>  Conditions: <br><ul><li>  Volume of tanks: 2 to 8,000 liters </li><li>  Geographic position of tanks: -2nd floor (8 meters underground) </li><li>  Floor overlappings: wood </li><li>  Required level accuracy: ¬± 10 liters </li><li>  Critical Level Warning </li><li>  Indication in the workplace </li></ul><br><br><a name="habracut"></a><br><h1>  Analog option </h1>  The option with probes in extreme positions disappeared immediately, due to the lack of information about the current level.  The first idea was the implementation on the analog principle of the comparator.  The basis is LM3915N-1, which is mainly used for logarithmic indicators in acoustics.  Scheme - nowhere easier. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/117/6ea/2ef/1176ea2efae67b01653ba4e461a70110.jpg"><br><br>  Level output - a point or a column on the line of LEDs.  The board shows one shoulder of the voltage divider, which set the initial level. <br><br><img src="https://habrastorage.org/storage2/81d/5f6/d83/81d5f6d838114df7c63f369a49907805.jpg"><br><br>  As a measuring element, a chain of resistors with a length of one and a half meters was made, it was also the second divider arm at the input of the mikruhi.  The values ‚Äã‚Äãof the resistors were chosen so that the output voltage varied from 2 to 5 V, required by the datasheet for the LM.  The chain is immersed in the tube for visual inspection along the tank.  Connection with the "probe" - 15 meters of a two-wire cable. <br><br><img src="https://habrastorage.org/storage2/83e/b51/2a3/83eb512a325ced31b293188f4943610a.jpg"><br><br>  The principle of the idea was that when the resistors were flooded, some of them would close with water, respectively, the voltage at the input of the comparator would increase, the LED bar would be filled.  The advantages of this idea lie in the speed of implementation and simplicity, a minus of this light collective farm got out in two or three weeks.  The level on the indicator began to gradually fall, and the level in the tank was normal.  Trimmer I summed it up to normal, until the design stopped working at all.  The reason turned out to be transparent, but it had not previously been possible to guess.  The solder of the chain of resistors underwent major electrolysis and the salts of water simply gnawed it in several places.  The solution to this disgrace is only a float with a magnet and a reed switch for each link or pile of Hall sensors that would close the ‚Äúprobe‚Äù links, but this even larger collective farm and the complexity of the design would obviously increase with the same weak discreteness and accuracy.  The scheme was dismantled. <br><br><h1>  Back to the old drawing board. </h1>  As a new implementation, I decided to make a device on the controller.  Arduino and analogues do not use in principle, it is more interesting to do everything from scratch, although you can learn something.  I work with controllers a little, a year and a half maximum, so I try to learn something new in each development, which means that it would be possible to get by with much cheaper elements (display, connection), but less interesting.  Also, do not kick much for implementation and code. <br><br>  A new idea is to use an ultrasonic rangefinder, measure the distance to the water surface, and since  tank sizes are known, then the volume to calculate - the task of the simplest. <br><br>  Components: <br><ul><li>  Display: 128x64 graphic <a href="http://www.ebay.com/itm/12864-Graphic-LCD-Display-Pin-header-For-Arduino-2560-UNO-R3-51-ARM-PIC-A043-/261014862286">NoName</a> with ebay </li><li>  Controller: AT Mega16a PU </li><li>  Ultrasonic Sensor: <a href="http://www.ebay.com/itm/Arduino-Ultrasonic-Module-HC-SR04-Distance-Measuring-Transducer-Sensor-/170909347903">HC-SR04</a> with ebay </li><li>  Communications: BT <a href="http://www.ebay.com/itm/JY-MCU-HC-06-V1-03-Bluetooth-Transeiver-RF-Module-Wireless-Serial-4p-Port-line-/261053366958">JY-MCU HC-06 V1.03</a> with ebay </li><li>  Receiver: <a href="http://www.ebay.com/itm/330782868458">Bluetooth Dongle Adapter USB 2.0</a> </li></ul><br><br>  All this was embedded in the layer of insulation, which sheathed tanks, here is the gutted back side of the block that was embedded in the tank trim: <br><br><img src="https://habrastorage.org/storage2/46c/600/1b3/46c6001b3d02aa13442f34591034ca95.jpg"><br><br>  The controller program was written in C (CodeVision AVR), the client part in Delphi 7. <br>  The essence of the work is as follows, the controller registers the duration of the echo pulses from the ultrasonic sensor by timer, counts into the distance, then into the volume.  The data on the bluetooth is transmitted to the computer, where the graphic output of the tank filling, the distance to the surface and the depth go.  All this is calculated in the controller.  The maximum and minimum limits are set from the client to the controller, upon reaching which the red or green LED lights up on the lab, and the program displays a sound on the computer and the display of the tank in which it has reached the limit flashes.  Also, the volume coefficient [l / cm] is set so that the sensor can be positioned or even put it on a tank with a different geometry.  All parameters are stored in EPPROM.  The system has two channels, data is transmitted from two tanks simultaneously.  At the time of the shooting, one tank was lowered and I turned off this channel so that my eyes would not waste. <br><br><img src="https://habrastorage.org/storage2/a70/c6d/5bd/a70c6d5bd0f30c92640ceae66ddebf6d.jpg"><br><br>  Initially, the idea was to transmit data over the wires, but it was difficult to lay 15 meters of the wire past the ceiling.  By air, the distance was about 8 meters.  The receiver is located in the computer, in the special cabinet near the mine, the installation control system, which is fed from the experimental tanks, is spaced apart, one is the operator's seat next to the mine and the pipeline, the second is rendered away.  The sensors themselves are installed in a plastic pipe with a diameter of 100 mm inside the tank so that when they drain water into the tanks they do not splash and the level smoothly changed, there are no waves and ripples on the surface, just in case.  The advantage of this is also the fact that the ultrasound sensor pattern of the ultrasound is narrow.  Unfortunately, there is no photo of the installation site, the tank lids are already screwed onto 40 small bolts and the Nemer weighs; <br><br>  View of the display in thermal insulation (one channel): <br><br><img alt="Forgot to remove the film" src="https://habrastorage.org/storage2/021/0d4/213/0210d4213d535705dff5178bc9fb7aec.jpg"><br><br>  Globally, besides solving the level control problem in underground tanks, I have also developed a little, touched the bluetooth module, added libraries for graphics, touched the ultrasonic sensor, and progress is always good. <br><br>  You can fill it all with silicone or compound, but I have not oxidized anything until at a humidity of 60-70%, the Chinese themselves write IP68 to the ultrasonic sensors themselves, who knows, maybe they really do, I still filled it with hot melt glue in a circle. <br><br>  This is how the system turned out, it works properly, perhaps someone will come in handy, it is quite applicable at the cottage in the well and in other hard-to-reach places.  The main thing is the idea. <br><br>  I don‚Äôt regret everything that was in the archive, MK firmware, PROTEUS files, Delphi 7 raw files, compiled executables, all libraries, in short, the entire project folder.  [archive password: idkfa] <br>  <a href="">AVR LevelMeter Graphic LCD 2ch BLUETOOTH.rar [2.6 Mb]</a> </div><p>Source: <a href="https://habr.com/ru/post/156261/">https://habr.com/ru/post/156261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../156249/index.html">Apple has apologized to Samsung</a></li>
<li><a href="../156251/index.html">Cooking advanced CGridView</a></li>
<li><a href="../156253/index.html">Determining the speed of the SD card</a></li>
<li><a href="../156255/index.html">We automate the collection of information about the program crashes.</a></li>
<li><a href="../156259/index.html">Create an Azure based game server</a></li>
<li><a href="../156263/index.html">Developer Economics 2013 study: participation</a></li>
<li><a href="../156265/index.html">Halloween - hello admin</a></li>
<li><a href="../156267/index.html">The new Switchvox 450 & 470, API and something else ...</a></li>
<li><a href="../156269/index.html">The results of the contest "I and my ASUS: One Day in Our Life"</a></li>
<li><a href="../156271/index.html">Component MacBook Repair: Power Supply Repair</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>