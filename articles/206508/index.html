<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we made reading letters safer: Content Security Policy in Yandex.Mail</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the priorities for the Yandex.Mail team has always been and is the security of user data. And this concerns not only the storage of letters, bu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we made reading letters safer: Content Security Policy in Yandex.Mail</h1><div class="post__text post__text-html js-mediator-article">  One of the priorities for the Yandex.Mail team has always been and is the security of user data.  And this concerns not only the storage of letters, but also secure access to them.  Back in 2011, we began to pass all images in letters through our proxy servers, blocking one of the distribution channels of malicious code, and also cache them to save traffic and ensure greater privacy.  In November of this year, we <hh user="http://habrahabr.ru/company/yandex/blog/203882/">  they implemented encryption when receiving and sending mail, and also transferred mail to HTTPS-only mode - now the web interface is available only via a secure protocol. <br><br>  And more recently, we have begun to support a new user data protection mechanism - the Content Security Policy standard.  With it, you can prevent scripts on the page from loading any resources from hosts that are not listed in the white list. <br><br>  This is still a rather rare thing (not a single large post known to us yet uses this), and in this post we will share our experience in implementing the standard. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="http://habrahabr.ru/company/yandex/blog/206508/"><img src="https://habrastorage.org/getpro/habr/post_images/e27/8e5/099/e278e509944463ea28d0a454c62edb1b.png" alt="image"></a> <br><a name="habracut"></a><br>  <a href="http://ru.wikipedia.org/wiki/%25CC%25E5%25E6%25F1%25E0%25E9%25F2%25EE%25E2%25FB%25E9_%25F1%25EA%25F0%25E8%25EF%25F2%25E8%25ED%25E3">XSS</a> , despite all the knowledge, is one of the most common vulnerabilities of sites.  This vulnerability allows an attacker to insert malicious code into a web application page.  How to control it on the server, we know very well.  But on the user side, this is all somewhat more complicated. <br>  What methods of protection do we know? <br><ul><li>  User Input Validation and Web Application Firewall (WAF); </li><li>  special character escaping; </li><li>  protecting cookies using HttpOnly so that they cannot be read from JavaScript; </li><li>  various browser plugins, for example, noscript. </li></ul><br>  Now there is another protection mechanism against such attacks - Content Security Policy. <br><br>  Content Security Policy ( <a href="http://en.wikipedia.org/wiki/Content_Security_Policy">CSP</a> ) is a new standard that defines Content-Security-Policy and Content-Security-Policy-Report-Only HTTP headers that tell the browser a white list of hosts from which it can download various resources. <br>  The current status of the <a href="http://www.w3.org/TR/CSP/">standard</a> is Candidate Recommendation. <br><br>  Today, it is supported by all popular browsers: <br><ul><li>  Chrome 25+, Firefox 23+, Opera 15+, and Yandex Browser have full support and understand the standard header; </li><li>  Firefox 4-22, IE 10+ support non-standard X-Content-Security-Policy header and have partial support for the standard one; </li><li>  Chrome 14-24, Safari 5-7 support the non-standard X-Webkit-CSP header and have partial support for the standard one. </li></ul><br>  For information, you can read on HTML5 Rocks <a href="http://www.html5rocks.com/en/tutorials/security/content-security-policy/">article by</a> Mike West (Mike West) - one of the developers of the standard.  A good standard description is on <a href="https://developer.mozilla.org/en-US/docs/Security/CSP">MDN</a> . <br><br><h4>  What does CSP consist of? </h4><br>  The CSP header consists of a set of divided directives - parts of a policy that control certain browser resources. <br><ul><li>  In the current version of the standard, the following set of directives is available: </li><li>  default-src specifies a list of hosts that are assigned by default to unspecified directives. </li><li>  script-src, style-src, object-src (for plugins like Flash), img-src, media-src (audio and video), frame-src (iframe), font-src, connect-src (XMLHttpRequest, WebSocket, EventSource) - narrower directives that control the corresponding browser resources.  For each directive, you must specify a list of hosts (not urls) with which the browser can communicate.  Can be used *. </li><li>  report-uri - specifies the URL to which the JSON violation reports will be sent.  This is how it looks like: </li></ul><br><br><pre><code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"csp-report"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"document-uri"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://mail.yandex.ru/neo2/"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"referrer"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://www.yandex.ru/"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"violated-directive"</span></span>: <span class="hljs-string"><span class="hljs-string">"script-src 'unsafe-inline' 'unsafe-eval' blob: chrome-extension: *.yandex.ru *.yandex.net yandex.st"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"original-policy"</span></span>: <span class="hljs-string"><span class="hljs-string">"....     ..."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"blocked-uri"</span></span>: <span class="hljs-string"><span class="hljs-string">"...    ..."</span></span> } }</code> </pre> <br><br>  Some browsers also report a link and a JS line in the report, which led to a breach of security policy. <br><br>  In addition, in the directives you can use not the hosts, but keywords (always in quotes): <br><ul><li>  'self' - corresponds to the current host, protocol and port. </li><li>  'none' - everything is forbidden. </li><li>  'unsafe-inline' is used in script-src and enables <code><code>, javascript:  -  (onclick="").  style-src      style="".        , ..       javascript  ,     XSS. <br> 'unsafe-eval' ‚Äî   script-src    : eval, new Function, setTimeout(' var foo = "bar" ', 1). <br></code></code> <code><code>, javascript:  -  (onclick="").  style-src      style="".        , ..       javascript  ,     XSS.</code> <br> 'unsafe-eval' ‚Äî   script-src    : eval, new Function, setTimeout(' var foo = "bar" ', 1). <br></code> <br><br>  Hosts can be specified as simply <code>"yandex.st"</code> , and with the protocol or port <code>"https://yandex.st:443"</code> .  Remember that if the host does not have a protocol or port, then it is taken from the current page, by analogy with the same origin policy.  Thus, the host <code>"yandex.st"</code> on the page <code>"https://mail.yandex.ru:443/neo2/"</code> automatically takes the form <code>"https://yandex.st:443"</code> . <br><br>  If the Content-Security-Policy header is specified, the browser blocks all resources that do not comply with the policy.  The Content-Security-Policy-Report-Only header also checks all resources, but does not block them, but only reports violations.  We recommend using it in the early stages of CSP implementation. <br><br><h4>  How we implemented </h4><br>  We investigated this technology from the spring, when there was no standard implementation yet.  First, carefully implemented the Content-Security-Policy-Report-Only header for our internal mail.  Some time we studied the reports and corrected our policy, and in May we included CSP in blocking mode.  During internal testing, the behavior of all headers, both standard and none, was investigated. <br><br>  With public mail it was somewhat more difficult, because users came to us with an uncontrolled environment.  For several months, we understood the reports, corrected the politicians, and finally, in the fall, rolled them out 100% in blocking mode. <br><br>  The most interesting thing that we now have is several million daily reports with violations from viruses, careless plug-ins and extensions that try to insert their code into our pages.  We cannot control the content of this code, which means we cannot guarantee that it treats the personal data of our users with care - and we are pleased that we block their execution. <br><br>  In addition, during the implementation process, we developed tools for working with CSP: <br><ul><li>  Chromium-based browser <a href="https://github.com/oxdef/csp-tester">extension</a> to add headers to the page and test policies. </li><li>  <a href="https://github.com/oxdef/csp-reporter/">A utility</a> for parsing browser reports to make it easier to get a list of blocked resources. </li></ul><br><br>  Let us analyze the title on the example of mobile Yandex.Mail <br><pre> <code class="hljs pgsql">//     , yandex.st    WebSocket  xiva-daria.mail.yandex.net Content-<span class="hljs-keyword"><span class="hljs-keyword">Security</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">Policy</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>-src <span class="hljs-string"><span class="hljs-string">'self'</span></span> wss://xiva-daria.mail.yandex.net yandex.st; //          frame-src *.yandex.ru; // <span class="hljs-string"><span class="hljs-string">'self'</span></span> data:  <span class="hljs-keyword"><span class="hljs-keyword">inline</span></span>- // mc.yandex.ru ‚Äî . // yandex.st ‚Äî  CDN   // *.yandex.net -   https- img-src <span class="hljs-string"><span class="hljs-string">'self'</span></span> data: mc.yandex.ru *.yandex.net yandex.st; //       font-src <span class="hljs-string"><span class="hljs-string">'none'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>-src <span class="hljs-string"><span class="hljs-string">'none'</span></span>; // <span class="hljs-string"><span class="hljs-string">'unsafe-inline'</span></span> ‚Äî   <span class="hljs-keyword"><span class="hljs-keyword">inline</span></span>-      // yandex.st ‚Äî  CDN   style-src <span class="hljs-string"><span class="hljs-string">'unsafe-inline'</span></span> yandex.st; // self  blob ‚Äî    js  blob // unsafe-eval      // mc.yandex.ru ‚Äî . // yandex.st ‚Äî  CDN   script-src <span class="hljs-string"><span class="hljs-string">'self'</span></span> <span class="hljs-string"><span class="hljs-string">'unsafe-eval'</span></span> blob: mc.yandex.ru yandex.st; //      report-uri /neo2/csp.jsx?<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>=touch</code> </pre><br>  A rough plan for implementing CSP on a service is as follows: <br><ol><li>  Evaluation of the list of downloadable resources. </li><li>  Implementing the Content-Security-Policy-Report-Only header. </li><li>  Log analysis. </li><li>  Policy correction. </li><li>  Implementing the Content-Security-Policy header (switching to blocking mode). </li><li>  The happiness of users :) </li></ol><br><h4>  What to consider when implementing </h4><br>  Browser features: <br><ul><li>  Safari 5 and AndroidBrowser with the X-Webkit-CSP header have a very poor implementation of the standard.  And we advise you not to use CSP for these browsers at all.  For example, they poorly understand the unsafe-eval and unsafe-inline rules. </li><li>  Firefox in X-Content-Security-Policy implements slightly non-standard directives.  Instead of connect-src, you need to write xhr-src (or you can add rules to default-src).  In addition, he does not understand unsafe-inline, unsafe-eval, instead of them it is necessary to add the directive "options inline-script eval-script".  You can read more about your own implementation of the header on the <a href="https://wiki.mozilla.org/Security/CSP/Specification">Mozilla wiki</a> . </li><li>  Firefox and X-Content-Security-Policy have <a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D820719">problems</a> with report-ui. </li><li>  Safari in iOS6 sends very uninformative reports. </li></ul><br>  We do not recommend using custom headers.  The latest versions of modern browsers (with the exception of IE) support the standard header, therefore, using only it, you cover the vast majority of the audience. <br><br>  Features CSP, which must always be remembered: <br><ul><li>  If you use inline-pictures, then in img-src you need to enable the "data:" protocol. </li><li>  Using Blob, specify 'self' (for Chrome) and blob: (for Firefox and X-WebKit-CSP) </li><li>  The CSP of the top document does not apply to child iframes except for about: blank. </li><li>  If you do not want to block chrome extensions, which, by the way, from the latest versions also live on CSP, then you need to allow the ‚Äúchrome-extension:‚Äù protocol </li><li>  default-src applies to all unspecified directives, but if you want to add or remove something, you will have to specify all domains again. </li><li>  You can specify both Content-Security-Policy and Content-Security-Policy-Report-Only.  Both headers will work independently.  This approach will be useful for testing new policies. </li><li>  If you use frameworks with feature detection (for example, <a href="http://bugs.jquery.com/ticket/12040">jQuery &lt;1.8</a> or Modernizr), then for style-src you must specify 'unsafe-inline'. </li></ul><br><br>  Naturally, this is not always possible, but try not to use *, but specify the exact list of domains.  Also specify all directives, otherwise all errors will occur as a violation in default-src.  Of course, the size of the header will increase, but it will be much easier to find problems. <br><br>  Unfortunately, we have not yet managed to refuse unsafe-inline.  Inline scripts in the mail are used for two things: issuing settings and checking the loading of critical JS (jQuery and bootloader).  And if we could change the settings to JSON, then we could not refuse important reports of JS unloading, and we had to leave 'unsafe-inline'.  Also, problems were added by the active use of inline attributes in the TinyMCE WYSWYG editor. <br><br>  Although this rule allows you to execute any inline javascript on the page, we can protect ourselves by allowing connections only to trusted resources. <br><br><h4>  Updated CSP 1.1 standard </h4><br>  The new version of the standard is currently in the draft stage, but Chrome and Firefox are already beginning to introduce new features from it. <br><br>  For example, the new nonce directive may be a solution to inconvenience with a complete ban on unsafe-inline.  The work scheme is still under development, but we are making efforts so that it works as follows: <br><ol><li>  nonce - a random sequence of characters transmitted in the header; </li><li>  if there is unsafe-inline and nonce, then nonce turns off unsafe-inline; </li><li>  only inline scripts are executed that are signed by the nonce attribute with the same sequence of characters. </li></ol><br>  Example: <br><pre> <code class="hljs xml">Content-Security-Policy: default-src 'self'; script-src 'self' https://example.com 'nonce-eef8264c4994bf6409c51ac7c9614446' <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> alert(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">",   nonce"</span></span></span><span class="actionscript">) </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">nonce</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"22168992a8d57a5d3a64ca73bb9fc669"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> alert(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">",    nonce  "</span></span></span><span class="actionscript">) </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">nonce</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eef8264c4994bf6409c51ac7c9614446"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> alert(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">",    nonce "</span></span></span><span class="actionscript">) </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ,    script-src  https://example.com --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://example.com/allowed-because-of-src.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ,    nonce   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">nonce</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"22168992a8d57a5d3a64ca73bb9fc669"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://otherdomain.com/invalid.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- ,    nonce ,   ,  otherdomain.com    script-src --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">nonce</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eef8264c4994bf6409c51ac7c9614446"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://otherdomain.com/valid.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Also CSP 1.1 adds new features: <br><ul><li>  indication of the policy through the meta tag; </li><li>  JavaScript API for getting and checking policies; </li><li>  DOM violation policy event; </li><li>  new directives form-action, plugin-types. </li></ul><br><h4>  Finally </h4><br>  CSP was not only protection against attacks and blocking incomprehensible requests.  In testing, we were pleasantly surprised by two things: <br><ol><li>  In essence, CSP allows you to make a distributed security testing system out of users' computers.  And if the number of reports of violations increases dramatically, this is a reason to go looking for a problem. </li><li>  Since all mail users are working on HTTPS, CSP made it possible to track and fix those secluded places where requests were still sent via HTTP. </li></ol><br>  Try CSP, embed, protect users' personal data and just make the world a better place. </li></ul></hh></div><p>Source: <a href="https://habr.com/ru/post/206508/">https://habr.com/ru/post/206508/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../206498/index.html">Boom charitable startups in Russia?</a></li>
<li><a href="../206500/index.html">Hackathon Apps4all: scandals, intrigues, investigations</a></li>
<li><a href="../206502/index.html">Is it easy to teach a robot to pass a test for programmers?</a></li>
<li><a href="../206504/index.html">The Swede will pay $ 610,000 for downloading 1 movie to a torrent tracker, plus a penalty for poor quality.</a></li>
<li><a href="../206506/index.html">Online Trading Gadgets</a></li>
<li><a href="../206510/index.html">Mathematical straightening</a></li>
<li><a href="../206512/index.html">Top 7 cases of downtime known services and resources in 2013</a></li>
<li><a href="../206514/index.html">Piwik 2.0 was released</a></li>
<li><a href="../206516/index.html">Constructing the Julia Set</a></li>
<li><a href="../206518/index.html">Installing Sailfish OS on Nokia N9</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>