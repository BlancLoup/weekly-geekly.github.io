<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dependency injection in .Net Mark Siman 1 - Dependencies between application layers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dependencies between application layers | Designer implementation, lifetime | Cross-cutting aspects of the application, interception, decorator 

 The...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dependency injection in .Net Mark Siman 1 - Dependencies between application layers</h1><div class="post__text post__text-html js-mediator-article">  Dependencies between application layers |  <a href="https://habrahabr.ru/post/344380/">Designer implementation, lifetime</a> |  <a href="https://habrahabr.ru/post/344986/">Cross-cutting aspects of the application, interception, decorator</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2d/a18/295/c2da18295354ee36ac0dadea9a071775.jpg" alt="Introducing dependencies in .Net by Mark Siman" hspace="15" vspace="15" align="left" height="360">  The principles of program development, called ‚ÄúDependency Injection‚Äù (OT), is not a new topic, but it‚Äôs no less interesting and useful.  Even if you do not know what a ‚Äúdependency injection container‚Äù is, you may already be using the OT.  Do you work with Angular?  - you are in the subject.  In any case, it is impossible to ignore this concept and remain a competitive developer. <br><br>  Let's talk about the wonderful book by Mark Siman.  This note does not claim to be complete, it is not a brief summary and can in no way replace Mark's work.  But, I hope, motivates to read 379 pages (there are 463 pages in total in the book), it will show interesting techniques from the author‚Äôs arsenal.  And, of course, it will help support the conversation with colleagues at the water cooler. <br><a name="habracut"></a><br><h2>  For whom the book </h2><br>  The book is very suitable for server-side web developers, development approaches are considered on the example of an online store.  Well, if you have experience of participation in real projects, then in the course of the narrative analogies from life will arise - Mark managed to highlight real, uninvented problems and show how to solve them.  If you are just starting your career, reading will not be so interesting, you have not yet felt the pain of development and support of any major project. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The book is for those who not only want to understand the "dependency injection" (for this there are articles shorter), but more for those who want to learn how to develop long-playing applications that can be developed. <br><br><h2>  main idea </h2><br>  In order to make a good durable project, the code must be structured, broken into modules that are as less related as possible - loosely coupled. <br><br><blockquote>  The benefits we get from using loose binding are not always obvious, but it manifests itself over time as the size and complexity of the developed code increases.  (quote from the book) </blockquote><br>  The book is about how to achieve weak binding, including (but not only) using the OT.  Linking code can be estimated, there are unambiguous quantitative indicators.  For example, how many libraries are in your project, what references to each other do they have.  It happened that your ASP.NET MVC project has a dll reference with Entity Framework entities?  Or even does not refer, and contains Entity context?  Reason to buy a book. <br><br><h2>  A typical web application consists of three levels. </h2><br>  Further reading will require some experience developing web projects.  If you do not have it, then it will not be interesting. <br><br>  Often, there are 3 levels of application: <br>  - display level <br>  - level of business logic <br>  - level of data access <br><br>  This Mark considers correct, in his opinion, it is possible to go further and divide the display level by two more and be 4. <br><br>  Usually start with a data access level.  And usually use the Entity Framework (EF) (nothing against EF is a great technology). <br><br>  In articles and books about the Entity Framework, you can find descriptions of how great it is that the Code First model allows you to create domain POCO / DTO objects.  How bad it is to use attributes in such POCO objects ‚Äî binding to database tables should be done only using the Entity Framework Fluent Api.  It is advised to have two projects: <br>  - one with POCO objects (describe objects that lie in the database), let's call it <i>Models</i> <br>  - the second one contains EF Context and Fluent mapping to the base, let it be <i>DataAccessLayer</i> <br><br>  Thus, POCO objects seem to be ‚Äúdisconnected‚Äù from the ‚Äúdata access layer‚Äù.  EF Context plays the role of repository. <br><br>  In this scheme, it is easy to be deceived.  Next, a <i>BusinessLayer</i> project is created in which: <br>  - EF POCO objects are used as business entities (after all, they are ‚Äúnot connected in any way‚Äù with the database), <br>  - EF Context is also used, linq queries are very convenient. <br><br>  Thus, the <i>BusinessLayer</i> project contains references to <i>Models</i> and <i>DataAccessLayer projects</i> . <br><br>  The display level queue is an ASP.NET MVC <i>WebSite</i> project that renders EF POCO objects.  <i>WebSite</i> project has references on <i>BusinessLayer</i> and <i>Models</i> . <br><br>  The scheme of dependencies of such a project in Figure 1. It can be seen that the entire application depends on the level of data access.  The result is a strongly related code. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8a/ff6/9df/e8aff69dff41e77ee71fd8c239f6b5e0.png" alt="Dependency scheme of a highly related application (arrows in the direction of dependence)"><br>  <i>Figure 1. The dependency diagram of a highly related application (arrows in the direction of dependence)</i> <i><br></i> <br>  Note: EF POCO objects are not actually business objects, they are one-on-one mapped on the database structure.  They cannot be changed without changing the database schema; if the database is changed, you will need to rewrite all linq queries that are made in <i>BusinessLayer</i> . <br><br>  To determine which dependencies between the layers are correct, Mark argues as follows: which part of the application does not make sense to change even in a hypothetical scenario? <br><br><ul><li>  Theoretically, the display level may need to be replaced: <br>  o say go to the new framework, <br>  o or make simultaneously two levels of display: the site and the mobile application. </li><li>  The level of data access can also be changed in theory: <br>  o - new DBMS not supported by EF (weak argument, but we are considering hypothetical situations to identify the right dependencies), <br>  o part of the data on objects can be moved to another database or a web service, <br>  o finally file repositories for testing. </li><li>  But if the level of business logic changes, we will get a new application.  Fit to it the old base and the interface will not work. </li></ul><br>  Thus, all application layers should depend only on business logic.  The business layer should not have dependencies at all - Fig. 2. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f10/a71/bea/f10a71bea514a38fe8830bfbad2e3736.png" alt="Correct Dependency Map"><br>  <i>Fig 2. Correct dependency diagram</i> <br><br>  How will <i>BusinessLayer</i> get data without reference to <i>DataAccessLayer</i> and its repositories?  In the book it is. <br><br>  When examining the example, the author makes an interesting remark: not only the resulting dependencies are wrong, but also the order in which the layers are developed.  It is necessary to start not from the database, and not from business objects, but from the display level.  In the text you will find a step by step description of the development. <br><br><h2>  To be continued (?) </h2><br>  We talked about those to whom the book is addressed, briefly reviewed a typical web application.  Mark Siman has cooked a lot more useful.  The note turns out long, it makes sense to break it into blocks.  Until new meetings. </div><p>Source: <a href="https://habr.com/ru/post/343830/">https://habr.com/ru/post/343830/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343820/index.html">Technical diary: half a year developing mobile PvP</a></li>
<li><a href="../343822/index.html">Heading "We read articles for you." October - November 2017</a></li>
<li><a href="../343824/index.html">MySQL and partitioning</a></li>
<li><a href="../343826/index.html">Russia's first mitap on Apache Ignite, December 12</a></li>
<li><a href="../343828/index.html">Writing a simple Linux kernel module</a></li>
<li><a href="../343832/index.html">Designing a system for reading data from input devices (Part Two)</a></li>
<li><a href="../343834/index.html">Introduction to reinforcement training: from a multi-armed gangster to a full-fledged RL agent</a></li>
<li><a href="../343836/index.html">EU GDPR: Compliance with the requirements of regulators in the field of cloud computing</a></li>
<li><a href="../343838/index.html">Analyze it - Lenta.ru</a></li>
<li><a href="../343840/index.html">Renga development team: how we reached the idyll, working without managers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>