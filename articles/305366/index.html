<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Amazing story document.write</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The document.write method is one of the strangest methods. It inserts the HTML code on the page immediately after it. More precisely, right after the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Amazing story document.write</h1><div class="post__text post__text-html js-mediator-article"> The <code>document.write</code> method is one of the strangest methods.  It inserts the HTML code on the page immediately after it.  More precisely, right after the <code>&lt;script&gt;</code> , inside which it is located.  And only if the document has not yet been completely downloaded.  And if there was?  Then the page is cleared and replaced with what was specified. <br><br>  You can insert a line that explicitly breaks the rest of the page: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span class="hljs-string">'&lt;plaintext&gt;'</span></span>)</code> </pre><br>  Or you can play Russian roulette: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() &gt; <span class="hljs-number"><span class="hljs-number">0.9</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span class="hljs-string">'&lt;!--'</span></span>)</code> </pre><a name="habracut"></a><br>  It turns out that the fact that the text is inserted immediately <i>after the</i> <code>&lt;script&gt;</code> tag is important.  For example: <br><br><pre> <code class="javascript hljs">&lt;script&gt; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span class="hljs-string">'&lt;script src="jquery.js"&gt;&lt;/'</span></span> + <span class="hljs-string"><span class="hljs-string">'script&gt;'</span></span>); alert(jQuery.guid) &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt;</span></span></code> </pre><br>  This code will generate an error that the jQuery variable is not declared. <br>  On the other hand: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> document.write('</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"jquery.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="actionscript"><span class="xml"><span class="actionscript">&lt;/</span></span><span class="hljs-string"><span class="xml"><span class="actionscript"><span class="hljs-string">' + '</span></span></span></span><span class="xml"><span class="actionscript">script&gt;</span></span><span class="hljs-string"><span class="xml"><span class="actionscript"><span class="hljs-string">'); </span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> alert(jQuery.guid) </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  And this code will be executed without errors, because the second <code>&lt;script&gt;</code> tag will not be executed until the script loaded from the first tag is fully processed. <br><br>  Further it becomes more curious.  Imagine that there is such a code: <br><br><pre> <code class="javascript hljs">&lt;script&gt; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'a'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span class="hljs-string">'&lt;script src="printC.js"&gt;&lt;/'</span></span> + <span class="hljs-string"><span class="hljs-string">'script&gt;'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'b'</span></span>); <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script&gt; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'d'</span></span>); <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  And the <code>printC.js</code> file contains the following: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'c'</span></span>)</code> </pre><br>  This code will output the following to the console: <br><br><pre> <code class="javascript hljs">a b c d</code> </pre><br>  This example shows that all the code from the first <code>&lt;script&gt;</code> after <code>document.write</code> was executed right away, but the <i>second</i> tag started being executed only after <code>printC.js</code> completed its work. <br><br>  It should be remembered.  That this method of inserting content only works directly during the loading of the document.  What happens if you call <code>document.write</code> after it is already loaded?  It would be logical to give an error, or do nothing.  Instead, the entire existing page is erased, and the transferred string is displayed in its place: <br><br><pre> <code class="javascript hljs">setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span class="hljs-string">"Oops"</span></span>); })</code> </pre><br><h3>  Is there a normal reason to use <code>document.write</code> ? </h3><br>  I have not heard about this.  Apparently, it is used in banner rolls, because it allows you to show a tracking image instead of an AJAX request, if the user logs in to the site through Netscape 2. In the modern world, it is not needed for anything else. <br><br>  True, sometimes there are wonderful tools that imperceptibly wrap the HTML you pass into <code>document.write</code> calls. <br><br><h3>  Can I call <code>document.write</code> inside <code>document.write</code> ? </h3><br>  Aha <br><br><h3>  Like, infinitely many times? </h3><br>  No, 20 times. <br><br><h3>  Seriously?  Twenty? </h3><br>  <a href="">Yeah</a> . <br><br>  Google Chrome is undoubtedly a better browser - there you can as many as <a href="">21</a> times. <br><br><h3>  Did they think of this independently of each other? </h3><br>  The Firefox developers were the first to fix a bug that could potentially drop the browser, and the Webkit developers copied their solution.  Rumor has it that IE also has a certain limit, but it is even lower. <br><br><h3>  Is it possible to break the browser even faster? </h3><br><pre> <code class="javascript hljs">&lt;div id=<span class="hljs-string"><span class="hljs-string">"uniqid"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"JavaScript"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text/JavaScript"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="javascript"><span class="xml"><span class="javascript"> </span></span><span class="hljs-built_in"><span class="xml"><span class="javascript"><span class="hljs-built_in">document</span></span></span></span><span class="xml"><span class="javascript">.write(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"&gt;"</span></span></span></span><span class="xml"><span class="javascript">+</span></span><span class="hljs-built_in"><span class="xml"><span class="javascript"><span class="hljs-built_in">document</span></span></span></span><span class="xml"><span class="javascript">.getElementById(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">'uniqid'</span></span></span></span><span class="xml"><span class="javascript">).innerHTML+</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"&lt;"</span></span></span></span><span class="xml"><span class="javascript">); </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/div&gt;</span></span></code> </pre><br>  (Code taken from <a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D197052">ticket</a> ) <br><br><h3>  What other nonsense can you do with <code>document.write</code> ? </h3><br>  Yes, whatever! <br><br>  For example, you can make a <i>synchronous</i> AJAX request and paste its result directly into the body of the page: <br><br><pre> <code class="javascript hljs">x = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttpRequest() x.open(<span class="hljs-string"><span class="hljs-string">'GET'</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) x.send() <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(x.responseText);</code> </pre><br>  Sending the request will block the loading of the main page, and the contents of the response will be inserted as if it was originally located on the loaded page.  In this case, an empty string is passed instead of the URL, so the same page will load, and it, in turn, will start loading itself again, and so on to infinity *. <br><br>  <sub>* ‚ÄúEndlessly‚Äù means 20 times.</sub>  <sub>Or 21. Or even less if you are in IE.</sub> <br><br>  In general, you can have <a href="http://zack.is/%25E2%2588%259E/">fun in different ways</a> . <br><br><h3>  Anything else? </h3><br>  This is not in the current specification (although it was in previous versions), but you can pass several parameters to <code>document.write</code> , for example: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>);</code> </pre><br><h3>  If the method is useless, why am I reading about it at all? </h3><br>  This is a really good question! <br><br>  <i>Translator's Note:</i> <br><br>  Curiously, only the <i>first</i> call to <code>document.write</code> after loading the page, clears its contents.  Subsequent calls add text after the first. </div><p>Source: <a href="https://habr.com/ru/post/305366/">https://habr.com/ru/post/305366/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305352/index.html">6 "harmful" tips to the developer</a></li>
<li><a href="../305354/index.html">Guilloche</a></li>
<li><a href="../305356/index.html">The digest of interesting materials for the mobile # 161 developer (July 3-10)</a></li>
<li><a href="../305360/index.html">Reasonable AOP for IOC container fans</a></li>
<li><a href="../305364/index.html">Running cron inside the Docker container</a></li>
<li><a href="../305368/index.html">QNX 2 per virtual machine</a></li>
<li><a href="../305372/index.html">Ubuntu Unity desktop shell launched in Windows 10 environment</a></li>
<li><a href="../305374/index.html">UX design in the mobile application: a request to evaluate the application</a></li>
<li><a href="../305376/index.html">The digest of fresh materials from the world of the frontend for the last week No. 219 (July 4 - 10, 2016)</a></li>
<li><a href="../305378/index.html">We generate a beautiful Google spreadsheet from our program (using the Google Sheets API v4)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>