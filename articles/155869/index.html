<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Internet thermometer or telemetry of a country house</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I built a "country" house, because I do not live in it, I ran into the problem of determining the temperature. At the construction site lives mother-i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Internet thermometer or telemetry of a country house</h1><div class="post__text post__text-html js-mediator-article">  I built a "country" house, because I do not live in it, I ran into the problem of determining the temperature.  At the construction site lives mother-in-law.  Water in the heating system is recruited.  It was determined experimentally that at +8 in the house, the pipes on the walls behind the plasterboard begin to freeze, and at +18 the mother-in-law is sick.  So there was an idea to monitor the temperature remotely. <br><br>  After searching the Internet, 2 <a href="http://www.masterkit.ru/main/set.php%3Fcode_id%3D565375">devices</a> were purchased: domestic production <a href="http://www.masterkit.ru/main/set.php%3Fcode_id%3D565375">VM1707</a> and Chinese <a href="http://www.thermohid.co.uk/">termoHID</a> .  The software was attached to both.  Chinese art was nalapisto, but the functionality slightly surpassed ours, but up to 10 DS18B20 sensors can be connected to our device.  This argument was decisive. <br><br>  Now in the system 4 sensors, street, 1st floor, 2nd floor and attic.  Accumulated year of statistics.  The front looks like this: <br><img src="https://habrastorage.org/storage2/303/a31/456/303a31456e6bf52a56710b3c78f0a670.jpg"><br><a name="habracut"></a><br>  ATP <a href="http://habrahabr.ru/users/Dennsy/">Dennsy</a> thermometer in the openweathermap.org project, the station is <a href="http://openweathermap.org/station/46933">here</a> . <br>  ATP <a href="http://habrahabr.ru/users/SSar/">SSar</a> thermometer in the project narodmon.ru, the station <a href="http://narodmon.ru/%3Fid%3D424">here</a> . <br>  The native site tarasii.dyndns.org due to the limitations of windows xp falls upon 10 connections. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      BM1707 software can record measurement results in text files.  So, for a long time without thinking about ASP, a file-to-table converter was thrown.  It was not easy to read such tables, and most importantly it is difficult to notice the moment when the temperature is still not normal.  It was here that colleagues (ATP KOJISI) came to the rescue, and pushed on the right road.  <a href="http://www.highcharts.com/products/highstock">Javascript Highstock</a> came into view.  How it is used in Highstock <a href="http://habrahabr.ru/post/132941/">articles: monitoring the Runet Award</a> and <a href="http://habrahabr.ru/post/135039/">Dynamic graphics based on highstock</a> . <br><br>  After some vigilance, the tables on the ASP were combined with JS.  In fact, the graphics turned out to be the same as now, but they were built by files.  After two months of work, the files had to be abandoned.  File processing lasted an incredibly long time.  The decision was made with lightning speed - we read graphs from MySQL.  The BM1707 software allows you to periodically poll sensors and then execute bat files.  A VBScript was written which stores the measurement results in MySQL.  The script has a text date to date conversion in seconds since 1970, as well as a check for the existence of a record with such a time. <br><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> ForReading = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Const</span></span> TristateUseDefault = <span class="hljs-number"><span class="hljs-number">-2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> FSO <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> FSO = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"Scripting.FileSystemObject"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> FilePath FilePath = <span class="hljs-string"><span class="hljs-string">"C:\BM1707\bm1707.temp"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> cn = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"ADODB.Connection"</span></span>) cn.connectionstring = <span class="hljs-string"><span class="hljs-string">"Driver={MySQL ODBC 5.1 Driver};Server=localhost;DataBase=test; "</span></span> &amp;_ <span class="hljs-string"><span class="hljs-string">"USER=usr;PASSWORD=psw;"</span></span> cn.open <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> FSO.FileExists(FilePath) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> file <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> file = FSO.GetFile(FilePath) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> TextFileStream <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> TextFileStream = file.OpenAsTextStream(ForReading,TristateUseDefault) <span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> TextFileStream.AtEndOfStream <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> line line = TextFileStream.ReadLine curday = <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(Line,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) curmnth = <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(Line,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) curyear = <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(Line,<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>) curData = <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(Line,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>) curhour = <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(Line,<span class="hljs-number"><span class="hljs-number">13</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) curmin = <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(Line,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) cursec = <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(Line,<span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) curdt = curyear &amp; curmnth &amp; curday &amp; curhour &amp; curmin &amp; cursec curhour = <span class="hljs-built_in"><span class="hljs-built_in">Cint</span></span>(curhour) curmin = <span class="hljs-built_in"><span class="hljs-built_in">Cint</span></span>(curmin) cursec = <span class="hljs-built_in"><span class="hljs-built_in">Cint</span></span>(cursec) aspdate = <span class="hljs-built_in"><span class="hljs-built_in">CDate</span></span>(curData) javadt = ((((aspdate - <span class="hljs-number"><span class="hljs-number">25569</span></span>) * <span class="hljs-number"><span class="hljs-number">24</span></span> + curhour) * <span class="hljs-number"><span class="hljs-number">60</span></span> + curmin) * <span class="hljs-number"><span class="hljs-number">60</span></span> + cursec) * <span class="hljs-number"><span class="hljs-number">1000</span></span> sqlStr = <span class="hljs-string"><span class="hljs-string">"SELECT Count( * ) FROM temperatures WHERE javadatetime = "</span></span> &amp; javadt res = cn.<span class="hljs-keyword"><span class="hljs-keyword">execute</span></span>(sqlStr) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> res(<span class="hljs-number"><span class="hljs-number">0</span></span>)=<span class="hljs-string"><span class="hljs-string">"0"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> line = <span class="hljs-built_in"><span class="hljs-built_in">trim</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(Line,<span class="hljs-number"><span class="hljs-number">24</span></span>)) cnt = <span class="hljs-number"><span class="hljs-number">1</span></span> lst = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(line) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> str <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> lst nm = <span class="hljs-string"><span class="hljs-string">""</span></span> val = <span class="hljs-string"><span class="hljs-string">""</span></span> vals = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(str,<span class="hljs-string"><span class="hljs-string">"="</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> z <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> vals <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> nm = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> nm = z <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> val = <span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(z,<span class="hljs-string"><span class="hljs-string">","</span></span>,<span class="hljs-string"><span class="hljs-string">"."</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nm &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (val &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> cmdStr = <span class="hljs-string"><span class="hljs-string">"INSERT INTO temperatures"</span></span> &amp;_ <span class="hljs-string"><span class="hljs-string">"(measurementdatetime, thermometerid, value, javadatetime, thermometername)"</span></span> &amp;_ <span class="hljs-string"><span class="hljs-string">"VALUES ('"</span></span> &amp; curdt &amp; <span class="hljs-string"><span class="hljs-string">"','"</span></span> &amp; cnt &amp; <span class="hljs-string"><span class="hljs-string">"','"</span></span> &amp; val &amp; <span class="hljs-string"><span class="hljs-string">"','"</span></span> &amp; javadt &amp; <span class="hljs-string"><span class="hljs-string">"','"</span></span> &amp; nm &amp; <span class="hljs-string"><span class="hljs-string">"')"</span></span> cn.<span class="hljs-keyword"><span class="hljs-keyword">execute</span></span> cmdStr <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> cnt = cnt + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> TextFileStream.Close <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> TextFileStream = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> cn.close</code> </pre> <br>  Next is a PHP adapter that generates JSON for Highstock. <br><pre> <code class="php hljs">$rcn = mysql_connect(<span class="hljs-string"><span class="hljs-string">"localhost"</span></span>,<span class="hljs-string"><span class="hljs-string">"usr"</span></span>,<span class="hljs-string"><span class="hljs-string">"psw"</span></span>); mysql_select_db(<span class="hljs-string"><span class="hljs-string">"test"</span></span>); $termid = <span class="hljs-string"><span class="hljs-string">" and `thermometerid` = 2"</span></span>; $last = <span class="hljs-string"><span class="hljs-string">"order by `measurementdatetime`"</span></span>; $from = <span class="hljs-string"><span class="hljs-string">""</span></span>; $to = <span class="hljs-string"><span class="hljs-string">""</span></span>; $funk = <span class="hljs-string"><span class="hljs-string">"MIN"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET[<span class="hljs-string"><span class="hljs-string">'termid'</span></span>])) $termid=<span class="hljs-string"><span class="hljs-string">" and `thermometerid` = "</span></span>.$_GET[<span class="hljs-string"><span class="hljs-string">'termid'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET[<span class="hljs-string"><span class="hljs-string">'last'</span></span>])) $last=<span class="hljs-string"><span class="hljs-string">"order by `measurementdatetime` desc, 'termid' limit "</span></span>.$_GET[<span class="hljs-string"><span class="hljs-string">'last'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET[<span class="hljs-string"><span class="hljs-string">'from'</span></span>])) $from=<span class="hljs-string"><span class="hljs-string">" and `measurementdatetime` &gt;= "</span></span>.$_GET[<span class="hljs-string"><span class="hljs-string">'from'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET[<span class="hljs-string"><span class="hljs-string">'to'</span></span>])) $to=<span class="hljs-string"><span class="hljs-string">" and `measurementdatetime` &lt;= "</span></span>.$_GET[<span class="hljs-string"><span class="hljs-string">'to'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_GET[<span class="hljs-string"><span class="hljs-string">'funk'</span></span>])) $funk=<span class="hljs-string"><span class="hljs-string">""</span></span>.$_GET[<span class="hljs-string"><span class="hljs-string">'funk'</span></span>]; $sqlstr = <span class="hljs-string"><span class="hljs-string">"SELECT MIN(`javadatetime`) as javadatetime, ROUND("</span></span>.$funk.<span class="hljs-string"><span class="hljs-string">"(`value`),1) as value FROM `temperatures` WHERE 1 "</span></span>.$termid.<span class="hljs-string"><span class="hljs-string">" "</span></span>.$from.<span class="hljs-string"><span class="hljs-string">" "</span></span>.$to.<span class="hljs-string"><span class="hljs-string">" group by TO_DAYS(`measurementdatetime`) "</span></span>.$last; $res = mysql_query($sqlstr); $number = mysql_num_rows($res); printf(<span class="hljs-string"><span class="hljs-string">"["</span></span>); $first = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($number &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ($row=mysql_fetch_array($res)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($first) printf(<span class="hljs-string"><span class="hljs-string">","</span></span>); printf(<span class="hljs-string"><span class="hljs-string">"["</span></span>); printf($row[<span class="hljs-string"><span class="hljs-string">'javadatetime'</span></span>]); printf(<span class="hljs-string"><span class="hljs-string">", "</span></span>); printf($row[<span class="hljs-string"><span class="hljs-string">'value'</span></span>]); printf(<span class="hljs-string"><span class="hljs-string">"]"</span></span>); $first = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } printf(<span class="hljs-string"><span class="hljs-string">"]"</span></span>); mysql_close();</code> </pre><br>  Example of graphics output: <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cnt = <span class="hljs-number"><span class="hljs-number">0</span></span>, seriesOptions = [], names = [<span class="hljs-string"><span class="hljs-string">'MAX'</span></span>,<span class="hljs-string"><span class="hljs-string">'AVG'</span></span>, <span class="hljs-string"><span class="hljs-string">'MIN'</span></span>]; createAll(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createAll</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ cnt = <span class="hljs-number"><span class="hljs-number">0</span></span>; $.each(names, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i, name</span></span></span><span class="hljs-function">) </span></span>{ $.getJSON(<span class="hljs-string"><span class="hljs-string">'http://tarasii.dyndns.org/minmax.php?termid=2&amp;funk='</span></span>+name, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ seriesOptions[i] = {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: name, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: data, <span class="hljs-attr"><span class="hljs-attr">tooltip</span></span>: { <span class="hljs-attr"><span class="hljs-attr">yDecimals</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>}}; cnt++; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cnt == names.length) { createChart(); } }); }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createChart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.chart = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Highcharts.StockChart({ <span class="hljs-attr"><span class="hljs-attr">chart</span></span> : { <span class="hljs-attr"><span class="hljs-attr">renderTo</span></span> : <span class="hljs-string"><span class="hljs-string">'container'</span></span>}, <span class="hljs-attr"><span class="hljs-attr">title</span></span> : { <span class="hljs-attr"><span class="hljs-attr">text</span></span> : <span class="hljs-string"><span class="hljs-string">'Day Temperature Statistics'</span></span>}, <span class="hljs-attr"><span class="hljs-attr">xAxis</span></span> : { <span class="hljs-attr"><span class="hljs-attr">maxZoom</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span> * <span class="hljs-number"><span class="hljs-number">24</span></span> * <span class="hljs-number"><span class="hljs-number">3600000</span></span> <span class="hljs-comment"><span class="hljs-comment">// fourteen days}, series : seriesOptions }); }</span></span></code> </pre><br>  Recently, again, colleagues have pushed me to the jQuery gauge widget (ATP ASM).  It turned out analog thermometers and clocks <br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createGauge</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">inGauge</span></span></span><span class="hljs-function">) </span></span>{ inGauge.jqxLinearGauge({ <span class="hljs-attr"><span class="hljs-attr">orientation</span></span>: <span class="hljs-string"><span class="hljs-string">'vertical'</span></span>, <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-attr"><span class="hljs-attr">height</span></span>: <span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-attr"><span class="hljs-attr">ticksMajor</span></span>: { <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-string"><span class="hljs-string">'10%'</span></span>, <span class="hljs-attr"><span class="hljs-attr">interval</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span> }, <span class="hljs-attr"><span class="hljs-attr">ticksMinor</span></span>: { <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-string"><span class="hljs-string">'5%'</span></span>, <span class="hljs-attr"><span class="hljs-attr">interval</span></span>: <span class="hljs-number"><span class="hljs-number">2.5</span></span>, <span class="hljs-attr"><span class="hljs-attr">style</span></span>: { <span class="hljs-string"><span class="hljs-string">'stroke-width'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">stroke</span></span>: <span class="hljs-string"><span class="hljs-string">'#aaaaaa'</span></span>} }, <span class="hljs-attr"><span class="hljs-attr">max</span></span>: <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-attr"><span class="hljs-attr">min</span></span>: <span class="hljs-number"><span class="hljs-number">-40</span></span>, <span class="hljs-attr"><span class="hljs-attr">pointer</span></span>: { <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-string"><span class="hljs-string">'5%'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">colorScheme</span></span>: <span class="hljs-string"><span class="hljs-string">'scheme05'</span></span>, <span class="hljs-attr"><span class="hljs-attr">labels</span></span>: {<span class="hljs-attr"><span class="hljs-attr">position</span></span>: <span class="hljs-string"><span class="hljs-string">'far'</span></span>, <span class="hljs-attr"><span class="hljs-attr">interval</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-attr"><span class="hljs-attr">formatValue</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value, position</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value === <span class="hljs-number"><span class="hljs-number">-40</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'¬∞C'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value + <span class="hljs-string"><span class="hljs-string">'¬∞'</span></span>; } }, <span class="hljs-attr"><span class="hljs-attr">animationDuration</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> }); };</code> </pre><br>  Script that sends results to openweathermap <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Resume</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> cn = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"ADODB.Connection"</span></span>) cn.connectionstring = <span class="hljs-string"><span class="hljs-string">"Driver={MySQL ODBC 5.1 Driver};Server=localhost;DataBase=test; "</span></span> &amp;_ <span class="hljs-string"><span class="hljs-string">"USER=usr;PASSWORD=pwd;"</span></span> cn.open sqlStr = <span class="hljs-string"><span class="hljs-string">"SELECT t.value as vl, transactiondatetime,thermometername FROM temperatures t where thermometername='Outdor' order by transactiondatetime desc limit 1; "</span></span> res = cn.<span class="hljs-keyword"><span class="hljs-keyword">execute</span></span>(sqlStr) str = <span class="hljs-built_in"><span class="hljs-built_in">FormatNumber</span></span>(res(<span class="hljs-number"><span class="hljs-number">0</span></span>),<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">-1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) str = <span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(Str,<span class="hljs-string"><span class="hljs-string">","</span></span>,<span class="hljs-string"><span class="hljs-string">"."</span></span>) cn.close <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> cn = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> strURL = <span class="hljs-string"><span class="hljs-string">"http://openweathermap.org/data/post"</span></span> strDatatoSend =<span class="hljs-string"><span class="hljs-string">"user=usr&amp;password=pwd&amp;temp="</span></span>&amp;str&amp;<span class="hljs-string"><span class="hljs-string">"&amp;lat=50.5193&amp;long=30.5915&amp;alt=100"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> objHTTP <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objHTTP = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"Microsoft.XMLHTTP"</span></span>) <span class="hljs-comment"><span class="hljs-comment">'Create XML HTTP object for the Post method objHTTP.open "POST", strURL, False, "usr", "pwd" 'Opening the HTTP post method objHTTP.setRequestHeader "Content-Type", "application/x-www-form-urlencoded" objHTTP.send strDatatoSend 'Sending the request Set objHTTP = Nothing</span></span></code> </pre><br>  An example of a <a href="https://docs.google.com/open%3Fid%3D0B8EAsl0iGKAXX2x5TGtSREFINUk">gadget</a> for windows7 which shows the temperature from the openweathermap station <br>  The data is read by the jquery script. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateList</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $.getJSON(<span class="hljs-string"><span class="hljs-string">'http://openweathermap.org/data/2.1/weather/station/46933?type=json&amp;callback=?'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">json</span></span></span><span class="hljs-function">) </span></span>{ $.each(json, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i, head</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(i==<span class="hljs-string"><span class="hljs-string">"main"</span></span>){ curTmp = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.round((head.temp<span class="hljs-number"><span class="hljs-number">-273</span></span>)*<span class="hljs-number"><span class="hljs-number">10</span></span>)/<span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (curTmp&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>){ $(<span class="hljs-string"><span class="hljs-string">'#main'</span></span>).html(<span class="hljs-string"><span class="hljs-string">'&lt;p&gt;+'</span></span>+curTmp+<span class="hljs-string"><span class="hljs-string">'¬∞C&lt;/p&gt;'</span></span>); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ $(<span class="hljs-string"><span class="hljs-string">'#main'</span></span>).html(<span class="hljs-string"><span class="hljs-string">'&lt;p&gt;-'</span></span>+curTmp+<span class="hljs-string"><span class="hljs-string">'¬∞C&lt;/p&gt;'</span></span>); } } }); }); }</code> </pre><br><br><h5>  A little about the equipment. </h5><br>  The BM1707 controller is connected to DS18B20 sensors by a twisted pair, the sensors are connected in parallel.  Tire length about 10 meters. <br><br>  At first, the server was an EeePC900H netbook running WIN XP.  After some time, the server moved to the miniITX VIA C7-D 1800MHz in the old AT package. <br><img src="https://habrastorage.org/storage2/eb8/cf0/33c/eb8cf033cba4dc3f1c683981851712bf.jpg"><br><br>  By the cost of components including the "server" you can keep within $ 100 <br><br>  I hope this article complements the <a href="http://habrahabr.ru/post/145184/">Electronic thermometer with a web interface based on UniPing RS-485</a> </div><p>Source: <a href="https://habr.com/ru/post/155869/">https://habr.com/ru/post/155869/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../155853/index.html">Take advantage of the built-in PHP server</a></li>
<li><a href="../155857/index.html">Nokia introduced the Lumia 510 for $ 200</a></li>
<li><a href="../155859/index.html">Exercises for brain training</a></li>
<li><a href="../155865/index.html">Report from the Apple presentation on October 23</a></li>
<li><a href="../155867/index.html">Blog on node.js</a></li>
<li><a href="../155873/index.html">Removing Amazon DRM protection from e-books</a></li>
<li><a href="../155875/index.html">Basic CSS styles of various elements</a></li>
<li><a href="../155877/index.html">Strange global variables in VK.com, why?</a></li>
<li><a href="../155879/index.html">Asynchronous loading of pictures in TextView</a></li>
<li><a href="../155883/index.html">Network infrastructure of RTLS systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>