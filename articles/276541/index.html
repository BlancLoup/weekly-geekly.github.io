<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The report on the results of visits to ISC-2015</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On September 17, 2015, the regular annual Intel Software Conference took place in Moscow. The conference program included general presentations (openi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The report on the results of visits to ISC-2015</h1><div class="post__text post__text-html js-mediator-article">  On September 17, 2015, the regular annual <a href="https://istep-2015.mc-reg.ru/">Intel Software Conference</a> took place in Moscow.  The conference program included general presentations (opening remarks, a review of the company's technologies for developers, Intel customers' success stories) and two parallel sessions: the first was devoted to code optimization and parallel computing, the second concerned mobile development and media. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f35/fd1/e39/f35fd1e39dcab5e0a29a9179a190d328.png"></div><br>  As a result of attending the first session, I was most interested in a report on the topic ‚Äú <b>We vectorize code with Intel Advisor XE</b> ‚Äù.  In addition to demonstrating the capabilities of the code optimization tool, general questions of vectorization were considered, recommendations were given for writing vectorized code, and examples of constructions that impede automatic vectorization were analyzed, and advice was given to eliminate them.  But let's get everything in order. <br><a name="habracut"></a><br><h2>  <font color="#00204D">Prehistory</font> </h2><br>  This little story began with the fact that one of my colleagues somehow came up and said: ‚ÄúListen, and yet another Intel software conference will be held soon, why don't we visit it?‚Äù.  He was there several times before, always responded positively.  No sooner said than done, the registration is free, and we managed to agree on the management with the management (for which - special thanks) for attending this event in the middle of the working week. <br><br>  By the way, when I mentioned the upcoming campaign to the conference to my old friend (former classmate, classmate, and colleague in one person), he also, taking this opportunity, decided to ‚Äúbreak free‚Äù from the routine of working days, since the workload on the working front allowed it.  And although he contacted the organizers after the official registration on the site was closed, we must give them their due - no problems arose, the same day a positive response came. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  <font color="#00204D">Overall impression</font> </h2><br>  The conference made a double impression on me.  There were not so many visitors (it could be the fault of everyday life, people are busy at the main job), as it seemed to me, they were mostly representatives of the older generation (among the visitors we met one of the respected employees of our university, hello to you, Boris Mikhailovich !) <br><br>  The opening speech was held by Greg Anderson (Director, Worldwide Software Sales, Intel Software and Services Group, Portland, Oregon, USA), who spoke in his native language in general about the line of Intel development tools, their vision of the future optimization technologies and about some details, new features of their fresh produce.  It is always helpful to listen to a native speaker, and here the most inquisitive have the opportunity to ask their questions directly. <br><br>  The whole program of retelling does not make sense, it is available on the official <a href="https://istep-2015.mc-reg.ru/">conference website</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2a/93f/5b0/e2a93f5b06bd47f5dfff6a04300a6d40.jpg"><br><br><h2>  <font color="#00204D">"Briefly about the main thing"</font> </h2><br>  Discussing this event with my colleagues and friends, I found out that the topic of code vectorization is interesting enough for many, but few people remember the details well.  Following the results of attending the conference, a small report was written, which can be used as a brief educational program. <br>  Vectorization is a special case of parallel computing model SIMD (Single Instruction Multiple Data).  In essence, this means the execution of a single command that processes a certain amount of scalar data (as opposed to scalar operations on the SISD model, Single Instruction Single Data, which process one data element at a time).  Different processor architectures support different SIMD extensions and / or SIMD instructions. <br><br>  Such an approach allows for a significant gain in the speed of performing calculations of a certain type.  As the simplest classical example, often add the addition of two arrays of integers, which can be written as follows (hereinafter the definitions of variables are omitted): <br><br><pre><code class="hljs matlab"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>;<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>&lt;=MAX;<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>++)       c[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]=a[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]+b[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>];</code> </pre> <br>  Without vectorization (when considering one SSE2 register with a size of 128bit, which corresponds to four 32bit integers), a significant part of the register remains unoccupied (Figure 1). <br><br><div style="text-align:center;"><img src="https://lh3.googleusercontent.com/Eeo99DhwLfetFk3FQrGHgzq5N_iP534HqZ6ppIQKbMtgPtWkfTed4pDTTf3yQw1OgOsaJPV_3tIkK2yWW7aa_w5iJUnOUN1jeiq5-0ooYPjB4A37kW3TqKl2jUI-QeLqZdVTIUDS"></div><br>  <i><font color="#999999"><b>Figure 1.</b> Illustration of the process of adding two arrays (without vectorization)</font></i> <br><br>  With vectorization enabled, the compiler can use additional 32bit elements to perform four additions in a single operation (Figure 2). <br><br><div style="text-align:center;"><img src="https://lh4.googleusercontent.com/916ai5pEMa2M_uGaGLgGFJy0YWGOdGuvhm2Rpy_H0id85bnz9xY1DWqJjzTn9nt48LjzC0MIowcyRbbu3MPG9QVSXn-S0XqibsnbezCt3S3gEojCYKRnTAt3MrzcKfNs83useH8u"></div><br>  <i><font color="#999999"><b>Figure 2.</b> Illustration of vectorized addition of two arrays</font></i> <br><br>  In general, this can lead to a noticeable increase in performance.  However, specific results can vary greatly depending on the source code.  compiler, processor. <br><br>  Modern versions of popular compilers (for example, Microsoft Visual C ++ 14.0, GCC 5.3, Clang 3.7, ICC) support automatic vectorization to one degree or another.  For more detailed and up-to-date information, refer to the documentation of the specific version of the compiler. <br><br>  I would like to list the main conditions under which the cycles can be vectorized.  It is worth emphasizing that these are the most general recommendations (giving the opportunity to understand the key principles underlying vectorization), which will not necessarily work in a particular environment.  Each specific compiler may have additional restrictions and / or vice versa, ‚Äúbe able‚Äù to cope with some of the numbers listed below. <br><br><ol><li>  <i>The number of loop iterations must be known</i> by the time the loop starts to execute (i.e., the loop exit is not data dependent); <br><br></li><li>  <i>No data loopout points dependent.</i>  For example, in the following cycle this condition is not met: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;=<span class="hljs-type"><span class="hljs-type">MAX</span></span>;i++) { <span class="hljs-built_in"><span class="hljs-built_in">c</span></span>[i]=a[i]+b[i]; <span class="hljs-comment"><span class="hljs-comment">// data-dependent exit condition if (a[i] &lt; 0)   break; }</span></span></code> </pre> <br></li><li>  <i>Rectilinear code execution</i> (no logical branches).  Thus, the presence of the switch statement prevents code vectorization.  At the same time, the presence of the if statement is not so critical and often allows vectorization; <br><br></li><li>  <i>Usually, only the inner (most nested) loop is vectorized.</i>  The exceptions are external cycles that have been converted to internal through some or other optimization steps (for example, spin-up / collapse of the cycle); <br><br></li><li>  <i>No function calls.</i>  Exceptions, as a rule, are built-in mathematical functions (in the documentation of the compiler, you can see the tables of vectorized functions) and functions to be embedded. <br></li></ol><br>  There are also several circumstances that do not necessarily prevent vectorization, but may adversely affect this process.  Consider them: <br><br><ol><li>  <i>References to non-continuous memory areas.</i>  As an example, we can consider 4 adjacent integers that can be loaded into a register using one SSE instruction.  If these 4 numbers are not located in a contiguous room, a larger number of operations may be required to load them, which is definitely less efficient.  In such cases, vectorization is possible, but the compiler may consider it to be meaningless. <br><br>  The most common case of this may be non-sequential access cycles (for example, when the array index is incremented by values ‚Äã‚Äãother than 1) or by indirect addressing (the array index is taken from another array), Figure 3. <br><br><div style="text-align:center;"><img src="https://lh3.googleusercontent.com/OWsqrpTv9TnylnVZth2rMQ9vxabmHCH5STBH2J7iw0L6q5vIN42uM2FvsRHpifMk3sRfkDScs1XWbpHfg_PFfrZuosq2RFkvry6jjPUBI2dhv_42is3VXdXu3iBY13Ti0eHgCiLY"></div><br>  <i><font color="#999999"><b>Figure 3.</b> Memory access patterns (from top to bottom): continuous, with constant pitch ‚â† 1, with variable pitch</font></i> <br><br></li><li>  <i>Availability of "dependent data".</i>  Since each SIMD instruction processes several scalar values ‚Äã‚Äãat each moment of time, vectorization is possible if a change in the order of processing values ‚Äã‚Äãdoes not affect the result of the calculations. <br><br>  A simple example of ‚Äúindependent data‚Äù in calculations is when data that is accessed in a given iteration of a loop is not used in subsequent iterations.  In this case, each iteration is independent and can be performed in any order, without affecting the final result of the calculations. <br><br>  If, for example, a variable is written in one iteration of a loop, and is read in the next iteration, there is a read-after-write / flow dependency relationship. </li></ol><br>  Also to the general recommendations for writing vectorized code include the following: <br><br><ol><li>  <i>Use of aligned data structures</i> (for example, by powers of two).  A properly designed data structure allows you to perform operations on yourself most efficiently, both in terms of execution time and the amount of memory used; <br><br></li><li>  <i>Preference for array structures (Structures of Arrays, SoA) to arrays of structures (Array of Structures, AoS).</i>  The choice of data organization has a significant impact on the possibility of code vectorization.  If we compare the two structures: </li></ol><table><tbody><tr><td><pre> <code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">color</span></span></span><span class="hljs-class"> // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AoS</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> r, g, b;                      };</code> </pre> </td><td><pre> <code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">color</span></span></span><span class="hljs-class"> // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SoA</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> *r, *g, *b;                      };</code> </pre> </td></tr></tbody></table>  And how the data will be located in memory (Figure 4): <br><br><div style="text-align:center;"><img src="https://lh3.googleusercontent.com/a83WMUnVDcdcoHclaz27nmuKhuzm9jD0Z2ItjDqzS9EamFbWxSW3l5wUkllbPR4wYb7vjYcBeZ99x-gK3HW-Dudfmck9NLOuNSC029I3ewiUgqBv7DVWgIJO2z6rcoWv_bJIWIdN"></div><br>  <i><font color="#999999"><b>Figure 4.</b> Graphical representation of the location of data in memory.</font></i> <br><br>  it becomes obvious that the SoA option is a more ‚Äúfriendly‚Äù way of storing data for performing vectorization operations (since it provides good data locality, and therefore the possibility of efficient vectorization by performing operations on adjacent values). <br><br>  It should also be noted that the applicability of the described techniques may be limited, since the real benefits can only be gained by careful analysis of the generated code. <br><br><h2>  <font color="#00204D">Summing up</font> </h2><br>  In general, the impressions from attending the conference remained positive.  But it seems that from year to year the program changes only slightly, so I would summarize it as follows: if it is possible to visit it once, it is definitely necessary for those who are interested in Intel products / technologies. <br><br>  If I were a student, then whenever possible (and there are, on average, more of them during this period of life than, for example, with full-time employment), I would attend this conference to expand my horizons and form interesting acquaintances. <br><br>  The same can be recommended to people whose professional activities are closely connected with high-performance computing and / or deep code optimization - here you can meet like-minded people, listen to success stories and get answers to interesting questions, which is called ‚Äúfirst-hand‚Äù. <br><br>  Thanks to the organizers and speakers! <br><br><img src="https://lh3.googleusercontent.com/1pUMBYCbnBec6MMbQnsZnkeoFRArtf6GjnE1Bb8EDN9dLBB-lph3INehUX4eTrf-DtRnIyfZtSvjFvL1As-VBVt7ip4Erp9v_jh4mj6VomflP2o2y8pttORL1x4B35yJaRPTHp4H"><br><br>  <b>List of sources:</b> <br>  1. <a href="https://software.intel.com/sites/default/files/m/4/8/8/2/a/31848-CompilerAutovectorizationGuide.pdf">A Guide to Vectorization with Intel¬Æ C ++ Compilers</a> , Intel Corporation, 2010; <br>  2. <a href="http://www.agner.org/optimize/optimizing_cpp.pdf">Optimizing software in C ++</a> , A.Fog, Technical University of Denmark, 2015; <br>  3. <a href="https://istep-2015.mc-reg.ru/registration">‚ÄúVectorize code with Intel Advisor XE‚Äù</a> , K. Rogozhin, Intel Software Conference, 2015. </div><p>Source: <a href="https://habr.com/ru/post/276541/">https://habr.com/ru/post/276541/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276527/index.html">Notes of a true architect: just about the most important thing (Part 1)</a></li>
<li><a href="../276531/index.html">Unified test runner and analysis of test data</a></li>
<li><a href="../276533/index.html">Procedurally generated world maps on Unity C #, part 3</a></li>
<li><a href="../276535/index.html">How are the packages for checking the quality of random sequences?</a></li>
<li><a href="../276539/index.html">This is the future</a></li>
<li><a href="../276545/index.html">FBI: Hedge Fund Traders Share Insider Information in the Call of Duty Game Chat</a></li>
<li><a href="../276547/index.html">Install Azure Stack TP1</a></li>
<li><a href="../276549/index.html">Query Performance Insight: Who Eats Your Database Resources?</a></li>
<li><a href="../276551/index.html">Procedurally generated world maps on Unity C #, Part 4 (traffic)</a></li>
<li><a href="../276557/index.html">Methods of creating images on the example of Docker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>