<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Publishing 1C database on a third-party web server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is a windows-server c 1C 8.3 (DB - MSSQL). 
 The task is to set up database publishing on a Linux web server. 
 Subtleties - the 1C module for A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Publishing 1C database on a third-party web server</h1><div class="post__text post__text-html js-mediator-article">  There is a windows-server c 1C 8.3 (DB - MSSQL). <br>  The task is to set up database publishing on a Linux web server. <br>  Subtleties - the 1C module for Apache works only with 2.0 and 2.2, and the current version in most distributions is 2.4+ <br>  Writes more for yourself, not to forget.  Well, you never know, suddenly someone else will come in handy - you do not have to run around the forums in search of the right teams. <br><a name="habracut"></a><br>  Iron - gave gigabytes of RAM, one core and 20 gigabytes of disk.  Zoom is never too late. <br>  OS: Debian Stable, I'm used to it. <br><br>  I put a minimum, including an ssh-server, but not including web.  To this we will return. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/c13/ad0/a42/c13ad0a42041c0bbf9467c3f158d5050.jpg" alt="2016-01-08_091636" width="900" height="603"><br><br>  After installing the basic setting to taste, I usually set the utf8 locale, put sudo, mc and vim, the rest according to needs. <br>  Next you need to put apache 2.2.  And do it in the right way, and not just by downloading the deb package.  :) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First we add lines to /etc/apt/sources.list with a link to the previous version of the distribution. <br><pre> deb http://mirror.yandex.ru/debian/ wheezy main
 deb-src http://mirror.yandex.ru/debian/ wheezy main
</pre><br>  You can, of course, write <strong>oldstable</strong> - at the moment it will also be correct.  But only in the present, because sooner or later a new stable version will be released in <strong>oldstable</strong> and then instead of apache 2.2 there will be 2.4.  Although, I hope, by that time, 1C will be updated and will work with newer versions of Apache.  But who knows?  :) <br>  Where <strong>mirror.yandex.ru</strong> - there is written the name of your favorite server with a repository. <br><br>  Then we update the indexes - <em>apt-get update</em> - and see what we have here for apache with the command <em>apt-cache showpkg apache2</em> <br>  There a lot of things are displayed, but we are only interested in the beginning of the output: <br><pre> Package: apache2
 Versions:
 2.4.10-10 + deb8u3 (/var/lib/apt/lists/mirror.yandex.ru_debian_dists_stable_main_binary-i386_Packages)
 Description Language:
                  File: /var/lib/apt/lists/mirror.yandex.ru_debian_dists_stable_main_binary-i386_Packages
                   MD5: d02426bc360345e5acd45367716dc35c
 Description Language: en
                  File: /var/lib/apt/lists/mirror.yandex.ru_debian_dists_stable_main_i18n_Translation-en
                   MD5: d02426bc360345e5acd45367716dc35c
 Description Language: ru
                  File: /var/lib/apt/lists/mirror.yandex.ru_debian_dists_stable_main_i18n_Translation
                   MD5: d02426bc360345e5acd45367716dc35c

 2.4.10-10 + deb8u1 (/var/lib/apt/lists/security.debian.org_dists_stable_updates_main_binary-i386_Packages)
 Description Language:
                  File: /var/lib/apt/lists/mirror.yandex.ru_debian_dists_stable_main_binary-i386_Packages
                   MD5: d02426bc360345e5acd45367716dc35c
 Description Language: en
                  File: /var/lib/apt/lists/mirror.yandex.ru_debian_dists_stable_main_i18n_Translation-en
                   MD5: d02426bc360345e5acd45367716dc35c
 Description Language: ru
                  File: /var/lib/apt/lists/mirror.yandex.ru_debian_dists_stable_main_i18n_Translation
                   MD5: d02426bc360345e5acd45367716dc35c

 2.2.22-13 + deb7u6 (/var/lib/apt/lists/mirror.yandex.ru_debian_dists_wheezy_main_binary-i386_Packages)
 Description Language:
                  File: /var/lib/apt/lists/mirror.yandex.ru_debian_dists_wheezy_main_binary-i386_Packages
                   MD5: d24f049cd70ccfc178dd8974e4b1ed01
 Description Language: en
                  File: /var/lib/apt/lists/mirror.yandex.ru_debian_dists_wheezy_main_i18n_Translation-en
                   MD5: d24f049cd70ccfc178dd8974e4b1ed01
 Description Language: ru
                  File: /var/lib/apt/lists/mirror.yandex.ru_debian_dists_wheezy_main_i18n_Translation-
                   MD5: d24f049cd70ccfc178dd8974e4b1ed01
</pre><br><br>  We see that in addition to 2.4.10 there is version 2.2.22-13 + deb7u6 - what you need. <br>  Set: <strong>apt-get install apache2 = 2.2.22-13 + deb7u6</strong> <br>  Or, more precisely: <strong>install apache2 = 2.2.22-13 + deb7u6 apache2-mpm-worker = 2.2.22-13 + deb7u6 apache2.2-common = 2.2.22-13 + deb7u6 apache2.2-bin = 2.2 .22-13 + deb7u6</strong> , and the rest of the dependencies are already pulled up automatically. <br><br>  After that, we put the Apaches on hold, so as not to update by chance. <br><br><pre> apt-mark hold apache2 apache2-mpm-worker apache2.2-common apache2.2-bin
 apache2 is marked as committed.
 apache2-mpm-worker is marked as committed.
 apache2.2-common is marked as committed.
 apache2.2-bin is marked as committed.
</pre><br>  You can start the service apache2 start and hit telnet on port 80 to check if the browser is too lazy to start. <br><br>  <em>telnet localhost 80</em> <br><pre> Trying :: 1 ... Connected to localhost. 
 Escape character is '^]'. 
 one 
 &lt;! DOCTYPE HTML PUBLIC "- // IETF // DTD HTML 2.0 // EN"&gt;
 &lt;html&gt; &lt;head&gt; 
 &lt;title&gt; 501 Method Not Implemented &lt;/ title&gt; 
 &lt;/ head&gt; &lt;body&gt; 
 &lt;h1&gt; Method Not Implemented &lt;/ h1&gt; 
 &lt;p&gt; 1 to /index.html not supported. &lt;br /&gt; 
 &lt;/ p&gt; &lt;hr&gt; 
 &lt;address&gt; Apache / 2.2.22 (Debian) Server at 1cweb Port 80 &lt;/ address&gt; 
 &lt;/ body&gt; &lt;/ html&gt; 
 Connection closed by foreign host.
</pre><br><br>  Swears - it means it works. <br><br>  Now we put 1C. <br>  Only 1C web services are needed (package <strong>1c-enterprise83-ws</strong> ).  And <strong>1c-enterprise83-common</strong> , which is registered in dependencies.  And <strong>1c-enterprise83-server</strong> , which is not registered in dependencies, but without it, the publication utility writes ‚ÄúSegmentation Error‚Äù. <br>  In principle, only a module for the Apache <strong>wsap22.so</strong> from the <strong>1c-enterprise83-ws</strong> package is needed, and everything else can be done through a text editor.  But I‚Äôm a lazy person and better spend a few megabytes per 1C than I‚Äôll use my hands to drive lines into configs.  :) <br><br>  Next you need to create a folder to store the settings of published 1C databases.  It is possible in the web server tree, but I'd rather do it separately, right at the root, / 1c. <br>  After that, from the folder with installed 1C files ( <strong>/opt/1C/v8.3/i386</strong> ), launch the <strong>webinst</strong> publishing <strong>utility</strong> with the following parameters (publish our test database): <br><pre> ./webinst -apache22 -wsdir testlitupp -dir / 1c / testlitupp -connstr "Srvr = 10.0.0.4; Ref = testlitupp;"  -confPath /etc/apache2/apache2.conf
 Publish done
</pre><br><br>  -apache22 - our version of webserver <br>  -wsdir testlitupp - the folder on the web server where the published database will be available (http: // your server / testlitupp) <br>  -dir / 1c / testlitupp - folder in which the default.vrd file with the publication settings will be stored <br>  -connstr "Srvr = 10.0.0.4; Ref = testlitupp;" - ip of the 1C server and the name of the published database <br>  -confPath /etc/apache2/apache2.conf - path to apache config <br><br>  If it says ‚ÄúPublish completed,‚Äù then everything went well.  If you write "Segmentation Error", then you most likely forgot to install the <strong>1c-enterprise83-server</strong> . <br>  According to the results we have the file default.vrd <br><pre> &lt;? xml version = "1.0" encoding = "UTF-8"?&gt; 
 &lt;point xmlns = "http://v8.1c.ru/8.2/virtual-resource-system" 
 xmlns: xs = "http://www.w3.org/2001/XMLSchema" 
 xmlns: xsi = "http://www.w3.org/2001/XMLSchema-instance" 
 base = "/ testlitupp" ib = "Srvr = 10.0.0.4; Ref = testlitupp;" /&gt;
</pre><br>  And a few new lines in the web server configuration file: <br><br><pre> LoadModule _1cws_module "/opt/1C/v8.3/i386/wsap22.so"

 # 1c publication
 Alias ‚Äã‚Äã"/ testlitupp" "/ 1c / testlitupp /"
 &lt;Directory "/ 1c / testlitupp /"&gt; 
 AllowOverride All 
 Options none 
 Order allow, deny 
 Allow from all 
 SetHandler 1c-application 
 ManagedApplicationDescriptor "/1c/testlitupp/default.vrd" 
 &lt;/ Directory&gt;
</pre><br>  Restart the apache (service apache2 restart) and go to see what was published there. <br>  Published, asks for a password. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/e72/cf6/c01/e72cf6c01c13921e4362f84fd53d4e38.jpg" alt="2016-01-08_115425" width="900" height="616"><br><br>  And lets in the base. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/9de/3e9/2a7/9de3e92a732fb3c9ed7e1a45b0faee90.jpg" alt="2016-01-08_115604" width="900" height="616"><br><br>  Works.  Additional publishing settings are made by editing vrd-files (for example, turning on debugging), and your 1C programmers should do the finishing of the web client interface. <br>  If you will add options, for example, with connecting services manually, do not forget to delete the last slash in the default.vrd file in the line "base =" / testlitupp "ib =" Srvr = 10.0.0.4; Ref = testlitupp; "  <font color="red"><strong>/</strong></font> &gt;, I was busy with this for a long time.  If you do not delete and add something after, then "Error 500" crashes without additional information. <br>  What will be the load on the web server - I still do not know, we still have it working in test mode and there are enough allocated resources.  But to add memory or cores as the needs increase does not amount to problems. <br><br>  In general, in other linux distributions everything is done in the same way, the differences are only in the ways of installing the old version of apache. </div><p>Source: <a href="https://habr.com/ru/post/356340/">https://habr.com/ru/post/356340/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../356330/index.html">Linus Torvalds flew the fighter and felt that such a weightlessness</a></li>
<li><a href="../356332/index.html">Linux accounting and reporting</a></li>
<li><a href="../356334/index.html">2GIS for Linux everything and for a long time</a></li>
<li><a href="../356336/index.html">Links to download now available * Ubuntu 15.10 Wily Werewolf</a></li>
<li><a href="../356338/index.html">Linux Mint 17.3 ‚ÄúRosa‚Äù LTS released</a></li>
<li><a href="../356342/index.html">Problems of submitting reports in electronic form from 1C 8.3 in GNU / Linux</a></li>
<li><a href="../356344/index.html">Errors made by novice Linux users and how to avoid them</a></li>
<li><a href="../356346/index.html">Recommendations after installing Ubuntu 16.10</a></li>
<li><a href="../356348/index.html">Monitoring Avaya Aura distributed stations using Zabbix</a></li>
<li><a href="../356350/index.html">Linus Torvalds: ‚Äútinydrm looks like refined shit that has never been passed through the compiler‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>