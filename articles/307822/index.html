<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>I looked into the node_modules folder, and you won’t believe what happened</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The history of the left-pad jabbed the JavaScript community to the bone. While the swollen code continues to slow down our sites, plant our batteries ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>I looked into the node_modules folder, and you won’t believe what happened</h1><div class="post__text post__text-html js-mediator-article">  The history of the <a href="https://habrahabr.ru/post/280039/">left-pad</a> jabbed the JavaScript community to the bone.  While the swollen code continues to slow down our sites, plant our batteries and make our npm install slow, many developers have decided to conduct a thorough audit of the dependencies they bring to their projects.  The time has come for us, as a community, to stand up and say: “Enough!” This community belongs to all of us, not just a handful of JavaScript developers with gorgeous long hair. <br><br>  I decided to describe my experience in the audit of dependencies of my project and I hope that this information will be useful. <br><a name="habracut"></a><br><h3>  Ember </h3><br>  Ember is a JavaScript framework that specializes in quickly creating todo lists.  He has a good size of 112 kilobytes in compressed form.  But most people do not know how much of the 112 kilobytes is spent on anything. <br><br>  If we look at the dependencies of embra, we will see a library called glimmer.  The library itself weighs 95KB (or 85% of the embankment code), but its purpose is not immediately clear (it is not even mentioned on the embame site!). <br>  Well, looking at this addiction, I found something rather curious: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">├─┬ glimmer@1.1.5 │ ├─┬ brittanica@13.0.2 │ │ ├── brittanica<span class="hljs-_"><span class="hljs-_">-a</span></span>@0.0.1 │ │ ├── brittanica-b@0.1.2 │ │ ├── brittanica-c@0.0.3 │ │ ...</code> </pre> <br>  Brittanica, a 93kb module, must do all the hard work.  Brittanica itself consists of a set of dependencies: each module is called “brittanica” + suffix with the letter of the English alphabet (26 pieces). <br><br>  Looking further, I found that each module consists of a single terms.json file.  I opened it in Atom, then opened it in Sublime, after Atom was frozen.  The gibberish appeared on the screen: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"g"</span></span>: { <span class="hljs-string"><span class="hljs-string">"page"</span></span>: <span class="hljs-number"><span class="hljs-number">1018</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"The seventh letter of the US English..."</span></span> }, <span class="hljs-string"><span class="hljs-string">"ga"</span></span>: { <span class="hljs-string"><span class="hljs-string">"page"</span></span>: <span class="hljs-number"><span class="hljs-number">1021</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"a Kwa language of Ghana, spoken in Acc..."</span></span> }, ... <span class="hljs-string"><span class="hljs-string">"glimmer"</span></span>: { <span class="hljs-string"><span class="hljs-string">"page"</span></span>: <span class="hljs-number"><span class="hljs-number">1172</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"A faint or wavering light, used pri..."</span></span> }, ... }</code> </pre> <br>  17,648 lines in total, describing various words and phrases that begin with the letter G. Who on earth may need it?  Well, meet, this is glimmer / help.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">help</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> descriptino = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"brittanica-g"</span></span>).glimmer; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"glimmer (n). "</span></span> + descriptino); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"Copyright (c) 2016 Tilde Inc"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">""</span></span>); ... }</code> </pre><br>  In case the above code snippet is incomprehensible, let me summarize: <br><br>  <strong>1.</strong> Amber is proud of using the “glimmer” module: a small, fast rendering library. <br>  <strong>2.</strong> “Glimmer” pulls a part of the Brittanica encyclopedia, just to display the definition of the word glimmer in the “help” menu. <br>  <strong>3.</strong> Our oceans are drying out at an alarming rate, and we are all too busy playing Pokemon on our phones, instead of talking about it.  Just insane. <br><br><h3>  Babel </h3><br>  Babel is a compiler for the new version of JavaScript, which beat its competitors when someone on Facebook said they like Babel more. <br><br>  Although people love Babel, he received a fair share of criticism.  Many complain about its confusing plugin system, overly complex configuration files, and unclear error messages.  Curiously, not many people have noticed the incredible amount of addiction Babel requires. <br><br>  I began my investigation by installing the babel-preset-es2015 package.  This package allows over twenty web developers in the world to write on a new, worst-case version of JavaScript that no one in their team knows.  Then I calculated the number of dependencies introduced by this package, and then the total code size.  As many as 90 dependencies totaling 17 megabytes. <br><br>  If the whole history of mankind could fit in one megabyte, then one Babel will consist of at least seventeen chronicle histories of mankind.  But I really wondered what makes Babel so big? <br><br>  One of the biggest criminals - the package called “babel-core” was suspiciously large - 13 megabytes.  I opened the “babel-core” in VIM, then I rebooted the computer, because the Ctrl-C combination did not work, then I opened the “babel-core” in Sublime. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./lib/api/node.js"</span></span>);</code> </pre> <br>  After about 2 hours, I successfully found /lib/api/node.js and understood the essence of the issue. <br><br><img src="https://habrastorage.org/files/167/46b/e00/16746be008674ccbab5070124ea89284.png"><br>  <a href="">This is true</a> .  Every Babel installation includes a photo of Guy Fier, and you can't do anything about it. <br><br>  I have no idea how this error passed code verification.  In any case, it is there, and it takes up precious space on millions and millions of 15-inch Retina MacBook Pro hard drives around the world. <br><br><h3>  Express </h3><br>  Behind the fastest, non-greasy JavaScript web framework hides a bunch of dependencies, each with its own bunch of dependencies.  In fact, a simple “npm install express” leads to the installation of 291 modules. <br><br>  So, what is included in the list of these dependencies?  Many are self-evident: “range-parser” parses the http range, “escape-html” screens HTML, and “ <a href="https://en.wikipedia.org/wiki/The_Negotiator">negotiator</a> ” does other important things.  However, one addiction - “yummy” (“yummy”) - caught my attention. <br><br><pre> <code class="bash hljs">├── yummy │ ├── LICENSE │ ├── README.md │ ├── like-tweet.js │ ├── index.js │ └── package.json</code> </pre><br>  Interesting.  In addition to the usual index.js and package.json, we find the suspicious like-tweet.js.  I decided to take a closer look. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> http = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"http"</span></span>) http.request({ <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, <span class="hljs-attr"><span class="hljs-attr">hostname</span></span>: <span class="hljs-string"><span class="hljs-string">"api.twitter.com"</span></span>, <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">"/hotpockets/status/501511389320470528"</span></span>, })</code> </pre> <br>  Just a moment like-tweet.js, which runs every time your application loads the popular Express library, makes a post-request to the Twitter API.  What for?  I moved forward and downloaded this route myself. <br><br><img src="https://habrastorage.org/files/ab5/b60/0d4/ab5b600d40ba4e259d95eaa7eedca474.png"><br><br>  Of course, this is a tweet from Hot Pockets, and I have already added it to my favorites.  In fact, every time you load Express, you add this tweet from Hot Pockets to your favorites.  What monster made such a promotional deal?  I skip sensitive customer data through Express, and they sell "add to favorites" in Hot Pockets?  Of course, I will not use Express anymore. <br><br><h3>  findings </h3><br>  I want to be understood - I do not think that external dependencies are a sign of the end of the world.  I just think that it’s as important as possible that we as a community begin to take care of the cleanliness of the code, just as we take care of cool features and beautiful logos. <br><br>  We can work better.  Dead code takes up space, eats bandwidth and can even kill your startup. <br><br>  I urge you to look inside your / node_modules folder the next time you have a few free hours, and a computer with 16 gigabytes of RAM.  The results may just surprise you. </div><p>Source: <a href="https://habr.com/ru/post/307822/">https://habr.com/ru/post/307822/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307810/index.html">Interfaces and usability: who, why and how designs UX</a></li>
<li><a href="../307814/index.html">Simulation of dynamic systems (Lagrange method and Bond graph approach)</a></li>
<li><a href="../307816/index.html">Using Q_GADGET in C ++ & QtQuick</a></li>
<li><a href="../307818/index.html">As protection from Microsoft deleted the code on the servers. Bike about Defender</a></li>
<li><a href="../307820/index.html">How to learn to evaluate tasks if you are not able: 4 complexity factors</a></li>
<li><a href="../307824/index.html">CSS of our days</a></li>
<li><a href="../307826/index.html">20+ My favorite AngularJS helpers</a></li>
<li><a href="../307828/index.html">Discovered a new hacking mechanism for cloud virtual machines</a></li>
<li><a href="../307830/index.html">Tales of Ransomwhere: how often spam campaigns are used</a></li>
<li><a href="../307832/index.html">Nagios - monitoring system and some homemade plugins</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>