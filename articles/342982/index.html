<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Conan: dependency manager for C / C ++</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. Today we will talk about Conan - a modern dependency manager for C / C ++. If you are already actively working with him, you will hardly find a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Conan: dependency manager for C / C ++</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c72/839/ce8/c72839ce8cdd758a38439a6ff3cde7c3.png" alt="image"></div><br>  Hello.  Today we will talk about Conan - a modern dependency manager for C / C ++.  If you are already actively working with him, you will hardly find anything new for yourself.  Otherwise - I ask under the cat. <br><a name="habracut"></a><br><h2>  Why do I need a dependency manager </h2><br>  If you are a Linux-based user of the distributive or macOS, then most likely it‚Äôs not a problem for you to pull up some necessary dependency - the distributions most likely have the &lt;library_name&gt; -dev package you need.  But if you are a Windows user, I think you have often encountered a problem, how can you add a dependency to the project?  Well, if the third-party library header-only - just need to copy the header files in the right and start using.  But usually libraries need to be assembled (and as in C ++ zoo, it is often not so easy to do), then place the compiled library in the right place for you.  And only after that you can use it. <br><br>  Besides, let's not forget that we should compile libraries, preferably with one compiler, do not forget about ABI compatibility, etc.  And the compilation itself takes a lot of time (hi Boost).  Too much for ordinary mortals, is not it?  In the meantime, some people just use <a href="https://ru.wikipedia.org/wiki/Pip_(%25D0%25BC%25D0%25B5%25D0%25BD%25D0%25B5%25D0%25B4%25D0%25B6%25D0%25B5%25D1%2580_%25D0%25BF%25D0%25B0%25D0%25BA%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B2)">pip</a> , <a href="https://www.npmjs.com/">npm</a> , <a href="https://crates.io/">cargo</a> , <a href="https://maven.apache.org/">maven</a> , etc.  and save yourself a lot of nerves. <br><br><h2>  Previous attempts </h2><br>  I would like to have an analogue of npm, but for C ++.  That literally one team to pull up the dependence you need in the project and not know a headache. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There have already been attempts to create such a tool for C ++.  Maybe some of you remember such a thing as <a href="http://docs.biicode.com/">biicode</a> .  He, unfortunately, ordered to live long.  <a href="http://blog.biicode.com/biicode-just-the-company-post-mortem/index.html">Here</a> you can find out the cause of death of the patient.  An interesting fact: the creators of Conan and biicode are about the same people.  A reasonable question arises: will Conan not repeat the fate of biicode? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/904/3a3/12b/9043a312beacbb0300f4fd0923fd736d.jpg" alt="image"><br><br>  There are modern alternatives to Conan.  Of the most famous: <a href="https://github.com/Microsoft/vcpkg">vcpkg</a> , <a href="https://github.com/ruslo/hunter">hunter</a> , <a href="https://buckaroo.pm/">buckaroo</a> . <br><br><h2>  How to install? </h2><br>  First you need to install Conan itself.  There are many ways to do this: Your favorite package manager, pip, brew.  There are also binary builds for Ubuntu / Debian and Windows.  The authors themselves recommend using the installation via pip.  If you do not like these methods, then you can always build yourself from the <a href="https://github.com/conan-io/conan">source code</a> . <br><br><h2>  Special features </h2><br>  Conan tracks for you such things as: compiler, compiler version, operating system, OS width, build type (Release / Debug), standard library version.  Using these parameters, Conan tries to find the assembled version for your configuration.  If you‚Äôre lucky, there is an already compiled version in the repository and you don‚Äôt have to compile anything. <br><br>  If you are not lucky and under the combination of your OS / compiler /, etc.  No package was found, Conan will <b>automatically</b> download the source code of the required library and compile it on your working machine.  After that, you can safely use the library, as if it had already been collected by someone. <br><br><h2>  How to use </h2><br>  We have such a timer.cpp, which we must make compile and work: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Poco/Timer.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Poco/Thread.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Poco/Stopwatch.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; using Poco::Timer; using Poco::TimerCallback; using Poco::Thread; using Poco::Stopwatch; class TimerExample{ public: TimerExample(){ _sw.start();} void onTimer(Timer&amp; timer){ std::cout &lt;&lt; "Callback called after " &lt;&lt; _sw.elapsed()/1000 &lt;&lt; " milliseconds." &lt;&lt; std::endl; } private: Stopwatch _sw; }; int main(int argc, char** argv){ TimerExample example; Timer timer(250, 500); timer.start(TimerCallback&lt;TimerExample&gt;(example, &amp;TimerExample::onTimer)); Thread::sleep(5000); timer.stop(); return 0; }</span></span></span></span></code> </pre> <br>  Consider a standard example from the documentation.  We want to connect the <a href="https://pocoproject.org/">POCO</a> library to our project (suppose we use <a href="https://cmake.org/">CMake</a> ).  To do this, in the project folder create a file conanfile.txt with the following text: <br> <code>[requires] <br> Poco/1.8.0.1@pocoproject/stable <br> <br> [generators] <br> cmake</code> <br> <br>  Let's analyze what is what in this file.  In the Requires section, we describe the dependencies we need in the form Library Name / Library Version @ Name of Mailer / Package Stability.  The name of the maintainer is the person or organization who supports the package.  Stability is simply an indicator of how stable a package is.  Usually use stable, testing, ci.  I recommend using only stable packages. <br><br>  In the generators section, we specify what we want to integrate with.  In our case, we specify integration with CMake.  Conan for integration with CMake will automatically create a file conanbuildinfo.cmake, in which variables with paths to header files and already compiled libraries will be defined, which we will use in our CMakeLists.txt: <br><br><pre> <code class="hljs lisp">project(<span class="hljs-name"><span class="hljs-name">FoundationTimer</span></span>) cmake_minimum_required(<span class="hljs-name"><span class="hljs-name">VERSION</span></span> <span class="hljs-number"><span class="hljs-number">2.8</span></span>.<span class="hljs-number"><span class="hljs-number">12</span></span>) add_definitions(<span class="hljs-string"><span class="hljs-string">"-std=c++11"</span></span>) include(${CMAKE_BINARY_DIR}/conanbuildinfo.cmake) conan_basic_setup() add_executable(<span class="hljs-name"><span class="hljs-name">timer</span></span> timer.cpp) target_link_libraries(<span class="hljs-name"><span class="hljs-name">timer</span></span> ${CONAN_LIBS})</code> </pre> <br>  Pay attention to lines 5-6.  In line 5 we connect the previously generated conanbuildinfo.cmake, and in the 6th line we simply define a macro that makes Conan magically work :-) <br><br>  Now we are ready to build.  And before the standard CMake run, we have to ask Conan to install dependencies.  This is done by the following command: <br> <code>conan install /path/to/conanfile.txt</code> <br>  Usually the team will look just like <br> <code>conan install ..</code> <br> <br><img src="https://habrastorage.org/getpro/habr/post_images/695/83d/ff1/69583dff13627d738213877f5401f3ff.png" alt="image"><br>  <b>The most interesting thing happens here - how Conan tightens dependencies</b> <br><br>  Dependencies search order: <br><br><ul><li>  We check the local cache. </li><li>  We are looking for in the connected repositories we need the recipe.  I draw your attention that the search is conducted strictly in the order in which your repositories are connected.  If the package is in two repositories, then the first one will be found. </li><li>  If the recipe was found and there is an already assembled library for your configuration, then simply download the package from the repository and save it to the local cache.  It is worth noting that the package is automatically downloaded with all dependencies to it. </li><li>  If there is no assembled library for your configuration (or if there is no assembled library dependency for your configuration), Conan will report this and ask you to run it again with the - build flag to start building the package on your machine. </li></ul><br>  If you do not want to use someone else's library and do not trust other people's builds, you can always specify the - build flag so that the library and all its dependencies are forcibly reassembled on your machine. <br><br>  Congratulations, all dependencies are pulled up with the help of Conan (if lucky)! <br><br><h2>  Conan and build system integration </h2><br>  It is important not just to download the necessary version of the library, but also to connect it correctly to the project.  And it is desirable that this be done as easily as possible for the developer.  Therefore, Conan can integrate with such things as CMake, Visual Studio, Xcode, etc.  You can always find the full list <a href="http://conanio.readthedocs.io/en/latest/reference/generators.html">here</a> . <br><br>  <b>Conan as a way to manage your own dependencies</b> <br>  Conan is not only a client for installing dependencies from repositories already created by someone.  The authors of this dependency manager also kindly provided us with the program <a href="http://docs.conan.io/en/latest/uploading_packages/running_your_server.html">conan-server</a> , which allows literally in a couple of actions to raise their own server with ready-made libraries.  Very convenient for companies that want to build their own dependency management infrastructure. <br><br><h2>  Existing problems </h2><br>  The value of a package manager is determined by its usability and the number of packages.  If there are no special problems with the first one (Conan is really very convenient to use), then there are certain problems with the number of packages.  If you look at the main repositories, you will see two of them: <a href="https://bintray.com/conan/conan-center">conan-center</a> and <a href="https://bintray.com/conan/conan-transit">conan-transit</a> .  Agree, it is misleading - what to use?  Here you need to tell a little story. <br><br>  Initially, Conan had one repository into which any user had the right to ship packages.  Because of this, the Conan repository very quickly turned into one big trash bin.  The authors decided that this could not continue and decided to create a repository, in which the packages will get only after a thorough check.  So it appeared conan-center.  And the old, ‚Äúgarbage‚Äù repository decided not to delete, but simply to transfer it to read-only mode and renamed it to conan-transit. <br><br><h2>  Where packages for open-source libraries are stored </h2><br>  <a href="https://bintray.com/">JFrog Bintray is responsible for storing</a> all the packages.  Not so long ago, Conan moved to the Bintray infrastructure, so we had access to a more capacious package repository, as well as a <a href="https://ru.wikipedia.org/wiki/Content_Delivery_Network">CDN</a> .  One of the most interesting innovations after the move is that you can create your own <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D1%2582%25D0%25BA%25D1%2580%25D1%258B%25D1%2582%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BE%25D0%25B1%25D0%25B5%25D1%2581%25D0%25BF%25D0%25B5%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">OSS</a> repository absolutely free of charge.  If you want privacy, you can use the trial version for 30 days, and then have to pay. <br><br><h2>  Bincrafters </h2><br>  There are many libraries, and I would like to have ready-made packages for everyone.  The Conan team is now very small and is mainly engaged in the development of the package manager itself, so they have no time to package everything (although they are constantly looking for developers, including for packaging).  But you need to package the library, otherwise there is no point in Conan.  This is how the Bincrafters team appeared - a team of enthusiasts that actively packs the open-source library.  They have now opened a program at <a href="https://www.patreon.com/bincrafters">Patreon</a> to raise funds for the rental of additional <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B5%25D0%25BF%25D1%2580%25D0%25B5%25D1%2580%25D1%258B%25D0%25B2%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B5%25D0%25B3%25D1%2580%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">CI</a> facilities.  If you want to join the team - welcome. <br><br><h2>  What if the X library is not in Conan? </h2><br>  At this stage of development, this happens very often.  You can always leave a request to create a package <a href="https://github.com/conan-io/wishlist/">here</a> (before this, make sure that no one has asked you to do this before).  If the application already exists, just write in the comments that this library and you need it.  And, of course, you yourself can package the library, everyone will just say thanks. <br><br>  <b>The most useful commands (in my opinion)</b> <br><br><ul><li>  <code>conan search &lt;library_name_pattern&gt;</code> - search for a package in repositories by a given pattern </li><li>  <code>conan info</code> - view package information (license, creation date, package source code address, etc.) </li><li>  <code>conan remote</code> - manage Conan repositories (add, delete, etc.) </li></ul><br><h2>  Tips </h2><br><ul><li>  Use only stable packages.  The use of testing and ci packages is not recommended, as they can break regularly. </li><li>  If you decide to write your own recipes, an example of a good recipe can be found <a href="https://github.com/bincrafters/conan-templates">here</a> . </li><li>  When creating packages, it is highly recommended to have a customized CI for all target platforms.  The problem always pops up where you do not expect them :-) </li><li>  Do not forget to update Conan.  It may happen that Conan will simply break backward compatibility and the recipe that works with the new Conan will not work with the old one. </li><li>  Recommended package search order (at the moment): <a href="https://bintray.com/conan/conan-center">conan-center</a> , <a href="https://bintray.com/bincrafters/public-conan">public-conan</a> (repository of Bincrafters team), <a href="https://bintray.com/conan/conan-transit">conan-transit</a> , other repositories. </li></ul><br><h2>  Useful links: </h2><br><ul><li>  <a href="https://www.conan.io/">Conan</a> site </li><li>  <a href="https://bincrafters.github.io/">Bincrafters</a> </li><li>  Youtube materials: <a href="https://www.youtube.com/watch%3Fv%3DxvqH_ck-5Q8">one</a> , <a href="https://www.youtube.com/watch%3Fv%3DxA9yRX4Mdz0">two</a> , webinar ( <a href="https://www.youtube.com/watch%3Fv%3DqpOul18bXes">1</a> , <a href="https://www.youtube.com/watch%3Fv%3DJsijdbjVlXw">2</a> , <a href="https://www.youtube.com/watch%3Fv%3DExpkMy6DJ6o">3</a> ), <a href="https://www.youtube.com/watch%3Fv%3DW9DBJunyZyQ">three</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/342982/">https://habr.com/ru/post/342982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342968/index.html">Torskel - simplify the routine in Tornado</a></li>
<li><a href="../342970/index.html">Exonum 0.3 - what we have improved in the new version of the framework for the development of blockchains</a></li>
<li><a href="../342974/index.html">How to make your blockchain. Part 1 - Build, Store, Sync, Display, Mining, and Proof</a></li>
<li><a href="../342976/index.html">10 obvious steps to prepare the infrastructure of an online store for Black Friday</a></li>
<li><a href="../342978/index.html">From searching to examining documents in network balls and file dumps</a></li>
<li><a href="../342984/index.html">Node.js basis for async / await API out of the box</a></li>
<li><a href="../342986/index.html">OWASP Top 10 2017</a></li>
<li><a href="../342988/index.html">How I got 365K downloads on the App Store in two weeks (and why I left gamedev after that)</a></li>
<li><a href="../342990/index.html">Collective portrait of the participants of the contest MERC-2017</a></li>
<li><a href="../342992/index.html">TgGram - website creation service for / from telegram channels</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>