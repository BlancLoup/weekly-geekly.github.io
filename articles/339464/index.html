<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Photogrammetry research</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Friends, I want to share the experience that I acquired in the process of practical study of the discipline, like photogrammetry. I would be glad if a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Photogrammetry research</h1><div class="post__text post__text-html js-mediator-article">  Friends, I want to share the experience that I acquired in the process of practical study of the discipline, like photogrammetry.  I would be glad if any of you give your opinion, correct me or point out mistakes that you made.  Perhaps this article on the study of my photogrammetry will help and will be useful to you.  My work is described on the example of nature photography in a city park, in the central zone of Russia, in the period August-September 2017. <br><a name="habracut"></a><br>  So, let's start from the very beginning: after reading and reviewing a certain amount of information on this topic, I chose the Agisoft PhotoScan program, which helps to get 3d models that are textured based on the original images.  Having adopted the instruction from Agisoft PhotoScan - on proper photography, the rules of which must be followed in order to get the best result.  It is known that there are many programs on this subject: Photoscan (Agisoft), 123D Catch (Autodesk), ReCap360 (Autodesk), Arch3D (Epoch project), Bundler / PMVS2, Apero / MicMac, 3DF Zephyr (3DFlow), Photomodeller scanner (EOS systems), Smart3D (Acute3D). <br><br>  <b>The next stage of work includes the settings of the camera, camera, images and the preparation of the necessary equipment for shooting.</b> <br><br><ol><li>  Lens.  My experience and instruction advises giving preference to lenses with fixed focal length: 35mm, 50mm, 85mm.  When using lenses with a variable focal length, set the zoom to one of the extreme positions (minimum or maximum).  Otherwise, each zoom lens will require separate calibration.  I recommend minimizing the variability of camera / lens models and focal length values. </li><li>  Camera setup: It is preferable to use RAW format images converted to uncompressed TIFF format, since converting to JPG format makes images more noisy, reducing their quality.  I recommend shooting with the maximum possible resolution.  The ISO value is recommended to be reduced to the minimum to reduce noise.  To achieve a sufficient depth of field, I recommend reducing the aperture value, F-Stop 11+.  It is important that all parts of the subject are clear, not blurred.  The shutter speed should be high enough to prevent blurring caused by possible movements, preferably 1/125 +. </li><li>  Images: PhotoScan handles source images.  Do not deform photos, that is, do not scale, crop, rotate or otherwise modify the original images. </li><li>  What else can be useful to us: a tripod, a monopod, a remote control for a camera, a polarizing filter, you can still take a small hromakey (monochrome background) with a blue color better, suddenly we want to photograph small objects, and to separate them we need a background, so that later it is easy to make a mask for these photos. </li></ol><br><h2>  Stage shooting </h2><br>  After the necessary preparation and choosing an auspicious day, cloudy weather is best; it is the most favorable for photography, we need neutral lighting, because with further actions we will get a 3d model with a texture and set it in the right lighting, of course, you can also shoot an object in sunny weather - if you need, only a 3d model and in this case the texture can be corrected in Photoshop, but this is an additional manipulation, I will write more about this method. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We go to the forest park or to the place where the object we need is located.  So, having arrived at the scene, I tried to find more interesting objects with a pronounced texture.  Nature creates, in its beauty and form, such instances with a unique color, the pattern from which it is impossible to tear off a look, our task is to borrow all this magnificence and transfer it to our 3d world.  Let's start taking pictures. <br><br>  For the implementation of the photographing process, it is necessary, taking each subsequent frame, to provide an overlap between frames of approximately 60%, these 60% will form our model with a texture.  It is desirable maximum resolution, which can allow your camera, you need to bypass the object completely, i.e.  take a 360% round and take about 36 shots on 1 lap; there may be several shooting circles.  Again, in no case need to zoom in, if you need to fix some details, then you need to come closer, sit down or lie down to take the desired picture.  If the object has concavities and bumps, and the shooting is done only by standing and the object is not removed from below, then in some places that look ‚Äúnormal‚Äù to the ground and do not fall into the frame, in these areas there will be holes on the 3d model and therefore no texture , we will fix such moments further in the programs, but it is better to avoid this from the very beginning.  I have to replace another important point, strive to avoid sprigs and grass in the frame that are near the roots and at the base of the objects we need, because later on these objects will be printed on our texture and we will clean it, which in some cases is inevitable .  I found this interesting stump. <br><br><img src="https://habrastorage.org/webt/59/d2/9e/59d29e7577956934946655.jpeg"><br><br>  So, after making the necessary number of pictures of all the objects that we liked, the next stage began. <br><br><h2>  Photo processing and 3d model creation </h2><br>  Many people know that there are some programs for editing Raw formats, CameraRaw and Lightroom, I stopped at Lightroom. <br><br>  Next, import all our Raw images into Lightroom and make the following settings.  Highlights lower, and Shadows increase, remove chromatic aberration and lens distortion.  Based on the settings of one photo, we create a Preset to further speed up the processing of photos, there may be a different number from several tens to several thousand, depending on what your task is and how many objects you are shooting. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da2f2647055104517.jpeg"><br><br>  We create the Preset we apply to the remaining photos and export them to TIFF format in the appropriate folder for each object separately and the library of this category, it‚Äôs best to organize the workflow, from the very beginning, to avoid subsequent chaos and loss of the necessary files, Raw files are deleted. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da2f2572446865949.jpeg"><br><br><h2>  Add photos </h2><br>  Open Agisoft PhotoScan and add our photos.  For best results, you need to mask all minor objects in the original photos.  Create masks around the object, you can create masks in different ways in PhotoScan Lasso and then add a selection or in the Photoshop as the Lasso tool, but also create Actions to skip the routine process of creating a mask, adding it to the channel and saving the file.  If you were shooting in a studio and you had a uniform background, then you need to go to Tools / Import mask and apply the From Background method to the selected cameras.  You can even do without creating masks, but this will complicate the process. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da345dd1001105438.jpeg"><br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da359f2b627436892.jpeg"><br><br><h2>  Align photos </h2><br>  At this stage, PhotoScan determines the position of the cameras and builds a sparse cloud of points on the basis of photographs. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da3b2033400544394.jpeg"><br><br>  If we have masks, then put a tick "Consider the mask."  After this step, we can evaluate the quality of our photos and select all the cameras in the window that appears. <br><br>  We can filter our photos by quality, I have already done this and at the top are the worst photos, but this is not necessarily the way the quality of blurring is determined. <br><br>  The image quality estimation algorithm analyzes the contrast between pixels, when there is a lot of contrast, then the image is perceived as good.  The only way to make sure all your images are normal is to visually check them at 200% zoom.  Awfully boring job.  The worst images, those that are very blurred, can be turned off. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da3c7e2d951036148.jpeg"><br><br>  The next step is to select our object with the Selection tool and click Crop and so clean our object.  The Space key helps us to switch between tools, for example, selection and navigation. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da3f3353375652681.jpeg"><br><br><h2>  Define a build area </h2><br>  Correcting Box, this will not help NumPad, it allows you to switch between cameras, perspective and orthogonal projection. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da40ee8f024593980.jpeg"><br><br><h2>  Building a dense point cloud </h2><br>  Based on the calculated positions of the cameras, the program builds a dense cloud of points.  Quality: Ultra-high (the higher the desired quality, the more time and computing resources will be required to complete the stage). <br><br>  Aggressive (if the reconstructed scene has a complex geometry with numerous fine details or non-textured surfaces, such as the roofs of buildings, it is recommended to set the Soft parameter value). <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da437582806746220.jpeg"><br><br>  That's what we did. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da45ff64020790002.jpeg"><br><br>  After a little cleaning of the object with the selection tools, we get this result. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da47b927739104594.jpeg"><br><br><h2>  Building a polygonal model </h2><br>  Now, based on the obtained dense point cloud, you can build a three-dimensional polygonal model. <br><blockquote>  Surface type: elevation map. <br>  Baseline: A dense cloud. <br>  Number of polygons: High (in brackets next to the parameter value <br>  The maximum number of polygons in the model to be constructed is specified. <br>  The values ‚Äã‚Äãsuggested by the program are calculated based on the data. <br>  about the number of points in a dense cloud). <br>  Interpolation: Enabled (default). </blockquote>  Here is our result 3d models <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da4aadd1842351451.jpeg"><br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da4b43fc242706812.jpeg"><br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da4e13d8804990349.jpeg"><br><br><h2>  Editing the resulting geometry </h2><br>  Select Edit and click Gradual Selection to highlight in red all the individual pieces of geometry that we need to remove. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da4eafaf192106831.jpeg"><br><br>  After that we need to close all the holes in our object, for this we select Tools, Mesh, Close Holes. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da52caeb658135562.jpeg"><br><br><h2>  Export Model </h2><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da53b8e2703757327.jpeg"><br><br>  Now we export our model to Zbrush for further editing. <br><br><h2>  Create a low poly model </h2><br>  Import the model into Zbrush and duplicate, <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da5b3bf6432269193.jpeg"><br><br>  use the Zremesher command and export to Maya. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da5b67ae315205332.jpeg"><br><br>  Import the model into Maya, perform the Extrude operation and export it back to Zbrush. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da5de04f458613139.jpeg"><br><br>  In Zbrush, we use the operation DynaMesh and Zremesher, <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da611aad257178594.jpeg"><br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da611510978797204.jpeg"><br><br>  export to Maya and delete unnecessary polygons.  Of course, you can still adjust the low-poly grid with pens and cut even polygons, but now I will not do this.  If you have a desire, you can try and write about the result, I will attach all the files to the article. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da64d47f281146349.jpeg"><br><br>  We export to UVLayout and create a UV scan. <br><br><h2>  Create a color texture </h2><br>  We import the low-poly with the finished UV scan into Zbrush and execute the ProjectAll, dist.  you need to raise and lower each time so that there are no artifacts, right here in the Zbrush bake Displacement map.  We export obtained after Project High-poly. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da64a0e1818833160.jpeg"><br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da67cf58173396835.jpeg"><br><br>  Open PhotoScan and delete the model in its place through the Tools menu, import the resulting High-poly model. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da6870c0567268584.jpeg"><br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da6b69b3847948770.jpeg"><br><br>  After importing the model, create a texture in Tif format and export it. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da6ba16e147343029.jpeg"><br><br>  Open the texture in Photoshop and the Magic wand Tool, click on the area where there is no texture and a black spot at this point. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da6e6e19490310870.jpeg"><br><br>  Select the Lasso tool and in the Edit menu select the Fill command, a fill based on the content (Content-Aware Fill). <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da703770046149068.jpeg"><br><br>  That's what we got, just a few seconds and the texture is ready. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da7402e0805320039.jpeg"><br><br>  Of course, you can go in other ways, for example, Stamp and handles to fill all spaces.  It is also possible with the help of other programs, for example, 3D - Coat, to import High-poly and color textures in the Stamp tool and paint the right places on the texture, the same manipulations can be repeated in the Substance Painter, it is also possible in the Zbrush tool DraqRect, but it's all long and possible in some situation, and this is exactly what will need to be taken in one of these ways. <br><br><h2>  Baking and texture making </h2><br>  1. Run the Substance Painter, create a new project, load the low-poly with the finished UV scan, after creating the project, go to the TextureSet Settings menu and click Bake textures.  In the baking window, we remove the cards we don‚Äôt need, load High-poly from PhotoScan.  Baked cards will be automatically inserted into the appropriate slots in the TextureSet settings. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da746900909830623.jpeg"><br><br>  2. The next step is to replace our low-poly model with High-poly.  in order to generate additional textures such as specular, roughness, etc., we can clearly view the texture we need. <br><br><img src="https://habrastorage.org/webt/59/d2/9d/59d29da779673170346621.jpeg"><br><br>  3. We generate the maps we need, because texturing through channels is a very exciting experience, along with various filters and very flexible generators, which will help us greatly in this and will speed up the entire workflow of obtaining the necessary textures.  For example, create a fill layer (Add fill layers), fill it with the desired color or texture, turn off all unnecessary channels, connect a black or white mask to the fill layer, generators, filters, in general, you can handle. <br><br>  4. After obtaining the desired result, we can create Smart materials in order not to repeat the same actions in the future, because we strive to facilitate and speed up the workflow, since time is a resource that cannot be returned or bought. <br><br>  5. When we are completely satisfied with the result, we can export all the textures we need into various renders / engines for further visualization.  In the Export document there is a Config which will help us choose the settings for exporting textures for further use. <br><br>  That's what we had and this is what we quickly and effortlessly received. <br><br><img src="https://habrastorage.org/webt/59/d2/9f/59d29fd2d861d473316610.jpeg"><br><br>  And so to summarize, such discipline as Photogrammetry is very interesting, necessary and can help speed up the workflow, in creating objects around (trees, plants, stones, etc.), interior items (microphone, music speaker, chair, etc.) etc.), organic (human, turtle, etc.), landscape and buildings, etc.  The use of photogrammetry is very wide! <br><br>  Well, that, friends process is complete.  Open to your questions in a personal and communication in the experience of work. <br><br>  Best wishes, Evgeny A. <br><br>  <a href="https://cloud.mail.ru/public/Gz51/kpA9hzybr">Materials</a> </div><p>Source: <a href="https://habr.com/ru/post/339464/">https://habr.com/ru/post/339464/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339450/index.html">Parse BGP NOTIFICATION by RFC</a></li>
<li><a href="../339454/index.html">How the brain hits a tree, or how we made a recommendation system using a neural network.</a></li>
<li><a href="../339456/index.html">ZFS and KVM. @home</a></li>
<li><a href="../339458/index.html">Uneducated youth: an attempt to summarize and some personal</a></li>
<li><a href="../339460/index.html">When did Phoenix kill Reils?</a></li>
<li><a href="../339468/index.html">Google Chrome distribution knows who downloaded it</a></li>
<li><a href="../339470/index.html">Root worse Mikhalkov</a></li>
<li><a href="../339472/index.html">Large list of telegram channels for designers, product managers and analysts</a></li>
<li><a href="../339474/index.html">Testing in Openshift: Openstack Integration</a></li>
<li><a href="../339476/index.html">Let them in passwords</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>