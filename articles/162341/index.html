<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Features of working with time in different time zones</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Due to the fact that several issues have accumulated and decisions on working with time, I decided to make a small review. 


 Work with different typ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Features of working with time in different time zones</h1><div class="post__text post__text-html js-mediator-article">  Due to the fact that several issues have accumulated and decisions on working with time, I decided to make a small review. <br><img src="https://habrastorage.org/storage2/3e1/de8/a87/3e1de8a872d4ef555528ac8473beb176.jpg"><br><a name="habracut"></a><br><h4>  Work with different types of data in databases </h4><br><h5>  MYSQL </h5><br>  In mysql there are several standard data types for representing time, we will look at <code>TIMESTAMP</code> and <code>DATETIME</code> . <br>  The <a href="http://dev.mysql.com/doc/refman/5.6/en/time-zone-support.html">documentation</a> states that a conversion policy is applied to some data types, but not to some. <br>  In practice, everything is much more interesting.  Consider a few examples: <br>  Create a table: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> xxxDate(ts <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, dt DATETIME <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>);</code> </pre> <br>  Let's set the current zone for Moscow (in Moscow, recently there is no daylight saving time, and UTC + 4): <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">time_zone</span></span>=<span class="hljs-string"><span class="hljs-string">'Europe/Moscow'</span></span>;</code> </pre> <br>  Create two entries with summer and winter time, respectively: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> xxxDate <span class="hljs-keyword"><span class="hljs-keyword">values</span></span>(<span class="hljs-string"><span class="hljs-string">'2012-06-10 15:08:05'</span></span>, <span class="hljs-string"><span class="hljs-string">'2012-06-10 15:08:05'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> xxxDate <span class="hljs-keyword"><span class="hljs-keyword">values</span></span>(<span class="hljs-string"><span class="hljs-string">'2012-12-10 15:08:05'</span></span>, <span class="hljs-string"><span class="hljs-string">'2012-12-10 15:08:05'</span></span>);</code> </pre> <br>  Let's see what sample of these dates from the database shows: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> xxxDate; +<span class="hljs-comment"><span class="hljs-comment">---------------------+---------------------+ | ts | dt | +---------------------+---------------------+ | 2012-06-10 15:08:05 | 2012-06-10 15:08:05 | | 2012-12-10 15:08:05 | 2012-12-10 15:08:05 | +---------------------+---------------------+ select UNIX_TIMESTAMP(ts), UNIX_TIMESTAMP(dt) from xxxDate; +--------------------+--------------------+ | UNIX_TIMESTAMP(ts) | UNIX_TIMESTAMP(dt) | +--------------------+--------------------+ | 1339326485 | 1339326485 | | 1355137685 | 1355137685 | +--------------------+--------------------+</span></span></code> </pre> <br>  We see that in both columns the values ‚Äã‚Äãare the same, this is because the <a href="http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html"><code>UNIX_TIMESTAMP</code></a> function considers the value of the argument in the current zone and converts it to UTC.  It is obvious that the same values ‚Äã‚Äãwill be converted equally into the same value <code>Mon, 10 Dec 2012 11:08:05 UTC</code> . <br>  Now we are moving to London! <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">time_zone</span></span>=<span class="hljs-string"><span class="hljs-string">'Europe/London'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> xxxDate; +<span class="hljs-comment"><span class="hljs-comment">---------------------+---------------------+ | ts | dt | +---------------------+---------------------+ | 2012-06-10 12:08:05 | 2012-06-10 15:08:05 | | 2012-12-10 11:08:05 | 2012-12-10 15:08:05 | +---------------------+---------------------+</span></span></code> </pre> <br>  There is nothing surprising, according to the <a href="http://dev.mysql.com/doc/refman/5.6/en/datetime.html">documentation</a> , <code>TIMESTAMP</code> , before being inserted into the database is converted to UTC, so after we changed the current zone, the database gives us the value of this time in the current zone.  <code>DATETIME</code> values ‚Äã‚Äãhave not changed. <br>  Now let's take a closer look at the work of the algorithm for Moscow.  Values ‚Äã‚Äãfor ts when converted were converted to UTC, and when sampled, they were converted to values ‚Äã‚Äãaccording to the current zone (as for London) 15 hours, and when UNIX_TIMESTAMP was selected, they were simply displayed as they were stored in the database. <br>  Now the expected result for London: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNIX_TIMESTAMP</span></span>(ts), <span class="hljs-keyword"><span class="hljs-keyword">UNIX_TIMESTAMP</span></span>(dt) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> xxxDate; +<span class="hljs-comment"><span class="hljs-comment">--------------------+--------------------+ | UNIX_TIMESTAMP(ts) | UNIX_TIMESTAMP(dt) | +--------------------+--------------------+ | 1339326485 | 1339337285 | // 14h (dt) | 1355137685 | 1355152085 | // 15h (dt) +--------------------+--------------------+</span></span></code> </pre> <br>  The ts values ‚Äã‚Äãhave not changed, and the dt values ‚Äã‚Äãare considered as values ‚Äã‚Äãin the current zone, therefore daylight saving time (first record) is <code>1339337285 = Sun, 10 Jun 2012 14:08:05 GMT</code> , and winter time (lower record) is <code>1355152085 = Mon, 10 Dec 2012 15:08:05 GMT</code> . <br>  Just in case, check the behavior for UTC. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">time_zone</span></span>=<span class="hljs-string"><span class="hljs-string">'UTC'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> xxxDate; +<span class="hljs-comment"><span class="hljs-comment">---------------------+---------------------+ | ts | dt | +---------------------+---------------------+ | 2012-06-10 11:08:05 | 2012-06-10 15:08:05 | | 2012-12-10 11:08:05 | 2012-12-10 15:08:05 | +---------------------+---------------------+ select UNIX_TIMESTAMP(ts), UNIX_TIMESTAMP(dt) from xxxDate; +--------------------+--------------------+ | UNIX_TIMESTAMP(ts) | UNIX_TIMESTAMP(dt) | +--------------------+--------------------+ | 1339326485 | 1339340885 | // 15h (dt) | 1355137685 | 1355152085 | // 15h (dt) +--------------------+--------------------+</span></span></code> </pre><br>  Everything is as previously described, ts values ‚Äã‚Äãhave not changed, dt values ‚Äã‚Äãare considered in the current zone, therefore they do not change <code>1339340885 = Sun, 10 Jun 2012 15:08:05 GMT; 1355152085 = Mon, 10 Dec 2012 15:08:05 GMT</code> ( <code>1339340885 = Sun, 10 Jun 2012 15:08:05 GMT; 1355152085 = Mon, 10 Dec 2012 15:08:05 GMT</code> ) . <br>  Conclusion: <br><ul><li>  When working with <code>DATETIME</code> and moving the server (incorrect setting of the time zone during insertion or import of data) with loss of information about the time of changing the server / connection time zone, you will lose information about the actual time of events.  For example, we created records at 15 o'clock Moscow time (we imported data into the database from a backup), then we set up our server on UTC and did not notice that before this the time zone was Moscow.  As a result, instead of 11 o'clock UTC, both of our orders are now made 4 hours later - at 15 o'clock, and could be on another day.  Therefore, in my opinion it is necessary to work with <code>TIMESTAMP</code> . </li><li>  Also, to avoid unnecessary problems when debugging on the server, it is better to have a UTC zone, and work with data in UTC, and on the client side, display in the zone in which the client wants. </li><li>  It is also a good example at the end <a href="http://habrahabr.ru/post/69983/">of the</a> <a href="https://habrahabr.ru/users/feedbee/" class="user_link">feedbee</a> <a href="http://habrahabr.ru/post/69983/">article</a> . </li><li>  To avoid problems with leap second, it is also worth working with unix epochs in UTC (see the section on Leap second). </li></ul><br><br><h5>  SQLite3 </h5><br>  Consider the situation with sqlite3.  According to the <a href="http://www.sqlite.org/datatype3.html">documentation</a> in sqlite there is no data type to save time, but there are <a href="http://www.sqlite.org/lang_datefunc.html">functions</a> for working with time, saved as text, a floating point number and as an integer.  In general, these views are fundamentally no different.  We can assume that the current time zone is not used in sqlite if you do not use the localtime and utc modifiers.  For example, regardless of the system settings, <code>CURRENT_TIMESTAMP</code> has a value in UTC. <br><pre> <code class="sql hljs">$ date Mon Dec 10 22:05:50 MSK 2012 $ sqlite3 sqlite&gt; <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT_TIMESTAMP</span></span>; 2012-12-10 18:06:05 sqlite&gt; <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> datetime(<span class="hljs-keyword"><span class="hljs-keyword">CURRENT_TIMESTAMP</span></span>, <span class="hljs-string"><span class="hljs-string">'localtime'</span></span>); 2012-12-10 22:06:35</code> </pre><br>  Therefore, convert your data in utc in your program and use unix epochs in order not to look for errors when parsing lines. <br>  Debugging features: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> strftime(<span class="hljs-string"><span class="hljs-string">'%s'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CURRENT_TIMESTAMP</span></span>); 1355162582 <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> datetime(<span class="hljs-number"><span class="hljs-number">1355152085</span></span>, <span class="hljs-string"><span class="hljs-string">'unixepoch'</span></span>); 2012-12-10 15:08:05</code> </pre><br><h4>  How user sees time </h4><br>  If you work with the datetime type and do not convert it, users will get confused in time.  For example, if two users live in different time zones, then, seeing the same time line without specifying a zone, they will think about different times.  In order not to repeat, here is a <a href="http://habrahabr.ru/post/69983/">link</a> with an example. <br><br><h4>  C-functions to work with time </h4><br>  First, it is very useful to get acquainted with the description of work with time in <a href="http://www.delorie.com/gnu/docs/glibc/libc_toc.html">glibc</a> .  We will consider several examples concerning the results of the work of several functions in different time zones.  It turns out that even the documentation states that the struct tm (hereinafter the broken-down time) is usually used <b>only</b> for displaying to users (because of clarity), i.e.  in your program it is better to use other more suitable data types. <br>  Consider a few examples: <br><pre> <code class="hljs rust">Function: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tm</span></span></span></span> * localtime_r(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> time_t *time, <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tm</span></span></span></span> *resultp)</code> </pre> <br>  Converts simple time to broken-down time, expressed relative to the user zone. <br><pre> <code class="hljs cpp"> <span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span> t = <span class="hljs-number"><span class="hljs-number">1339326485</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 2012-06-10 11:08:05 (UTC) struct tm bdt; localtime_r (&amp;t, &amp;bdt); cout &lt;&lt; bdt.tm_hour &lt;&lt; endl; cout &lt;&lt; bdt.tm_isdst &lt;&lt; endl; cout &lt;&lt; bdt.tm_zone &lt;&lt; endl;</span></span></code> </pre> <br><table><tbody><tr><th>  zone in the system </th><th>  UTC </th><th>  Europe / Moscow </th><th>  Europe / London </th></tr><tr><td>  output hour </td><td>  eleven </td><td>  15 </td><td>  12 </td></tr><tr><td>  isdst output </td><td>  0 </td><td>  0 </td><td>  one </td></tr><tr><td>  zone output </td><td>  UTC </td><td>  MSK </td><td>  Bst </td></tr></tbody></table><br><pre> <code class="hljs cpp"> <span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span> t = <span class="hljs-number"><span class="hljs-number">1355137685</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 2012-12-10 11:08:05 (UTC)</span></span></code> </pre> <br><table><tbody><tr><th>  zone in the system </th><th>  UTC </th><th>  Europe / Moscow </th><th>  Europe / London </th></tr><tr><td>  output hour </td><td>  eleven </td><td>  15 </td><td>  eleven </td></tr><tr><td>  isdst output </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><td>  zone output </td><td>  UTC </td><td>  MSK </td><td>  GMT </td></tr></tbody></table><br><pre> <code class="hljs rust">Function: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tm</span></span></span></span> * gmtime_r(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> time_t *time, <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tm</span></span></span></span> *resultp)</code> </pre> <br>  Returns the value for a UTC zone regardless of the user zone. <br><pre> <code class="hljs cpp"> <span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span> t = <span class="hljs-number"><span class="hljs-number">1339326485</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 2012-06-10 11:08:05 (UTC) struct tm bdt; gmtime_r (&amp;t, &amp;bdt); cout &lt;&lt; bdt.tm_hour &lt;&lt; endl; cout &lt;&lt; bdt.tm_isdst &lt;&lt; endl; cout &lt;&lt; bdt.tm_zone &lt;&lt; endl;</span></span></code> </pre> <br><table><tbody><tr><th>  zone in the system </th><th>  UTC </th><th>  Europe / Moscow </th><th>  Europe / London </th></tr><tr><td>  output hour </td><td>  eleven </td><td>  eleven </td><td>  eleven </td></tr><tr><td>  isdst output </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><td>  zone output </td><td>  GMT </td><td>  GMT </td><td>  GMT </td></tr></tbody></table><br><pre> <code class="hljs cpp"> <span class="hljs-keyword"><span class="hljs-keyword">time_t</span></span> t = <span class="hljs-number"><span class="hljs-number">1355137685</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 2012-12-10 11:08:05 (UTC)</span></span></code> </pre> <br><table><tbody><tr><th>  zone in the system </th><th>  UTC </th><th>  Europe / Moscow </th><th>  Europe / London </th></tr><tr><td>  output hour </td><td>  eleven </td><td>  eleven </td><td>  eleven </td></tr><tr><td>  isdst output </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><td>  zone output </td><td>  GMT </td><td>  GMT </td><td>  GMT </td></tr></tbody></table><br><pre> <code class="hljs php"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Function</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_t</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mktime</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(struct tm *brokentime)</span></span></span></span></code> </pre> <br>  (synonymous with <b>timelocal</b> , but rarely) <br>  Converts broken-down time to simple time. <br>  Note: <b>sets the current zone for the argument.</b> <br>  The tm_zone field is not considered an argument, it is considered that the time is set in the current time zone and the time is returned in UTC. <br><pre> <code class="hljs ruby"> struct tm bdt; bdt.tm_sec = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">05</span></span> sec bdt.tm_min = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> 08 min bdt.tm_hour = <span class="hljs-number"><span class="hljs-number">11</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> h bdt.tm_mday = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> bdt.tm_mon = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>th mon - Jun bdt.tm_year = <span class="hljs-number"><span class="hljs-number">112</span></span>;<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> <span class="hljs-number"><span class="hljs-number">2012</span></span> - <span class="hljs-number"><span class="hljs-number">1900</span></span> bdt.tm_wday = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ignored bdt.tm_yday = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ignored bdt.tm_isdst= <span class="hljs-number"><span class="hljs-number">0</span></span>; bdt.tm_gmtoff= <span class="hljs-number"><span class="hljs-number">0</span></span>; bdt.tm_zone = <span class="hljs-string"><span class="hljs-string">"UTC"</span></span>; time_t t = mktime(&amp;bdt); cout &lt;&lt; t &lt;&lt; endl; cout &lt;&lt; bdt.tm_hour &lt;&lt; endl; cout &lt;&lt; bdt.tm_isdst &lt;&lt; endl; cout &lt;&lt; bdt.tm_gmtoff &lt;&lt; endl; cout &lt;&lt; bdt.tm_zone &lt;&lt; endl;</code> </pre> <br><table><tbody><tr><th>  zone in the system </th><th>  UTC </th><th>  Europe / Moscow </th><th>  Europe / London </th></tr><tr><td>  t output </td><td>  1339326485 (Sun, 10 Jun 2012 11:08:05 GMT) </td><td>  1339312085 (Sun, 10 Jun 2012 07:08:05 GMT) </td><td>  1339326485 (Sun, 10 Jun 2012 11:08:05 GMT) </td></tr><tr><td>  output hour </td><td>  eleven </td><td>  eleven </td><td>  12 </td></tr><tr><td>  isdst output </td><td>  0 </td><td>  0 </td><td>  one </td></tr><tr><td>  gmtoff output </td><td>  0 </td><td>  14,400 (4 * 60 * 60) </td><td>  3600 (1 * 60 * 60) </td></tr><tr><td>  zone output </td><td>  UTC </td><td>  MSK </td><td>  Bst </td></tr></tbody></table><br>  Note that the tm_hour and tm_isdst fields have changed for London, this is part of the normalization of the structure fields of the broken-down time. <br>  now for <br><pre> <code class="hljs objectivec">bdt.tm_mon = <span class="hljs-number"><span class="hljs-number">11</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 11th mon - Dec</span></span></code> </pre> <br><table><tbody><tr><th>  zone in the system </th><th>  UTC </th><th>  Europe / Moscow </th><th>  Europe / London </th></tr><tr><td>  t output </td><td>  1355137685 (Mon, 10 Dec 2012 11:08:05 GMT) </td><td>  1355123285 (Mon, 10 Dec 2012 07:08:05 GMT) </td><td>  1355137685 (Mon, 10 Dec 2012 11:08:05 GMT) </td></tr><tr><td>  output hour </td><td>  eleven </td><td>  eleven </td><td>  eleven </td></tr><tr><td>  isdst output </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><td>  gmtoff output </td><td>  0 </td><td>  14,400 (4 * 60 * 60) </td><td>  0 </td></tr><tr><td>  zone output </td><td>  UTC </td><td>  MSK </td><td>  GMT </td></tr></tbody></table><br><pre> <code class="hljs php"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">Function</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_t</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">timegm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(struct tm *brokentime)</span></span></span></span></code> </pre> <br>  Works in UTC. <br><table><tbody><tr><th>  zone in the system </th><th>  UTC </th><th>  Europe / Moscow </th><th>  Europe / London </th></tr><tr><td>  t output </td><td>  1339326485 (Sun, 10 Jun 2012 11:08:05 GMT) </td><td>  1339326485 (Sun, 10 Jun 2012 11:08:05 GMT) </td><td>  1339326485 (Sun, 10 Jun 2012 11:08:05 GMT) </td></tr><tr><td>  output hour </td><td>  eleven </td><td>  eleven </td><td>  eleven </td></tr><tr><td>  isdst output </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><td>  gmtoff output </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><td>  zone output </td><td>  GMT </td><td>  GMT </td><td>  GMT </td></tr></tbody></table>  now for <br><pre> <code class="hljs objectivec">bdt.tm_mon = <span class="hljs-number"><span class="hljs-number">11</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 11th mon - Dec</span></span></code> </pre> <br><table><tbody><tr><th>  zone in the system </th><th>  UTC </th><th>  Europe / Moscow </th><th>  Europe / London </th></tr><tr><td>  t output </td><td>  1355137685 (Mon, 10 Dec 2012 11:08:05 GMT) </td><td>  1355137685 (Mon, 10 Dec 2012 11:08:05 GMT) </td><td>  1355137685 (Mon, 10 Dec 2012 11:08:05 GMT) </td></tr><tr><td>  output hour </td><td>  eleven </td><td>  eleven </td><td>  eleven </td></tr><tr><td>  isdst output </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><td>  gmtoff output </td><td>  0 </td><td>  0 </td><td>  0 </td></tr><tr><td>  zone output </td><td>  GMT </td><td>  GMT </td><td>  GMT </td></tr></tbody></table><br>  Conclusion: <br>  If you want to display the time to the user in your program on the user's computer, then use the <code>timelocal/localtime</code> functions, if you are working on the server, then use the <code>timegm/gmtime</code> .  Also, install a UTC zone on the server, in case any of your colleagues or a third-party library uses * local * functions.  Even on the user's computer store and work over time in UTC, so if he changes his zone, all dates will remain correct. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Note </h4><br><h5>  Setting time zones in linux </h5><br>  Consider only deb-based distributions and a couple of iron methods for setting up a time zone. <br><ul><li>  Method one (works on deb-based distributions): <br>  Run the command in the terminal and follow the instructions (‚ÄúUTC‚Äù is in the ‚ÄúEtc‚Äù section): <br>  sudo dpkg-reconfigure tzdata </li><li>  Method two (works, probably everywhere): <br>  Run the following command in the terminal: <br><pre> <code class="bash hljs">sudo ln -sf /usr/share/zoneinfo/UTC /etc/localtime</code> </pre> <br>  and just in case edit <code>/etc/timezone</code> (if there is one) </li><li>  Method three: <br>  Set the TZ environment variable to the desired zone, for example: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> TZ=Europe/London</code> </pre> </li></ul><br><h5>  LEAP SECOND </h5><br>  In general, this is a separate topic, so in this article there are no examples relating to leap second.  You can check for yourself how certain functions work, as well as how different databases behave, <a href="http://dev.mysql.com/doc/refman/5.6/en/time-zone-leap-seconds.html">here are examples of mysql</a> . <br><ul><li>  UTC includes <a href="http://en.wikipedia.org/wiki/Leap_seconds">leap second</a> </li><li>  Very important <a href="http://www.delorie.com/gnu/docs/glibc/libc_433.html">note</a> : <br>  POSIX requires that time_t counted from 00:00:00 on January 1, 1970, UTC does not include leap seconds, but sometimes includes in practice.  Also, depending on the leap second support, the difftime function works differently.  Be careful. </li><li>  Julian day also does not include leap second. </li><li>  In mysql you will not see leap second, i.e.  instead of 60 or 61 seconds (s) there will always be 59 ( <a href="http://dev.mysql.com/doc/refman/5.6/en/time-zone-leap-seconds.html">link</a> ).  But at the same time, everything is supported and works correctly if you are dealing with unix epochs in UTC. </li><li>  General recommendation for sqlite: store the date as an integer (integer), which already includes leap seconds (as in mysql).  Then you will always know the exact time. </li></ul><br><h5>  And further </h5><br><ul><li>  If the time_zone (mysql) variable is set to SYSTEM, then the system zone is selected as the current zone (which was configured in the system at the time the server was started). </li><li>  <a href="http://www.onlineconversion.com/unix_time.htm">http://www.onlineconversion.com/unix_time.htm</a> website for converting unix time to regular time. </li><li>  GMT - can be considered as an obsolete concept, so the article mainly uses UTC. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/162341/">https://habr.com/ru/post/162341/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../162329/index.html">Connecting and working with MySQL in VB.NET</a></li>
<li><a href="../162333/index.html">AR Drone - quadcopter intercepting communication of other quadcopters</a></li>
<li><a href="../162335/index.html">iTunes In-App Purchases from server side</a></li>
<li><a href="../162337/index.html">Trend Watching: 10 major trends in 2013. Part 2</a></li>
<li><a href="../162339/index.html">zsh and bash: what to choose</a></li>
<li><a href="../162343/index.html">Runetology (177): Levon Oganesyan, Founder of the Delivery Club</a></li>
<li><a href="../162345/index.html">AWS Insight: Reservations for EC2 - how it works</a></li>
<li><a href="../162347/index.html">Saving files from the Internet to Google Drive</a></li>
<li><a href="../162351/index.html">Broadcast Final Selection Skolkovo MD</a></li>
<li><a href="../162353/index.html">Using async and await in C # best practices</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>