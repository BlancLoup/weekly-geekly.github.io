<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Until the thunder clap ...</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is possible that someone has already got into an unpleasant situation - when for some reason a RAID controller fails, or simply the array ‚Äúcrumbles...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Until the thunder clap ...</h1><div class="post__text post__text-html js-mediator-article">  It is possible that someone has already got into an unpleasant situation - when for some reason a RAID controller fails, or simply the array ‚Äúcrumbles‚Äù.  Especially often this happens with cheap controllers built into the motherboard.  I'll tell you a small but instructive story that happened to me at the dawn of my admin's career. <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/81/e7/81e734a56aad87b8d7454bb4a92f69bc.jpg" alt="image"></div><br><a name="habracut"></a><br><br>  So, one day everything happened that could only appear in a nightmare. <br>  One fine morning, our tester approaches me and asks: ‚ÄúWhat happened to TFS?‚Äù  TFS is a Team Foundation Server, a kind of web application tied to MS Visual Studio, used by programmers to track bugs, and maybe for something else, at least for me this TFS was a ‚Äúblack box‚Äù. <br>  The server on which this application was launched was a normal system unit, with an external SATA RAID controller Adaptec 2410S.  On three SATA-disks with a capacity of 149GB, a RAID5 array was created, on which everything was installed.  Batteries from the controller, of course it was not.  Yes, now tomatoes will fly into me, but alas - the server was raised before me, they did not give me money for the brand (apparently) money, and even then I didn‚Äôt particularly think about it.  And in vain. <br>  So, I, not knowing anything bad, ping the server on which TFS was installed.  Not pinged.  Swearing to myself, I went to the server to check the cables - everything seems to be in order, the server is on, the ‚ÄúLink‚Äù diode on the network card is on.  I go to the server with KVM'a - and here it is: "Non-system disk or disk error".  With the help of the Holy Trinity (Ctrl-Alt-Del), I restart the server.  POST passes, the RAID controller is initialized and suddenly ... ‚ÄúArray # 0 has missing required members.  Found 0 arrays. "Now I'm starting to swear out loud.  I press Ctrl-A, I go into the controller BIOS. <br>  I look - and the status of the array - FAILED.  Two of the three discs are shown in gray. <br>  ‚ÄúSo what are you, white northern chanterelle!‚Äù - I thought.  Began to think what actually happened.  The controller seems to work.  Disks too, as if visible.  I start checking both ‚Äúproblematic‚Äù disks with the utility in the controller BIOS.  Verification succeeds, ‚Äú0 errors found‚Äù.  Reboot - again, the array was not found. <br>  Having written a letter of resignation in advance, I unwind the server case, put it next to my computer, connect hard drives (well, they were SATA and I connected them directly to the motherboard) and boot. <br>  The screws seem to be defined.  Now we need to somehow pull out the data from them, namely the MS SQL Server 2005 database in which the TFS data was stored.  The biggest problem was that it was necessary in some way to recreate the structure of the RAID-array, while not losing data. <br>  Wandering on the Internet, I came across a prog Runtime RAID Reconstructor (www.runtime.org). <br>  In the description it was said that it can automatically determine the structure of the array.  I download, run. <br>  The program window looks like this: <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/23/fe/23fedf470ceacc5d1dbb04ea3e3a186f.png" alt="image"></div><br>  In the left part of the window, I chose my disks.  By the way, this program allows you to create complete disk images and then connect them instead of "live" disks - it can be useful when the disk starts to "crumble" and can fail at any minute. <br>  Then I clicked ‚ÄúOpen Drives‚Äù and ‚ÄúAnalyze‚Äù to analyze the structure of the array. <br>  In the analysis wizard, by the way, there is no block size of 512Kb (which seems to have been used by me), but you can add a Custom Size, which I actually did.  I left the number of sectors for analysis by default (10,000). <br>  The analysis was successful, the structure of the array was determined. <br>  After that, she created the Virtual Image File - a small (less than 1Kb) file with the * .vim extension, which describes the structure of the array. <br>  The same program then offers to open the file with various utilities from Runtime - Captain Nemo, GetDataBack, Disk Explorer.  I needed, apparently, Captain Nemo: the task was to remove data from disks.  I shake.  I bet. <br>  I open my vim to her - and, oh, a miracle!  - I saw a full tree of folders!  I found the necessary database files, saved them through Captain Nemo to my screw and connected it on a freshly installed TFS, and it all worked!  You can say, "carried."  The statement of dismissal went to the shredder. <br>  Now - let's summarize. <br>  As a server, the usual systemic was used. <br>  The system together with the database lay on the same 3-disk RAID5 array, on the same partition. <br>  The array was built on 3 SATA screws, using an Adaptec 2410SA controller. <br>  The reasons for the failure could not be established.  According to my suspicions, the cause was a power failure.  The RAID controller is not equipped with a BBU (backup battery) and, apparently, a power failure occurred during writing to the disk, resulting in some loss of information about the structure of the array, and the controller began to consider 2 hard drives as failed. <br>  The moral of this story is: You can‚Äôt completely trust RAID!  Especially - made on cheap hardware.  RAID will never replace backup to separate media. <br>  I hope this opus will help someone who falls into this situation.  But even more, I hope that it will help not to fall into it.  As you know, admins are divided into those who do not backup, and those who already do.  If at least one of those who have read this article goes into the second, bypassing the first, I will assume that my goal has been fulfilled.  On this optimistic note, I will probably finish. </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/100744/">https://habr.com/ru/post/100744/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../100738/index.html">ChartBeat - Listen to the pulse of your site</a></li>
<li><a href="../100739/index.html">Necessary things</a></li>
<li><a href="../100741/index.html">How to stop thinking about time zones and start living</a></li>
<li><a href="../100742/index.html">Handgam do it yourself</a></li>
<li><a href="../100743/index.html">Henry Kuttner - Classic Humorous Fiction</a></li>
<li><a href="../100749/index.html">Automate testing of Windows applications using .Net</a></li>
<li><a href="../100750/index.html">We send SMS.ru with convenience</a></li>
<li><a href="../100751/index.html">Help for victims of fires</a></li>
<li><a href="../100754/index.html">Sales: ‚Äúanother feature - and sales will go‚Äù</a></li>
<li><a href="../100756/index.html">Hacker created a $ 1,500 cell phone listening device</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>