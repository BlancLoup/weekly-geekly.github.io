<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Interception PPPoE session</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The video shows a practical way to hijack a PPPoE session using a cable tie. In this case, no login or password is intercepted and the type of authori...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Interception PPPoE session</h1><div class="post__text post__text-html js-mediator-article"><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/31007374&amp;xid=17259,15700021,15700043,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhiMQEbjKr18ZzUYh4PleLxMKrq7VQ" width="560" height="315" frameborder="0" title="PPPoE Session hijacking / Interception session pppoe" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe><br><br>  The video shows a practical way to hijack a PPPoE session using a cable tie.  In this case, no login or password is intercepted and the type of authorization used (CHAP / PAP) does not matter. <br><br>  Most ethernet providers, unfortunately, do not use encryption of the entire session, limited only by encryption of the authorization step.  This allows you to introduce yourself as a legitimate client, intercepting the details of an existing connection. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h1>  Theory </h1><br><br>  <b>PPPoE</b> (Point-to-Point Protocol over Ethernet) is a data link layer protocol, one level below ip, so no IP address is required to establish a connection, addressing occurs over MAC. <br><br>  Conventionally, the connection process looks like this: <br><br>  A client searching for a pppoe server sends a broadcast request <br>  The destination MAC address FF: FF: FF: FF: FF: FF. <br>  The server responds to the client and authorizes (for example, CHAP Challenge) <br><br><img src="https://habrastorage.org/storage1/9fe7c682/1d3fe8ed/66211e54/e3fa4bd1.png"><br><br>  In the established connection, the server identifies the client by its MAC address and Session ID.  IP packets are encapsulated inside PPPoE frames.  In an unencrypted connection, the entire contents of the packets can be viewed: <br><br><img src="https://habrastorage.org/storage1/b945f8e1/a641020f/79710226/13a1517b.png"><br><br>  Accordingly, having learned the connection details, you can intercept the session: <br><br><img src="https://habrastorage.org/storage1/fe9a0db1/f5d248c6/fb9a657c/7f7fba2c.png"><br><br>  To protect against such attacks, there is the CHAP Rechallenge option when the server re-identifies the client at a given time interval.  None of the tested providers used this option. <br><br>  The video uses a virtual machine running in bridge mode with an ethernet card of the host system. <br>  During cable switching it is important to get between the LCP-echo packages. <br>  PPPoE server <a href="http://www.roaringpenguin.com/products/pppoe">www.roaringpenguin.com/products/pppoe</a> recompiled with the option <br> <code>#define DEFAULT_MAX_SESSIONS 64000</code> <br> <br>  Thanks to <a href="https://habrahabr.ru/users/kekekeks/" class="user_link">kekekeks</a> for help in picking the source of the rp-pppoe server. </div><p>Source: <a href="https://habr.com/ru/post/130710/">https://habr.com/ru/post/130710/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../130701/index.html">Motorola introduced the DROID RAZR</a></li>
<li><a href="../130702/index.html">Customization of social buttons</a></li>
<li><a href="../130703/index.html">Chain conversion</a></li>
<li><a href="../130704/index.html">Watchdog for replication in PostgreSQL 9</a></li>
<li><a href="../130707/index.html">Nesztapap - old-school non-commercial site</a></li>
<li><a href="../130712/index.html">Broadcast from a Google and Samsung event in Hong Kong - Galaxy Nexus features, new Android 4.0 Ice Cream Sandwich [updated]</a></li>
<li><a href="../130714/index.html">Acer Iconia Tab - how to disassemble the tablet and what it consists of</a></li>
<li><a href="../130716/index.html">October 19 - It-english speaking club: Silicon Valley from Russia</a></li>
<li><a href="../130717/index.html">USSD in Android</a></li>
<li><a href="../130718/index.html">Android 4.0 Ice Cream Sandwich SDK will be available via ... Already available!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>