<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 05: difficult numbers in socat, Virustotal checks the BIOS for bookmarks, the secret life of WiFi modules</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Three of the most popular news of this week are somehow related to the topic of security intelligence - another poorly translated, and relatively rece...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 05: difficult numbers in socat, Virustotal checks the BIOS for bookmarks, the secret life of WiFi modules</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4f3/a43/3ed/4f3a433ed2da4c0da28836b8d08beb85.jpg" align="right">  Three of the most popular news of this week are somehow related to the topic of security intelligence - another poorly translated, and relatively recent term in the information security industry.  Intelligence is the sum of knowledge that somehow helps protect users and companies from cyber threats.  The quotes from the book by Evgeny Kaspersky, which I quote at the end of each issue, reflect the knowledge requirements for the beginning of the 90s of the last century: then one expert could have in his head everything necessary for protection against cyber threats.  Information on typical methods of infection and distribution, methods for determining the type of threat and treatment.  These were good times, but they are long gone.  To understand the threats of modern, requires a huge range of knowledge - from the Lua programming language to the dialects of Chinese, from the features of hard drive firmware to data encryption theory. <br><br>  Moreover, there is no universal and effective expertise for all.  Each company has a unique set of IT infrastructure elements, with its own vulnerable points and potential points of entry.  Naturally, there is no single, relevant for all recipe protection.  Good corporate security requires knowledge of cyber threats in general, and how they can be applied to a specific situation.  If it is simpler, you need to know where the protection will be broken (or already broken!), And the further, the more expensive this knowledge will be evaluated.  Finally, there are so many threats and types of attacks that it is also becoming more difficult to analyze them all by hand.  It is necessary to build <s>combat humanoid robots,</s> automation systems and machine learning, which will take on routine operations.  The analogue of the 120-page almanac about viruses of 1992 is now petabytes of data, non-algorithmic experience and skills of experts, and what can be called artificial intelligence.  However, it is easier to talk about the subject of examination with examples.  Go. <br><br>  All editions are available by <a href="http://habrahabr.ru/search/%3Ftarget_type%3Dposts%26q%3D%255Bklsw%255D%2520%26order_by%3Ddate">tag</a> . <br><a name="habracut"></a><br>  <b>Socat's Unix utility used a vulnerable implementation of the Diffie-Hellman algorithm to create secure connections, suspect an error or even malicious intent of the developer</b> <br>  <a href="https://threatpost.ru/socat-warns-weak-prime-number-could-mean-its-backdoored/14588/">News</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Socat is an open source Unix utility that is used to transfer data between two different channels.  With its help, for example, you can analyze network traffic by redirecting it to a file or forwarding tunnels between networks.  Since the utility interacts with the network, it also supports secure data transfer, and therefore implements the appropriate connection setup algorithms.  In particular, the Diffie-Hellman algorithm that has appeared on the pages of my digest more than once allows you to safely exchange keys and uses some basic prime number of long length for complex calculations (in this case, 1024 bits). <br><br>  Well, firstly, it has already been <a href="https://threatpost.ru/prime-diffie-hellman-weakness-may-be-key-to-breaking-crypto/12806/">proved</a> earlier that 1024-bit prime numbers are already unsafe in the context of this algorithm, although hacking something using this ‚Äúvulnerability‚Äù still takes a lot of time and is very expensive.  Secondly, the news is that the number used in socat was not easy.  In a sense, it goes into factors.  You can evaluate the consequences of such an error by reading, for example, <a href="http://crypto.stackexchange.com/questions/32415/how-does-a-non-prime-modulus-for-diffie-hellman-allow-for-a-backdoor/32431">this</a> remarkable discussion on Stackexchange.  In short - to crack the encrypted data exchange using the weakened Diffie-Hellman algoritm becomes even easier, although all the same it is a question of rather complex and lengthy calculations. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/97d/1c1/b53/97d1c1b53aab4c94ad070061aeceb1d8.jpg"></div><br><br>  Since the utility is open source, it was easy to trace the appearance of the error to a specific author.  It turned out to be a certain Zhiang Wang, at the time of adding the vulnerable code, an Oracle employee who, in general, was not trying to maintain anonymity.  Was there a reason to hide?  Well, in general, the introduction of a deliberate vulnerability in the program code can be interpreted as an attempt to plant a backdoor.  In <a href="https://threatpost.com/socat-warns-weak-prime-number-could-mean-its-backdoored/116104/">an interview with</a> Threatpost Maintainer socat Gerhard Rieger said that he still considers this a mistake.  There are two reasons.  Firstly, there was no attempt to cover the tracks, and secondly, if someone wanted to implant a backdoor, he would certainly use a less clumsy method.  On the other hand, it is difficult to check (by calculations) whether a prime number is really simple.  The patch in the OpenSSL library itself last week, by the way, solved a similar problem - there used ‚Äúunreliable‚Äù prime numbers for Diffie-Hellman to work, which also made the attack theoretically possible. <br><br>  In general, this news, like the previous ones, can be interpreted as a game of preemption by software developers and researchers of encryption algorithms: vulnerabilities are closed, the practical use of which is unlikely.  This aspect of the situation is interesting: we are talking about a bug that is very difficult to detect if you don‚Äôt know exactly where to dig.  Perhaps this is why not the most dangerous vulnerability in socat has received such attention - the news became the most popular on Threatpost for the week.  Encryption generally dramatically raises the bar for expertise required for security audits.  The problem is that such tasks of increased complexity will sooner or later begin to appear in other areas of the national economy.  In the meantime, everything is not bad: the bug was closed, replacing the basic prime number with a proven and reliable 2048-bit one.  But the potential vulnerability in socat was hidden in the code for exactly a year. <br><br>  <b>The microcode check service has appeared on VirusTotal.</b> <br>  <a href="https://threatpost.ru/virustotal-supports-firmware-scanning/14541/">News</a> <br><br>  VirusTotal service allows you to scan a suspicious file with antivirus engines from different manufacturers.  It quite often becomes the last argument in disputes about the effectiveness of security software, and more often the results of such a ‚Äúdetector‚Äù are interpreted freely and not quite correctly.  The service, which has been owned by Google since 2012, is also a useful tool for security researchers, giving them additional hints about the activity of malicious campaigns - for example, information about when and where a malicious element was downloaded. <br><br>  The new service is on the side of the standard model of VirusTotal.  It analyzes microcode, including BIOS firmware for computers and laptops, and issues a verdict on a number of parameters.  Among them: analysis of the lines contained in the firmware to determine the target vendors (for which devices the firmware is intended), extract certificates, extract the Portable Executable code ‚Äî that is, programs, for example, stored in the BIOS, but intended to run on Windows.  The latter, in theory, are of particular interest - this is how you can safely hide the malicious code in the BIOS, run it on the installed system for some purpose with elevated rights, and reinstall it if deleted. <br><br>  Attention to the firmware was attracted by the <a href="https://securelist.ru/blog/issledovaniya/25144/equation-zvezda-smerti-galaktiki-vredonosnogo-po/">study of</a> The Equation campaign published by the Laboratory last year.  Including were found means of modifying firmware hard drives, allowing to restore unauthorized access to the attacked system, even in the case of complete deletion of data.  In itself, such a discovery made it clear that with sufficient investment in development, you can create an attack model that is extremely difficult to detect and stop.  In general, the BIOS and firmware of individual components in modern computers are represented to most in the form of a black hole, in which it is unclear what happens.  And much can happen there.  Another example, this time about the BIOS - is the methods of the anti-theft complex <a href="https://securelist.ru/analysis/obzor/19169/ugroza-iz-bios/">Absolute Computrace</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7b2/557/e2f/7b2557e2f7f44ba589bfea3f4d7826ca.png"></div><br><br>  In general, it is necessary to analyze, and now VirusTotal provides tools for this, although it is very basic.  But the point here is not only in the quality of tools, but also in the amount of information for research.  The more often they use this functionality, the more different BIOS and other firmware will be collected, the easier it will be to carry out a comparative analysis.  The higher the likelihood that somewhere will be found a new backdoor, and at the same time do not have to disassemble each firmware by hand.  Actually, this is a good example of the development of information security, when experts base their research on the basis of a large amount of previously collected data.  An example of parsing the firmware is <a href="https://www.virustotal.com/en/file/3afb102f0a61f5a71be4658c3d8d3624e4773e36f64fd68a173f931bc38f651e/analysis/">here</a> . <br><br>  <b>Android closes WiFi driver vulnerability</b> <br>  <a href="https://threatpost.ru/critical-wi-fi-flaw-patched-on-android/14564/">News</a>  Security <a href="http://source.android.com/security/bulletin/2016-02-01.html">bulletin</a> . <br><br>  The February patchset for Android, which is now available to owners of Nexus devices and sometime to everyone else, closes a vulnerability in WiFi drivers for Broadcom modules.  The potential exploitation scenario for this vulnerability looks terrible.  You connect to a public WiFi network, in the subway, in the office or in a hotel.  An attacker on the same network sends a specially crafted network packet to your device and gets full access to the smartphone.  Fortunately, the scenario is really theoretical - Google claims that no real attacks were noticed. <br><br>  Another vulnerability is closed, in the infamous Mediaserver component, which previously found a <a href="https://threatpost.ru/globalnyj-vzlom-android-foto-i-pochta-dostupny-hakeram/10373/">Stagefright</a> hole.  As I said <a href="https://habrahabr.ru/company/kaspersky/blog/275693/">earlier</a> , if there are many vulnerabilities in the software, this does not necessarily qualify the software or the platform as ‚Äúinsecure‚Äù.  On one condition - if the vulnerabilities are closed.  The Android ecosystem is studied as thoroughly as possible by everyone - both white hat researchers and crime.  The introduction of monthly security updates last year was a positive change, but questions about the fragmentation of Android, the inaccessibility of patches for a large number of devices still remain.  This means that a protection strategy, for example, mobile phones in a corporate network, must a priori assume that many devices are vulnerable and will remain so for a long time. <br><br>  <b>What else happened:</b> <br>  Oracle <a href="https://threatpost.ru/oracle-to-kill-java-browser-plugin/14509/">will no longer</a> develop a Java plugin for browsers.  The expected solution, as browser developers have long been trying with all their might to not allow such plug-ins to themselves.  Google pioneered by <a href="https://threatpost.ru/google-otklyuchila-npapi-v-chrome/7741/">blocking</a> the default NPAPI interface, that is, by effectively prohibiting the work of such plug-ins as Java and Silverlight. <br><br>  Found another <a href="https://threatpost.ru/toys-patched-against-flaws-that-put-childrens-data-safety-at-risk/14585/">pack of vulnerabilities</a> in "smart" children's toys. <br><br>  Anonymous hackers <a href="https://threatpost.ru/hakery-ukrali-250-gbajt-dannyh-u-nasa/14562/">stole</a> 250 gigabytes of data from NASA.  Or they didn‚Äôt steal it: NASA itself <a href="https://threatpost.ru/nasa-otritsaet-hakerskuyu-ataku/14612/">claims</a> that the ‚Äúleak‚Äù was posted on the company's website for public access, and there was no attack, but unbridled PR. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right">  <b>Antiquities:</b> <br>  "Ninja-1376" <br><br>  Very dangerous resident virus.  It infects .COM and .EXE files other than COMMAND.COM and AIDSTEST.EXE.  When infected before and after the virus adds random blocks up to 255 bytes in length.  Periodically kills files: writes a program to their beginning, which, when started, decodes and displays the text: "Mutant Ninja Version 2.0 Copyright ¬© 1990,91 Virus &amp; Worm Software".  In 1992, on the 13th at 13.00, erases the FAT drive C :.  It does not work correctly with int 24h.  It contains the lines: "COMMAND.COM", "AIDSTEST.EXE", ".COM" and ".EXE".  Intercepts int 21h. <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 77.</i> <br><br>  <i>Disclaimer: This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/276629/">https://habr.com/ru/post/276629/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276613/index.html">Notes of a true architect: just about the most important thing (Part 2)</a></li>
<li><a href="../276617/index.html">Chakra officially adopted by Node.js</a></li>
<li><a href="../276619/index.html">Analysis of Android Malvari Matryoshka</a></li>
<li><a href="../276621/index.html">Mitap SPB .NET Community # 9</a></li>
<li><a href="../276623/index.html">Through a filtering proxy using a script in the name of the moon</a></li>
<li><a href="../276631/index.html">Game Designer Skills</a></li>
<li><a href="../276633/index.html">Compact OS for ARM processors</a></li>
<li><a href="../276635/index.html">Building a glass of quotes (FullOrderBook) based on historical data</a></li>
<li><a href="../276637/index.html">We start and we emulate Windows on Raspberry Pi by means of QEMU</a></li>
<li><a href="../276641/index.html">nopCommerce CMS on ASP.NET MVC: review of the functionality of the new version</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>