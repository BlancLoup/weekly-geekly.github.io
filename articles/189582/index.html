<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple but effective technique for working with SQL comment blocks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Developers of systems using databases have to write a lot in SQL. Everyone knows, but not everyone realizes that SQL has been experiencing for the fou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple but effective technique for working with SQL comment blocks</h1><div class="post__text post__text-html js-mediator-article">  Developers of systems using databases have to write a lot in SQL.  Everyone knows, but not everyone realizes that SQL has been experiencing for the fourth decade as one of the most successful and widely used technologies in the world of computers.  Technology does not stand still, but even today, many creators of post-relational database systems specifically invest funds and resources to provide users with SQL-like search tools and data manipulation.  Let's take a look at how modern requirements for database development products facilitate and speed up the creation of correct SQL code and get to know a curious little trick. <br><br>  Recently I came across a simple and effective solution to one elementary, not even a problem, but the inconvenience I decided to share.  The bottom line is this: <br><br>  Like any practicing SQL developer or DBA, I save scripts to solve repetitive tasks so that in the future I already have a prepared tool for quick execution.  Using DBArtisan, you can automatically record all SQL statements that I executed during the session and then use some of them to create and save such scripts.  In the DBArtisan environment, I can put items on the main menu to invoke the most frequently used scripts or run the script on several servers simultaneously. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Naturally, many of these repetitive tasks require different specialized ‚Äúpieces of code‚Äù, depending on the task or database being solved.  It turned out that it is often quicker and easier to support not to create many similar "almost" identical SQL scripts or versions, but to use "block comments" to temporarily disable / enable the necessary SQL fragment and manually manage them in the ISQL editor. <br><a name="habracut"></a><br>  Everyone knows that the SQL standard provides 2 types of comments in the source code: <br><ul><li>  "Lower case", which starts with the characters '-', and turns everything to the end of this line into text that the SQL translator does not perceive.  When moving to the next line, this comment is no longer valid. </li><li>  "Block", which can be converted into a comment large block of SQL code.  They begin with the combination of the characters '/ *' and end as soon as the combination '* /' is encountered.  These symbols indicate the beginning of the block and the end of the block. </li></ul><br>  The trick, by the example of which I will talk about the capabilities of modern ISQL editors, was suggested by <a href="http://www.sqlservercentral.com/articles/T-SQL/100061/">Peter Zerk</a> , one of the well-known MS SQL Server experts.  Take the SQL text with the commented out chunk: <br><pre><code class="sql hljs">while (@j &lt; @nstr) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-comment"><span class="hljs-comment">--     INSERT INTO PRR.TRANSITADVOLS ( VAL_ID,VAL_MASH ) VALUES /*        ,     , ... ...    ""       --*/ (@USERNM,@BDATE);</span></span></code> </pre> <br><br>  It would seem that nothing has changed, but the placement of the ‚Äúend of the block‚Äù in the ‚Äúlower-level‚Äù comments gives us the opportunity to activate this whole block (when we decide that we need to execute it) not to search and delete both the beginning and the end of the block, and just put the characters '-' in front of the ‚Äúblock start‚Äù combination <br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/*     --*/</span></span> <span class="hljs-comment"><span class="hljs-comment">--/*     --*/</span></span></code> </pre><br>  If we did not put the ‚Äúend of the block‚Äù inside the line comment, the script would be terminated, and we would get the error Incorrect syntax near '*' <br><br>  One can only wonder why my colleagues and I, in due time, passed by this decision. <br><br>  Now we can localize similar, but specific pieces of code in one place, manage our code. <br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--       /* --SCRIPT 'A' -     .    mm/dd/yyyy ... ..         mm/dd/yyyy ... --*/ /* -- SCRIPT 'B' -     .    dd/mm/yyyy ... ..         dd/mm/yyyy ... --*/</span></span></code> </pre><br>  Suppose I need to process input data with dates in the ‚ÄúAmerican‚Äù format - 'mm / dd / yyyy'.  I insert the symbols - before the first group ‚Äúthe beginning of the block‚Äù and the execution of the block SCRIPT A is turned on. At the same time - SCRIPT B remains off.  If the data came in with the date in ‚Äúour‚Äù format - dd / mm / yyyy - then I do the opposite, put it - before the second ‚Äústart of the block‚Äù, and the SCRIPT B is turned on <br><br>  <strong>Tracing</strong> <br><br>  Using the same trick, T-SQL allows us to use another useful ‚Äúside effect‚Äù. <br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--    PRINT,     --/* --SCRIPT 'A' -       Print 'Script A active - integer data' --*/ Print 'Script A inactive /* -- SCRIPT 'B' -      Print 'Script B active - char data' --*/ Print 'Script B inactive'</span></span></code> </pre><br>  A trace will appear in the message window: <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/452/25d/caa/45225dcaa67d6637c4a0b9d35a61ebb2.jpg" alt="https://habrastorage.org/getpro/habr/post_images/452/25d/caa/45225dcaa67d6637c4a0b9d35a61ebb2.jpg" width="300" height="129"></a> <br><br>  And all this is achieved by commenting on a single line of source text. <br><br>  <strong>Debugging</strong> <br><br>  Have you ever figured out why a query with a complex set of selection conditions does not work as expected? <br><br>  Now it is easier to do this by alternately testing the performance of all or part of these conditions. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-comment"><span class="hljs-comment">#table /* --       WHERE ID in ( SELECT something FROM a-really-complex-condition WHERE we-are-not-sure-what-we-get ) --*/ WHERE ID = 1 --       </span></span></code> </pre><br>  Or control the depth of data modification when executing the script. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> <span class="hljs-comment"><span class="hljs-comment">#table set Comment = 'changed' where Comment = 'change me' /* -- use 'line comment' to enable UPDATE to proceed and 1 = 1 --*/ and 1 = 0</span></span></code> </pre><br><br>  This example allows me to debug the whole script without actually updating it until I check that everything works as it should. <br><br>  And the last. <br><br>  Dear author gave an example of using this trick to support nested blocks of one another. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> Mytable <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">-- always true /* -- first condition to check AND condition1 = TRUE --*/ /* -- some more conditions AND condition2 = ( SELECT condition3 FROM Myanothertable WHERE 1 = 1 /* -- Paying attention? This is a nested Comment Block AND NestedCondition = TRUE --*/ ) --*/ --/* the comment here 'activates' this condition. It gets checked. AND Comment = 'buggy value' --*/</span></span></code> </pre><br>  You can see for yourself, it really works.  In any ISQL editor, for example, run DBArtisan, and copy this text there. <br><br>  SQL is a universal, if you can say so, standardized language, which, however, is transformed in each DBMS in accordance with the requirements imposed by the creators of this platform.  In MS SQL, this is the T-SQL dialect, in Oracle we use PL / SQL, in other platforms we introduce our own unique features of syntax and behavior.  Here is how it looks for MS SQL: <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b61/6ff/b3d/b616ffb3d46a2e648a647a6461d769bc.jpg" alt="sqlsql_9235" width="500" height="303"></a> <br><br>  I decided to apply the trick I liked to work with Oracle.  You can additionally run the tools that come with Oracle, but you can stay at DBArtisan, which supports simultaneous work with different DBMS platforms. <br><br>  In DBArtisan, I opened another window of the SQL editor, indicated that this editor was already connected to the Oracle database and transferred the script from the example above to it: <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/7f1/d2f/72d/7f1d2f72df7bef2ea6bdf1275c96a6b4.jpg" alt="https://habrastorage.org/getpro/habr/post_images/7f1/d2f/72d/7f1d2f72df7bef2ea6bdf1275c96a6b4.jpg" width="500" height="223"></a> <br><br>  I just inserted the text of the request.  See the red mark on line 13? <br>  This DBArtisan automatic syntax analyzer signals that SQL text does not conform to the rules of a given SQL dialect.  A check on the Oracle site confirmed that, despite the graphical syntax schemes in the documentation, Oracle did not support nested comments and did not support them.  By the way, the rest of the examples worked! <br><br>  The automatic parser / validator is one of the three components that were included in the SQL editor DBArtisan, in accordance with modern requirements to accelerate the development of SQL programs and improve their quality.  It also detects instances of using object names that are absent in the database, right as you type. <br><br>  It also helps a lot when developing SQL programs, greatly speeds up and avoids the simplest mistakes in writing the Code Completion mode.  If you had to write in modern programming languages ‚Äã‚Äãin rapid application development environments, for example, Delphi or C ++ Builder, Java Designer or Eclipse, you are familiar with it: as you type, the editor himself selects the appropriate context objects (not just syntax elements ) and substitutes them in the text for you or offers to make a choice from the list.  DBArtisan selects objects from the current context based on the DBMS editor platform, from the list of actually existing schema objects of the used data source. <br><br>  If, when writing complex SQL code, it suddenly turns out that you need to make some changes to other schema objects, for example, add an input parameter to the stored procedure, you can simply go to editing it (in a specialized dialog editor), selecting its name directly in text on SQL and calling the corresponding Hyperlink Object Action with the mouse. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/200/30a/469/20030a469f6e8ffc34fe7d7f1168673d.jpg" alt="https://habrastorage.org/getpro/habr/post_images/200/30a/469/20030a469f6e8ffc34fe7d7f1168673d.jpg" width="500" height="252"></a> <br><br>  Like any text, SQL program scripts can be created in any text editor.  But if you are a professional, you work a lot and often with SQL, then syntax highlighting and automatic reformatting of the code will no longer be enough, especially if you have to switch between different DBMS platforms. <br><br>  Moreover, more or less successful attempts are made to make server-side technologies for developing information systems more flexible, more adaptable for making changes and implementing new requirements, taking more advantage of the collective development and the repeated use of successful and proven solutions.  For quite a long time, many DBMS and solutions for developers have the opportunity to apply the "versioning" of SQL texts.  About this - in the following articles. </div><p>Source: <a href="https://habr.com/ru/post/189582/">https://habr.com/ru/post/189582/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189570/index.html">Make beautiful input [type = file] for responsive site</a></li>
<li><a href="../189574/index.html">Oracle data access methods</a></li>
<li><a href="../189576/index.html">10 reasons why your project should use the Dojo Toolkit</a></li>
<li><a href="../189578/index.html">Microsoft released another set of updates, August 2013</a></li>
<li><a href="../189580/index.html">dotPeek 1.1: JetBrains free decompiler update</a></li>
<li><a href="../189584/index.html">Between Samsung Galaxy S III and OPPO Find 5 (quite a bit more about the latter)</a></li>
<li><a href="../189586/index.html">Hipster approach or ‚Äúwhat to do when writing press releases is boring‚Äù</a></li>
<li><a href="../189588/index.html">How to create a cluster in JBoss AS 7.1 in standalone mode?</a></li>
<li><a href="../189594/index.html">Paul Graham: How to convince investors</a></li>
<li><a href="../189596/index.html">Mixed (client / server) xmlDsig digital signature generation algorithm based on CryptoPro Browser Plugin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>