<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WPF Binding: When do you need to use ObjectDataProvider?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are many ways to create an object that will be used as a data source for binding. Many people create an object in code and assign this object to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WPF Binding: When do you need to use ObjectDataProvider?</h1><div class="post__text post__text-html js-mediator-article">  There are many ways to create an object that will be used as a data source for binding.  Many people create an object in code and assign this object to the DataContext property of Window.  In general, this is a good way.  You may have noticed that I added the source object to the Window's Resource Dictionary in most of my posts, and it worked quite well.  However, we have the ObjectDataProvider class in the data binding, which can also be used to create your source object in XAML.  In this post I will try to explain the differences between adding a source object directly to resources and using an ObjectDataProvider.  I hope I will give you a guide on how to evaluate your task and choose the best solution. <br><a name="habracut"></a><br>  As I describe these possibilities, we will create a small program that will allow people to indicate their weight on Earth and find out how much they will weigh on Jupiter. <br><br>  When we add a source object directly to resources, the data binding engine calls the default constructor for the type of this object.  The object added to the resource dictionary uses the key defined through x: Key.  Here is an example code with this approach: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">local:MySource</font> <font color="#ff0000">x:Key</font> =‚Äù <font color="#ff0000">source</font> ‚Äù <font color="#0000ff">/&gt;</font> (‚Ä¶) <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font></font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">local:MySource</font> <font color="#ff0000">x:Key</font> =‚Äù <font color="#ff0000">source</font> ‚Äù <font color="#0000ff">/&gt;</font> (‚Ä¶) <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">local:MySource</font> <font color="#ff0000">x:Key</font> =‚Äù <font color="#ff0000">source</font> ‚Äù <font color="#0000ff">/&gt;</font> (‚Ä¶) <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">local:MySource</font> <font color="#ff0000">x:Key</font> =‚Äù <font color="#ff0000">source</font> ‚Äù <font color="#0000ff">/&gt;</font> (‚Ä¶) <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">local:MySource</font> <font color="#ff0000">x:Key</font> =‚Äù <font color="#ff0000">source</font> ‚Äù <font color="#0000ff">/&gt;</font> (‚Ä¶) <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">local:MySource</font> <font color="#ff0000">x:Key</font> =‚Äù <font color="#ff0000">source</font> ‚Äù <font color="#0000ff">/&gt;</font> (‚Ä¶) <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font></font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Alternatively, you can add an ObjectDataProvider class object to resources and use it as a source for binding.  The ObjectDataProvider class is a wrapper for your source object, which provides some additional functionality.  Next, I will talk about the following remarkable features of the ObjectDataProvider: <br><ul><li>  Passing parameters to the constructor; </li><li>  Binding on a method (which can take parameters); </li><li>  Replacing the source object; </li><li>  Asynchronous creation of a source object. </li></ul><br><h2>  Passing parameters to the constructor </h2><br>  When we add a source object directly to resources, WPF always calls the default constructor for this type.  It may happen that you do not have control over the source object, and the class that you add does not have a default constructor.  For example, this is a class from a third-party library and it is declared as sealed.  In this situation, you can create an instance of a class in XAML by using an ObjectDataProvider in the following way: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">ObjectDataProvider</font> <font color="#ff0000">ObjectType</font> = ‚Äù{ <font color="#ff0000">x: Type</font> <font color="#ff0000">local: MySource</font> }‚Äù <font color="#ff0000">x: Key</font> = ‚Äù <font color="#ff0000">odp1</font> ‚Ä≥ <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">ObjectDataProvider.ConstructorParameters</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">system: String</font> <font color="#0000ff">&gt;</font> Jupiter <font color="#0000ff">&lt;/</font> <font color="#800000">system: String</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">ObjectDataProvider.ConstructorParameters</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">ObjectDataProvider</font> <font color="#0000ff">&gt;</font> </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  This markup creates an instance of the class MySource by invoking its constructor and passing the string ‚ÄúJupiter‚Äù as its parameter.  This also creates an object of class ObjectDataProvider, which will wrap an object of class MySource. <br><br>  MySource has a public property called ‚ÄúPlanet‚Äù that provides an object of the Planet class, whose name corresponds to the string passed to the constructor.  In our case, this is ‚ÄúJupiter‚Äù.  I want the program to have a label that associates with the Name property of the planet.  Binding to subproperties can be implemented in WPF using ‚Äúdot notation‚Äù.  In general, it looks like this: Path = Property.SubProperty.  You can see this in the following code: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Label</font> <font color="#ff0000">Content</font> = ‚Äù{ <font color="#ff0000">Binding</font> <font color="#ff0000">Source</font> = { <font color="#ff0000">StaticResource</font> <font color="#ff0000">odp1</font> }, <font color="#ff0000">Path</font> = <font color="#ff0000">Planet</font> .  <font color="#ff0000">Name</font> } ‚Äù <font color="#ff0000">Grid</font> .  <font color="#ff0000">ColumnSpan</font> = ‚Äù <font color="#ff0000">2</font> ‚Ä≥ <font color="#ff0000">HorizontalAlignment</font> =‚Äù <font color="#ff0000">Center</font> ‚Äù <font color="#ff0000">FontWeight</font> =‚Äù <font color="#ff0000">Bold</font> ‚Äù <font color="#ff0000">Foreground</font> =‚Äù <font color="#ff0000">IndianRed</font> ‚Äù <font color="#ff0000">FontSize</font> =‚Äù <font color="#ff0000">13</font> ‚Ä≥ <font color="#ff0000">Margin</font> = ‚Äù <font color="#ff0000">5</font> , <font color="#ff0000">5</font> , <font color="#ff0000">5</font> ‚Ä≥ <font color="#ff0000">15</font> ‚Ä≥ <font color="#0000ff">/&gt;</font> </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  You might look at this binding definition and think that it does not make sense.  It looks as if we are associating with the Name sub-property of the Planet property of the ObjectDataProvider class.  But I mentioned above that MySource has a Planet property, but ObjectDataProvider does not have it.  The reason why this code works is that the binding engine accesses the ObjectDataProvider in a special way when the Path property of the source object is wrapped (that is, wrapped).  Note that this special access method can also be applied when binding to an XmlDataProvider or CollectionViewSource. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Method binding </h2><br>  MySource has a method that takes as an argument the weight of a person on Earth and calculates the weight of this person on the planet, which was transferred to the constructor.  I want to pass some weight value to a method in XAML and communicate with its result.  This can be done using ObjectDataProvider: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">ObjectDataProvider</font> <font color="#ff0000">ObjectInstance</font> = ‚Äù{ <font color="#ff0000">StaticResource</font> <font color="#ff0000">odp1</font> }‚Äù <font color="#ff0000">MethodName</font> = ‚Äù <font color="#ff0000">WeightOnPlanet</font> ‚Äù <font color="#ff0000">x: Key</font> = ‚Äù <font color="#ff0000">odp2</font> ‚Ä≥ <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">ObjectDataProvider.MethodParameters</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">system: Double</font> <font color="#0000ff">&gt;</font> 95 <font color="#0000ff">&lt;/</font> <font color="#800000">system: Double</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">ObjectDataProvider.MethodParameters</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">ObjectDataProvider</font> <font color="#0000ff">&gt;</font> </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Notice that instead of setting the ObjectType property, this time I set the ObjectInstance property.  This allows us to reuse an instance of the class MySource, which we created in the previous ObjectDataProvider.  I also set the MethodName property and passed the parameter to this method using the MethodParameters property.  Displaying the result returned from a method is as simple as creating a binding with this second ObjectDataProvider: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Label</font> <font color="#ff0000">Content</font> = ‚Äù{ <font color="#ff0000">Binding</font> <font color="#ff0000">Source</font> = { <font color="#ff0000">StaticResource</font> <font color="#ff0000">odp2</font> }}‚Äù <font color="#ff0000">Grid</font> .  <font color="#ff0000">Row</font> = ‚Äù <font color="#ff0000">2</font> ‚Ä≥ <font color="#ff0000">Grid</font> .  <font color="#ff0000">Column</font> = ‚Äù <font color="#ff0000">1</font> ‚Ä≥ <font color="#ff0000">Grid</font> .  <font color="#ff0000">ColumnSpan</font> = ‚Äù <font color="#ff0000">2</font> ‚Ä≥ <font color="#0000ff">/&gt;</font> </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  This is a good start, but I would like to allow users to enter their own weight in TextBox, and so that the Label will show the new value.  However, the problem is that I cannot put the Binding description in the MethodParameters property because this property is not a DependencyProperty.  In fact, ObjectDataProvider is also not a DependencyObject.  As you remember, the target of the Binding should be a Dependency property, although there can be any source.  Fortunately, there is a way out when you want to bind the CLR property to the Dependency property: you can swap the source and target by placing your binding in the Dependency property and setting the Mode Binding property to TwoWay or OneWayToSource.  This code shows how to create a TextBox that modifies the argument that was passed to the WeightOnPlanet method: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> </li><li>  (...) </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">local: DoubleToString</font> <font color="#ff0000">x: Key</font> = ‚Äù <font color="#ff0000">doubleToString</font> ‚Äù <font color="#0000ff">/&gt;</font> </li><li>  (...) </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Window.Resources</font> <font color="#0000ff">&gt;</font> </li><li></li><li>  (...) </li><li></li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">TextBox</font> <font color="#ff0000">Grid</font> .  <font color="#ff0000">Row</font> = ‚Äù <font color="#ff0000">1</font> ‚Ä≥ <font color="#ff0000">Grid</font> .  <font color="#ff0000">Column</font> = ‚Äù <font color="#ff0000">1</font> ‚Ä≥ <font color="#ff0000">Name</font> =‚Äù <font color="#ff0000">tb</font> ‚Äù <font color="#ff0000">Style</font> =‚Äù { <font color="#ff0000">StaticResource</font> <font color="#ff0000">tbStyle</font> } ‚Äù <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">TextBox.Text</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Binding</font> <font color="#ff0000">Source</font> = ‚Äù{ <font color="#ff0000">StaticResource</font> <font color="#ff0000">odp2</font> }‚Äù <font color="#ff0000">Path</font> = ‚Äù <font color="#ff0000">MethodParameters</font> [ <font color="#ff0000">0</font> ]‚Äù <font color="#ff0000">BindsDirectlyToSource</font> = ‚Äù <font color="#ff0000">true</font> ‚Äù <font color="#ff0000">UpdateSourceTrigger</font> = ‚Äù <font color="#ff0000">PropertyChanged</font> ‚Äù <font color="#ff0000">Converter</font> = ‚Äù{ <font color="#ff0000">StaticResource</font> <font color="#ff0000">doubleToString</font> }‚Äù <font color="#0000ff">&gt;</font> </li><li>  (...) </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Binding</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">TextBox.Text</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Textbox</font> <font color="#0000ff">&gt;</font> </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  In this situation, I do not need to do anything for the binding to be Two-Way, because I create a binding with the Text property of an object of the TextBox class;  it [binding] is already Two-Way by default.  By default, the bindings will be One-Way in most Dependency properties and Two-Way in those properties where we expect the data to be changed by the user.  This default behavior can be overridden by changing the Mode property of the Binding. <br><br>  As I said above, when we create a binding on an ObjectDataProvider, the binding engine automatically looks at the source that is wrapped, and not at the ObjectDataProvider itself.  In this situation, this presents a problem for us, because we want to connect with the ObjectDataProvider's MethodParameters property.  To change the default behavior, we must set the BindsDirectlyToSource property to true. <br><br>  The MethodParameters property is an IList, and in our situation we want to bind to the first item in the list, since the WeightOnPlanet method takes only one parameter.  We can do this using an indexer, just as we would do in a C # code. <br><br>  I set the property UpdateSourceTrigger to PropertyChanged, so when the method is invoked, we get a new value whenever the user types something in the TextBox.  Other possible values ‚Äã‚Äãfor the UpdateSourceTrigger property are ‚ÄúExplicit‚Äù (we must explicitly call UpdateSource () on the binding) and ‚ÄúLostFocus‚Äù (the source will be updated when the control loses focus), which is the default. <br><br>  If we were binding to a property with a double type, the binding engine would try to automatically convert the Text Text Box's property to a double type.  However, due to the fact that we are attached to the method, we need to write our own converter.  Without it, the binding will try to call the WeightOnPlanet method, which accepts a string as a parameter, which will lead to an error, because  there is no such method.  If we look at the Output window in Visual Studio, we will see a debugging message there that says that we could not find a method that accepts the parameters that we pass.  Here is the code for this converter: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> DoubleToString: IValueConverter </li><li>  { </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">object</font> <font color="#2B91AF">Convert</font> ( <font color="#0000ff">object</font> <font color="#0000ff">value</font> , Type targetType, <font color="#0000ff">object</font> parameter, System.Globalization.CultureInfo culture) </li><li>  { </li><li>  <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> ! = <font color="#0000ff">null</font> ) </li><li>  { </li><li>  <font color="#0000ff">return</font> <font color="#0000ff">value</font> .ToString (); </li><li>  } </li><li>  <font color="#0000ff">return</font> <font color="#0000ff">null</font> ; </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">object</font> ConvertBack ( <font color="#0000ff">object</font> <font color="#0000ff">value</font> , Type targetType, <font color="#0000ff">object</font> parameter, System.Globalization.CultureInfo culture) </li><li>  { </li><li>  <font color="#0000ff">string</font> strValue = <font color="#0000ff">value</font> <font color="#0000ff">as</font> <font color="#0000ff">string</font> ; </li><li>  <font color="#0000ff">if</font> (strValue! = <font color="#0000ff">null</font> ) </li><li>  { </li><li>  <font color="#0000ff">double</font> result; </li><li>  <font color="#0000ff">bool</font> converted = Double.TryParse (strValue, <font color="#0000ff">out</font> result); </li><li>  <font color="#0000ff">if</font> (converted) </li><li>  { </li><li>  <font color="#0000ff">return</font> result; </li><li>  } </li><li>  } </li><li>  <font color="#0000ff">return</font> <font color="#0000ff">null</font> ; </li><li>  } </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Some of you may be a little puzzled by this converter: should it be StringToDouble or DoubleToString?  The Convert method is called when data is transferred from a source (double) to a target (string), and the ConvertBack method is called when a transfer occurs in the opposite direction.  And so, we need a DoubleToString converter, and not any other. <br><br>  And what will happen if the user enters the wrong weight value?  He may enter a negative number, or a string containing more than just numbers, or he may not enter anything at all.  And, if the situation is this, I do not want to allow the binding to begin transmitting data to the source.  I want to create my own logic, which not only prevents the binding from transmitting data, but also warns the user that the value entered by him is incorrect.  This can be done using the Validation function in data binding.  I wrote a ValidationRule that validates the values ‚Äã‚Äãand added it to the property in the following way: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Binding</font> <font color="#ff0000">Source</font> = ‚Äù{ <font color="#ff0000">StaticResource</font> <font color="#ff0000">odp2</font> }‚Äù <font color="#ff0000">Path</font> = ‚Äù <font color="#ff0000">MethodParameters</font> [ <font color="#ff0000">0</font> ]‚Äù <font color="#ff0000">BindsDirectlyToSource</font> = ‚Äù <font color="#ff0000">true</font> ‚Äù <font color="#ff0000">UpdateSourceTrigger</font> = ‚Äù <font color="#ff0000">PropertyChanged</font> ‚Äù <font color="#ff0000">Converter</font> = ‚Äù{ <font color="#ff0000">StaticResource</font> <font color="#ff0000">doubleToString</font> }‚Äù <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Binding.ValidationRules</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">local: WeightValidationRule</font> <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Binding.ValidationRules</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Binding</font> <font color="#0000ff">&gt;</font> </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  WeightValidationRule is a heir from ValidationRule and overrides the Validate method, in which I described the logic I needed: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> WeightValidationRule: ValidationRule </li><li>  { </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">override</font> ValidationResult Validate ( <font color="#0000ff">object</font> <font color="#0000ff">value</font> , System.Globalization.CultureInfo cultureInfo) </li><li>  { </li><li>  <font color="#008000">// Value is not a string</font> </li><li>  <font color="#0000ff">string</font> strValue = <font color="#0000ff">value</font> <font color="#0000ff">as</font> <font color="#0000ff">string</font> ; </li><li>  <font color="#0000ff">if</font> (strValue == <font color="#0000ff">null</font> ) </li><li>  { </li><li>  <font color="#008000">// not going to happen</font> </li><li>  <font color="#0000ff">return</font> <font color="#0000ff">new</font> ValidationResult ( <font color="#0000ff">false</font> , ‚ÄúInvalid Weight - Value <font color="#0000ff">is</font> not a <font color="#0000ff">string</font> ‚Äù); </li><li>  } </li><li></li><li>  <font color="#008000">// Value can not be converted to double</font> </li><li>  <font color="#0000ff">double</font> result; </li><li>  <font color="#0000ff">bool</font> converted = Double.TryParse (strValue, <font color="#0000ff">out</font> result); </li><li>  <font color="#0000ff">if</font> (! converted) </li><li>  { </li><li>  <font color="#0000ff">return</font> <font color="#0000ff">new</font> ValidationResult ( <font color="#0000ff">false</font> , ‚ÄúInvalid Weight - Please type a valid number‚Äù); </li><li>  } </li><li></li><li>  <font color="#008000">// Value is not between 0 and 1000</font> </li><li>  <font color="#0000ff">if</font> ((result &lt;0) || (result&gt; 1000)) </li><li>  { </li><li>  <font color="#0000ff">return</font> <font color="#0000ff">new</font> ValidationResult ( <font color="#0000ff">false</font> , ‚ÄúInvalid Weight - You're either too light or too heavy‚Äù); </li><li>  } </li><li></li><li>  <font color="#0000ff">return</font> ValidationResult.ValidResult; </li><li>  } </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Now, entering the wrong value causes a red border around the TextBox.  However, I want to notify the user about the message that is contained in the ValidationResult.  Moreover, I would like a tooltip to appear with an error message when the user does something wrong.  This can all be done in XAML, with styles and triggers: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Style</font> <font color="#ff0000">x: Key</font> = ‚Äù <font color="#ff0000">tbStyle</font> ‚Äù <font color="#ff0000">TargetType</font> = ‚Äù{ <font color="#ff0000">x: Type</font> <font color="#ff0000">TextBox</font> }‚Äù <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Style.Triggers</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Trigger</font> <font color="#ff0000">Property</font> = ‚Äù <font color="#ff0000">Validation</font> .  <font color="#ff0000">HasError</font> ‚Äù <font color="#ff0000">Value</font> =‚Äù <font color="#ff0000">true</font> ‚Äù <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">Setter</font> <font color="#ff0000">Property</font> = ‚Äù <font color="#ff0000">ToolTip</font> ‚Äù </li><li>  <font color="#ff0000">Value</font> = ‚Äù{ <font color="#ff0000">Binding</font> <font color="#ff0000">RelativeSource</font> = { <font color="#ff0000">RelativeSource</font> <font color="#ff0000">Self</font> }, <font color="#ff0000">Path</font> = ( <font color="#ff0000">Validation</font> . <font color="#ff0000">Errors</font> ) [ <font color="#ff0000">0</font> ].  <font color="#ff0000">ErrorContent</font> } ‚Äù <font color="#0000ff">/&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Trigger</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Style.Triggers</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">Style</font> <font color="#0000ff">&gt;</font> </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Validation.HasError is an attached Dependency property that becomes true whenever at least one ValidationRule returns an error.  Validation.Errors is also a nested Dependency property that contains a list of errors for a particular element.  In this case, we know that a TextBox can have only one error (since it has only one rule), which means that we can safely associate ToolTip with the first error in this list.  ‚Äú{RelativeSource Self}‚Äù simply means that the source of our binding is TextBox itself.  Notice that the description of the Path property uses parentheses ‚Äî they should be used whenever we bind to the nested Dependency property.  In Russian, ‚ÄúPath = (Validation.Errors) [0] .ErrorContent‚Äù means that we are looking for the source property Validation.Errors (i.e., TextBox), we get the first item in the list and refer to ValidationError's apt property ErrorContent. <br><br>  If you try to enter something in TextBox that is different from a number in the range from 0 to 1000, then you should see a pop-up hint with an error message. <br><br>  I wrote an example (which is included in the SDK) that shows some other aspects of validation.  There is a lot more to say about this possibility, but I will leave a more detailed explanation for the subsequent posts. <br><br><h2>  Replacing the source object </h2><br>  You may need to, when you need to replace the current source of all your bindings with some other object.  If you have an object in the resource dictionary that is used as a source for linking, there is no way to replace this object with any other object and cause an update of all bindings.  Deleting this object from the resource dictionary and adding a new one with the same x: Key will not cause the bindings to be notified. <br><br>  If this is your case, you can decide to use ObjectDataProvider.  If you change the ObjectType property, all bindings to this ObjectDataProvider will be notified that the source object has been updated and the data must be updated. <br><br>  Note that if you assign the DataContext property of an element that is higher in the element tree, your source object is programmatically, assigning another object will also cause all bindings to be updated. <br><br><h2>  Asynchronous source object creation </h2><br>  ObjectDataProvider has a property called IsAsynchronous that allows you to control whether data will be loaded in the same stream as your program, or in another.  By default, ObjectDataProvider has this property set to false, and XmlDataProvider set to true. <br><br>  I plan to discuss this in more detail in one of my future posts, so be prepared. <br><br>  You can use the source code of this example in order to write a WPF program that will allow users to select a planet, enter their weight and find out their weight on the selected planet.  In fact, it is very simple. <br><br><div style="text-align:center;"><img src="http://www.beacosta.com/uploaded_images/19ObjectDataProviderSample.png"></div><br>  <a href="">Here</a> you can find a project for Visual Studio with the code that was used in the article. </div><p>Source: <a href="https://habr.com/ru/post/46998/">https://habr.com/ru/post/46998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../46992/index.html">Charger toaster for mobile phone</a></li>
<li><a href="../46993/index.html">Illness, nemerle</a></li>
<li><a href="../46994/index.html">The first Walkman with tachkrinom</a></li>
<li><a href="../46996/index.html">Internet for legal entities in Belarus is getting cheaper</a></li>
<li><a href="../46997/index.html">Motherload flash game</a></li>
<li><a href="../47001/index.html">Microsoft SkyDrive - 25GB online storage free (free then, if in Russian)</a></li>
<li><a href="../47002/index.html">A way to cause Safari browser crash</a></li>
<li><a href="../47003/index.html">A Practical Cloud Computing Guide by InformationWeek</a></li>
<li><a href="../47004/index.html">South - cool new syncdb</a></li>
<li><a href="../47005/index.html">Plugin to quickly change the encoding of an open file in Gedit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>