<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The process of release of iOS-applications in Badoo</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! My name is Mikhail Bulgakov, and I work on the Badoo release engineers team. In this post, I will talk about how iOS application releases occur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The process of release of iOS-applications in Badoo</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/59/ca/3f/59ca3f40d0e0c701755539.jpeg"></p><br><p>  Hello!  My name is Mikhail Bulgakov, and I work on the Badoo release engineers team.  In this post, I will talk about how iOS application releases occur from the moment <strong>‚ÄúI have a ready-made binary‚Äù</strong> to the moment <strong>‚ÄúAfter the deluge of us,‚Äù</strong> and, of course, as we do in Badoo (looking ahead: we managed to reduce the time required to launch the release from several hours to one minute and get rid of manual work). </p><a name="habracut"></a><br><h3 id="zhiznennyy-cikl-reliza-ios-prilozheniya">  IOS application release life cycle </h3><br><p><img src="https://habrastorage.org/webt/59/cb/a2/59cba24e0447f949825615.png"></p><br><p>  To begin with, I‚Äôll briefly talk about how releases of iOS applications go in general.  We assume that we have only one application with one supported language.  Perhaps someone this part seems obvious, I understand.  Therefore, if you know how this kitchen is arranged, switch immediately to the next chapter - iOS releases in Badoo. </p><br><p>  Immediately I will clarify that all the work on the preparation of the release takes place on the site iTunes Connect.  This is an Apple component specifically designed for application developers.  There is both a web version and an application, and both have flaws.  The application is almost useless for working on the product (but it should be at least for push-notifications: it is always better when they are, than when they are not);  and the web version is cumbersome and cumbersome and slow (Apple is not particularly famous for developer-friendly products).  There is also an API that can be used for our purposes, but more on that later. </p><br><p>  So, when the application has already been assembled and tested, it is worthwhile to immediately upload it - it should go through the so-called processing (pre-check of a binary file), it takes from half an hour to several hours.  Next, we prepare the information for display in the Store: fill in the text and image data that the user will see in the App Store.  This data will also be checked: both the accuracy of the screenshots and the correspondence of the description of reality. </p><br><p>  As soon as the binary file has passed the processing stage, we send the application for review by answering a couple of questions in the form (about encryption and advertising user ID), and we are awaiting a review.  It is important to note that before the review has begun, we can change both text assets (‚ÄúDescription‚Äù, ‚ÄúWhat's New‚Äù, ‚ÄúKeywords‚Äù, etc.) and graphics (screenshots, icon and all that).  But, as soon as the status becomes <strong>In Review</strong> , only text data can be changed, and even that is not all.  On average, a <a href="http://appreviewtimes.com/">review review</a> lasts no more than a couple of days, the review itself lasts from half an hour to several hours. </p><br><p>  If assets, in-app purchase (in-app purchases) or a binary file are not all right, then it is rejected and given the opportunity to correct errors.  The most common ones are <strong>Metadata Rejected</strong> , when the reviewer could not use the new In-App, for example (in this case, you do not need to reload the new version - just chat with tech support and send the application for testing again) and <strong>Rejected</strong> (this is serious and you need to fix something). root and reload the new version of the application). </p><br><p>  It is worth noting that the application can be rejected for so many reasons.  Apple‚Äôs requirements are very specific and are detailed in the <a href="https://developer.apple.com/app-store/review/guidelines/">guidelines</a> .  And if we shake off Rejection, then we get a detailed description of the cause.  These can be application crashes, inconsistencies between screenshots and applications, forbidden logic (there are many lists of logic that are not allowed to be distributed, for example, dating services for minors), a broken interface, and so on.  In fact, in this case we get an additional stage of testing for our peace of mind, so you should not treat it too negatively. </p><br><p>  There is also the possibility of an <a href="https://developer.apple.com/support/app-review/"><strong>Expedited App Review</strong></a> .  This is a very useful thing, intended for an urgent release of a critical fix or a seasonal event, to which we did not have time to prepare (for example, you need to add a new pack of stickers for Valentine's Day). </p><br><p>  After checking the application, the status changes to <strong>Pending Developer Release</strong> , and we release it to the public. </p><br><p>  By the way, there are also a couple of handy features for developers: <strong>automated / manual release of the application and <a href="https://itunespartner.apple.com/en/apps/faq/Managing%2520Your%2520Apps_Submission%2520Process">Phased Review</a></strong> .  As for the automated / manual release: you can release the application as soon as it passes the review, at a certain time and day, or manually - by clicking the button.  And the second tool is a very interesting thing.  Apple is launching a phased release (which was long ago implemented on Google Play), which allows the application to be released to all users within seven days. </p><br><h3 id="ios-relizy-v-badoo">  Badoo iOS Releases </h3><br><p><img src="https://habrastorage.org/webt/59/ca/4c/59ca4c2319e6c417068415.png"></p><br><p>  We now have eight iOS applications (the main one is Badoo, and several dating apps under different brands aimed at their target audience or country, with their own features and buns), most of them being translated into 25 languages ‚Äã‚Äãand dialects.  For each application, we translate all materials for the App Store: as a text part, as well as screenshots and videos.  Most of the applications we release once a week, the rest - periodically. </p><br><p>  Naturally, for the preparation and release of such a volume of content, in addition to the binary file itself, you need to prepare and fill in a huge amount of texts and pictures.  And, of course, it takes a lot of time from release engineers, translators and product managers.  Without automation, all this would have resulted in a small local hell for all participants in the process. </p><br><p>  Below, I will tell you how we went from this hell to a very convenient and transparent flow. </p><br><h4 id="kak-ranshe-prohodila-podgotovka-reliza">  How was the release preparation? </h4><br><p><img src="https://habrastorage.org/webt/59/ca/4c/59ca4c232ca26276311814.png"></p><br><p>  While the QA team was testing the release branch, the product manager wrote the texts for the next release to Google Docs and sent them to the team of translators.  Which, in turn, made translations in the same document.  When everything was ready together with the binary file, the preparation of the next release began in the App Store. </p><br><p>  The release engineer poured a binary file of the application in the App Store, waited while Apple finished its processing (at that time he was starting to upload updated texts and screenshots for the upcoming release).  On average, processing took one to two hours.  In about the same time, we managed to update the assets for the application. </p><br><p>  Apple often added fuel to the fire with the godless iTunes Connect website, where all the work was done.  And we actively used life hacking ‚Äî listening to relaxing music.  Because it was possible to fill in all the texts and screenshots, click on the ‚ÄúSave‚Äù button - and see that the session was torn or the message ‚ÄúTry later‚Äù (without trial!) Or unfilled assets for a non-existent language.  By the way, such glitches are not uncommon now. </p><br><p>  In general, it‚Äôs hard and unsightly to work with iTunes Connect if you have more than one application in several languages. </p><br><p>  What were the obvious disadvantages of such an organization of work: </p><br><ul><li>  Absolutely inconvenient system with a custom document for each release. </li><li>  Interaction through mail-jabber at each stage of release readiness. </li><li>  The document had to be searched each time among threads in the mail. </li><li>  Very slow and nervous work with iTunes Connect. </li><li>  Preparing each release took a few hours from the team. </li><li>  Huge probability of error due to the human factor. </li><li>  Writing texts for each release. </li></ul><br><h4 id="kak-ranshe-prohodil-monitoring-progressa">  As previously monitored progress </h4><br><p><img src="https://habrastorage.org/webt/59/ca/4c/59ca4c23487a2434152377.jpeg"></p><br><p>  Then began the process of monitoring releases.  Yes, Apple sends emails about every change in application status.  It's comfortable.  Nevertheless, at this stage, it still required a lot of actions and manual work, which did not allow to reduce the probability of error due to the human factor. </p><br><p>  Actually, earlier the review process on the Apple side took about five days.  During this period, it was necessary to go into iTunes Connect from time to time and check if something had changed.  The letter can be lost, and all this had to be done manually.  And given the speed of the site, it was necessary to spend at least ten minutes to simply view the statuses of all applications.  Just to view the statuses, Carl! </p><br><p>  Finally, when all applications successfully passed the review, we notified product managers about this, so that they could be convinced of the readiness of the server part and send new versions ‚Äúto float freely‚Äù. </p><br><h3 id="nashi-dni-chto-my-sdelali-chtoby-zhit-luchshe">  Our days: what have we done to live better </h3><br><h4 id="sozdanie-pervyh-interfeysov">  Creation of the first interfaces </h4><br><p><img src="https://habrastorage.org/webt/59/ca/4c/59ca4c23367b2396254275.png"></p><br><p>  To solve the problem with custom documents, we first of all made an interface in which the product manager can upload a new version of the text through a special form.  The changes immediately go to the translator's interface, which they use to translate both the main site and the application.  ‚ÄìSo we centralized the work of translators and reduced the number of custom entities. </p><br><p>  In the same interface, you can watch and progress in all languages ‚Äã‚Äãfor each application.  Moreover, all translated texts also automatically fall into this interface.  You no longer have to rush through a large document in search of the desired localization, and the number of errors due to the notorious human factor has noticeably decreased. </p><br><p>  This was the first stage of automation.  We have greatly simplified the lives of translators, product managers and release engineers.  But we still had to copy all the texts in iTunes Connect. </p><br><h4 id="avtomatizaciya-podgotovki-stora">  Automation of preparation </h4><br><p><img src="https://habrastorage.org/webt/59/ca/4c/59ca4c23666af699557145.png"></p><br><p>  At one point, a new tool loomed on the market, positioned as making life easier for developers of iOS applications ‚Äî <a href="https://fastlane.tools/">fastlane</a> .  We immediately started testing it.  But at that time it was, unfortunately, a very raw product: there were a lot of errors and script crashes almost due to the phase of the moon.  Nevertheless, he opened up many opportunities. </p><br><p>  In short, the fastlane potentially allows you to automate almost all the work from compilation to release the application to end users: </p><br><ul><li>  certificate generation ( <a href="https://github.com/fastlane/fastlane/tree/master/cert">Cert</a> ), </li><li>  test user management ( <a href="https://github.com/fastlane/fastlane/tree/master/pilot">Pilot</a> ), </li><li>  application build ( <a href="https://github.com/fastlane/fastlane/tree/master/gym">Gym</a> ), </li><li>  preparation for release ( <a href="https://github.com/fastlane/fastlane/tree/master/deliver">Deliver</a> ), </li><li>  the release itself and a whole lot more. </li></ul><br><p>  The appearance of this tool was all the more relevant because at that time we already had thoughts to write something similar on our own.  But, as it happens, we didn‚Äôt get a hand and there was no time, because, in addition to iOS, we released apps for Android, Windows Phone, BlackBerry, Xiaomi and Opera and simultaneously worked on the desktop version.  And at the same time it was necessary to support, improve and fix the flow of development, testing, deployment.  But we started taking steps in this direction. </p><br><p>  First of all, we taught our interface to unload all localizations of text assets, arranged in folders and files, in a single archive that can be used by fastlane. </p><br><p>  Next, a script was written that prepared the file structure, initialized Deliver (a component of fastlane) repository, downloaded all localizations from our interface, put them where it should be and initiated the download to iTunes Connect through the same Deliver. </p><br><p>  This script could be used by any product manager or tester, not just a release engineer.  But the biggest advantage was that with the help of this script we reduced the time for preparing the store from half an hour to an hour to thirty seconds to a minute.  Moreover, it allowed reducing errors due to the human factor to an absolute minimum. </p><br><p> After that, we thought that not every version needs a beautiful text. What's new, and every time writing bug fixes is not cool.  Then we asked product managers to write 15 variants of standard texts, brought them into our interface (that is, they became possible to change, add to, delete without our team), and then taught our interface to replace the former text version What's new with one of the default options and set up ratification. </p><br><p>  Now, if we do not have a very large release with new features and large-scale changes, we simply use one of the default previously translated texts.  According to statistics, only one of ten to fifteen releases requires a lot of beautiful text.  For other cases, the use of the default option (seemingly trivial) significantly saves the time and effort of all participants in the process. </p><br><p>  It is also worth noting that Apple has a <a href="https://developer.apple.com/testflight">TestFlight</a> component.  It allows you to test new versions of the application on selected test users.  After uploading a binary file there, it is in process for both the beta release and the main one.  We do this immediately after the application is assembled, so that it has time to process itself before we are ready for release, which significantly reduces the waiting time for processing.  That is, we save another half hour ‚Äì hour. </p><br><h4 id="avtomatizaciya-monitoringa-progressa">  Automation of progress monitoring </h4><br><p><img src="https://habrastorage.org/webt/59/ca/4c/59ca4c2358f42214618529.png"></p><br><p>  At the next stage, we decided to eliminate the problem of inconvenient and long-term monitoring of progress.  At this point, Apple has significantly accelerated the review process: if earlier it took about five days to wait for the review, now it has taken only a couple of days.  The smallest waiting period in our memory is a little less than a day (about twenty hours). </p><br><p>  At that time, a custom script was already written that went to iTunes Connect with a curl and monitored application statuses.  But because of the device site and the need to change the active development team (we also have many applications) in iTunes Connect, and also because of the periodic changes to the site, anything and anytime could break.  Actually, that happened from time to time.  In general, this option did not suit us due to the lack of time and hands for modernization, fixes and support. </p><br><p>  Then it was decided to use the same magical fastlane.  Fortunately, by that time it had become much more reliable and convenient to use.  We wrote a script that every half an hour goes through the fastlane-Spaceship library in iTunes Connect, collects statistics on the status and active versions of all our applications and adds the results to the database.  Based on this statistics, we wrote a user-friendly interface for product managers, where they can monitor the progress of the application from release preparation to release itself almost in real time, and also set up notifications and additional mailings to responsible employees. </p><br><p><img src="https://habrastorage.org/webt/59/ca/4c/59ca4c23924c2857573780.png"></p><br><p>  Additionally, we made stickers on the page with a list of active builds with indicators for the release life cycle: </p><br><ul><li>  Creating a release branch in the Git repository and testing. </li><li>  Preparing the stack for the upcoming release of the new version of the application. </li><li>  App submission and Apple review pending. </li><li>  If there are problems (rejections), then their conclusion. </li><li>  Successful completion of review of all applications and waiting for release. </li><li>  Successful release of all applications. </li></ul><br><p><img src="https://habrastorage.org/webt/59/ca/4c/59ca4c23765a4644095554.png"></p><br><p>  In addition to the obvious convenience for all participants in the development and testing processes, it allowed other teams to receive accurate dates for changing statuses, releases, problems, etc. The search for causes and the study of problems for absolutely all Badoo teams were also simplified. </p><br><p>  So, now on one interface page, anyone can see the current progress in the release of absolutely all of our applications and the full history of all releases since the start of monitoring statuses and versions.  And all this with exact dates of status changes, versions, etc. In the future, this will allow us to upload detailed statistics: how the time of a full release cycle for a month or year has changed, for example.  And, of course, to make beautiful graphics with time, quantity, frequency - who does not like graphics! </p><br><h3 id="chto-v-itoge">  What is the result? </h3><br><p><img src="https://habrastorage.org/webt/59/ca/4c/59ca4c23883d2307297159.png"></p><br><ol><li>  The time spent on preparing and submitting one application was reduced (from an hour or two to (ideally) one or two minutes. </li><li>  Manual work has been reduced to practically launching a single script. </li><li>  A convenient system for monitoring the progress of the release from creating a release branch in the repository to the release of the application in the store has been developed. </li><li>  It became possible to collect detailed statistics on the releases of all our applications and each separately. </li><li>  Simplified the life of product managers, release engineers and translators. </li><li>  Practically any participant can now make releases. </li><li>  The process is almost completely integrated into the company's overall flow. </li><li>  Our hands are completely free to upgrade release processes at other sites. </li><li>  Almost complete care from manual work in the iTunes Connect web interface. </li></ol><br><h3 id="plany-na-buduschee">  Future plans </h3><br><p>  We did a great job.  But there are a few things that are being actively developed now and are in the plans for the near future. </p><br><p>  Firstly, I want to make a convenient interface for filling localized screenshots with product managers.  Due to the nature of such assets and the human factor, it is very difficult to automate completely.  Fortunately, screenshots are rarely updated. </p><br><p>  Secondly, I want to bring this whole process from launching a script to a release engineer or product manager to a single button in the interface by any participating participant in the process, which all QA and product managers use in one way or another.  One click - and everything is ready for release!  Lepote! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/338760/">https://habr.com/ru/post/338760/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338742/index.html">Hackathon from ABBYY</a></li>
<li><a href="../338744/index.html">Reamp library: pain killer for your Android applications</a></li>
<li><a href="../338746/index.html">Hosting for a startup: designer, clouds or your own hardware?</a></li>
<li><a href="../338752/index.html">The saga of the Gulf Stream and the level of information security in a large security company</a></li>
<li><a href="../338758/index.html">How Alexey Moiseenkov reached Prisma and went further</a></li>
<li><a href="../338762/index.html">Data geometry 3. Scalar product of pairs</a></li>
<li><a href="../338764/index.html">Making MitM using openssl on Android</a></li>
<li><a href="../338766/index.html">Options in Swift</a></li>
<li><a href="../338770/index.html">Stream API & ForkJoinPool</a></li>
<li><a href="../338772/index.html">Mobile applications: what is the 2017 holiday season and how to make the most of it?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>