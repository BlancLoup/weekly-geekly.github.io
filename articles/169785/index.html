<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Examples of generating and sending Email using Cach√© DBMS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Often there is a need to automatically generate and send emails based on data from the database. These can be various reports with tables, diagrams or...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Examples of generating and sending Email using Cach√© DBMS</h1><div class="post__text post__text-html js-mediator-article">  Often there is a need to automatically generate and send emails based on data from the database.  These can be various reports with tables, diagrams or notifications about the occurrence of some events. <br>  All this can be implemented directly in the Cach√© DBMS itself, serving here and as an <s>e-mail</s> application server. <br><br>  Next, consider the following examples: <br><ul><li>  creating a text letter </li><li>  HTML letter creation </li><li>  add attachments </li><li>  adding images to the body of the letter </li><li>  other examples </li></ul><a name="habracut"></a><br>  There are several <a href="">% Net</a> package classes for working with <a href="">mail</a> . <br>  The documentation describes in some detail the work with email, so we will immediately start the examples. <br><br><h4>  Plain text letter </h4><br><blockquote>  <font color="#0000ff">#dim</font> <font color="#800000">ex</font> <font color="#0000ff">As</font> <font color="#008080">% Exception.SystemException</font> <font color="#008080"><br></font>  <font color="#0000ff">try</font> <font color="#800080">{</font> <font color="#800080">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </font>  <font color="#0000ff">set</font> <font color="#800000">msg</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% Net.MailMessage</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Subject</font> <font color="#000000">=</font> <font color="#008000">"Email subject"</font> <font color="#008000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">From</font> <font color="#000000">=</font> <font color="#008000">"from@domain.com"</font> <font color="#008000"><br><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">To</font> <font color="#000000">.</font>  <font color="#0000ff">Insert</font> <font color="#000000">(</font> <font color="#008000">"to@domain.com"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"Hi, Habr!"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">smtp</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% Net.SMTP</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">smtp</font> <font color="#000000">.</font>  <font color="#0000ff">smtpserver</font> <font color="#000000">=</font> <font color="#008000">"123.145.167.189"</font> <font color="#008000"><br><br></font>  <font color="#0000ff">$$$ ThrowOnError</font> <font color="#000000">(</font> <font color="#800000">smtp</font> <font color="#000000">.</font> <font color="#0000ff">Send</font> <font color="#000000">(</font> <font color="#800000">msg</font> <font color="#000000">))</font> <font color="#000000"><br><br></font>  <font color="#800080">}</font> <font color="#0000ff">catch</font> <font color="#800000">ex</font> <font color="#800080">{</font> <font color="#800080"><br></font>  <font color="#0000ff">write $ system</font> <font color="#008080">.Status</font> <font color="#000000">.</font>  <font color="#0000ff">GetErrorText</font> <font color="#000000">(</font> <font color="#800000">ex</font> <font color="#000000">.</font> <font color="#0000ff">AsStatus</font> <font color="#000000">(),</font> <font color="#008000">"ru"</font> <font color="#000000">) ,!</font> <font color="#000000"><br></font>  <font color="#800080">}</font> </blockquote><br>  Since the Unicode version of Cach√© was used for the tests, the letter encoding is by default equal to utf-8, which suits us perfectly. <br>  If you have an 8-bit version, you need to additionally set the desired encoding. <br>  For example: <br>  <font color="#0000ff">set</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Charset</font> <font color="#000000">=</font> <font color="#008000">"utf-8"</font> <br><br><h4>  Letter headers (importance, tagging, etc.) </h4><br>  Add to the example above the following lines: <br><blockquote>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Headers</font> <font color="#000000">.</font>  <font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#008000">"Company-Confidential"</font> <font color="#000000">,</font> <font color="#008000">"Sensitivity"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Headers</font> <font color="#000000">.</font>  <font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#008000">"Low"</font> <font color="#000000">,</font> <font color="#008000">"X-Priority"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Headers</font> <font color="#000000">.</font>  <font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#008000">"Low"</font> <font color="#000000">,</font> <font color="#008000">"X-MSMail-Priority"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Headers</font> <font color="#000000">.</font>  <font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#008000">"Low"</font> <font color="#000000">,</font> <font color="#008000">"Importance"</font> <font color="#000000">)</font> </blockquote><br>  Similarly, you can add other headers to your letters. <br>  The following values ‚Äã‚Äãare available for the <b>Sensitivity</b> header (mark): <br><ul><li>  <i>Normal</i> - normal </li><li>  <i>Personal</i> - personal </li><li>  <i>Private</i> - private </li><li>  <i>Company-Confidential</i> - <abbr title="For administrative use">DSP</abbr> </li></ul><br>  The following values ‚Äã‚Äãor their numeric codes are available for <b>X-Priority</b> , <b>X-MSMail-Priority</b> and <b>Importance</b> (importance): <br><ul><li>  <i>Low</i> - low (5) </li><li>  <i>Normal</i> - Normal (3) </li><li>  <i>High</i> - high (1) </li></ul><br><h4>  SMTP server authentication </h4><br>  If the SMTP server requires authentication, then you need to use the <b>% Net.Authenticator</b> class: <br><blockquote>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">To</font> <font color="#000000">.</font>  <font color="#0000ff">Insert</font> <font color="#000000">(</font> <font color="#008000">"to@domain.com"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Cc</font> <font color="#000000">.</font>  <font color="#0000ff">Insert</font> <font color="#000000">(</font> <font color="#008000">"cc@domain.com"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Bcc</font> <font color="#000000">.</font>  <font color="#0000ff">Insert</font> <font color="#000000">(</font> <font color="#008000">"bcc@domain.com"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"Hi, Habr!"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">auth</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% Net.Authenticator</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">auth</font> <font color="#000000">.</font>  <font color="#0000ff">UserName</font> <font color="#000000">=</font> <font color="#008000">"login"</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">auth</font> <font color="#000000">.</font>  <font color="#0000ff">Password</font> <font color="#000000">=</font> <font color="#008000">"password"</font> <font color="#008000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">smtp</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% Net.SMTP</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">smtp</font> <font color="#000000">.</font>  <font color="#0000ff">smtpserver</font> <font color="#000000">=</font> <font color="#008000">"123.145.167.189"</font> <font color="#008000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">smtp</font> <font color="#000000">.</font>  <font color="#0000ff">authenticator</font> <font color="#000000">=</font> <font color="#800000">auth</font> </blockquote><br><h4>  Letter with attachment </h4><br>  There are several methods for adding attachments: <i>AttachFile</i> , <i>AttachStream</i> , <i>AttachEmail</i> , <i>AttachNewMessage</i> . <br><br>  Add a photo file to our example: <br>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">AttachFile</font> <font color="#000000">(</font> <font color="#008000">"c: \ Photo"</font> <font color="#000000">,</font> <font color="#008000">"test.jpg"</font> <font color="#000000">)</font> <br><br><h4>  HTML email </h4><br>  To do this, assign the true property <b>IsHTML</b> : <br><blockquote>  <font color="#008000">// ...</font> <font color="#008000"><br><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">To</font> <font color="#000000">.</font>  <font color="#0000ff">Insert</font> <font color="#000000">(</font> <font color="#008000">"to@domain.com"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">IsHTML</font> <font color="#000000">= 1</font> <font color="#000000"><br><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;b&gt; Hello &lt;/ b&gt;, &lt;font color = 'red'&gt; Habr &lt;/ font&gt;!"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;br/&gt; Click &lt;a href='http://intersystems.ru/cache/index.html'&gt; Cach√© &lt;/a&gt; to go to the &lt;u&gt; InterSystems &lt;/ u&gt; website."</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">smtp</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% Net.SMTP</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br><br></font>  <font color="#008000">// ...</font> </blockquote><br><h4>  The image in the body of the letter </h4><br><h5>  Option 1: multiple images from files </h5><br><blockquote>  <font color="#008000">// ...</font> <font color="#008000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">IsHTML</font> <font color="#000000">= 1</font> <font color="#000000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">MultiPartType</font> <font color="#000000">=</font> <font color="#008000">"related"</font> <font color="#008000"><br><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">AttachFile</font> <font color="#000000">(</font> <font color="#008000">"c: \ Photo"</font> <font color="#000000">,</font> <font color="#008000">"test1.jpg"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">AttachFile</font> <font color="#000000">(</font> <font color="#008000">"c: \ Photo"</font> <font color="#000000">,</font> <font color="#008000">"test2.gif"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">part</font> <font color="#000000">=</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Parts</font> <font color="#000000">.</font>  <font color="#0000ff">GetAt</font> <font color="#000000">(1)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">part</font> <font color="#000000">.</font>  <font color="#0000ff">ContentType</font> <font color="#000000">=</font> <font color="#008000">"image / jpeg"</font> <font color="#008000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">part</font> <font color="#000000">.</font>  <font color="#0000ff">Headers</font> <font color="#000000">.</font>  <font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#008000">"id1"</font> <font color="#000000">,</font> <font color="#008000">"Content-ID"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">part</font> <font color="#000000">=</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Parts</font> <font color="#000000">.</font>  <font color="#0000ff">GetAt</font> <font color="#000000">(2)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">part</font> <font color="#000000">.</font>  <font color="#0000ff">ContentType</font> <font color="#000000">=</font> <font color="#008000">"image / gif"</font> <font color="#008000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">part</font> <font color="#000000">.</font>  <font color="#0000ff">Headers</font> <font color="#000000">.</font>  <font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#008000">"id2"</font> <font color="#000000">,</font> <font color="#008000">"Content-ID"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;b&gt; Hello &lt;/ b&gt;, &lt;font color = 'red'&gt; Habr &lt;/ font&gt;!"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;br/&gt; &lt;img src = 'cid: id1'&gt;"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;br/&gt; &lt;img src = 'cid: id2'&gt;"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#008000">// ...</font> </blockquote><br><h5>  Option 2: image from the "memory" </h5><br><blockquote>  <font color="#008000">// ...</font> <font color="#008000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">IsHTML</font> <font color="#000000">=</font> <font color="#0000ff">$$$ YES</font> <font color="#0000ff"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">MultiPartType</font> <font color="#000000">=</font> <font color="#008000">"related"</font> <font color="#008000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">stream</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% GlobalBinaryStream</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">stream</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#0000ff">$ system</font> <font color="#008080">.Ecryption</font> <font color="#000000">.</font> <font color="#0000ff">Base64Decode</font> <font color="#000000">(</font> <font color="#000000"><br></font>  <font color="#008000">"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8 / 9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"UUlEQVR42lWTWUwTURSGaUtIKY5QweISTUzceDGu0Rj1xURjTNQEE + ODGn0hPhBEQdqZztahBbrA"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"tFih1Fprh9IBiVLLErZSU7BUoS7VqNH44ovx0S0ovdfO4Ez04cw9Ofec7 / 5zzr15NEnkUxSVFx8O"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"bZ1x7nzHN6z9nOhnzOFwWCnECcKoEFbBRrrp6iF / XRvD0BoplkdTuAiIhtt3P3Fu + jJlKlkM1WoX"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"LFjVeSnpXrC94gV3ciJp1X0L1K7 + NtDfvXdpj1TmmUwm8QTfLa867T + ceWTSwO5r5b87XNaDEoBr"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"v3p2Ai + AU1Qh5OiDGS4UXi4roAisQHBiYfJS2obAVPMyELYcGxViOIaKcLaNLXzadej5nBUBPXW6"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"hdYW0z4RQOYUXK2tUfr8QeXL0Kn4JKEBk7QWdtrrLggJJEmoCBxVCf50qIaaa0HABFkEPZaLNnGf"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"wPNFGV0u05Y554bvMQoBPLbxs9t9QydJpHP / KayRbsf + pG1NdgTTgDuGXa8dbS41ZtArxaQYT1Wl"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"HVqYaloGOcvJIan4X2MdViTl3vExbS + GPfXlvzzutj1LPch9HrYea59t0YIRtAAO + PQuIWYwNKik"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"Yty41Iuk / 3TvMzsCB9HcQR7msgzgjZs7Z5rLQPR6PojeJW2d3oDCoG / IlwAYqlexbp / i9eB19ziu"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"BoMoAlrR03YZ0G8 + 0JFhS8EjuhD6zWfuCTEjppcBOKYX1bwaqA5MM2oYZ4pBy7XjrAyY7sPqU01F"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"cNZW / jtwZeXXVpt5u1RM4JhYzHFBddqz5 / 28fUU2NwngtVUbZUCE79o6x67 / MYiXLiSbS8D9xp1v"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"I7znkLvDK07A5 / MiT7mzdxMMAsdMqxaiWDHkgzePigBUXy9KTfdWeVKNSjjPrvv5uKkYxszIIXX7"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"eDLeVfkgbt30bt5eAlOOtT9nLRrI03szrOumOtcb4SrTSj2KKfr4nuUZ7kR8HFPAYXLlYqxRl43T"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"GjjTWAhHCC1MNK / + lWA0cJLRgfsh95G / N1H136z7 + BCSuHMuMEGVLo4a1XCKKcuO0WXZBw1FcNig"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"hmPWbe8jIeeJpdFiCrkHguWUyM92NBKseBut8T92bfsw66z49IyrHH2T5CvlqeCYUvL / ANIZ7 + oh"</font> <font color="#000000">_</font> <font color="#0000ff">$$$ NL</font> <font color="#000000">_</font> <font color="#000000"><br></font>  <font color="#008000">"XSdWAAAAAEElFTkSuQmCC"</font> <font color="#000000">))</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">AttachStream</font> <font color="#000000">(</font> <font color="#800000">stream</font> <font color="#000000">,</font> <font color="#008000">"id1"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">part</font> <font color="#000000">=</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">Parts</font> <font color="#000000">.</font>  <font color="#0000ff">GetAt</font> <font color="#000000">(1)</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">part</font> <font color="#000000">.</font>  <font color="#0000ff">ContentType</font> <font color="#000000">=</font> <font color="#008000">"image / png"</font> <font color="#008000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">part</font> <font color="#000000">.</font>  <font color="#0000ff">Headers</font> <font color="#000000">.</font>  <font color="#0000ff">SetAt</font> <font color="#000000">(</font> <font color="#008000">"id1"</font> <font color="#000000">,</font> <font color="#008000">"Content-ID"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;html&gt; &lt;body&gt;"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;b&gt; Hello &lt;/ b&gt;, &amp; nbsp; &lt;font color = 'red'&gt; Habr &lt;/ font&gt;!"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;ul&gt; &lt;li&gt; asd &lt;/ li&gt; &lt;li&gt; qwe &lt;/ li&gt; &lt;li&gt; zxc &lt;/ li&gt; &lt;/ ul&gt;"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;img src = 'cid: id1'&gt;"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;br&gt; &lt;span style = 'color: red; font-weight: bold'&gt; B &lt;/ span&gt; un &lt;span style = 'color: green; font-weight: bold'&gt; ƒÉ &lt;/ span&gt; ziua ! "</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;br&gt; &lt;table border = 1 cellpadding = 2 cellspacing = 2&gt; &lt;tr BGCOLOR = # 22ffdd&gt; &lt;td&gt; Column # 1 &lt;/ td&gt; &lt;td&gt; Column # 2 &lt;/ td&gt; &lt;/ tr&gt; &lt; tr&gt; &lt;td&gt; Row (1,1) &lt;/ td&gt; &lt;td BGCOLOR = # ddff22&gt; Row (1,2) &lt;/ td&gt; &lt;/ tr&gt; &lt;tr&gt; &lt;td&gt; Row (2,1) &lt;/ td&gt; &lt;td&gt; Row (2.2) &lt;/ td&gt; &lt;/ tr&gt; &lt;/ table&gt; "</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">msg</font> <font color="#000000">.</font>  <font color="#0000ff">TextData</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">"&lt;/ body&gt; &lt;/ html&gt;"</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#008000">// ...</font> </blockquote><hr>  <a href="http://db.tt/kxrRnoNr">Download the</a> source class with all the examples. </div><p>Source: <a href="https://habr.com/ru/post/169785/">https://habr.com/ru/post/169785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../169773/index.html">PayOnline in Silicon Valley - or how we studied at Founders Bootcamp Silicon Valley</a></li>
<li><a href="../169775/index.html">Making audio calls from web and mobile clients (RTMP, RTMFP, WebRTC)</a></li>
<li><a href="../169777/index.html">An example of convenient organization of split (A / B) testing on the server side</a></li>
<li><a href="../169779/index.html">PyCon for students</a></li>
<li><a href="../169783/index.html">Logical levels of training and psychotherapy</a></li>
<li><a href="../169789/index.html">Yandex.Money introduced one-time SMS passwords</a></li>
<li><a href="../169791/index.html">MSc in Technical University Munich</a></li>
<li><a href="../169793/index.html">How we ran online tech support</a></li>
<li><a href="../169795/index.html">Apple Macintosh Performa 475</a></li>
<li><a href="../169797/index.html">6 ways to stand out in the crowded app market</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>