<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Expression compiler</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I recently had the need to evaluate expressions. The expression is represented as a string and can contain variable names, integers, string constants,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Expression compiler</h1><div class="post__text post__text-html js-mediator-article"> I recently had the need to evaluate expressions.  The expression is represented as a string and can contain variable names, integers, string constants, and any operations on them. <br><br>  Example: <br>  expression: "x + 10 == 5 * y / (1 + z * 2)"; <br>  you must be able to evaluate this expression for any x, y, and z values. <br><br>  And of course, the priorities of the operators must be taken into account. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For the solution, you need to make a compiler, which builds an ‚ÄúComputable Expression‚Äù object on the line.  This object will have a ‚Äúcalculate for these variable values‚Äù method. <br><br>  Solution in Java, but can be easily translated into other languages. <br><br><a name="habracut"></a><br><br>  First about what we get at the output after compiling the string.  This is an Expression object (expression) with the execute method (Map vars).  The object is a tree, in nodes the operators on the leaves are variables or constants.  By example, I think everything is clear: <br><br>  "X + 1 &lt;y / (1 + 2)" =&gt; <br><br> <code>[ "&lt;" ] <br> [ "+" ] <br> [ x ] <br> [ 1 ] <br> [ "/" ] <br> [ y ] <br> [ "+" ] <br> [ 1 ] <br> [ 2 ] <br></code> <br><br>  The nodes of this tree are: <br><ul><li>  <b>Binary</b> - operator and two operands (+, -, ==, etc.) </li><li>  <b>Unary</b> - operator and one operand (negation and unary minus) </li><li>  <b>Variable</b> - leaf node with variable name </li><li>  <b>Line</b> </li><li>  <b>Number</b> </li></ul><br><br>  To calculate you need to recursively bypass the tree by calculating the values ‚Äã‚Äãin the nodes.  For a variable, the string and the number of calculations are trivial, for the binary and unary nodes, you must first calculate the values ‚Äã‚Äãof the operands and simply apply the operator to them. <br><br>  Now the most interesting is compilation. <br>  I will try to tell it is clear for habra people unfamiliar with finite automata and grammars. <br>  For clarity, let us examine the simplest expressions, which can contain only numbers, ‚Äú+‚Äù, ‚Äú-‚Äù signs and brackets. For example, 10 - (3 + 2 - (10 - 5)). <br><br>  We write formally: <br><br> <code>:  [+ / - ] * <br> :  | () <br></code> <br><br>  Pronounced like this: <br>  <b>The expression</b> is a term, plus or minus term (this ‚Äúplus or minus term‚Äù can be repeated from zero to any number of times). <br>  <b>The term</b> is a number or expression in brackets. <br><br>  The processing algorithm looking at the formal record is as follows: <br><br> <code>: <br> X1 = () <br> <br>    ¬´+¬ª  ¬´-¬ª <br> X2 = (); <br> X1 =  ( ¬´+¬ª  ¬´-¬ª, X1, X2) <br>   <br>  X1 <br>  <br> <br> : <br>    '(' <br> X = () <br>  X <br>  <br>   <br>  <br> <br></code> <br><br>  The following compiler uses a more complex grammar: <br><br> <code>S0 : S1 [ || S1] * <br> S1: S2 [ &amp;&amp; S2] * <br> S2: S3 | ! S3 <br> S3: S4 | S4 == S4 | S4 != S4 | S4 &lt;= S4 | S4 &lt; S4 | S4 &gt;= S4 | S4 &gt; S4 <br> S4: S5 [¬´+¬ª  ¬´-¬ª S5] * <br> S5: S6 [¬´*¬ª  ¬´.¬ª S6] * <br> S6: 'string' | var | number | null | (S0) | - var | - number | - (S0) <br></code> <br><br>  And the actual code: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">import java.util.Map; <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">*  </font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">abstract</font> <font color="#0000ff">class</font> Expression { <br> <br> <font color="#008000">/**       */</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">abstract</font> Object execute(Map&lt; <font color="#2B91AF">String</font> , Object&gt; values) throws Exception; <br> <br> <br> <font color="#008000">/**   ‚Äî ¬´¬ª */</font> <br> <font color="#0000ff">static</font> <font color="#0000ff">class</font> Num extends Expression { <br> <font color="#0000ff">private</font> final <font color="#0000ff">long</font> <font color="#0000ff">value</font> ; <br> <br> <font color="#0000ff">public</font> Num( <font color="#0000ff">long</font> x) { <br> <font color="#0000ff">value</font> = x; <br> } <br> <br> @Override <br> <font color="#0000ff">public</font> Object execute(Map&lt; <font color="#2B91AF">String</font> , Object&gt; values) { <br> <font color="#0000ff">return</font> <font color="#0000ff">value</font> ; <br> } <br> } <br> <br> <font color="#008000">/**   ‚Äî ¬´¬ª */</font> <br> <font color="#0000ff">static</font> <font color="#0000ff">class</font> Str extends Expression { <br> <font color="#0000ff">private</font> final <font color="#2B91AF">String</font> <font color="#0000ff">value</font> ; <br> <br> <font color="#0000ff">public</font> Str( <font color="#2B91AF">String</font> x) { <br> <font color="#0000ff">value</font> = x; <br> } <br> <br> @Override <br> <font color="#0000ff">public</font> Object execute(Map&lt; <font color="#2B91AF">String</font> , Object&gt; values) { <br> <font color="#0000ff">return</font> <font color="#0000ff">value</font> ; <br> } <br> } <br> <br> <font color="#008000">/**   ‚Äî ¬´¬ª */</font> <br> <font color="#0000ff">static</font> <font color="#0000ff">class</font> Var extends Expression { <br> <font color="#0000ff">private</font> final <font color="#2B91AF">String</font> name; <br> <br> <font color="#0000ff">public</font> Var( <font color="#2B91AF">String</font> name) { <br> <font color="#0000ff">this</font> .name = name; <br> } <br> <br> @Override <br> <font color="#0000ff">public</font> Object execute(Map&lt; <font color="#2B91AF">String</font> , Object&gt; values) { <br> <font color="#0000ff">return</font> values. <font color="#0000ff">get</font> (name); <br> } <br> } <br> <br> <br> <font color="#008000">/**   ‚Äî ¬´ ¬ª */</font> <br> <font color="#0000ff">static</font> <font color="#0000ff">class</font> Unary extends Expression { <br> <font color="#0000ff">private</font> final Expression expr; <br> <font color="#0000ff">private</font> final boolean not; <br> <br> <font color="#0000ff">public</font> Unary(Expression e, <font color="#2B91AF">String</font> oper) { <br> expr = e; <br> not = <font color="#A31515">"!"</font> .equals(oper); <br> } <br> <br> @Override <br> <font color="#0000ff">public</font> Object execute(Map&lt; <font color="#2B91AF">String</font> , Object&gt; values) throws Exception { <br> Object o = expr.execute(values); <br> <font color="#0000ff">if</font> (not) <br> <font color="#0000ff">return</font> !(Boolean)o; <br> <font color="#0000ff">else</font> <br> <font color="#0000ff">return</font> -(Long)o; <br> } <br> } <br> <br> <br> <br> <font color="#008000">/**   ‚Äî ¬´ ¬ª */</font> <br> <font color="#0000ff">static</font> <font color="#0000ff">class</font> Binary extends Expression { <br> <font color="#0000ff">private</font> final Expression x1; <br> <font color="#0000ff">private</font> final Expression x2; <br> <font color="#0000ff">private</font> final <font color="#2B91AF">String</font> op; <br> <br> <font color="#0000ff">public</font> Binary(Expression x1, Expression x2, <font color="#2B91AF">String</font> op) { <br> <font color="#0000ff">this</font> .x1 = x1; <br> <font color="#0000ff">this</font> .x2 = x2; <br> <font color="#0000ff">this</font> .op = op; <br> } <br> <br> @Override <br> <font color="#0000ff">public</font> Object execute(Map&lt; <font color="#2B91AF">String</font> , Object&gt; values) throws Exception { <br> Object o1 = x1.execute(values); <br> Object o2 = x2.execute(values); <br> <br> Class type = commonType(o1, o2); <br> <br> <font color="#0000ff">if</font> (type == <font color="#2B91AF">String</font> . <font color="#0000ff">class</font> ) <br> <font color="#0000ff">return</font> execStr(o1 != <font color="#0000ff">null</font> ? o1.toString() : <font color="#0000ff">null</font> , o2 != <font color="#0000ff">null</font> ? o2.toString() : <font color="#0000ff">null</font> ); <br> <font color="#0000ff">else</font> <font color="#0000ff">if</font> (type == Long. <font color="#0000ff">class</font> ) <br> <font color="#0000ff">return</font> execNum((Long)o1, (Long)o2); <br> <font color="#0000ff">else</font> <br> <font color="#0000ff">return</font> execBool((Boolean)o1, (Boolean)o2); <br> } <br> <br> <font color="#0000ff">private</font> Class commonType(Object o1, Object o2) { <br> <font color="#0000ff">if</font> (o1 == <font color="#0000ff">null</font> || o2 == <font color="#0000ff">null</font> || o1 instanceof <font color="#2B91AF">String</font> || o2 instanceof <font color="#2B91AF">String</font> ) <br> <font color="#0000ff">return</font> <font color="#2B91AF">String</font> . <font color="#0000ff">class</font> ; <br> <font color="#0000ff">if</font> (o1 instanceof Long &amp;&amp; o2 instanceof Long) <br> <font color="#0000ff">return</font> Long. <font color="#0000ff">class</font> ; <br> <font color="#0000ff">return</font> Boolean. <font color="#0000ff">class</font> ; <br> } <br> <br> <font color="#0000ff">private</font> Object execStr( <font color="#2B91AF">String</font> s1, <font color="#2B91AF">String</font> s2) throws Exception { <br> <font color="#0000ff">if</font> ( <font color="#A31515">"=="</font> .equals(op)) <br> <font color="#0000ff">return</font> (Boolean)(s1 == <font color="#0000ff">null</font> ? s2 == <font color="#0000ff">null</font> : s1.equals(s2)); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"!="</font> .equals(op)) <br> <font color="#0000ff">return</font> (Boolean)(s1 == <font color="#0000ff">null</font> ? s2 != <font color="#0000ff">null</font> : !s1.equals(s2)); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"+"</font> .equals(op)) <br> <font color="#0000ff">return</font> ( <font color="#2B91AF">String</font> )(s1 == <font color="#0000ff">null</font> ? s2 : s1 + (s2 == <font color="#0000ff">null</font> ? <font color="#A31515">""</font> : s2)); <br> <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#A31515">"Illegal String operator: "</font> + op); <br> } <br> <br> <font color="#0000ff">private</font> Object execBool(boolean q1, boolean q2) throws Exception { <br> <font color="#0000ff">if</font> ( <font color="#A31515">"&amp;&amp;"</font> .equals(op)) <br> <font color="#0000ff">return</font> q1 &amp;&amp; q2; <br> <font color="#0000ff">if</font> ( <font color="#A31515">"||"</font> .equals(op)) <br> <font color="#0000ff">return</font> q1 || q2; <br> <font color="#0000ff">if</font> ( <font color="#A31515">"=="</font> .equals(op)) <br> <font color="#0000ff">return</font> q1 == q2; <br> <font color="#0000ff">if</font> ( <font color="#A31515">"!="</font> .equals(op)) <br> <font color="#0000ff">return</font> q1 != q2; <br> <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#A31515">"Illegal Boolean operator: "</font> + op); <br> } <br> <br> <font color="#0000ff">private</font> Object execNum( <font color="#0000ff">long</font> n1, <font color="#0000ff">long</font> n2) throws Exception { <br> <font color="#0000ff">if</font> ( <font color="#A31515">"=="</font> .equals(op)) <br> <font color="#0000ff">return</font> (Boolean)(n1 == n2); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"!="</font> .equals(op)) <br> <font color="#0000ff">return</font> (Boolean)(n1 != n2); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"&lt;"</font> .equals(op)) <br> <font color="#0000ff">return</font> (Boolean)(n1 &lt; n2); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"&lt;="</font> .equals(op)) <br> <font color="#0000ff">return</font> (Boolean)(n1 &lt;= n2); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"&gt;"</font> .equals(op)) <br> <font color="#0000ff">return</font> (Boolean)(n1 &gt; n2); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"&gt;="</font> .equals(op)) <br> <font color="#0000ff">return</font> (Boolean)(n1 &gt;= n2); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"+"</font> .equals(op)) <br> <font color="#0000ff">return</font> (Long)(n1 + n2); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"-"</font> .equals(op)) <br> <font color="#0000ff">return</font> (Long)(n1 - n2); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"*"</font> .equals(op)) <br> <font color="#0000ff">return</font> (Long)(n1 * n2); <br> <font color="#0000ff">if</font> ( <font color="#A31515">"/"</font> .equals(op)) <br> <font color="#0000ff">return</font> (Long)(n1 / n2); <br> <br> <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#A31515">"Illegal Long operator: "</font> + op); <br> } <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  And the compiler itself: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">import java.util.HashMap; <br> import java.util.Map; <br> <br> import org.junit.Test; <br> import <font color="#0000ff">static</font> org.junit.Assert.assertTrue; <br> <br> <font color="#008000">/**   */</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> ExpressionBuilder { <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">String</font> expression; <font color="#008000">//    </font> <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> p = 0; <font color="#008000">//  </font> <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> Expression build( <font color="#2B91AF">String</font> expression) { <br> ExpressionBuilder builder = <font color="#0000ff">new</font> ExpressionBuilder(expression); <br> builder.skip( <font color="#A31515">" "</font> ); <br> Expression expr = builder.build(0); <br> <font color="#0000ff">return</font> expr; <br> } <br> <br> <font color="#0000ff">private</font> ExpressionBuilder( <font color="#2B91AF">String</font> expression) { <br> <font color="#0000ff">this</font> .expression = expression; <br> } <br> <br> <br> <font color="#008000">/**    */</font> <br> Expression build( <font color="#0000ff">int</font> state) { <br> <font color="#0000ff">if</font> (lastState(state)) { <br> Expression ex = <font color="#0000ff">null</font> ; <br> boolean isMinus = startWith( <font color="#A31515">"-"</font> ); <br> <font color="#0000ff">if</font> (isMinus) <br> skip( <font color="#A31515">"-"</font> ); <br> <br> <font color="#0000ff">if</font> (startWith( <font color="#A31515">"("</font> )) { <br> skip( <font color="#A31515">"("</font> ); <br> ex = build(0); <br> skip( <font color="#A31515">")"</font> ); <br> } <br> <font color="#0000ff">else</font> <br> ex = readSingle(); <br> <font color="#0000ff">if</font> (isMinus) <br> ex = <font color="#0000ff">new</font> Expression.Unary(ex, <font color="#A31515">"-"</font> ); <br> <font color="#0000ff">return</font> ex; <br> } <br> <br> boolean unarNot = state == 2 &amp;&amp; startWith( <font color="#A31515">"!"</font> ); <br> <font color="#0000ff">if</font> (unarNot) <br> skip( <font color="#A31515">"!"</font> ); <br> <br> <font color="#008000">/*    */</font> <br> Expression a1 = build(state+1); <br> <font color="#0000ff">if</font> (unarNot) <br> a1 = <font color="#0000ff">new</font> Expression.Unary(a1, <font color="#A31515">"!"</font> ); <br> <br> <font color="#008000">//   </font> <br> <font color="#2B91AF">String</font> op = <font color="#0000ff">null</font> ; <br> <font color="#0000ff">while</font> ((op = readStateOperator(state)) != <font color="#0000ff">null</font> ) { <br> Expression a2 = build(state + 1); <br> a1 = <font color="#0000ff">new</font> Expression.Binary(a1, a2, op); <br> <br> } <br> <font color="#0000ff">return</font> a1; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#2B91AF">String</font> [][] states = <font color="#0000ff">new</font> <font color="#2B91AF">String</font> [][] { <br> { <font color="#A31515">"||"</font> }, <br> { <font color="#A31515">"&amp;&amp;"</font> }, <br> { <font color="#A31515">"!"</font> }, <br> { <font color="#A31515">"&lt;="</font> , <font color="#A31515">"&gt;="</font> , <font color="#A31515">"=="</font> , <font color="#A31515">"!="</font> , <font color="#A31515">"&lt;"</font> , <font color="#A31515">"&gt;"</font> }, <br> { <font color="#A31515">"+"</font> , <font color="#A31515">"-"</font> }, <br> { <font color="#A31515">"*"</font> , <font color="#A31515">"/"</font> }, <br> <font color="#0000ff">null</font> <br> }; <br> <br> <font color="#0000ff">private</font> boolean lastState( <font color="#0000ff">int</font> s) { <br> <font color="#0000ff">return</font> s+1 &gt;= states.length; <br> } <br> <br> <font color="#0000ff">private</font> boolean startWith( <font color="#2B91AF">String</font> s) { <br> <font color="#0000ff">return</font> expression.startsWith(s, p); <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> skip( <font color="#2B91AF">String</font> s) { <br> <font color="#0000ff">if</font> (startWith(s)) <br> p+= s.length(); <br> <font color="#0000ff">while</font> (p &lt; expression.length() &amp;&amp; expression.charAt(p) == <font color="#A31515">' '</font> ) <br> p++; <br> } <br> <br> <br> <font color="#0000ff">private</font> <font color="#2B91AF">String</font> readStateOperator( <font color="#0000ff">int</font> state) { <br> <font color="#2B91AF">String</font> [] ops = states[state]; <br> <font color="#0000ff">for</font> ( <font color="#2B91AF">String</font> s : ops) { <br> <font color="#0000ff">if</font> (startWith(s)) { <br> skip(s); <br> <font color="#0000ff">return</font> s; <br> } <br> } <br> <font color="#0000ff">return</font> <font color="#0000ff">null</font> ; <br> } <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">*    ""  ( ,   )</font> <br> <font color="#008000">* @return</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">private</font> Expression readSingle() { <br> <font color="#0000ff">int</font> p0 = p; <br> <font color="#008000">//    </font> <br> <font color="#0000ff">if</font> (startWith( <font color="#A31515">"'"</font> ) || startWith( <font color="#A31515">"\""</font> )) { <br> boolean q2 = startWith( <font color="#A31515">"\""</font> ); <br> p = expression.indexOf(q2 ? <font color="#A31515">'"'</font> : <font color="#A31515">'\''</font> , p+1); <br> Expression ex = <font color="#0000ff">new</font> Expression.Str(expression.substring(p0+1, p)); <br> skip(q2 ? <font color="#A31515">"\""</font> : <font color="#A31515">"'"</font> ); <br> <font color="#0000ff">return</font> ex; <br> } <br> <br> <font color="#008000">//     =&gt;   </font> <br> <font color="#0000ff">while</font> (p &lt; expression.length()) { <br> <font color="#0000ff">if</font> (!(Character.isLetterOrDigit(expression.charAt(p)))) <br> <font color="#0000ff">break</font> ; <br> p++; <br> } <br> <br> Expression ex = <font color="#0000ff">null</font> ; <br> <font color="#0000ff">if</font> (p &gt; p0) { <br> <font color="#2B91AF">String</font> s = expression.substring(p0, p); <br> skip( <font color="#A31515">" "</font> ); <br> <font color="#0000ff">try</font> { <br> <font color="#008000">//    </font> <br> <font color="#0000ff">long</font> x = Long.parseLong(s); <br> <font color="#0000ff">return</font> <font color="#0000ff">new</font> Expression.Num(x); <br> } <br> <font color="#0000ff">catch</font> (Exception e){} <br> <br> <font color="#0000ff">if</font> ( <font color="#A31515">"null"</font> .equals(s)) <br> <font color="#0000ff">return</font> <font color="#0000ff">new</font> Expression.Str( <font color="#0000ff">null</font> ); <br> <br> <font color="#008000">//  ,     null ‚Äî  </font> <br> <font color="#0000ff">return</font> <font color="#0000ff">new</font> Expression.Var(s); <br> <br> } <br> <font color="#0000ff">return</font> <font color="#0000ff">null</font> ; <br> } <br> <br> <br> <br> <br> <br> <font color="#008000">//  -</font> <br> <font color="#0000ff">public</font> ExpressionBuilder(){} <br> <br> @Test <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> testBuilder() throws Exception { <br> <font color="#2B91AF">String</font> str = <font color="#A31515">"qwerty"</font> ; <br> <font color="#0000ff">long</font> n1 = 10; <br> <font color="#0000ff">long</font> n2 = 5; <br> <br> Map&lt; <font color="#2B91AF">String</font> , Object&gt; map = <font color="#0000ff">new</font> HashMap&lt; <font color="#2B91AF">String</font> , Object&gt;(); <br> map.put( <font color="#A31515">"str"</font> , <font color="#A31515">"str"</font> ); <br> map.put( <font color="#A31515">"n1"</font> , n1); <br> map.put( <font color="#A31515">"n2"</font> , n2); <br> <br> Expression e = ExpressionBuilder.build( <font color="#A31515">"str != 'qwerty' &amp;&amp; n1 / n2 &gt;= 3 * (n2 + 10 / n1 * (2+3))"</font> ); <br> Boolean a = (Boolean) e.execute(map); <br> Boolean b = ! <font color="#A31515">"qwerty"</font> .equals(str) &amp;&amp; n1 / n2 &gt;= 3 * (n2 + 10 / n1 * (2+3)); <br> assertTrue(a == b); <br> } <br> } <br> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/50139/">https://habr.com/ru/post/50139/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../50130/index.html">All webmord in one. virtualhost and proxy_pass in nginx for home.</a></li>
<li><a href="../50131/index.html">ICQ masquerade as a universal solution to problems with changes in the ICQ protocol</a></li>
<li><a href="../50134/index.html">Apple Macintosh turned 25 years old</a></li>
<li><a href="../50137/index.html">Spell check with Google</a></li>
<li><a href="../50138/index.html">jQuery plugin positioning v1.1</a></li>
<li><a href="../50140/index.html">Introducing FreeSWITCH Part One</a></li>
<li><a href="../50142/index.html">Experienced marketers</a></li>
<li><a href="../50143/index.html">Gentoo + drbd + ocfs2</a></li>
<li><a href="../50147/index.html">HTTP request types and REST philosophy</a></li>
<li><a href="../50148/index.html">25 most dangerous mistakes in programming</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>