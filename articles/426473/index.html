<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Redux architecture. Yes or no?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The author of the material, the translation of which we are publishing today, says that he is part of the Hike messenger team, which deals with new fe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Redux architecture. Yes or no?</h1><div class="post__text post__text-html js-mediator-article">  The author of the material, the translation of which we are publishing today, says that he is part of the <a href="https://hike.in/">Hike</a> messenger team, which deals with new features of the application.  The goal of this team is to translate into reality and explore ideas that users might like.  This means that developers need to act quickly, and that they often have to make changes to the innovations they explore, which are aimed at making the work of users as convenient and enjoyable as possible.  They prefer to conduct their experiments using React Native, as this library speeds up development and allows you to use the same code on different platforms.  In addition, they use the Redux library. <br><br> <a href="https://habr.com/company/ruvds/blog/426473/"><img src="https://habrastorage.org/getpro/habr/post_images/ac1/9ea/879/ac19ea87996279f729fd56933e24c42f.png"></a> <br><a name="habracut"></a><br>  When developers from Hike start working on something new, then, when discussing the architecture of the solution under study, they have several questions: <br><br><ul><li>  This is an experimental possibility that can, as they say, ‚Äúdo not take off,‚Äù and will have to be abandoned.  Is it necessary, given this, to spend time designing an application architecture? </li><li>  The experimental application is just MVP, a minimally viable product that has 1-2 screens and needs to be created as quickly as possible.  Is it worth it, considering this, to contact Redux? </li><li>  How to justify to the product managers the time required to prepare the auxiliary infrastructure of the experimental application? </li></ul><br>  As a matter of fact, Redux helps to find the right answers to all these questions.  The Redux architecture helps to separate the state of the application from React.  It allows you to create a global repository located at the top level of the application and providing state access for all other components. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  <font color="#3AC1EF">Separation of responsibilities</font> </h2><br>  What is a ‚Äúdivision of responsibility‚Äù?  This is what <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D0%25B7%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BE%25D1%2582%25D0%25B2%25D0%25B5%25D1%2582%25D1%2581%25D1%2582%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">Wikipedia</a> says about this: ‚ÄúIn computer science, the division of responsibilities is the process of dividing a computer program into functional blocks that overlap each other‚Äôs functions as little as possible.  In a more general case, the division of responsibilities is the simplification of a single process for solving a problem by dividing it into interacting processes to solve subtasks. ‚Äù <br><br>  The Redux architecture allows you to implement the principle of separation of responsibilities in applications, breaking them into four blocks, presented in the following figure. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aa4/b4f/ca3/aa4b4fca367a26eeaa6d4affecc0eb95.png"><br>  <i><font color="#999999">Redux architecture</font></i> <br><br>  Here is a brief description of these blocks: <br><br><ul><li>  Views or user interface components (UI Components) resemble pure functions (that is, functions that do not change the data passed to them and have some other properties) that are responsible for displaying information on the screen based on the data passed to them from the repository.  They do not change the data directly.  When an event occurs, or if a user interacts with them, they contact the action creators. </li><li>  Action Creators are responsible for creating and dispatching actions. </li><li>  Reducers receive dispatched actions and update the state of the repository. </li><li>  Data Store is responsible for storing application data. </li></ul><br>  Consider the Redux architecture by example. <br><br><h2>  <font color="#3AC1EF">What if different components need the same data?</font> </h2><br>  The Hike app has a screen displaying a list of the user's friends.  At the top of this screen displays information about their number. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/468/074/194/4680741943d6d145443ba5ab97bddb3f.png"><br>  <i><font color="#999999">Hike friend info screen</font></i> <br><br>  There are 3 React components here: <br><br><ul><li> <code>FriendRow</code> is a component that contains the name of a friend‚Äôs friend and some other information about him. </li><li>  <code>FriendsHeader</code> is a component that displays the inscription "MY FRIENDS" and information about the number of friends. </li><li>  <code>ContainerView</code> is a container component that combines a screen header, represented by the <code>FriendsHeader</code> component, and a list of friends, obtained by traversing an array containing information about a user's friends, each element of which turns out to be represented on the screen by the <code>FriendRow</code> component. </li></ul><br>  Here is the <a href="https://gist.github.com/ankitghike/bdadfc6dc86597292f8ed5b1a4479df8">friendsContainer.js</a> file <a href="https://gist.github.com/ankitghike/bdadfc6dc86597292f8ed5b1a4479df8">code</a> that illustrates the above: <br><br><pre> <code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Container</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   constructor(props) {     <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props);     <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {       friends: []     };   }   componentDidMount() {     <span class="hljs-type"><span class="hljs-type">FriendsService</span></span>.fetchFriends().then((data) =&gt; {       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({         friends: data       });     });   }   render() {     const { friends } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state;     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (       &lt;<span class="hljs-type"><span class="hljs-type">View</span></span> style={styles.flex}&gt;       &lt;<span class="hljs-type"><span class="hljs-type">FriendsHeader</span></span> count={friends.length} text=<span class="hljs-symbol"><span class="hljs-symbol">'My</span></span> friends' /&gt;       {friends.map((friend) =&gt; (&lt;<span class="hljs-type"><span class="hljs-type">FriendRow</span></span> {...friend} /&gt;)) }       &lt;/<span class="hljs-type"><span class="hljs-type">View</span></span>&gt;     );   } }</code> </pre> <br>  An absolutely obvious way to create such an application page is to load friend data into the container component and pass it as properties to the child components. <br><br>  Let us now consider that this data about friends may be needed in some other components used in the application. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/650/7b0/599/6507b05997159a11bcc609a90cf7a9b2.png"><br>  <i><font color="#999999">Chat Screen in Hike App</font></i> <br><br>  Suppose an application has a chat screen that also contains a list of friends.  It can be seen that the same data is used on the screen with a list of friends and on the chat screen.  What to do in this situation?  We have two options: <br><br><ul><li>  You can load friend data again in the <code>ComposeChat</code> component responsible for displaying chat lists.  However, this approach is not particularly good, since its use will mean duplication of data and may lead to problems with synchronization. </li><li>  You can load data about friends in the top-level component (the main container of the application) and transfer this data to the components responsible for displaying the list of friends and displaying the chat list.  In addition, we need to transfer functions to these components in order to update friend data, which is necessary to support data synchronization between components.  This approach will lead to the fact that the top-level component will be literally packed with methods and data that he does not directly use. </li></ul><br>  Both of these options are not so attractive.  Now let's look at how our problem can be solved using the Redux architecture. <br><br><h2>  <font color="#3AC1EF">Using redux</font> </h2><br>  Here we are talking about the organization of work with data using the repository, action creators, reducers and two user interface components. <br><br><h3>  <font color="#3AC1EF">‚ñç1.</font>  <font color="#3AC1EF">Data store</font> </h3><br>  The repository contains downloaded data about the user's friends.  This data can be sent to any component if it is needed there. <br><br><h3>  <font color="#3AC1EF">‚ñç2.</font>  <font color="#3AC1EF">Action creators</font> </h3><br>  In this case, the creator of the action is used to dispatch events to save and update data about friends.  Here is the code for the <a href="https://gist.github.com/ankitghike/750544a718c094ea00f83bbe1d9a8e26">friendsActions.js</a> file: <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> onFriendsFetch = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">friendsData</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {   <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'FRIENDS_FETCHED'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">payload</span></span>: friendsData }; };</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç3.</font>  <font color="#3AC1EF">Reductors</font> </h3><br>  Reducers expect the arrival of events that represent dispatched actions, and update the data about friends.  Here is the code for the <a href="https://gist.github.com/ankitghike/e7f4d2c58cefbea1edc3318cb083d49c">friendsReducer.js</a> file: <br><br><pre> <code class="hljs actionscript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> INITIAL_STATE = {      friends: [],   friendsFetched: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(state = INITIAL_STATE, action)</span></span></span><span class="hljs-function"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(action.type) {   <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'FRIENDS_FETCHED'</span></span>:       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {           ...state,           friends: action.payload,           friendsFetched: <span class="hljs-literal"><span class="hljs-literal">true</span></span>       };   } }</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç4.</font>  <font color="#3AC1EF">Friend List Component</font> </h3><br>  This container component views friends and updates the interface as they change.  In addition, he is responsible for downloading data from the storage in the event that he does not have them.  Here is the code for the <a href="https://gist.github.com/ankitghike/28eb43bf36b41e7671f06d0fbde54b00">friendsContainer.js</a> file: <br><br><pre> <code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Container</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {     <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props);   }   componentDidMount() {     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.friendsFetched) {       FriendsService.fetchFriends().then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> {         <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.onFriendsFetch(data);       });     }   }   render() {     <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { friends } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props;     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">       &lt;View style={styles.flex}&gt;       &lt;FriendsHeader count={friends.length} text=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'My friends'</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/&gt;       {friends.map((friend) =&gt; (&lt;FriendRow {...friend} /</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;</span></span></span><span class="hljs-function">)) }       &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">View</span></span></span><span class="hljs-function">&gt;     );   } } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mapStateToProps</span></span></span><span class="hljs-function"> = (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ ...state.friendsReducer }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapActionToProps = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">onFriendsFetch</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> {   dispatch(FriendActions.onFriendsFetch(data)); } }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> connect(mapStateToProps, mapActionToProps)(Container);</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç5.</font>  <font color="#3AC1EF">Component that displays the chat list</font> </h3><br>  This container component also uses data from the repository and responds to their updating. <br><br><h2>  <font color="#3AC1EF">About the implementation of the Redux architecture</font> </h2><br>  In order to bring the above described architecture to a working state, it may take a day or two, but when changes need to be made to the project, they are made very simply and quickly.  If you need to add a new component to your application that uses data about friends, you can do this without having to worry about data synchronization or about having to redo other components.  The same applies to the removal of components. <br><br><h2>  <font color="#3AC1EF">Testing</font> </h2><br>  When using Redux, each application block is independently testable. <br>  For example, each component of the user interface can be easily subjected to unit testing, since it is independent of the data.  The point is that a function representing such a component always returns the same representation for the same data.  This makes the application predictable and reduces the likelihood of errors occurring during data visualization. <br><br>  Each component can be comprehensively tested using a variety of data.  Such testing helps to reveal hidden problems and contributes to ensuring the high quality of the code. <br><br>  It should be noted that not only components responsible for data visualization, but also reducers and action creators can be subjected to independent testing. <br><br>  Redux is great, but using this technology we encountered some difficulties. <br><br><h2>  <font color="#3AC1EF">Difficulty Using Redux</font> </h2><br><h3>  <font color="#3AC1EF">‚ñç excess template code</font> </h3><br>  In order to implement the Redux architecture in an application, you have to spend a lot of time, encountering all sorts of strange concepts and entities. <br><br>  These are the so-called sledges (thunks), reducers (reducers), actions (actions), intermediate software layers (middlewares), these are <code>mapStateToProps</code> and <code>mapDispatchToProps</code> , and much more.  It takes time to learn all this, but it takes practice to learn how to use it properly.  There are a lot of files in a project, and, for example, one minor change to a component to visualize data may result in the need to make changes to four files. <br><br><h3>  <font color="#3AC1EF">Red Redux vault is singleton</font> </h3><br>  In Redux, the data warehouse is built using the Singleton pattern, although components may have multiple instances.  Most often this is not a problem, but in certain situations such an approach to data storage can create some difficulties.  For example, imagine that there are two instances of a certain component.  When data changes in any of these instances, the changes also affect the other instance.  In certain cases, this behavior may be undesirable; it may be necessary for each instance of the component to use its own copy of the data. <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  Recall our main question, which is whether to spend time and effort on the implementation of the Redux architecture.  We, in response to this question, say Redux "yes."  This architecture helps save time and effort when developing and developing applications.  Using Redux makes it easier for programmers to make frequent changes to the application, and makes testing easier.  Of course, the Redux architecture provides for a considerable amount of template code, but it contributes to breaking the code into modules that are convenient to work with.  Each such module can be tested independently of the others, which contributes to the identification of errors at the design stage and allows for high quality programs. <br><br>  <b>Dear readers!</b>  Do you use Redux in your projects? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/426473/">https://habr.com/ru/post/426473/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../426461/index.html">Garage find: TESLA without run</a></li>
<li><a href="../426463/index.html">Open cannot be ignored</a></li>
<li><a href="../426465/index.html">"We are changing the relief of the earth" - IT goes to a large construction site</a></li>
<li><a href="../426469/index.html">Telegram as corporate standard</a></li>
<li><a href="../426471/index.html">How data flows from spyware applications</a></li>
<li><a href="../426475/index.html">Miya - helper from the smartphone</a></li>
<li><a href="../426477/index.html">The whole truth about the RTOS. Article # 15. Memory sections: services and data structures</a></li>
<li><a href="../426479/index.html">Homemade test bench for motherboards</a></li>
<li><a href="../426481/index.html">Unity Hexagon Maps: Path Search, Player Squads, Animation</a></li>
<li><a href="../426483/index.html">The one who overtakes Tesla. For more profitable</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>