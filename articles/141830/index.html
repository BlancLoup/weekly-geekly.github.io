<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How Instagram prepared for the launch of the Android application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you might have known, Instagram is selling Facebook for $ 1 billion . Many have a question: For what kind of money? Someone on Habr√© compared it wi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How Instagram prepared for the launch of the Android application</h1><div class="post__text post__text-html js-mediator-article">  As you might have known, <a href="http://www.vedomosti.ru/tech/news/1620068/facebook_kupila_instagram_za_1_mlrd">Instagram is selling Facebook for $ 1 billion</a> .  Many have a question: For what kind of money?  Someone on Habr√© compared it with the dot-com boom.  Yes, but all this boom on one Facebook and holds. <br><br>  For two years, CEO Instagram Kevin Systrom was thinking about how to monetize his fast-growing offspring, but he never figured it out.  At the same time, many times there were rumors about his refusal to deal with Facebook.  The Google autosupport has long given the phrase ‚ÄúKevin Systrom net worth‚Äù to the query ‚Äúkevin systrom‚Äù for a long time.  Things went uphill without Facebook. <br><br>  A week ago, they released an Android application and sold Facebook for an amount with 9 zeros in dollars.  Android owners were happy to: <br><img src="https://habrastorage.org/storage2/54d/93f/23c/54d93f23c1bfbaba2d586d6328cfffe5.jpg"><br>  The developers, however, are not very: ‚ÄúWhere are they so drowned?  What are they paid for?  I can do that too, there is nothing complicated and innovative there! ‚ÄùEvery second Android / iOS developer shouted. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Personally, I was waiting for the service to fall on the day the application was released on the Google Play store.  But this did not happen.  The number of registered users in the first 24 hours was about a million.  A good number, I tell you. <br><br>  <b>And how did the team of 9 people manage to endure such an influx and not break?</b> <br><a name="habracut"></a><br>  Here's how <i>(all the data is reliably taken from the <a href="http://instagram-engineering.tumblr.com/">Instagram blog</a> )</i> : <br><br><h4>  Measurements: counters and timers </h4><br>  In order to keep track of everything that happens inside, you must somehow monitor all the activity.  Usually these are two types of activity: some amounts (counters, registrations per second, for example) and some time intervals (timers, how long it takes to like a vintage photo, for example).  But what to do when you have more than one car on the balcony, but a couple of dozen in the DC, and we need one general schedule, and not a couple of dozen different ones?  The solution is simple ‚Äî store everything in a single database.  But this operation is not so fast.  UDP comes to the exit!  Yes, instead of pushing everything into the database, we will simply throw special packets on UDP with data on one common server, and the server will receive them, summarize and represent graphically.  So, for this all on Instagram use NodeJS daemon called <a href="http://github.com/etsy/statsd/">"statsd"</a> .  He catches all this wealth, and then sends them straight to <a href="http://graphite.wikidot.com/">Graphite</a> ( <i>graphing thing, as you might have guessed</i> ). <br>  All this is very scalable (in Instagram the polling interval is 10 seconds), so it allows you to monitor everything that happens almost in realtime. <br><br>  <a href="http://pgfouine.projects.postgresql.org/">PGFouine is</a> used to monitor PostgreSQL servers.  It builds analytics on the basis of PG server logs, allowing you to detect heavy requests and cache them, or non-optimized requests, requests that pull out extra data, etc. <br><br><h4>  Zombie processes </h4><br>  It's terribly sad when a 500 error is thrown out to the client after a timeout expires, isn't it?  And who is to blame?  All are silent, and the only witness has already been killed ( <i>kill -9</i> ).  Instagram comes to the aid of Bitbucket with their open-source development for Django called <a href="https://bitbucket.org/evzijst/dogslow">dogslow</a> .  This dog clings to each request at the very beginning, and if after 25 seconds the response to the request has not come, it merges the call tracing somewhere, for example, to the mail. <br>  With it, the guys found out that memcached was a bottleneck, which hung on set () and get_many () requests, generating 50,000 requests per second, without using the whole processor and, as a result, slowing down the whole process. <br><br><h4>  Replication and slavery </h4><br>  The main backends for data storage on Instagram, Inc.  are Redis &amp; PostgreSQL.  As you know, both of these engines were thinking about scalability, so they allowed the guys to connect slaves ‚Äúon the go‚Äù as soon as resources started to run out. <br>  In the first 12 hours, the frequency of queries to the Redis database reached 40,000, which began to affect performance.  It took no more than 20 minutes to connect additional servers.  Impressive, isn't it? <br>  Amazon EBS Snapshots were used to scale Postgre.  It also took no more than 20 minutes to connect them, thanks to the easily tuned AWS environment in which their master servers hang out. <br><br><h4>  Android chips </h4><br>  In addition to all this, the guys wrote a node2dm utility, a node.js server for sending push notifications to the android C2DM service.  According to them, he processed about 5 million notifications that day.  In honor of this, <a href="https://github.com/Instagram/node2dm">node2dm</a> was presented to the community completely open-source. </div><p>Source: <a href="https://habr.com/ru/post/141830/">https://habr.com/ru/post/141830/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141822/index.html">Speakers at UA PyCon</a></li>
<li><a href="../141825/index.html">Protecting traffic with Comodo TrustConnect and DNSCrypt</a></li>
<li><a href="../141826/index.html">Tim Cook will open the D10 conference</a></li>
<li><a href="../141827/index.html">The simplest compression algorithms: RLE and LZ77</a></li>
<li><a href="../141829/index.html">Samba <3.6.4 (CVE-2012-1182) remote execution of arbitrary code with root-rights</a></li>
<li><a href="../141832/index.html">Google Chrome 19 introduces open tabs sync.</a></li>
<li><a href="../141833/index.html">Routes on Google Maps in your Android application</a></li>
<li><a href="../141834/index.html">Meteor - A new way to create applications</a></li>
<li><a href="../141835/index.html">Disassembly of the Nikon D5100 DSLR and 18-55mm lens</a></li>
<li><a href="../141839/index.html">Linux Hacking Exercises</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>