<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>EMET v4 Release</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last week, the beta version of the EMET v4 toolkit was released. We already wrote about some new features of the 4th version and would like to dwell i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>EMET v4 Release</h1><div class="post__text post__text-html js-mediator-article">  Last week, the beta version of the EMET v4 toolkit was released.  We already <a href="http://habrahabr.ru/company/eset/blog/177265/">wrote</a> about some new features of the 4th version and would like to dwell in more detail on the release itself, since this tool really deserves attention.  Again, the Enhanced Mitigation Experience Toolkit (EMET) uses preventive methods to block various actions of exploits to protect applications from attacks that are aimed at exploiting flaws (or vulnerabilities) in software and changing the flow of code.  Despite the fact that modern Windows 7 and Windows 8 have built-in, enabled by default, DEP and ASLR capabilities aimed at mitigating (mitigation) the consequences of exploitation, EMET allows you to introduce new features for blocking actions of exploits, as well as enable DEP or ASLR default, for example, for outdated Windows XP. <br><br>  In our post, we want to provide an overview of the main features of the fourth version of EMET, which help protect against exploits. <br><br><a name="habracut"></a>  Before considering the main features of this tool, let's clarify a few points: <br><ul><li>  EMET is not a substitute for antivirus or HIPS, because it does not have the functionality of such tools: it does not contain a signature database or special behavioral threat patterns. </li><li>  EMET is not a substitute for sandbox (sandbox), because it is not designed for this and is not able to emulate the actions of the application. </li><li>  EMET is not a 100% system of protection against exploits, since, in fact, it is focused on tracking known methods of operation and will not be able to help against exploitation methods that are unknown to it. </li><li>  EMET is aimed at advanced users who are able to set the appropriate system settings and respond to incoming messages. </li><li>  EMET is free to use. </li></ul><br>  EMET main window. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/e4d/0bd/0d9/e4d0bd0d994e06de4c5dcbf6a2997be0.png"><br><br>  From the point of view of protection against exploits, the tool has two types of settings: for the system as a whole, that is, the general rule for all applications in the system (System Status) and for specific applications (Configure Applications).  Settings for the system include four main points: <br><ul><li>  <b>Data Execution Prevention (DEP) ‚Äîdetermines</b> which applications should use DEP. </li><li>  <b>Structured Exception Handler Overwrite Protection (SEHOP) ‚Äîdetermines</b> which applications should use the protection against overwriting of SEH handlers.  Modification of SEH handlers has been a long time in exploit mode.  SEHOP was introduced at the system level already with Vista SP1. </li><li>  <b>Address Space Layout Randmization (ASLR) ‚Äîdetermines</b> which applications should use ASLR. </li><li>  <b>Certificate Trust (Pinning)</b> - the function is available only for Internet Explorer and allows you to manually create rules for verifying digital certificates for SSL / TLS connections when visiting specific web resources. </li></ul><br>  Decoding settings DEP, ASLR, SEHOP, see <a href="http://support.microsoft.com/kb/875352">here</a> . <br>  The tool supports built-in protection profiles for quick setup: <br><ul><li>  <b>Maximum Security Settings</b> - the option enables all system settings to the maximum level. </li><li>  <b>Recommended Security Settings</b> - option enables system settings to "recommended level".  Unlike Maximum Security Settings, it lowers the status of DEP and SEHOP to App Opt In, that is, including these settings (by default) only for key system processes. </li></ul><br>  You can check the status of processes with DEP, ASLR enabled, for example, using Process Explorer, by setting the display of the corresponding columns in the settings.  View-&gt; Select Columns-&gt; DEP Status, ASLR Enabled. <br><br><img src="https://habrastorage.org/storage2/ad1/995/841/ad19958416fc35ff0137bb9e28378140.png"><br><br>  EMET allows you to protect the application, including from the following very well-known methods used by exploits: <br><ul><li>  <b>ROP</b> is a method well-known and widely used by exploits, which allows using special ‚Äúcode gadgets‚Äù on the stack to achieve the execution of the required code sequence, bypassing so.  DEP. </li><li>  <b>SEH overwrite</b> - SEH blocks (the next, address of the handler) are located on the stack and can be overwritten, for example, as part of a buffer overflow;  accordingly, attackers can use this vulnerability to transfer control to their code through an exception handler. </li><li>  <b>Stack pivoting</b> is a method used to move the register of the ESP stack to the desired address for the exploit. </li><li>  <b>Heapspray</b> - exploits use this method to allocate a large number of memory areas with the location of the exploit code, which increases the likelihood of transferring control to the code needed by the attacker. </li></ul><br>  EMET groups these methods, relating some of them to a specific group.  Below is a screenshot of the settings for the processes, in which you can see how the mitigation methods are grouped and the methods used by the exploits. <br><br><img src="https://habrastorage.org/storage2/c21/c25/e60/c21c25e60c575cc219e8565642822cfe.png"><br><br>  This screenshot shows settings related directly to the memory. <br><ul><li>  <b>DEP</b> is implemented by calling a <i>kernel32! SetProcessDEPPolicy</i> in the context of an EMET-controlled process. </li><li>  <b>BottomUpASLR</b> - in some way is an ASLR for allocated memory regions on the stack and on the heap (as memory is allocated and in the higher addresses). </li><li>  <b>NullPage</b> - see <a href="http://technet.microsoft.com/ru-ru/security/bulletin/ms13-031">MS13-031</a> . </li><li>  <b>MandatoryASLR</b> - forcibly enables ASLR for dynamically loaded process libraries, i.e.  making unpredictable download addresses.  Implemented by intercepting the function <i>ntdll! NtMapViewOfSection</i> . </li><li>  <b>HeapSpray</b> - allows you to record attempts to heapspraying operations by reserving heap memory. </li></ul><br><br><img src="https://habrastorage.org/storage2/3f3/662/09a/3f366209ae634a128edccdd7045810bc.png"><br><br><ul><li>  <b>LoadLib</b> - tracking <i>LoadLibrary</i> operations to prevent the library from loading into memory along a UNC path, for example, \\ server1 \ share.dll </li><li>  <b>MemProt</b> - prohibition of changing the status of stack pages to executable. </li><li>  <b>Caller</b> - also refers to ROP and allows you to observe with which instruction the API was called, i.e. control that the function was called using call rather than ret, which is widely used in exploits. </li><li>  <b>SimExecFlow</b> - allows you to detect ROP-gadgets after calling the EMET-controlled function. </li><li>  <b>StackPivot</b> - allows you to detect stack pivoting situations. </li></ul><br><br><img src="https://habrastorage.org/storage2/f6b/566/1bb/f6b5661bb894ef89007665607433c06b.png"><br><br><ul><li>  <b>SEHOP</b> - tracks attempts to exploit SEH handlers.  In fact, this feature was introduced in the OS itself, starting with Vista SP1.  EMET allows you to use this feature on systems below Vista SP1. </li><li>  <b>EAF (Export Address Table Access Filtering)</b> - prohibits any operations of accessing the memory page on which the module export table is located, depending on the code that is trying to access it.  That is, it allows access to it only for code that belongs to a known loaded module.  It is used by exploits (and not only) when manually parsing the export table of the module in order to obtain the address of the desired function. </li></ul><br>  To perform all these operations, EMET uses the well-known inline code patching method, which is graphically presented in the screenshot below (process controlled by EMET). <br><br><img src="https://habrastorage.org/storage2/268/b1c/7a9/268b1c7a982d7562af6c05c43704bf04.png"><br><br>  EMET has additional advanced features for applications that are available from the Application Configuration. <br><br><img src="https://habrastorage.org/storage2/9cb/533/f11/9cb533f112160bc0b917439b1ab9fed2.png"><br><br><ul><li>  <b>Deep Hooks</b> - to protect critical APIs, EMET will not only intercept these functions themselves, but also those functions (other APIs) that will be called from among them. </li><li>  <b>Anti Detours</b> - blocks the actions of exploits that skip the first bytes of the API (usually the prologue) and transfer control to the instructions following them. </li><li>  <b>Banned Functions</b> - prohibits calling API functions from a special list.  In the 4th version, only the <i>ntdll! LdrHotPatchRoutine</i> function is present in this list. </li></ul><br>  Specify the action that EMET will perform when one of the operating conditions occurs.  The options are: Stop on exploit (blocking the action with the display of a special message and the completion of the process) and Audit only (notification of the action). <br><br><img src="https://habrastorage.org/storage2/654/1ae/5c4/6541ae5c4f173303accd11e41bdf06ff.png"><br><br>  <b>What should EMET protect?</b> <br><br><img src="https://habrastorage.org/storage2/8cd/703/a21/8cd703a21c500caaf6b37715db9b5ac4.png"><br><br>  Please note that EMET has a list of processes for which it will be enabled by default.  These processes include: MS Internet Explorer web browser, Adobe Acrobat, Java, MS Office.  You can see the list of processes in the Apps window. <br>  We highlight the following features regarding application security using EMET: <br><ul><li>  Consider enabling EMET for Skype processes (or other messenger you use), as well as your browser.  Since these components can be operated remotely. </li><li>  Note that EMET is <b>not fully compatible with all applications</b> , not to mention debuggers and other system tools.  Therefore, if you are an administrator, do not turn on EMET for all the necessary processes on the network at once, better test compatibility with these applications separately. </li><li>  A list of possible incompatibilities and their discussion, see <a href="http://social.technet.microsoft.com/Forums/security/en-US/1e70c72b-67b2-43c4-bd36-a0edd1857875/application-compatibility-issues">here</a> . </li></ul><br><br><img src="https://habrastorage.org/storage2/ea3/812/1d8/ea38121d8fb6de668c3a108b9819d661.png"><br>  List of incompatibilities of EMET mechanisms with various applications. <br><br>  Microsoft EMET Guide [PDF] <a href="http://download.microsoft.com/download/4/E/9/4E9A5137-F73D-4A4C-9192-444810C26F6B/EMET%25204.0%2520User%27s%2520Guide.pdf">here</a> . <br>  EMET presentation on RECon'13 from one of the developers <a href="http://0xeb.wordpress.com/2013/06/23/inside-emet-4-0/">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/184428/">https://habr.com/ru/post/184428/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../184414/index.html">Time management: experience using Excel spreadsheets</a></li>
<li><a href="../184416/index.html">Model-View in QML. Part One: Predefined Component Views</a></li>
<li><a href="../184420/index.html">Why I comment on Ruby / Rails application code again</a></li>
<li><a href="../184422/index.html">Armikrog danger! Will the project on the kickstarter collect the required amount? Collected</a></li>
<li><a href="../184426/index.html">Playstation 4 will work on a modified version of FreeBSD 9.0</a></li>
<li><a href="../184430/index.html">Real sock_raw'thin</a></li>
<li><a href="../184432/index.html">Print history: matrix, inkjet, laser and LED technology (Part 2)</a></li>
<li><a href="../184436/index.html">Useful multithreading idioms C ++</a></li>
<li><a href="../184442/index.html">Mega-data centers are the pioneers of innovation. Part 2</a></li>
<li><a href="../184444/index.html">Venus or the first 60 kpx from another planet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>