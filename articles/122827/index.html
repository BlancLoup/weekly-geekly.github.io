<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Functional programming in 1C: Enterprise 8 environment</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, there has been a tendency of the ideas of functional programming to the masses. For me, as a 1C programmer, the most interesting thing is to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Functional programming in 1C: Enterprise 8 environment</h1><div class="post__text post__text-html js-mediator-article"> Recently, there has been a tendency of the ideas of functional programming to the masses.  For me, as a 1C programmer, the most interesting thing is to increase the level of abstraction when working with tabular data.  It's one thing to encode loops with a lot of variables that change from iteration to iteration, and after a month you need to do a ‚Äúdebugging with your eyes‚Äù (or even start the debugger) to understand how these loops work.  It is much more elegant to use ready-made algorithms that can be applied to the table as a whole, and get the expected result. <br><br>  Year after year, coding similar and not so cycles, I was filled with the desire to change something for the better in this dull process.  At first, I was inspired by the generic STL C ++ algorithms.  Then, for general development, I studied Haskell - this language really turns perception. <br><br>  About 2 years ago I started writing a library of universal functions that I used in my daily work.  Practice has convinced me that the approach works, and brings tangible benefits.  More recently, I discovered LINQ, which is used on the .NET platform for unified work with collections, the generation of SQL queries and other useful things.  I envy the white envy of the Sharperam, who have such a wonderful tool! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Having studied the library of standard query operators that make up the LINQ core, I decided to write a similar library for 1C Enterprise 8. <br><a name="habracut"></a><br>  Those practices that I have had so far - I throw them in the trash, because  they are not sufficiently systemic and universal. <br><br>  The main obstacle to creating a function-oriented library is the lack of support for the transfer of functions as parameters in the built-in language. <br><br>  Typical algorithms for working with collections require function arguments as their arguments.  For example, the filtering algorithm uses a condition function that accepts a collection item and returns boolean.  Converting table fields requires an even more complex function.  Functions that are passed to another function as a parameter are called closures in functional programming. <br><br>  I considered various options for replacing full-fledged closures with any surrogates, even writing in the embedded language of a virtual machine that interprets bytecode.  As a result, I came to the conclusion that it is advisable to take advantage of the possibility of the language to calculate expressions in the embedded language, which are transferred to the library as strings (the rationale for the decision is in the project documentation).  It looks like this: <br> <code> = .("_. &gt; 0",, ); <br></code> <br>  The underscore symbol denotes a function parameter, in this case a row of the original table.  If the function takes several parameters, they are denoted by "_0", "_1", etc.  The function passed to the algorithm may use some data known on the caller (context).  For example: <br> <code> = 100; <br>  = .("_. &gt; _.",  ("", ), ); <br></code> <br>  The variable "_k" gets the context value (usually a structure) passed to the second parameter of the If function.  To demonstrate more complex constructions, I‚Äôll give a somewhat contrived example: <br><pre> Customer Order Amounts = Tables. Connection (
     "Customer = _. Link",
     "Customer = _0. Link
     | TIN = _0.INN
     | Ordered = _1. Amount ",,
     Customers, Orders
 );
</pre><br>  The first parameter specifies the key fields of the connection, and converts the field names of the first table (‚ÄúLink‚Äù) into the field names of the second table (‚ÄúClient‚Äù).  The second parameter sets expressions for the result fields (Customer, TIN, Ordered).  "Customers" and "Orders" are the original tables of values. <br><br>  Processing data in the tables of values ‚Äã‚Äãusing the built-in language is not the best solution to the problem.  The built-in language runs much slower than SQL queries.  We resort to the built-in language only if the data is not received from the database or its volume is small, as well as for non-trivial operations (not everything can be done by queries). <br><br>  I have included functions in my library that look like universal algorithms but actually form a query. <br><pre> Request = Requests. Select (
     "Specs. Nomenclature AS Material, 
     | (Orders.Number * Specifications.Number) HOW the Quantity ",
     Requests. Connection (
         "Orders", "Specifications",
         "Orders. Specification = Specs. Reference",
         Requests. From ("Document. OrderOnProduction.Products"),
         Requests. From ("Handbook. Specifications. SourceComplete")
     )
 )
 Result = Requests. Execute (,, Request);
</pre><br>  Why did I do this?  The given example is faster and more reliable to make the query constructor.  It is read all the same worse than the usual query language.  Is it only because of the love of art?  Not only.  This part of the library is designed for complex queries that contain duplicate elements, or a variable number of fields, subqueries.  Such queries are usually formed by the contact string, which leads to the need to follow the syntax, in particular, the arrangement of commas and parentheses.  I hope the library in these cases will bring more benefits than harm, although in practice I have not tested this approach yet. <br><br>  At the moment, the project documentation and function headers are completely ready.  I haven‚Äôt started implementing the functions yet, but I imagine it to be accurate to the line - the project has been worked out in great detail.  Testing the entire array of functions can be more difficult.  I hope to get feedback from colleagues.  If there are well-grounded remarks / suggestions, I am ready to correct the interface of the library, for the present I have not started implementation.  Ready modules are also going to publish.  I also plan to expand the library by adding specific accounting algorithms: distribution over the base, distribution over the fifo, etc. <br><br>  References: <br><ol><li>  <a href="https://docs.google.com/document/pub%3Fid%3D1xgmJmduF6AMv7SOBi92xPevnC6afasS0MgLWt6vtO1o">Library design documentation</a> </li><li>  <a href="https://docs.google.com/document/pub%3Fid%3D18G3AbNgKMYWTvAlAAFu_mTOzGf9WjZV46qrUTFtPHzw">Requests module</a> </li><li>  <a href="https://docs.google.com/document/pub%3Fid%3D1YsQWYUyuQX9d__xZkkaa_7eMGPe6HewyEC02EEqoaGw">Table Module</a> </li><li>  <a href="https://docs.google.com/document/pub%3Fid%3D11hgPru8G990jnPVuCGf4my8H4XNusiP0svv0L-XF31I">Module Arrays</a> </li><li>  <a href="http://download.microsoft.com/download/5/8/6/5868081c-68aa-40de-9a45-a3803d8134b8/standard_query_operators.doc">Standard Query Operators Library Specification for LINQ Language</a> </li><li>  <a href="http://mmcs.sfedu.ru/~ulysses/IT/Haskell/papers/why-haskell-censored.pdf">Inspiring presentation on the benefits of the functional approach using the example of Haskell</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/122827/">https://habr.com/ru/post/122827/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122820/index.html">Canada goes to plastic money</a></li>
<li><a href="../122822/index.html">Briefly about reading the blog "SHTOSM" in the feed of friends in LiveJournal</a></li>
<li><a href="../122823/index.html">File transfer by signals</a></li>
<li><a href="../122824/index.html">Reading an XML file using App Inventor</a></li>
<li><a href="../122826/index.html">Qt applications in the Mac App Store</a></li>
<li><a href="../122828/index.html">comScore: The network is "shrinking" because of Facebook</a></li>
<li><a href="../122829/index.html">Data binding in JavaScript applications: auto-authoring events</a></li>
<li><a href="../122830/index.html">Checkout right</a></li>
<li><a href="../122831/index.html">Qt. Creating a console widget for a graphics application</a></li>
<li><a href="../122832/index.html">Conference site DevCon'11 published conference materials</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>