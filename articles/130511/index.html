<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Correct" utf-8 encoding in nginx / apache settings</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I hope that this post will be useful to many developers, because judging by the numerous threads on the Internet, the problem is quite frequent. The e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Correct" utf-8 encoding in nginx / apache settings</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage1/b85e8ca5/7eb6c555/f5ddee32/afde7af2.png">  I hope that this post will be useful to many developers, because  judging by the numerous threads on the Internet, the problem is quite frequent.  The essence of the problem is the following: incorrect name of utf-8 encoding in nginx / apache settings.  At the same time, the content returned by the server is perceived normally in all browsers except Internet Explorer. <br><a name="habracut"></a><br><br><br>  Often, many developers, when configuring virtual hosts, copy settings from somewhere on the Internet or from other places.  And at the same time, an error ‚Äúmigrates‚Äù to their settings.  In the case of nginx, this is the directive: <br><blockquote>  charset utf8; </blockquote><br>  In the case of Apache, this is: <br><blockquote>  &lt;Directory / path / to / site /&gt; <br>  AddDefaultCharset UTF8 <br>  &lt;/ Directory&gt; <br></blockquote><br>  So - there is no such encoding as <b>utf8</b> !  Correctly write <b>utf-8</b> (hyphenated).  Most browsers (Firefox&gt; = 3, Opera&gt; = 9, Chrome&gt; = 4, Safari&gt; = 4) are loyal to specifying <b>utf8</b> as an encoding, and perceive the content given out correctly, but all versions of <b>Internet Explorer</b> (including even the latest, 9th) ) instead of content give out "krakozyabry."  Of course, this situation is easy to manage even without fixing the settings of the web server.  For example, in the case of returning dynamic content using PHP, you can explicitly specify the encoding in the script itself: <br><blockquote>  <font color="black">header ( <font color="#A31515">'Content-type: text / html; charset = utf-8'</font> );</font> </blockquote><br>  Or use the following tag in HTML: <br><blockquote>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">meta</font> <font color="#ff0000">http-equiv</font> <font color="#0000ff">= "content-type"</font> <font color="#ff0000">content</font> <font color="#0000ff">= "text / html; charset = utf-8"</font> <font color="#0000ff">/&gt;</font></font> </blockquote><br>  And everything would be fine, but the situation becomes more complicated when using AJAX JavaScript tries to reach static content.  An example using jQuery: <br><blockquote>  <font color="black">$ ( <font color="#0000ff">document</font> ) .ready ( <font color="#0000ff">function</font> () {</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">function</font> print_r ()</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black"><font color="#008000">// ...</font></font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black">$ .ajax ({</font> <font color="black"><br></font>  <font color="black">url: <font color="#A31515">"/test.txt"</font> ,</font> <font color="black"><br></font>  <font color="black">dataType: <font color="#A31515">"text"</font> ,</font> <font color="black"><br></font>  <font color="black">success: <font color="#0000ff">function</font> (data, textStatus) {</font> <font color="black"><br></font>  <font color="black">$ ( <font color="#A31515">'#res'</font> ) .html (data);</font> <font color="black"><br></font>  <font color="black">},</font> <font color="black"><br></font>  <font color="black">error: <font color="#0000ff">function</font> (jqXHR, textStatus, errorThrown) {</font> <font color="black"><br></font>  <font color="black">$ ( <font color="#A31515">'#res'</font> ) .html ( <font color="#A31515">'jqXHR:'</font> + print_r (jqXHR) + <font color="#A31515">'&lt;br /&gt; textStatus:'</font> + textStatus + <font color="#A31515">'&lt;br /&gt; errorThrown:'</font> + print_r (errorThrown));</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black">});</font> <font color="black"><br></font>  <font color="black">});</font> </blockquote><br>  In this case, IE produces the following error: <br><blockquote>  <font color="black">{</font> <font color="black"><br></font>  <font color="black">jqXHR: {</font> <font color="black"><br></font>  <font color="black">readyState: 4,</font> <font color="black"><br></font>  <font color="black">status: 0,</font> <font color="black"><br></font>  <font color="black">statusText: <font color="#A31515">'error'</font></font> <font color="black"><br></font>  <font color="black">},</font> <font color="black"><br></font>  <font color="black">textStatus: <font color="#A31515">'error'</font> ,</font> <font color="black"><br></font>  <font color="black">errorThrown: {</font> <font color="black"><br></font>  <font color="black">name: <font color="#A31515">'Error'</font> ,</font> <font color="black"><br></font>  <font color="black">number: -1072896658,</font> <font color="black"><br></font>  <font color="black">description: <font color="#A31515">'Could not complete the action.</font></font>  <font color="black"><font color="#A31515">Error c00ce56e. '</font></font>  <font color="black">,</font> <font color="black"><br></font>  <font color="black">message: <font color="#A31515">'Could not complete the action.</font></font>  <font color="black"><font color="#A31515">Error c00ce56e. '</font></font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black">}</font> </blockquote><br>  This JS error is quite nontrivial.  And if users, who have already encountered such a thing, immediately understand what is the matter, then those who encounter such a thing for the first time may be perplexed and take a long time to figure out the reason. <br><br>  <b>PS</b> As it was rightly noted in the comments, when accessing MySQL, the query is used to indicate in which encoding to access the database: <br><blockquote>  SET NAMES utf8 </blockquote><br>  And in general, wherever there is a reference to the utf-8 encoding, for example, when creating a table: <br><blockquote>  CREATE TABLE `some_table` (...) ENGINE = innoDB DEFAULT CHARSET = utf8 </blockquote><br>  The encoding is utf8, not utf-8.  That is, in this case, the recording goes WITHOUT a hyphen, which makes even more cognitive dissonance in understanding what is happening ... </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/130511/">https://habr.com/ru/post/130511/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../130505/index.html">Asus Eee Pad Transformer - how to disassemble a tablet and what it consists of</a></li>
<li><a href="../130506/index.html">The single interface is the biggest redesign in Google history.</a></li>
<li><a href="../130507/index.html">Mobile Professional Days in Kharkov</a></li>
<li><a href="../130508/index.html">Meet Payoneer at RIW-2011</a></li>
<li><a href="../130509/index.html">Google+ search widget</a></li>
<li><a href="../130513/index.html">My Mahjong</a></li>
<li><a href="../130514/index.html">Panoramic camera-ball gives a 360 ¬∞ view.</a></li>
<li><a href="../130515/index.html">When trigger replication is preferable to PostgreSQL built-in</a></li>
<li><a href="../130516/index.html">UnityCar - cars with physics for Unity3D</a></li>
<li><a href="../130518/index.html">Odnoklassniki office</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>