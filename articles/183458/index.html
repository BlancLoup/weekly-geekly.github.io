<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mobile Web Development: HTML5 Android App</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 

 Fortunately, there is more than one way to write an application for a mobile phone. You can make a website, pack it in a special way, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mobile Web Development: HTML5 Android App</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br><br>  Fortunately, there is more than one way to write an application for a mobile phone.  You can make a website, pack it in a special way, and voila, here is your application! <a name="habracut"></a>  It is this approach that the <a href="http://phonegap.com/">phonegap.com</a> project offers us about this method and will be discussed in this article. <cut><br><br>  I am sure that it is not worth discussing the economic feasibility of this approach.  She is on the face.  Yes, you need more knowledge than the average web developer, but still, this is a website!  It's clear!  This is the same HTML, this is the same browser, the same Javascript.  Finding a developer is not as difficult as, say, ‚Äúnative‚Äù.  And if you multiply by the cross-platform nature of this solution, it may even seem like a panacea.  Of course, we all know that no ‚Äúpill‚Äù exists, but in a number of cases this is indeed the best practic 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, my work assignment sounded like this: Develop a client application for Android OS.  The application is a game.  Quest.  The essence of the game is as follows: a group of people who want to have a rest, are divided into teams.  Each team is given on a smartphone.  In the smartphone app.  Open the application.  The application connects to the server and questions come from there.  For each team they have their own.  Questions may look like ordinary questions with answer choices, well, let's say, How old is the city of St. Petersburg ?, or location questions.  Find the main entrance to the engineering castle.  The team moves, finds the input, clicks We are in place and the coordinates go to the server.  From the server, the answer is true or not.  There are also photography issues.  For example Take a photo of yourself against the background of an engineering castle.  In sum, all the answers are evaluated and in the end one of the teams wins, gaining more points.  In short everything. <br><br><h5>  Step 1 - Prototype </h5><br><br>  In general, the task is clear to us.  Assume that the technical task has already been compiled.  What else?  Looking for prototypes.  Here they are: <br><br><img src="//" alt="Unfortunately, the author of the image has been identified."><br><br><h5>  Step 2 - layouts </h5><br><br>  Next step.  You need to draw them from.  We take up the job, it turns out the following. <br><br><img src="//" alt="Unfortunately, the author of the image has been identified."><br><br><h5>  Step 3 - choose a framework </h5><br><br>  In fact, there are two of them: <br><br>  1. Sencha Touch <br>  <a href="http://www.sencha.com/products/touch">http://www.sencha.com/products/touch</a> <br><br>  2. Jquerymobile <br>  <a href="http://jquerymobile.com/">http://jquerymobile.com/</a> <br><br>  Take Sencha Touch.  The framework is made like ExtJS.  A large number of classes.  We compose them, set them up and get the application.  There is access to HTML elements, but at the framework level it is extremely unwise to manage elements.  Roughly speaking, changing the standard visual display of elements is extremely difficult.  But the data from the server to receive in JSON format is a pleasure. <br><br>  And vice versa.  Jquerymobile is access to elements, in fact extended Jquery.  Tags are added to the elements.  After loading, the framework for these tags adds elements to styles and other elements.  I just failed to make friends with the JSON data from the server.  Jquerymobile is waiting for html code from the server.  Of course, you can get JSON and convert it on the client side to html code, which actually makes Sencha.  But this is not a good practice.  This goes against the framework ideology.  There is a huge number of problems that are extremely difficult to solve. <br><br>  Stop.  And why do we need a framework?  What is first, what is second, in essence, is, so to speak, a ready-made element base, ready-made solutions, the purpose of which is to help you make the application (website) visually similar to the native application.  Do we need this?  Not.  What about PhoneGap?  And that he does not care what you use.  No where no restrictions.  Well then, let's just lay out the application, like a normal website and be done with it! <br><br><h5>  Step 4 - typeset </h5><br><br>  The layout process itself is no different from the standard one.  There are certainly nuances, so let's talk about them.  The first such nuance is the meta tags. <br><br><pre><code class="hljs pgsql">&lt;meta <span class="hljs-type"><span class="hljs-type">name</span></span>="viewport" content="width=device-width, initial-scale=1, user-scalable=no" /&gt;</code> </pre> <br><br>  Without this line in the header of the html code, your application will be displayed as a regular site.  The browser will zoom in on it, which doesn't add any realism to the application. <br><br>  Unlike the desktop browser, the mobile phone browser (probably not all) adds a frame to the elements that are in focus.  A similar frame, when moving the focus, is by default in Google Chrome, at the moment when we enter data in the next field.  It is treated similarly. <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">input</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:focus</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">outline</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> none; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">textarea</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:focus</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">outline</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> none; } <span class="hljs-selector-class"><span class="hljs-selector-class">.Button</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:focus</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">outline</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> none; }</code> </pre><br><br>  And the latest nuance is position: fixed.  And this is really a problem, because there are no universal solutions.  Everything depends on the mobile browsers themselves, they simply do not support, or support, but not completely, such functionality.  It turns out to fix the control panel with one solution for all cases.  For example, jquerymobile, up to version 1.1, in case the browser does not support position: fixed, emulated scrolling and dynamically changed the position of fixed elements, which in general did not give realism and sometimes looked ‚Äúno ice‚Äù. <br><br>  Here is the link for a description of mobile browsers that support position: fixed <br>  <a href="http://bradfrostweb.com/blog/mobile/fixed-position/">bradfrostweb.com/blog/mobile/fixed-position</a> <br>  There are also links to the Javascript libraries that emulate the work position: fixed and scrolling process.  Unfortunately, the work of none of them cannot be called satisfactory. <br><br>  In my particular case, the mobile platform was listed as Android 2.3, and it supports position: fixed, but the user zoom will not work, which is essentially nothing in the application.  Specify in the viewport header <br><br><pre> <code class="hljs pgsql">&lt;meta <span class="hljs-type"><span class="hljs-type">name</span></span>="viewport" content="width=device-width, initial-scale=1, user-scalable=no" /&gt;</code> </pre> <br><br>  And prescribe styles <br><br><pre> <code class="css hljs"> <span class="hljs-selector-class"><span class="hljs-selector-class">.Header</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: white; <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: none; <span class="hljs-attribute"><span class="hljs-attribute">border</span></span>: none; <span class="hljs-attribute"><span class="hljs-attribute">text-shadow</span></span>: none; <span class="hljs-attribute"><span class="hljs-attribute">border-bottom</span></span>: white solid <span class="hljs-number"><span class="hljs-number">3px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">font-weight</span></span>: bold; <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: fixed; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">100%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">62px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">top</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">left</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">z-index</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> }</code> </pre><br><br>  That's all. <br><br><h5>  Step 5 - Emulators </h5><br><br>  Obviously, it is difficult to type out and look in the browser, in the monitor window.  Resolution android application, say 320x480, and what is the screen size of your monitor?  Emulators come to the rescue.  The easiest emulator is already in your browser!  If you upload pages to Google Chrome and press Ctrl + Shift + I, the browser will show you the developer tools.  In the lower right corner you can find the gear icon, click on it.  Next, select the Override tab and here it is, your emulator.  Select User Agent and tick Device Metric.  At the first stage it will be enough. <br><br><img src="//" alt="Unfortunately, the author of the image has been identified."><br><br>  And there is an emulator from PhoneGap itself!  <a href="http://emulate.phonegap.com/">emulate.phonegap.com</a> <br>  Called Ripple.  It is put in the form of additions to Google Chrome.  Hooray!  Our capabilities have increased dramatically.  If in your application you use the cordova library to expand the functionality of the application, say, to work with a phone camera or a compass, then Ripple will give you the opportunity to simulate these processes. <br><br>  Well, once we talked about emulators, you can‚Äôt say anything about an emulator, which should be installed with Eclipse, if you follow the instructions from Phonegap <br>  <a href="http://docs.phonegap.com/en/2.2.0/guide_getting-started_android_index.md.html">docs.phonegap.com/en/2.2.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android</a> <br>  This emulator is already behaving quite like a real device.  All the errors that were found on this emulator, all the same way were found on the device.  And of course you need to say that using this emulator is quickly difficult.  Long loading, hard to type text, etc.  It is suitable for the very last stage.  When your application is already working fine on all other emulators previously listed. <br><br><h5>  Step 6 - we program </h5><br><br>  Although the article is for programmers, to mix all the code here is just silly.  I will describe in general.  Programming a web application, in fact, is not different from programming a small site.  There are the same methods and approaches, but performed on Javascript.  The same MVC, the same patterns: singleton, compiler, etc. <br><br>  Here is the front controller <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> App = { <span class="hljs-attr"><span class="hljs-attr">Init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Model(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.url); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.view = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> View(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.controller = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Controller({ <span class="hljs-attr"><span class="hljs-attr">model</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model, <span class="hljs-attr"><span class="hljs-attr">view</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.view }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">Run</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">task, params</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> task == <span class="hljs-string"><span class="hljs-string">'undefined'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.controller.Login(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.controller[task] == <span class="hljs-string"><span class="hljs-string">'undefined'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.controller.Login(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.controller[task](params); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">Done</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } } $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ App.Init(); App.Run(); App.Done(); });</code> </pre><br>  * There are no magic methods in javascript.  If we say in PHP we can use __call, and call App.SomeSome ('&lt;parameters&gt;'), then we need to write App.Run ('SomeSome', '&lt;parameters&gt;') <br><br>  Here is an example controller: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Controller = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">params</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.view = params.view; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model = params.model; } Controller.prototype = { <span class="hljs-attr"><span class="hljs-attr">Login</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.view.Login(); }, <span class="hljs-attr"><span class="hljs-attr">LoginSubmit</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> that = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, value = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model.GetLoginFormValue(), errors = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model.GetLoginFormErrors(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (errors !== <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.view.Login(value, errors); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model.SendToServer(<span class="hljs-string"><span class="hljs-string">'teamLogin'</span></span>, value, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err, data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!err) { that.model.SetTeam(data); that.model.ListenServer(data.lastMessageId); that.Welcome(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { that.view.ShowPopup(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, data) } }); } }, <span class="hljs-attr"><span class="hljs-attr">Welcome</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> that = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model.GetWelcomeContent(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err, data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!err) { that.view.Welcome(data); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { that.view.ShowPopup(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, data); } }); }</code> </pre><br><br>  Here is a small example of a model. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Model = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.url = url; } Model.prototype = { <span class="hljs-attr"><span class="hljs-attr">GetHelpChat</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">callback</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url = <span class="hljs-string"><span class="hljs-string">'helpChat?team='</span></span>+<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.team.teamId+<span class="hljs-string"><span class="hljs-string">'&amp;hash='</span></span>+<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.team.hash; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ReciveFromServer(url, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err, data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) { callback(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, data); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { callback(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, data); } }); },</code> </pre><br><br>  Here is an example view. <br><br><pre> <code class="hljs matlab">var View = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">page</span></span></span><span class="hljs-function"> = $</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('.Page')</span></span></span><span class="hljs-function">; } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">View</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prototype</span></span></span><span class="hljs-function"> = { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TaskIndex</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(status, time, tasks)</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">var</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">num</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Util</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetRndNumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Show</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Html.Header( Html.IconPanel(status)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Html</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimePanel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(time)</span></span></span><span class="hljs-function"> ), </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Html</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Content</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Html.TaskPanel(tasks)</span></span></span><span class="hljs-function"> ), </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Html</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Footer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Html.ButtonPanelBottom('task')</span></span></span><span class="hljs-function"> ) ); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setInterval</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Timer.Total, 1000)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setInterval</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Timer.Current, 1000)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Util</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetScrollToTop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; },</span></span></code> </pre><br><br>  In fact, it‚Äôs the same as if the site were written in PHP.  With the exception of the fundamental principle, Javascript is an asynchronous language and without a callback, neither here (unless you use special libraries of course) <br><br>  Separately, I would like to stop at the nuances, namely, work with a smartphone camera.  Out of the box, javascript can't do this.  Cordova library comes to the rescue, which PhoneGap offers to connect.  But the link to the description of the work with the camera phone <br><br>  <a href="http://docs.phonegap.com/en/2.2.0/cordova_camera_camera.md.html">http://docs.phonegap.com/en/2.2.0/cordova_camera_camera.md.html#Camera</a> <br><br>  When working with advanced Javascript functions and in particular with the camera, I expected the most problems from them.  And not in vain.  The first thing I had to deal with was that after taking a photo, the camera simply showed a black screen and did not return to the application.  As it turned out, this is due to the fact that by default the photo was taken of maximum quality and the file was large.  The process of its transfer to the application, due to the low power of the phone itself, takes considerable time.  I had to make changes to the demo code <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">navigator</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.camera</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.getPicture</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">OnSuccess</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">OnFail</span></span>, { <span class="hljs-attribute"><span class="hljs-attribute">quality</span></span>: <span class="hljs-number"><span class="hljs-number">75</span></span>, allowEdit: true, targetWidth: <span class="hljs-number"><span class="hljs-number">280</span></span>, targetHeight: <span class="hljs-number"><span class="hljs-number">280</span></span>, destinationType: destinationType.DATA_URL });</code> </pre><br><br>  But this was not all.  The getPicture method returns the base64 encoded image, but the data between the server and the client are transmitted as JSONP requests. <br>  Obviously, it is impossible to transfer such amount of data via GET request.  The server part, by the way, I do not remember whether I said whether or not, in PHP.  Yes, not the best solution, you can forget about WebSocket.  Proxying is also not done.  Probably, the solution to this problem was one of the most difficult.  And the solution was the following.  Time goes and standard classes are expanded, new methods are added.  So the XMLHttpRequest class has got new events.  In addition to the standard onreadystatechange, the onload event also appeared.  If the response handler from the server is ‚Äúhung up‚Äù on it, and in the Content-Type header you specify application / x-form-urlencoded, then the browser will make a cross-domain request using the POST method, which we actually need.  Here is an example <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xhr = new XMLHttpRequest(); xhr.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'POST'</span></span>, url, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); xhr.setRequestHeader(<span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>, <span class="hljs-string"><span class="hljs-string">'application/x-www-form-urlencoded'</span></span>); xhr.onload = function(e) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.readyState == <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.status == <span class="hljs-number"><span class="hljs-number">200</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r = JSON.parse(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.responseText); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (r.success) { callback(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, r.<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { callback(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, r.message); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { that.view.ShowPopupWindow(<span class="hljs-string"><span class="hljs-string">'Error'</span></span>, msg.ERROR_CONNECTION); } } }</code> </pre><br><br>  And yet, a very important point.  The cross-domain query, no matter how it is implemented, is synchronous, even though the above code looks like asynchronous. <br><br>  I also faced the Same Origin Policy problem.  The solution to this problem lies on the server side.  In the configuration files, permission is set for the cross-domain query and deal with the end. <br><br>  I also tried FormData API <br>  <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData%3Fredirectlocale%3Den-US%26redirectslug%3DWeb%252FAPI%252FXMLHttpRequest%252FFormData">developer.mozilla.org/en-US/docs/Web/API/FormData?redirectlocale=en-US&amp;redirectslug=Web%2FAPI%2FXMLHttpRequest%2FFormData</a> <br>  But, unfortunately, this API, the mobile phone browser does not support. <br><br>  I would also like to note that in case you don‚Äôt need advanced phone functions: accelerometer, compass, camera, media, etc.  it is not necessary to connect the cordova library (and this is about 300 kilobytes).  Geolocation, by the way, is available without it. <br><br><h5>  Step 7 - debug </h5><br><br>  Here is our application ready.  It is done and works great on the Ripple emulator (see the section on emulators).  The most interesting begins, namely, debugging on the phone.  But first, let's try to run the application on the emulator, in eclipse.  Before each launch of the application on the emulator, the system asks to clean the project.  Project -&gt; Clean.  Do not forget to do it.  Push Run - let's go! <br><br>  After loading the emulator, there will be a huge number of messages in the LogCat Eclipse panel.  The first question that arises is which ones are ours?  In order to see only your errors, and in particular, to see the messages that the application displays in console.log, you need to configure the filter.  In the LogCat panel, on the left, there is a separate unit, Saved Filters.  Opening it, you will of course see an empty list, for we do not yet have filters.  Click on the plus sign and see the window <br><br><img src="//" alt="Unfortunately, the author of the image has been identified."><br><br>  Enter in the Log Tag web console, as in the picture and now the Log console will display messages from your web application. <br><br>  As expected, the emulator in the browser is far from being an emulator in Eclipse.  Indeed, there were errors that were not previously. <br><br><img src="//" alt="Unfortunately, the author of the image has been identified."><br><br><pre> <code class="hljs sql">JSCallback Error: Request failed <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">status</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">at</span></span> :<span class="hljs-number"><span class="hljs-number">1180915830</span></span></code> </pre> <br><br>  Begin to study the error.  It is obvious that the error is caused at the time of receiving data from the server.  Error says that status 0 is coming. We are starting to search for a solution on Google, and this is what we find <br>  <a href="http://simonmacdonald.blogspot.ru/2011/12/on-third-day-of-phonegapping-getting.html">simonmacdonald.blogspot.ru/2011/12/on-third-day-of-phonegapping-getting.html</a> <br>  <a href="http://stackoverflow.com/questions/11230685/phonegap-android-status-0-returned-from-webservice">stackoverflow.com/questions/11230685/phonegap-android-status-0-returned-from-webservice</a> <br><br>  We conclude: you probably need to add status 0, as the correct status, to continue processing the server response.  We are looking for where the JSCallback messages are and find it in the cordova.js file on line 3740 (cordova-2.1.0.js) <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> startXhr() { // cordova/exec <span class="hljs-keyword"><span class="hljs-keyword">depends</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> this module, so we can<span class="hljs-string"><span class="hljs-string">'t require cordova/exec on the module level. var exec = require('</span></span>cordova/exec<span class="hljs-string"><span class="hljs-string">'), xmlhttp = new XMLHttpRequest(); // Callback function when XMLHttpRequest is ready xmlhttp.onreadystatechange=function(){ if (!xmlhttp) { return; } if (xmlhttp.readyState === 4){ // If callback has JavaScript statement to execute if (xmlhttp.status === 200) { // Need to url decode the response var msg = decodeURIComponent(xmlhttp.responseText); setTimeout(function() { try { var t = eval(msg); } catch (e) { // If we'</span></span>re getting an error here, seeing the message will help <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> debugging console.log("JSCallback: Message from Server: " + msg); console.log("JSCallback Error: "+e); } }, <span class="hljs-number"><span class="hljs-number">1</span></span>); setTimeout(startXhr, <span class="hljs-number"><span class="hljs-number">1</span></span>); } // <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> callback ping (used <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> keep XHR request <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">timing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (xmlhttp.status === <span class="hljs-number"><span class="hljs-number">404</span></span>) { setTimeout(startXhr, <span class="hljs-number"><span class="hljs-number">10</span></span>); } // <span class="hljs-number"><span class="hljs-number">0</span></span> == Page <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> unloading. // <span class="hljs-number"><span class="hljs-number">400</span></span> == Bad request. // <span class="hljs-number"><span class="hljs-number">403</span></span> == invalid token. // <span class="hljs-number"><span class="hljs-number">503</span></span> == <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> stopped. <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { console.log("JSCallback Error: Request failed with status " + xmlhttp.status); exec.setNativeToJsBridgeMode(exec.nativeToJsModes.POLLING); } } };</code> </pre><br><br>  We are <code>if (xmlhttp.status === 200)</code> to replace <code>if (xmlhttp.status === 200)</code> with <code>if (xmlhttp.status === 200 || xmlhttp.status === 0)</code> and voila - no effect! <br><br>  I will not continue to tell you how I spent the whole day circling around this error.  I can only say that I was ready to despair, because nothing could help me.  The application still crashed until I just decided to comment out part of the code.  And lo and behold!  The error has disappeared!  Returning, in parts, my code, I found part of it that led to an error. <br><br><pre> <code class="hljs pgsql">var Util = { SetNewHash: <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(hash) { <span class="hljs-comment"><span class="hljs-comment">/** *     Android 2.3!! */</span></span> //<span class="hljs-keyword"><span class="hljs-keyword">location</span></span>.href = <span class="hljs-string"><span class="hljs-string">'http://'</span></span>+<span class="hljs-keyword"><span class="hljs-keyword">location</span></span>.host+<span class="hljs-keyword"><span class="hljs-keyword">location</span></span>.pathname+<span class="hljs-string"><span class="hljs-string">'#'</span></span>+hash; },</code> </pre><br><br>  Why the change of Hesh, led to such an error, remains a mystery to me.  If anyone has any thoughts on this subject - well. <br><br><h5>  Step 8 - Run </h5><br><br>  In order to launch the application directly on the phone, it‚Äôs enough to enter the settings, select the Development section and check the box next to USB Debugging.  Next, by pressing RUN in eclipse, the environment will determine that your phone is connected to USB, and I hope you have already done this, and will start running the application already on the device. </cut></div><p>Source: <a href="https://habr.com/ru/post/183458/">https://habr.com/ru/post/183458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../183444/index.html">Kotlin M5.3: Delegated Properties</a></li>
<li><a href="../183446/index.html">About acquaintance with the "reinforcing" sound on the example of Rock It Sounds R-20</a></li>
<li><a href="../183448/index.html">Three tasks for programmers who do not need math</a></li>
<li><a href="../183452/index.html">The director filed a lawsuit for the right to use the song "Happy Birthday" without licensing fees</a></li>
<li><a href="../183454/index.html">Return by value and const variables in C ++ 11</a></li>
<li><a href="../183460/index.html">Amazon has a section on selling 3D printers.</a></li>
<li><a href="../183462/index.html">Practice of using XOR in programming</a></li>
<li><a href="../183466/index.html">Wall mounted aircraft, jumping glider and quadrocopter on the ceiling</a></li>
<li><a href="../183468/index.html">Forwarding a video card in KVM from under ubuntu</a></li>
<li><a href="../183470/index.html">Lock audio records Vkontakte. Restore playlist</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>