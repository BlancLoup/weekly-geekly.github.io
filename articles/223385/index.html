<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Transition from 2 links to service architecture in the SOA paradigm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, I would like to share my experience in organizing the transition from the classic 2 links to the SOA paradigm, also touch on some asp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Transition from 2 links to service architecture in the SOA paradigm</h1><div class="post__text post__text-html js-mediator-article">  In this article, I would like to share my experience in organizing the transition from the classic 2 links to the SOA paradigm, also touch on some aspects of deployment within an enterprise solution and integration with related services written in Java <br><br><h5>  Prehistory </h5><br>  For the last 3 years I have been working in the internal automation department of Novotelecom.  The main development of systems for automating internal processes related to IT departments began in 2008 along with the active growth of the campaign itself.  At that time, management did not set goals to make quality decisions, the main goal was to conquer the market, and this put an imprint on the decisions made.  The main system on which the department of VA works is an internal CRM system, which also includes elements of human resource planning and help systems.  For a long time, the system was written on a samopisny framework, but after becoming acquainted with Yii and implementing the company's website on it, it was decided to transfer the system to this framework.  Discussions why this particular framework was chosen are beyond the scope of my article. <br><a name="habracut"></a><br>  At the initial transfer to Yii, our team decided to leave the architecture without major changes, since  the pace of development grew, and internal work organization processes were not yet at the same level as prioritizing architectural aspects.  Thus, a year later, about a third of the functionality of the current system was transferred to Yii.  We definitely increased the pace of development because  The framework helped to solve many typical problems, the solution of which previously took a lot of time.  But there was one moment that began to bother more and more.  It was necessary all the same to solve architectural issues, until everything went into the zone of no return.  The decisive factor in deciding on the transition to services instead of one monolithic application was the selection in the campaign of the role of an intersystem architect, who began to put in order all the internal processes and architectural aspects.  An architect was assigned to this role from one of the adjacent groups that write software in Java.  In their group, the soa paradigm was originally chosen and over the past 3-5 years this practice has shown all the pros and cons of this approach. <br><br><h5>  Little about the environment </h5><br><ul><li>  OS Debian 6 </li><li>  nginx web server </li><li>  php 5.3 </li><li>  framework yii </li><li>  phing build and deployment system </li><li>  services are installed as deb packages </li><li>  <a href="http://hessianphp.sourceforge.net/">hessian</a> related services integration protocol </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Restrictions </h5><br>  Initially, a development approach was chosen using modules that combined business logic layers, for example, client application, client card, etc.  When switching to services, the question was how to organize the structure of the application, how to deploy it, how to store it in SVN. <br>  To solve such problems there are several approaches.  One of them was proposed by the guys from 2Gis in <a href="http://habrahabr.ru/company/2gis/blog/130162/">his article</a> .  You can also use a similar solution in organizing the structure of the application - <a href="http://yiinitializr.2amigos.us/">Yiinitializr</a> .  The decision from 2amigos is good enough, but just to take and transfer everything to it was already quite problematic.  Therefore, I had to make my own bike based on the existing examples and experience gained with Yii. <br><br><h5>  Little bit about SOA </h5><br>  In the first stage, the following services were allocated. <br><img src="https://habrastorage.org/getpro/habr/post_images/5ad/66d/d59/5ad66dd592ae89562f7e51592758401a.jpg" width="500"><br><br>  The diagram has 2 internal layers: core and portal <br>  <b>Core</b> - a layer of common components necessary for the correct operation of all services, plus libraries, for example, yii, behat, ratcher, etc., as well as a set of components for integration with related services. <br>  <b>Portal</b> - user interfaces. <br>  In addition, the diagram shows a layer of internal and external services and interaction protocols. <br><br><h5>  More about implementation </h5><br>  Each application, be it a service or user interface, has one of two entry points: <b>web</b> and <b>console</b> .  For example, in the case of a web service, the entry point is rest api. <br><br>  Storage of configs is done by analogy with yiinitializr, taking into account our features.  Thus, each application has the following configs structure: <br><ul><li>  service.web.php - config for the web part </li><li>  service.console.php - config for console part </li><li>  service.test.php - config to run autotests </li><li>  service.base.php - common config for all previous ones.  Connects inside each one </li><li>  env / local.php - config in which parameters depending on the environment (dev, test or production) are made </li><li>  sections / routes.php - routing rules </li></ul><br>  ApplicationDispatcher is responsible for application initialization in the common package, which implements the following functions: preparing the config, setting internal aliases, prescribing routes and provides methods for getting paths to directories depending on the environment, for example, to a folder with temporary files or logs. <br><br>  The component is connected to index.php and called as follows. <br><br><div class="spoiler">  <b class="spoiler_title">Source code index.php</b> <div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    if(!file_exists('/usr/share/ntk-rm-common/protected/components/ApplicationDispatcher.php')) {    throw new Exception('   ntk-rm-common'); } require_once('/usr/share/ntk-rm-common/protected/components/ApplicationDispatcher.php');   //      $dispatcher = ApplicationDispatcher::getInstance(); //   :    $dispatcher-&gt;setEnvironment(ApplicationDispatcher::ENV_PRODUCTION); //    $dispatcher-&gt;setApplicationType(ApplicationDispatcher::APP_TYPE_WEB); //     $dispatcher-&gt;create('crm')-&gt;run();</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">The source code of the create method</b> <div class="spoiler_text"><pre> <code class="php hljs"> <span class="hljs-comment"><span class="hljs-comment">/** *    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> $service -    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> mixed * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> Exception */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($service)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;service = $service; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;app_type)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span>(<span class="hljs-string"><span class="hljs-string">'  : web  console'</span></span>); } <span class="hljs-comment"><span class="hljs-comment">//    require_once $this-&gt;getBasePath('common') . '/helpers/global.php'; $config = $this-&gt;prepareConfig(); //        $config['runtimePath'] = $this-&gt;getRuntimePath($service); //       - protected $config['basePath'] = $this-&gt;getBasePath($service); $this-&gt;setAliases(); if ($this-&gt;app_type == self::APP_TYPE_WEB) { $this-&gt;app = Yii::createWebApplication($config); //    $this-&gt;setRoutes(); //     assets     $basePath = $this-&gt;getHtdocsPath($this-&gt;service) . '/assets/'; $this-&gt;app-&gt;getAssetManager()-&gt;setBasePath($basePath); } else { defined('STDIN') or define('STDIN', fopen('php://stdin', 'r')); $this-&gt;app = Yii::createConsoleApplication($config); } return $this-&gt;app; }</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">The logic of preparing the configuration file is not much different from that used in Yii-Boilerplate or Yiinitializr</b> <div class="spoiler_text"><pre> <code class="php hljs"> <span class="hljs-comment"><span class="hljs-comment">/** *    . * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> array|mixed * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> Exception -         */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prepareConfig</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;isExistsServiceConfig()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span>(<span class="hljs-string"><span class="hljs-string">'   ¬´'</span></span> . <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getServiceConfigName() . <span class="hljs-string"><span class="hljs-string">'¬ª  .   .'</span></span>); } <span class="hljs-comment"><span class="hljs-comment">//    $service_configs = array( '/' . $this-&gt;service . '.' . $this-&gt;app_type . '.php', '/env/local.php' ); $config = $this-&gt;mergeConfigs(array(), $service_configs , $this-&gt;getConfigPath(($this-&gt;service))); //    $common_configs = array( '/env/local.php', '/common.base.php', $this-&gt;app_type == self::APP_TYPE_WEB ? '/common.web.php' : '/common.console.php', ); $config = $this-&gt;mergeConfigs($config, $common_configs, $this-&gt;getConfigPath('common')); //   backend  $backend_configs = array( '/php-backend.base.php', '/env/local.php', ); $config = $this-&gt;mergeConfigs($config, $backend_configs, $this-&gt;getConfigPath('php-backend')); return $config; }</span></span></code> </pre><br></div></div><br><h5>  Package structure </h5><br>  As mentioned above, the installation of services in production occurs via deb-packages.  For full support of debian-way when installing a deb-package, the application is scattered in the following directories: <br><ul><li>  / usr / share / &lt;service-name&gt; / protected / - service sources </li><li>  / usr / share / doc / &lt;service-name&gt; / - config example local.default.php </li><li>  / usr / bin / &lt;service-name&gt; - executable file for launching robots </li><li>  / var / www / &lt;service-name&gt; / htdocs / - directory for web north </li><li>  / var / tmp / &lt;service-name&gt; / - directory to store temporary files </li><li>  / var / log / &lt;service-name&gt; / directory for storing service logs </li></ul><br><h5>  Build a package using the Phing utility </h5><br>  The phing utility is responsible for building the package, which: <br><ul><li>  downloads the current version from the trunk branch from svn </li><li>  spreads all the necessary directories as described above </li><li>  invokes a command to build a package </li><li>  creates a label in svn </li><li>  uploads package to debian package server repository </li></ul><br><div class="spoiler">  <b class="spoiler_title">Sample code from the task of forming the package structure</b> <div class="spoiler_text"><pre> <code class="bash hljs"> &lt;!-- ============================================ --&gt; &lt;!-- Target: prepare --&gt; &lt;!-- ============================================ --&gt; &lt;target name=<span class="hljs-string"><span class="hljs-string">"prepare"</span></span> depends=<span class="hljs-string"><span class="hljs-string">"clean"</span></span>&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"    "</span></span> /&gt; &lt;mkdir dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">"</span></span> /&gt; &lt;copy todir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">"</span></span>&gt; &lt;fileset dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.basedir}</span></span></span><span class="hljs-string">/debian"</span></span>&gt; &lt;include name=<span class="hljs-string"><span class="hljs-string">"**/*"</span></span> /&gt; &lt;exclude name=<span class="hljs-string"><span class="hljs-string">".svn"</span></span> /&gt; &lt;exclude name=<span class="hljs-string"><span class="hljs-string">"cron.d/"</span></span> /&gt; &lt;exclude name=<span class="hljs-string"><span class="hljs-string">"cron.d/*"</span></span> /&gt; &lt;/fileset&gt; &lt;/copy&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=<span class="hljs-string"><span class="hljs-string">"svn info | grep 'URL: '"</span></span> outputProperty=<span class="hljs-string"><span class="hljs-string">"project.tmp.svnInfo"</span></span> /&gt; &lt;php expression=<span class="hljs-string"><span class="hljs-string">"end(explode(': ', '</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.tmp.svnInfo}</span></span></span><span class="hljs-string">'));"</span></span> returnProperty=<span class="hljs-string"><span class="hljs-string">"project.tmp.svnUrl"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"    SVN"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=<span class="hljs-string"><span class="hljs-string">"rm -Rf </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/var/www/ntk-rm-crm/*"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>=<span class="hljs-string"><span class="hljs-string">"svn export --force </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.tmp.svnUrl}</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/export/"</span></span>/&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"     - /var/www/ntk-rm-crm/htdocs/"</span></span> /&gt; &lt;mkdir dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/var/www/ntk-rm-crm/"</span></span> /&gt; &lt;copy todir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/var/www/ntk-rm-crm/htdocs/"</span></span> &gt; &lt;fileset defaultexcludes=<span class="hljs-string"><span class="hljs-string">"false"</span></span> expandsymboliclinks=<span class="hljs-string"><span class="hljs-string">"true"</span></span> dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/export/htdocs/"</span></span>&gt; &lt;include name=<span class="hljs-string"><span class="hljs-string">"**/*"</span></span> /&gt; &lt;/fileset&gt; &lt;/copy&gt; &lt;mkdir dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/var/www/ntk-rm-crm/htdocs/assets/"</span></span> /&gt; &lt;copy file=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/var/www/ntk-rm-crm/htdocs/index-prod.php"</span></span> tofile=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/var/www/ntk-rm-crm/htdocs/index.php"</span></span> overwrite=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt; &lt;delete file=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/var/www/ntk-rm-crm/htdocs/index-prod.php"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"     /usr/share/ntk-rm-crm/protected/"</span></span> /&gt; &lt;mkdir dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/usr/share/ntk-rm-crm/protected/"</span></span> /&gt; &lt;copy todir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/usr/share/ntk-rm-crm/protected/"</span></span> &gt; &lt;fileset defaultexcludes=<span class="hljs-string"><span class="hljs-string">"false"</span></span> expandsymboliclinks=<span class="hljs-string"><span class="hljs-string">"true"</span></span> dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/export/protected/"</span></span>&gt; &lt;include name=<span class="hljs-string"><span class="hljs-string">"**/*"</span></span> /&gt; &lt;exclude name=<span class="hljs-string"><span class="hljs-string">"configs/*"</span></span> /&gt; &lt;exclude name=<span class="hljs-string"><span class="hljs-string">"**/yiic*"</span></span> /&gt; &lt;/fileset&gt; &lt;/copy&gt; &lt;delete dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/usr/share/ntk-rm-crm/protected/configs/"</span></span> includeemptydirs=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"  yiic.php   "</span></span> /&gt; &lt;copy file=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/export/protected/yiic-prod.php"</span></span> tofile=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/usr/share/ntk-rm-crm/protected/yiic.php"</span></span> overwrite=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt; &lt;copy file=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/export/protected/yiic-prod"</span></span> tofile=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/usr/bin/ntk-rm-crm"</span></span> overwrite=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"     /etc/ntk-rm-crm/"</span></span> /&gt; &lt;mkdir dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/etc/ntk-rm-crm/"</span></span> /&gt; &lt;copy todir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/etc/ntk-rm-crm/"</span></span> &gt; &lt;fileset defaultexcludes=<span class="hljs-string"><span class="hljs-string">"false"</span></span> expandsymboliclinks=<span class="hljs-string"><span class="hljs-string">"true"</span></span> dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/export/protected/configs/"</span></span>&gt; &lt;include name=<span class="hljs-string"><span class="hljs-string">"**/*"</span></span> /&gt; &lt;exclude name=<span class="hljs-string"><span class="hljs-string">"**/crm.test.php"</span></span> /&gt; &lt;exclude name=<span class="hljs-string"><span class="hljs-string">"**/local.default.php"</span></span> /&gt; &lt;/fileset&gt; &lt;/copy&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"     /usr/share/doc/ntk-rm-crm/"</span></span> /&gt; &lt;mkdir dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/usr/share/doc/ntk-rm-crm/"</span></span> /&gt; &lt;copy file=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/export/protected/configs/env/local.default.php"</span></span> tofile=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/usr/share/doc/ntk-rm-crm/local.default.php"</span></span> overwrite=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">" cron- /etc/cron.d/ntk-rm-crm"</span></span> /&gt; &lt;copy file=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.basedir}</span></span></span><span class="hljs-string">/debian/cron.d/ntk-rm-crm"</span></span> tofile=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/etc/cron.d/ntk-rm-crm"</span></span> overwrite=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"    /var/log/ntk-rm-crm/"</span></span> /&gt; &lt;mkdir dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/var/log/ntk-rm-crm/"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"     /var/tmp/ntk-rm-crm/"</span></span> /&gt; &lt;mkdir dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/var/tmp/ntk-rm-crm/"</span></span> /&gt; &lt;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> msg=<span class="hljs-string"><span class="hljs-string">"  export"</span></span> /&gt; &lt;delete dir=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${project.packageDir}</span></span></span><span class="hljs-string">/export/"</span></span> includeemptydirs=<span class="hljs-string"><span class="hljs-string">"true"</span></span> /&gt; &lt;/target&gt;</code> </pre><br></div></div><br><br><h5>  Conclusion </h5><br>  In conclusion, I would like to note that this solution has both advantages and disadvantages.  Of the main advantages obtained after the implementation of this scheme, we can distinguish debian-way support for packages, which makes life easier for the support team.  It also became easier to simultaneously develop and implement new functionality. <br><br>  The article is for informational purposes only.  in one article does not reveal all aspects.  Ready to answer questions if they appear. <br><br>  In addition, here are some references to materials about the SOA paradigm: <br><ul><li>  <a href="http://www.soa-manifesto.org/default_russian.html">www.soa-manifesto.org/default_russian.html</a> </li><li>  <a href="http://www.gartner.com/it/content/754400/754413/twelve_common_soa_mistakes.pdf">www.gartner.com/it/content/754400/754413/twelve_common_soa_mistakes.pdf</a> </li><li>  <a href="http://essay.utwente.nl/57339/1/scriptie_Steghuis.pdf">essay.utwente.nl/57339/1/scriptie_Steghuis.pdf</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/223385/">https://habr.com/ru/post/223385/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../223373/index.html">We write your package for Chocolatey</a></li>
<li><a href="../223375/index.html">Mega-Tutorial Flask, Part 6: Profile page and avatar</a></li>
<li><a href="../223377/index.html">Natural language processing in the task of monitoring campaigning</a></li>
<li><a href="../223381/index.html">Calculation of property names at runtime in the Java language</a></li>
<li><a href="../223383/index.html">How to turn Pale Moon into a convenient browser</a></li>
<li><a href="../223387/index.html">Game ‚ÄúLAND‚Äù for DVK-3. Windows Reincarnation</a></li>
<li><a href="../223389/index.html">‚ÄúAyusha‚Äù - a controller on a 6502 processor</a></li>
<li><a href="../223395/index.html">LabView in robotics - creating a SCADA system to control the robot</a></li>
<li><a href="../223399/index.html">A little cycling under Linux or RSS-aggregator on the knee with your own hands</a></li>
<li><a href="../223401/index.html">The basic principles of setting up the Garbage Collection from scratch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>