<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Binary tree numbering</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How to number all binary trees? As on the KDPV: the ‚Äútree‚Äù of one leaf will be the first, the tree of two sheets will be the second, the second tree w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Binary tree numbering</h1><div class="post__text post__text-html js-mediator-article">  How to number all binary trees?  As on the KDPV: the ‚Äútree‚Äù of one leaf will be the first, the tree of two sheets will be the second, the second tree with another branch coming from the root will be the third.  And how to find the number of an arbitrary tree in such a scheme? <br><br><img src="https://habrastorage.org/webt/4l/nk/gs/4lnkgsbacqtgtx_mjqoybwvkn-y.png" alt="KDPV"><br><a name="habracut"></a><br>  First of all, the motor scooter is not mine.  The scheme described in the article was published by Caroline Colina and Giovanni Plazzotta (C. Colijn, G. Plazzotta) <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5790134/">in Systematic Biology</a> .  But since most of the Habr hardly reads English biological journals, I decided that it was worth translating a piece from there. <br><br>  Suppose that we already have a certain numbering scheme, and the numbering begins with a simple tree consisting of one sheet.  We call a tree consisting of two subtrees with numbers <i>k</i> and <i>j</i> such that <i>k</i> &gt; = <i>j</i> , <i>(k, j) -tree</i> .  The set of ( <i>k</i> , <i>j</i> ) -trees will be ordered lexicographically: (1), (1, 1), (2, 1), (2, 2), (3, 1), (3, 2) ... there will be a place for the tree in that order  That is, (1, 1) -tree is the same as tree number 2, (2, 1) -tree is the same as tree number 3, and so on.  You can check: on KDPV the way it is. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To translate ( <i>k, j</i> ) -notation into numbers, you need to pay attention to the fact that this is essentially a sequence of all possible pairs of natural numbers.  Since <i>k</i> &gt; = <i>j</i> &gt; = 1 by definition, there are exactly <i>k</i> ( <i>k</i> , <i>j</i> ) -pairs, from ( <i>k</i> , 1) to ( <i>k</i> , <i>k</i> ), for any <i>k</i> .  Therefore, ( <i>k</i> , 1) -pair has the number (1 + 2 + 3 + ... + <i>k</i> -1) + 1, because it is preceded by (1 + 2 + 3 + ... + <i>k</i> -1) pairs.  And, of course, the number of ( <i>k</i> , <i>j</i> ) -pairs is greater than the number of ( <i>k</i> , 1) -pairs of ( <i>j</i> -1).  Substituting the formula for the sum of an arithmetic progression and reducing the extra units, we arrive at the following formula: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>d</mi><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow><mo>+</mo><mi>j</mi><mo>+</mo><mn>1</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.733ex" height="2.66ex" viewBox="0 -832 14524.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-4E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-28" x="888" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-6B" x="1278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-2C" x="1799" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-6A" x="2244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-29" x="2657" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-3D" x="3324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-64" x="4630" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-66" x="5154" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-72" x="5704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-61" x="6156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-63" x="6685" y="0"></use><g transform="translate(7119,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-28" x="521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-6B" x="911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-2212" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-31" x="2655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-29" x="3155" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-32" x="10664" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-2B" x="11387" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMATHI-6A" x="12388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-2B" x="13022" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353338/&amp;xid=17259,15700022,15700043,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhYCVQyIoGAKZAoqWmKx7N27wClCw#MJMAIN-31" x="14023" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>N</mi><mo stretchy="false">(</mo><mi>k</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>d</mi><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo stretchy="false">(</mo><mi>k</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow><mo>+</mo><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> N (k, j) = \ dfrac {k (k - 1)} {2} + j + 1 </script></p><br><br>  The extra unit is explained by the fact that the sequence does not begin with (1, 1) -, but with (1) -tree.  Now the number of any arbitrary tree can be calculated in a recursive manner.  The target tree is by definition a ( <i>k</i> , <i>j</i> ) -tree, where <i>k</i> and <i>j</i> are subtrees growing from its root.  <i>The k-</i> tree, in turn, is ( <i>k1</i> , <i>k2</i> ) -tree, where <i>k1</i> and <i>k2</i> are its subtrees, and so on to the leaves, which are (1) -trees.  For example: <br><br><img src="https://habrastorage.org/webt/i4/iv/li/i4ivli3oltkdq7ehwmgurqtt0ju.jpeg" alt="image"><br><br>  From this method of calculating the numbers and the practical meaning of the whole venture.  Actually the numbers are a cool thing, but it's not very clear what to do with it further.  Is that to admire how a huge number took up all your RAM and wants more (in practice: marking about a dozen trees with 500 leaves can not fit in 64 GB, even using <a href="http://gmpy2.readthedocs.io/en/latest/intro.html">gmpy2</a> ).  They vary too much even with slight changes in the trees;  the two trees in the picture above, for example, differ only in that in the right one sheet is missing at the very bottom.  But each tree also corresponds to a vector of numbers of all its internal nodes.  And on the vectors, it is already possible to determine the distance metric (for example, Euclidean) and use it for clustering tree topologies.  In the original article, the trees were phylogenetic and managed to identify differences in the evolution of the influenza virus in the US and the tropics.  In the tropics, the disease occurs throughout the year, so all intermediate forms are observed (mass ( <i>k</i> , 1) subtrees to the right).  But in America, the flu is seasonal and mostly comes from abroad, so there are practically no such trees. <br><br><img src="https://habrastorage.org/webt/cb/ti/yn/cbtiynszd1rsowprhkfxvos3u6m.jpeg" alt="image"><br><br>  The <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5790134/">original article</a> still has a lot of interesting things: in particular, generalization for non-binary trees, various practically useful options for distance metrics, evidence that these are really metrics in the strict sense, the definition of mathematical operations on trees, and so on.  If you suddenly want to play, then the <a href="https://github.com/carolinecolijn/treetop">author's code on R</a> and <a href="https://github.com/synedraacus/metrics">my implementation on python</a> are available on the githaba.  Both, however, are designed for phylogenetic trees. </div><p>Source: <a href="https://habr.com/ru/post/353338/">https://habr.com/ru/post/353338/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353324/index.html">How is information security operational management center (SOC-center) built today?</a></li>
<li><a href="../353328/index.html">How to use getDerivedStateFromProps in React 16.3 (py subtitles)</a></li>
<li><a href="../353332/index.html">Own validations of fields for Rules in one class</a></li>
<li><a href="../353334/index.html">How to use the geodata analysis to predict the number of emergency calls in different parts of the city?</a></li>
<li><a href="../353336/index.html">5 Differences technical product manager from business-oriented PM</a></li>
<li><a href="../353340/index.html">How to create a startup empire without selling your freedom</a></li>
<li><a href="../353342/index.html">How I learn Agile practices and values</a></li>
<li><a href="../353344/index.html">And we count you. Universal labeling of goods is coming in Russia</a></li>
<li><a href="../353346/index.html">Riot Games: the anatomy of technical duty</a></li>
<li><a href="../353348/index.html">Do not protect the site from scraping: resistance is useless</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>