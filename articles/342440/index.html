<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Let's talk about Plesk with the Docker extension</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, the article Iron_Butterfly was published , where, among other things, it tells how you can run the most powerful search engine ElasticSearch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Let's talk about Plesk with the Docker extension</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/4w/hz/kc/4whzkcjw8efot7p_r0cw4s36wju.png" alt="Let's speak about Docker"><br><br>  Recently, the <a href="https://habrahabr.ru/company/plesk/blog/340274/">article</a> <a href="https://habrahabr.ru/users/iron_butterfly/" class="user_link">Iron_Butterfly was published</a> , where, among other things, it tells how you can run the most powerful search engine ElasticSearch inside the Docker container.  I want to continue this vector and tell you what other tasks can be solved with the help of Docker containers using Plesk and the Docker extension. <br><br><h2>  Short plan </h2><br>  In this article, we will look at how using the Docker extension can solve tasks that are hard or even impossible to solve with Plesk without Docker containers.  This list of tasks is based on the popular questions of our users;  as users, we will consider hosting owners, web application developers, WordPress admins. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Tasks: </h3><br>  - Simultaneous use of different versions of databases; <br>  - Expanding Memcached for WordPress; <br>  - Using your own cloud storage Nextcloud; <br>  - Run your own application on Go.  Running your own git repository; <br>  - Testing new versions of Plesk without interfering with the combat server. <br><br>  I want to clarify that all the examples in the article are made using the free version of the Docker extension;  The paid version allows you to manage Docker service on remote servers. <br><a name="habracut"></a><br><h2>  Instead of introducing </h2><br><div class="spoiler">  <b class="spoiler_title">Short glossary of terms used</b> <div class="spoiler_text"><ul><li>  <b>Docker</b> is an automation software for deploying and managing applications in a virtualization environment at the operating system level. </li><li>  <b>Docker extension (Docker extension)</b> is an extension that is installed inside the Plesk control panel to extend the functionality of the panel itself. </li></ul><br></div></div><br>  Before we go over to specific examples, let's take a quick look at the limitations in the current version and prepare Plesk to work with containers. <br><br><h3>  Known issues and limitations </h3><br><ul><li>  The ports specified in the Dockerfile are set to default by default.  For some containers, this behavior is undesirable.  Always check and close access to containers from the outside, if access is not required; </li><li>  It is possible to close access to the container from the outside by means of a system firewall.  In cloud environments, these ports can be closed by default by the cloud firewall and / or security group.  Containers in this case will be available from localhost; </li><li>  All volumes are connected with read-write permissions.  You cannot set read only rights; </li><li>  You cannot use docker-compose and its configuration files. </li></ul><br><h3>  Deploy environment.  Installing Docker Extensions </h3><br>  0. Obtain a valid certificate using Let's Encrypt (this is an optional step, I will remove the self-signed certificate warning); <br>  1. Select Extensions in the left menu; <br>  2. Find a Docker; <br>  3. Click ‚ÄúInstall‚Äù; <br>  4. Wait until the installation process is complete; <br>  5. Go to the extension.  Is done. <br><br>  <b>Get a valid certificate using Let's Encrypt (optional)</b> <br><br>  <b>Select Extensions in the left menu.</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/70/mb/aq/70mbaqm4mjkspsk9pqu4h-abobi.jpeg" alt="Select Extensions in the left menu."></div><br>  <b>Find a Docker</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/so/m9/jn/som9jn8nd65l9d0jnlyco0hrxkc.jpeg" alt="Find a Docker"></div><br>  <b>Click ‚ÄúInstall‚Äù</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n5/yr/pk/n5yrpkfylwghccsew5o9zpr9j54.jpeg" alt="Click Install"></div><br>  <b>Wait for the installation process to complete.</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kr/ys/6w/krys6wfkrpundngqkqe0nue6sua.jpeg" alt="Wait for the installation process to complete."></div><br>  <b>Go to the extension.</b>  <b>Is done</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_z/ej/i-/_zeji-g0ktvt-jyjqhkq8cj3na4.jpeg" alt="Go to the extension. Is done"></div><br><br><h3>  Tasks </h3><br><h4>  Hosting provider </h4><br><ul><li>  Clients on our forum periodically ask how to upgrade MySQL / MariaDB to the latest supported version of Plesk. </li><li>  Sometimes questions arise about how to use a web application that has a MySQL 5.7 or MariaDB 10.2 database specified in its minimum requirements, or if the client wants to use the latest version of the database, since  it is better in performance tests. </li><li>  The client wants full control over the MySQL server, not the database. </li></ul><br>  Soon we will look at how to solve the listed tasks, but before that we will see what tasks the web developer can face. <br><br><h4>  Web developer </h4><br>  Let's imagine that you are a web application developer.  Today you are starting to develop a new web application that will save all the data in a SQL database.  What SQL database will you use?  Perhaps you would prefer to write a web application so that it works with all popular databases, since  This will help to attract more customers.  So which databases do you know? <br><br><ul><li>  Officially supported in Plesk (this is not a complete list, just as an example) <br><br><ul><li>  MySQL 5.5 / 5.6 / 5.7 </li><li>  MariaDB 10.0 / 10.1 </li><li>  PosgreSQL 9.5 </li></ul><br></li><li>  Not supported in Plesk <br><br><ul><li>  MySQL 8.0 </li><li>  MariaDB 10.2 </li><li>  PostgreSQL 9.6 </li></ul></li><li>  Something else? <br><br><ul><li>  Microsoft SQL Server on Linux </li></ul><br></li></ul><br>  Well, your application is ready, but now you need to test it with all these databases.  Let's look at how this task can be solved with the help of Plesk, Docker and Docker extensions. <br><br><h4>  Install containers with all necessary databases </h4><br>  We will use the official Docker Hub containers: <br><br><ul><li>  MySQL: <a href="https://hub.docker.com/_/mysql/">hub.docker.com/_/mysql</a> </li><li>  MariaDB: <a href="https://hub.docker.com/_/mariadb/">hub.docker.com/_/mariadb</a> </li><li>  PostgreSQL: <a href="https://hub.docker.com/_/postgres/">hub.docker.com/_/postgres</a> </li></ul><br>  <b>Consider the installation of one of the containers, let's say MariaDB 10.0:</b> <br><br><ol><li>  Find the available containers with MariaDB, select the required version; </li><li>  Wait until the installation is complete; </li><li>  Configure the necessary parameters: <br><br><ul><li>  Turn on autoload; </li><li>  Specify static port mapping; </li><li>  Add volume mapping so that data is stored outside the container; </li><li>  Set the environment variable with the password for root. </li></ul></li><li>  Create a container and wait for it to start. </li></ol><br>  Repeat the steps to create containers for MariaDB 10.1 / 10.2, MySQL 5.5 / 5.6 / 5.7 / 8.0, PostgreSQL 9.5 / 9.6. <br><br>  <b>Find the available containers with MariaDB, select the version you want.</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/le/wt/di/lewtdixjf7tazmq859c3ei8dmbk.jpeg" alt="Find the available containers with MariaDB, select the version you want."></div><br>  <b>Wait for the installation to complete.</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bp/fh/cp/bpfhcpukhbez39chcchaxfsimcq.jpeg" alt="Wait for the installation to complete."></div><br>  <b>Set the necessary parameters</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u3/uf/ti/u3uftiektdh1_vnrvrdpwmhvw1c.jpeg" alt="Set the necessary parameters"></div><br>  <b>Create a container and wait for it to start.</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/29/dk/wo/29dkwojp-5ffvlqbou1it0jbx-8.jpeg" alt="Create a container and wait for it to start."></div><br>  <b>Repeat container creation steps</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wc/yu/ex/wcyuex60hwqrofjkty43-zszinm.jpeg" alt="Repeat container creation steps"></div><br><h4>  Using Created Databases in Plesk </h4><br>  Below are two options for the possible use of the created databases: <br><br><ul><li>  Add the created databases to Plesk so that customers can use them in their subscriptions. </li><li>  If the database is not supported by Plesk, then you can use it by connecting directly (this is relevant, for example, for MySQL 8.0) </li></ul><br>  A few screenshots that show how the result looks like on the configured system. <br><br>  <b>Add DB to Plesk</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mr/44/k_/mr44k_uuzcdbczsetbh_lvvedpo.jpeg" alt="Add DB to Plesk"></div><br>  <b>The resulting resulting DB list in Plesk</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/s7/dr/hq/s7drhqlpqfccjwv2qt6t42cno_c.jpeg" alt="The resulting resulting DB list in Plesk"></div><br>  <b>How it all looks inside the OS</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bv/gw/5z/bvgw5z32k_o4a8jqvsxwd1wmugg.jpeg" alt="How it all looks inside the OS"></div><br><h3>  WordPress Admin </h3><br>  Another task that may be relevant for site owners with Wordpress, and the solution of which I would like to consider in this article. <br><br><ul><li>  Install the Memcached daemon to increase the speed of WordPress and reduce the load on the CPU. <br><br><ul><li>  <u>For security reasons, you should disable access to Memcached from anywhere except WordPress.</u> <br><ul><li>  In this example, Plesk is deployed in Google Cloud, so I am protected by the cloud platform's firewall. </li></ul></li></ul></li></ul><br>  <b>Steps:</b> <br><br><ol><li>  Check your firewall settings; you should block external connections to memcached; </li><li>  Find and install the container with Memcached; </li><li>  Enable autorun and configure port mapping; </li><li>  Run the container; </li><li>  Check that everything works. </li></ol><br>  <b>Check your firewall settings, you must block external connections to memcached (individually)</b> <br><br>  <b>Find and install a container with memcached</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/he/fx/be/hefxbesegjgrirrd4ezmakxo4oi.jpeg" alt="Find and install a container with memcached"></div><br>  <b>Enable autorun and configure port mapping</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bs/fl/sj/bsflsjqwao3x55t3n-yk8714mhy.jpeg" alt="Enable autorun and configure port mapping"></div><br>  <b>Run the container</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/o3/gd/sx/o3gdsxefubpdautfhfsi_nasfsq.jpeg" alt="Run the container"></div><br>  <b>Check that everything works.</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/he/fx/be/hefxbesegjgrirrd4ezmakxo4oi.jpeg" alt="Check that everything works."></div><br><h3>  Organization </h3><br>  A task that may be relevant for small organizations: you want to have your own resource for file sharing based on Nextcloud.  This problem can also be easily solved. <br><br><h4>  Own Nextcloud in Plesk with Docker? </h4><br><br>  <b>Steps:</b> <br><br><ol><li>  Find and install the container with Nextcloud; <br><br><ul><li>  Please note that the volume mapping is not configured;  This is done deliberately, because  inside Dockerfile for Nextcloud, use unnamed docker volume. </li></ul></li><li>  Wait until it starts; </li><li>  Configure proxy rules for Docker in ‚ÄúWebsites &amp; Domains‚Äù; </li><li>  Open the Nextcloud web interface and set the name and password for the administrator; </li><li>  Is done.  You can use Nextcloud. </li></ol><br>  <b>Find and install the container with Nextcloud</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qu/ta/qe/qutaqex82oqutf2zv3yg6mbo1ac.jpeg" alt="Find and install the container with Nextcloud"></div><br>  <b>Wait until it starts.</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lw/7j/9a/lw7j9alc5izgo2hfmnzmbhamzvi.jpeg" alt="Wait until it starts."></div><br>  <b>Configure proxy rules for Docker in ‚ÄúWebsites &amp; Domains‚Äù</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tw/u1/xw/twu1xwsja0eoid-fn5xnksfqkly.jpeg" alt="Configure proxy rules for Docker in Websites &amp; Domains"></div><br>  <b>Open the web interface of Nextcloud, set the name and password for the administrator</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/oc/he/i2/ochei2qm_rbieax5ccawghurveq.jpeg" alt="Open the Nextcloud web interface and set the name and password for the administrator."></div><br>  <b>Is done.</b>  <b>You can use Nextcloud</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mv/2j/66/mv2j66l01ily38f5frnwc3rgaac.jpeg" alt="Is done. You can use Nextcloud"></div><br><h3>  Go developer </h3><br>  Currently, Plesk does not have extensions that allow you to work with Go, but you can write an application on Go and run it under Plesk in a Docker container.  I do not know how to write on Go, so for clarity, I will take the finished product written on Go and show you how to run your own git-service in Plesk. <br><br>  <b>Find a container with Gogs</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lp/rx/rf/lprxrfblmyhvv5n6w9csydne-q0.jpeg" alt="Find a container with Gogs"></div><br>  <b>Set up a container with Gogs</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/my/sj/mm/mysjmm8njagqog90gvqn1srvn4o.jpeg" alt="Set up a container with Gogs"></div><br>  <b>Run the container with Gogs</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6_/aa/w3/6_aaw3yq5tpkd10wx0l5brojvqe.jpeg" alt="Run the container with Gogs"></div><br>  <b>Specify the initial settings for the Gogs itself</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fs/zf/fd/fszffdpfunv8n3g3ccxmmq5nn38.jpeg" alt="Specify the initial settings for the Gogs itself"></div><br>  <b>Is done.</b>  <b>Own git service is up and running</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4h/de/lk/4hdelkmjqsb_w1slt4gmy-gr08o.jpeg" alt="Is done. Own git service is up and running"></div><br>  <b>Create the first repository.</b>  <b>Let's call it ... HelloWorld</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lz/kj/xv/lzkjxvssb0zqwkoe5slsmbcgjce.jpeg" alt="Create the first repository. Call it ... HelloWorld"></div><br><h3>  Testing new versions of Plesk! </h3><br>  Let's install Plesk as a Docker container in Plesk with the Docker extension!  Immediately answer the question "Why?": <br><br><ul><li>  You can test your own planned changes in an isolated environment, regardless of the combat version of the site and only then apply them to the public version of the site. <br></li><li>  You can deploy Plesk Preview, see the new functionality, if necessary, check in advance that the websites are ready to be updated in the future. </li></ul><br>  <b>Find a Plesk Container</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mf/k-/k_/mfk-k_uibhyceqvnru69e7vcf_u.jpeg" alt="Find a Plesk Container"></div><br>  <b>Customize Plesk Container</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5k/7q/ps/5k7qps5vcueunxx3lm7fku4qv6c.jpeg" alt="Customize Plesk Container"></div><br>  <b>Launch the Plesk container.</b>  <b>Is done.</b>  <b>Can check</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hl/9e/bj/hl9ebj9vod1njd34lhht3y3da6a.jpeg" alt="Launch the Plesk container. Is done. Can check"></div><br><h2>  Conclusion </h2><br>  Instead of a conclusion, I propose to discuss in the comments which public containers with Docker Hub you regularly use in your daily work, or vice versa, why did you refuse to use public containers in your tasks. </div><p>Source: <a href="https://habr.com/ru/post/342440/">https://habr.com/ru/post/342440/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342430/index.html">Interns</a></li>
<li><a href="../342432/index.html">Do I need the OPTIONS method in REST services?</a></li>
<li><a href="../342434/index.html">Levenshtein distance in MySQL and fuzzy search algorithms using PHP</a></li>
<li><a href="../342436/index.html">Manage complex IT infrastructure of an application from a web interface? Easy</a></li>
<li><a href="../342438/index.html">How was the October moscowcss. Video recordings from the meeting of moscowcss ‚Ññ5 from the office of Tutu.ru October 31, 2017</a></li>
<li><a href="../342442/index.html">Independent data centers: fuel cells instead of electrical</a></li>
<li><a href="../342444/index.html">Operating ROCA's crypto-vulnerability may be easier than intended.</a></li>
<li><a href="../342446/index.html">CRM systems: what is it? Simple words</a></li>
<li><a href="../342448/index.html">What is a business process and business process description</a></li>
<li><a href="../342450/index.html">Shazam Vice President EMEA, LATAM and Canada Josh Partridge: ‚ÄúIT specialists lack understanding of business processes‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>