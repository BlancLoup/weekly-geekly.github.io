<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Severe Therapy: Pale Anti-Fever for MacOS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="You will say that here and out of the box everything is fine and everything seems to be brilliant, right up to the autogeneration of such a password f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Severe Therapy: Pale Anti-Fever for MacOS</h1><div class="post__text post__text-html js-mediator-article">  You will say that here and out of the box everything is fine and everything seems to be brilliant, right up to the autogeneration of such a password for web sites, which is not even visually perceived from the fifth attempt, however, let us imagine that it is important for us to protect ourselves not only from everyday hackers, but also from the system developers themselves. <br><a name="habracut"></a><br>  My research into these moments began as soon as OS X Lion 10.7 was released, and I initially used third-party software to protect it, which was paid and very effective, until I figured out what was happening and by which this software covered this result. <br><br>  Actually, here is a simple script that silences the firewall management through the internal services of the MacOS system based on anchors and gives control directly to the packet filter, which blocks all incoming connections in general: <br><br><pre><code class="hljs vbscript"># # Ninja PF configuration file( original located <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> /etc/pf.conf.backup ). # # This file contains the main ruleset, which gets automatically loaded # at startup. PF will <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> be automatically enabled, however. Instead, # <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> component which utilizes PF <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> responsible <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> enabling <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> disabling # PF via -E <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> -X as documented <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> pfctl(<span class="hljs-number"><span class="hljs-number">8</span></span>). That will ensure that PF # <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> disabled only when the last enable reference <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> released. # # Care must be taken <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> ensure that the main ruleset does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> flushed, # as the nested anchors rely <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the anchor point defined here. <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> addition, # <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the anchors loaded by this file, some system services would dynamically # insert anchors into the main ruleset. These anchors will be added only when # the system service <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> used <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> would removed <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> termination of the service. # # See pf.conf(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> syntax. # # ICMP configure icmp_types = <span class="hljs-string"><span class="hljs-string">"{echoreq, echorep, unreach}"</span></span> icmp6_types = <span class="hljs-string"><span class="hljs-string">"{echoreq, unreach, echorep, 133, 134, 135, 136, 137}"</span></span> netbios_types = <span class="hljs-string"><span class="hljs-string">"{137,138,139}"</span></span> interfaces = <span class="hljs-string"><span class="hljs-string">"{en0, en1, en2, en3, en4}"</span></span> # Base policy <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> fingerprints <span class="hljs-string"><span class="hljs-string">"/etc/pf.os"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> block-policy drop <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> state-policy <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-bound <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> require-order yes <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> optimization aggressive <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ruleset-optimization none <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> skip <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> lo0 scrub <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> all fragment reassemble no-df min-ttl <span class="hljs-number"><span class="hljs-number">64</span></span> max-mss <span class="hljs-number"><span class="hljs-number">1440</span></span> scrub out all random-id block <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> all pass out quick flags S/SA modulate state # Antispoofing antispoof quick <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> $interfaces inet antispoof quick <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> $interfaces inet6 # More secure settings block <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> from urpf-failed <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> any block <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> quick <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> $interfaces from any <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">255.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span> block <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> quick <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> $interfaces from any <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">255.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> # ICMP policy block <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> inet proto icmp all icmp-type $icmp_types keep state block <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> inet6 proto icmp6 all icmp6-type $icmp6_types keep state block <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> $interfaces proto {tcp,udp} from any <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> any port $netbios_types</code> </pre> <br>  Do not forget to tick the firewall in the preferences.  To verify that PF is running, simply run in a terminal. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">sudo pfctl -sa</code> </pre> <br>  Here, briefly collected patterns of rules for managing connections and interfaces, and the setting itself as much as possible blocks incoming traffic.  If you are completely paranoid - just comment out the line set skip on lo0 and you will save the system from a working web server and block most applications from accessing the loop back interface (terminal loop). <br><br>  Lo0 is usually useful to block if you like to play pirated games with torrents, which are often patched by an explorer or some other rubbish. <br><br>  The second thing the script does is, by agreement with the user, to set advanced kernel security settings. <br><br>  Here is a brief listing: <br><br><pre> <code class="hljs dos"># <span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">13</span></span>.<span class="hljs-number"><span class="hljs-number">4</span></span> system ctl configuration # Kernel IPC overrides kern.ipc.somaxconn=<span class="hljs-number"><span class="hljs-number">100</span></span> # kernel security level(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> - soft security level or <span class="hljs-number"><span class="hljs-number">2</span></span> - can't install any software) kern.securelevel=<span class="hljs-number"><span class="hljs-number">1</span></span> # Speed up TM backups debug.lowpri_throttle_enabled=<span class="hljs-number"><span class="hljs-number">0</span></span> kern.coredump=<span class="hljs-number"><span class="hljs-number">0</span></span> # Networking settings <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.link.ether.inet.max_age=<span class="hljs-number"><span class="hljs-number">600</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.redirect=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet6.ip6.redirect=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.sourceroute=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.accept_sourceroute=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.linklocal.<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>.allowbadttl=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.icmp.bmcastecho=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.icmp.icmplim=<span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.icmp.maskrepl=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.udp.blackhole=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.blackhole=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.delayed_ack=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.always_keepalive=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.rfc3390=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.rfc1644=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.tso=<span class="hljs-number"><span class="hljs-number">0</span></span> # Incoming and outgoing port ranges <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.sack_globalmaxholes=<span class="hljs-number"><span class="hljs-number">2000</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.portrange.first=<span class="hljs-number"><span class="hljs-number">1024</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.portrange.last=<span class="hljs-number"><span class="hljs-number">65535</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.portrange.hifirst=<span class="hljs-number"><span class="hljs-number">1024</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.portrange.hilast=<span class="hljs-number"><span class="hljs-number">2500</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.check_interface=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.keepidle=<span class="hljs-number"><span class="hljs-number">50000</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.ip.rtmaxcache=<span class="hljs-number"><span class="hljs-number">1024</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.path_mtu_discovery=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet6.icmp6.rediraccept=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet.tcp.msl=<span class="hljs-number"><span class="hljs-number">4500</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet6.icmp6.nodeinfo=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet6.ip6.accept_rtadv=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet6.ip6.auto_linklocal=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet6.ip6.only_allow_rfc4193_prefixes=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.inet6.icmp6.nd6_onlink_ns_rfc4861=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  These kernel parameters tighten the network connection policy including all possible RFCs and blocking all possible noises (echoes, redirects, and so on), and the kern.securelevel = 1 parameter, which can be extremely useful for a pen tester, is worth special attention. <br><br>  kern.securelevel = 2 completely blocks the installation of any packages in the system.  Generally tight.  But the system does not lose performance. <br><br>  I also turned over the ports of applications requiring high values ‚Äã‚Äãand landed them lower so that the traffic was not comfortable to ‚Äúlisten‚Äù. <br><br>  Next, the script added customization options for some of the Finder display options and small settings for Safari.  For example, it is necessary to disable the AV Foundation and other media functions in the same way as with a single picture from a web site you can hack the system through audio and video streams. <br><br>  And in general, it is strange, but even iTunes on MacOS follows, so I prefer a full tank. <br><br>  The patch <a href="https://github.com/xShiftx/10.13.4-security-fix">is posted on GitHub</a> .  To run, use <br><br><pre> <code class="bash hljs">sudo ./fix.sh</code> </pre> <br>  If you have any suggestions and amendments, I suggest sharing your thoughts in the comments. </div><p>Source: <a href="https://habr.com/ru/post/421221/">https://habr.com/ru/post/421221/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../421209/index.html">IaaS in eCommerce and finance: who and why switched to virtual infrastructure</a></li>
<li><a href="../421211/index.html">PowerShell and Group Policy Preferences, when the printers account for hundreds</a></li>
<li><a href="../421213/index.html">DJI Mavic 2 Pro / Zoom in detail</a></li>
<li><a href="../421215/index.html">How I hacked Steam. Twice</a></li>
<li><a href="../421217/index.html">Python support in Power BI</a></li>
<li><a href="../421223/index.html">DevFest SPB 2018</a></li>
<li><a href="../421225/index.html">SENS-diagnostics. Biomarkers of mitochondrial dysfunction and oxidative stress</a></li>
<li><a href="../421227/index.html">Overview of cross-platform mobile development frameworks</a></li>
<li><a href="../421229/index.html">Story of my headache</a></li>
<li><a href="../421235/index.html">Magic Leap One glasses - points for $ 2295 with maintainability 3 of 10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>