<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>My URL is not your URL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When I started working on httpget, the predecessor of the Curl project, long ago in 1996, I wrote my first URL parser. Just then, this universal addre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>My URL is not your URL</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/24b/4ab/8bd/24b4ab8bd2b8487c8f8d45581d704d71.jpg"><br><br>  When I started working on httpget, the predecessor of the Curl project, long ago in 1996, I wrote my first URL parser.  Just then, this universal address was named <a href="https://www.ietf.org/rfc/rfc1738.txt">URL</a> : Uniform Resource Locator (single resource index).  Its specification was published by the IETF in 1994.  The URL abbreviation was then used as an inspiration for the tool name and the <a href="https://curl.haxx.se/">Curl</a> project. <br><br>  The term ‚ÄúURL‚Äù was later changed;  it came to be called the <a href="https://www.ietf.org/rfc/rfc3986.txt">URI</a> (Uniform Resource Identifier - Uniform Resource Identifier), according to the specification published in 2005, but the main preserved: the syntax for the string that specifies the online resource and specifies the protocol for obtaining this resource.  We require curl URLs, as defined by this RFC 3986 specification. Below, I‚Äôll tell you why this is not quite true. <br><a name="habracut"></a><br>  There was also a related RFC describing <a href="https://www.ietf.org/rfc/rfc3987.txt">IRI</a> : Internationalized Resource Identifier (international resource identifier).  IRI is essentially the same as a URI, but IRI allows non-ASCII characters to be used. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://whatwg.org/">The WHATWG consortium</a> later created its own <a href="https://url.spec.whatwg.org/">URL specification</a> , mainly bringing together formats and ideas from URI and IRI with a strong focus on browsers (which is not surprising).  One of the <a href="https://url.spec.whatwg.org/">goals</a> they declared was ‚ÄúUpgrade RFC 3986 and RFC 3987 in accordance with current implementations and gradually eliminate them.‚Äù  They want to go back to using the term ‚ÄúURL‚Äù, rightly stating that the terms URI and IRI simply confuse the situation and that people never understand them (or often don‚Äôt even know that these terms exist). <br><br>  The WHATWG specification is written in the spirit of the good old browser mantra: be as liberal as possible with users, always try to guess what they mean, and turn inside out trying to do it.  Although at the same time we all know now that the <a href="https://en.wikipedia.org/wiki/Robustness_principle">law of Postel</a> is not the best approach to business.  In practice, this means that the specification allows you to use too many slashes, spaces and non-ASCII characters in the URL. <br><br>  From my point of view, such a specification is also very difficult to read and comply with, since it does not describe the syntax or format in great detail, but at the same time imposes a mandatory parsing algorithm.  To verify my statement: see what this specification says about the end point after the host name in the URL. <br><br>  In addition to all these standards and specifications, in the interface of all browsers there is an address bar (which is often called differently), which allows users to enter any funny lines and convert them to URLs.  If you enter " <code>http://localhost/%41</code> " in the address bar, then the segment with the percentage will be converted to "A" (since 41 in hexadecimal is the capital letter A in ASCII), but if you enter " <code>http://localhost/AA</code> ", then in fact the outgoing HTTP GET request will be sent to" <code>/A%20A</code> "(with a space in the URL encoding).  I say this because people often think that all that can be entered on this line is the URL. <br><br>  The above is mainly my (distorted) representation, with which specifications and standards we have to work with.  Now let's add reality and see what problems we get when my URL is not your URL. <br><br><h4>  So what is a URL? </h4><br>  Or more specifically, how do we write them?  What syntax is used? <br><br>  I think one of the biggest mistakes in the WHATWG specification (and the reason why I oppose this specification in its current form with the firm conviction that they are wrong) is that they believe that only they are allowed to work with the URL and to define them;  they limit their view of the URL only to browsers, HTML, and address strings.  Of course, WHATWG was created by large companies representing browsers that almost everyone uses, and URLs are widely used in these browsers, but the URLs themselves are much more significant. <br><br>  The representation of the URL that exists in the WHATWG is not widely accepted outside of browsers. <br><br><h4>  Colon-slash slash </h4><br>  If you ask users ‚Äî ordinary people without any particular knowledge of the protocols or the network ‚Äî what is a URL, what will they answer?  The sequence ": //" (colon-slash-slash) would be at the beginning of the list of responses;  a few years ago, when browsers showed the URL more fully, it would be even more noticeable.  After seeing this sequence, we immediately understand that we are the URL. <br><br>  However, let's move away from users and look around - there are mail clients in the world, terminal emulators, text editors, Perl scripts, and many other things that can recognize URLs and work with them.  For example, open a URL in a browser, turn it into an active link in the generated HTML, and so on.  A huge number of named scripts and programs will use exactly the sequence "colon-slash-slash" as the main feature. <br><br>  The WHATWG specification says that there must be at least one slash and that the parser must accept any number of slashes.  This means that " <code>http:/example.com</code> " and " <code>http:///////////////example.com</code> " are completely suitable options.  RFC 3986 and many others disagree.  Well, indeed, most of the people I have been arguing with over the past few days, even those who work on the web, speak, think and are convinced that the URL has two slashes.  Just take a closer look at the screenshot of the Google image search result for the ‚ÄúURL‚Äù above in this article. <br><br>  We just know that a URL has two slashes (although, yes, file: type URLs usually have three slashes, but for now let's ignore this).  Not alone.  Not three.  Two.  But the WHATWG disagrees. <br><br>  ‚ÄúIs there at least one real reason for accepting more than two slashes for non-file URLs?‚Äù (I ask irritably at the WHATWG members) <br><br>  <i>" <a href="https://github.com/whatwg/url/issues/118">The fact is, all browsers do this.</a> "</i> <br><br>  <i>The specification says this because browsers have implemented it that way.</i> <br><br>  No better explanation was given even after I indicated that this statement is incorrect and not all browsers do this.  Perhaps this thread of discussion will seem very informative. <br><br>  In the Curl project, we just recently started discussing how to handle URLs that have a number of slashes other than two, because it turns out that there are already servers that send back such URLs in <a href="https://tools.ietf.org/html/rfc7231">the ‚ÄúLocation:‚Äù header</a> , and some browsers accept without objection their.  Curl is not, just like most of the many other libraries and command line tools.  Who do we support? <br><br><h4>  Spaces </h4><br>  The space character (code 32 in ASCII, hex code 0x20) cannot be part of the URL.  If you want to send it, you should use the URL encoding, as is done with any other invalid character that needs to be made part of the URL.  URL encoding is a byte value in hexadecimal with a percent sign in front of it.  Thus, "% 20" means a space.  It also means that the parser, such as scanning text for URLs, finds out that it has reached the end of the URL when it detects an invalid character.  For example, a space. <br><br>  Browsers usually convert all% 20 in their address lines to a space character so that the links look decent.  When copying the address to the buffer and pasting it into a text editor, we see spaces as% 20, as required. <br><br>  I'm not sure if this is the reason, but browsers also accept spaces as part of the URL, receiving, for example, redirection in an HTTP response.  Such URLs are transmitted from the server to the client in the ‚ÄúLocation:‚Äù header.  Browsers easily allow spaces in their URLs, encoding them in the form of% 20 and sending the next request.  This causes curl to accept spaces in the redirected "URL". <br><br><h4>  Non-ascii </h4><br>  Supporting languages ‚Äã‚Äãin languages ‚Äã‚Äãthat include non-ASCII characters is of course important, especially for non-Western communities, and I agree that the IRI specification has never been good enough.  I personally am far from being an expert in internationalization, so I am guided by what I have heard from others.  But, of course, users of non-Latin alphabets and printing systems should be able to write their ‚ÄúInternet addresses‚Äù into resources and use them as links. <br><br>  In the ideal case, we would have an internationalized version for display to the user, and an ASCII version for internal use in network requests. <br><br>  For international domain names, the name is converted to punycode so that it can be read by regular DNS servers that do not know anything about names in non-ASCII encoding.  URIs do not have IDN names;  IRI and WHATWG URLs are.  Curl supports IDN hostnames. <br><br>  WHATWG states that URLs can use UTF-8, whereas URIs are only ASCII.  Curl does not accept non-ASCII characters in the path part of the address, but encodes them as a percentage in outgoing requests;  this causes ‚Äúinteresting" side effects when non-ASCII characters are represented in code other than UTF-8, which is, for example, standard for Windows. <br><br>  Like what I wrote above, this results in servers sending back non-ASCII codes in HTTP headers that browsers readily accept, and non-browsers also have to work with them. <br><br><h4>  URL standard does not exist </h4><br>  I did not try to present a complete list of problems or inconsistencies - here is just some selection of the difficulties that I recently encountered.  A ‚ÄúURL‚Äù issued in one place, of course, will not necessarily be accepted or understood in another place as a ‚ÄúURL‚Äù. <br><br>  Nowadays, even curl no longer follows a strictly published specification - we are slowly degrading in favor of ‚Äúweb compatibility‚Äù. <br><br>  There is no uniform URL standard, and there is no work in this direction.  I cannot believe that the WHATWG makes real efforts for this, since it writes the specification to a closed group without serious attempts to involve the wider community. <br><br></div><p>Source: <a href="https://habr.com/ru/post/301516/">https://habr.com/ru/post/301516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../301506/index.html">Generation 13, the fourth wave: entry-level Dell PowerEdge servers</a></li>
<li><a href="../301508/index.html">Webinar "Work in the company or master: reveal the pros and cons for the developer"</a></li>
<li><a href="../301510/index.html">PHDays VI: hackers could not take the city entirely</a></li>
<li><a href="../301512/index.html">ASP.NET Core Today: Pros and Cons</a></li>
<li><a href="../301514/index.html">Yandex employees will represent Russia in the C ++ Standardization Committee</a></li>
<li><a href="../301518/index.html">Russian IT companies view Agile as a means to implement an ‚Äúemergency strategy‚Äù of development in the market.</a></li>
<li><a href="../301520/index.html">ITMO University Digest: # 3 Neural networks: interesting articles from ITMO University journals</a></li>
<li><a href="../301522/index.html">Structure from motion</a></li>
<li><a href="../301524/index.html">What does Apple Watch: a year later</a></li>
<li><a href="../301528/index.html">80 for 20 - how not to optimize processes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>