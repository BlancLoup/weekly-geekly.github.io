<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PHPShop Optimization</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It so happened that one of our customers ordered us to add to his online store several tens of thousands of products. His shop worked at the well-know...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PHPShop Optimization</h1><div class="post__text post__text-html js-mediator-article">  It so happened that one of our customers ordered us to add to his online store several tens of thousands of products.  His shop worked at the well-known <a title="PHPShop" href="http://phpshop.ru/">PHPShop (version 2.1.8)</a> .  Up to this point, I have not met with this "miracle".  After adding the first 5000 products, the store came down and could show only a white page.  Those support answered that it was all because of the host (MasterHost).  I believed them and decided to try everything on a local web server.  The store showed the same picture.  Moreover, the task list showed that Apache ‚Äúeats‚Äù 200 MB of RAM.  I had to climb into the inside ... <br><a name="habracut"></a><br>  After a brief search, it was found that when displaying goods, the script did not query the database to get a specific product.  It turned out that when you run the script, all the goods from the database are placed in the global array, and then, when you need a certain product, it was taken from this array.  And for some reason, the module, which in theory should be responsible for caching (cache.inc.php), was doing this.  It seemed to me very strange.  To rewrite the whole script so that the data was taken from the database only when it was needed, it took a long time (this global array was used very often) and there was no time, because the customer was in a hurry.  We had to look for another way out and it was found. <br><br>  It was necessary to make the data in the array fall only when accessing it.  After a brief search, the ArrayAccess interface was found, which allows the object to be accessed as an element of an array.  For a couple of hours it was all implemented.  Now the data in the array fell only when accessing it.  Also, in addition, all the received data was cached to avoid loading MySQL server. <br><br>  Solving the problem not only restored the store‚Äôs performance, but also reduced the page generation time by a factor of two. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If someone is interested in looking at the code for solving a problem, I can publish it in its entirety in the next post. <br><br>  If the developers of PhpShop see this post, I would like to know what they were guided by, creating a global array with all the goods in advance. </div><p>Source: <a href="https://habr.com/ru/post/62470/">https://habr.com/ru/post/62470/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62458/index.html">Antithegs</a></li>
<li><a href="../62460/index.html">Google and Facebook will try to make money on unrest in Iran</a></li>
<li><a href="../62464/index.html">CSS Tidy: need help</a></li>
<li><a href="../62466/index.html">Not satisfied with the quality of hosting? Write a complaint!</a></li>
<li><a href="../62468/index.html">We register the program, we receive the certificate</a></li>
<li><a href="../62475/index.html">PHP Visual Reflector</a></li>
<li><a href="../62476/index.html">MUSICDEPO.RU - Community of Artists and Fans</a></li>
<li><a href="../62477/index.html">[3.0.] Jailbreak Tightens</a></li>
<li><a href="../62478/index.html">UbuntuOne open</a></li>
<li><a href="../62482/index.html">Web Proxy service for Opera Unite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>