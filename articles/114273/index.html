<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SVN hooks: revision comment revision</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is no secret that by default, changing the text of the comment to the revision in SVN is not allowed. The post is intended for those who want to ma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SVN hooks: revision comment revision</h1><div class="post__text post__text-html js-mediator-article">  It is no secret that by default, changing the text of the comment to the revision in SVN is not allowed.  The post is intended for those who want to make it possible, but do not know how. <br><a name="habracut"></a><br>  First, let's refresh our memory a little. <br><br><h3>  What is a hook. </h3><br>  No, this is not a Spielberg film, we are on a habr.  This is the hook that caught the event :) Just a program that runs when a specific event occurs in the version control system.  They are supported not only by SVN, so you can play around with hooks for example in GIT. <br>  If there is a hooks folder in the root of your repository, you should know that this is the hooks nest.  Hook templates can be stored in this folder, the names of which correspond to the events being tracked. <br><pre><code class="hljs pgsql">$ ls repos/hooks/ post-<span class="hljs-keyword"><span class="hljs-keyword">commit</span></span>.tmpl post-unlock.tmpl pre-revprop-change.tmpl post-<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>.tmpl pre-<span class="hljs-keyword"><span class="hljs-keyword">commit</span></span>.tmpl pre-unlock.tmpl post-revprop-change.tmpl pre-<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>.tmpl <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">commit</span></span>.tmpl $</code> </pre> <br>  This means that based on these patterns you can make your hook.  As you may have guessed, pre-hooks are triggered before the event.  post-hooks - after the event. <br>  * <b>start-commit</b> - runs before the start of the transaction, can be used to verify rights. <br>  * <b>pre-commit</b> - runs at the end of a transaction, but before commit, it is often used to validate data, for example, to check non-empty log messages. <br>  * <b>post-commit</b> - runs after a transaction, can be used to send e-mail or to reserve storage. <br>  * <b>pre-revprop-change</b> - run before changes in revision, can be used to check access. <br>  * <b>post-revprop-change</b> - run after changes in revision, can be used to send e-mail. <br>  * <b>post-lock</b> , <b>post-unlock</b> , <b>pre-lock</b> , <b>pre-unlock</b> - run when the repository works with locks <br><br>  It would not be superfluous to mention that the user who connects to the repository, and therefore runs the hooks, must have execution rights. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Change Revision Comment </h3><br>  Let us turn to the solution of our problem.  Use the pre-revprop-change hook to introduce additional controls.  In addition, it should be remembered that the following parameters are passed to the hook <br>  1. Path to the repository <br>  2. Audit, whose properties will change <br>  3. The name of the user who will make the changes <br>  4. Name of changeable property <br>  5. Action code: A (added), D (deleted), or M (modified) <br><br><h4>  Hook right. </h4><br>  In * nix systems, it is enough to create the corresponding file in the <b>hooks</b> folder without an extension, for example, <b>pre-revprop-change</b> <br><br><pre> <code class="hljs pgsql">#!/bin/sh #  . REPOS="$1" REV="$2" <span class="hljs-keyword"><span class="hljs-keyword">USER</span></span>="$3" PROPNAME="$4" ACTION="$5" #       (   ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ "$ACTION" = "M" -a "$PROPNAME" = "svn:log" ]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> echo "Changing revision properties other than svn:log is prohibited" &gt;&amp;<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> fi</code> </pre><br><br><h4>  Hook left. </h4><br>  On Windows, the file in the <b>hooks</b> folder must be executable, for example, <b>pre-revprop-change.bat</b> <br><br><pre> <code class="hljs sql">@ECHO OFF ::  . <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> repository=%<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> revision=%<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> userName=%<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> propertyName=%<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">action</span></span>=%<span class="hljs-number"><span class="hljs-number">5</span></span> ::     (   ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> /I <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-string"><span class="hljs-string">"%propertyName%"</span></span> == <span class="hljs-string"><span class="hljs-string">"svn:log"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> ERROR_PROPNAME ::     (     ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> /I <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-string"><span class="hljs-string">"%action%"</span></span> == <span class="hljs-string"><span class="hljs-string">"M"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> ERROR_ACTION :: ,      . <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> bIsEmpty=<span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f <span class="hljs-string"><span class="hljs-string">"tokens=*"</span></span> %%g <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'find /V ""'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> bIsEmpty=<span class="hljs-literal"><span class="hljs-literal">false</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%bIsEmpty%"</span></span> == <span class="hljs-string"><span class="hljs-string">"true"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> ERROR_EMPTY <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :eof :ERROR_EMPTY echo <span class="hljs-keyword"><span class="hljs-keyword">Empty</span></span> svn:<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> messages <span class="hljs-keyword"><span class="hljs-keyword">are</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> allowed. &gt;&amp;<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> ERROR_EXIT :ERROR_PROPNAME echo <span class="hljs-keyword"><span class="hljs-keyword">Only</span></span> changes <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> svn:<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> messages <span class="hljs-keyword"><span class="hljs-keyword">are</span></span> allowed. &gt;&amp;<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> ERROR_EXIT :ERROR_ACTION echo <span class="hljs-keyword"><span class="hljs-keyword">Only</span></span> modifications <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> svn:<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> revision properties <span class="hljs-keyword"><span class="hljs-keyword">are</span></span> allowed. &gt;&amp;<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> ERROR_EXIT :ERROR_EXIT <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><br>  If you are using a VisualSVN server, the default batch file will not work.  And the folder hooks do not need to create.  You just need to open the <b>VisualSVN Server Manager</b> , go to the properties of the repository for which you want to create a hook, select the <b>Hooks</b> tab.  Double click on the <b>Pre-revision property change hook</b> and just copy the code of the batch file there. <br>  <i>Addition: when activating a hook in the VisualSVN Server Manager, the server will create the hooks folder and generate standard templates there.</i> <i><br></i>  <i>Thanks for the tip <a href="http://habrahabr.ru/users/chemodax/" class="user_link">chemodax</a></i> <br><br>  PS All the information and codes for the hook found on the Internet </div><p>Source: <a href="https://habr.com/ru/post/114273/">https://habr.com/ru/post/114273/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../114264/index.html">Vietnamese ISPs block access to game servers from 22:00 to 8:00</a></li>
<li><a href="../114265/index.html">Spectrum of visible radiation in computer graphics</a></li>
<li><a href="../114270/index.html">The forbidden fruit of GOTO is sweet (version for microcontrollers)!</a></li>
<li><a href="../114271/index.html">Magical Transformation: A wireless access point or router becomes a hypertext Fidonet node</a></li>
<li><a href="../114272/index.html">LLeo (Leonid Kaganov) opened his own WebBBS (based on AJAX) to access Fidonet from the Internet</a></li>
<li><a href="../114274/index.html">Safety online for kids</a></li>
<li><a href="../114275/index.html">Do you do sports / physical education / physical stress?</a></li>
<li><a href="../114276/index.html">Seminar: Making an Agile project. Roles, practices, tools</a></li>
<li><a href="../114277/index.html">What to do if it dawned on you or the startup alphabet?</a></li>
<li><a href="../114278/index.html">Travel kit for console gamer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>