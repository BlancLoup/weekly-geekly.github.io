<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Algorithms and trading on the stock exchange: Hiding large transactions and predicting the price of shares</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="New York University professor of mathematics and financial markets expert Marco Avellaneda (Marco Avellaneda) made a presentation in which he describe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Algorithms and trading on the stock exchange: Hiding large transactions and predicting the price of shares</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/itinvest/blog/271059/"><img src="https://habrastorage.org/files/c79/c44/35a/c79c4435a2474e5da70360e3c541ec82.jpg"></a> <br><br>  New York University professor of mathematics and financial markets expert Marco Avellaneda (Marco Avellaneda) made a <a href="https://www.math.nyu.edu/faculty/avellane/QuantCongressUSA2011AlgoTradingLAST.pdf">presentation</a> in which he described how large investors ‚Äúhide‚Äù their large-scale transactions using algorithms, while other traders are engaged in predicting stock price changes. <br><br>  In our today's material - the main points of this work. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Why do we need algorithms </h4><br>  Algorithmic trading since its inception in the early 90s of the last century has been a tool for large investors and hedge funds.  Decimalization (the transition on the New York Stock Exchange to use in trading shares on the decimal system - the minimum price step began to equal 1 cent, not 1/16 of a dollar), Direct Market Access (DMA) technology, 100% electronic exchanges , reduction of commissions of stock exchanges and brokers, the emergence of various stock exchanges in the USA and in other countries - all this led to an explosive growth in the number of traders using algorithms. <br><br>  Avellaneda describes the purpose of using algorithms in stock trading as follows.  In the opinion of the professor, in the case of large institutional investors, they are used primarily not to maximize the potential profits from a particular transaction, but to control market risk and order execution costs. <br><br>  Simply put, usually large investors need to perform operations with a large amount of shares.  Often the volume of the transaction is higher than the market can "digest" without changing the price of the stock.  The need to make the purchase of a huge number of shares will lead to a change in their price and the emergence of the so-called "slippage."  Thus, it will not be possible to execute the entire order at the same price - at first the transactions will be held at the right price, but gradually it will become less and less profitable. <br><br>  To avoid this, it is necessary to break large orders into smaller ones that are executed via the Internet within minutes, hours or days. <br><br>  To make this as profitable as possible, the algorithm must control the average share price.  You can evaluate it by comparing with the market ‚Äúbenchmark‚Äù - the global average price per day, the closing price or the opening price, etc. <br><br>  But the problem of determining how to break a large order into smaller ones is not the only one.  The algorithm must also decide how exactly to place an order on the market - in the form of a limit or market order - and at what price.  It is necessary to achieve the best price for each such child order. <br><br>  The development of financial markets and the emergence of new trading instruments have made this task much more difficult and interesting. <br><br>  The times when customers could transfer applications to their brokers only by phone or fax are a thing of the past.  Now there are different ways to connect to electronic trading.  For example, it is possible to connect a trading robot to the brokerage system using an API - in this case, orders are sent to the brokerage system, and from there they go to the exchange (ITinvest has its own SmartCOM <a href="http://www.itinvest.ru/software/smartcom/">API</a> ). <br><br><img src="https://habrastorage.org/files/906/a2d/83e/906a2d83e38c461bb6dc49f5f9753f57.png"><br><br>  In the case of algorithmic trading, as a rule, the speed of the strategy is important, so many traders prefer to use the direct market access technology (DMA - ITinvest <a href="http://www.itinvest.ru/services/access/">provides such access</a> to Russian and foreign exchanges).  In case of its application, the trading robot interacts directly with the exchange trading system, bypassing the broker system, which allows to gain time. <br><br><img src="https://habrastorage.org/files/cb5/2ea/aea/cb52eaaea82b4cf887d0f903a2f8037d.png"><br><br>  But this is not the most difficult trade option.  The emergence of a large number of different trading platforms has led to the development of algorithms for ‚Äúsmart routing‚Äù orders - such systems not only try to make the most profitable transactions on a particular stock exchange, but also analyze which of the available sites are currently better conditions to send an order there . <br><br>  Thus, there are three levels of development of modern algorithms. <br><br><ul><li>  <b>Macro</b> Trading <b>Algorithms</b> - determine the trading strategy; </li><li>  <b>Micro</b> trading <b>algorithms</b> - in fact, trading "engines" of placing orders; </li><li>  <b>Smart routing algorithms</b> - if the work is carried out on several exchanges simultaneously. </li></ul><br><h4>  Examples of trading algorithms </h4><br>  There are several types of algorithmic strategies.  One of them is the executive strategy, which is aimed at solving the problem of buying or selling a large amount of a financial instrument (for example, stocks) with a minimum deviation of the final weighted average transaction price from the current market price. <br><br>  Examples of algorithms that solve this problem are the TWAP and VWAP algorithms. <br><br><h5>  TWAP algorithm </h5><br>  Using TWAP (Tie Weighted Average Price - time-weighted average price) implies uniform execution of an order to buy or sell for a given number of iterations over a given period of time.  For this purpose, market orders are constantly placed at the prices of the best demand or supply, adjusted by the specified percentage deviation. <br><br>  For example, the purchase of 100 thousand shares during the day may look like this (five-minute consecutive intervals are used): <br><br><img src="https://habrastorage.org/files/107/761/830/107761830278446cb0e5c077d0976dfc.png"><br><br><h5>  VWAP algorithm </h5><br>  VWAP (Volume weighted average price) is based on the following scheme.  Trading volume is usually higher at the beginning and end of the trading session, and in its middle it is smaller.  To execute a large order with minimal cost, it is broken down into smaller orders based on the time of day. <br><br>  For this: <br><br><ol><li>  The algorithm estimates the average trading volume at five-minute intervals. </li><li>  Within each interval, deals are made on the amount of the instrument, which is proportional to the standard volume. </li></ol><br>  The properties of this algorithm include completeness (the size of transactions is always known in advance), as well as the use of historical data for estimating the volume function. <br><br><img src="https://habrastorage.org/files/f57/c77/0c0/f57c770c037a406c9c3d1a1c6a86f543.png"><br><br><img src="https://habrastorage.org/files/0c1/26e/4c2/0c126e4c2c244e3faebd73806b781317.png"><br><br><h5>  Percentage of Volume (POV) </h5><br>  The Percentage of Volume (POV) algorithm solves the same problem as VWAP, but using information on the trading volume on a particular current day as a benchmark.  The idea is to have a constant percentage of participation in the auction throughout the selected period. <br><br>  If you still need to ‚Äútrade‚Äù shares of Q volume, and the ‚Äúparticipation rate‚Äù in Œ≥ trading, the algorithm calculates the trading volume V traded in the period (t - ŒîT, t) and executes orders for the number of financial instrument q = min (Q, V * Œ≥). <br><br><img src="https://habrastorage.org/files/63f/f21/ab8/63ff21ab8bf5424db1e539722de09e36.png"><br><br>  V (t) = total trading volume, which took place on the market by the time t; <br><br>  Q (t) = the number of shares that still need to be bought / sold (Q (0) = initial amount). <br><br><img src="https://habrastorage.org/files/123/131/f44/123131f4435d4f1b8ad976f68c69ed76.png"><br><br><img src="https://habrastorage.org/files/2e1/281/cf3/2e1281cf356c40368a09c5ddd6c99f37.png"><br><br>  Eventually: <br><br><img src="https://habrastorage.org/files/7f6/bdd/1da/7f6bdd1dae3748e59a6cd7d60e48edd7.png"><br><br><h4>  How else are the algorithms used? </h4><br>  In addition to executive strategies, there are a number of strategies aimed at extracting profit using other models.  Here are some of them: <br><br><ul><li>  <b>Arbitration strategies</b> are a subset of pair trading strategies that are based on an analysis of the price ratios of two highly correlated financial instruments.  In the case of arbitrage, such a pair consists of the same or related assets, the correlation of which is close to one ‚Äî for example, the shares of the same company on different exchanges.  For successful trading in the framework of arbitration strategies, the speed of obtaining data and issuing / modifying buy or sell orders is critical. </li><li>  <b>Providing liquidity (market-making)</b> - <b>market-making</b> involves maintaining spreads for the purchase and sale of a financial instrument.  Market makers are the main suppliers of instant liquidity, so the exchanges often attract them to work with illiquid instruments by providing preferential conditions. </li><li>  <b>Price prediction</b> - strategies that analyze various data (including using technical analysis indicators) to build hypotheses about which direction the price of a financial instrument can move in a given period of time. </li></ul><br><h4>  Predicting prices in high frequency trading </h4><br>  In order to "predict" the price movement, the algorithm must simulate the hidden liquidity of the market given the liquidity of the bids to buy and sell.  The "exhaustion" of the queue of applications for the purchase or sale may indicate an early price movement. <br><br><img src="https://habrastorage.org/files/9a5/f7d/7ef/9a5f7d7ef93042ea94e49c12ae4a24bf.png"><br><br>  A price change occurs when at one of the price levels all orders for purchase or sale disappear, and there is the next level of bid and ask prices. <br><br>  The probability that the queue of requests for an ask will be depleted earlier than the queue of requests for a bid is calculated as follows: <br><br><img src="https://habrastorage.org/files/cbb/9c4/552/cbb9c4552d81453fa7b9224e231aa8ec.png"><br><br>  The final formula for the probability of price increase: <br><br><img src="https://habrastorage.org/files/523/355/0d2/5233550d20fc4620a750600298640f44.png"><br><br>  where H is the hidden liquidity of the market, that is, transactions that are unknown to the general public (for example, transactions of large financial organizations that are concluded outside the stock exchanges). <br><br>  The evaluation procedure is as follows: <br><br><ul><li>  At the first stage, the collected data is divided by exchanges, one trading day is analyzed at a time; </li><li>  Quotations of bid and asc values ‚Äã‚Äãare arranged by <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B2%25D0%25B0%25D0%25BD%25D1%2582%25D0%25B8%25D0%25BB%25D1%258C">deciles</a> .  For each such set (i, j), the frequency of the price increase u_ij is calculated. </li><li>  The number of occurrences of each d_ij value is counted. </li><li>  A model compliance analysis is performed using <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25BD%25D0%25B0%25D0%25B8%25D0%25BC%25D0%25B5%25D0%25BD%25D1%258C%25D1%2588%25D0%25B8%25D1%2585_%25D0%25BA%25D0%25B2%25D0%25B0%25D0%25B4%25D1%2580%25D0%25B0%25D1%2582%25D0%25BE%25D0%25B2">the least squares method</a> : </li></ul><br><br><img src="https://habrastorage.org/files/55a/6a3/a72/55a6a3a722944c289bdc4f217cc8f5f3.png"><br><br><h4>  Conclusion </h4><br>  On many stock exchanges (for example, in the USA and Russia), the turnover of algorithmic trading has been more than 50% for quite some time.  At the same time, algorithms are often used not only to ‚Äúoutrun‚Äù competitors in the speed of transactions and earn money on it. <br><br>  Large players can use this tool in order to break large transactions into smaller ones, which allow to carry out an operation with a specified amount of a financial instrument, without shifting its market price to one side or the other.  For this, TWAP, VWAP and PoV algorithms are used. <br><br>  In addition, algorithms are used to implement ‚Äúquantum strategies‚Äù, such as arbitration or market-making.  In addition, there are opportunities to calculate the probability of price changes for specific financial instruments. <br><br>  That's all for today, thank you for your attention! <br><br>  <b>Other ITinvest articles on trading:</b> <br><br><ul><li>  <a href="http://habrahabr.ru/company/itinvest/blog/270813/">Online algorithms in high-frequency trading: problems of competition</a> </li><li>  <a href="http://habrahabr.ru/company/itinvest/blog/269761/">What's New: 3 technological trends in algorithmic trading</a> </li><li>  <a href="http://habrahabr.ru/company/itinvest/blog/269367/">Experiment: Is it possible to create an effective trading strategy using machine learning and historical data</a> </li><li>  <a href="http://habrahabr.ru/company/itinvest/blog/268783/">Creating trading robots: 11 development tools</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/271059/">https://habr.com/ru/post/271059/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271045/index.html">Zotero: optimizing the storage and use of scientific literature</a></li>
<li><a href="../271047/index.html">Backups are different. Today I will tell about Acronis Backup Cloud (BaaS)</a></li>
<li><a href="../271049/index.html">Website Testing Automation: Pytest, Allure, Selenium + Some Secret Ingredients</a></li>
<li><a href="../271051/index.html">Node.js in the service of an electronics developer: we create libraries of microcircuits</a></li>
<li><a href="../271053/index.html">Library of machine learning Google TensorFlow - first impressions and comparison with its own implementation</a></li>
<li><a href="../271061/index.html">Protection of personal data in accordance with N 242-–§–ó: how to understand and what to do?</a></li>
<li><a href="../271065/index.html">A game for math. Verbal counting</a></li>
<li><a href="../271067/index.html">The Chrome Dev Summit live, day one</a></li>
<li><a href="../271069/index.html">MoscowJS 27</a></li>
<li><a href="../271071/index.html">Master class by Dmitry Sklyarov. DRM: yesterday, today and tomorrow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>