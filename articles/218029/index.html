<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Like a car gyro on the steering wheel, measured</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="And not only the gyroscope was tied to the steering wheel! The second was on the foot, and the third was pulled by rubber rings to the ashtray cover. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Like a car gyro on the steering wheel, measured</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/847/051/fa1/847051fa17df3804ffc3b697e3762608.jpg" align="right"><br>  And not only the gyroscope was tied to the steering wheel!  The second was on the foot, and the third was pulled by rubber rings to the ashtray cover.  All these tricks - in order to find out if the steering wheel does not ‚Äúlag‚Äù and if the gas pedal does not ‚Äútupit‚Äù. <br><br>  Although the steering wheel is mechanically connected to the wheels and the accelerator pedal to the throttle, the car does not immediately respond to the driver‚Äôs commands.  Especially if the gearbox is automatic, and the electronics "tupit."  Delays make control much more difficult and can lead to undesirable oscillations.  Therefore, it is important to know how fast the car responds to driver commands. <br><a name="habracut"></a><br>  The first way to find delays is to use data from the OBD (On-Board Diagnostics) port.  This port is connected to the vehicle's diagnostic bus (CAN bus).  That it is used in the service for reading the error codes of the engine and transmission.  It also contains information about the current engine speed, fuel consumption, the angle of the gas pedal, the opening of the throttle, etc. <br>  To connect to the car's tire, I bought a typical Chinese ‚Äúobd reader‚Äù for a thousand rubles. <br><br>  This device can be connected to any modern car.  However, a cheap reader does not give more information than on car devices.  Those.  for our purposes it is useless.  On the whole, there are a number of problems with the diagnostic port and bus: <br><ul><li>  closed protocols and bus data standards </li><li>  unknown accuracy / accuracy of data </li><li>  unpredictable delays </li><li>  I do not understand anything </li><li>  Therefore, it was decided to assemble their own measuring instruments from improvised gyroscopes and arduins. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Measurement Technique </h4><br>  The first gyroscope was ‚Äúsecurely‚Äù tied to the steering wheel with masking tape.  He determined the steering angle.  The second gyro is pulled to the driver's leg with hair ties.  He passed on the brake / gas pedal.  The last device was fixed in the cabin.  In addition to the gyroscope, he had an accelerometer and collected data from other sensors.  Then the data was sent to the laptop via a virtual COM port via usb. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ce/172/553/4ce172553d48b4bd365f729cb3bd23b2.jpg"><img src="https://habrastorage.org/getpro/habr/post_images/ae4/72a/a51/ae472aa513f1d86e45c736f91c78424b.jpg"><br><br>  As the captain suggests, in order to measure delays, it is necessary to synchronize the time on all sensors.  Now synchronization is released ‚Äúvlob‚Äù: the receiving sensor subtracts the magic constant from the time of signal arrival (determined by interruption from the wireless module) - the time required to send and receive data. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b16/6c4/2aa/b166c42aa29a7506cb56920d1db3190d.jpg"><br><br>  To determine this magic constant Zhetsko pressed the sensors to each other and rotated.  The delay between the readings gives just that ‚Äúmagic constant‚Äù. <br><br><h4>  About sensors </h4><br>  Two modules based on Arduino Uno were assembled: <br><ul><li>  Additional scheme (shild) for prototyping, mounted on top of arduin; </li><li>  gyro based on MPU-6050, soldered to shield; </li><li>  radio module nrf24l01 +, soldered to the shield. </li></ul><br>  One model based on arduino micro: <br><ul><li>  double-sided board for laser-iron technology; </li><li>  logic level matching board 5v &lt;-&gt; 3.3v; </li><li>  MPU-6050 based gyroscope on I2C interface; </li><li>  radio nrf24l01 +. </li></ul><br><br><h4>  Measurements </h4><br>  I don‚Äôt have a car, so we tested it on a Mitsubishi Lancer of my friend, Konstantin. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/345/c38/c48/345c38c4828ce35e2c840a83f434e092.jpg"></div><br><br>  All tests were conducted on a dead end section of a public road, so the speeds are not great. <br>  Kostya was driving at a speed of about 30 km / h, actively turning the steering wheel and modulating the gas pedal.  Nearby training cars jumped to the sides, observing our inadequate actions of a used Lancer. <br><br>  At that time I was sitting with a laptop in the passenger seat and was managing to receive data from the sensors. <br>  The following graph shows typical readings of a gyroscope attracted to the leg: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ec/3ce/d37/1ec3ced3766ffe69713ac10e19bda4c0.png"><br><br>  Vibrations from the engine, the hands of the driver, the road - everything leads to noise.  Especially clearly they appear on the charts of the acceleration of the car body. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b2c/606/ea9/b2c606ea9a252ae4334ea68e3827fe8a.png"><br><br>  To combat high-frequency noises, the data was pre-processed by a low-pass filter (filterfilt matlab).  The filter was chosen so as not to introduce an additional delay into the signal. <br><br>  I note that the gyroscopes determine the speed of rotation of the gas pedal and the steering wheel, and we need an angle.  For this, the readings from the sensors on the steering wheel and the foot have been integrated.  Then, to calculate the delays, cross-correlation was used (the finddelay function of the matlab). <br><br>  The graph below shows the angle of rotation of the pedal (foot), the acceleration of the vehicle along the corresponding axis and the acceleration of the vehicle, corrected for the calculated delay: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/21b/b8d/269/21bb8d269ca806162546d53ded7f1a74.png"><br><br>  Kostya pressed and released the gas pedal, and the car reacted only after 124 milliseconds.  The speed is about 30 km / h, the speed is 3000 rpm. <br>  At a speed of 30km / h, the delay of the car on steering turns, according to the results of individual tests, ranged from 90 to 95ms. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c06/6bc/767/c066bc7679e5fba716111907eb5119ca.png"><br><br><h4>  Plans </h4><br><ul><li>  Measure delays on other cars; </li><li>  Measure the time from the moment you press the gas pedal (or release the clutch) to 100 km / h (or 402 m). </li><li>  Measure the reaction force on the steering wheel in turn (feedback); </li><li>  Measure the driver's pulse before / during / after passing the track. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/218029/">https://habr.com/ru/post/218029/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../218019/index.html">A couple of words about Epson Moverio BT-200</a></li>
<li><a href="../218021/index.html">JPHP - How it works. History of creation</a></li>
<li><a href="../218023/index.html">The comet landing module "Fila" successfully woke up aboard the probe "Rosette"</a></li>
<li><a href="../218025/index.html">Psychological component of the speed of interaction in mobile interfaces</a></li>
<li><a href="../218027/index.html">Purpose of gyroscopic sensors and their use in modern navigation systems</a></li>
<li><a href="../218031/index.html">SAP ABAP: Crossing Checkpoint Charlie in a SAAB (translated from scn.sap.com)</a></li>
<li><a href="../218035/index.html">Survey: what should be additional education?</a></li>
<li><a href="../218037/index.html">Difficulties of creating and publishing the first Android application</a></li>
<li><a href="../218039/index.html">Canonical closes the Ubuntu One service.</a></li>
<li><a href="../218041/index.html">How to start developing games if you can't program?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>