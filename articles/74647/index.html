<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Own, home PBX</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is SIP probably already know many. In fact, this is just a session establishment protocol for communication devices, everything is simple - you a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Own, home PBX</h1><div class="post__text post__text-html js-mediator-article">  What is SIP probably already know many.  In fact, this is just a session establishment protocol for communication devices, everything is simple - you ask the server for the presence of the called subscriber, the server responds that it is there, no, it is live-offline, and so on, the server responds to you - it does, it is there , asks both subscribers to establish a connection (ACK), after which you successfully talk to a friend.  The protocol is quite simple, very similar in both codes and organization to HTTP. <br><br><img src="http://upload.wikimedia.org/wikipedia/ru/3/3e/%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80_%D1%81%D0%B5%D1%82%D0%B8_SIP.JPG" alt="image"><br><br>  This article is not about the protocol.  It will be about how to create your own PBX, rationally organize external and internal calls. <br><a name="habracut"></a><br>  So: for a start, we will consider several options of ‚Äúready-made solutions‚Äù for organizing our own PBX. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Option 1: Commercial product CommunigatePro.  Why at number 1?  Yes, because there are implementations for all major platforms, there is an intelligible web-based administrator interface and a bunch of related services, mail, IM and so on.  Worth the money, but for the formal service can easily work as a personal service without limiting functionality. <br><br>  Option 2: Asterisk.  asterisk.org.  And a huge pile of clones, assemblies, forks: TrixBox ( <a href="http://trixbox.org/">trixbox.org</a> ), Elastix ( <a href="http://www.elastix.org/">www.elastix.org</a> ), Yate2 ( <a href="http://voip.null.ro/">voip.null.ro</a> ), FreePBX ( <a href="http://www.freepbx.org/">www.freepbx.org</a> ) ... you can take a long time to list Clones and Asterisk mods .  What is a plus - the project is developing, there are many additions - web interfaces, database integrations.  Minus - Asterisk has not very simple syntax of configuration files.  Therefore, I do not recommend it to beginners. <br><br>  Option 3: Other software I don‚Äôt know about.  :-) In fact, there are a huge number of server solutions with intelligible interfaces for the administrator, client, billing, etc. <br><br>  So.  It is clear that we will talk about CommunigatePro ( <a href="http://www.stalker.com/communigatepro">www.stalker.com/communigatepro</a> ).  By the way, there is Russian documentation for it, there are many references, for example, here: <a href="http://relay.bhost.ru/guide/russian/">relay.bhost.ru/guide/russian</a> <br><br>  Installing the server is quite simple for both different linux implementations and for windows.  The server uses 2 main folders - the service folder and the data folder, where domain accounts, settings, web skin templates and voice messages are stored. <br>  The entire installation on any platform is reduced to running the installer, specifying folders.  The process is minimal, so we will not consider the installation process.  If someone has problems - I will answer in the comments. <br>  In any Linux, CommuniGate is located in the / opt / CommuniGate and / var / CommuniGate folders. <br><br>  Service is installed.  What's next? <br><br>  The default port of the web admin is: 8010. We go to the administration service with any browser <a href="http://127.0.0.1/">127.0.0.1</a> : 8010 if the server is installed on the same computer, if you installed the service on the remote computer, replaces 127.0.0.1 with the address of the remote server).  When you first log in, the server will ask you for a password to manage the server.  There you can also specify the system default language.  The default user is postmaster. <br><br>  All we are in admin.  To deploy a SIP service, 3 steps are enough: <br><br>  1. Via the Web Interface of the Administrator, open the General page in the Settings area: specify the domain or use your IP address instead of the domain.  All email addresses in this domain will be treated as local, and (in the simplest case) the mail will be stored in the user's local folders.  Initially, this field contains the name of the server computer that CommuniGate Pro takes from the OS.  If this name looks like host12345hh.company.com, then you should change it to the domain name that the Server should maintain. <br><br>  2. Domain created.  Now we need to configure clients and their phone numbers.  In communicagate it is quite simple.  In the default domain, we climb into the domain objects, add the user (for example, ivan).  After pressing the Create button, we are thrown onto the user settings form, we must enter the password for the user and drop it to the bottom of the settings page - there, at the bottom right, the most important thing is the text field with the name ‚ÄúTelephone Number‚Äù.  Well, as the first mover we put 1001). <br><br>  This is the most important thing for local PBX.  Wash everything simple.  Now you need to create another couple of accounts and try to talk within the network. <br>  Repeating steps 2, we add the users Vasya and Jenya by assigning them the numbers 1002 and 1003, respectively. <br>  Now the stage of choice: what will we say? <br><br>  Options 3: <br><br>  1. There are softphones.  The list can be viewed here: <a href="http://en.wikipedia.org/wiki/List_of_SIP_software">en.wikipedia.org/wiki/List_of_SIP_software</a> <br>  I personally like <a href="http://en.wikipedia.org/wiki/SIP_Communicator">en.wikipedia.org/wiki/SIP_Communicator</a> <br>  2. There are hardware solutions.  I use WellTech LP-388 hardware.  There are many other analogues. <br>  3. SIP adapter.  it is made in the form of a box with an ezernta and a simple tephonic RJ-11 hole.  Not popular for private purposes. <br><br>  So, put the software (for debugging, you can put 2 siphon on the same computer), indicated different accounts, WE'RE DRAWING! <br>  The call has gone!  We enjoy the fact that everything works.  And if you dial 200 from any of the clients, the Auto-Attendant starts talking to us - this is the auto-informer of the system.  While he speaks English, later we will teach him to communicate in his native Russian). <br><br>  Now the most important stage.  External world!) <br><br>  3. In order for our internal PBX to not only connect us between each other, we need to have an external SIP gateway. <br>  There are many.  Consider a couple of the most popular.  A service that is known to be sipnet ( <a href="http://sipnet.ru/">sipnet.ru</a> ).  We cure.  After registration, the service will give us an extension number of the type 0023413643 - this is the extension number of the system.  I don‚Äôt know how it is now, but in times of promotion, sipnet gave a small bonus of 100 rubles at the time of registration to the account. This is enough to establish an external connection for our server. <br>  What do we need to throw the server out? <br>  - sipnet address - sipnet.ru <br>  - our username and password of the account that we registered <br>  Moving on: we climb in the admin panel of our communigate in Settings - Real Time - SIP - Gateways. <br>  We see an empty form with fields: Gateway Name, Domain, Username, AUTH-Name, Password - this is in the left column, on the right - Calls: (Authentication, Proxy), Replace, Contact Field and Register once in‚Ä¶ <br>  What we write: The gateway name is a personal name for you, you can name at least tel1, we will use this name later when setting up routing of calls. <br>  The main point: Domain: sipnet.ru - where the road, Username: Your ID in the system format 0023413643 and Password. <br>  Specifically for sipnet, you must put Auth in Auth (in different systems in different ways) and set Register once every ... 30 minutes.  These are their recommendations. <br>  The Proxy field is used to ensure that your servers with Unreal IPs work with signals and media.  If you have an internal ip, I advise you to put the type of media proxying. <br><br>  And now the most important thing.  As our Vasya to bring out. <br>  We climb in the settings - Router (Router): <br>  There is a full text box. <br>  Do not get scared, look what is written: <br>  = john;  simple alias <br>  &lt;sales@client1.com&gt; = sales-client1;  simple alien alias <br>  &lt;info@client1.com&gt; = info@otherhost.com;  user -&gt; another user <br><br>  This is the setting for the passage of calls within your system. <br>  In fact, in the default installation, you need to fix only 1 tsifirku - the one where you have local calls.  By default, it costs 7d - if you plan to use numbering like 1001 1002 - change to 4d, if like me 005-364536 - &lt;005 (6d) "*&gt; well, or by analogy - &lt;(6d) @ *&gt; if without prefixes. <br>  Now the most pleasant: we configure the CITY. <br>  Just one line after everything that is there (add): <br>  N: S: &lt;(7d) @ *&gt; = + 7495*@tel1.sipgw;  this is our outside world!  tel1 is how you called the gateway (see above) <br>  Simply save (Modify) and dial your home number from your soft background. <br><br>  CALL GONE!) <br><br>  Congratulations!  You have set up your own PBX, where you can distribute internal numbers to your friends, communicate over the network, both with software clients and with hardware solutions of tsiska, veltecha, etc. In addition, this server also supports IM, mail, web, but more on that later . <br><br>  And a small Py-Sy - if you lock the second gateway in the Gateways, calling it, for example tel2, you can easily make Routing like this: <br><br>  N: S: &lt;(7d) @ *&gt; = + 7495*@tel1.sipgw <br>  N: S: &lt;8 (10d) @ *&gt; = + 7*@tel2.sipgw <br><br>  It will work like this: all city calls in the format 9463746 will go to the provider's gateway tel1, and all cellular calls in the format 89267485746 through the second provider tel2.  It is very profitable if one provider provides Moscow as a bonus for free, and the second has a cellular price much lower than the first. </div><p>Source: <a href="https://habr.com/ru/post/74647/">https://habr.com/ru/post/74647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../74639/index.html">RMI (Remote Method Invocation)</a></li>
<li><a href="../74641/index.html">How to bring MacOS X to mind: a few tips</a></li>
<li><a href="../74643/index.html">The history of one bug or why you should know not only PHP</a></li>
<li><a href="../74644/index.html">Master Class "Secrets of Client Optimization" - as it were</a></li>
<li><a href="../74645/index.html">Greasemonkey for Internet Explorer</a></li>
<li><a href="../74649/index.html">About monadic technologies</a></li>
<li><a href="../74651/index.html">Discourse on the role of the state in the multimedia industry</a></li>
<li><a href="../74653/index.html">SQUID Proxy Automation</a></li>
<li><a href="../74654/index.html">ORM - evil or How I tried to cache Propel in symfony</a></li>
<li><a href="../74656/index.html">Babo Violent 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>