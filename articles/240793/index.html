<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Multiboot, UEFI, NTFS or almost a recipe for happiness</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Post written based on the publication "Life-giving flash drive . " 

 Foreword 
 Good day, Habr. Quite recently, reading Habr, I came across an articl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Multiboot, UEFI, NTFS or almost a recipe for happiness</h1><div class="post__text post__text-html js-mediator-article">  <i>Post written based on the publication <a href="http://habrahabr.ru/post/240443/">"Life-giving flash drive</a></i> . <i><a href="http://habrahabr.ru/post/240443/">"</a></i> <br><br><h2>  Foreword </h2><br>  Good day, Habr.  Quite recently, reading Habr, I came across an article, A <a href="http://habrahabr.ru/post/240443/">revitalizing flash drive</a> , which described how to create a multiboot flash drive with a set of useful utilities, various systems, etc.  And everything would be fine, but here and there the dog is buried - pay attention to <a href="http://habrahabr.ru/post/240443/">this comment thread</a> , which discusses the performance of multiboot in systems with UEFI.  Thus, I began <s>my own investigation</s> to look for a universal way to solve this problem. <br><a name="habracut"></a><br>  I didn‚Äôt have to go far, since the days of insane popularity of the Windows XP Zver Edition build, its developers used a toolkit called <a href="http://www.rmprepusb.com/">RMPrepUSB</a> to write the build to a USB drive.  The assembly is gone from the memory of people, but the utility package project itself continues to evolve and grow stronger.  Well, the very basis - the project <a href="http://www.easy2boot.com/">Easy2Boot</a> .  Studying their website, I found a universal way to create a multi-boot flash drive, which can contain any distribution kit, LiveCD or floppy images that you just want to add.  So, let's start creating such a wonderful flash drive. <br><br><h2>  Getting started </h2><br>  <a href="http://www.rmprepusb.com/documents/rmprepusb-beta-versions">Go to the site</a> and download the latest archive with <b>Install_RMPrepUSB_Full</b> in the title.  Unpack and install. <br>  <b><i>Warning:</i></b> for fans of portability - you can open the installer in 7-zip (for example) and unpack it into a folder without installation. <br>  Next, go to the Easy2Boot website and <a href="http://goo.gl/t5oEAf">download the archive</a> with the E2B itself, unpack it into any folder on your PC. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Preparing a flash drive </h2><br>  Go to the folder with E2B and run the file <b>_ISO \ docs \ Make_E2B_USB_Drive.cmd</b> . <br>  <b><i>Attention:</i></b> if you did not install, but unpacked RMPrepUSB, then at the first stage you will be asked to specify the path in the RMPrepUSB folder. <br>  We will be asked to indicate the number of the drive from the list, ask if we really want to format the drive and ask to choose a file system. <br>  <b>And here attention!</b>  Choose FAT32 - we load into UEFI without problems, but there is no support for files&gt; 4 GB, and vice versa - NTFS without UEFI, but with support for large files.  If your images weigh less than 4 GB each, feel free to choose FAT32.  With NTFS it is a bit more difficult, namely - the flash drive in UEFI will not boot, but if you load it on a regular BIOS, and then select an image for UEFI (see below), then Easy2Boot will overwrite the MBR flash drive and it will load into UEFI, provided that in that image there is its support (the presence of files <b>efi \ bootia32.efi</b> and <b>efi \ boot \ bootx64.efi</b> ) <br><br>  We go on a complex path - we write N (that is, we format it in NTFS), a confirmation window will come out, click OK and wait.  After formatting, E2B files will be copied and ‚ÄúPress any key‚Äù appears on a green background. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshots</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/521/1b8/6b5/5211b86b57ac4ae7af74cc46ba14fbad.png"><br><img src="https://habrastorage.org/files/e0e/b28/f0e/e0eb28f0e34348e4830ec8bcbc2f8130.png"><br></div></div><br><br><h2>  Folder structure or where to put images? </h2><br>  Go to the drive, see the files and the <b>_ISO</b> folder.  I will briefly describe the structure (details are <a href="http://www.easy2boot.com/add-payload-files/">on the site</a> ): <br><ul><li>  <b>ANTIVIRUS</b> - we cast images of antivirus LIveCD (Kaspersky, Dr.Web and others like them) </li><li>  <b>AUTO</b> - we throw any image into a subfolder with the desired name (for example, along the path Ubuntu \ My_Ubuntu_Distro.iso) </li><li>  <b>LINUX</b> - accordingly, we upload any Lunk image to this folder. </li><li>  <b>MAINMENU</b> - we <b>drop the</b> image into this folder and it will appear in the main menu of Grub4DOS when it is loaded (not in the submenu, more on that later) </li><li>  <b>UTILITIES</b> - we throw images of diskettes here </li><li>  <b>UTILITIES_MEMTEST</b> - the same, but, alas, I can not say more precisely </li><li>  <b>WIN</b> - here we will add images prepared for upload to UEFI.  More on that later </li><li>  <b>WINDOWS</b> - by the structure of subfolders, it is easy to understand that for each Windows family you need to put an image in the corresponding subfolder. </li></ul><br><br>  Next, run RMPrepUSB, select the drive in the list and press Ctrl + F2, agree and wait a couple of seconds.  Program pohamanit with files and you can boot from a flash drive. <br><br><h2>  Wait, what about UEFI? </h2><br>  Oh, yes.  That is why we are here and gathered.  To prepare the image for downloading to UEFI, download the <a href="http://www.easy2boot.com/download/mpi-pack/">archive</a> , unpack it.  Install the <b>ImDisk</b> file <b>\ imdiskinst.exe</b> from the folder, and then drag the image file to the <b>MakePartImage_AutoRun_FAT32.cmd</b> script in the main folder.  This script converts the image into the .imgPTN format, when mounted, which E2B will rewrite the MBR and mount the image as a FAT32 partition.  You can read more <a href="http://www.easy2boot.com/faq-/how-e2b-works/">here</a> . <br><br><h2>  How does all this look? </h2><br>  A working example - I threw different images on the drive, the structure is as follows: <br><ul><li>  <b>_ISO \ LINUX \ linuxmint-17-xfce-dvd-64bit.iso</b> </li><li>  <b>_ISO \ WIN \ ru-en_win7_sp1_x86-x64_18in1_activated_v2.imgPTN</b> </li><li>  <b>_ISO \ WIN \ Boot_USB_Sergei_Strelec_2014_v.6.9.imgPTN</b> </li><li>  <b>_ISO \ WIN \ ru_windows_8_1_pro_vl_x86_dvd_LITE_3.iso</b> </li></ul><br><div class="spoiler">  <b class="spoiler_title">Screenshots</b> <div class="spoiler_text">  <b>Main menu flash drive</b> <br><img src="https://habrastorage.org/files/d31/306/2c4/d313062c4f3d4c64b13c41290e959db3.png"><br>  <b>Linux submenu</b> <br><img src="https://habrastorage.org/files/6cf/bbb/9c0/6cfbbb9c067b47eeb545e9a6332fd9dd.png"><br>  <b>Submenu with ordinary ISO images of Windows</b> <br><img src="https://habrastorage.org/files/037/e36/8d5/037e368d591c4a2daa48ffa048913d95.png"><br>  <b>Submenu with images for UEFI</b> <br><img src="https://habrastorage.org/files/9f2/12c/9d7/9f212c9d7aa541d796838ca095a916a7.png"><br>  <b>When downloading an image for UEFI, we will be asked if we really want to rewrite the table with a section of flash drives?</b>  <b>Hit Enter</b> <br><img src="https://habrastorage.org/files/fb1/5d3/02a/fb15d302ae4242ed9b9bf8f580b4105d.png"><br>  <b>And this is how the bootloader of any image looks like for UEFI.</b>  <b>Instructions for returning to the main menu below.</b> <br><img src="https://habrastorage.org/files/313/ff6/0c8/313ff60c8d9249cfb2c41e7fa6cde11e.png"><br></div></div><br>  Boot into the BIOS, select the desired UEFI image, switch the UEFI back and get a USB flash drive with one partition containing the files of this image.  Accordingly, if this image supports booting into UEFI, it will appear in the list of devices from which you can boot. <br><br>  <b><i>Attention!</i></b>  If you downloaded from images prepared for UEFI, you will notice that the next time you boot from the drive, there will be a boot menu from that image.  And where are all those that we sketched on a flash drive?  Yes, and the files on the flash drive are not those ... There are two options - from the bootloader select the top item <b>EASY2BOOT</b> or in the OS run the script <b>e2b \ RestoreE2B (run as admin) .cmd</b> from the flash drive. <br><br><h2>  In the dry residue </h2><br>  There were no minuses here, too - you have to switch to the BIOS in order to connect the desired image.  But the functionality of this set of utilities closes all imaginable and unimaginable needs in a multi-boot flash drive. <br><br><h2>  Information from the developer site </h2><br><ul><li>  <a href="http://www.easy2boot.com/faq-/how-e2b-works/">www.easy2boot.com/faq-/how-e2b-works</a> </li><li>  <a href="http://www.easy2boot.com/make-an-easy2boot-usb-drive/">www.easy2boot.com/make-an-easy2boot-usb-drive</a> </li><li>  <a href="http://www.easy2boot.com/add-payload-files/">www.easy2boot.com/add-payload-files</a> </li><li>  <a href="http://www.easy2boot.com/add-payload-files/makepartimage/">www.easy2boot.com/add-payload-files/makepartimage</a> </li><li>  <a href="http://www.easy2boot.com/add-payload-files/adding-uefi-images/">www.easy2boot.com/add-payload-files/adding-uefi-images</a> </li><li>  <a href="http://www.easy2boot.com/add-payload-files/adding-windows-install-isos-without-needing-a-helper-flash-drive/">www.easy2boot.com/add-payload-files/adding-windows-install-isos-without-needing-a-helper-flash-drive</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/240793/">https://habr.com/ru/post/240793/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../240783/index.html">Finger Trees (Part 1. Introduction)</a></li>
<li><a href="../240785/index.html">Simple Rest Api framework based on Phalcon</a></li>
<li><a href="../240787/index.html">Web application - well, almost without a back-end: Flask, Redis, API via JSONP, JSFiddle.net</a></li>
<li><a href="../240789/index.html">CleverStyle CMS module architecture</a></li>
<li><a href="../240791/index.html">Russian translation Apple iPhone Developer Program License Agreement + Schedule 2 v19</a></li>
<li><a href="../240795/index.html">Evaluation of the competitiveness of search queries for variations in search results</a></li>
<li><a href="../240799/index.html">The story of one bug in the machine for video poker</a></li>
<li><a href="../240803/index.html">Free Cryptic Disk 4 with TrueCrypt support</a></li>
<li><a href="../240805/index.html">Strutext C ++ word processing library</a></li>
<li><a href="../240807/index.html">NodeMap, but not what you thought</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>