<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fill documents in Microsoft Word using Python. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We multiply the documents  . 
 In the previous post it was considered how to fill the request in word using python. This time it will be shown how to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fill documents in Microsoft Word using Python. Part 2</h1><div class="post__text post__text-html js-mediator-article"><h3>  We multiply the documents </h3>  . <br>  In the previous <a href="https://habr.com/ru/post/456534/">post</a> it was considered how to fill the request in word using python.  This time it will be shown how to fill in several word documents with data from the excel table. <br><br>  Before working with the program, we need to prepare an excel file, which will contain the original data.  Create an excel file with such data or use ready-made: <br><br><img src="https://habrastorage.org/webt/yp/eb/ni/ypebnibmgckd5u4tyb59xwuutma.jpeg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now turn to the program. <br><a name="habracut"></a><br>  Since we have to read the excel file, we need to import the corresponding module: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> openpyxl</code> </pre> <br>  Next, we need to go through the table and read all the data line by line.  It will look like this: <br><br><pre> <code class="python hljs">test=[] wb = openpyxl.load_workbook(<span class="hljs-string"><span class="hljs-string">'zaprosi.xlsx'</span></span>) sheet=wb.get_active_sheet() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> row <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sheet[<span class="hljs-string"><span class="hljs-string">'B3'</span></span>:<span class="hljs-string"><span class="hljs-string">'F7'</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cellObj <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> row: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cellObj.value==<span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> cellObj.value==<span class="hljs-string"><span class="hljs-string">" "</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> <span class="hljs-comment"><span class="hljs-comment">#print(cellObj.value) test.append(cellObj.value)</span></span></code> </pre> <br>  We have created an empty list where we further add values ‚Äã‚Äãfrom the table.  Adding occurs only if there are any records in the cell (not empty). <br><br>  After the done manipulations, we will enter the collected data into the word template: <br><br><pre> <code class="python hljs">doc = DocxTemplate(<span class="hljs-string"><span class="hljs-string">".docx"</span></span>) context = { <span class="hljs-string"><span class="hljs-string">'emitent'</span></span> : test[<span class="hljs-number"><span class="hljs-number">0</span></span>],<span class="hljs-string"><span class="hljs-string">'address1'</span></span> : test[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-string"><span class="hljs-string">''</span></span> : test[<span class="hljs-number"><span class="hljs-number">2</span></span>],<span class="hljs-string"><span class="hljs-string">'_'</span></span> : test[<span class="hljs-number"><span class="hljs-number">3</span></span>],<span class="hljs-string"><span class="hljs-string">'director'</span></span> : test[<span class="hljs-number"><span class="hljs-number">4</span></span>] } doc.render(context) doc.save(<span class="hljs-string"><span class="hljs-string">'-final.docx'</span></span>)</code> </pre> <br>  As a result, we will have a ready-made word file with data from the table.  Only here it is one, and is called the final template.  How then to distinguish the documents from each other? <br><br>  Let's start with the simple.  To save files each time under different names, you need to change at the end of the code to the following: <br><br><pre> <code class="python hljs">doc.save(test[x]+<span class="hljs-string"><span class="hljs-string">'.docx'</span></span>)</code> </pre> <br>  Now the saved file will have the name of the company sending the request. <br><br>  During program execution, an error may occur: <br><br><img src="https://habrastorage.org/webt/_r/p6/fj/_rp6fjjjdexrc-zruwdyq1h3gkk.jpeg" alt="image"><br><br>  This error is due to the fact that the company name contains quotes.  If you remove the quotes from the excel table, the word file is successfully saved with the name Company-1.docx. <br><br>  It remains to ‚Äúpropagate‚Äù the document by entering the remaining data from the table. <br><br>  Here, too, everything is simple.  We create a cycle based on our collected data: <br><br><pre> <code class="python hljs">x=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> x&lt;len(test): doc = DocxTemplate(<span class="hljs-string"><span class="hljs-string">".docx"</span></span>) context = { <span class="hljs-string"><span class="hljs-string">'emitent'</span></span> : test[x],<span class="hljs-string"><span class="hljs-string">'address1'</span></span> : test[x+<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-string"><span class="hljs-string">''</span></span> : test[x+<span class="hljs-number"><span class="hljs-number">2</span></span>],<span class="hljs-string"><span class="hljs-string">'_'</span></span> : test[x+<span class="hljs-number"><span class="hljs-number">3</span></span>],<span class="hljs-string"><span class="hljs-string">'director'</span></span> : test[x+<span class="hljs-number"><span class="hljs-number">4</span></span>] } doc.render(context) doc.save(test[x]+<span class="hljs-string"><span class="hljs-string">'.docx'</span></span>) x+=<span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre> <br>  At the end of the cycle, we ‚Äújump over‚Äù the name of the column with the name of the company so that the word file is preserved with the correct name. <br><br>  The program is ready!  It remains only to create an excel spreadsheet with companies that are serviced. <br><br>  Download the finished program - <a href="https://yadi.sk/i/XbGDFml7cCJs5A">here</a> . <br><br>  Download the excel spreadsheet with test data - <a href="https://yadi.sk/i/N52S_9R_U1vjiQ">here</a> . <br><br>  The word document template is <a href="https://yadi.sk/i/W_454HxqWl66kQ">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/459152/">https://habr.com/ru/post/459152/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../45914/index.html">Using third-party brands in a startup</a></li>
<li><a href="../459140/index.html">Implant placement: how is it done?</a></li>
<li><a href="../459142/index.html">Building an animated linear graph of a moving average in R. Retrieving data through the NBA API</a></li>
<li><a href="../459146/index.html">Product Design Digest June 2019</a></li>
<li><a href="../459150/index.html">The digest of fresh materials from the world of the frontend for the last week No. 372 (July 1 - 7, 2019)</a></li>
<li><a href="../459154/index.html">Network for small businesses on Cisco equipment. Part 1</a></li>
<li><a href="../459156/index.html">VNIITE planet of the whole: how in the USSR the system of ‚Äúsmart home‚Äù was invented</a></li>
<li><a href="../459158/index.html">How Artifact was Valve's biggest failure</a></li>
<li><a href="../459162/index.html">"To win the championships, the team must breathe in unison." Interview with Moscow Workshops ICPC coach</a></li>
<li><a href="../459166/index.html">What are you, a closure in javascript?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>