<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Extract Fonts from PDF</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Immediately it should be said that the best information on the format than the multi megabyte PDFReference from the Adobe site does not exist. For tho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Extract Fonts from PDF</h1><div class="post__text post__text-html js-mediator-article">  Immediately it should be said that the best information on the format than the multi megabyte PDFReference from the Adobe site does not exist.  For those who write in C ++ there is a ready solution - XPDF.  In Linux, this is the most full-featured replacement for Adobe products.  Russian-language materials on this topic are superficial and serve only for familiarization, and not for practical work.  But I expect that you are already familiar with them, and better with PDFReference.  I decided to describe a specific simplified example of extracting fonts from a truetype PDF file, because this question often sounds on the web and remains unanswered.  I know only one such program that works with errors and without source.  I remind you that it is not always legal to use the extracted fonts, you can only display text from the document using the embedded font. <br><a name="habracut"></a><br>  Who was interested in the question, they know that the PDF consists of the header, cross-reference table (XRef), body and trailer (trailer).  All elements except the title can be scattered in parts and in several copies throughout the document.  First you need to read the XRef table.  I recommend to issue its class.  To find the address of the table, we read the file from the end, until we meet the %% EOF tag.  We continue to read backwards before the startxref tag.  Now you can read the number that follows this tag. <br>  Here is an example of the end of the file: <br><br>  startxref <br>  173 <br>  %% EOF <br>  the number 173 is the offset from the beginning of the file data to the beginning of the first XRef table.  Moving to this point, we see something like this: <br>  xref <br>  7628 42 <br>  0000000016 00000 n <br>  0000001195 00000 f <br>  etc. <br><br>  At 7628, we will not pay attention yet (this is the name of the first object where information about the number of pages is recorded, for example, as well as many other things).  And 42 is the number of records in this part of the table.  Further, quite simply: we read the first word in the 10-byte buffer, skip the space and read the 5-byte buffer, read a single character.  And so 42 times.  The converted to integer strings have the following value - the offset from the beginning of the data to the reference object, the generation number.  The last character is interpreted as follows: n - the object is used, f - the object is not used, but as I said, the XRef table may have continuations in the file stream.  How to find them?  after the table always follows the trailer tag.  When he meets, you need to look for the string / Prev - if there is one, then an offset to the next table follows. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      / Prev 4025745 <br><br>  Thus, we read all the tables if there are more than one.  You can finish reading if in the next trailer there is no key / Prev.  A sign of the last table can also be that it begins with the entry 0000000000 65535 f.  It must be said that we read the tables backwards, the latter, when reading, is the first that appeared when creating the document itself, and the first, when reading, appeared after the last editing. <br><br>  Using the data we can navigate to any reference document object.  True, there are still direct objects whose addresses are not listed in the XRef, but more on that later.  Now we can iterate over document objects, check their type and do with them what our heart desires.  The object starts like this: <br><br>  7626 0 obj <br>  object content <br>  endobj <br><br>  7626 is the number (name) of the object, and 0 is the generation number, which must match the similar value in the reference table for this object.  As I understand it, if the object is changed, edited, then the generation number increases.  We are going to look for fonts, for this we need to read the dictionary of the object, which is a lexeme, enclosed in tags &lt;&lt; ... &gt;&gt;.  If the dictionary elements have such a structure, for example: <br><br>  / FirstChar 32 <br><br>  where the word after the slash is the key, and the optional value after the space is the value.  When parsing, you must remember that the value may contain any data, any enclosure, including other dictionaries.  So recursion in your hands, however, is possible without recursion, if we work on the specific task of extracting fonts.  The specified value may also include nested or non-nested elements of the following types: <br><br>  (...) -text lines <br>  &lt;...&gt; - hex strings <br>  [...] - arrays <br><br>  The value string continues to the next slash or line feed.  To identify the font object you need to find a combination in the dictionary: <br><br>  / Type / Font <br>  Now we filter Truetype fonts by content in the sequence dictionary: <br>  / Subtype / TrueType <br><br>  The rest of the keys are ignored, because we just want to extract the fonts.  But most likely we will not find the font itself in this object.  Only a set of unnecessary keys to us.  We read one of them: <br><br>  / FontDescriptor 1675 0 R <br><br>  If there is no such key, the font is external and not embedded in the document.  Next, the generation number of this object, and the symbol R indicates that it is a link.  We have already read the XRef table and now we can move to the font data through the search for the offset for the object with the number 1675. However, such an option is possible: <br><br>  / FontDescriptor &lt;&lt; dictionary and / or font data &gt;&gt; <br><br>  We assume that we have moved the link to a direct object.  In his dictionary should be such keys: <br><br>  / Type / FontDescriptor <br><br>  This object also has a lot of useful information about the font, but the font itself is not there again.  Not my fault - all claims against Adobe.  We need such a key <br><br>  / FontFile2 1676 0 R <br><br>  Familiar design.  Go to the next object.  If we did everything right, then this is a stream object.  It consists of a stream dictionary and binary data enclosed between stream ... endstream tags.  Here I must say that the presence of binary data does not allow to use ready-made text parsers.  I tried a lot and had to write my own from scratch.  Binary data can be read at once, as the stream dictionary contains the / Length key with the stream length.  If you try to save the extracted stream to a file with a TTF extension, the system will declare that it is in no way a font.  All right, you have to unclench it. <br><br>  The font is often compressed using zip, but to be sure, you can check it by the presence of the / FlateDecode key.  If we work in Delphi, then we use standard ZLib.  We can get the buffer size for the expanded data from the stream dictionary using the / Length1 key.  Well, you need to know that the font embedded in the document contains only those glyphs that are used in the document. <br><br>  I think that after these blueprints you can take hex-ver in one hand, PDFReference in the other and cost your own AcrobatRider. </div><p>Source: <a href="https://habr.com/ru/post/116025/">https://habr.com/ru/post/116025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116017/index.html">Hetzner dedicated or in search of cheap hosting</a></li>
<li><a href="../116018/index.html">How to get rid of glare on the screen of your iPad 2?</a></li>
<li><a href="../116021/index.html">tinycmd - enter a few characters instead of a long command in the console</a></li>
<li><a href="../116022/index.html">ReactOS developers proudly present version 0.3.13</a></li>
<li><a href="../116023/index.html">Google received a patent for Doodles</a></li>
<li><a href="../116026/index.html">Windows Azure: Blob and Table complement each other</a></li>
<li><a href="../116027/index.html">3D came to microscopes</a></li>
<li><a href="../116029/index.html">Online broadcast from the conference "Modern technological education in school: from computer to robot"</a></li>
<li><a href="../116030/index.html">What PHP framework do you use? And why?</a></li>
<li><a href="../116031/index.html">Great themes for ADW Launcher, Go Launcher EX, MIUI ROM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>