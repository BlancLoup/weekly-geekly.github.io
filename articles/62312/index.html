<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Weather Monitoring or Cacti HowTo</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This post could start in different ways. It is possible on business: how the monitoring system is needed to search for system errors and how it helps ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Weather Monitoring or Cacti HowTo</h1><div class="post__text post__text-html js-mediator-article">  This post could start in different ways.  It is possible on business: how the monitoring system is needed to search for system errors and how it helps to detect bottlenecks.  But, now it's summer, time for outdoor recreation, and I'll start with how I decided to find out how often the weather forecast changes using the popular monitoring tool Cacti.  Under the cut, about a curious reader!, You are waiting for stories about how to set up monitoring of arbitrary data in <a title="cacti" href="http://ru.wikipedia.org/wiki/Cacti">Cacti</a> , and not just, but with pictures. <br><br><a name="habracut"></a><br>  So, a week before June 19th (Friday, you know ...) I started watching, what will the weather be like?  I watched from <a title="yandex" href="http://weather.yandex.ru/">Yandex</a> - I really love these web meteorological sites.  The weather changed day by day and I was curious - what is the frequency of these changes?  The feeling of the weather is a subjective thing, and the frequency of changes in the forecast on the site is quite measurable.  For these purposes, I decided to use the long-known <a title="cacti" href="http://ru.wikipedia.org/wiki/Cacti">Cacti</a> monitoring tool.  The article is intended mainly for programmers and system administrators, so I don‚Äôt consider how to install Cacti - these people have either already been installed or can handle in 5 minutes. <br>  If you are wondering how often the weather changes in forecasts, but Cacti is not interesting, skip right to the end. <br><br><h3>  Cacti Philosophy </h3><br><img align="right" src="https://habrastorage.org/getpro/habr/post_images/1ec/08b/7b4/1ec08b7b485bd426156476fb4a8d6856.png"><br>  Cacti is based on <a href="http://en.wikipedia.org/wiki/RRDtool">RRDTool</a> - a tool for working with circular databases (RRD - round-robin database).  Such databases consider the time coordinate consisting of the intervals and record the values ‚Äã‚Äãof the stored parameter in the nodes of such intervals, interpolating, if necessary, the measured value.  In a single database, there can be several RRA (round-robin archive) ‚Äîthis is achieved the ability to store a value with different time intervals (that is, with different detail).  All these operations Cacti hides from the user - all we need to do is to set up monitoring of the value - to provide a means to get this value and tell Cacti to start the poller (data collector - pulls data from all the sources and saves them to that very RRD ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First, a few words about the ‚Äúentities‚Äù that exist in Cacti.  They are listed in the left menu in the admin panel: <br>  So: <br><ul><li>  <strong>Data Input Method</strong> - describes how the data will be obtained.  The main methods are SNMP (an interesting topic, but we will not go deep) and the external script is our case. </li><li>  <strong>Data Template</strong> - describes how often and with what parameters the <em>Data Input Method</em> will be used. </li><li>  <strong>Data Source</strong> - RRD itself - stores data in a file, it is created based on the <em>Data Template</em> </li><li>  <strong>Graph Template</strong> .  You can describe in it all the details of the display, except for the data source, and you can create template parameters for color, transparency and other things </li><li>  <strong>Graph</strong> - the actual graph.  You can prepare by mixing <em>Data Source, Graph Template</em> and specifying all template parameters from the Graph Template </li><li>  <strong>Graph Tree</strong> - a tree of graphs - if you have a lot of graphs (for example, monitor 10 machines), then it is convenient to create a hierarchy </li><li>  There is much more, but we will not need it yet. <br></li></ul><br><br><h3>  Script for mining weather </h3><br>  To find out the forecast at a given time, you need to upload a page with Yandex weather and parse.  Since we don‚Äôt know in advance what day we are interested in, we‚Äôll make a script that will accept a date for an input, give a temperature at the output for it in the afternoon.  You don‚Äôt need to contact Yandex every 5 minutes - the weather is unlikely to change so often, so let's make the script cache the data.  I will not go deep here, just give the script code: <br><blockquote><ol><li> <code><font color="#666666">#!/bin/bash <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></font></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#000000"><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> fi <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></font></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> <li> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> </li> </ol></blockquote> <code><font color="#666666">#!/bin/bash</font> <font color="#7a0874">cd</font> <font color="#000000">/</font> usr <font color="#000000">/</font> share <font color="#000000">/</font> cacti <font color="#007800">flagdate</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">date</font> <font color="#ff0000">"+%Y-%m-%d %H:00"</font> <font color="#7a0874">)</font> <font color="#007800">flagfile</font> =yandex.flag <font color="#c20cb9">touch</font> <font color="#007800">$flagfile</font> <font color="#660033">-d</font> <font color="#ff0000">" <font color="#007800">$flagdate</font> "</font> <font color="#000000">if</font> <font color="#7a0874">[</font> <font color="#000000">!</font> <font color="#660033">-e</font> index.html <font color="#660033">-o</font> index.html <font color="#660033">-ot</font> <font color="#007800">$flagfile</font> <font color="#7a0874">]</font> ; <font color="#000000">then</font> <font color="#c20cb9">wget</font> http: <font color="#000000">//</font> weather.yandex.ru <font color="#000000">/</font> <font color="#000000">27612</font> <font color="#000000">/</font> <font color="#660033">-O</font> index.html <font color="#000000">&gt;</font> <font color="#000000">/</font> dev <font color="#000000">/</font> null <font color="#000000">2</font> <font color="#000000">&gt;&amp;</font> <font color="#000000">1</font> <font color="#000000">fi</font> <font color="#007800">day</font> =$ <font color="#000000">1</font> <font color="#007800">pos</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> weekday <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"&lt;th class= <font color="#000099">\"</font> week[^0-9]*[0-9]*[^0-9]*&lt;/th&gt;"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#007800">$day</font> <font color="#660033">-n</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"^[0-9]"</font> <font color="#7a0874">)</font> <font color="#7a0874">let</font> <font color="#007800">pos</font> =pos+ <font color="#000000">1</font> <font color="#007800">res</font> =$ <font color="#7a0874">(</font> <font color="#c20cb9">cat</font> index.html <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#ff0000">"&lt;tr class= <font color="#000099">\"</font> data day <font color="#000099">\"</font> &gt;"</font> <font color="#660033">-A1</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"+[0-9]*"</font> <font color="#000000">|</font> <font color="#c20cb9">sed</font> <font color="#660033">-n</font> <font color="#ff0000">" <font color="#007800">$pos</font> "</font> <font color="#ff0000">"p"</font> <font color="#7a0874">)</font> <font color="#7a0874">echo</font> <font color="#007800">$res</font> <font color="#000000">|</font> <font color="#c20cb9">grep</font> <font color="#660033">-o</font> <font color="#ff0000">"[0-9]*"</font> <br></code> <br><h4>  Data Input Method </h4><br>  Now that the script is ready, you need to put it somewhere (it‚Äôs up to you).  I, for example, put in / usr / share / cacti /.  But do not forget to take into account the rights to read and run (just to create a file) - poller will run this script under the user <strong>www-data</strong> .  Next, create a <em>Data Input Method</em> : <br><img src="https://habrastorage.org/getpro/habr/post_images/5d2/ced/b33/5d2cedb33a7b29e18796733a1771e3c4.png"><br>  Using the <strong>&lt;day&gt;</strong> construct, we make the template parameter for the input method.  It must be declared in the <em>Input Fields</em> list - so that the <em>Data Template</em> knows about it.  You also need to declare the Output Field with the name res (the name is not important, since our script returns one value).  Making the <em>Data Input Method</em> is a pleasure, the most interesting thing to come) <br><br><h4>  Data template </h4><br>  We create <em>Data Template</em> : <br><img src="https://habrastorage.org/getpro/habr/post_images/ca2/faf/808/ca2faf808d9992b2009b73ca65d21088.png"><br>  By default, we are prompted to enter all the parameters, but some of them can be delegated to <em>Data Source</em> .  In our case, we delegate the name and parameter to the <em>Data Source</em> script. <br><br><h4>  Data source </h4><br>  Making <em>Data Source is</em> also pretty simple: <br><img src="https://habrastorage.org/getpro/habr/post_images/8dc/586/4b7/8dc5864b709edb4bc77b3c9b19378eba.png"><br>  Select the newly created <em>Data Template</em> , the host name can be left empty - in our case everything happens on the local machine.  We write a unique name for Data Source (uniqueness is not required - it is necessary so that it would be easier to insert it into the schedule) and the day we are monitoring, in our case, the 19th number.  The file name is calculated based on the id of the given Data Source - but you can choose your own one (the main thing is that there are no collisions). <br><br><h4>  Graph Template </h4><br>  Most of all, perhaps, the settings for graphs.  Create a new <em>Graph Template</em> and see: <br><img src="https://habrastorage.org/getpro/habr/post_images/6fc/1db/73a/6fc1db73a610f41f6e76a6e367db202b.png"><br>  First, the elements of the chart are listed - lines, legends, other signatures.  Further, the template parameters (where without them, this is a template).  And then there is a bunch of graph parameters (I did not give them in the figure, they are pretty obvious - limits, logarithmic scale and other things that are not necessary in our case). <br>  To begin with, we create visual elements (in the settings for a chart, the captions can be made by analogy): <br><img src="https://habrastorage.org/getpro/habr/post_images/ac3/3ce/96c/ac33ce96c33299b0f0a8915c013fe061.png"><br>  We leave the name of the <em>Data Source</em> and the color empty - we‚Äôll move them to the template parameters.  The main parameters of the visual element: <br><ul><li>  <strong>Graph Item Type</strong> is an item type.  In our case there will be <em>AREA</em> (the actual graph) or <em>GPRINT</em> (the caption is at the bottom of the graph - we will write the average and maximum values) </li><li>  <strong>Consolidation Function</strong> - for the schedule should be <em>AVERAGE</em> , when creating signatures, you can also choose <em>LAST / MAX / MIN</em> </li><li>  <strong>GPRINT Type</strong> - for signatures, you can specify an extended output format.  You can create your own format in the <strong>Graph Managment</strong> -&gt; <strong>GPRINT Presets menu</strong> .  There's the usual printf format, nothing interesting) </li></ul><br><br>  When visual elements are described, you can create template parameters in the Graph Item Item Inputs list: <br><img src="https://habrastorage.org/getpro/habr/post_images/f68/8b3/ac0/f688b3ac0fc80abe045be8dc029f54c5.png"><br>  In this window, you need to specify that we want to template (data source, color, transparency, or something else) and to which elements this will apply.  In our case, you need to submit a template data source for all elements. <br><br><h4>  Almost Final </h4><br>  Now that we have a data source and a graph template, we create the graph itself in the <strong>Graph Managment</strong> menu: <br><img src="https://habrastorage.org/getpro/habr/post_images/bb2/a46/3d5/bb2a463d59a8cea97bcecb8b06a108d4.png"><br>  If everything is done correctly, the schedule should appear immediately.  But there is one BUT - at least two pollings must pass in order to draw the data on the chart - that is, about 10 minutes. <br>  In the process of setting up new data sources, it is convenient to use remote information, which is sufficient in Cacti: <br><ul><li>  There are many logs in <em>/ var / log / cacti /</em> , in particular poller errors poller-error.log </li><li>  In the <strong>System Utilities</strong> menu -&gt; <strong>View Cacti Log File</strong> </li></ul><br><br><h4>  The final </h4><br>  So, for the sake of which there were all the dances with a tambourine, the dynamics of the weather forecast change for June 19 by Yandex. Weather: <br><img src="https://habrastorage.org/getpro/habr/post_images/141/481/78b/14148178b53bcd7d0e1b46948bfba858.png"><br>  And, as a bonus, the dynamics of changes in the dollar exchange rate by the Central Bank of the Russian Federation (there is an empty area - this is not a symbol of the crisis, but I just cut down the server): <br><img src="https://habrastorage.org/getpro/habr/post_images/65f/eff/001/65feff0010fde74a80054b3af3ba6e7e.png"><br><br>  What you want to monitor you - the mistakes of the Apache, the number of users, or the number of songs in your playlist - a question of fantasy.  Good luck to all who are interested in experimenting with Cacti! <br><br>  PS While I was writing this post, Yandex decided that the 19th would be even colder by two degrees ... But, nevertheless, the weather from Yandex is very cool, even it was nice to parse. <br>  PPS Cacti is far from the only tool for working with RRD - there is Munin, Ganglia, Nagios and a whole lot more. <br></div><p>Source: <a href="https://habr.com/ru/post/62312/">https://habr.com/ru/post/62312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62305/index.html">Easy way to get model fields in ActiveResource</a></li>
<li><a href="../62307/index.html">The Pirate Bay begins testing anonymizer</a></li>
<li><a href="../62308/index.html">Children's Wikipedia. Need?</a></li>
<li><a href="../62309/index.html">Until the roof has moved out - paint it white</a></li>
<li><a href="../62311/index.html">Open air do it yourself</a></li>
<li><a href="../62314/index.html">Safe JSONP? An interesting feature of the Bing API</a></li>
<li><a href="../62315/index.html">Easy way to add license file support to your .Net application</a></li>
<li><a href="../62316/index.html">Elections in Iran: Internet media as a means of fighting for freedom of choice</a></li>
<li><a href="../62317/index.html">Miranda 0.8 released</a></li>
<li><a href="../62318/index.html">1048 characters / minute 0_o</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>