<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing, configuring and using the rkhunter server vulnerability scanner</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Habr√©, an application called rkhunter was mentioned more than once. I would like to dwell on it in more detail. 

 Rkhunter is a scanner of various...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing, configuring and using the rkhunter server vulnerability scanner</h1><div class="post__text post__text-html js-mediator-article">  On Habr√©, an application called rkhunter was mentioned more than once.  I would like to dwell on it in more detail. <br><br>  Rkhunter is a scanner of various types of local (potential) vulnerabilities (backdoors, exploits and rootkits) with its regularly updated database. <br>  It is written in bash and perl, so it will work under any unix-based server OS without any problems. <br><br><img src="https://habrastorage.org/files/1cc/706/cf5/1cc706cf5f1e4e2c8430118fc29495cf.gif">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  To install, you can use the official repositories of the OS on which you want to scan, or by downloading the archive from the official website <a href="http://rkhunter.sourceforge.net/">http://rkhunter.sourceforge.net/</a> <br><br>  <b>Installation</b> <br><ul><li>  Centos: yum install rkhunter </li><li>  Debian / Ubuntu: apt-get install rkhunter </li><li>  FreeBSD: make all install clean -C / usr / ports / security / rkhunter or pkg install rkhunter </li></ul><br><br>  <b>First launch and preparation</b> <br>  The first run is required to check the system for compatibility and correct installation of the rkhunter itself. <br><br>  Check for the beginning of the relevance of the installed version <br><br>  <i>rkhunter --versioncheck</i> <br><br>  There will be such information by which you can judge the relevance of the version. <br>  <i>[Rootkit Hunter version 1.4.2]</i> <i><br><br></i>  <i>Checking rkhunter version ...</i> <i><br></i>  <i>This version: 1.4.2</i> <i><br></i>  <i>Latest version: 1.4.2</i> <br><br>  To maintain the urgency of the vulnerability scan tool on the server, you must run rkhunter with the key --update <br><br>  <i>rkhunter --update</i> <br>  <i>[Rootkit Hunter version 1.4.2]</i> <i><br><br></i>  <i>Checking rkhunter data files ...</i> <i><br></i>  <i>Checking file mirrors.dat [No update]</i> <i><br></i>  <i>Checking file programs_bad.dat [No update]</i> <i><br></i>  <i>Checking file backdoorports.dat [No update]</i> <i><br></i>  <i>Checking file suspscan.dat [Updated]</i> <i><br></i>  <i>Checking file i18n / cn [No update]</i> <i><br></i>  <i>Checking file i18n / de [Updated]</i> <i><br></i>  <i>Checking file i18n / en [No update]</i> <i><br></i>  <i>Checking file i18n / tr [Updated]</i> <i><br></i>  <i>Checking file i18n / tr.utf8 [Updated]</i> <i><br></i>  <i>Checking file i18n / zh [Updated]</i> <i><br></i>  <i>Checking file i18n / zh.utf8 [Updated]</i> <br><br>  The second step is to create a snapshot of the installed system for the rkhunter command: <br>  <i>rkhunter - propupd</i> <br><br>  <i>[Rootkit Hunter version 1.4.2]</i> <i><br></i>  <i>File created: searched for 171 files, found 139</i> <br><br>  So, the database has been updated and now we are ready to make the first launch of rkhunter for scanning. <br>  <i>rkhunter -c --enable all --disable none</i> <br><br>  The system will be tested and various messages will be displayed for each of the item checks.  After each step, you will need to press Enter to continue.  At the very end, the system check summary information will appear: <br><br>  <i>System checks summary</i> <i><br></i>  <i>=====================</i> <i><br><br></i>  <i>File properties checks ...</i> <i><br></i>  <i>Files checked: 139</i> <i><br></i>  <i>Suspect files: 23</i> <i><br><br></i>  <i>Rootkit checks ...</i> <i><br></i>  <i>Rootkits checked: 381</i> <i><br></i>  <i>Possible rootkits: 0</i> <i><br><br></i>  <i>Applications checks ...</i> <i><br></i>  <i>Applications checked: 3</i> <i><br></i>  <i>Suspect applications: 0</i> <i><br><br></i>  <i>The system checks took: 2 minutes and 39 seconds</i> <i><br><br></i>  <i>All results have been written to the log file: /var/log/rkhunter/rkhunter.log</i> <i><br><br></i>  <i>One or more warnings have been found while checking the system.</i> <i><br></i>  <i>Please check the log file (/var/log/rkhunter/rkhunter.log)</i> <i><br></i> <br><br>  Please note that rkhunter keeps a log file and in it you can see the data that was displayed on the screen during the test. <br><br>  The first launch and check is made, now we will pass to more thin setup of this remarkable tool. <br><br>  <b>Rkhunter setup</b> <br>  The rkhunter configuration file can be located in /etc/rkhunter.conf or /usr/local/etc/rkhunter.conf, depending on the OS and distribution. <br>  First of all, let's set up an alert to the email address in the parameter <br>  <i>MAIL-ON-WARNING = "mailbox @"</i> <br>  In the event of a false positive for files of the / bin / which type, you can use the SCRIPTWHITELIST parameter and add files to it that you do not need to check / signal about the problem.  Add one by one to the parameter on the line: <br>  <i>SCRIPTWHITELIST = "/ usr / sbin / adduser"</i> <i><br></i>  <i>SCRIPTWHITELIST = "/ bin / which</i> <i><br></i> <br>  If you use the root user for ssh access and do not intend to disable it, you can disable this check: <br>  <i>ALLOW_SSH_ROOT_USER = yes</i> <br><br>  After editing the configuration file, save it and check for problems by running rkhunter with the -C key: <br>  <i>rkhunter -C</i> <br>  Run rkhunter to check the system, but add the -rwo switch to display only warnings: <br>  <i>rkhunter -c --enable all --disable none --rwo</i> <br><br>  <b>Auto start scan</b> <br>  Scheduler settings can be made both from the console and in the ISPmanager control panel. <br><br>  In the console, you need to run the crontab -e command and add a line for daily scanning: <br>  @daily / usr / bin / rkhunter --cronjob --update --quiet <br><br>  In ISPmanager4, the scheduler is located in the menu item ‚ÄúTools‚Äù -&gt; ‚ÄúScheduler (cron)‚Äù <br><img src="https://habrastorage.org/files/8d4/2b6/743/8d42b674301741a1a7a22314ca83c32c.png"><br><br>  In ISPmanager5 this is the ‚ÄúScheduler‚Äù menu item in the ‚ÄúSystem‚Äù section. <br><img src="https://habrastorage.org/files/f99/f77/c2c/f99f77c2c1c5460fa3c748512f000c69.png"><br><br>  As a conclusion I want to remind.  Do not forget to run <i>rkhunter --propupd</i> after each configuration file change or OS update.  This will prevent false positives. </div><p>Source: <a href="https://habr.com/ru/post/242865/">https://habr.com/ru/post/242865/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242847/index.html">How to find your vocation (new article from Oliver Amberton)</a></li>
<li><a href="../242851/index.html">The process of constant change in the company - how it is automated</a></li>
<li><a href="../242857/index.html">Announced reports of the conference. NEXT 2014 Moscow</a></li>
<li><a href="../242861/index.html">Creative card file</a></li>
<li><a href="../242863/index.html">PowerShell Web Access: manage servers from a browser</a></li>
<li><a href="../242869/index.html">Logger with member functions that do not exist</a></li>
<li><a href="../242875/index.html">FAQ on the conference. NEXT 2014 Moscow</a></li>
<li><a href="../242877/index.html">Go turned 5 years old</a></li>
<li><a href="../242879/index.html">Running Terminal Server for 1C Applications on Synology NAS</a></li>
<li><a href="../242881/index.html">Bestsellers O'Reilly</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>