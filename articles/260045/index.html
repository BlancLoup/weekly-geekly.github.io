<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Material Design and Search by the example of a reference application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 A few years ago I wrote an article on Habr about a math reference application for Android, which was my first development experience fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Material Design and Search by the example of a reference application</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  A few years ago I wrote an article on Habr about a math reference application for Android, which was my first development experience for GooglePlay.  Today, looking back at my past habrapost and past version of the application, I get scared (to shudder just look at the first screenshot below).  Over the past few years, much has changed: AndroidMarket has become GooglePlay with new rules and other things, new OS versions have been released, a certain general google-concept for the design of material-design applications has appeared, new development environments have appeared, and Habr has changed. <br><br>  In this post we will talk about how to make your application material, add search to it, as well as some thoughts about what kind of advertising to use. <br><img src="https://habrastorage.org/files/180/07c/086/18007c0863004c1faf478fd5fa2ecbeb.png"><br><a name="habracut"></a><br>  In general, the application has undergone several <s>major</s> design changes during its existence.  A short story about how it changed is shown in the screenshots: <br><br><img src="https://habrastorage.org/files/d02/476/d9e/d02476d9e2a942669867ca6a9b6218e6.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Material design </h4><br>  Of course material design.  Where are without it now in the development of android?  I had to get rid of many graphic resources, which at one time were so carefully drawn, but nothing could be done, they did not fit into the concept of material design - they were too non-minimalist.  For example, sidebar icons: <br><br><img src="https://habrastorage.org/files/006/84d/2a9/00684d2a9fb54bdd8c9d3121e83f62cb.png"><br><br>  With <a href="http://romannurik.github.io/AndroidAssetStudio/icons-launcher.html">asset</a> icons for different screens, <a href="http://romannurik.github.io/AndroidAssetStudio/icons-launcher.html">asset studio</a> helps in working with resources, in which, among other things, there are also quite good long shadow and dog-ear effects.  In general, asset studio is a great designer that will save a lot of time when working with resources.  Also with the help of asset studio new material-icons were made for the purchase of beer and social interaction: <br><br><img src="https://habrastorage.org/files/cf6/bcd/696/cf6bcd696dff4c76bdc423373e3f9998.png"><br><img src="https://habrastorage.org/files/790/b64/620/790b64620e534a90983ac1c12a83def7.png"><br><br>  If beer is purchased, then sold out will appear in the lower right corner: <br><br><img src="https://habrastorage.org/files/0d5/ffb/f84/0d5ffbf84d7b44078519af0e4866819e.png"><br><br>  The application icon has also undergone some changes, here I had to open Photoshop and draw: <br><br><img src="https://habrastorage.org/files/029/04d/030/02904d030a7d492a80f6ab27f9fc3556.png"><br><br>  The most difficult thing is over, we will not talk about graphic resources anymore. <br><br>  Now we will create several themes for our application and add a FloatingActionButton.  In the <i>values ‚Äã‚Äã/</i> project folder in the themes.xml file, we will describe two themes for our Light and Dark application: <br><br><div class="spoiler">  <b class="spoiler_title">themes.xml</b> <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"LightTheme"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">parent</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Theme.AppCompat.Light.DarkActionBar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimary"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/greenPrimary1</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimaryDark"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/greenPrmrDark1</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"android:windowBackground"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/mn_bck1</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorAccent"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/fabBckgrnd1</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DarkTheme"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">parent</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ThemeOverlay.AppCompat.Dark.ActionBar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimary"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/greyPrimary1</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimaryDark"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/greyPrmrDark1</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"android:windowBackground"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/mn_bck2</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorAccent"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/fabBckgrnd2</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  About what colorPrimary, colorPrimaryDark, colorAccent is well written <a href="http://habrahabr.ru/post/241479/">here</a> and <a href="https://developer.android.com/training/material/theme.html">here</a> .  But what these topics look like in the application: <br><br><img src="https://habrastorage.org/files/ff7/0e0/a01/ff70e0a016d04d17b23b369d1ce2d2fc.png"><br><br>  I‚Äôll tell you how to apply the theme to all the activities of your application at once.  To do this, you need to make the BaseActivity inherited from ActionBarActivity (it does not need to be declared in the manifest and create an xml markup file for it).  In the onCreate () method of this activity, we call setTheme () depending on the user's choice in the application settings: <br><br><div class="spoiler">  <b class="spoiler_title">BaseActivity.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionBarActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String NAME_PREFERENCES = <span class="hljs-string"><span class="hljs-string">"mysetting"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String THEME_SWITCHER = <span class="hljs-string"><span class="hljs-string">"thmswtch"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> THM_SWTCHR_DFLT = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); SharedPreferences mSet = getSharedPreferences(NAME_PREFERENCES, Context.MODE_PRIVATE); <span class="hljs-comment"><span class="hljs-comment">/**   ,        (    LightTheme) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(mSet.getInt(THEME_SWITCHER, THM_SWTCHR_DFLT) == <span class="hljs-number"><span class="hljs-number">1</span></span>){ <span class="hljs-comment"><span class="hljs-comment">/**   c LOLLIPOP   -  - */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) { getWindow().addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS); getWindow().setStatusBarColor(getResources().getColor(R.color.greyPrmrDark1)); } setTheme(R.style.DarkTheme); } } }</code> </pre><br></div></div><br>  Well, all the other activities of our application, we will inherit from BaseActivity: <br><br><img src="https://habrastorage.org/files/433/506/d56/433506d561944889a3c82d3c71859365.png"><br><br>  When selecting color combinations for a theme in the material style, the materialpalette.com resource can be a great help, offering a full color palette for the theme in two main shades of your choice. <br><br>  <a href="http://github.com/amulyakhare/TextDrawable">TextDrawable</a> library is great for adding circular icons with text in each list <a href="http://github.com/amulyakhare/TextDrawable">item</a> , which is easy to use and allows you to create not only circular icons of the same type (as in the screenshots), but also icons of different shapes, colors, fonts and even add animation for them. <br><br><div class="spoiler">  <b class="spoiler_title">An example of using TextDrawable in the application's main list adapter</b> <div class="spoiler_text"><pre> <code class="java hljs"> TextDrawable drawable = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(position==<span class="hljs-number"><span class="hljs-number">0</span></span>) drawable = TextDrawable.builder().beginConfig().bold().endConfig().buildRound(<span class="hljs-string"><span class="hljs-string">"dx"</span></span>, context.getResources().getColor((curr_theme==<span class="hljs-number"><span class="hljs-number">1</span></span>) ? R.color.mn_dvdr_dark : R.color.mn_dvdr_lght)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(position==<span class="hljs-number"><span class="hljs-number">1</span></span>) drawable = TextDrawable.builder().beginConfig().bold().endConfig().buildRound(<span class="hljs-string"><span class="hljs-string">"lim"</span></span>,context.getResources().getColor((curr_theme==<span class="hljs-number"><span class="hljs-number">1</span></span>) ? R.color.mn_dvdr_dark : R.color.mn_dvdr_lght));</code> </pre><br></div></div><br>  <a href="http://www.google.com/design/spec/components/buttons-floating-action-button.html">Floating Action Button</a> (further we will call it fab) should bear in itself the main function of the application.  In the reference application, this is of course a search.  So  clicking on the button will drop SearchView.  In order for the fab to scroll down / up beautifully disappear / appear in the list, I recommend using the <a href="https://github.com/makovkastar/FloatingActionButton">FloatingActionButton</a> library. <br><br><div class="spoiler">  <b class="spoiler_title">FloatingActionButton usage example</b> <div class="spoiler_text"><pre> <code class="java hljs">FloatingActionButton fab; ListView MainListView; LinearLayout searchLayout; SearchView searchView; ... searchLayout = (LinearLayout) findViewById(R.id.search_view); searchView = (SearchView) findViewById(R.id.search); MainListView = (ListView) findViewById(android.R.id.list); fab = (FloatingActionButton) findViewById(R.id.fab); <span class="hljs-comment"><span class="hljs-comment">//  fab  MainListView. //      fab  ,     -  fab.attachToListView(MainListView); fab.setShadow(true); fab.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { Animation openSearch = AnimationUtils.loadAnimation(context, R.anim.search_down); searchLayout.startAnimation(openSearch); searchLayout.setVisibility(View.VISIBLE); Animation hideFab = AnimationUtils.loadAnimation(context, R.anim.s_down); fab.startAnimation(hideFab); fab.setVisibility(View.GONE); //     searchView searchView.requestFocus(); openKeyboard(); } }); ...</span></span></code> </pre><br></div></div><br>  This work on the materialization of application interfaces ends. <br><br><h4>  Search </h4><br>  Since the contents of the directory are stored in different html-files, in order to make a quick search on them you need: <br><ul><li>  Work with the html files themselves - add <a href="http://htmlbook.ru/samhtml/yakorya">anchors</a> to each place where the user will go when entering this or that request. </li><li>  Use the virtual FTS table (what is it you can read <a href="http://sqlite.org/fts3.html">here (English)</a> and <a href="http://xbb.uz/db/SQLite-FTS3-i-FTS4/">here (in Russian)</a> . In short, the FTS allows users to perform full-text searches on multiple documents). </li></ul><br><br>  The table contains two columns.  The first column (KEY_INPUT) is a list of all section titles and terms contained in the directory, in other words, this is a list of possible user requests.  The second column (KEY_ANKER) is a list of html files with anchors (ie, files and positions in these files) corresponding to these requests.  As with all other SQLite tables, both virtual and normal, data from FTS tables is obtained using SELECT queries: <br><br><pre> <code class="java hljs">String query = <span class="hljs-string"><span class="hljs-string">"SELECT docid as _id,"</span></span> + KEY_INPUT + <span class="hljs-string"><span class="hljs-string">","</span></span> + KEY_ANKER + <span class="hljs-string"><span class="hljs-string">" FROM "</span></span> + FTS_VIRTUAL_TABLE + <span class="hljs-string"><span class="hljs-string">" WHERE "</span></span> + KEY_INPUT + <span class="hljs-string"><span class="hljs-string">" MATCH '"</span></span> + inputText + <span class="hljs-string"><span class="hljs-string">"';"</span></span>;</code> </pre><br><br>  When you enter a text query, the FTS table is searched and options are provided to the user in the drop-down list.  When you select a transition to the desired section on the corresponding anchor.  The principle is shown in the figure below: <br><br><img src="https://habrastorage.org/files/f4d/db0/dbc/f4ddb0dbc5f54871a90f6d539d04ce7b.png" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">SearchDbAdapter.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SearchDbAdapter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String DATABASE_NAME = <span class="hljs-string"><span class="hljs-string">"mhdb"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String FTS_VIRTUAL_TABLE = <span class="hljs-string"><span class="hljs-string">"srcht"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> DATABASE_VERSION = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_INPUT = <span class="hljs-string"><span class="hljs-string">"rqst"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String KEY_ANKER = <span class="hljs-string"><span class="hljs-string">"ankr"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String DATABASE_CREATE = <span class="hljs-string"><span class="hljs-string">"CREATE VIRTUAL TABLE "</span></span> + FTS_VIRTUAL_TABLE + <span class="hljs-string"><span class="hljs-string">" USING fts3("</span></span> + KEY_INPUT + <span class="hljs-string"><span class="hljs-string">","</span></span> + KEY_ANKER + <span class="hljs-string"><span class="hljs-string">");"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Context mCtx; <span class="hljs-comment"><span class="hljs-comment">//     (  ,   ) public static final String search_arr[] = {"data1 request 1","data1 request 2","data2 request 3","data2 request 4"}; //     html-   (    assets ) public static final String ankers_arr[] = {"file1.html#an1","file2.html#an2","file1.html#an3","file1.html#an4"}; private static class DatabaseHelper extends SQLiteOpenHelper { DatabaseHelper(Context context) { super(context, DATABASE_NAME, null, DATABASE_VERSION); } @Override public void onCreate(SQLiteDatabase db) { db.execSQL(DATABASE_CREATE); int LNGTH = search_arr.length; ContentValues initValues = new ContentValues(); for(int i=0; i&lt;LNGTH; i++){ initValues.put(KEY_INPUT, search_arr[i]); initValues.put(KEY_ANKER, ankers_arr[i]); db.insert(FTS_VIRTUAL_TABLE, null, initValues); initValues.clear(); } } @Override public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) { db.execSQL("DROP TABLE IF EXISTS " + FTS_VIRTUAL_TABLE); onCreate(db); } } public SearchDbAdapter(Context ctx) { this.mCtx = ctx; } public SearchDbAdapter open() throws SQLException { mDbHelper = new DatabaseHelper(mCtx); mDb = mDbHelper.getWritableDatabase(); return this; } public void close() { if (mDbHelper != null) { mDbHelper.close(); } } public Cursor searchAnker(String inputText) throws SQLException { inputText = inputText.toLowerCase(); String query = "SELECT docid as _id," + KEY_INPUT + "," + KEY_ANKER + " FROM " + FTS_VIRTUAL_TABLE + " WHERE " + KEY_INPUT + " MATCH '" + inputText + "';"; Cursor mCursor = mDb.rawQuery(query,null); if (mCursor != null) { mCursor.moveToFirst(); } return mCursor; } }</span></span></code> </pre><br></div></div><br>  <b>1</b> .  The user enters the search query "data2" in SearchView.  The SearchViewer calls the searchAnker () method of the SearchDbAdapter class, which returns a cursor (mCursor) containing queries similar to the entered text and the corresponding html files with anchors: <br>  data2 request 3 - file1.html # an3 <br>  data2 request 4 - file2.html # an4 <br>  <b>2</b>  Similar requests contained in mCursor are displayed in the drop-down list: data2 request 3, data2 request 4. <br>  <b>3</b>  When clicking on the elements of the drop-down list, the ViewActivity is launched, to which the corresponding html-file name with the anchor from mCursor is transmitted with an intent: file1.html # an3 <br><br><h4>  Advertising and hidden features of the application </h4><br>  Do you need it, advertising?  It spoils the interface, and so much time and effort is spent to make it beautiful.  Now you can earn something from advertising either with millions of active users, or from aggressive banner advertising that works like this: <br><ul><li>  the user downloads an update into which the advertising library is integrated; </li><li>  stage of waiting, so that the user, at the moment of the beginning of the most interesting, does not immediately understand why this happens; </li><li>  The most interesting thing is that the user has, on top of all interfaces in other applications, huge advertising banners pop up on the full screen, not clicking on which is a difficult task. </li></ul><br>  Of course, such an advertisement, to put it mildly, very few people like it.  I have long ago refused any advertising in the directory, and more, perhaps, of interest, I added the usual donat - buying beer in the app. <br><br><img src="https://habrastorage.org/files/ac2/3ad/df0/ac23addf0446412a9cfd3bfd5bc15bb0.jpg"><br><br>  Buying beer is easily realized using <a href="http://developer.android.com/google/play/billing/billing_integrate.html">In-app Billing</a> .  To simplify the implementation of billing, there are libraries about which more than once was written on Habr√© <a href="https://github.com/serso/android-checkout">here</a> and <a href="https://github.com/anjlab/android-inapp-billing-v3">here</a> . <br><br>  In order to somehow revive our Activity with a donate, a small Easter egg has been added.  When you click on any area of ‚Äã‚Äãthe screen in the lower right corner Android will appear, reflecting on the beer. <br><br><img src="https://habrastorage.org/files/456/e12/6b6/456e126b600048609aa221a53465dd68.png"><br><br>  Here is the creativity.  <s>Perhaps if Jimmy Wales appeared in the lower right corner of the beer would be poured river</s> . </div><p>Source: <a href="https://habr.com/ru/post/260045/">https://habr.com/ru/post/260045/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260025/index.html">Fun starts or C ++ and STL: who is faster?</a></li>
<li><a href="../260027/index.html">Passing Stored Arguments to a Function</a></li>
<li><a href="../260029/index.html">Detector of UI locks in WPF with notification</a></li>
<li><a href="../260031/index.html">Windows and Mac OS Integration with Acronis Access Connect</a></li>
<li><a href="../260033/index.html">Is it true that Go is faster than Ruby?</a></li>
<li><a href="../260047/index.html">Interesting notes on C # and CLR (v2.0)</a></li>
<li><a href="../260049/index.html">One of the features of PHP related to methods and functions</a></li>
<li><a href="../260053/index.html">How to bind Docker containers without forcing the application to read environment variables</a></li>
<li><a href="../260061/index.html">Development of modular C / C ++ applications using annotations</a></li>
<li><a href="../260065/index.html">NGINX inside: born for performance and scaling</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>