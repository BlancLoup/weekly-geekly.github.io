<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MIG Icon Generator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings habrosoobschestvo. I want to share with you one of my latest mini-projects - the MIG geodata icon generator. With it, you can generate vecto...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MIG Icon Generator</h1><div class="post__text post__text-html js-mediator-article">  Greetings habrosoobschestvo.  I want to share with you one of my latest mini-projects - the <abbr title="Map Icons Generator">MIG</abbr> geodata icon generator.  With it, you can generate vector ( <abbr title="Scalable Vector Graphics">SVG</abbr> ) and raster (PNG) icons, with the specified parameters (color, size, stroke, etc.). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8a6/64d/f16/8a664df168ad89a8687257665fd7767e.png" alt="MIG demopage"><br><br>  All this works right in the browser and is distributed under the <b>MIT license</b> .  Under the cat you can learn how to use it and how it works. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  How to use </h4><br>  By default, <a href="https://github.com/KoGor/Map-Icons-Generator" title="MIG project on GitHub">MIG</a> uses a world map on a <b>1: 110m</b> scale to generate icons, based on <a href="http://www.naturalearthdata.com/downloads/" title="Natural earth data">natural earth data</a> .  It contains data for ( <b>174 + 3</b> ) countries of the world (the rest on this scale degenerate), plus three countries ‚Äî Northern Cyprus, Kosovo and Somaliland.  If this is enough for you, then simply set the parameters of the icons you need directly in the code, or use the <abbr title="Graphical User Interface">GUI</abbr> on the <a href="http://kogor.github.io//Map-Icons-Generator/" title="MIG demopage">MIG's demo page</a> .  If you want to filter out some countries, this can be done easily by setting conditions for the <code>properties</code> .  For example, filtering by ID is as follows: <br><br><pre> <code class="javascript hljs">.data(topojson.feature(world, world.objects.countries).features .filter(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">d</span></span></span><span class="hljs-function">) </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> contryList.indexOf(d.id) &gt; <span class="hljs-number"><span class="hljs-number">-1</span></span>;}))</code> </pre><br>  The demo looks very ascetic, because to achieve interesting results, you still have to change the code.  So boldly fork <a href="https://github.com/KoGor/Map-Icons-Generator" title="MIG project on GitHub">MIG</a> and change it for yourself.  Yes, new inputs are used in the demo (HTML5), they are not yet supported everywhere: <a href="http://caniuse.com/forms">caniuse</a> , but there is a fallback, so it should work anyway. <br><br>  So, what to do if the default option does not suit you.  First of all, it is necessary to determine the new geodata - this can be a world map, a country map with administrative borders, a city map with division into districts, or any other map.  Once you have decided on the geodata you need to convert them to <a href="https://github.com/mbostock/topojson/wiki" title="TopoJSON wiki">TopoJSON</a> .  This can be done using the <a href="https://github.com/mbostock/topojson/wiki/Command-Line-Reference">Command-line TopoJSON</a> , having previously installed the <a href="https://npmjs.org/package/topojson" title="NPM topojson">implementation of TopoJSON</a> for Node.js.  At the conversion stage, you must remove all unnecessary properties, you can also add names if you are not going to use an external file for this.  When the new TopoJSON file is ready, update the paths and names: <br><br><pre> <code class="javascript hljs">.defer(d3.json, <span class="hljs-string"><span class="hljs-string">"data/TopoJSON_file.json"</span></span>) .defer(d3.tsv, <span class="hljs-string"><span class="hljs-string">"data/external_file_for_names.tsv"</span></span>)</code> </pre><br>  Change the name of the <code>feature</code> to suit your new file: <br><br><pre> <code class="javascript hljs">.data(topojson.feature(world, world.objects.YourNewFeatureName).features</code> </pre><br>  Everything, now it is possible to generate icons! <br><br><h4>  Additional features </h4><br>  For those cases when you need to use a non-standard Mercator projection, you can easily add one of the <a href="https://github.com/mbostock/d3/wiki/Geo-Projections" title="D3.js projections">available projections</a> or even create your own.  In this case, you can apply a separate projection for at least each icon.  By the way, in the demo example, separate projections for Russia and the USA are used. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (d.id) { <span class="hljs-comment"><span class="hljs-comment">//Russia case "RUS": var projection = d3.geo.albers().rotate([-105, 0]).center([-10, 65]).parallels([52, 64]); path = d3.geo.path().projection(projection); break; //USA case "USA": var projection = d3.geo.albersUsa(); path = d3.geo.path().projection(projection); break; default: var projection = d3.geo.mercator(); path = d3.geo.path().projection(projection); break; }</span></span></code> </pre><br>  In general, there is an extensive field for experimentation. <br><br><h4>  What is under the hood </h4><br>  The generator is written using the <a href="http://d3js.org/" title="d3.js">D3.js library</a> , the code can be viewed on GitHub: <a href="https://github.com/KoGor/Map-Icons-Generator" title="MIG project on GitHub">Map Icons Generator</a> .  So, what is happening here.  First, the geodata and the corresponding names are loaded (for the case when they are not sewn into the TopoJSON file).  Then, for each object, an <abbr title="Scalable Vector Graphics">SVG</abbr> element is created of a given size and the corresponding map region is drawn into it in a given projection, while the centering and scale are calculated based on the <code>BoundingBox</code> .  There are several nuances associated with this point, since the presentation of geodata depends on the projection, in some cases autocentration and autoscaling will give an unattractive result.  For example, countries through which the anti-meridian passes (including our long-suffering Russia) or countries with a large spread of territories (island) will look very fine.  This can be corrected with the help of a suitable projection, or deletion (filtration) of a part of the territories of the displayed region.  Then go to the stylization of icons.  At this stage, you can use various SVG filters, gradients, patterns, <code>clipping</code> - in general, all the power of <abbr title="Scalable Vector Graphics">SVG</abbr> . <br><br>  Further, based on the created vector icons, raster are created.  This happens as follows: in the loop we go over all <abbr title="Scalable Vector Graphics">SVG</abbr> elements, create canvas elements and draw our icon there using the <code>context.drawImage()</code> , here also has a small nuance, the <abbr title="Scalable Vector Graphics">SVG</abbr> should be all right with the <code>xmlns</code> attribute, and its <code>Blob</code> 'a is the correct <b>MIME</b> type, otherwise it will not work.  Now fasten the save, run and enjoy the resulting icons. <br><br><h4>  Further development </h4><br>  I think to add filtering by country and improve the design of the demo page.  Change the saving mechanism - now the icons are saved either individually, when you click on a country, or the entire region (continent) at once, and a modal window is created for each icon, I plan to replace it with the ability to download icons with one archive.  I also plan to add the possibility of simplifying geometry and accuracy for geodata so that they can be adjusted accordingly to the size of the icons.  Now it can be done at the stage of creating TopoJSON ( <code>simplification</code> and <code>quantization</code> ). <br><br>  If there are any questions, something is not clear, found a bug or something else - write. <br><br>  That's all, good luck! </div><p>Source: <a href="https://habr.com/ru/post/211689/">https://habr.com/ru/post/211689/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../211675/index.html">The biggest problem with web development</a></li>
<li><a href="../211679/index.html">Beta Opera 20 for Android</a></li>
<li><a href="../211681/index.html">RF Prosecutor General‚Äôs Office held a meeting of the Bitcoin expert group</a></li>
<li><a href="../211685/index.html">Cisco VSS: Fear and Loathing at Work</a></li>
<li><a href="../211687/index.html">We disassemble the Sony Xperia Z1 Compact: a small smartphone with the heart of a large flagship</a></li>
<li><a href="../211691/index.html">Discover new and interesting with Likeastore</a></li>
<li><a href="../211693/index.html">Hey, NASA, and black holes do exist!</a></li>
<li><a href="../211697/index.html">Mobile application "LOOK +"</a></li>
<li><a href="../211701/index.html">Lightning catcher</a></li>
<li><a href="../211703/index.html">New Horizons: a long way to the outskirts</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>