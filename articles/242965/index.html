<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Portable distribution of .Net applications with Microsoft Report Viewer and Oracle Instant Client reports</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quite often there is a need or desire to abandon the creation of the installer and distribute the application by copying the folder with files to the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Portable distribution of .Net applications with Microsoft Report Viewer and Oracle Instant Client reports</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/230/fbc/f06/230fbcf06dae453c94325a317c46b0ca.png"><br><br>  Quite often there is a need or desire to abandon the creation of the installer and distribute the application by copying the folder with files to the target computer.  If you're wondering how to create a portable distribution of .Net applications with Report Viewer reports or how to portable copy client and driver to access the Oracle database, please use the cat.  I will try to explain everything in detail. <br><br>  As a practical part, the creation of an application that displays reports for the SuperMag trading system (which, in fact, uses the Oracle database) will be considered. <br><a name="habracut"></a><br>  One of the advantages of Oracle's portable distribution is that its standard installation is not the most pleasant thing to do.  And if you also install the Report Viewer, the installation process on several machines risks becoming a tedious task.  Of course, as an alternative, you can use ClickOnce, but when distributing with ClickOnce, you can also copy the folder with libraries as it is done in this example. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Required libraries for desktop applications with portable access to Oracle </h5><br>  You need to download Oracle Instant Client.  If you are using a localized application, then it is better for you to take a package of basic, although it takes about 100Mb in size, but, unlike the ‚Äúlight‚Äù (30 MB) light, it guarantees you to work with Cyrillic. <br><br>  Unpacks the archive and take 2 files from it: <br><br>  <b>oci.dll</b> (abbreviation for Oracle Call Interface); <br>  <b>orannzsbb11.dll</b> or <b>orannzsbb12.dll</b> (if you use version 12). <br><br>  A third file is also needed: <br><br>  If you took the version of basic, then it will be - <b>oraociei11.dll</b> or <b>oraociei12.dll</b> (again for version 12). <br>  If you have taken the version of light - <b>oraociicus11.dll</b> or <b>oraociicus12.dll</b> (I‚Äôm not going to mention that the second file for version 12 is understandable to everyone). <br><br>  And Oracle Data Provider - ODP.NET is also required (it is better to take the XCopy version, it is smaller), unpack and find 2 files: <br><br>  <b>Oracle.DataAccess.dll</b> ; <br>  <b>OraOps11w.dll</b> or <b>OraOps12w.dll</b> (this file is required by Oracle.DataAccess.dll for working with Oracle Instant Client files, it is the same for .Net 2.0 and for .Net 4.0). <br><br>  If you want to use version 12, you can download both the Oracle Instant Client and ODP in one ODAC file (Oracle Data Access Components) at: <a href="http://www.oracle.com/technetwork/topics/dotnet/downloads/index.html">www.oracle.com/technetwork/topics/dotnet/downloads/index.html</a> <br><br><h5>  Required libraries for portable Report Viewer application </h5><br>  For the portable distribution of the Report Viewer, let's take the 2010 version. <br><br>  Version 2013 as a version for portable distribution, I did not take.  After I discovered that Microsoft.ReportViewer.ProcessingobjectModel.dll is missing in it, I had a ‚Äútemplate break‚Äù and I decided that they would be quite satisfied with the reports of 2010.  If you know how to create a portable distribution of the 2013 version, I am waiting for your comments.  One could even announce a contest, but bad luck - there is no prize. <br><br>  Download <a href="http://www.microsoft.com/ru-ru/download/details.aspx%3Fid%3D6442">Microsoft Report Viewer Redistributable 2010</a> and unpack the exe file as an archive. <br>  Among the unpacked files we find <b>reportviewer_redist2010core.cab</b> . <br>  We continue the "matryoshka" and unpack in turn this file. <br>  Find the files and rename them as follows: <br><br>  FL_Microsoft_ReportViewer_Common_dll_117718_117718_x86_ln.3643236F_FC70_11D3_A536_0090278A1BB8 <br>  rename to <b>Microsoft.ReportViewer.Common.dll</b> <br><br>  FL_Microsoft_ReportViewer_Processingobject_125592_125592_x86_ln.3643236F_FC70_11D3_A536_0090278A1BB8 <br>  rename to <b>Microsoft.ReportViewer.ProcessingobjectModel.dll</b> <br><br>  FL_Microsoft_ReportViewer_WebForms_dll_117720_117720_x86_ln.3643236F_FC70_11D3_A536_0090278A1BB8 <br>  rename to <b>Microsoft.ReportViewer.WebForms.dll</b> <br><br>  FL_Microsoft_ReportViewer_WinForms_dll_117722_117722_x86_ln.3643236F_FC70_11D3_A536_0090278A1BB8 <br>  rename to <b>Microsoft.ReportViewer.WinForms.dll</b> <br><br>  If the developer's computer has the Oracle Client and Report Viewer installed (and it must be installed necessarily), links to these files can even be set, and simply copy them into folders from the exe (into the Debug and Release folders of the project).  But Oracle.DataAccess.dll must be placed in the project folder and set the "Copy Locally" property to one of the two copying options. <br><br>  In order for the fear of portable distribution not to be so large, I will briefly describe the library search algorithm of the desktop .Net application. <br><br>  Before you start the dll search, the system checks whether the dll is already loaded into memory, and whether the dll is already in the list of already known dlls (try to view the list in the registry at <b><i>HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Control \ Session Manager \ KnownDLLs</i></b> ). <br><br>  The dll search algorithm depends on some factors (for example, on whether the SafeDllSearchMode mode is set), but approximately this is (in the example SafeDllSearchMode is turned off): <br><br>  1. The directory from which the application is launched; <br>  2. Current directory; <br>  3. System directory.  You can use the GetSystemDirectory function to get the path to this directory; <br>  4. 16-bit system directory; <br>  5. Windows directory.  You can use the GetWindowsDirectory function; <br>  6. Folders that are listed in the system variable PATH. <br><br>  What is the system variable PATH and where it is located, see clearly in the following screenshot: <br><br><img src="https://habrastorage.org/files/a54/7e4/dfd/a547e4dfdbea443e93d70e53d64f0f1c.PNG"><br><br>  We now turn to the practical part. <br><br>  In a WPF application (and for me, XAML is more preferable than obsolete Forms as a layout editor), the Report Viewer component is added using the Windows FormsHost control. <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowsFormsHost</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">HorizontalAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Stretch"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">VerticalAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Stretch"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0,0,0,0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"windowsFormsHost1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rv:ReportViewer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_reportViewer"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowsFormsHost</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  To make the example not look useless, we will get data from the document history in it. <br>  To store the data required by the report, create a class: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ReportDataSM</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime EventTime { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Doc { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> UserName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> NewState { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br>  Now we can create a template file for the appearance of our report (For a visual editor, the Microsoft SQL Server Data Tools option should be selected when installing Visual Studio). <br><br>  Add a report file to the project (Reporting).  Set the value of the "Copy Local" property to "Copy if newer."  Then open the newly created report file and go to the ‚ÄúData Sources‚Äù tab.  Click ‚ÄúAdd new data source‚Äù, select ‚ÄúObject‚Äù type, open our project in the list of objects and find our ReportDataSM class in it, which we select: <br><br><img src="https://habrastorage.org/files/64d/9d9/546/64d9d954675041dfb3220e4a0c65af36.PNG"><br><br>  Next, to display the rows with data, add a table to the report.  When adding a dataset property to a query, select our data source and give it some name (in the example DataSet1): <br><br><img src="https://habrastorage.org/files/e68/e46/fac/e68e46fac0be474787f6ffd9c78dcf44.PNG"><br><br>  This data source will be specified in the table table in the DataSetName property.  The rdlc file can be edited not only with the help of the visual editor, but also with the help of the XML editor (this way it is convenient to delete old unnecessary data). <br><br>  We set the columns to the values ‚Äã‚Äãfrom the data of our array (clicking on the lines is simple and intuitive, I will not explain in detail). <br><br><h5>  Consider the code </h5><br>  Since freezing the interface is a very bad practice, we will start fetching the data in a separate thread.  For data storage, we use the competitive generic collection of the ReportDataSM class.  Add to variable declarations (at the beginning of the class): <br><br><pre> <code class="cs hljs">ConcurrentBag&lt;ReportDataSM&gt; list4R;</code> </pre> <br>  After initializing it somewhere in the code: <br><br><pre> <code class="cs hljs">list4R = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentBag&lt;ReportDataSM&gt;();</code> </pre> <br>  Once we decided to receive data without blocking the interface, we will need a delegate to call the method asynchronously: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyGetDataDelegate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> s</span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br>  In this example, the delegate takes one string value as a parameter. <br>  The parameter will be the ID of the document for which you want to receive data on the change history. <br>  A method that is a delegate implementation, let it be a method called getDataMethod. <br>  I cite the simplified code for the implementation of the data acquisition method (without processing possible errors): <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDataMethod</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> docid</span></span></span><span class="hljs-function">)</span></span>{ DataSet dataset = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataSet(); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> oradb = <span class="hljs-string"><span class="hljs-string">"Data Source="</span></span> + <span class="hljs-string"><span class="hljs-string">"DATABASENAME"</span></span> + <span class="hljs-string"><span class="hljs-string">";User Id="</span></span> + <span class="hljs-string"><span class="hljs-string">"typeusernamehere"</span></span> + <span class="hljs-string"><span class="hljs-string">";Password="</span></span> + <span class="hljs-string"><span class="hljs-string">"password123"</span></span> + <span class="hljs-string"><span class="hljs-string">";"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  ,        ,      Oracle //   TNSNAMES.ORA  ,     . using (OracleConnection conn = new OracleConnection(oradb)) { if (conn.State != ConnectionState.Open) conn.Open(); string sqltext = "select SMDocLog.EVENTTIME, SMDocLog.ID, SMDocLog.USERNAME, NVL(SSDocStates.DOCSTATENAME,' ') as NEWSTATE"; sqltext = sqltext + " from SMDocLog LEFT JOIN SSDocStates"; sqltext = sqltext + " ON SMDocLog.DOCTYPE=SSDocStates.DOCTYPE and SMDocLog.NEWSTATE=SSDocStates.DOCSTATE"; sqltext = sqltext + " WHERE ID='" + docid + "'"; sqltext = sqltext + " ORDER BY EVENTTIME DESC"; using (OracleCommand cmd = new OracleCommand()) { cmd.Connection = conn; cmd.CommandText = sqltext; cmd.CommandType = CommandType.Text; using (OracleDataAdapter adapterO = new OracleDataAdapter(cmd)) { using (DataSet ds = new DataSet()) { adapterO.Fill(ds); //    ,        foreach (DataRow dr in ds.Tables[0].Rows) { ReportDataSM rd = new ReportDataSM(); rd.EventTime = Convert.ToDateTime(dr["EVENTTIME"]); rd.UserName = dr["USERNAME"].ToString(); rd.Doc = dr["ID"].ToString(); rd.NewState = dr["NEWSTATE"].ToString(); list4R.Add(rd); } } // end using DataSet } // end using OracleDataAdapter } // end using OracleCommand } }</span></span></code> </pre><br>  Call this method asynchronously with: <br><br><pre> <code class="cs hljs"> MyGetDataDelegate dlgt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyGetDataDelegate(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getDataMethod); IAsyncResult ar = dlgt.BeginInvoke(txtDocN.Text, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AsyncCallback(CompletedCallback), <span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre><br>  Pay attention to the CompletedCallback method, which is passed as a parameter. <br>  Its implementation is necessary in order to run some other method after the completion of our callable method.  In our case, after extracting the data, you need to bind this data to the report and update the interface. <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateUserInterface</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _reportViewer.Reset(); ReportDataSource reportDataSource= <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReportDataSource(<span class="hljs-string"><span class="hljs-string">"DataSet1"</span></span>, list4R); <span class="hljs-comment"><span class="hljs-comment">//            _reportViewer.LocalReport.ReportPath = "ReportSM.rdlc"; _reportViewer.LocalReport.DataSources.Add(reportDataSource); _reportViewer.RefreshReport(); }</span></span></code> </pre><br>  But we have a catch in that we can update the interface only from the application flow. <br>  To do this, we will call the update method of the application interface from the dispatcher thread.  That is, the contents of our CompletedCallback method will be: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CompletedCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IAsyncResult result</span></span></span><span class="hljs-function">)</span></span> { Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.Normal, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NoArgDelegate(UpdateUserInterface)); }</code> </pre><br>  Again, to call the method asynchronously, we needed a delegate, which this time does not accept any parameters.  Add it to the beginning of our code: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NoArgDelegate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>;</code> </pre><br>  It should get something like this application: <br><br><img src="https://habrastorage.org/files/eae/4dd/b30/eae4ddb30e644bcfbea117cb21a511c5.PNG"><br><br>  Update: <a href="https://github.com/programmersommer/Portable_Oracle_ReportViewer_.Net_4.0_App">link to GitHub project</a> (using Oracle.ManagedDataAccess installed from NuGet package manager) </div><p>Source: <a href="https://habr.com/ru/post/242965/">https://habr.com/ru/post/242965/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242953/index.html">How and why "break" online shopping</a></li>
<li><a href="../242955/index.html">Dino Esposito to speak at .NEXT in Moscow</a></li>
<li><a href="../242957/index.html">Arduino, Nokia 5110 LCD and Cyrillic Module</a></li>
<li><a href="../242959/index.html">10 errors that I made when starting two online stores (and how to avoid these errors)</a></li>
<li><a href="../242963/index.html">November 20 - the launch of the first strategic MMO game for ... programmers</a></li>
<li><a href="../242967/index.html">Big little things: 7 UBANK features that will make your life easier and more fun</a></li>
<li><a href="../242969/index.html">Snippet msVendor for miniShop2</a></li>
<li><a href="../242971/index.html">Future Directory Services (in the clouds) - register for a webinar</a></li>
<li><a href="../242975/index.html">How have I been pwned? scaled under high load and how much it cost (<$ 25)</a></li>
<li><a href="../242977/index.html">Another simple state machine for Unity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>