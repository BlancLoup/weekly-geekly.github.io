<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Original Antivirus Test</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this mini article, I will shed light on some features of the work of anti-virus software for signatures, and also tell you why software creators ne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Original Antivirus Test</h1><div class="post__text post__text-html js-mediator-article">  In this mini article, I will shed light on some features of the work of anti-virus software for signatures, and also tell you why software creators need to carefully consider the choice of packers if they do not want to dunk their reputation and their program. <br><br>  A couple of days ago, without planning for myself, I conducted an interesting antivirus test.  It all started with the fact that I, wandering through the lost folders of my drive, came across a couple of Trojans.  Once (back in 2004) <a href="http://www.imho.ws/showpost.php%3Fp%3D554534%26postcount%3D323">I had already conducted an antivirus test</a> .  There you can also look at the results of verification in my posts and the posts of other users.  Then I took a couple of Trojans and several programs modifying the binary (various packers and other software, the full list is at the end).  So I set about trying to see: what happened after 7 years? <a name="habracut"></a><br><br>  Unfortunately, the original test I have left.  Only parts of it.  But this was enough for the experiment and some conclusions.  Tests were conducted at <a href="http://www.virtest.com/">www.virtest.com</a> .  This should, in theory, guarantee the relevance of the results to date. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The first discovery was waiting for me when I checked the DTr trojan in its original form.  The original Trojan file is packaged by UPX.  Test result: <a href="http://www.virtest.com/log.php%3Fdir%3D372943%26id%3D00dedf3741e3467da354d89523b04dea">out of 41 antiviruses, only 2 (eTrust and AVL) could not identify it</a> .  Next, I checked the unpacked file of the same Trojan (also supplied by the developer).  This time <a href="http://www.virtest.com/log.php%3Fdir%3D372944%26id%3Deeb79a961199e72dc1805519c618d879">only 31 out of 41</a> caught him.  A reasonable question arises: why then do anti-virus labs add samples, if you can get around them in such a simple way?  For example, there are a bunch of UPX unpackers. <br><br>  Then I tested the Pinch trojan, processed by different packers and other programs of the same bearded 2004.  The result is the following (the number of antiviruses that found the virus to the total number of antiviruses): <br><ul><li>  <a href="http://www.virtest.com/log.php%3Fdir%3D374700%26id%3D124037ae53c19a6fe82be45b6cce8deb">24/41</a> </li><li>  <a href="http://www.virtest.com/log.php%3Fdir%3D374701%26id%3Da0ed4b4b498bd4355abcd63c951c8f60">29/41</a> </li><li>  <a href="http://www.virtest.com/log.php%3Fdir%3D374702%26id%3D1ccd82d22a3f952d36467733cf0e6158">26/41</a> </li><li>  <a href="http://www.virtest.com/log.php%3Fdir%3D374704%26id%3D65ff8d730e5bceeb891060a1e9ca6683">33/41</a> </li></ul><br>  After examining some of the antivirus reactions, I came to the conclusion that they were cursing more for the use of packers than for the signature of the Trojan itself.  For example, here is the entry: <br> <code>ClamWin Pinch_1.exe PUA.Packed.ASPack</code> <br>  or here: <br> <code>Webroot Pinch.exe Sus/UnkPacker</code> <br>  could not unpack and swears. <br><br>  I remembered that Pinch came with an fsg packer.  I also remembered how at one of the seminars the representative of VBA32 said that in some cases a packer is added to the database - if there is confidence that the packer is not widely spread and used to hide the virus signature.  According to the virus analyst, such packers are often written by virus writers themselves.  Well, there is some truth.  Especially if you remember what kind of distribution before it was at various "file crypto artists". <br><br>  My next experiment: take an innocuous program and try to process it with various packers.  As a ‚Äúvictim,‚Äù I chose the <a href="http://www.securitylab.ru/software/313490.php">ArpBuilder</a> program I <a href="http://www.securitylab.ru/software/313490.php">wrote</a> . <br><br>  Result: <br><ol><li>  <a href="http://www.virtest.com/log.php%3Fdir%3D374713%26id%3D1bf92262b5b5e38117b80f3ce362658f">for use PeCompact has</a> cursed ClamWin. </li><li>  24 antiviruses <a href="http://www.virtest.com/log.php%3Fdir%3D374714%26id%3Debd9dfbad555abdda6e24a1944bf8401">scolded</a> about the <a href="http://www.virtest.com/log.php%3Fdir%3D374714%26id%3Debd9dfbad555abdda6e24a1944bf8401">use of fsg</a> . </li></ol><br>  In this regard, I <b>recommend that programmers check their ‚Äúchild‚Äù after processing by packers</b> .  Otherwise, this may hurt the reputation of your software, and you will have to explain for a long time that ‚Äúa misunderstanding has occurred‚Äù.  According to my observations, using UPX does not cause such problems. <br><br>  For those who want to conduct their own similar experiments, here are the lists of used programs (some software on the sites was updated after 2004): <br><ol><li>  Avx! AVSpoffer </li><li>  <a href="http://dotfix.net/">DotFix FakeSigner</a> </li><li>  <a href="http://xtreeme.prv.pl/">fsg</a> </li><li>  <a href="http://bgcorp.narod.ru/download.htm">HidePE, StealthPE</a> </li><li>  <a href="http://bitsum.com/pecompact.php">Pecompact</a> </li><li>  pe-patcher </li></ol></div><p>Source: <a href="https://habr.com/ru/post/127942/">https://habr.com/ru/post/127942/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127934/index.html">REG.RU + Masterhost: short Q & A</a></li>
<li><a href="../127935/index.html">HelpDesk under the hood. Audit of creating user accounts in AD</a></li>
<li><a href="../127938/index.html">Get up, Russia!</a></li>
<li><a href="../127940/index.html">Writing a widget that uses the Yandex.Metrics API</a></li>
<li><a href="../127941/index.html">Some features of the development of the portal for the provision of public services to inform about the results of the Unified State Exam using DotNetNuke</a></li>
<li><a href="../127943/index.html">Natural string sorting in javascript</a></li>
<li><a href="../127945/index.html">IFA 2011: Galaxy Note, Toshiba AT200, PocketBook A10 "</a></li>
<li><a href="../127947/index.html">".Toster" announces readiness</a></li>
<li><a href="../127948/index.html">Creating and monetizing blog</a></li>
<li><a href="../127949/index.html">Windows Phone Camp - conference results</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>