<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Windows Server 2012 - life without GUI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows Server 2012 is positioned as a system that does not need a GUI for full-fledged work. When installing, the Server Server option is selected by...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Windows Server 2012 - life without GUI</h1><div class="post__text post__text-html js-mediator-article">  Windows Server 2012 is positioned as a system that does not need a GUI for full-fledged work.  When installing, the Server Server option is selected by default, the ability to remove the graphical interface without reinstalling the server is added, the list of roles that do not need a GUI is expanded compared to 2008 R2.  In his books, Microsoft claims that working with the command line is natural and recalls the beginning of the 90s of the last century, when system administrators complained about the useless waste of resources by the graphical shell.  In addition, Microsoft offers a ‚Äúnew‚Äù way to administer its server operating systems, in which it is assumed that you will only see the server console once - when installing the operating system, and all the work and configuration of the system will be done remotely: through the Server Manager , MMC-snap-ins and PowerShell, which in 2012 server is already version 3.0 <br><br>  Suppose that the initial server setup after installation includes: <br><br><ul><li>  Network Interface Setup </li><li>  Setting the time zone </li><li>  Enable Remote Desktop </li><li>  Rename computer </li><li>  Joining a domain </li></ul><br>  The question is: can these tasks be performed remotely using PowerShell?  Well, let's say, there is a remote server somewhere in the taiga, on which the local craftsman put the 2012 server, went to mark this case and lost the key to the cabinet.  The case is armor-piercing, waterproof, soundproof and generally involves protection against unauthorized access by bears.  And you need to configure.  Suppose there is a VPN or some kind of "direct wire" (I often see this service in the price lists of providers) and the server is available over the network.  And only on the network. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the source data a letter from a local craftsman: <br><br>  <i>Hi, put Venda on the server.</i>  <i>IP - 169.254.23.43.</i>  <i>Login - Administrator.</i>  <i>The password is qwe123! @ #.</i>  <i>Until.</i> <br><a name="habracut"></a><br><h4>  Getting ready </h4><br>  The remote server in the workgroup, in a freshly installed state, does not understand RPC (the ports on the firewall are closed), does not ping, with an unprovable name and Moscow time zone in Siberia.  If this were 2008 R2, our adventures would end there, since all remote controls in it are disabled by default.  In 2012, there is a way to remotely control out of the box ‚Äî <abbr title="Windows remote management">WinRM</abbr> enabled by default, an implementation of the Microsoft <abbr title="Web Services Management">WS-MAN</abbr> standard.  On the one hand, it seems to be a security hole, on the other hand, in a normally designed network in which the servers are located in a separate VLAN, access to which is restricted to trusted users, the probability of using this hole is negligible.  But still there. <br><br>  To manage a remote server in a workgroup using WinRM, we must trust the remote server.  Here the logic is a little incomprehensible to me.  The idea is that the remote server should trust us, we manage it, and not us.  Perhaps this is from an incomplete understanding of how WS-MAN works.  But in any case, tell WinRM that we trust the remote server needs.  This is implemented by entering the name or IP address of the remote server in the list of "trusted hosts" (TrustedHosts) <br><br><pre><code class="cs hljs">si WSMan:\localhost\Client\TrustedHosts <span class="hljs-number"><span class="hljs-number">169.254</span></span><span class="hljs-number"><span class="hljs-number">.23</span></span><span class="hljs-number"><span class="hljs-number">.43</span></span></code> </pre> <br>  Now somehow you need to perform the initial configuration of the remote server.  I know 2 cmdlets that can help with this task: <a href="http://technet.microsoft.com/en-us/library/hh849707.aspx">Enter-Pssession</a> and <a href="http://technet.microsoft.com/en-us/library/hh849719.aspx">Invoke-Command</a> .  Both use WinRM.  Enter-Pssession gives us the console of a remote server, Invoke-Command sends a block of commands to a remote server and returns the result of their execution.  Below, Invoke-Command is used (we are not going to see the remote console at all). <br><br>  Actions will be performed on the following principle: <br><br><ol><li>  Powershell </li><li>  If you can't complete the task via PowerShell, connect cmd </li><li>  If not in PowerShell, not in cmd there are no suitable tools - WMI via PowerShell </li><li>  Well, as the last option - picking the registry also via PowerShell </li></ol><br><h4>  Network Interface Setup </h4><br>  There is nothing to do, we change our address to something from the APIPA-range, for example, well, 169.254.0.1 and sit down to think how to remotely change the IP address of the taiga server.  There is nothing to think about: <br><br><ol><li>  Determine on which adapter to make changes </li><li>  Disable DHCP </li><li>  Assign a static address for the server with a subnet mask and default gateway. </li><li>  Assign DNS servers </li></ol><br>  And all this is desirable without uncoupling from the server. <br><br>  In PowerShell 3.0, there is a whole group of <a href="http://technet.microsoft.com/en-us/library/jj134956(v%3Dwps.620).aspx">Network Adapter Cmdlets</a> , which allows us to do anything with network adapters. <br><br>  Obtain the network adapter object and save it in the $ adapter variable.  Ethernet is the new name for ‚ÄúLocal Area Connection‚Äù.  This change, despite the seeming insignificance, is very pleasing. <br><br><pre> <code class="cs hljs">$adapter = Get-NetAdapter Ethernet</code> </pre><br>  Disable DHCP <br><br><pre> <code class="cs hljs">$adapter | Set-NetAdapter ‚ÄìDhcp disabled</code> </pre><br>  Change the IP address to normal with the necessary mask and gateway.  For this there is another group <a href="http://technet.microsoft.com/en-us/library/hh826123(v%3Dwps.620).aspx">Net TCP / IP Cmdlets</a> <br><br><pre> <code class="cs hljs">$adapter | New-NetIPAddress <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> ‚ÄìPrefixLength <span class="hljs-number"><span class="hljs-number">24</span></span> ‚ÄìDefaultGateway <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span></code> </pre><br>  Add DNS servers.  Third group <a href="http://technet.microsoft.com/en-us/library/jj590772(v%3Dwps.620).aspx">DNS Client Cmdlets</a> <br><br><pre> <code class="cs hljs">Set-DnsClientServerAddress Ethernet ‚Äìaddresses (‚Äú<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>‚Äù,‚Äù<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>‚Äù)</code> </pre><br>  How to do all this on a remote server?  Make a script and use Invoke-Command to run it. <br><br>  Let's save this command set somewhere with the name of the script, for example, remotechangeip. <br><br><div class="spoiler">  <b class="spoiler_title">There is one moment.</b>  <b class="spoiler_title">The script execution policy is called.</b> <div class="spoiler_text">  By default, PowerShell is allowed to work only in interactive mode, the execution of any scripts is prohibited (restricted).  To execute the scripts, we need either remotesigned (a digital signature is required for scripts downloaded from the Internet), or unrestricted (when executing an unsigned script downloaded from the Internet, a warning about the unreliability of the source will be issued).  If you completely put on safety, you can put a bypass (everything will be done without any extra questions).  If you have your own certificate issued by a trusted publisher, and you are not lazy to sign your scripts with it - you need allsigned (in this case, you probably know it yourself).  I do not have a certificate, so I install the remotesigned policy. <br><br><pre> <code class="cs hljs">Set-ExecutionPolicy remotesigned</code> </pre><br>  The script execution policy is installed on the local computer; there is no such need on the remote one, because Invoke-Command converts the script file into just a set of commands before executing the script on the remote computer.  Accordingly, a script (a file with the .ps1 extension) is executed on the remote computer, but a set of commands with which the execution policy of scripts is on the drum. </div></div><br>  We send our script to a remote server. <br><br><pre> <code class="cs hljs">Invoke-Command <span class="hljs-number"><span class="hljs-number">169.254</span></span><span class="hljs-number"><span class="hljs-number">.23</span></span><span class="hljs-number"><span class="hljs-number">.43</span></span> C:\scripts\remotechangeip.ps1 ‚ÄìCredential </code> </pre><br>  We have the password for the Administrator account in the letter.  After execution, we get a server with a static address 192.168.0.5 with a subnet mask / 24, a default gateway 192.168.0.1, and DNS servers 192.168.0.2 and 192.168.0.3 <br><br>  You also need to remember to change the IP in TrustedHosts, otherwise our remote administration will end there. <br><br><pre> <code class="cs hljs">$newvalue = ((ls WSMan:\localhost\Client\TrustedHosts).<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).replace(<span class="hljs-string"><span class="hljs-string">"169.254.23.43"</span></span>,<span class="hljs-string"><span class="hljs-string">"192.168.0.5"</span></span>) si WSMan:\localhost\Client\TrustedHosts $newvalue</code> </pre><br><h4>  Change time zone </h4><br>  I tried to solve this problem for a very long time using PowerShell.  I found a <a href="http://gallery.technet.microsoft.com/scriptcenter/Set-TimeZone-function-b5ed93b5">function that changes the time zone locally.</a>  But if we try to execute this function through Invoke-Command, we will get a rake across the forehead in the form "The name Set-Timezone is not recognized as the name of a cmdlet, function, script file or program being executed." <br><br>  Invoke-Command, when executed naturally, does not copy from the local machine, but executes cmdlets that are available on the remote server.  This is understandable and logical.  The task was clear - before performing Invoke-Command, you need to reset the function to a remote server.  But ... then I was too lazy. <br><br>  If you look into the function code, it becomes clear that it only checks the OS version and, depending on it, either performs timedate.cpl (XP and lower) or tzutil (Vista and higher).  There is no need to check the OS version, we know it.  So just change the time zone with tzutil <br><br><pre> <code class="cs hljs">Invoke-Command <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> {tzutil /s ‚ÄúNorth Asia Standard Time‚Äù} ‚ÄìCredential </code> </pre><br><div class="spoiler">  <b class="spoiler_title">WMI</b> <div class="spoiler_text">  You can try to set the time zone using WMI.  It will look like this: <br><br><pre> <code class="cs hljs">$strComputer = <span class="hljs-string"><span class="hljs-string">"."</span></span> $objWMI = gwmi win32_computersystem<span class="hljs-string"><span class="hljs-string">" -computername $strComputer $objWMI.CurrentTimeZone = 207 $objWMI.Put()</span></span></code> </pre><br>  What's going on here?  The dot (.) Says that we are working with a local computer.  We <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa394102(v%3Dvs.85).aspx">turn</a> on the local computer to the class <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa394102(v%3Dvs.85).aspx">win32_computersystem</a> .  Set the CurrentTimeZone property to 207, corresponding to ‚ÄúNorth Asia Standard Time‚Äù.  And the Put method saves the time zone change. <br><br>  Also save and transfer the script to the remote computer using Invoke-Command.  In my opinion, tzutil is easier to use. </div></div><br>  Values ‚Äã‚Äãof time zones can be taken <a href="http://msdn.microsoft.com/en-us/library/ms912391(v%3Dwinembedded.11).aspx">from here</a> or from the output tzutil / l <br>  Well, without PowerShell still not done. <br><br><h4>  Enable Remote Desktop </h4><br>  In PowerShell 3.0, many cmdlets have appeared to work with RDS.  Their group is called <a href="http://technet.microsoft.com/library/jj215451.aspx">Remote Desktop Cmdlets.</a>  But, as I understand it, they are designed to work with an RDS server, you simply cannot enable the remote desktop for the administrator with their help. <br><br>  There are two ways to turn on the desktop.  Through WMI calls and <s>incorrect</s> through registry modification.  I never liked modifying the registry.  One awkward finger movement and no one guarantees that the server will rise after a reboot. <br><br>  As for the inclusion of a remote desktop, <a href="http://technet.microsoft.com/ru-ru/library/cc722151(v%3Dws.10).aspx">modifying the HKLM \ SYSTEM \ CurrentControlSet \ Control \ Terminal Server \ fDenyTSConnections key</a> , which needs to be set to 0 to allow the remote desktop: <s>first, it requires a reboot, second</s> , it does not add an exception to remote desktop in firewall rules. <br><br>  Therefore, I will use the WMI class <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa383640(v%3Dvs.85).aspx">win32_terminalservicesetting</a> and its <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa383644(v%3Dvs.85).aspx">setallowtsconnections</a> method, which will allow you to do without rebooting and add exception rules in the firewall with one command. <br><br><pre> <code class="cs hljs">Invoke-Command <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> {(gwmi win32_terminalservicesetting -<span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">root</span></span>\<span class="hljs-title"><span class="hljs-title">cimv2</span></span>\<span class="hljs-title"><span class="hljs-title">terminalservices</span></span>).<span class="hljs-title"><span class="hljs-title">setallowtsconnections</span></span>(1,1)} ‚Äì<span class="hljs-title"><span class="hljs-title">Credential</span></span> </code> </pre><br>  Now we have access to the taiga server via RDP!  Can you rejoice?  Imagine that the only channel of communication with the outside world is at the remote server via satellite with extortionate tariffs, dial-up speed, through-the-top ping and continue to configure the server remotely via PowerShell. <br><br><h4>  Rename the server and join it to the domain </h4><br>  All the more, that remained quite a bit. <br><br>  In theory, the <a href="http://technet.microsoft.com/en-us/library/hh849798.aspx">Add-Computer</a> cmdlet allows you to rename a computer when it joins a domain.  But in practice, I was faced with the fact that when joining a domain and simultaneously renaming it using this command, the computer enters the domain under its old name.  And it raced - to bring the computer out of the domain, reboot, delete the account in AD, start replication if there are several controllers, wait, rename the computer, reboot, enter into the domain, reboot. <br><br>  Therefore, I prefer to rename the computer and enter the domain separately. <br><br>  Rename <br><br><pre> <code class="cs hljs">Invoke-Command <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> {rename-computer taiga -restart} -credential </code> </pre><br>  As soon as the control is returned to us, the remote server is rebooted.  You can check the result of the command (and server readiness) like this: <br><br><pre> <code class="cs hljs">Invoke-Command <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> {$env:computername} -credential </code> </pre><br>  And finally entering the domain <br><br><pre> <code class="cs hljs">Invoke-ommand <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>-computer contoso.com -credential contoso.com\domainadmin -restart} -credential </code> </pre><br><h4>  We finish </h4><br>  All tasks set at the beginning are completed.  Now you can think about how to continue to live and where to find this damn key to the cabinet. <br><br>  And finally, a small cheat sheet on CMD and PowerShell. <br><table><tbody><tr><td></td><td>  Cmd </td><td>  Powershell </td></tr><tr><td>  Change network settings </td><td><pre> <code class="cs hljs">netsh <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ip</span></span> <span class="hljs-title"><span class="hljs-title">set</span></span> <span class="hljs-title"><span class="hljs-title">address</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span> = ‚ÄúEthernet‚Äù <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> <span class="hljs-number"><span class="hljs-number">255.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> netsh <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ip</span></span> <span class="hljs-title"><span class="hljs-title">set</span></span> <span class="hljs-title"><span class="hljs-title">dns</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span> = ‚ÄúEthernet‚Äù <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> netsh <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ip</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">dns</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span> = ‚ÄúEthernet‚Äù <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span></code> </pre></td><td><pre> <code class="cs hljs">$adapter = Get-NetAdapter Ethernet $adapter | Set-NetAdapter ‚ÄìDhcp disabled $adapter | New-NetIPAddress <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> ‚ÄìPrefixLength <span class="hljs-number"><span class="hljs-number">24</span></span> ‚ÄìDefaultGateway <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> Set-DnsClientServerAddress Ethernet ‚Äìaddresses (‚Äú<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>‚Äù,‚Äù<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>‚Äù)</code> </pre></td></tr><tr><td>  Change time zone </td><td><pre> <code class="cs hljs">tzutil /s ‚ÄúNorth Asia Standard Time‚Äù</code> </pre></td><td><pre> <code class="cs hljs">$strComputer = <span class="hljs-string"><span class="hljs-string">"."</span></span> $objWMI = gwmi win32_computersystem<span class="hljs-string"><span class="hljs-string">" -computername $strComputer $objWMI.CurrentTimeZone = 207 $objWMI.Put()</span></span></code> </pre></td></tr><tr><td>  Enable Remote Desktop </td><td><pre> <code class="cs hljs">reg <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-string"><span class="hljs-string">"HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server"</span></span> /v fDenyTSConnections /t REG_DWORD /d <span class="hljs-number"><span class="hljs-number">0</span></span> netsh advfirewall firewall <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> rule <span class="hljs-keyword"><span class="hljs-keyword">group</span></span>=<span class="hljs-string"><span class="hljs-string">"remote desktop"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> enable=Yes</code> </pre></td><td><pre> <code class="cs hljs">(gwmi win32_terminalservicesetting -<span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">root</span></span>\<span class="hljs-title"><span class="hljs-title">cimv2</span></span>\<span class="hljs-title"><span class="hljs-title">terminalservices</span></span>).<span class="hljs-title"><span class="hljs-title">setallowtsconnections</span></span>(1,1)</code> </pre></td></tr><tr><td>  Rename server </td><td><pre> <code class="cs hljs">netdom renamecomputer %computername% /newname:taiga /reboot</code> </pre></td><td><pre> <code class="cs hljs">rename-computer taiga ‚Äìrestart</code> </pre></td></tr><tr><td>  Join Domain </td><td><pre> <code class="cs hljs">netdom <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> taiga /d:contoso.com /ud:contoso.com\domainadmin /pd:* /reboot</code> </pre></td><td><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">add</span></span>-computer contoso.com -credential contoso.com\domainadmin -restart</code> </pre></td></tr></tbody></table><br>  One thing unites them: they all need RPC for remote work, which by default is closed by a firewall.  Therefore, the only way to deliver them to a remote computer is WinRM. <br><br>  And Enter-Pssession did not work for me :) <br><br>  Used material from: <br>  <a href="http://msdn.microsoft.com/ru-ru/ms348103.aspx">MSDN</a> <br>  <a href="http://technet.microsoft.com/">Technet</a> </div><p>Source: <a href="https://habr.com/ru/post/183012/">https://habr.com/ru/post/183012/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../182998/index.html">Spatial hashing for the smallest</a></li>
<li><a href="../183004/index.html">XQuery enhancements in MarkLogic Server</a></li>
<li><a href="../183006/index.html">Electricity Lessons - Transmission Lines</a></li>
<li><a href="../183008/index.html">Deferred objects in AngularJS</a></li>
<li><a href="../183010/index.html">PHPUnit: a simple syntax for creating mock objects</a></li>
<li><a href="../183016/index.html">External impact on the web client 1C: Enterprise</a></li>
<li><a href="../183018/index.html">Web Design + Mac OS - Adobe = Sketch. The new tool is better than all the old</a></li>
<li><a href="../183022/index.html">Random'ization in Python. Is it random?</a></li>
<li><a href="../183024/index.html">Numbers in itself</a></li>
<li><a href="../183028/index.html">How to quickly make a cyborg cockroach</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>