<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Uploading sketches to Arduino via Bluetooth</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When programming the Arduino, it is sometimes desirable to do without a physical connection via USB to a computer, for example: 



- Power circuits -...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Uploading sketches to Arduino via Bluetooth</h1><div class="post__text post__text-html js-mediator-article">  When programming the Arduino, it is sometimes desirable to do without a physical connection via USB to a computer, for example: <br><br><ul><li>  Power circuits - switching 220V.  One connection error and good-bye to the USB controller of your favorite system unit. </li><li>  Radio frequency circuits - a lot of pickups on food. </li><li>  Assembled and somewhere fixed devices that it is desirable to reflash, but it is inconvenient to crawl to them. </li></ul><br>  On the Internet you can find several publications on this topic, but all of them are fragmentary and there is no completely ready solution.  Also, despite the simplicity and obviousness of the design, there are several small difficulties that are ready to thwart the whole event.  About how to overcome them, I want to talk in this article. <br><br><img src="https://habrastorage.org/files/efe/d6b/07b/efed6b07ba464f04969a88781a5c1d78.jpg" alt="The Arduino board is connected to a Bluetooth module for wireless upload."><br><a name="habracut"></a><br>  I used the cheapest Bluetooth-modules with the straightforward name "Bluetooth-module HC-05 (HC-06)".  On ebay they can be found from 200 rubles.  apiece, in domestic stores - from 500 rubles.  I advise you to take the module already soldered on the adapter "for the Arduino", the difference in money is minimal, and saves time on assembling the interface circuit. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/890/ee3/445/890ee3445a1542f5a6ad26927e60e1f6.jpg" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">And if you got a module without an adapter card?</b> <div class="spoiler_text">  In this case, you will have to assemble the adapter circuit yourself.  The instruction is <a href="http://letsmakerobots.com/content/programming-arduino-bluetooth">here.</a> </div></div><br><br>  We need HC-05, but since it is extremely difficult to visually distinguish them, there is a great chance that HC-06 will be in the hands, even if the package says ‚ÄúHC-05‚Äù, as it happened to me: <br><br><img src="https://habrastorage.org/files/14c/fbc/b71/14cfbcb718804f1ead972cee7fbcb48e.jpg" alt="image"><br><br><div class="spoiler">  <b class="spoiler_title">Is it possible to distinguish HC-05 from HC-06?</b> <div class="spoiler_text">  You can try to distinguish in appearance, if not all the legs of the Bluetooth module are sealed or have a multimeter at hand.  In HC-05 to the LED, unsoldered on the module itself, there is a conductor from leg 31, and in NS-06 from leg 24. <br><br><img src="https://habrastorage.org/files/8df/9eb/c22/8df9ebc2228542b0963419a6da2a2d00.jpg" alt="image"><br><br>  The photo shows that the only 24th leg is soldered on the whole row, it is one hundred percent module HC-06. <br></div></div><br><br>  Fortunately, HC-06 can be reflashed in HC-05, but you will have to find a computer with an LPT port and spend a few hours.  Instructions for flashing can be read <a href="http://bsvi.ru/pereproshivka-hc-06-v-hc-05/">here</a> .  From myself I want to add that the firmware did not take place under Windows7, I had to install Windows XP, and also in the BIOS, change the LPT port mode to EPP 1.7. <br><br><div class="spoiler">  <b class="spoiler_title">Detailed LPT port settings</b> <div class="spoiler_text">  The switching of LPT-port modes and settings in the Device Manager was especially tiring, so I‚Äôll immediately give you the correct screenshots.  BIOS: <br><img src="https://habrastorage.org/files/75e/a75/c25/75ea75c256b34d978d78f5260c34cf08.jpg" alt="image"><br><br>  In dispatcher: <br><img src="https://habrastorage.org/files/ffe/4d3/b37/ffe4d3b37ed34a498b112c35f8ada0c7.jpg" alt="image"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Why reflash?</b> <div class="spoiler_text">  The HC-05 firmware, unlike the HC-06, when connecting, changes the signal at the 32 pin - this is necessary in order to hard reset the programmable Arduino and start the fill process.  You can not reflash, and press the RESET button on the board every time before pouring, and you need to catch the right moment, which is extremely inconvenient.  It looks like <a href="http://www.youtube.com/watch%3Fv%3Di-69D0iDVxE">this</a> </div></div><br><br>  So, we have on hand the module HC-05.  Now you need to set the parameters of work.  To switch to the parameter setting mode, you need to solder the last, 34th leg to the power supply 3.3v. <br><br><img src="https://habrastorage.org/files/e2e/f70/b8e/e2ef70b8e7ba4ad2bf0951d7e0ff88f5.jpg" alt="image"><br><br>  Then we connect to the computer via any USB-UART-TTL adapter and in the terminal we give the following sequence of commands: <br><br>  <b>AT</b> <b><br></b>  <b>AT + RESET</b> <b><br></b>  <b>AT + ORGL</b> <b><br></b>  <b>AT + ROLE = 0</b> <b><br></b>  <b>AT + POLAR = 1.0</b> <b><br></b>  <b>AT + UART = 57600,0,0</b> <b><br></b>  <b>AT + INIT</b> <b><br></b>  <b>AT + INQ</b> <b><br></b> <br>  If you want to change the standard password for pairing, then in addition: <br>  <b>AT + PSWD = 5678</b> <b><br></b> <br>  If you want to change the name of the device, then in addition: <br>  <b>AT + NAME = RemoteArduino</b> <b><br></b> <br>  After that, the module is turned off, the jumper with 34 legs is removed and proceed to the final refinement of the module.  This can be done directly on the HC-05 board, but it seemed to me more convenient to do this in the form of an adapter card for direct connection to the Mini Pro. <br><br><img src="https://habrastorage.org/files/c78/ee9/f3a/c78ee9f3a518401da5c84c74f00fb433.jpg" alt="image"><br><br>  To automatically reset the Arduino when a connection is established, you need to bring the 32nd foot to the connector, for this I cut off the WAKE-UP output that was unnecessary for me and labeled it as RESET.  The adapter scheme is as follows: <br><br><img src="https://habrastorage.org/files/4cb/0a9/656/4cb0a9656a444e7bbd563666e3a4e207.jpg" alt="image"><br><br>  The LED will show an established connection. <br><br>  On this with soldering everything, but pouring still does not work.  The fact is that the Arduino IDE at each attempt to fill the sketch clears the COM port buffers, which causes the BlueTooth connection to be closed and the download canceled. <br><br>  To avoid this, you need to fix the configuration of the Arduino IDE, which is located in the file <b>C: \ arduino \ hardware \ arduino \ boards.txt</b> .  We open this file in a text editor, look for the section corresponding to the board with which we work (I have this Pro Mini 5V) and add the following line: <br><br>  <b>pro5v328.upload.disable_flushing = true</b> <br><br>  Do not forget to change the first word in the string, for example, for Arduino Uno it will be: <br><br>  <b>uno.upload.disable_flushing = true</b> <br><br>  Now pouring should earn.  A small annoying detail remains - when we go into the Arduino IDE menu and select the ‚ÄúTools‚Äù item, the program ‚Äúfreezes‚Äù for a few seconds.  The fact is that with each access to this menu item, the program goes through all the available COM ports in the system, but in a non-optimal way, which leads to large delays.  To remove this delay, you need to replace the rxtxSerial.dll library with a modified version, which can be found <a href="">here</a> .  Who are interested in the details of the problem, may familiarize themselves with <a href="http://forum.arduino.cc/index.php/topic,46977.0.html">the thread on the forum Arduino</a> . <br><br>  Here is another option with the Arduino TX Power and TX button: <br><br><img src="https://habrastorage.org/files/328/ecb/c35/328ecbc3548441508d6a98c2fc84c981.jpg" alt="image"><br><br>  The scheme of the second option (the Bluetooth module is different, so the pins are located differently and the Pro Mini is not original, but ‚ÄúDeek-Robot‚Äù, the pinout is mirrored): <br><br><img src="https://habrastorage.org/files/6e5/11b/b0e/6e511bb0e32741e3a7271e6a93d35d1c.jpg" alt="image"><br><br>  The circuit takes up minimal space, connects quickly, does not require configuration.  It also remains possible to enable the Arduino IDE to enable Serial Monitor and receive data from the device as if connected via USB. <br><br>  PS <br>  It turned out that there <a href="http://www.adafruit.com/products/1588">are ready-made such converted modules</a> , and maybe someday we will see them on sale in our country. </div><p>Source: <a href="https://habr.com/ru/post/235727/">https://habr.com/ru/post/235727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235717/index.html">How we fought the brakes in AndEngine</a></li>
<li><a href="../235719/index.html">Battle Arsenal of Erlang Developer</a></li>
<li><a href="../235721/index.html">Biological sensory surfaces as a new step in the evolution of gadgets</a></li>
<li><a href="../235723/index.html">Creating plug-ins for AutoCAD using the .NET API (part 1 - first steps)</a></li>
<li><a href="../235725/index.html">OOBD without OOP</a></li>
<li><a href="../235729/index.html">Realistic gravity lensing on Unity</a></li>
<li><a href="../235731/index.html">Ideal development environment for PIC - personal experience</a></li>
<li><a href="../235735/index.html">3D mode in Diablo 2</a></li>
<li><a href="../235739/index.html">Recycling Gadgets</a></li>
<li><a href="../235741/index.html">Writing a lossless audio player in JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>