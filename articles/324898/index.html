<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tensorflow deep learning library</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Habr! The series of articles on learning tools for neural networks continues with an overview of the popular Tensorflow framework. 


 Tensorfl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tensorflow deep learning library</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/063/6d1/1af/0636d11afa654531b08986cc3ff1b4ca.png" align="right">  Hello, Habr!  The series of articles on learning tools for neural networks continues with an overview of the popular Tensorflow framework. </p><br><p>  Tensorflow (hereinafter referred to as TF) is a rather young framework for deep machine learning developed by Google Brain.  For a long time, the framework was developed in a closed mode under the name DistBelief, but after a global refactoring on November 9, 2015 it was released in open source.  In a year with a little TF, it grew to version 1.0, gained integration with keras, became much faster and received support for mobile platforms.  Recently, the framework has also been developing towards classical methods, and in some parts of the interface it is already somewhat reminiscent of scikit-learn.  Prior to the current version, the interface changed actively and often, but the developers promised to freeze changes to the API.  We will consider only the Python API, although this is not the only option - there are also interfaces for C ++ and mobile platforms. </p><br><a name="habracut"></a><br><h2 id="ustanovka">  Installation </h2><br><p>  TF is installed as standard via python pip.  There is a nuance: there are separate installation algorithms for operation on the CPU and on the video cards. </p><br><p>  In the case of the CPU, everything is simple: you need to put a pip package called tensorflow. </p><br><p>  In the second case, you need: </p><br><ol><li>  check compatibility with video card.  The CUDA Compute Capability parameter should be greater than 3.0, you can find it for your video card <a href="https://developer.nvidia.com/cuda-gpus">here.</a> </li><li>  Install <a href="https://developer.nvidia.com/cuda-downloads">CUDA Toolkit</a> Eighth Version </li><li>  Install <a href="https://developer.nvidia.com/cudnn">cuDNN</a> version 5.1 </li><li>  Install tensorflow-gpu package from pip </li></ol><br><p>  However, the documentation claims that earlier versions of CUDA Toolkit and cuDNN are supported, but recommends installing the versions mentioned above. </p><br><p>  Developers recommend installing TF in a separate environment with virtualenv to avoid possible problems with versioning and dependencies. </p><br><p>  Another installation option is Docker.  By default, only the CPU version will work from the container, but if you use the special <a href="https://github.com/NVIDIA/nvidia-docker">nvidia docker</a> , then you can use the GPU. </p><br><p>  I did not try it myself, but they say that TF even works with Windows.  Installation is carried out through the same pip and, they say, works without problems. </p><br><p>  I skip the build process from source, but this option may make sense.  The fact is that the package from the repository is assembled without the support of SSE and other buns.  In the latest versions, TF checks for the presence of such buns and reports that it will run faster from the sources. </p><br><p>  The installation process is described in detail <a href="https://www.tensorflow.org/install/">here</a> . </p><br><h2 id="dokumentaciya">  Documentation </h2><br><p>  There is a lot of documentation and examples. </p><br><ul><li>  <a href="https://www.tensorflow.org/">Official site</a> </li><li>  <a href="https://www.tensorflow.org/get_started/get_started">Official Tutorials</a> </li><li>  <a href="https://github.com/jtoy/awesome-tensorflow">Awesome-list - a selection of all the best on the topic</a> </li><li>  <a href="https://github.com/tensorflow/models/">Excellent collection of different models on TF</a> </li></ul><br><p>  The best way to focus on official documentation is that due to the rapid development and frequent changes of api, there are a lot of tutorials and scripts on the Internet that target the old versions (well, like the old ... half a year ago) with the old API, they will not work with the latest versions of the framework . </p><br><h2 id="bazovye-elementy-tf">  Basic TF Elements </h2><br><p>  With the help of "Hello, world" we will make sure that everything was established correctly: </p><br><pre><code class="hljs haskell"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf #  TF hello = tf.constant('<span class="hljs-type"><span class="hljs-type">Hello</span></span>, <span class="hljs-type"><span class="hljs-type">TensorFlow</span></span>!') #    TF sess = tf.InteractiveSession() #   print(<span class="hljs-title"><span class="hljs-title">sess</span></span>.<span class="hljs-title"><span class="hljs-title">run</span></span>(<span class="hljs-title"><span class="hljs-title">hello</span></span>)) # ""  &gt;&gt;&gt; b'Hello, TensorFlow!'</code> </pre> <br><p>  The first line we connect TF.  The rule has already been established to introduce a corresponding abbreviation for the framework.  This same piece of code is found in the documentation and allows you to make sure that everything was installed correctly. </p><br><h3 id="graf-vychisleniy">  Computation graph </h3><br><p>  Work with TF is built around building and executing a graph of calculations.  The computation graph is a construct that describes how calculations will be performed.  In classical imperative programming, we write code that is executed line by line.  In TF, the usual imperative approach to programming is needed only for some auxiliary purposes.  The basis of TF is the creation of a structure defining the order of calculations.  Programs are naturally structured into two parts - the compilation of a graph of calculations and the execution of calculations in the structures created. </p><br><p>  The computation graph in TF does not differ in meaning from that in Theano.  In the <a href="https://habrahabr.ru/company/ods/blog/323272/">previous article of the</a> cycle an excellent description of this entity is given. </p><br><p>  A TF graph consists of placeholders, variables, and operations.  From these elements it is possible to collect a graph in which the tensors will be calculated.  Tensors are multidimensional arrays; they serve as a ‚Äúfuel‚Äù for a graph.  A tensor can be either a single number, a feature vector from the problem being solved or an image, or a whole batch of object descriptions or an array of images.  Instead of a single object, we can transfer to the graph an array of objects and an array of answers will be computed for it.  TF work with tensors is similar to how it processes numpy arrays, in functions of which you can specify the axis of the array relative to which the calculation will be performed. </p><br><h3 id="sessii">  Sessions </h3><br><p>  Computing graphs are performed in sessions.  The session object ( <code>tf.Session</code> ) hides in itself the execution context of the graph - the necessary resources, auxiliary classes, address spaces. <br>  There are two types of sessions - regular, which are implemented in <a href="https://www.tensorflow.org/api_docs/python/tf/Session">tf.Session</a> and interactive ( <a href="https://www.tensorflow.org/api_docs/python/tf/InteractiveSession">tf.InteractiveSession</a> ).  The difference between them is that an interactive session is more suitable for execution in the console and immediately defines itself as a default session.  The main effect is that the session object does not need to be passed to the calculation function as a parameter.  In the examples below, I will assume that the interactive session is currently running, which we announced in the first example, and when I need to refer to the session, I will refer to the <code>sess</code> object. </p><br><p>  Further, in the post, standard TF images with graph images will appear, generated by a built-in utility called Tensorboard.  The designations there are: </p><br><table><tbody><tr><th>  Variable </th><th>  Operation </th><th>  Auxiliary result </th></tr><tr><td>  The graph node usually contains data. </td><td>  Does something with variables.  This also includes placeholders who make the substitution of values ‚Äã‚Äãin the graph. </td><td>  Any caching and side calculations of the type of gradients, usually refer to a separate part of the graph. </td></tr><tr><td><img src="https://habrastorage.org/files/720/db6/88e/720db688e60042b59a8d68204421c401.png"><br></td><td><img src="https://habrastorage.org/files/191/4b2/a19/1914b2a19b6d431d889ecbe96c66d891.png"><br></td><td><img src="https://habrastorage.org/files/145/d34/cb7/145d34cb71d242759b0afaa4e10772b7.png"><br></td></tr></tbody></table><br><h3 id="tenzory-operacii-i-peremennye">  Tensors, operations and variables </h3><br><p>  For example, create a tensor filled with zeros. </p><br><pre> <code class="python hljs">zeros_tensor = tf.zeros([<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>])</code> </pre> <br><p>  In general, the API in TF will largely resemble numpy and <code>tf.zeros()</code> ‚Äî far from the only function that has a direct analogue in numpy.  To see the value of the tensor, it must be executed.  In more detail about performance of the graph slightly below, so far we will manage that we will display the value of the tensor and the tensor itself. </p><br><pre> <code class="python hljs">print(zeros_tensor.eval()) print(zeros_tensor) &gt;&gt;&gt; [[ <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>] [ <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>] [ <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>]] &gt;&gt;&gt; Tensor(<span class="hljs-string"><span class="hljs-string">"zeros_1:0"</span></span>, shape=(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), dtype=float32)</code> </pre> <br><p>  The difference between the lines is that the tensor is calculated in the first line, and in the second line we just print the object representation. </p><br><p>  The tensor description shows us several important things: </p><br><ol><li>  The tensors have names.  At our zeros it: 0 </li><li>  There is a notion of the form of a tensor, it looks like the dimension of an array of numpy. </li><li>  The tensors are typed and the types for them are set from the library. </li></ol><br><p>  Above tensors, you can perform a variety of operations: </p><br><pre> <code class="python hljs">a = tf.truncated_normal([<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>]) b = tf.fill([<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-number"><span class="hljs-number">0.5</span></span>) print(sess.run(a + b)) print(sess.run(a - b)) print(sess.run(a * b)) print(sess.run(tf.matmul(a, b))) &gt;&gt;&gt; [[<span class="hljs-number"><span class="hljs-number">-1.12130964</span></span> <span class="hljs-number"><span class="hljs-number">-1.02217746</span></span>] [ <span class="hljs-number"><span class="hljs-number">0.85684788</span></span> <span class="hljs-number"><span class="hljs-number">0.5425666</span></span> ]] &gt;&gt;&gt; [[ <span class="hljs-number"><span class="hljs-number">0.35249496</span></span> <span class="hljs-number"><span class="hljs-number">0.96118248</span></span>] [<span class="hljs-number"><span class="hljs-number">-1.55395389</span></span> <span class="hljs-number"><span class="hljs-number">-1.18111515</span></span>]] &gt;&gt;&gt; [[<span class="hljs-number"><span class="hljs-number">-0.06559008</span></span> <span class="hljs-number"><span class="hljs-number">-0.11100233</span></span>] [ <span class="hljs-number"><span class="hljs-number">0.51474923</span></span> <span class="hljs-number"><span class="hljs-number">-0.27813852</span></span>]] &gt;&gt;&gt; [[<span class="hljs-number"><span class="hljs-number">-0.16202734</span></span> <span class="hljs-number"><span class="hljs-number">-0.16202734</span></span>] [<span class="hljs-number"><span class="hljs-number">-0.8864761</span></span> <span class="hljs-number"><span class="hljs-number">-0.8864761</span></span> ]]</code> </pre> <br><p>  In the example above, we use the <code>sess.run</code> construct ‚Äî this is the method for executing graph operations in a session.  In the first line, I created a tensor from a truncated normal distribution.  It uses the standard generation of the normal distribution, but it excludes everything that falls outside the limits of two standard deviations.  In addition to this generator, there is a uniform, simple normal, gamma, and several other distributions.  A very characteristic thing for TF - most of the popular options for performing an operation have already been implemented and, perhaps, before inventing a bicycle, you should look at the documentation.  The second tensor is a multidimensional 2x2 array filled with a value of 0.5 and this is something similar to numpy and its functions of creating multidimensional arrays. </p><br><p>  Now let's create a variable based on the tensor: </p><br><pre> <code class="python hljs">v = tf.Variable(zeros_tensor)</code> </pre> <br><p>  The variable participates in the calculations as a node of the computational graph, saves the state, and it needs some initialization.  So, if in the next example we do without the first line, then TF will throw an exception. </p><br><pre> <code class="python hljs">sess.run(v.initializer) v.eval() &gt;&gt;&gt; array([[ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>], [ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>], [ <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>, <span class="hljs-number"><span class="hljs-number">0.</span></span>]], dtype=float32)</code> </pre> <br><p>  Operations on variables create a computational graph, which can then be performed.  There are also placeholders - objects that parameterize the graph and mark places for the substitution of external values.  As written in the official documentation, a placeholder is a promise to substitute value later.  Create a placeholder and assign it a data type and size: </p><br><pre> <code class="python hljs">x = tf.placeholder(tf.float32, shape=(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>))</code> </pre> <br><p>  Another such use example.  Here, two placeholders serve as input nodes for the adder: </p><br><pre> <code class="python hljs">a = tf.placeholder(<span class="hljs-string"><span class="hljs-string">"float"</span></span>) b = tf.placeholder(<span class="hljs-string"><span class="hljs-string">"float"</span></span>) y = tf.multiply(a, b) print(sess.run(y, feed_dict={a:<span class="hljs-number"><span class="hljs-number">100</span></span>, b:<span class="hljs-number"><span class="hljs-number">500</span></span>})) &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">50000.0</span></span></code> </pre> <br><h3 id="prosteyshie-vychisleniya">  Simple calculations. </h3><br><p>  As an example, create and calculate several expressions. </p><br><pre> <code class="python hljs">x = tf.placeholder(tf.float32) f = <span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">2</span></span> * x + tf.pow(x, <span class="hljs-number"><span class="hljs-number">2</span></span>) sess.run(f, feed_dict={x: <span class="hljs-number"><span class="hljs-number">10</span></span>}) &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">121.0</span></span></code> </pre> <br><p>  And the calculation graph: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1c4/5ed/13f/1c45ed13fd8f4fa48850b6ab208ec8fd.png"></div><br><p>  <code>x</code> and <code>y</code> points to the operations in this scheme are additional parameters that could be replaced by graph edges, but we substituted scalar values ‚Äã‚Äã1 and 2 into <code>f</code> and this is just a designation in the graph for numbers.  In this example, we create a placeholder and, based on it, an expression graph <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>+</mo><mn>2</mn><mi>x</mi><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.719ex" height="2.539ex" viewBox="0 -935.7 5045.8 1093.4" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2B" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-32" x="1723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-78" x="2223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2B" x="3018" y="0"></use><g transform="translate(4019,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-32" x="809" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>+</mo><mn>2</mn><mi>x</mi><mo>+</mo><msup><mi>x</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-1"> 1 + 2x + x ^ 2 </script>  , and then we perform graph calculations in the context of the current session.  I did not specify the form in the placeholder parameters and this means that tensors of any sizes can be fed to the input.  The only thing you need to specify is the type of tensor.  The parameters for the calculation inside the session are transmitted through the <code>feed_dict</code> dictionary with all that is necessary for the calculations. </p><br><p>  Let's try to collect something more practically meaningful. <br>  For example, sigmoid: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>x</mi></mrow></msup></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.942ex" height="2.66ex" viewBox="0 -832 11599.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-28" x="2953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-78" x="3343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-29" x="3915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-3D" x="4582" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-66" x="5889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="6439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="6891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-63" x="7420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-31" x="7854" y="0"></use><g transform="translate(8354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2B" x="722" y="0"></use><g transform="translate(1723,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-78" x="778" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>‚àí</mo><mi>x</mi></mrow></msup></mrow></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ sigma (x) = \ frac {1} {1 + e ^ {- x}} </script></p><br><pre> <code class="python hljs">x = tf.placeholder(dtype=tf.float32) sigma = <span class="hljs-number"><span class="hljs-number">1</span></span> / (<span class="hljs-number"><span class="hljs-number">1</span></span> + tf.exp(-x)) sigma.eval(feed_dict={x: np.linspace(<span class="hljs-number"><span class="hljs-number">-5</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) })</code> </pre> <br><p>  And such a graph for her. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f07/d29/c67/f07d29c67e174a42aebcdc9589653dec.png"></div><br><p>  In the fragment with the launch of the calculation function, there is one thing that distinguishes this example from the previous ones.  The fact is that in the placeholder, instead of a single scalar value, we pass a whole array.  TF processes all the values ‚Äã‚Äãof the array together, within the same tensor (remember that the array == tensor).  In exactly the same way, we can transfer objects to the graph in whole batchy and deliver images to the neural network as a whole. </p><br><p>  In general, working with tensors resembles working with arrays in numpy.  However, there are some differences.  When we want to lower the dimension, somehow combining the values ‚Äã‚Äãin the tensor for a certain dimension, we use those functions that begin with <a href="https://www.tensorflow.org/api_guides/python/math_ops">reduce_</a> . <br>  If you compare the Theano API - in TF there is no division by vectors and matrices, but instead you have to follow the dimensions of the tensors in the graph and there is a mechanism for deriving the form of the tensor, which allows you to get dimensions even before runtime. </p><br><h2 id="mashinnoe-obuchenie">  Machine learning </h2><br><p>  Let us first analyze the classical linear regression mentioned here more than once, with a detailed description of which can be found <a href="https://habrahabr.ru/company/ods/blog/322076/">here</a> , but we will use the gradient descent method for teaching. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/comment_images/caf/f57/dfc/caff57dfca0f0a3a7ad50d486d4b3531.png"></div><br><p>  <em>Where do without this picture</em> </p><br><p>  I'll start with linear regression, and then add polynomial features. <br>  The data will be synthetic - sine with normal noise: </p><br><pre> <code class="python hljs">x = np.linspace(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) y = np.sin(x) + np.random.normal(size=len(x))</code> </pre> <br><p>  They will look something like this: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9c2/aef/ec6/9c2aefec6677413da0bdfbca55fcaa9d.png"></div><br><p>  I will still break the sample into a training and reference in the proportion of 70/30, but I will leave this and some other routine points in the full source, the link to which will be slightly lower. </p><br><p>  First, we construct a simple linear regression. </p><br><pre> <code class="python hljs">x_ = tf.placeholder(name=<span class="hljs-string"><span class="hljs-string">"input"</span></span>, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], dtype = tf.float32) y_ = tf.placeholder(name= <span class="hljs-string"><span class="hljs-string">"output"</span></span>, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], dtype = tf.float32) model_output = tf.Variable(tf.random_normal([<span class="hljs-number"><span class="hljs-number">1</span></span>]), name=<span class="hljs-string"><span class="hljs-string">'bias'</span></span>) + tf.Variable(tf.random_normal([<span class="hljs-number"><span class="hljs-number">1</span></span>]), name=<span class="hljs-string"><span class="hljs-string">'k'</span></span>) * x_</code> </pre> <br><p>  Here I create two placeholders for the sign and the answer and the formula of the form <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mi>x</mi><mo>+</mo><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.379ex" height="2.178ex" viewBox="0 -780.1 2746.4 937.7" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-78" x="521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2B" x="1316" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-62" x="2316" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mi>x</mi><mo>+</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> kx + b </script>  . <br>  Nuance - in the placeholder the shape parameter (shape) contains None.  The dimension of the placeholder means that the pleisoder consumes two-dimensional tensors, but on one of the axes the size of the tensor is not defined and can be any.  This is done so that the user can transfer the values ‚Äã‚Äãto the graph at once in whole batch.  Such specific dimensions are called dynamic, TF calculates the actual dimension of related elements during the execution of the graph. </p><br><p>  The placeholder for the sign is used in the formula, but for the answer, I place the placeholder for the loss function <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow><mi>i</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.214ex" height="3.142ex" viewBox="0 -935.7 12578.2 1352.7" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6E" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="3566" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-75" x="4035" y="0"></use><g transform="translate(4608,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6E" x="1242" y="499"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-28" x="6735" y="0"></use><g transform="translate(7124,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2212" x="8181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-68" x="9432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="10008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="10538" y="0"></use><g transform="translate(10899,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="693" y="-342"></use></g><g transform="translate(11734,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-32" x="550" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ frac {1} {n} \ sum ^ {n} _ {i = 1} (y_i - \ hat {y} _i) ^ 2 </script>  : </p><br><pre> <code class="python hljs">loss = tf.reduce_mean(tf.pow(y_ - model_output, <span class="hljs-number"><span class="hljs-number">2</span></span>)) <span class="hljs-comment"><span class="hljs-comment">#  </span></span></code> </pre> <br><p>  In TF implemented a dozen methods of optimization.  We will use the classic gradient descent, indicating the speed of learning in the parameters. </p><br><p>  The minimize method will create an operation for us, the calculation of which will minimize the loss function. </p><br><pre> <code class="python hljs">gd = tf.train.GradientDescentOptimizer(<span class="hljs-number"><span class="hljs-number">0.001</span></span>) <span class="hljs-comment"><span class="hljs-comment"># train_step = gd.minimize(loss)</span></span></code> </pre> <br><p>  Initialization of variables - it is necessary for further calculations: </p><br><pre> <code class="python hljs">sess.run(tf.global_variables_initializer())</code> </pre> <br><p>  Everything can finally be taught.  I will launch 100 epochs of training on the training part of the sample, after each training I will arrange control on the delayed part. </p><br><pre> <code class="python hljs">n_epochs = <span class="hljs-number"><span class="hljs-number">100</span></span> train_errors = [] test_errors = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm.tqdm(range(n_epochs)): <span class="hljs-comment"><span class="hljs-comment"># 100 _, train_err = sess.run([train_step, loss ], feed_dict={x_:X_Train.reshape((len(X_Train), 1)) , y_: Y_Train.reshape((len(Y_Train), 1))}) train_errors.append(train_err) test_errors.append(sess.run(loss, feed_dict={x_:X_Test.reshape((len(X_Test), 1)) , y_: Y_Test.reshape((len(Y_Test), 1))}))</span></span></code> </pre> <br><p>  The first session execution of the <code>train_step</code> and <code>loss</code> operations at the same time does both the training and the error estimate on the training set, i.e.  proper assessment of how well we memorized the sample.  The second session execution is counting losses on the test sample.  In the <code>feed_dict</code> parameter <code>feed_dict</code> I pass values ‚Äã‚Äãto the graph for placeholders and <code>reshape</code> to ensure that the data arrays are the same in size.  Where the value of <code>None</code> in the placeholder, any number can be passed.  Tensors with such uncertain sizes are called dynamic, and here I use them to transfer to the graph batchy with examples for training. </p><br><p>  It turns out this is the dynamics of learning: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8d5/3d4/830/8d53d4830722478fa68edfb26a403ccd.png"></div><br><p>  In this column there are auxiliary variables with gradients and initialization operations, they are placed in a separate block. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/87c/930/515/87c93051519f4eacb7b6f285768a1cf7.png"></div><br><p>  And here are the model calculation results: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/721/1f4/8ca/7211f48ca0034409893d010fa90ca4df.png"></div><br><p>  I calculated the values ‚Äã‚Äãfor the graph in this way: </p><br><pre> <code class="python hljs">sess.run(model_output, feed_dict={x_:x.reshape((len(x), <span class="hljs-number"><span class="hljs-number">1</span></span>))})</code> </pre> <br><p>  Here, in the graph, I pass the value only to the <code>x_</code> placeholder - the rest is simply not necessary to evaluate the <code>model_output</code> expression. </p><br><p>  Full listing of the program is <a href="https://pastebin.com/a7WdCLEw">here</a> .  The result was predictable for such a simple linear model. </p><br><h3 id="polinomialnaya-regressiya">  Polynomial regression </h3><br><p>  Let us try to diversify the regression with polynomial signs, regularization, and changes in the model learning speed. </p><br><p>  In the generation of a dataset, we add a certain number of degrees and normalize the features using PolynomialFeatures and StandardScaler from the scikit-learn library.  The first object will create as many polynomial signs as we want, and the second normalizes them. </p><br><p>  For the transition to polynomial regression, we replace only a few lines in the graph of calculations: </p><br><pre> <code class="python hljs">order = <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-comment"><span class="hljs-comment">#   x_ = tf.placeholder(name="input", shape=[None, order], dtype=tf.float32) y_ = tf.placeholder(name= "output", shape=[None, 1], dtype=tf.float32) w = tf.Variable(tf.random_normal([order, 1]), name='weights') model_output = tf.matmul(x_, w)</span></span></code> </pre> <br><p>  In fact, we now consider <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><msub><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>r</mi></mrow></msubsup><msup><mi>x</mi><mi>i</mi></msup><mtext>&amp;#xA0;</mtext><mi>d</mi><mi>o</mi><mi>t</mi><msub><mi>w</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.72ex" height="3.142ex" viewBox="0 -935.7 13657.2 1352.7" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6F" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-64" x="1364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="1887" y="0"></use><g transform="translate(2354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6C" x="0" y="0"></use><g transform="translate(298,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-75" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="1058" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-70" x="1419" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-75" x="1923" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="2495" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-3D" x="5050" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="6356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-75" x="6826" y="0"></use><g transform="translate(7398,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,352)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-64" x="937" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="1460" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="1926" y="0"></use></g><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-31" x="1124" y="0"></use></g></g><g transform="translate(10059,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="809" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-64" x="11225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6F" x="11749" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="12234" y="0"></use><g transform="translate(12596,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="1013" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi><mi>p</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>r</mi></mrow></msubsup><msup><mi>x</mi><mi>i</mi></msup><mtext>&nbsp;</mtext><mi>d</mi><mi>o</mi><mi>t</mi><msub><mi>w</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5"> model_ {output} = \ sum ^ {order} _ {i = 1} x ^ i \ dot w_i </script>  .  Obviously, there is a danger of retraining the model on level ground, so we will add regularization penalties on weights.  Penalties are added to the loss function (loss in the examples) as additional terms and we get almost ElasticNet from sklearn. </p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msubsup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow><mi>i</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>+</mo><mtext>&amp;#xA0;</mtext><mi>a</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi></mrow><mn>2</mn></msup><mo>+</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="68.727ex" height="3.262ex" viewBox="0 -987.6 29590.5 1404.6" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-3D" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-66" x="3307" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="3857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="4309" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-63" x="4838" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-31" x="5272" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6E" x="5772" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="6623" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-75" x="7092" y="0"></use><g transform="translate(7665,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6E" x="1242" y="499"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-28" x="9792" y="0"></use><g transform="translate(10181,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2212" x="11238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-68" x="12489" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="13066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="13595" y="0"></use><g transform="translate(13957,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="693" y="-342"></use></g><g transform="translate(14791,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2B" x="15857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="17108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6C" x="17637" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-70" x="17936" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-68" x="18439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="19016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="19795" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-75" x="20265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6D" x="20837" y="0"></use><g transform="translate(21716,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-32" x="1013" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2B" x="23108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-62" x="24359" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="24789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="25255" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="25617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="26396" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-75" x="26866" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6D" x="27438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-7C" x="28317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-77" x="28595" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-7C" x="29312" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msubsup><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>h</mi><mi>a</mi><mi>t</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi>y</mi></mrow><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mtext>&nbsp;</mtext><mi>a</mi><mi>l</mi><mi>p</mi><mi>h</mi><mi>a</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><msup><mrow class="MJX-TeXAtom-ORD"><mi>w</mi></mrow><mn>2</mn></msup><mo>+</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> loss = \ frac {1} {n} \ sum ^ {n} _ {i = 1} (y_i - \ hat {y} _i) ^ 2 + \ alpha \ sum {w} ^ 2 + \ beta \ sum | w | </script></p><br><p></p><br><pre> <code class="python hljs">loss = tf.reduce_mean(tf.square(y_ - model_output)) + <span class="hljs-number"><span class="hljs-number">0.85</span></span>* tf.nn.l2_loss(w) + <span class="hljs-number"><span class="hljs-number">0.15</span></span>* tf.reduce_mean(tf.abs(w))</code> </pre> <br><p>  For the most popular L2 regression, there is a separate function <code>l2_loss</code> , but the selection of features using L1 will have to be implemented manually, but we will have this average over all absolute weights. </p><br><p>  For the sake of example, I will add another significant change that will affect the pace of learning.  Quite often, when training heavy neural networks, this is simply a necessary measure in order to avoid learning problems and get an acceptable result.  A very simple idea - as you learn to gradually lower the parameter of a step, avoiding big trouble. </p><br><p>  Instead of a constant rate, we will use the exponential decay, which I took straight from the documentation: </p><br><pre> <code class="python hljs">learning_rate = tf.train.exponential_decay(starter_learning_rate, global_step, <span class="hljs-number"><span class="hljs-number">100000</span></span>, <span class="hljs-number"><span class="hljs-number">0.96</span></span>, staircase=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><p>  Inside the function, there is a formula: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>l</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><msub><mtext>&amp;#xA0;</mtext><mi>r</mi></msub><mi>a</mi><mi>t</mi><msub><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><msub><mtext>&amp;#xA0;</mtext><mi>r</mi></msub><mi>a</mi><mi>t</mi><mi>e</mi><mo>&amp;#x2217;</mo><mi>d</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>y</mi><msub><mtext>&amp;#xA0;</mtext><mi>r</mi></msub><mi>a</mi><mi>t</mi><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>g</mi><mi>l</mi><mi>o</mi><mi>b</mi><mi>a</mi><mi>l</mi><msub><mtext>&amp;#xA0;</mtext><mi>s</mi></msub><mi>t</mi><mi>e</mi><mi>p</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>y</mi><msub><mtext>&amp;#xA0;</mtext><mi>s</mi></msub><mi>t</mi><mi>e</mi><mi>p</mi><mi>s</mi></mrow></mrow></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="68.447ex" height="3.142ex" viewBox="0 -987.6 29470.1 1352.7" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="765" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="1294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6E" x="1746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="2346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6E" x="2692" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-67" x="3292" y="0"></use><g transform="translate(3773,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="4442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="4971" y="0"></use><g transform="translate(5333,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="523" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-63" x="990" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="1423" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-79" x="1953" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="2450" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-64" x="2917" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-3D" x="8610" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6C" x="9666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="9965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="10431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="10961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6E" x="11412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-69" x="12013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6E" x="12358" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-67" x="12959" y="0"></use><g transform="translate(13439,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="14108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="14638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="14999" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMAIN-2217" x="15688" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-64" x="16411" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="16934" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-63" x="17401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="17834" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-79" x="18364" y="0"></use><g transform="translate(18861,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="19531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="20060" y="0"></use><g transform="translate(20422,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-66" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-72" x="904" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="1355" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-63" x="1885" y="0"></use><g transform="translate(1639,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6C" x="480" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6F" x="779" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-62" x="1264" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="1693" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-6C" x="2223" y="0"></use><g transform="translate(1783,0)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="499" y="-213"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="3307" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="3669" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-70" x="4135" y="0"></use></g><g transform="translate(4919,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="523" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-63" x="990" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-61" x="1423" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-79" x="1953" y="0"></use><g transform="translate(1732,0)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="499" y="-213"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-74" x="3236" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-65" x="3597" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-70" x="4064" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324898/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhh7ZQBkI05qgzOYk9OmtkXvoqk8fg#MJMATHI-73" x="4567" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><msub><mtext>&nbsp;</mtext><mi>r</mi></msub><mi>a</mi><mi>t</mi><msub><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>y</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><msub><mtext>&nbsp;</mtext><mi>r</mi></msub><mi>a</mi><mi>t</mi><mi>e</mi><mo>‚àó</mo><mi>d</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>y</mi><msub><mtext>&nbsp;</mtext><mi>r</mi></msub><mi>a</mi><mi>t</mi><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>g</mi><mi>l</mi><mi>o</mi><mi>b</mi><mi>a</mi><mi>l</mi><msub><mtext>&nbsp;</mtext><mi>s</mi></msub><mi>t</mi><mi>e</mi><mi>p</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>y</mi><msub><mtext>&nbsp;</mtext><mi>s</mi></msub><mi>t</mi><mi>e</mi><mi>p</mi><mi>s</mi></mrow></mrow></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> learning \ _rate_ {decayed} = learning \ _rate * decay \ _rate ^ {\ frac {global \ _step} {decay \ _steps}} </script></p><br><p>  In our example, <code>decay_rate</code> is set to 100000, <code>decay_rate</code> is 0.96. </p><br><p>  We get the following rates of error reduction in training and control: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3aa/025/0ac/3aa0250acbb84646be8525515b091ede.png"></div><br><p>  In addition to the exponential decay, there are other functions that allow you to reduce the speed of learning, and of course nothing prevents you from creating another function to fit your needs. </p><br><p>  The model itself after training and various selections of parameters will look something like this: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/653/552/97c/65355297c80848c8bf528914af1d4116.png"></div><br><p>  To obtain this result, I changed the coefficients at regularization and learning speed.  Enumerating the values ‚Äã‚Äãof constants in the loss formula is a great way to see with your own eyes the effect of the regularizers, I highly recommend playing with the settings in the full polynomial regression source, it is available <a href="https://pastebin.com/raw/F6tLn8Aw">here</a> . </p><br><h2 id="sohranenie-i-zagruzka-grafov">  Saving and loading graphs </h2><br><p>  We got a model and it would be nice to keep it.  In TF, everything is quite simple - the API has a special serializer object that does two things: </p><br><ol><li>  Saves the current graph, its state and variable values ‚Äã‚Äãto a file; </li><li>  Reads all the same from a file. </li></ol><br><p>  All you need to do is create this object: </p><br><pre> <code class="python hljs">saver = tf.train.Saver()</code> </pre> <br><p>  The state of the current session is saved using the <code>save</code> method: </p><br><pre> <code class="python hljs">saver.save(sess, <span class="hljs-string"><span class="hljs-string">"checkpoint_dir/model.ckpt"</span></span>)</code> </pre> <br><p>  It is already somehow accepted that the saved states of the model are called checkpoints, hence the name of the folders and file extensions.  Recovery is performed using the <code>restore</code> method: </p><br><pre> <code class="python hljs">ckpt = tf.train.get_checkpoint_state(ckpt_dir) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ckpt <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> ckpt.model_checkpoint_path: print(ckpt.model_checkpoint_path) saver.restore(session, ckpt.model_checkpoint_path)</code> </pre> <br><p>  First, using a special function, we get the state of the checkpoint (if all of a sudden there is no saved model in the target directory, the function will return <code>None</code> ).  By default, the function looks for a <code>checkpoint</code> file, but this behavior can be changed using the parameter.  After this, <code>restore</code> restores the state of the graph. </p><br><h2 id="tensorboard">  Tensorboard </h2><br><p>  The extremely useful system in the TF is a web-dashboard, which allows you to collect statistics from dumps and logs and observe what happens during the calculations.  It is extremely convenient that the dashboard runs on a web server and, for example, you can run tensorboard on a remote machine in the cloud and watch what is happening in your browser window. </p><br><p>  Tensorboard can: </p><br><ol><li>  Draw a graph of calculations. <br>  The graph of computations is worth looking at least for a self-test, in order to make sure that what has been collected and considered is exactly what was planned, and no mistakes were made during coding. </li><li>  Show variable statistics. <br>  You can collect any statistics at all. </li><li>  There is a tool for analyzing multidimensional data (for example, embeddingings). <br>  To do this, PCA and t-SNE are built into the dashboards, with which you can try to view the data in 2 and 3 dimensions. </li><li>  Histograms <br>  You can build a histogram of the distribution of the outputs of the network layers and the behavior of variables. </li></ol><br><p>  The reverse side of the medal is that in order for the statistics to fall into the dashboards, it must be saved to the logs (in the protobuf format) using a special API.  API is not very complex, grouped in <code>tf.summary</code> .  To collect statistics, you will need to separately register the variables of interest using special functions and then separately save everything to the log. </p><br><p>  Even when using Tensorboard, it is also important not to forget about the <code>name</code> parameter of variables.  The name that will be assigned to the variable will then be used to draw the graph, select the user interface of the dashboard, in general, everywhere.  For small graphs, this is not critical, but as the complexity of the task grows, problems may arise with understanding what is happening. </p><br><p>  There are several types of functions that save variable data in various ways: </p><br><pre> <code class="python hljs">tf.summary.histogram(<span class="hljs-string"><span class="hljs-string">"layer_output"</span></span>, w_h)</code> </pre> <br><p>  This function will allow you to collect a histogram for the layer exit and approximately estimate the dynamics of changes during training.  The <code>tf.summary.scalar("accuracy", learning_rate)</code> function will store a number.  You can still save audio and images. </p><br><p>  To save the logs you need a little more: you first need to create a FileWriter to write the file. </p><br><pre> <code class="python hljs">writer = tf.summary.FileWriter(<span class="hljs-string"><span class="hljs-string">"./logs/nn_logs"</span></span>, sess.graph) <span class="hljs-comment"><span class="hljs-comment"># for 1.0 merged = tf.summary.merge_all()</span></span></code> </pre> <br><p>  And combine all the statistics in one object. </p><br><p>  Now we need to transfer this <code>merged</code> object to the session and then use the <code>FileWriter</code> method <code>FileWriter</code> add new data received from the session. </p><br><pre> <code class="python hljs">summary, op_result = sess.run([merged, op], feed_dict={X: X_train, Y: y_train, p_keep_input: <span class="hljs-number"><span class="hljs-number">1.0</span></span>, p_keep_hidden: <span class="hljs-number"><span class="hljs-number">1.0</span></span>}) writer.add_summary(summary, i)</code> </pre> <br><p>  However, for simple saving of the graph such code is enough: </p><br><pre> <code class="python hljs">merged = tf.summary.merge_all(key=<span class="hljs-string"><span class="hljs-string">'summaries'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> os.path.exists(<span class="hljs-string"><span class="hljs-string">'tensorboard_logs/'</span></span>): os.makedirs(<span class="hljs-string"><span class="hljs-string">'tensorboard_logs/'</span></span>) my_writer = tf.summary.FileWriter(<span class="hljs-string"><span class="hljs-string">'tensorboard_logs/'</span></span>, sess.graph)</code> </pre> <br><p>  And a nuance: the default Tensorboard is locally available at 127.0.  <strong>1</strong> .1: 6006.  I hope I saved the readers a few seconds of time and neurons with this remark. </p><br><h2 id="mnogosloynyy-perceptron">  Multilayer perceptron </h2><br><p>  Let us analyze the canonical example of memorizing the function xor, which the linear model cannot assimilate due to the impossibility of a linear division of the space of attributes. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dc9/f2b/3b2/dc9f2b3b24a34d8684eca18fdbe5d449.png"></div><br><p>  Multilayer networks assimilate the function because they make an implicit conversion of the space of attributes into separable or, depending on the implementation, make a nonlinear partition of this space.  We are implementing the first option - we will create a two-layer perceptron with non-linear activation of the layers.  The first layer will do the nonlinear transformation, and the second layer is almost linear regression, which works on the transformed feature space. </p><br><p>  As an element of nonlinearity, we will use the <a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)">relu</a> function. </p><br><p>  Define the network structure: </p><br><pre> <code class="python hljs">x_ = tf.placeholder(name=<span class="hljs-string"><span class="hljs-string">"input"</span></span>, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>], dtype=tf.float32) y_ = tf.placeholder(name= <span class="hljs-string"><span class="hljs-string">"output"</span></span>, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], dtype=tf.float32) hidden_neurons = <span class="hljs-number"><span class="hljs-number">15</span></span> w1 = tf.Variable(tf.random_uniform(shape=[<span class="hljs-number"><span class="hljs-number">2</span></span>, hidden_neurons ])) b1 = tf.Variable(tf.constant(value=<span class="hljs-number"><span class="hljs-number">0.0</span></span>, shape=[hidden_neurons ], dtype=tf.float32)) layer1 = tf.nn.relu(tf.add(tf.matmul(x_, w1), b1)) w2 = tf.Variable(tf.random_uniform(shape=[hidden_neurons ,<span class="hljs-number"><span class="hljs-number">1</span></span>])) b2 = tf.Variable(tf.constant(value=<span class="hljs-number"><span class="hljs-number">0.0</span></span>, shape=[<span class="hljs-number"><span class="hljs-number">1</span></span>], dtype=tf.float32)) nn_output = tf.nn.relu(tf.add(tf.matmul(layer1, w2), b2))</code> </pre> <br><p>    keras     , TF,  Theano          .       , ,   dropout-   ,                 ,     (     ,  ,   ). </p><br><p> ,        : </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fully_connected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(input_layer, weights, biases)</span></span></span><span class="hljs-function">:</span></span> layer = tf.add(tf.matmul(input_layer, weights), biases) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(tf.nn.relu(layer))</code> </pre> <br><p>             :      -   (  ‚Äî      )              ,  tensorboard  -    . </p><br><p>    : </p><br><pre> <code class="python hljs">gd = tf.train.GradientDescentOptimizer(<span class="hljs-number"><span class="hljs-number">0.001</span></span>) loss = tf.reduce_mean(tf.square(nn_output - y_)) train_step = gd.minimize(loss)</code> </pre> <br><p>  : </p><br><pre> <code class="python hljs">x = np.array([[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]]) y = np.array([[<span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>]]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">20000</span></span>): sess.run(train_step, feed_dict={x_:x, y_:y})</code> </pre> <br><p>  : </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/76e/2e4/185/76e2e41856fb443bab060434e0f9aec2.png"></div><br><p>        :    ,    .   ,    ‚Äî     .   ,         ,          . </p><br><p> ,        .              : </p><br><pre> <code class="python hljs">sess.run(nn_output, feed_dict={x_:x})</code> </pre> <br><p>      <a href="https://pastebin.com/9M9NES35"></a> .         5 . </p><br><p> ,                     TF     . </p><br><h2 id="upravlenie-resursami">   </h2><br><p>     ,         .       Tesla,       -  .  TF       .      ¬´/cpu:0¬ª, ¬´/gpu:0¬ª  ..   ‚Äî  ,    ¬´¬ª    : </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.device(<span class="hljs-string"><span class="hljs-string">'/cpu:0'</span></span>): a = ...</code> </pre> <br><p>     <code></code>   . </p><br><p>       ,        .    : </p><br><pre> <code class="python hljs">cfg = tf.ConfigProto() sess = tf.Session(config=cfg)</code> </pre> <br><p>        <code>log_device_placement</code> ,  ,           . </p><br><p> ,          GPU.       : </p><br><pre> <code class="python hljs">gpu_opts = tf.GPUOptions(per_process_gpu_memory_fraction = <span class="hljs-number"><span class="hljs-number">0.25</span></span>) sess = tf.Session(config=tf.ConfigProto(gpu_options = gpu_opts))</code> </pre> <br><p>           GPU,   ,        ,        CPU,      <code>allow_soft_placement</code> ,  TF    .    API               .      ,   ‚Äî  ,     . </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p> TF   -  ,           ,          .           , ,      -.   ,    ¬´¬ª        .     TF    Kaggle! </p><br><p>    <a href="https://habrahabr.ru/users/sovcharenko/" class="user_link">sovcharenko</a> , <a href="https://habrahabr.ru/users/ferres/" class="user_link">Ferres</a>  <a href="https://habrahabr.ru/users/bauchgefuehl/" class="user_link">bauchgefuehl</a>     . </p><br><p>  UPD: <br> Jupyter-       <a href="https://github.com/hydrophis-spiralis/intro_tf/blob/master/intro_tf.ipynb"></a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/324898/">https://habr.com/ru/post/324898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324888/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ255 (March 20 - 26, 2017)</a></li>
<li><a href="../324890/index.html">On linear regression: Bayesian approach to the ruble exchange rate</a></li>
<li><a href="../324892/index.html">PHP Digest number 105 - interesting news, materials and tools (March 13 - 26, 2017)</a></li>
<li><a href="../324894/index.html">Making your first game on the Phaser. Part 0 - Getting Started</a></li>
<li><a href="../324896/index.html">Making your first game on the Phaser. Part 1 - Introduction</a></li>
<li><a href="../324900/index.html">MIPSfpga and interrupts</a></li>
<li><a href="../324902/index.html">How Discord Indexes Billions of Posts</a></li>
<li><a href="../324904/index.html">Five important principles of working with data, which we forget when preparing a project presentation</a></li>
<li><a href="../324906/index.html">The story of how I went to Google Next 17. A brief pressing on the announcements and the most important</a></li>
<li><a href="../324908/index.html">A brief history of javascript. Part 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>