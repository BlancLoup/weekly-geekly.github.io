<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using third-party libraries in D</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On the wave of interest in the language D, I decided to contribute to its popularization. The article is not for beginners, but more for those who con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using third-party libraries in D</h1><div class="post__text post__text-html js-mediator-article">  On the wave of interest in the language D, I decided to contribute to its popularization.  The article is not for beginners, but more for those who consider D as a second language.  It is known that at the dawn of its development, programming languages ‚Äã‚Äãhave a poor set of libraries and this often prevents you from starting to write something serious on them.  I hope the article will help someone to cross this barrier. <br>  The features of the dub utility will be discussed below, as well as the connection of third-party packages and libraries written in C / C ++ using the example of the excellent <a href="http://software.schmorp.de/pkg/libev.html">libev</a> library. <br><a name="habracut"></a><br><h4>  Dub utility </h4><br>  Honestly, I still ‚Äúfloat‚Äù in the <a href="http://dlang.org/download.html">dmd</a> options needed to compile and build the application.  This is due to the <a href="http://code.dlang.org/about">dub</a> utility, which takes care of all these concerns and allows you to postpone the study of compiling and building the application for later, when it really becomes necessary.  In addition, this useful program performs the functions of a package manager, possessing functionality similar to the pip utilities for python, npm for javascript, etc. <br><br><h4>  Project Initialization </h4><br>  To initialize the application using the <b>dub</b> utility, you need to create a project directory, go to it and execute the command: <br><pre><code class="bash hljs">$ dub init</code> </pre> <br>  As a result, the file <b>dub.json</b> will be created, with the help of which the configuration and parameters of the application build will be set.  Also, the <b>source</b> subdirectory containing the <b>app.d</b> file with a plain heworld. <br>  The application is built and / or launched by the same utility launched from the project root directory, that is, from the directory containing the <code>dub.json</code> file.  To compile, build and run heloworld from the <code>app.d</code> file, just run the <code>dub</code> command. <br><br><h4>  Connection of third-party packages (libraries) </h4><br>  In terms of language, third-party D-libraries distributed as source codes are called packages.  The <code>dub</code> utility uses the package registry at the <a href="http://code.dlang.org/">following address</a> .  The use of libraries written with C / C ++ is also possible, but this requires the inclusion of special packages in the project, called <b>binding</b> .  The library itself must be installed in the system.  For example, <b>libev</b> , which will continue to be used, is installed on debian-like linux distributions as follows: <br><pre> <code class="bash hljs">$ sudo apt-get install libev-dev</code> </pre><br>  To use it in a project on D, you need a binding that a good person has already <a href="http://code.dlang.org/packages/libev">done and placed</a> in the above named registry.  There is also an instruction on what changes need to be made to the <code>dub.json</code> file in <code>dub.json</code> to use <code>libev</code> in the project.  It all comes down to adding to the <b>dependencies</b> section of the <code>dub.json</code> file the <code>dub.json</code> name, version and, if necessary, some other parameters. <br>  The next time you run the <code>dub</code> command, all the packages listed in dependencies will be checked and loaded if they are absent. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Heloworld using libev </h4><br>  After the above manipulations, the project is ready to use <code>libev</code> from <code>libev</code> .  Below is the code that should be placed in the <code>app.d</code> file, and if everything went smoothly, we will get an executable file that will delight every second with the message ‚ÄúHello, World!‚Äù In the console. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>.stdio; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> deimos.ev; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ev_timer watcher; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span>(C) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cb_timer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ev_loop_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* loop, ev_timer* watcher, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> revents)</span></span></span><span class="hljs-function"> </span></span>{ writeln(<span class="hljs-string"><span class="hljs-string">"Hello, World!"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> p_loop = ev_loop_new(EVFLAG_AUTO); ev_timer_init(&amp;watcher, &amp;cb_timer, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>); ev_timer_start(p_loop, &amp;watcher); ev_run(p_loop, <span class="hljs-number"><span class="hljs-number">0</span></span>); }</code> </pre><br>  What is worth noting in terms of using third-party libraries in D programs? <br>  First, the second line connects the package-binding to <code>libev</code> .  Secondly, the callback function <code>cb_timer</code> defined as <code>extern(C)</code> .  In fact, its call will come from the depths of the connected library, and we have it written in C. Consequently, the <code>cb_timer</code> <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BE%25D0%25B3%25D0%25BB%25D0%25B0%25D1%2588%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BE_%25D0%25B2%25D1%258B%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B5">calling</a> <code>cb_timer</code> must correspond to the call of functions written in C. <br><br>  What can I say in general, looking at the code?  Apart from the features of the D language, which allowed defining the <code>cb_timer</code> in the body of the <code>main</code> function, the code differs little from the similar C program. This is due to the fact that the binding packages usually contain minimal binding on function calls from the ssh library.  Often, for convenience, another level of binding is made that provides more readable code using the ‚Äúsyntactic sugar‚Äù of the D language. For example, similar code could look something like this. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>.stdio; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mercury.core; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TimerWatcher(<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, (revents) { writeln(<span class="hljs-string"><span class="hljs-string">"Hello, World!"</span></span>); }).start(); defaultEventLoop.start(); }</code> </pre><br>  By the way, the code above is real.  I tried to make a high-level wrapper over <code>libev</code> using a parameterized class for watchers.  It turned out like not bad.  If this is interesting to someone - in the next article I will tell about it. <br><br>  <b>Upd:</b> There is a <a href="http://habrahabr.ru/post/218125/">good article</a> on using the <code>dub</code> , the author described in some detail the main features of the utility. <br><br>  PS: It would be nice to have already highlighted the syntax highlighting D in the habratopic editor. </div><p>Source: <a href="https://habr.com/ru/post/226301/">https://habr.com/ru/post/226301/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../226291/index.html">My Kama holidays: as governor, Perm citizens and Skolkovo gathered to digitize their homeland</a></li>
<li><a href="../226293/index.html">Several useful features for the developer under Squarespace</a></li>
<li><a href="../226295/index.html">How to analyze skateboarding using PVDF film</a></li>
<li><a href="../226297/index.html">Navigation Editor - a new tool in Android Studio</a></li>
<li><a href="../226299/index.html">Protection of an entrance by the method of the organization of reasonable video surveillance without concierge</a></li>
<li><a href="../226303/index.html">TDD is dead. Long live testing</a></li>
<li><a href="../226305/index.html">Libraries that may still be useful</a></li>
<li><a href="../226307/index.html">We color icons from Google</a></li>
<li><a href="../226309/index.html">Declarative data binding in WinJS</a></li>
<li><a href="../226311/index.html">Steel printer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>