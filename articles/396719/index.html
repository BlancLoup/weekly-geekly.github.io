<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability in WPAD allows access to data protected with HTTPS and VPN</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Researchers recommend urgently disable the WPAD protocol on Windows 
 Web Proxy Auto-Discovery Protocol (WPAD) is an automatic proxy configuration pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability in WPAD allows access to data protected with HTTPS and VPN</h1><div class="post__text post__text-html js-mediator-article"><h3>  Researchers recommend urgently disable the WPAD protocol on Windows </h3><br><img src="https://habrastorage.org/files/94f/ae5/e18/94fae5e185c347f4a24889543470d7dc.gif" align="left">  Web Proxy Auto-Discovery Protocol (WPAD) is an automatic proxy configuration protocol that is used by clients (browser) to locate (URL) the location of the configuration file using DHCP and / or DNS technologies.  When making a request, the browser calls the FindProxyForURL function from the PAC file, where the URL and the host are passed to.  The expected answer is a list of proxies through which access to this address will be made. <br><br>  WPAD is enabled by default in Windows and is supported by other operating systems.  But this protocol is subject to a number of vulnerabilities, as <a href="https://it.slashdot.org/story/16/08/13/0149241">shown</a> by information security experts Alex Chapman (Alex Chapman) and Paul Stone (Paul Stone) at Defcon.  Malefactors, using these vulnerabilities, can obtain data of the victim (search history, access to accounts, photos, documents, etc.), despite HTTPS or VPS connections.  The type of attack that is used in this case is man-in-the-middle. <br><a name="habracut"></a><br>  You can locate the configuration PAC file using Dynamic Host Configuration Protocol (DHCP), Domain Name System (DNS), or Link-Local Multicast Name Resolution (LLMNR).  Cybercriminals can optionally exploit a WPAD vulnerability by specifying the location of a specially configured PAC file that will send a browser request through proxy servers that are under the control of intruders.  This can be achieved in an open wireless network by compromising a router or access point, or by opening to everyone who wants access to their own access point, configured properly. <br><br>  It is not necessary to compromise the attacked PC's own network, since the system will use WPAD to detect a proxy if it is connected via an open wireless network.  At the same time, WPAD is also used in the corporate environment; this option is enabled by default on all Windows PCs, as mentioned above. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Own proxy server allows attackers to intercept and modify unencrypted HTTP traffic.  This does not give too much to cybercriminals, since most sites now work on HTTPS (HTTP Secure).  But, since PAC files provide the ability to set different proxy addresses for specific web addresses, and for these addresses you can force the DNS lookup, hackers-beloshlyapniki created a script that allows you to receive all HTTPS protected URLs on your own server. <br><br>  The full HTTPS URL must be hidden because it contains authentication tokens and other private information.  But an attacker can recover the address.  For example, <a href="https://example.com/login%3Fauthtoken%3DABC1234">example.com/login?authtoken=ABC1234</a> can be restored by using the DNS query https.example.com.login.authtoken.ABC1234.leak and restored on the cybercriminary server. <br><br>  Using this method, an attacker can get a list of victim search queries or see which articles of a particular resource the victim is currently reading.  This is not too good in terms of information security, but it seems not too dangerous.  True, the trouble of the victim does not end there. <br><br>  The researchers have developed another type of attack that can be used to redirect the user of an open wireless access point to the fake access point page.  Many wireless networks collect user data using special pages.  After entering their data, the user gets access to the Internet (often this scheme is used by wireless providers at airports). <br><br>  A page formed by hackers loads Facebook or Google familiar to the user in the background, and then performs 302 HTTP redirect to other URLs, provided the user is authenticated.  If the user is already logged in to his account, and most people do not log out of their accounts on various resources, working from their PC or laptop, then the fraudster can obtain the identification data of the victim. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/cb9/af1/c20/cb9af1c20fb54e6af24121f31720f4df.png"><br>  <em>On Windows, WPAD is activated when the "Automatically detect settings" option is enabled.</em>  <em>This option is enabled by default.</em> <br><br>  This applies to accounts on a variety of resources, and through direct links, an attacker can gain access to personal photos of the victim, as well as other data.  Attackers can steal tokens for the popular OAuth protocol, which allows you to log in to various sites using your Facebook, Google or Twitter account information. <br><br>  The possibilities of the new method specialists showed on Defcon.  Using their technology, the experts got access to the victim's photo, history of coordinates, calendar reminders and Google account profile data, as well as access to all of the victim's documents on Google Drive.  It is worth emphasizing that the attack does not affect HTTPS encryption, the data is still protected.  But if WPAD is enabled in the OS, then HTTPS is already much less effective in protecting the user's private data.  And it also concerns the information of those users who work with VPN.  WPAD allows you to access this data. <br><br>  The fact of the matter is that popular VPN clients, like OpenVPN, do not clear the network settings specified by WPAD.  This means that if an attacker has already managed to establish his proxy settings on the victim's PC, before a VPN connection has been established on this PC, then the traffic will also go through the attacker's proxy server.  This opens up the possibility of obtaining all the data mentioned above. <br><br>  Most operating systems and browsers work with WPAD, and are vulnerable to this type of attack.  The experts who discovered the problem reported it to the developers of various vulnerable software products.  Patches released for OS X, iOS, Apple TV, Android, Google Chrome.  Microsoft and Mozilla are still working on fixing the problem. <br><br><h3>  How to protect yourself? </h3><br>  The easiest way is to disable WPAD.  If you need PAC files to work with, <a href="http://www.csoonline.com/article/3106076/data-protection/disable-wpad-now-or-have-your-accounts-and-private-data-compromised.html">disable WPAD</a> and configure URL exceptions yourself. <br><br>  Chapman and Stone are not the only information security experts who have noticed the vulnerability of the WPAD protocol.  A few days earlier, a similar type of attack was demonstrated at the Black Hat conference.  And in May, a joint team of specialists from Verisign and the University of Michigan told that tens of millions of WPAD requests go online every day when users' laptops disconnect from corporate networks.  These machines give requests for internal WPAD domains with extensions such as .global, .ads, .group, .network, .dev, .office, .prod, .hsbc, .win, .world, .wan, .sap, and .site . <br><br>  The problem is that such domain zones already exist in the global network, and if desired, an attacker can register domains for which requests are received from corporate machines that are disconnected from the enterprise network.  And this, in turn, allows attackers to ‚Äúfeed‚Äù self-configured PAC-files to machines that are disconnected from corporate networks, but which give WPAD requests to discover the global network addresses mentioned above. </div><p>Source: <a href="https://habr.com/ru/post/396719/">https://habr.com/ru/post/396719/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../396709/index.html">Library "Librusek" will be blocked by the decision of the Moscow City Court</a></li>
<li><a href="../396711/index.html">Facebook obediently blocks scientific bloggers and atheists on the complaints of the ignorant majority</a></li>
<li><a href="../396713/index.html">Forgotten Flight "Eagle"</a></li>
<li><a href="../396715/index.html">How and why the main feature of universal autonomous artificial intelligence will make it capture humanity?</a></li>
<li><a href="../396717/index.html">NASA Announces New Deadline for ARM Program</a></li>
<li><a href="../396721/index.html">Experts from China and the United States have learned to manipulate the Tesla autopilot</a></li>
<li><a href="../396723/index.html">Unlocked lock for home. And even for the owner, if he is forced to do it. And if you do not believe, the police will arrive.</a></li>
<li><a href="../396725/index.html">How I picked up my files from OneDrive</a></li>
<li><a href="../396727/index.html">The troubles of world stock markets: cybercrime, natural disasters and the human factor</a></li>
<li><a href="../396731/index.html">Shooting with the help of a special application will penalize traffic offenders</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>