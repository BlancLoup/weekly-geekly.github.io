<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using Coffeescript on Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="CoffeeScript is a new language / add-on / icing sugar over regular JavaScript. If anyone has not heard of it, you can read this excellent introductory...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using Coffeescript on Windows</h1><div class="post__text post__text-html js-mediator-article">  CoffeeScript is a new language / add-on / icing sugar over regular JavaScript.  If anyone has not heard of it, you can read this <a href="http://habrahabr.ru/blogs/javascript/97993">excellent introductory article</a> . <br><br>  By its magical nature, the compiler itself for coffee-scripts is written on the coffee-script.  But fortunately, the CoffeeScript source package already contains ready-to-use js scripts.  And now I will tell you how to use them in windows with the help of Node.js, Cygwin and Nant, for this is not a simple matter, at first glance. <br><br><a name="habracut"></a><h4>  What do you want? </h4><br>  So, to begin with, let's define the structure of a simple project with which we will work: <br><blockquote><pre> Project
 + --- CoffeeScripts
 |  \ --- roast.coffee
 + --- JavaScripts
 | --- Tools
 |  + --- CoffeeScript
 |  + --- CygwinLite
 |  + --- NAnt
 |  \ --- NodeJs
 \ --- compile.bat </pre></blockquote><br>  <b>The goal</b> is to run <code>compile.bat</code> in the project root, which will compile all the scripts from the <code>CoffeScripts</code> folder to the <code>JavaScripts</code> folder. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The following programs will help us with this: <br><ul><li>  CoffeeScript itself; </li><li>  Node.js to run a coffee compiler; </li><li>  Cygwin-Lite for converting file paths to unix view; </li><li>  Nant is an assembly system for all of this porridge. </li></ul><br>  As an example, we will compile the following simple coffee-script " <code>roast.coffee</code> ": <br><blockquote><pre> roast = (what) -&gt;
	 "Roasted # {what}"	
 console.log roast 'coffee!' </pre></blockquote><br><br><h4>  CoffeeScript </h4><br>  The latest version of the package can be downloaded from <a href="http://github.com/jashkenas/coffee-script/">github</a> or cloned using the following command: <br><blockquote><pre>  git clone http://github.com/jashkenas/coffee-script.git </pre></blockquote><br>  There are two js scripts in the CoffeeScript \ bin folder: cake and coffee.  Cake is a build system for make and rake projects, written in CoffeeScript, but we will not use it in this article.  Coffee - the compiler of coffee-scripts in js-scripts.  This is what we need to have. <br><br><h4>  Node.js </h4><br>  The binary assembly node.js for Windows can now be easily found on the Internet.  Personally, I am currently using version 0.2.2 <a href="http://node-js.prcn.co.cc/">from this site</a> . <br><br>  Already at this step, you can run coffee.  Suppose that the PATH environment variable contains the path to the node.js folder, and as an exercise, execute the following command " <code>coffee --version</code> ": <br><blockquote><pre> C: \ Project \ Tools \ CoffeeScript \ bin
 &gt; node coffee --version
 CoffeeScript version 0.9.4 </pre></blockquote><br>  However, everything is not so simple if you need to call coffee not from its bin directory.  Since node.js is compiled for windows using Cygwin, all paths in parameters to such programs must be specified in unix form via cygdrive (for absolute paths): <br><blockquote><pre> D: \
 &gt; node / cygdrive / C / Project / Tools / CoffeeScript / bin / coffee --version
 CoffeeScript version 0.9.4
</pre></blockquote><br>  To make such calls easier, you can use the following wrapper for coffee in the form of the " <code>coffee.bat</code> " <code>coffee.bat</code> , which you need to save to its bin-directory: <br><blockquote><pre> @pushd.
 @cd / d% ~ dp0
 @node coffee% *
 @popd
</pre></blockquote><br>  Now the call to coffee is simplified: <br><blockquote><pre> D: \
 &gt; C: \ Project \ Tools \ CoffeeScript \ bin \ coffee --version
 CoffeeScript version 0.9.4
</pre></blockquote><br>  Now you can compile our <code>roast.coffee</code> and get the result on the console: <br><blockquote><pre> C: \ Project
 &gt; Tools \ CoffeeScript \ bin \ coffee -c -p /cygdrive/C/Project/CoffeeScripts/roast.coffee
 (function () {
   var roast;
   roast = function (what) {
     return "Roasted" + (what);
   };
   console.log (roast ('coffee!'));
 }). call (this);
</pre></blockquote><br>  As you can see, it still remains necessary to specify the unix-path in the parameters to the compiler. <br><br>  Here comes to help us ... <br><br><h4>  Cygwin-lite </h4><br>  ... Or rather, its powerful utility cygpath.exe. <br><br>  Cygwin-Lite is very heavily clipped Cygwin, which, because of its small size, can be stored along with the code (yes, I like to store everything for assembly along with the project).  Download Cygwin-Lite <a href="http://cygwin-lite.sourceforge.net/">here</a> .  Although only cygpath is enough for us to compile, I did not find where it can be downloaded separately from the package. <br><br>  We will use cygpath with the following parameters: <br><blockquote><pre> cygpath -a -u windows-filename
</pre></blockquote><br>  This allows you to convert windows-paths to absolute unix-paths.  Example: <br><blockquote><pre> C: \ Project \ Tools \ CygwinLite \ bin
 &gt; cygpath.exe -a -u cygpath.exe
 /cygdrive/c/Project/Tools/CygwinLite/bin/cygpath.exe
</pre></blockquote><br><h4>  Compile.bat </h4><br>  OK, let's finally write a batch file for compiling scripts! <br>  For the purity of the experiment, we will not use environment variables and homemade coffee.bat. <br><blockquote><pre> @echo off

 REM Folder with source scripts
 set sourceDir = CoffeeScripts

 REM Folder for compiled scripts
 set destDir = JavaScripts

 REM Folders Used Utilities
 set cygwinDir = Tools \ CygwinLite \ bin
 set coffeeDir = Tools \ CoffeeScript \ bin
 set nodeDir = Tools \ nodejs

 REM Get the unix paths for the destination folder and before the coffee compiler script
 for / f %% o in ('% cygwinDir% \ cygpath.exe -a -u "% destDir%"') do set outputPath = %% o
 for / f %% c in ('% cygwinDir% \ cygpath.exe -a -u "% coffeeDir% \ coffee"') do set coffeePath = %% c

 REM For each coffee-script ...
 for %% f in (% sourceDir% \ *. coffee) do (
   REM ... we get its unix-way, ...
   for / f %% s in ('% cygwinDir% \ cygpath.exe -a -u %% f') do (
     REM ... and compile it into javascript in the destination folder!
     % nodeDir% \ node% coffeePath% -c -o% outputPath% %% s
   )
 )

 echo done!
</pre></blockquote><br>  Run <code>compile.bat</code> and get the compiled <code>roast.js</code> in the <code>JavaScripts</code> folder: <br><blockquote><pre> C: \ Project
 &gt; compile.bat
 Done!


 C: \ Project
 &gt; type JavaScripts \ roast.js
 (function () {
   var roast;
   roast = function (what) {
     return "Roasted" + (what);
   };
   console.log (roast ('coffee!'));
 }). call (this);
</pre></blockquote><br>  Hurray, it works!  But to build large projects you need something cooler than a batch file. <br><br><h4>  Use Nant </h4><br>  For those who are not familiar with NAnt, a small educational program. <br><br>  NAnt is a free tool for building and deploying .NET projects.  At one time, NAnt was ported from Ant (build system for Java) to the .NET framework and tailored to the needs of .NET developers.  But with good imagination, this thing can be applied to anything.  Currently, NAnt can be run both under windows and under linux using Mono.  Its advantages: can do a large number of tasks and functions right out of the box, there is error handling, plus good extensibility and third-party plug-ins. <br>  Links on which you can continue acquaintance with Nant: <br><ul><li>  <a href="http://nant.sourceforge.net/">NAnt Home Page</a> </li><li>  <a href="http://habrahabr.ru/blogs/net/101183/">Automating the assembly of web applications on the .NET platform</a> </li><li>  <a href="http://www.4guysfromrolla.com/articles/120104-1.aspx">A Brief Introduction to NAnt</a> </li><li>  <a href="http://dimecasts.net/Casts/ByTag/NAnt">Dimecasts.net: NAnt Episodes (screencasts)</a> </li></ul><br>  And so, I assume that you have some idea about Nant, and now we will write a build script that will compile coffee scripts, similar to the previous compile.bat. <br><blockquote><pre> &lt;? xml version = "1.0"?&gt;
 &lt;project xmlns = "http://nant.sf.net/release/0.90-alpha1/nant.xsd" name = "Coffee test"&gt;

   &lt;! - Set the environment variables for the script.  The path to cygwin is required to use the function $ {cygpath} -&gt;
   &lt;setenv&gt;
     &lt;variable name = "PATH" value = "Tools \ CygwinLite \ bin; Tools \ nodejs;% PATH%" /&gt;
   &lt;/ setenv&gt;
  
   &lt;foreach item = "File" property = "filename"&gt;
     &lt;in&gt;
       &lt;items basedir = "CoffeeScripts"&gt;
         &lt;include name = "*. coffee" /&gt;
       &lt;/ items&gt;
     &lt;/ in&gt;
     &lt;do&gt;
       &lt;exec program = "node"&gt;
         &lt;arg line = "$ {cygpath :: get-unix-path ('Tools \ CoffeeScript \ bin \ coffee')}" /&gt;        
         &lt;arg line = "- c" /&gt;
         &lt;arg line = "- o $ {cygpath :: get-unix-path (path :: get-full-path ('JavaScripts'))}" /&gt;
         &lt;arg line = "$ {cygpath :: get-unix-path (path :: get-full-path (filename))}" /&gt;
       &lt;/ exec&gt;
     &lt;/ do&gt;
   &lt;/ foreach&gt;
 &lt;/ project&gt;
</pre></blockquote><br>  Save the build script as " <code>compile.build</code> " and write a new " <code>compile.bat</code> " to run it: <br><blockquote><pre> Tools \ Nant \ bin \ nant.exe -buildfile: compile.build
</pre></blockquote><br><h4>  Roasting coffee </h4><br><blockquote><pre> C: \ Project \ JavaScripts
 &gt; node roast.js
 Roasted coffee! </pre></blockquote><br>  Good luck! </div><p>Source: <a href="https://habr.com/ru/post/106811/">https://habr.com/ru/post/106811/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../106805/index.html">C # for beginners. Lecture 2. Hello, World! and familiarity with Visual C # Express 2010</a></li>
<li><a href="../106806/index.html">PulseAudio, Part 1: Command Line Control</a></li>
<li><a href="../106807/index.html">Love of Google Maps to Russian strategic sites</a></li>
<li><a href="../106809/index.html">Ruby and EventMachine</a></li>
<li><a href="../106810/index.html">Entering an American Business School</a></li>
<li><a href="../106813/index.html">Convert UserJS to Opera extension</a></li>
<li><a href="../106815/index.html">Microcast: Iterators / Generating Date Ranges, Numbers, etc.</a></li>
<li><a href="../106816/index.html">The first Russian applications appeared in the Windows Marketplace</a></li>
<li><a href="../106817/index.html">Modification of the Chieftec power supply cooling system</a></li>
<li><a href="../106818/index.html">DesignGu.ru Podcast</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>