<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Progress Tracking in R</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It doesn't matter if we give ourselves an account of this, but when we have to wait, we worry and burn with impatience. This is especially true of wai...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Progress Tracking in R</h1><div class="post__text post__text-html js-mediator-article">  It doesn't matter if we give ourselves an account of this, but when we have to wait, we worry and burn with impatience.  This is especially true of waiting "blindly", that is,  when it is unknown how much more will have to suffer.  As Brad Allan Myers, who is considered the inventor of the state indicator in the 1980s, found out, the ability to track progress while waiting can significantly improve the user interaction mechanism with an application (Myers, 1985). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c26/699/d2d/c26699d2d4ec4559b7186b87e81f85eb.png"></div><br>  <i>Typical Status Indicator by Simeon87 [ <a href="http://www.gnu.org/licenses/gpl.html">GPL</a> ], Wikimedia Commons</i> <br><br>  Since I program in R for research in bioinformatics, my code is usually not for the general public, but it‚Äôs still important that my users, I mean colleagues and researchers, are as happy as possible.  But tracking progress in R is not an easy task.  This article presents several possible solutions, including my own ( <a href="https://cran.r-project.org/package%3Dpbmcapply">pbmcapply</a> ). <br><a name="habracut"></a><br><h2>  Output on display </h2><br>  The easiest way to track the progress in R is to periodically display the percentage of work completed at the moment: by default, on the screen, or write it to some file with logs somewhere on the disk.  It makes no sense to say that this is probably the least elegant way to solve, but many still use it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Pbapply </h2><br>  The best (and still simple) solution is to include the <a href="https://cran.r-project.org/web/packages/pbapply/index.html">pbapply</a> package.  If you believe the information on <a href="https://github.com/psolymos/pbapply">his page</a> , the package is very popular - 90 thousand downloads.  Its easy to use.  Whenever you are going to call apply, call its <i>pbapply version</i> .  For example: <br><br><pre><code class="hljs lua">#  ,      nums &lt;- <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span> #  sapply,       <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span> &lt;- sapply(nums, <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>) #        pbapply <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span> &lt;- pbsapply(nums, <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>)</code> </pre> <br>  While the numbers are being processed, a periodically updated status indicator will be displayed. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1f8/d0e/7c0/1f8d0e7c06064dec9fba3f4519c4d90b.jpeg"></div><br>  <i>Pbapply generated status indicator.</i>  <i>The user can see how much more time is needed, and the current state in the form of an indicator.</i> <br><br>  Although <i>pbapply</i> is a great tool, and I use it often, I wasn‚Äôt able to display progress for the parallel version of apply - <i>mcapply</i> - until recently.  In September, the author <i>pbapply</i> added support for clusters in a simple network (snow-type ‚Äî Simple Network Of Workstations ‚Äî simple network of workstations) and multi-core branching to his package.  But this approach involves the separation of elements into parts and the consistent application of <i>mcapply</i> to them.  One of the drawbacks of this approach is that if the number of elements greatly exceeds the number of cores, you need to call <i>mcapply</i> many times.  The <i>mcapply</i> calls built on Unix / Linux <i>fork () are</i> very expensive: branching into many child processes takes time and too much memory. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/347/5f5/19a/3475f519a8454cde8cba0cd6319d49f3.gif"></div><br>  <i>Note that pbapply generates many child processes, and pbmcapply re-uses them where possible.</i>  <i>For pbapply / pbmcapply 4 cores are allocated.</i>  <i>The code for R can be downloaded <a href="https://gist.github.com/kvnkuang/884ac81f5e7d0ff3e262216a230bdc61">from here</a> .</i> <br><br><h2>  Pbmcapply </h2><br>  <i>Pbmcapply</i> - my own solution to the problem.  It is available through the <a href="https://cran.r-project.org/package%3Dpbmcapply">CRAN</a> package, and is easy to use: <br><br><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta">#  pbmcapply install.packages(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"pbmcapply"</span></span></span><span class="hljs-meta">)</span></span></code> </pre> <br>  As the name implies, I was inspired by the <i>pbapply</i> package.  Unlike <i>pbapply</i> , my solution does not involve many calls to <i>mcapply</i> .  <i>Pbmcapply</i> uses the <i>future</i> package instead. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/cf5/406/deb/cf5406deb5ca415ba6a35e24a5a31f7d.jpeg"></div><br>  <i>Pbmcapply schema.</i>  <i>FutureCall () is executed in a separate process, which then forks into a specified number of children.</i>  <i>Child processes periodically transmit information about their progress through progressMonitor.</i>  <i>As soon as progressMonitor receives data, it displays the status on the standard output device.</i> <br><br>  In computer science, future denotes an object that will later contain a value.  This allows the program to execute some code as future and, without waiting for the output, go to the next step.  In <i>pbmcapply, mcapply</i> can be placed in the future.  Future will periodically provide information about its state to the main program, which, in turn, will display a status indicator. <br><br>  Since the <i>pbmcapply</i> resource costs are minimal and nonlinear, we get a significant performance improvement when the number of elements greatly exceeds the number of processor cores.  As an illustration, single- and multi-threaded apply-functions are used in R. Obviously, even with <i>pbmcapply</i> , performance suffers, since it takes time to start the monitoring process. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4a4/ca2/ebf/4a4ca2ebf34148e68335fc25b716fb28.png"></div><br>  <i>Performance comparison pbapply and pbmcapply.</i>  <i>The code for R can be downloaded <a href="https://gist.github.com/kvnkuang/dfb7c441ccb141f7e2aa38c85b53c11b">from here</a> .</i>  <i>The left panel shows the cost of resources when calling each of the packages.</i>  <i>The right panel shows the time for each call.</i> <br><br>  Everything has its price.  While enjoying the convenience of interactive state tracking, remember this slows down the program a bit. <br><br><h2>  Conclusion </h2><br>  As always, there is no universal solution.  If your main priority is performance (for example, when you run a program in a cluster), perhaps the best way to track progress is <i><b>print</b></i> .  However, if the extra few seconds do not solve anything, please use my solution ( <a href="https://cran.r-project.org/package%3Dpbmcapply">pbmcapply</a> ) or <a href="https://cran.r-project.org/package%3Dpbapply">pbapply</a> to make your program more convenient. <br><br><h4>  Links </h4><br>  Myers, BA (1985).  For computer-human interfaces.  In ACM SIGCHI Bulletin (Vol. 16, No. 4, pp. 11‚Äì17).  ACM. </div><p>Source: <a href="https://habr.com/ru/post/317314/">https://habr.com/ru/post/317314/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317300/index.html">In C ++ 17, there are still no normal multidimensional arrays that have been in Fortran since Fortran 90</a></li>
<li><a href="../317302/index.html">List of material classes Material Design Lite</a></li>
<li><a href="../317304/index.html">Classic parser combinators in Python</a></li>
<li><a href="../317306/index.html">Breaking the admin panel of the router</a></li>
<li><a href="../317312/index.html">The perfect programmer. Part 1</a></li>
<li><a href="../317318/index.html">Creating a website as a product or "why is it so expensive?"</a></li>
<li><a href="../317320/index.html">The study of connectivity in the brain based on electrophysiological data. Lecture in Yandex</a></li>
<li><a href="../317322/index.html">Pentest at Global Data Security - passing the 10th Pentestit Lab</a></li>
<li><a href="../317326/index.html">Ruby code coverage analysis</a></li>
<li><a href="../317328/index.html">Performance comparison of GPU calculations in Python and C</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>