<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using procedures and functions in Delphi</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sooner or later, any programmer is consumed using procedures and functions. We all remember from Pascal that there is nothing complicated there, but s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using procedures and functions in Delphi</h1><div class="post__text post__text-html js-mediator-article">  Sooner or later, any programmer is consumed using procedures and functions.  We all remember from Pascal that there is nothing complicated there, but some things are usually not described in books, although it is required to know in order to write a program correctly. <br><a name="habracut"></a><br><h4>  Parentheses </h4><br>  Adding parentheses when calling procedures and functions without parameters is no longer a novelty in Delphi, however, this feature is little known.  This opportunity will be appreciated by those programmers who have to work in two languages ‚Äã‚Äã(C ++ and Delphi), since they will not need to constantly remember the difference in syntax when calling procedures and functions in different languages.  In Delphi, both of the options below are considered valid. <br><br> <code>Form1.Show; <br> Form1.Show();</code> <br> <br><h4>  Overload capability </h4><br>  For the first time, the concept of overloading procedures and functions was implemented in Delphi 4. It allows you to have several different procedures and functions with the same name, but with different lists of parameters.  Such procedures and functions should be described using the overload directive. <br><br> <code>procedure Test (I: integer); overload; <br> procedure Test (S: string); overload; <br> procedure Test (D: double); overload;</code> <br> <br>  When you call the Test procedure, Delphi will decide which of the three procedures to perform, depending on the parameter passed to it.  But it should be noted that this is not the safest language option.  The use of overloaded procedures and functions can be an inexhaustible source of subtle errors in the program.  Therefore, use this opportunity carefully. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Parameter passing </h4><br>  Pascal allows you to pass parameters to functions and procedures, either by value or by reference.  The passed parameter can be of any built-in or user-defined type or be an open array.  A parameter can also be a constant if its value in a procedure or function does not change. <br><br><h5>  Passing parameters by value </h5><br>  This parameter transfer mode is the default.  If the parameter is passed by value, a local copy of this variable is created, which is provided for processing into a procedure or function.  Look at the following example: <br><br> <code>procedure Test(s: string);</code> <br> <br>  When calling this procedure, a copy will be created of the string s transmitted to it as a parameter, with which the Test procedure will work.  In this case, all changes made to the string will not affect the initial variable s. <br><br>  However, this does not apply to objects.  For example, if a variable (or rather, an object instance) of TStringList is passed to the function, then in this case, a reference will be sent (even if this is not explicitly indicated).  This method of transmission is the most favorite among most, but at the same time it is also the most unpractical, since  to execute the method, additional memory is allocated to create an exact copy of the variable passed.  To solve this problem, use one of the methods described below. <br><br><h5>  Passing parameters by reference </h5><br>  Pascal also allows you to pass parameters to functions or procedures by reference - such parameters are called variable parameters.  Passing a parameter by reference means that the function or procedure can change the values ‚Äã‚Äãof the parameters obtained.  To pass parameters by reference, the var keyword is used, which is placed in the parameter list of the called procedure or function. <br><br> <code>procedure ChangeMe(var x: longint); <br> begin <br> x := 2; //      <br> end;</code> <br> <br>  Instead of creating a copy of the variable x, the var keyword requires passing the address of the variable x itself, which allows the procedure to directly change its value. <br><br><h5>  Passing Constant Parameters </h5><br>  If there is no need to change the data passed to the function or procedure, you can describe the parameter as a constant.  The const keyword not only protects the parameter from being modified, but also allows the compiler to generate a more optimal code for passing strings and records.  Here is an example of a constant parameter declaration: <br><br> <code>procedure Test(const s: string );</code> <br> <br><h5>  Passing open arrays </h5><br>  An open array of parameters allows you to transfer a different number of parameters to a function or procedure.  As parameters, you can pass either an open array of elements of the same type, or arrays of constants of various types.  In the example below, a function is declared, to which an open array of integers should be passed as a parameter. <br><br> <code>function AddEmUp(A: array of integer): integer;</code> <br> <br>  In an open array, you can pass variables, constants, or expressions from constants. <br><br>  You can use the High, Low, and SizeOf functions to get information about the actual array of parameters in a function or procedure. <br><br>  Object Pascal also supports the type of array of const, which allows you to transfer data of different types in one array.  The syntax for declaring functions or procedures using such an array to get parameters is as follows: <br><br> <code>procedure WhatHaveIGot( A: array of const );</code> <br> <br>  You can call the function declared above, for example, using the following operator: <br><br> <code>procedure WhatHaveIGot( ['Text', 10, 5.5, @WhatHaveIGot, 3.14, true, 'c'] );</code> <br> <br>  When passing a function or procedure to an array of constants, all the parameters passed to the compiler implicitly convert to the type TVarRec.  The TVarRec data type is declared in the System module as follows: <br><br> <code>PVarRec = ^TVarRec; <br> TVarRec = record <br> case Byte of <br> vtInteger: (VInteger: Integer; VType: Byte); <br> vtBoolean: (VBoolean: Boolean); <br> vtChar: (VChar: Char); <br> vtExtended: (VExtended: PExtended); <br> vtString: (VString: PShortString); <br> vtPointer: (VPointer: Pointer); <br> vtPChar: (VPChar: PChar); <br> vtObject: (VObject: TObject); <br> vtClass: (VClass: TClass); <br> vtWideChar: (VWideChar: WideChar); <br> vtPWideChar: (VPWideChar: PWideChar); <br> vtAnsiString: (VAnsiString: Pointer); <br> vtCurrency: (VCurrency: PCurrency); <br> vtVariant: (VVariant: PVariant); <br> vtInterface: (VInterface: Pointer); <br> vtWideString: (VWideString: Pointer); <br> vtInt64: (VInt64: PInt64); <br> end;</code> <br> <br>  The VType field defines the type of data contained in this instance of the TVarRec record and can take one of the given values. <br><br>  Since an array of constants is capable of transferring data of different types, this can cause certain difficulties in creating a function or procedure that processes the received parameters.  As an example of working with such an array, consider the implementation of the WhatHaveIGot procedure, which looks at the elements of the resulting array of parameters and displays their type. <br><br> <code>procedure WhatHaveIGot( A: array of const ); <br> var <br> i: integer; <br> TypeStr: string; <br> begin <br> for i := Low(A) to High(A) do <br> begin <br> case A[i].VType of <br> vtInteger : TypeStr := 'Integer'; <br> vtBoolean : TypeStr := 'Boolean'; <br> vtChar : TypeStr := 'Char'; <br> vtExtended : TypeStr := 'Extended'; <br> vtString : TypeStr := 'String'; <br> vtPointer : TypeStr := 'Pointer'; <br> vtPChar : TypeStr := 'PChar'; <br> vtObject : TypeStr := 'Object'; <br> vtClass : TypeStr := 'Class'; <br> vtWideChar : TypeStr := 'WideChar'; <br> vtPWideChar : TypeStr := 'PWideChar'; <br> vtAnsiString : TypeStr := 'AnsiString'; <br> vtCurrency : TypeStr := 'Currency'; <br> vtVariant : TypeStr := 'Variant'; <br> vtInterface : TypeStr := 'Interface'; <br> vtWideString : TypeStr := 'WideString'; <br> vtInt64 : TypeStr := 'Int64'; <br> end; <br> ShowMessage( Format( 'Array item %d is a %s', [i, TypeStr] ) ); <br> end; <br> end;</code> <br> <br><h4>  Default Parameter Values </h4><br>  In Delphi there is one very useful feature - the use of default parameter values.  It allows you to set the default value of a parameter of a procedure or function.  This value will be used in cases when the procedure or function is called without specifying the value of this parameter.  In the declaration of a procedure or function, the default value of the parameter is indicated after the equal sign following the name of the parameter.  We explain this with the following example: <br><br> <code>procedure HasDefVal( s: string; i: integer = 0 );</code> <br> <br>  Similar declaration means that the HasDefVal procedure can be called in two ways.  In the first case - as usual, with the indication of both parameters: <br><br> <code>procedure HasDefVal( 'Hello', 26 );</code> <br> <br>  In the second case, you can specify only the value of the s parameter, and for the i parameter, use the default value: <br><br> <code>procedure HasDefVal( 'Hello' );</code> <br> <br>  When using the default settings, remember a few of the rules below: <br><ul><li>  Parameters that have default values ‚Äã‚Äãshould be placed at the end of the parameter list.  A parameter without a default value should not appear in the list after a parameter that has a default value. </li><li>  Default values ‚Äã‚Äãcan only be assigned to parameters of ordinary types, pointers or sets. </li><li>  The default value can be transmitted only by value or with the const modifier.  It cannot be a reference or an untyped parameter. </li></ul><br>  One of the important advantages of using the default parameter values ‚Äã‚Äãis the ease of extending the functionality of existing procedures and functions while maintaining backward compatibility.  Suppose a program was launched on the software market, the key element of which is the addition function of two integer values: <br><br> <code>function Add( I1, I2: integer ): integer; <br> begin <br> Result := I1 + I2; <br> end;</code> <br> <br>  Suppose also that studies have shown the feasibility of adding to the program the possibility of adding three numbers.  However, replacing the existing function with the addition function of three numbers will lead to the fact that you will have to forward a lot of text, which will cease to be compiled due to the addition of one more parameter to the function.  However, using default parameter values, the problem is solved easily and simply.  It is enough to change the declaration of the function as shown below. <br><br> <code>function Add( I1, I2: integer; I3: integer = 0 ): integer; <br> begin <br> Result := I1 + I2 + I3; <br> end;</code> <br> <br><h4>  Directive {$ X-} </h4><br>  The {$ X-} directive prohibits calling functions as procedures (ignoring the return result).  By default, this mode is enabled ({$ X +}).  So, remember, the use of the Result variable is unacceptable when the option Extended Syntax is unchecked, located in the Compiler tab of the Project Options dialog box, or when specifying the compiler directive {$ X-}. <br><br>  In each function of the Objecl Pascal language, there is a local variable called Result, designed to accommodate the return value.  In addition, you can also return a value from a function by assigning a value to a variable that has the same name as this function.  This is the standard syntax of the Pascal language, preserved from its previous versions.  When using a variable with its name in the function body, do not forget that there are big differences in the processing of this name - it all depends on where it is located - on the left side of the assignment operator or in any other place of the function text.  If the function name is indicated on the left side of the assignment operator, it is assumed that the return value is assigned by the function.  In all other cases, it is assumed that a recursive call to this function is made. <br><br>  <i>Procedure and function are key concepts in any programming language, without which no serious program can do.</i>  <i>And so it is very important to have a full understanding of the mechanism of their work.</i> </div><p>Source: <a href="https://habr.com/ru/post/122929/">https://habr.com/ru/post/122929/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122923/index.html">Object Representation</a></li>
<li><a href="../122925/index.html">Will United Russia ban outsourcing?</a></li>
<li><a href="../122926/index.html">Oracle. Start</a></li>
<li><a href="../122927/index.html">Generate one-time passwords using a smartphone</a></li>
<li><a href="../122928/index.html">Microsoft patent for listening to VoIP telephony</a></li>
<li><a href="../122930/index.html">It is important for us to know which topics are most relevant, and what you wanted to know, but were afraid to ask:</a></li>
<li><a href="../122931/index.html">Create For Millions - competition for developers and users of mobile applications</a></li>
<li><a href="../122933/index.html">Developing games with Intel: GPA and the first July webinar</a></li>
<li><a href="../122935/index.html">How a bitcoin network will be destroyed (practical tips with examples)</a></li>
<li><a href="../122936/index.html">What do you pay attention when choosing a hosting?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>