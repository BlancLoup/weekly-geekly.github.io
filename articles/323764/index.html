<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Via MVP to VIPER. Part One: MVP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, I published a translation. Why VIPER is a bad choice for your next application . And, as often happens, the opinion of the translator...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Via MVP to VIPER. Part One: MVP</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/8e1/b61/a9b/8e1b61a9b3a64eac8dba26932801c82c.png"></div><br><p>  Not so long ago, I published a translation. <a href="https://habrahabr.ru/post/321370/">Why VIPER is a bad choice for your next application</a> .  And, as often happens, the opinion of the translator did not coincide with the opinion of the author of the original article.  Therefore, in this post I will briefly tell you how I am trying (while still trying to) to introduce <a href="https://www.objc.io/issues/13-architecture/viper/">VIPER</a> into my projects. </p><br><p>  When I started working on my previous project, the team had exactly two point zero mobile developers: one wrote a version for Android, the second for iOS. </p><br><p>  Naturally, the iOS version was created on the classic, recommended by Apple, <a href="https://developer.apple.com/library/content/documentation/General/Conceptual/DevPedia-CocoaCore/MVC.html">MVC</a> pattern. </p><br><p>  I had a View: a "favorite" storyboard, in which there <s>were</s> quite a few <s>over9000</s> screens, and which looked like this: <a name="habracut"></a></p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/356/478/ea7/356478ea7f1e40fea010fb1b6bde0b0b.png"></div><br><p>  I had a model - classes for storing settings, user data, some data that was stored in the internal database. </p><br><p>  And I had a view controller for each screen on a storyboard.  In the view controller, handlers of user actions were to be placed, as well as notifications from the model (data retrieval on demand or data changes).  But in fact, something like this was happening there: </p><br><pre><code class="hljs pgsql">Networking.request(.POST, withURL: serverAddress, andParameters: parameters) { (dictResult, error) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let dictResult = dictResult { // <span class="hljs-keyword"><span class="hljs-keyword">some</span></span> actions <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let rates = dictResult["rates"] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? [AnyObject] { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rate <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rates { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let rateDictionary = rate <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? JSONDictonary { let result = Result(jsonDictionary: rateDictionary) self.resultsArray.append(result) } } } // <span class="hljs-keyword"><span class="hljs-keyword">some</span></span> actions <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let error = error { DispatchQueue.main.async(<span class="hljs-keyword"><span class="hljs-keyword">execute</span></span>: { self.showError(error) }) } } }</code> </pre> <br><p>  In general: I confidently moved from the Model View Controller to the Massive View Controller and had to do something about it. </p><br><p>  I began to study possible architectures for mobile applications, and of course, I immediately liked the <a href="http://clean-swift.com/clean-swift-ios-architecture/">Clean architecture</a> pattern (which is essentially VIPER): </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f30/a82/1b9/f30a821b91f14608a0291d05aaf28d55.png"></div><br><p>  <i>Picture from <a href="https://github.com/strongself/The-Book-of-VIPER">The Book of VIPER</a></i> </p><br><p>  I bravely spent several weekends studying this pattern.  I looked through several video tutorials and wrote quite a few simple application examples on it.  I also found convenient scripts for generating module files, because one module is about a dozen files (protocols, configurators, classes directly, storyboards, unit tests).  But pretty quickly it came to an understanding that if I now try to implant the VIPER ‚Äúhead-on,‚Äù I will lose a lot of time.  After all, with unaccustomed, I will have too much time spent on the correct division of responsibility between all layers.  And I decided to go the way easier and share responsibility gradually. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/21e/32c/8ce/21e32c8cee704d0087148ac2855627f9.jpg"></div><br><blockquote>  <i>And what if I tell you that the UIViewController is a View.</i> </blockquote><p>  That's why I took <a href="https://en.wikipedia.org/wiki/Model%25E2%2580%2593view%25E2%2580%2593presenter">MVP</a> .  The most difficult and at the same time the simplest thing is to understand that the UIViewController belongs to the View layer.  It should work with the UI and only with it: take actions related to the UI from the user (keystrokes, text input, etc.) and change the display of the UI itself.  At first it seemed difficult, but I brought out for myself a few simple rules that help put everything I need into the controller view, and at the same time do not put anything extra there: </p><br><ol><li><p>  All methods and algorithms of the controller view should work with the UI.  If you see some method or piece of code that can work without using UIKit, know: this method / block of code is not the place. </p><br></li><li><p>  For a presenter, everything is exactly the opposite: there should not be a single method for which UIKit is needed.  If such methods are found, you need to carefully study these parts of the code and bring them into the view controller. </p><br></li><li>  The view controller and presenter have protocols for which they are signed, these are their external interfaces.  There are defined methods that can be called from outside.  Therefore, if suddenly, you see a method call from the interface (protocol) of the same view controller in the view controller - this method should not be in the view controller, but in the presenter. </li></ol><br><p>  The transition to MVP taught me the main thing: to share responsibility between entities.  So far, I have only separated the work with UI from everything else, but ahead, VIPER is still waiting for me.  Perhaps classic, and possibly more multi-layered. </p><br><p>  I hope that soon I will get to him and continue my story. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/323764/">https://habr.com/ru/post/323764/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323752/index.html">Holographic displays: then and now</a></li>
<li><a href="../323754/index.html">3CX technical support responds: Plug and Play auto-tuning of IP phones does not work</a></li>
<li><a href="../323756/index.html">How to get the maximum discount when buying IT equipment</a></li>
<li><a href="../323760/index.html">Invisible friends of your github repository</a></li>
<li><a href="../323762/index.html">Internet of Things in archeology</a></li>
<li><a href="../323766/index.html">7 strategies to help you get rid of procrastination</a></li>
<li><a href="../323768/index.html">How IT professionals work. Pavel Klepinin, IT Director, NIPIGAZ Center</a></li>
<li><a href="../323770/index.html">Fast factorial calculation - PrimeSwing</a></li>
<li><a href="../323772/index.html">Do you still have a chance to achieve success</a></li>
<li><a href="../323774/index.html">Big interview: how to enter ITMO University</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>