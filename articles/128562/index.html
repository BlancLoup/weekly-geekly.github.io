<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HowTo: How to make Django friends with WebSocket (socket.io, sockjs)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Version: 0.2 

 I have a need for an atomic update in real time of the page for a certain number of users depending on the actions of other users (not...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HowTo: How to make Django friends with WebSocket (socket.io, sockjs)</h1><div class="post__text post__text-html js-mediator-article">  <b>Version: 0.2</b> <br><br>  I have a need for an atomic update in real time of the page for a certain number of users depending on the actions of other users (not <s>herbalife</s> chat).  Understandably, you can throw everything in the trash and, <b>like a young man</b> , <b>gash</b> from scratch to <b>tornado / twisted.web</b> , but obviously not the most productive way (and I am not a broker even once) when everything you need is already working on <b>Django</b> and you need just a little bit ... Naturally, in its essence, <b>WebSocket is</b> asking here.  And all would be nothing but Django <b>WSGI</b> application, and this standard does not imply such frills even close (yet).  Googling of the Internet put, once again, on the <a href="http://kmike.ru/files/django-realtime.pdf">work of the</a> famous python-guru <a href="https://habrahabr.ru/users/kmike/" class="user_link">kmike</a> (this is without sarcasm, because his work helped me personally more than once, for which my deepest bow to him!). <br><br>  So, if you want to cross your Django project with a websocket using the <b>js</b> library <b>socket.io</b> or <b>sockjs</b> - wilcomman! <br><a name="habracut"></a><br><h4>  About update </h4><br>  The first version of the article was devoted only to the variant with Socket.io.  In the process of work, there was a strange feeling that the library does not always determine the fallen connection.  Those.  when dumping the socket for a long time, she did not try to cling back.  I fully admit that I myself did something wrong.  In the comments to the first version of the article, people recommended <b>sockjs</b> (on their own initiative, because eventually they switched to it) and I decided to check this option.  As a result, either he keeps the connection with all his teeth, but from the server side a strange situation has arisen when he stops responding (also most likely due to our fault, but the reason is still in the process of finding out).  In any case, I decided to add an article for completeness (not without the urgent request of a friend from GooglePlus).  In general, I leave the choice of implementation for you. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Introduction </h4><br>  I have long wanted to try something asynchronous, but everything was not a good reason, There was a need, and where it was completely unclear from where to start.  Actually here I will try to create this most relevant (I myself have taken the above-mentioned document as the starting point, but it is quite old and some improvements have already appeared) the starting point for the start.  There will be a familiar island of Django to which I will show how to let out a fresh breeze ... <br><br>  By the way, from the work of <b>kmike, a</b> couple of functions are used without changes, I hope the author does not mind. <br><br><h4>  What we get </h4><br>  As a result, we will get an asynchronous service that runs next to the main django site, knows which django user sends / receives requests, and [service] can receive commands from django, performing some actions based on them in the user's browser. <br><br><h4>  Example </h4><br>  Take for example the hypothetical exchange.  She has moderators and clients.  Everything worked fine for you and it was necessary to give the moderators the opportunity to see changes in positions on the exchange in real time.  In this case, the moderators can somehow operate with positions on the exchange and you can not just reload the page. <br><br>  Before that, you have all together <b>F5</b> sausages ... And, in general, <b>highload</b> , as such, we are not particularly interested. <br><br><h4>  Instruments </h4><br>  For the work we need: <br><pre><code class="bash hljs">pip install redis tornado-redis  pip install tornadio2  pip install sockjs-tornado     .</code> </pre> <br>  As well as the library <a href="">socket.io</a> or <a href="">sockjs</a> <br><br><h4>  Theory </h4><br>  To work with socket.io, we will use the <b>tornadio2</b> library, and for sockjs, <b>sockjs-tornado,</b> which are naturally based on the asynchronous tornado framework.  This business will be <b>started</b> as <b>manage</b> command django (hello <b>supervisor</b> ).  There are no special problems with the execution of Djangovsky when there is no tornadio, but in return we have a small gag, which is solved by the <a href="http://en.wikipedia.org/wiki/Publish%25E2%2580%2593subscribe_pattern">PubSub</a> capabilities of <b>Redis</b> (in short, these are channels or message queues to which the <b>publisher</b> 's push messages, and the <b>subscriber</b> ' s receive them). <br><br><h4>  Excuse </h4><br>  In the course of the play, an attentive reader may notice inconsistencies, such as using django functions that are inherently synchronous, but this is a small sacrifice for the sake of rapid development.  In addition, speech about hayload initially does not go well, and this is not a comprehensive solution, but a starting point.  So I am leaving you to have fun with the nuances of your implementation and the bottlenecks of your code, for which I beg you to forgive me generously ... <br><br>  Also see the <b>kmike</b> excuses in the document I refer to all the time. <br><br><h4>  Practice </h4><br>  The practice will be practical, because there are many explanations in the comments in the source code. <br><br><h5>  service.py </h5><br>  Actually the service itself, which will maintain connections with the browser, receive commands from django, sending them to clients (and similarly in the opposite direction). <br><br>  The <code>on_message</code> method <code>on_message</code> mandatory for implementation, but in the example above, it is not needed, because  everything is implemented on a newfangled event model (for socket.io). <br><br><h6>  Implementation for socket.io </h6><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- import tornado import tornadoredis from tornadio2 import SocketConnection from tornadio2.conn import event import django from django.utils.importlib import import_module from django.conf import settings from django.utils import simplejson # start of kmike's sources _engine = import_module(settings.SESSION_ENGINE) def get_session(session_key): return _engine.SessionStore(session_key) def get_user(session): class Dummy(object): pass django_request = Dummy() django_request.session = session return django.contrib.auth.get_user(django_request) # end of kmike's sources #     redis     django ORDERS_REDIS_HOST = getattr(settings, 'ORDERS_REDIS_HOST', 'localhost') ORDERS_REDIS_PORT = getattr(settings, 'ORDERS_REDIS_PORT', 6379) ORDERS_REDIS_PASSWORD = getattr(settings, 'ORDERS_REDIS_PASSWORD', None) ORDERS_REDIS_DB = getattr(settings, 'ORDERS_REDIS_DB', None) #   unjson = simplejson.loads json = simplejson.dumps class Connection(SocketConnection): def __init__(self, *args, **kwargs): super(Connection, self).__init__(*args, **kwargs) self.listen_redis() @tornado.gen.engine def listen_redis(self): """     . """ self.redis_client = tornadoredis.Client( host=ORDERS_REDIS_HOST, port=ORDERS_REDIS_PORT, password=ORDERS_REDIS_PASSWORD, selected_db=ORDERS_REDIS_DB ) self.redis_client.connect() yield tornado.gen.Task(self.redis_client.subscribe, [ 'order_lock', 'order_done' ]) self.redis_client.listen(self.on_redis_queue) #    #  self.on_redis_queue def on_open(self, info): """   django. """ self.django_session = get_session(info.get_cookie('sessionid').value) @event # ,    def login(self): """      """ #      ,      on_open self.user = get_user(self.django_session) self.is_client = self.user.has_perm('order.lock') self.is_moder = self.user.has_perm('order.delete') def on_message(self): """  . """ pass def on_redis_queue(self, message): """     """ if message.kind == 'message': #      , #  ,     message_body = unjson(message.body) #  ,   #      JSON #        if message.channel == 'order_lock': self.on_lock(message_body) if message.channel == 'order_done: self.on_done(message_body) def on_lock(self, message): """   """ if message['user'] != self.user.pk: # -       self.emit('lock', message) def on_done(self, message): """   """ if message['user'] != self.user.pk: if self.is_client: message['action'] = 'hide' else: message['action'] = 'highlight' self.emit('done', message) def on_close(self): """       """ self.redis_client.unsubscribe([ 'order_lock', 'order_done' ]) self.redis_client.disconnect()</span></span></code> </pre><br><h6>  Implementation for sockjs </h6><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- import tornado import tornadoredis from sockjs.tornado import SockJSConnection import django from django.utils.importlib import import_module from django.conf import settings from django.utils import simplejson # start of kmike's sources _engine = import_module(settings.SESSION_ENGINE) def get_session(session_key): return _engine.SessionStore(session_key) def get_user(session): class Dummy(object): pass django_request = Dummy() django_request.session = session return django.contrib.auth.get_user(django_request) # end of kmike's sources #     redis     django ORDERS_REDIS_HOST = getattr(settings, 'ORDERS_REDIS_HOST', 'localhost') ORDERS_REDIS_PORT = getattr(settings, 'ORDERS_REDIS_PORT', 6379) ORDERS_REDIS_PASSWORD = getattr(settings, 'ORDERS_REDIS_PASSWORD', None) ORDERS_REDIS_DB = getattr(settings, 'ORDERS_REDIS_DB', None) #   unjson = simplejson.loads json = simplejson.dumps class Connection(SocketConnection): def __init__(self, *args, **kwargs): super(Connection, self).__init__(*args, **kwargs) self.listen_redis() @tornado.gen.engine def listen_redis(self): """     . """ self.redis_client = tornadoredis.Client( host=ORDERS_REDIS_HOST, port=ORDERS_REDIS_PORT, password=ORDERS_REDIS_PASSWORD, selected_db=ORDERS_REDIS_DB ) self.redis_client.connect() yield tornado.gen.Task(self.redis_client.subscribe, [ 'order_lock', 'order_done' ]) self.redis_client.listen(self.on_redis_queue) #    #  self.on_redis_queue def send(self, msg_type, message): """  . """ return super(Connection, self).send({ 'type': msg_type, 'data': message, }) def on_open(self, info): """   django. """ self.django_session = get_session(info.get_cookie('sessionid').value) self.user = get_user(self.django_session) self.is_client = self.user.has_perm('order.lock') self.is_moder = self.user.has_perm('order.delete') def on_message(self): """  . """ pass def on_redis_queue(self, message): """     """ if message.kind == 'message': #      , #  ,     message_body = unjson(message.body) #  ,   #      JSON #        if message.channel == 'order_lock': self.on_lock(message_body) if message.channel == 'order_done: self.on_done(message_body) def on_lock(self, message): """   """ if message['user'] != self.user.pk: # -       self.send('lock', message) def on_done(self, message): """   """ if message['user'] != self.user.pk: if self.is_client: message['action'] = 'hide' else: message['action'] = 'highlight' self.send('done', message) def on_close(self): """       """ self.redis_client.unsubscribe([ 'order_lock', 'order_done' ]) self.redis_client.disconnect()</span></span></code> </pre><br><h5>  models.py </h5><br>  Source of change.  Let it be a model. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- import redis from django.conf import settings from django.db import models ORDERS_FREE_LOCK_TIME = getattr(settings, 'ORDERS_FREE_LOCK_TIME', 0) ORDERS_REDIS_HOST = getattr(settings, 'ORDERS_REDIS_HOST', 'localhost') ORDERS_REDIS_PORT = getattr(settings, 'ORDERS_REDIS_PORT', 6379) ORDERS_REDIS_PASSWORD = getattr(settings, 'ORDERS_REDIS_PASSWORD', None) ORDERS_REDIS_DB = getattr(settings, 'ORDERS_REDIS_DB', 0) #   service_queue = redis.StrictRedis( host=ORDERS_REDIS_HOST, port=ORDERS_REDIS_PORT, db=ORDERS_REDIS_DB, password=ORDERS_REDIS_PASSWORD ).publish json = simplejson.dumps class Order(models.Model) ‚Ä¶ def lock(self): """   """ ‚Ä¶ service_queue('order_lock', json({ 'user': self.client.pk, 'order': self.pk, })) def done(self): """   """ ‚Ä¶ service_queue('order_done', json({ 'user': self.client.pk, 'order': self.pk, }))</span></span></code> </pre><br>  Actually here the <code>lock</code> and <code>done</code> methods after executing some business logic send messages with the necessary information.  This information will be obtained by the above service, processed and sent to client browsers. <br><br>  Those.  The action was performed by the user according to the standard scheme: he clicked the link / pressed the button, django completed the necessary actions, sent a notification to the channel for sending via the websocket and returned the classic answer to the user. <br><br><h5>  client.js </h5><br>  Do not forget to load in html <b>socket.io.js</b> or <b>sockjs.js</b> depending on your choice (links at the beginning of the article)! <br><br>  Actually, the apofigy of all this action is work on the client side. <br><br><h6>  Implementation for socket.io </h6><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> socket = io.connect(<span class="hljs-string"><span class="hljs-string">'http://'</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.host + <span class="hljs-string"><span class="hljs-string">':8989'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      //     login,       socket.on('connect', function(){ socket.emit('login'); }); //   -    socket.on('disconnect', function() { setTimeout(socket.socket.reconnect, 5000); }); //    "lock"  "ws_order_lock"       socket.on('lock', function(msg){ ws_order_lock(msg); }); socket.on('done', function(msg){ ws_order_done(msg); }); function ws_order_lock(msg){ if (msg.action == 'highlight'){ $('.id_order_row__' + msg.order).addClass('order-row_is_locked'); }else{ $('.id_info_renew_orders').addClass('hidden'); } } ‚Ä¶</span></span></code> </pre><br><h6>  Implementation for sockjs </h6><br><pre> <code class="javascript hljs">socket_connect(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">socket_connect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ socket = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SockJS(<span class="hljs-string"><span class="hljs-string">'http://'</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.host + <span class="hljs-string"><span class="hljs-string">':8989/orders'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      //     login,       socket.onmessage = function(msg){ window['ws_order_' + msg.data.type](msg.data.data); // ,      } socket.onclose = function(e){ setTimeout(socket_connect, 5000); }; } function ws_order_lock(msg){ if (msg.action == 'highlight'){ $('.id_order_row__' + msg.order).addClass('order-row_is_locked'); }else{ $('.id_info_renew_orders').addClass('hidden'); } } ‚Ä¶</span></span></code> </pre><br><h5>  async_server.py </h5><br>  This <b>manage</b> command, the file must be placed in the <code>myProject/orderApp/management/commands</code> folder. Also, do not forget, in each of the subfolders, the <code>__init__.py</code> file. <br><br><h6>  Implementation for socket.io </h6><br><pre> <code class="javascript hljs"># -*- coding: utf<span class="hljs-number"><span class="hljs-number">-8</span></span> -*- <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tornado <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tornadio2 <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tornadio <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.core.management.base <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> NoArgsCommand <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> myProject.order.tornado.service <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Connection <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Command</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NoArgsCommand</span></span></span><span class="hljs-class">): </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">handle_noargs</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">, **</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">options</span></span></span><span class="hljs-class">): </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">router</span></span></span><span class="hljs-class"> </span></span>= tornadio.TornadioRouter(Connection) app = tornado.web.Application(router.urls, socket_io_port=<span class="hljs-number"><span class="hljs-number">8989</span></span>) #      tornadio.SocketServer(app)</code> </pre><br><h6>  Implementation for sockjs </h6><br><pre> <code class="javascript hljs"># -*- coding: utf<span class="hljs-number"><span class="hljs-number">-8</span></span> -*- <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tornado <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tornadio2 <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tornadio <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.core.management.base <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> NoArgsCommand <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> myProject.order.tornado.service <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Connection <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Command</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NoArgsCommand</span></span></span><span class="hljs-class">): </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">handle_noargs</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">, **</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">options</span></span></span><span class="hljs-class">): </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">router</span></span></span><span class="hljs-class"> </span></span>= SockJSRouter(Connection, <span class="hljs-string"><span class="hljs-string">'/orders'</span></span>) # sockjs      :( app = tornado.web.Application(router.urls) app.listen(<span class="hljs-number"><span class="hljs-number">8989</span></span>) tornado.ioloop.IOLoop.instance().start()</code> </pre><br><br>  Now you can start the <code>python manage.py async_server</code> . </div><p>Source: <a href="https://habr.com/ru/post/128562/">https://habr.com/ru/post/128562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128555/index.html">Analysis of the malware for Android on the example of Trojan-Spy.AndroidOS.Zbot.a / Android.Smssniffer / Android / SpySMS / AndroidOS_SMSREP.B</a></li>
<li><a href="../128556/index.html">The secret of object-oriented development in Rails</a></li>
<li><a href="../128557/index.html">Using Ext JS 4 widgets within the Ext JS 3 interface</a></li>
<li><a href="../128558/index.html">Clonezilla Server - backup 100 PCs at night is no longer a problem</a></li>
<li><a href="../128560/index.html">How do you store work documents and files?</a></li>
<li><a href="../128563/index.html">A second video editor was built into Youtube</a></li>
<li><a href="../128564/index.html">Contactless payments: put the phone to the turnstile - and you're on the subway!</a></li>
<li><a href="../128569/index.html">About IT in Azerbaijan</a></li>
<li><a href="../128570/index.html">Mebromi: new BIOS rootkit</a></li>
<li><a href="../128573/index.html">Canobuvosti, 109th edition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>