<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Code Conventions: how we maintain the fast pace of developing a PHP project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr. My name is Evgeny Udodov, I am a co-founder and technical director of Roistat. I want to share our experience in developing a large and comp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Code Conventions: how we maintain the fast pace of developing a PHP project</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr.  My name is Evgeny Udodov, I am a co-founder and technical director of Roistat.  I want to share our experience in developing a large and complex product - analytics systems. <br><br>  <b>TL; DR</b> : We put <a href="https://github.com/roistat/php-code-conventions">our Code Conventions</a> on github and talked in the article about how to use it in practice. <br><br>  When developing large products, there is a common problem - over time, a lot of legacy code accumulates, tasks become slower and slower.  Also, as the team grows, developers start writing code in different ways and the lack of uniform rules can lead to conflicts and disputes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Over the 4 years of our project‚Äôs existence, we have made more than 20,000 Pull Requests (hereinafter referred to as PR) and under the cat I will tell you how we solved these problems. <br><br><img src="https://habrastorage.org/webt/6u/bk/39/6ubk39l-w_kmt3vsm57jtcafwme.png"><br><a name="habracut"></a><br>  I tried to write the most useful article.  It will be interesting to you if you are faced with the problems listed below. <br><br>  If you are a technical director or technical director: <br><br><ul><li>  You have to spend a lot of time to understand what is happening in the unfamiliar project code. <br></li><li>  For each task you have to point developers to the same errors. <br></li><li>  After discussing how to make a feature, the developer does not make the PR as agreed <br></li><li>  After a wrong PR, the developer, correcting some mistakes, makes others <br></li><li>  You spend a lot of time learning each new developer, even if he doesn‚Äôt stay long afterwards <br></li><li>  Senior developers come up with their own rules and impose them on less experienced guys. <br></li></ul><br>  If you are a product manager: <br><br><ul><li>  When discussing each (seemingly not the most difficult) features, the developers tell you that it‚Äôs a long and expensive process. <br></li><li>  You roughly understand the principles of programming, but you don‚Äôt understand anything in the code of your project <br></li><li>  You have to wait a long time for new developers to get up to speed before they can perform complex tasks. <br></li></ul><br><h2>  Start </h2><br>  At the beginning of 2014, only 2-3 developers worked at Roistat, but the first problems started already then.  We are faced with the fact that every developer needs to explain the same mistakes.  And with the growing number of developers, this situation has only worsened. <br><br>  Also with experienced developers there was another difficulty.  They each had their own accumulated experience and their own understanding of how to build the project architecture.  Very often, their opinions contradicted each other. <br><br>  Similar problems accumulated like a snowball.  It was clear that if this continues, development will lose speed, flexibility, and each release will be given through pain. <br><br><h2>  Search solutions </h2><br>  First, we discussed the problem areas and agreed in words about how we would act in such cases in the future.  Naturally, this did not work.  After some time, everyone had a different idea of ‚Äã‚Äãwhat we agreed on earlier.  Also about these agreements did not know the new developers. <br><br>  Then we thought: "How to fix this information for all in the same form?".  We tried to record instructional videos in which we talked about the architecture of the project and the basic principles of our development.  But this format was very inconvenient.  Video is difficult to correct or re-record.  During the active growth of the project, new situations and new problems constantly arise, which require either new arrangements or changes to old ones. <br><br>  Then we began to record the results of our discussions in a separate document.  At the start it was just a few suggestions.  But we agreed that developers should not impose their personal opinion on the code on the Code Review.  Instead, they should refer to this document and indicate inconsistencies with it.  If there is no necessary rule in it, then we must first discuss the problem, jointly work out a solution, write it into the document and then return and continue the Code Review. <br><br>  And it worked.  Problems with a different understanding of the agreements began to be reduced to a minimum.  In the document we wrote detailed explanations with code examples so that no one could interpret them differently.  Each new developer in our team could immediately understand what was required of him and how it is customary for us to act in different situations.  Code Review instead of endless discussions and disputes turned into a fairly transparent and pragmatic process. <br><br>  After half a year of work, this document already contained a lot of useful information and became an indispensable tool in the work of the team.  We called it Code Conventions (or Code Conv for short). <br><br><h2>  Code Conventions </h2><br>  Code Conv - these are the rules that must be followed when writing code.  We distinguish between Code Style and Code Conv.  For us, Code Style is the look of the code.  That is, the placement of indents, commas, brackets and other things.  And Code Conv is the semantic content of the code.  The correct action algorithms, the correct names of variables and methods, the correct composition of the code.  Compliance with the Code Style is easily verified by automatics.  But in most cases only a person can verify compliance with the Code Conv. <br><br>  We take the following approach when using Code Conv. <br><br>  For developer: <br><br><ul><li>  The developer studies this document before writing the first line of code in our team. <br></li><li>  The developer must understand and understand the written rules.  Just learn this document will not work. <br></li><li>  The developer strictly observes the rules of Code Conv when writing code. <br></li><li>  The developer creates a PR and immediately looks at it himself and checks for compliance with the Code Conv <br></li><li>  Developer submits PR to Code Review and corrects errors and inconsistencies of Code Conv, which are indicated to him and which he missed. <br></li></ul><br><br>  For Code Reviewer: <br><br><ul><li>  The reviewer checks the code for compliance with the rules described in Code Conv <br></li></ul><br><ul><li>  If a comment appears to the developer during Code Review, then it should be accompanied by a link to Code Conv. <br></li><li>  If the Code Conv does not have the required item, then a working group is assembled that generates a new rule and fixes it in the document.  After this, the reviewer returns to the PR check. <br></li></ul><br><br><h2>  Few examples </h2><br>  In order to make it clearer what I am talking about, here are some examples of how this document looks in reality. <br><br>  There is a table of contents at the beginning of the document.  Over time, information becomes more and without a table of contents - nowhere. <br><br>  We have 3 main sections: values, general principles and specific rules. <br><br>  Values ‚Äã‚Äãare the business requirements of the development team.  The business does not know the details of which methodologies and principles are used internally, but it is important for it that the product be developed simply, quickly and with time not be complicated.  The whole team should follow these values ‚Äã‚Äãwhen working out new rules and for resolving issues that are not described in the rules. <br><br>  Principles are ways to comply with the values ‚Äã‚Äãdescribed earlier.  They are a little more detailed, contain basic development methodologies and approaches that guide us.  An experienced developer does not have to memorize the entire document.  It is enough for him to understand these principles, and he can deduce all other rules from these principles himself at any moment. <br><br>  But still, values ‚Äã‚Äãand principles can be interpreted in different ways.  To avoid misunderstandings, there are specific rules and code examples in the document, showing how you can do it and how not to <br><br><img src="https://habrastorage.org/webt/5w/xn/6s/5wxn6sy8djsqvcopbdf-rtte4xw.png"><br><br>  There are a lot of such rules and they constitute the bulk of the document.  Thanks to them, the order is respected. <br><br>  In practice, the application of the document is as follows. <br><br>  The developer making the Code Review leaves comments on code sections in which he noted non-compliance with Code Conv.  In the commentary, he indicates which rule is violated.  And optionally, if it is not obvious, adds an explanation why he thinks so. <br><br><img src="https://habrastorage.org/webt/ld/n4/zz/ldn4zz0dz7cjxqko5mydv0fhg-i.png"><br><br>  For example, in this screenshot we see that the DRY principle has been violated (Don't Repeat Yourself).  Despite the fact that in this particular PR the developer wrote the code without repetitions and it would seem that he used it only once, he still created such a method that cannot be used in the future without additional verification.  That is, he created a method that obviously requires repetition of code and logic. <br><br><h2>  Frequent developer objections </h2><br>  Developers often try to push under different pretexts their code that does not comply with Code Conv.  They find all sorts of excuses for their violations, but there are some of the most frequent. <br><br><h3>  "But once you can?" </h3><br>  Developers think that a one-time violation of Code Conv will not do any harm.  They also sometimes believe that in some not very important place these rules do not carry value or are not critical.  In response to this, we always refer to the <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B8%25D1%258F_%25D1%2580%25D0%25B0%25D0%25B7%25D0%25B1%25D0%25B8%25D1%2582%25D1%258B%25D1%2585_%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25BD">theory of broken windows</a> : "If one glass is broken in a building and no one replaces it, then after a while there will not be a single whole window left in this building."  If we make exceptions to the rules, then in six months we will find ourselves in a situation where the entire project code consists of such violations. <br><br><h3>  "But you need a very urgent!" </h3><br>  Developers often say that it will be a long time to do it normally, and the client is waiting for a solution to the problem and the edit should be posted as soon as possible.  But, first, Code Conv does not prohibit anywhere to do the first iterations with a simplified code.  Just this code should still meet the quality standards.  Secondly, if you still need to break the Code Conv, then it is permissible to do this if the entropy created is not malignant (more on this below).  But even in this case, everyone should have a common understanding that following the Code Conv in this situation will indeed be much more expensive. <br><br>  A few words about entropy.  Entropy is the amount of information that a project consists of (the information capacity of a project).  If a developer writes code that adds critical information that every developer must know, then this entropy is malignant.  Often this code is a time bomb.  That is, at the moment this ignorance may not affect anything, and in the future, critical errors may be made because of it.  This entropy we call malignant.  If ignorance of information does not affect the work of other developers, then such entropy is not harmful, and we call it benign. <br><br>  For example, if we are doing a separate microservice that will listen to some events and add statistics somewhere, then this service does not contribute to malignant entropy.  If other developers do not know about this service, they will not make any mistakes, it will not affect their work.  If it breaks, then no one will suffer except the owner of this service.  So for such a service, it is permissible to do the first iteration (as Proof of Concept) with low quality code.  And then, if it is necessary to develop it, then it will be necessary to correct the pledged technical debt and work with it according to all the rules.  As a result, Code Conv does not prohibit experimenting and making quick and easy concepts, if it does not affect the rest of the system. <br><br><h2>  Conclusion </h2><br>  This approach has allowed us to maintain a high rate of development for more than four years, it is easy to introduce new developers into the work and not to slow down over time. <br><br>  Of the minuses it can be noted that with this approach Code Review takes longer than usual.  Even small tasks can be delayed for several days or longer due to not very critical errors. <br><br>  But this minus is overlapped by pluses, since the malignant code does not get into the battle and all the ‚Äúwindows‚Äù remain intact. <br><br>  We were repeatedly asked to share an example of Code Conv. <br>  We decided to share with everyone and make it public.  You can take it as is and use it right away.  Or you can change for yourself.  We are also open to PR and will review your suggestions for improvement. <br><br>  <a href="https://github.com/roistat/php-code-conventions">Link to our Code Conv</a> <br><br>  We are actively expanding the development team, so if you are close to our approach, please respond to <a href="https://moikrug.ru/vacancies/1000041252">our vacancy</a> or write to the <a href="">mail</a> . </div><p>Source: <a href="https://habr.com/ru/post/352762/">https://habr.com/ru/post/352762/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352750/index.html">Cretaceous lettering for dummies on the example of working on an art object</a></li>
<li><a href="../352752/index.html">Procedural worlds from simple tiles</a></li>
<li><a href="../352754/index.html">Introducing Google's S2 Geo-Library and Case Studies</a></li>
<li><a href="../352758/index.html">What is behind the cleanliness in your apartment, or Qlean preparation</a></li>
<li><a href="../352760/index.html">Compare Tarantool with Redis and Memcached</a></li>
<li><a href="../352764/index.html">EGAIS 3.0 or how not to answer for the mistakes of others</a></li>
<li><a href="../352766/index.html">Intelligence networks</a></li>
<li><a href="../352770/index.html">Kubernetes meetup - presentation and webcast</a></li>
<li><a href="../352772/index.html">Announcement of Moscow Spark # 4</a></li>
<li><a href="../352774/index.html">Is there any powder in the old dog? Hackathon Radio Canada 2018 (Part One, We Make a Team)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>