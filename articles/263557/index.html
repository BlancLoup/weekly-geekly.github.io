<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Checklist anonymity check surfing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few days ago on Habr√© slipped a note about the definition of VPN users. In the comments, I posted a link to our service with similar functionality, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Checklist anonymity check surfing</h1><div class="post__text post__text-html js-mediator-article">  A few days ago on Habr√© slipped a <a href="http://habrahabr.ru/post/216295/">note</a> about the definition of VPN users.  In the comments, I posted a link to <a href="http://2ip.ru/privacy/">our service</a> with similar functionality, the writing of which I recently engaged in. <br><br>  The main idea is to determine whether a user is hiding while surfing the net or not, and if possible, find out his real IP address.  There are some interesting pieces that I have never seen anywhere (double-sided ping, matching DNS leak / ISP pairs). <br><br>  I wanted to have on hand a sort of check-list, which would answer, "firing" you or not?  At the moment, the list consists of 12 verification methods, which will be discussed below, including how to avoid them, but first about the simplest in order. <br><a name="habracut"></a><br><h3>  HTTP proxy headers </h3><br>  Some proxies add their headers to the request, which initiates the user's browser.  Often this is the real IP address of the user. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Make sure that if the proxy server writes something to the headers listed below, then at least not your address: <br><br>  HTTP_VIA, HTTP_X_FORWARDED_FOR, HTTP_FORWARDED_FOR, HTTP_X_FORWARDED, APPROACH CORPOS, HTTP Infos <br><br><h3>  Open HTTP proxy ports </h3><br>  The IP address from which the request came to our page can say a lot.  For example, can you see which ports are open on that side? <br><br>  The most interesting ports are 3128, 1080, 8123. If they are not used, then it is quite possible to avoid unreasonable suspicions of using 3proxy, SOCKS 5 or Polipo. <br><br><h3>  Open ports web proxy </h3><br>  As in the case of HTTP, a web proxy can be hung on any port, but we wanted the test to work very quickly, so we restricted ourselves to a reverse connection to ports 80 and 8080. <br><br>  Is it a web page?  Fine!  At the moment, we can determine PHProxy, CGIProxy, Cohula and Glype. <br><br>  Non-standard ports with authorization close the question. <br><br><h3>  Suspicious hostname </h3><br>  Having an IP address, you can try to otrezolvit client hostname.  Stop words that may hint at the tunnel: vpn, hide, hidden, proxy. <br><br>  You should not bind domain names to a personal VPN, and if you do this, you should avoid ‚Äúspeaking‚Äù names. <br><br><h3>  Difference in time zones (browser and IP) </h3><br>  Based on the GeoIP data, you can find out the country by the user's IP, and therefore its time zone.  Then you can calculate the time difference between the browser and the time corresponding to the time zone of the VPN server. <br><br>  There is a difference?  So the user is probably hiding. <br><br>  For Russia, there is no exact latitude and longtitude base for the regions, and since there are many time zones, we don‚Äôt take these addresses into account in the final result.  With European countries, the opposite is true; they burn very well. <br><br>  When switching to VPN, you need to remember to translate the system time, change the time in the browser, or work with Russian proxies. <br><br><h3>  IP belonging to the Tor network </h3><br>  If your IP address is a Tor node from the list <a href="https://check.torproject.org/cgi-bin/TorBulkExitList.py">check.torproject.org/cgi-bin/TorBulkExitList.py</a> , congratulations, you were burned. <br><br>  Nothing criminal, but the fact of disclosing what you are hiding is not very happy. <br><br><h3>  Turbo Browser Mode </h3><br>  By collecting the IP address ranges of Google, Yandex and Opera, and comparing with the user address, you can assume the use of traffic compression services in the browsers of the respective companies. <br><br>  As a rule, such services also merge your real address in the headers.  As a means of anonymization, you should not rely on traffic compression. <br><br><h3>  Definition of web proxy (JS method) </h3><br>  By comparing window.location.hostname with the host of the requested page, you can determine whether the web proxy is used. <br><br>  Web proxies, in principle, are not reliable, so it‚Äôs best to bypass such methods of anonymization altogether. <br><br><h3>  IP leakage via flash </h3><br>  Adobe Flash works very well past user proxies.  By initiating a connection to our server, you can find out the user's IP. <br><br>  You can learn a lot by running a special daemon that logs all incoming connections with tag tags.  The best way not to reveal your address is not to use Adobe Flash at all, or to disable it in the browser settings. <br><br><h3>  Tunnel definition (two-way ping) </h3><br>  By running the ping to the client IP, from our server‚Äôs side, you can find out the approximate length of the route.  The same can be done by the browser, XMLHTTPRequest pulls the blank page of our nginx.  The resulting loop difference of more than 30 ms can be interpreted as a tunnel. <br><br>  Of course, the routes back and forth may vary, or the web server will be a little bit more powerful, but overall, the accuracy is pretty good. <br><br>  The only way to protect yourself is to prohibit ICMP traffic to your VPN server. <br><br><h3>  DNS leak </h3><br>  Finding out what DNS a user is using is not a problem, we wrote our DNS server, which records all calls to our uniquely generated subdomains. <br><br>  The next step was collecting statistics for several million users, who uses which DNS.  We made a binding to providers, rejected public DNS and got a list of DNS / ISP pairs. <br><br>  Now it‚Äôs not at all difficult to find out if a user presents himself as a subscriber of one network, and uses DNS entirely from another. <br><br>  Partially the problem is solved by the use of public DNS services, if this can be called a solution. <br><br><h3>  Leak through VKontakte </h3><br>  This is not an IP address leak, but we still believe that by giving the names of authorized users to everyone to the left and right, VK merges private data that undermines the entire anonymity of surfing. <br><br>  More information can be found here <a href="http://vk.com/dev/openapi">vk.com/dev/openapi</a> .  The "Exit" button after each session generally resolves the issue, but the best recommendation is not to enter :) <br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/263557/">https://habr.com/ru/post/263557/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263547/index.html">Pseudo OOP in C</a></li>
<li><a href="../263549/index.html">Multithreaded SOCKS 4 server on Qt</a></li>
<li><a href="../26355/index.html">Icarus ep</a></li>
<li><a href="../263551/index.html">Quick start with PHPixie 3</a></li>
<li><a href="../263555/index.html">Qucs project news: release candidate available with circuit simulation support in SPICE</a></li>
<li><a href="../26356/index.html">Articles in English.</a></li>
<li><a href="../263561/index.html">The digest of interesting materials for the mobile developer # 113 (July 20-26)</a></li>
<li><a href="../263565/index.html">Magic of tensor algebra: Part 13 - SKA Maxima in problems of transforming tensor expressions. Angular velocity and acceleration in the parameters of Rodrigues-Hamilton</a></li>
<li><a href="../263569/index.html">With LINQ on "Life"</a></li>
<li><a href="../26357/index.html">Articles in English.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>