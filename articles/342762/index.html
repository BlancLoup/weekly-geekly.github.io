<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Chat bot understands human speech at Dialogflow</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to share with you my experience with the Dialogflow service and tell you about some not very obvious things. 

 Dialogflow is a service that al...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">ğŸ”</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">ğŸ“œ</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">â¬†ï¸</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">â¬‡ï¸</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Chat bot understands human speech at Dialogflow</h1><div class="post__text post__text-html js-mediator-article">  <i>I want to share with you my experience with the <a href="https://dialogflow.com/">Dialogflow</a> service and tell you about some not very obvious things.</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/0e8/efb/957/0e8efb957a77b91f24a90e43e4194897.svg" alt="image"><a name="habracut"></a><br>  <a href="https://dialogflow.com/">Dialogflow</a> is a service that allows you to create chat bots for different <a href="https://dialogflow.com/docs/integrations/">platforms</a> and <a href="https://dialogflow.com/docs/reference/language">languages</a> on different <a href="https://dialogflow.com/docs/sdks">devices</a> . <br><br>  The service can be used absolutely free of charge, so we donâ€™t waste time and get down to work. <br><br>  In this article I will tell you how to create a simple bot that will receive an order from your users in your store. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Step 0. Task </h2><br>  A bot should receive a request from the user consisting of three parameters: name, city and address.  In this case, if the user previously mentioned one of these parameters - remember it within the context. <br><br><h2>  Step 1. Initial setup </h2><br>  First you need to register and create a new agent: <br><br><img src="https://habrastorage.org/webt/ca/r_/dv/car_dv7wb5bryxy4cxhszg8bzkq.png"><br><br><ul><li>  The name of the agent can be any. </li><li>  Language, I chose Russian.  But in the future you can add others. </li><li>  The time zone is important, since it will be used to identify phrases like â€œTodayâ€, â€œ3 days agoâ€ </li><li>  Let's create a new Google project </li><li>  I will use the first version of the API </li></ul><br>  After creating the agent, go to the â€œIntegrationsâ€ tab and connect the platforms we need. <br><br><img src="https://habrastorage.org/webt/v-/jt/8l/v-jt8ldqyk7z-clil4ofbrbvubu.png"><br><br>  At this stage, our bot is already running and can communicate with users.  Now you need to teach him to correctly understand the phrase. <br><br><h2>  Step 2. Create appointments </h2><br>  The destination is a handler for a specific request from the user. <br>  Go to the tab "Intents".  After creating the agent, there will be two standard assignments here: <br><br><ol><li>  <b>Default Welcome Intent</b> - launched to greet the user (send a return greeting) </li><li>  <b>Default Fallback Intent</b> - launched if none of the other appointments are appropriate.  Send a message that the user did not understand (â€œThis last phrase is not clear to me,â€ â€œTry, please express your thoughts differently,â€ etc.). </li></ol><br>  Next, we implement the following: when a user greets a bot, he asks him for his name and address of residence in order to use it in the future. <br><br><h3>  Add a user question to the greeting </h3><br>  Open the "Default Welcome Intent".  There are several sections here: <br><br><ul><li>  Contexts </li><li>  User says </li><li>  Events </li><li>  Action </li><li>  Response </li></ul><br>  Pay attention to the â€œEventsâ€ section: here you can see one service event â€œWELCOMEâ€. <br>  <b>The assignment can be launched in two ways: as a reaction to the user's text or upon an event.</b> <br><br>  In our case, the Default Welcome Intent assignment does not respond to any text from the user, but to the WELCOME service event.  For example, for Telegram this is the launch of a bot with the command / start.  <i><a href="https://dialogflow.com/docs/events">Read more about the events</a></i> . <br><br>  So, consider the â€œResponseâ€ section.  Here are the messages that will be sent in response to the user.  Each message can consist of several lines.  Each line - a separate message options.  For the answer one of these options will be selected.  And the more of them, the less often your bot will repeat. <br><br>  Add a message here asking them to tell about themselves. <br><br><img src="https://habrastorage.org/webt/df/6g/_j/df6g_jowq1ncyb-vlx4svstzuzw.png"><br><br><h3>  Response to response </h3><br>  Now create an appointment that will respond to the subsequent message. <br>  On the â€œIntentsâ€ tab, move the cursor to â€œDefault Welcome Intentâ€ and click â€œAdd follow-up intentâ€.  In the drop-down list, we will offer several pre-installed options.  We are not interested in them - choose "Custom" <br><br>  Let's move on to the â€œUser saysâ€ section and add several message options from the user. <br><br>  Now you need to specify what data in these messages we need.  To do this, select a piece of text and select the type of data in the drop-down menu.  Dialogflow has a number of predefined types, in particular for names and addresses.  But you can create your own.  <i>More details</i> . <br><img src="https://habrastorage.org/webt/vd/6n/y-/vd6ny-zwccj9_j3uyujqmgvtvry.png"><br>  Now pay attention to the section "Action".  Here are all the parameters that this assignment collects.  The parameters with which we marked the text messages are automatically imported. <br><br><img src="https://habrastorage.org/webt/wx/cl/fd/wxclfds5514vhgozm-jabkisrvq.png"><br>  Denote the user name as a required parameter.  Change the name of the parameter from â€œgiven-nameâ€ to â€œnameâ€ for more convenience.  And in the column "Prompts" we will indicate the question "What is your name?".  Now, since â€œnameâ€ is a required parameter, in case the message does not contain this parameter, one of the questions in â€œPromptsâ€ will be sent to the user to get the name. <br><br>  And finally, add the answer to the user in the section Â«ResponseÂ». <br><br><img src="https://habrastorage.org/webt/5c/t_/6_/5ct_6_jk32d7t1cgb4hlku-pxo0.png"><br><br><h3>  Work with context </h3><br>  Each assignment can work with the <b>incoming context</b> and <b>create an outgoing</b> context. <br><br>  If the assignment has an incoming context, the assignment will be launched only if that context exists.  If the destination has an outgoing context, it will be created and all collected data will be written to it. <br><br>  Consider in order: <br><br>  <b>Default Welcome Intent</b> - there is no incoming context.  Therefore, the assignment may start for any request.  The assignment creates a new empty context â€œDefaultWelcomeIntent-followupâ€ (automatically added). <br><br>  <b>Default Welcome Intent - custom</b> - has the incoming context "DefaultWelcomeIntent-followup" (added automatically).  This assignment can start only when this context exists (when the user is welcomed).  Outgoing context here is not yet. <br><br>  Add the outgoing context for the â€œDefault Welcome Intent - customâ€ with the name â€œUserDataâ€.  Now, when the user presents himself after the greeting, information about him will be recorded in the new â€œUserDataâ€ context. <br><br><h3>  Ordering by the user </h3><br>  Create a new â€œOrderâ€ destination with the outgoing â€œUserDataâ€ context.  This assignment can be launched at any time, and it can change the â€œUserDataâ€ context. <br>  In the text of the order we need the name, city and address. <br><br>  Add phrases and mark them up.  Duplicate all the parameters, but this time we will mark all as mandatory. <br><br><img src="https://habrastorage.org/webt/uo/la/yy/uolayyacmnno1ivmpvqhdzsd0us.png"><br><br><h3>  Using already known data </h3><br>  Our assignment can work both in case of absence of the â€œUserDataâ€ context, and in case of its presence.  In the first case, the bot will ask the user for all the missing data.  And in the second he should use already known. <br><br>  For this: <br><br><ul><li>  For the <b>name</b> parameter set the default value is <b># UserData.name</b> </li><li>  For the <b>address</b> parameter set the default value is <b># UserData.address</b> </li><li>  For the <b>city</b> parameter set the default value is <b># UserData.city</b> </li></ul><br>  Now, if a user has previously introduced himself (his name is stored in the context of UserData), then when placing an order, his name will be substituted automatically.  If not, the bot will ask the user a name. <br><br>  We add the answer with confirmation of the order.  In the answer you can use your parameters.  <i><a href="https://dialogflow.com/docs/actions-and-parameters">More details</a></i> . <br><br><img src="https://habrastorage.org/webt/gz/-e/3e/gz-e3eiirqcgz-wy78j1xvkxvry.png"><br><br><h2>  Work result </h2><br>  The result of the bot is shown in the screenshot below.  You can <a href="https://t.me/sample_ShopBot">talk</a> to him yourself in Telegram: <a href="https://t.me/sample_ShopBot">@sample_ShopBot</a> or <a href="https://bot.dialogflow.com/abd5af43-f379-490a-8e28-d4a78bc6fef0">Web Demo</a> <br><br><img src="https://habrastorage.org/webt/cp/i5/ej/cpi5ejxtne8njvbzpdpw9fegtzw.jpeg"><br><br>  After a while, the context will be reset.  After the first call, the bot will ask you for the name and shipping address.  And re-establish the context. <br><br><img src="https://habrastorage.org/webt/ed/er/lq/ederlqvdsc8tyjo3syxzkhju3cs.jpeg"><br><br><h2>  Conclusion </h2><br>  Thus, Dialogflow takes on the collection of information about the user, the order and sends to your service only the finished result.  It remains to configure sending WebHook to <b>your</b> server, which will respond and implement delivery.  <a href="https://dialogflow.com/docs/getting-started/basic-fulfillment-conversation"><i>More details</i></a> . <br><br><h3>  Links </h3><br>  <a href="https://bot.dialogflow.com/abd5af43-f379-490a-8e28-d4a78bc6fef0">Web demo</a> <br>  <a href="https://t.me/sample_ShopBot">Chat bot</a> <br>  <a href="https://dialogflow.com/docs">Documentation</a> </div><p>Source: <a href="https://habr.com/ru/post/342762/">https://habr.com/ru/post/342762/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342752/index.html">What to do if you do not know how the software works</a></li>
<li><a href="../342754/index.html">Selection of equipment for WLAN: how not to spend money in vain</a></li>
<li><a href="../342756/index.html">Cause time: choose a time management system</a></li>
<li><a href="../342758/index.html">[DotNetBook] Reference and significant data types, features of choice</a></li>
<li><a href="../342760/index.html">Digital events in Moscow from November 20 to 26</a></li>
<li><a href="../342764/index.html">Russian Startups Go Global 2017 - new global opportunities for Russian IT entrepreneurs</a></li>
<li><a href="../342766/index.html">Updating Xamarin apps for iOS on Iphone X</a></li>
<li><a href="../342768/index.html">Product owner in the bank - who is it and what he can do</a></li>
<li><a href="../342770/index.html">How IaaS-provider works with information security: threats and protection</a></li>
<li><a href="../342772/index.html">DuerOS - new OS with AI elements released</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>