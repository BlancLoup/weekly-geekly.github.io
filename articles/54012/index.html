<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Search API for PHP (Flash, Java and others)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Objective: to organize a search throughout the site with as little effort as possible and format the results in your own style. 

 Reasoning 
 There a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Search API for PHP (Flash, Java and others)</h1><div class="post__text post__text-html js-mediator-article">  <b>Objective: to</b> organize a search throughout the site with as little effort as possible and format the results in your own style. <br><br>  <b>Reasoning</b> <br>  There are various server systems for organizing full-text search, indexing a site, indexing a database.  But they need to be installed on your server, set up, and some of them are also paid. <br>  At some point I decided to use the Google Ajax Search API via JavaScript, but here it‚Äôs quite difficult to change the type of results, and you also need to make requests to another domain using javascript. <br><br>  <b>Decision</b> <br>  As a result, I came across the <a href="http://code.google.com/intl/ru-RU/apis/ajaxsearch/documentation/">Code Snippets</a> section on the <a href="http://code.google.com/intl/ru-RU/apis/ajaxsearch/documentation/">Google AJAX Search API</a> <a href="http://code.google.com/intl/ru-RU/apis/ajaxsearch/documentation/">page</a> and everything became simple: a little php code and full text search on any site is ready. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h4>  Php </h4><br>  A slightly simplified code snippet is shown.  Of course, it would be good to make a check on the availability of the ajax.googleapis.com server at the moment. <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#008000">//   </font> <br> $data    = MyDB:: <font color="#0000ff">get</font> () -&gt; selectOne( <font color="#A31515">'*'</font> ,self::TABLE, <font color="#A31515">'`id_mod` = '</font> .$ <font color="#0000ff">this</font> -&gt;id_mod); <br> <br> <font color="#008000">//   ?</font> <br> $sireUrl = $data[ <font color="#A31515">'url'</font> ]; <br> <br> <font color="#008000">//   </font> <br> $sigs = array( <br> <font color="#A31515">'q'</font> =&gt; array( <font color="#A31515">'type'</font> =&gt; <font color="#A31515">'string'</font> , <font color="#A31515">'required'</font> =&gt; <font color="#0000ff">false</font> ), <br> <font color="#A31515">'start'</font> =&gt; array( <font color="#A31515">'type'</font> =&gt; <font color="#A31515">'integer'</font> , <font color="#A31515">'required'</font> =&gt; <font color="#0000ff">false</font> ) <br> ); <br> $reqData = SpeData::sanitize_vars($ <font color="#0000ff">this</font> -&gt;queryArray, $sigs, <font color="#A31515">'RequestException'</font> ); <br> $q     = urlencode($reqData[ <font color="#A31515">'q'</font> ]. <font color="#A31515">' site:'</font> .$sireUrl); <br> $start   = empty($reqData[ <font color="#A31515">'start'</font> ]) ? 0 : $reqData[ <font color="#A31515">'start'</font> ]; <br> <br> <font color="#008000">//  ,     :)</font> <br> $ch = curl_init(); <br> curl_setopt($ch, CURLOPT_URL, <font color="#A31515">"http://ajax.googleapis.com/ajax/services/search/web?v=1.0&amp;q=$q&amp;rsz=large&amp;hl=ru&amp;start=$start"</font> ); <br> curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); <br> curl_setopt($ch, CURLOPT_REFERER, <font color="#A31515">"http://$sireUrl/"</font> ); <br> $body = curl_exec($ch); <br> curl_close($ch); <br> <br> <font color="#008000">// ,  ,   :)</font> <br> $json = json_decode($body); <br> <font color="#008000">//     print_r($json)    </font> <br> <font color="#008000">//    smarty    ,      </font> <br> <br> $search = array(); <br> <br> <font color="#008000">// </font> <br> <font color="#0000ff">if</font> (count($json -&gt; responseData -&gt; results) == 0) { <font color="#008000">//   </font> <br> $search[ <font color="#A31515">'result'</font> ] = <font color="#0000ff">false</font> ; <br> } <font color="#0000ff">else</font> { <br> <font color="#0000ff">foreach</font> ($json -&gt; responseData -&gt; results <font color="#0000ff">as</font> $v) { <br> $search[ <font color="#A31515">'result'</font> ][] = array( <br> <font color="#A31515">'GsearchResultClass'</font> =&gt; $v -&gt; GsearchResultClass, <br> <font color="#A31515">'unescapedUrl'</font> =&gt; $v -&gt; unescapedUrl, <br> <font color="#A31515">'url'</font> =&gt; $v -&gt; url, <br> <font color="#A31515">'visibleUrl'</font> =&gt; $v -&gt; visibleUrl, <br> <font color="#A31515">'cacheUrl'</font> =&gt; $v -&gt; cacheUrl, <br> <font color="#A31515">'title'</font> =&gt; $v -&gt; title, <font color="#008000">//   (    html-)</font> <br> <font color="#A31515">'titleNoFormatting'</font> =&gt; $v -&gt; titleNoFormatting, <br> <font color="#A31515">'content'</font> =&gt; $v -&gt; content <font color="#008000">//   </font> <br> ); <br> } <br> } <br> <br> <font color="#008000">//     </font> <br> <font color="#0000ff">if</font> (count($json -&gt; responseData -&gt; results) == 0) { <font color="#008000">//   </font> <br> $search[ <font color="#A31515">'pages'</font> ] = <font color="#0000ff">false</font> ; <br> } <font color="#0000ff">else</font> { <br> $url = <font color="#A31515">'http://'</font> .$_SERVER[ <font color="#A31515">'HTTP_HOST'</font> ].$_SERVER[ <font color="#A31515">'REDIRECT_URL'</font> ]. <font color="#A31515">'?q='</font> .$reqData[ <font color="#A31515">'q'</font> ]; <br> <font color="#0000ff">foreach</font> ($json -&gt; responseData -&gt; cursor -&gt; pages <font color="#0000ff">as</font> $v) { <br> $search[ <font color="#A31515">'pages'</font> ][] = array( <br> <font color="#A31515">'start'</font> =&gt; $v -&gt; start, <br> <font color="#A31515">'startUrl'</font> =&gt; $url. <font color="#A31515">'&amp;start='</font> .$v -&gt; start, <br> <font color="#A31515">'label'</font> =&gt; $v -&gt; label <br> ); <br> } <br> } <br> <br> <font color="#008000">//    </font> <br> $currentPageIndex = $json -&gt; responseData -&gt; cursor -&gt; currentPageIndex; <br> $search[ <font color="#A31515">'info'</font> ] = array( <br> <font color="#A31515">'q'</font> =&gt; $reqData[ <font color="#A31515">'q'</font> ], <br> <font color="#A31515">'estimatedResultCount'</font> =&gt; $json -&gt; responseData -&gt; cursor -&gt; estimatedResultCount, <br> <font color="#A31515">'moreResultsUrl'</font> =&gt; $json -&gt; responseData -&gt; cursor -&gt; moreResultsUrl, <br> <font color="#A31515">'currentPageIndex'</font> =&gt; $currentPageIndex, <br> <font color="#A31515">'currentLabel'</font> =&gt; $currentPageIndex + 1, <br> <font color="#A31515">'startResult'</font> =&gt; $currentPageIndex * 8 + 1, <br> <font color="#A31515">'endResult'</font> =&gt; ($currentPageIndex * 8 + 1) + count($search[ <font color="#A31515">'result'</font> ]), <br> <font color="#A31515">'next'</font> =&gt; (count($search[ <font color="#A31515">'pages'</font> ]) &gt; $currentPageIndex + 1) ? $search[ <font color="#A31515">'pages'</font> ][$currentPageIndex + 1][ <font color="#A31515">'startUrl'</font> ] : <font color="#0000ff">false</font> , <br> <font color="#A31515">'prev'</font> =&gt; ($currentPageIndex) ? $search[ <font color="#A31515">'pages'</font> ][$currentPageIndex - 1][ <font color="#A31515">'startUrl'</font> ] : <font color="#0000ff">false</font> <br> ); <br> <br> <br> <font color="#008000">// </font> <br> MySmarty:: <font color="#0000ff">get</font> () -&gt; assign( <font color="#A31515">'search'</font> , $search); <br> <br> ?&gt;</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><h4>  SMARTY </h4><br>  I use the delimiters "{{" and "}}" to distinguish smarty from javascript <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">{{ <font color="#0000ff">if</font> !$search.result}} <br>   &lt;b&gt; {{$search.info.q}} &lt;/b&gt;          . <br> {{ <font color="#0000ff">else</font> }} <br>  &lt;b&gt;{{$search.info.startResult}} - {{$search.info.endResult}}&lt;/b&gt;   &lt;b&gt;{{$search.info.estimatedResultCount}}&lt;/b&gt;  &lt;b&gt;{{$search.info.q}}&lt;/b&gt; <br> &lt;br /&gt; <br> &lt;br /&gt; <br> <br> {{section name=i loop=$search.result}} <br> &lt;a href= <font color="#A31515">"{{$search.result[i].url}}"</font> &gt;{{$search.result[i].title}}&lt;/a&gt;&lt;br /&gt; <br> {{$search.result[i].content}} <br> &lt;br /&gt; <br> &lt;br /&gt; <br> <br> {{/section}} <br> <br> &lt;br/&gt; <br> <br> {{ <font color="#0000ff">if</font> $search.info.prev}} <br> &lt;a href= <font color="#A31515">"{{$search.info.prev}}"</font> &gt;&lt;/a&gt; <br> {{/ <font color="#0000ff">if</font> }} <br> <br> <br> {{section name=i loop=$search.pages}} <br> {{ <font color="#0000ff">if</font> $search.info.currentLabel == $search.pages[i].label}} <br> {{$search.pages[i].label}} <br> {{ <font color="#0000ff">else</font> }} <br> &lt;a href= <font color="#A31515">"{{$search.pages[i].startUrl}}"</font> &gt;{{$search.pages[i].label}}&lt;/a&gt; <br> {{/ <font color="#0000ff">if</font> }} <br> {{/section}} <br> <br> {{ <font color="#0000ff">if</font> $search.info.next}} <br> &lt;a href= <font color="#A31515">"{{$search.info.next}}"</font> &gt;&lt;/a&gt; <br> {{/ <font color="#0000ff">if</font> }} <br> <br> {{/ <font color="#0000ff">if</font> }}</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  So we got a good search for any kind of data (html, doc, pdf and other documents that google is looking for). <br><br>  There is also a handy tool for <a title="Google Ajax Api Playground" href="http://code.google.com/apis/ajax/playground/">Google Ajax Api Playground</a> tests. <br><br>  Habraludi, if you know, please tell me how things are with the agreements on the use of this search API.  Should I indicate on the results page that I use google search, or do something else like that? <br><br>  Thanks for attention. <br><br>  PS This is my first post on Habr√©, if I did something wrong, say so, correct it :) <br></div><p>Source: <a href="https://habr.com/ru/post/54012/">https://habr.com/ru/post/54012/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../54005/index.html">Big Music will give up, but not before 2011</a></li>
<li><a href="../54006/index.html">On the use of links to run functions.</a></li>
<li><a href="../54008/index.html">Fool Solitaire!</a></li>
<li><a href="../54009/index.html">Google will show you where we are - everything else</a></li>
<li><a href="../54011/index.html">Seagate doubles Serial ATA 3</a></li>
<li><a href="../54015/index.html">"Keys" on 8 GB</a></li>
<li><a href="../54016/index.html">Installing SP1 on .NET Framework 3.5</a></li>
<li><a href="../54017/index.html">Homegrown Javascript frameworks - evil</a></li>
<li><a href="../54018/index.html">About self-signed certificates</a></li>
<li><a href="../54019/index.html">Dell Latitude E6400 XFR: ‚ÄúArmored‚Äù Notebook Laptop</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>