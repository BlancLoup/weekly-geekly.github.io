<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Morrowind Project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="You need to play Morrowind. 

 (Warning: below are a few paragraphs of praise from Morrowind, so you can safely skip them and go to the very essence o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Morrowind Project</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/819/410/924/8194109242eb72ae6930d1a97972bc92.jpg" alt="image"></div><br>  You need to play Morrowind. <br><br>  <em>(Warning: below are a few paragraphs of praise from Morrowind, so you can safely skip them and go to the very essence of the post.)</em> <br><br>  At the beginning of Morrowind, you are just a stunned who has just stepped down from a prison ship with 87 gold in your pocket (in this world, one loaf of bread costs 1 gold, that is, about 35 pounds - this is how much you have to pay for 87 packages of sliced ‚Äã‚Äãwhite bread at Tesco) .  Your first task will be to receive a parcel from a person in another city, and you can either take a ride on a silt strider (a huge long-legged insect that is probably driven by a perpetually drunk creepy driver - almost like in London buses) or take a walk there on foot through the wilderness fighting the hordes of overgrown birds of prey with an iron dagger that you pulled from the census bureau.  Only your dagger always misses, because, you see, the creators of the Morrowind combat system were inspired by tabletop role-playing games, and the animators were not paid much, so even if your weapon is obviously stuck into the fleshy body of the one you guarantees that you actually hit. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Therefore, having broken a couple of mice because of thousands of furious clicks, you decide to quit Morrowind and spend your life on something more interesting. <br><br>  Or do you continue to play and learn how fatigue affects your chances of someone hitting (and hitting someone), study game mechanics, buy a new mouse, get to Balmor and dive into one of the richest worlds that I seen in games.  You live a story that raises questions about organized religion, xenophobia, colonialism, tribal legends, prophecies, free will and the choice of priorities between your own interests and the interests of the organization to which you belong. <br><a name="habracut"></a><br>  And somewhere in the process of this research, you realize that your waving of your settling dagger no longer passes by.  In fact, the dagger is no longer a slop.  In fact, you no longer use a dagger, but found a stunning sword in a dungeon guarded by a couple, perhaps too sexy and extremely dangerous creatures.  You decide to kill God and take away his soul, because it possesses the greatest possibility of enchantment.  When you need to get somewhere, instead of a long walk through the wastelands, you use a single amulet to teleport to the nearest Temple, jump bunny-hop (because it turns out to move faster) or levitate to the city, go to the Mages Guild, use teleport Guilds, use another amulet and finally get to the desired point.  In a drug intoxication, you just cut out entire cities just for the pleasure of it, and then load the last saved one.  You rob the treasure houses of the Great Houses, steal rare armor and weapons just to get to a distant island and sell them to a huge crab.  You say that you chose him because he offers the best price, but in reality everyone else is simply afraid of you. <br><br>  Just like in real life. <br><br>  <em>(Here the praise of the game ends.)</em> <br><br>  Recently, I decided to re-play Morrowind and in the middle of the process of earning high rank I was a bit bored with the constant ‚Äúbring the subject‚Äù quests that I have to perform to get a promotion in some guilds.  Therefore, I thought about creating a route planner.  This is not a trivial task, because the number of options in Morrowind is very large: <br><br><ul><li>  Walking (or levitation, because a self-respecting player has already enchanted an object with the constant effect of levitation) </li><li>  A trip to the Silt Strider (or boat) - but it is worth considering that you cannot instantly get to the desired city and you will have to change transport in one of the bad parts of the city.  In-game time is spent on this, but we will assume that the movement takes place instantly, as it is perceived by the player. </li><li>  The magicians guild teleport is also instant.  You need to talk to the magicians, but in fact they are good guys. </li><li>  Divine / Almsivi Intervention - here everything becomes more interesting.  Divine Intervention teleports us to the nearest Imperial fort (Morrowind is part of the Empire, though still not reconciled with this thought), and Almsivi Intervention (Almsivi intervention) teleports us to the nearest Temple of the Tribunal (which is the official Morrowind religion and existed long before the Empire). </li><li>  Mark / Recall - two spells, one places the mark, and the second teleports you to this mark. </li><li>  Propylon (Propylon Indices) - a long time ago someone decided to build on the island in a circle a bunch of beautiful fortresses.  Good news: there is a teleportation room connecting them all in a circle.  The bad news is that you will need a propylion mark for each of these fortresses, and they are often difficult to find.  In addition, these fortresses are filled with a bunch of different creatures, and usually next to them is not very nice.  For now, I will exclude them from my analysis. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e2d/15a/059/e2d15a059f79c9e69843601ebcd505b4.png"></div><br>  <em>Due to the appearance of sharks on the Koltsevaya Line, slight movement delays are expected.</em> <br><br>  You can understand what interesting ways of moving can occur when combining these tools.  For example, you can skip Almsivi Intervention to teleport to the nearest Temple, and then Divine Intervention to teleport to the Imperial Fort, then use the Guild teleport and immediately skip another Almsivi to get into another city. <br><br>  But of course, it would be boring if I just spent some time reading these Morrowind displacement maps, creating a graph and executing the Dijkstra algorithm for it.  First, it would not have turned out such a good post.  Secondly, it would not help us if we were somewhere in the wasteland (see this area in the middle, surrounded by Falasmaryon, Valenvaryon, Rotheran, Indoranyon, Falensarano, Ald'Ruhn and Maar Gan? Yes, <a href="http://www.uesp.net/wiki/Morrowind:Red_Mountain">you should not go there</a> ). <br><br>  Finally, there are some pretty big fan add-ons to Morrowind, including <a href="http://tamriel-rebuilt.org/">Tamriel Rebuilt</a> , because I lied to you, and in fact this island is not called Morrowind, but Vvardenfell, and Morrowind is a province of which Vvardenfell is a part.  The authors of Tamriel Rebuilt tried to recreate the entire province (yes, all of Morrowind did not enter the game with the name Morrowind. Moreover, Tamriel is the whole Empire, of which Morrowind is part, and yes, Tamriel Rebuilt is simply trying to recreate the Morrowind. In a game called Morrowind ). <br><br>  All this I said in order to convince you that it would be a good idea to find a systematic way of pulling out this data from the game files in order to simplify our lives.  Imagine what we can find out if we do this!  Demographics!  Heat maps of the population!  Counts!  We can even make graphs of prices and travel times! <br><br>  In the next part of the Morrowind project, we will fight with intricate binary formats, strange assumptions, linear algebra, Python, and perhaps learn more about Morrowind Laura and his game mechanics. <br><br><h2>  Part 2 </h2><br>  Next in the Morrowind project, we will begin to turn horrible binaries into beautiful data structures in the Python interpreter memory space.  Technically, they still remain binary data, but let's not go so deep.  Otherwise, we realize that everything is composed of atoms and we will be covered by an existential crisis, and there is nothing good in this. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ab8/e44/f82/ab8e44f82847005cd66bff058f369224.png"></div><br>  <em>I ... I don't even see the code.</em>  <em>I only see wood, stone, marsh cane ...</em> <br><br><h2>  Data dump </h2><br>  In the games of the Elder Scrolls series created by Bethesda Softworks, including Morrowind and its followers (Oblivion, Skyrim, in addition, they include Fallout 3 and 4) basic game data (i.e. maps and locations of various objects, but not textures / sounds / models) are stored in ESM (Elder Scrolls Master) format.  Since the days of Morrowind, it has evolved, the Bethesda developers have added more and more features to it, but the basic idea remains the same: these files are a collection of records of various types. <br><br>  For example, we may have an NPC_ entry that defines the character of the game, which will contain the definitions of gender, race, AI behavior of the character, etc.  It can also contain links to other entries, for example, the inventory of a character that refers to the ARMO and WEAP entries.  CELL entries describe the in-game cells (locations themselves) and contain links to everything that is contained in this cell, for example NPC_, ARMO, WEAP, or CONT (containers, for example chests).  Morrowind's binary format is very well described <a href="http://www.uesp.net/morrow/tech/mw_esm.txt">here</a> and every new release of Bethesda games promises players a lot of interesting tasks for reverse engineering small changes in the game data file format. <br><br>  Bethesda came up with a clever idea - to make game save files overlay game data in this format.  For example, if you kill someone in a certain location (which happens quite often in games of the Elder Scrolls series), then your save file will contain a redefinition of the CELL entry, which indicates the corresponding killed NPC.  Unfortunately, this idea did not reflect on my project in any way, like many other clever ideas, but nevertheless it is interesting. <br><br>  However, there are other difficulties: the cells can be external or internal.  The outer cells are square and are connected edge to edge, creating stunning expanses of Morrowind.  There is a different story with internal cells - each of them is in its own little reality and is connected with other cells by doors, which are essentially used here as teleports.  A small house in an external cell is often much larger from the inside, so we cannot reliably judge where a player is when he enters. <br><br>  Therefore, if we want to recreate the graph of ways to move around Morrowind, then we need to be considered as another way to move the door. <br><br>  As for the Almsivi / Divine Intervention spells, there is a special marker object in each Temple and Imperial Fort - with the help of it the game determines where to teleport a player casting a certain spell.  This is also simple for external cells (because the markers are inside the premises), but it is complicated in the case of internal cells.  Some people claim that Morrowind uses the last external cell that the player was in (which sometimes leads to pathological cases - let's say we use the Guild teleport teleporting us from one room to another; then during the Intervention spell, we will be moved to a marker close to first guild, not the second) and the open-source implementation of the Morrowind engine <a href="https://openmw.org/en/">OpenMW</a> tries to solve this problem by using the cell closest to the player as a reference.  For some reason, my copy of Morrowind behaves correctly, so I simulate this behavior. <br><br>  Much better is that if the NPC offers transportation services (a Silt Strider, a boat, or a guild teleport), it will be encoded in its record. <br><br>  In general, it seems, we need to pull out all of the CELL and NPC_ records, because they contain everything we need. <br><br><h2>  Extracting all of the CELL and NPC_ records </h2><br>  Although I thought it would be quite possible and interesting to decode binary data in accordance with this wonderful specification, I decided to cheat and used the <a href="http://www.uesp.net/wiki/Tes3Mod:Enchanted_Editor">Morrowind Enchanted Editor</a> , the low-level editor of ESM files.  In particular, I used the ‚ÄúDump to Text File‚Äù function, which turns unreadable binary chaos into readable ASCII chaos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/42e/de8/307/42ede83078d4df29019b0dad5fba92c8.png"></div><br>  <em>Meet the character <a href="http://www.uesp.net/wiki/Morrowind:Todd%26">Todd's Super Tester Guy</a> , supposedly created by <a href="https://en.wikipedia.org/wiki/Todd_Howard_%2528video_game_designer%2529">Todd Howard</a> himself.</em> <br><br>  It is already possible to work with this: each element in the record is on a separate line and has a key in the form of a subrecord (for example, FNAM is the full name, RNAM is the name of the race, etc.).  First, we can extract only the NPC_ and CELL records, and then convert the data into <a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B5%25D0%25BA%25D1%2581%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25B0%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25B8%25D0%25B7">tokens</a> , converting them into a stream of key-value pairs (that is, the string NPC_ NAME todd turns into a tuple (NAME, todd), because we already know that refers to the NPC_ record.) <br><br>  <em>(I was going to show it here block by block and explain the source code, but today WordPress turned against me. I promise I will post it on GitHub later. Seriously, who thought to convert&gt; to &amp; gt; after the save cycle, and then back to &amp; amp; gt?)</em> <br><br>  As a result, we get something like this: <br><br><pre><code class="python hljs">In [<span class="hljs-number"><span class="hljs-number">6</span></span>]: cells[:<span class="hljs-number"><span class="hljs-number">10</span></span>] Out[<span class="hljs-number"><span class="hljs-number">6</span></span>]: [(<span class="hljs-string"><span class="hljs-string">'NAME'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-string"><span class="hljs-string">'DATA'</span></span>, <span class="hljs-string"><span class="hljs-string">'\x02\x00'</span></span>), (<span class="hljs-string"><span class="hljs-string">'DATA'</span></span>, <span class="hljs-string"><span class="hljs-string">'23'</span></span>), (<span class="hljs-string"><span class="hljs-string">'DATA'</span></span>, <span class="hljs-string"><span class="hljs-string">'7'</span></span>), (<span class="hljs-string"><span class="hljs-string">'RGNN'</span></span>, <span class="hljs-string"><span class="hljs-string">"Azura's Coast Region"</span></span>), (<span class="hljs-string"><span class="hljs-string">'NAME'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-string"><span class="hljs-string">'DATA'</span></span>, <span class="hljs-string"><span class="hljs-string">'\x02\x00'</span></span>), (<span class="hljs-string"><span class="hljs-string">'DATA'</span></span>, <span class="hljs-string"><span class="hljs-string">'23'</span></span>), (<span class="hljs-string"><span class="hljs-string">'DATA'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>), (<span class="hljs-string"><span class="hljs-string">'RGNN'</span></span>, <span class="hljs-string"><span class="hljs-string">"Azura's Coast Region"</span></span>)] npcs[:<span class="hljs-number"><span class="hljs-number">10</span></span>] Out[<span class="hljs-number"><span class="hljs-number">7</span></span>]: [(<span class="hljs-string"><span class="hljs-string">'NAME'</span></span>, <span class="hljs-string"><span class="hljs-string">'player'</span></span>), (<span class="hljs-string"><span class="hljs-string">'FNAM'</span></span>, <span class="hljs-string"><span class="hljs-string">'player'</span></span>), (<span class="hljs-string"><span class="hljs-string">'RNAM'</span></span>, <span class="hljs-string"><span class="hljs-string">'Dark Elf'</span></span>), (<span class="hljs-string"><span class="hljs-string">'CNAM'</span></span>, <span class="hljs-string"><span class="hljs-string">'Acrobat'</span></span>), (<span class="hljs-string"><span class="hljs-string">'ANAM'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-string"><span class="hljs-string">'BNAM'</span></span>, <span class="hljs-string"><span class="hljs-string">'b_n_dark elf_m_head_01'</span></span>), (<span class="hljs-string"><span class="hljs-string">'KNAM'</span></span>, <span class="hljs-string"><span class="hljs-string">'b_n_dark elf_m_hair_01'</span></span>), (<span class="hljs-string"><span class="hljs-string">'NPDT'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>), (<span class="hljs-string"><span class="hljs-string">'NPDT'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), (<span class="hljs-string"><span class="hljs-string">'NPDT'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>)]</code> </pre> <br>  Parsing a stream of NPC_ records into an NPC list is not such a difficult task.  I found out that the simplest way is to pass the stream to the class constructor and allow it to read from there everything necessary for its initialization.  But do not forget that we need to stop the parsing when we see the NAME subrecord of the next NPC, and if we have already used it, it is too late, so we need to define an iterator that allows us to look at the next element without using it. <br><br>  Parsing the list of locations we are looking for the Holy Grail is also very simple - just look at this example (this is one of the places where Todd's Super Tester Guy can deliver us): <br><br><pre> <code class="python hljs">NPC_ DODT <span class="hljs-number"><span class="hljs-number">1822.641</span></span> NPC_ DODT <span class="hljs-number"><span class="hljs-number">-231.5323</span></span> NPC_ DODT <span class="hljs-number"><span class="hljs-number">-292.9501</span></span> NPC_ DODT <span class="hljs-number"><span class="hljs-number">0</span></span> NPC_ DODT <span class="hljs-number"><span class="hljs-number">0</span></span> NPC_ DODT <span class="hljs-number"><span class="hljs-number">0.5</span></span> NPC_ DNAM ToddTest</code> </pre> <br>  We literally get a list of 6 numbers: the coordinates x, y, z and the angle (which is not important to us).  Sometimes, if we are in the inner cell, there is a DNAM subrecord. <br><br>  Add the <a href="https://docs.python.org/2/library/functions.html"><strong>repr</strong></a> method and we can see the list of NPCs! <br><br><pre> <code class="python hljs">npcs[:<span class="hljs-number"><span class="hljs-number">10</span></span>] Out[<span class="hljs-number"><span class="hljs-number">15</span></span>]: [NPC (player, player, Dark Elf, Acrobat), NPC (todd, Todd<span class="hljs-string"><span class="hljs-string">'s Super Tester Guy, Dark Elf, Guard), NPC (Imperial Guard, Guard, Imperial, Guard), NPC (agronian guy, Tarhiel, Wood Elf, Enchanter), NPC (murberius harmevus, Murberius Harmevus, Imperial, Warrior), NPC (madres navur, Madres Navur, Dark Elf, Acrobat), NPC (farusea salas, Farusea Salas, Dark Elf, Commoner), NPC (erval, Erval, Wood Elf, Commoner), NPC (Dralas Gilu, Dralas Gilu, Dark Elf, Rogue), NPC (uulernil, Uulernil, High Elf, Smith)] npcs[1].inventory Out[16]: [('</span></span>steel battle axe<span class="hljs-string"><span class="hljs-string">', 1), ('</span></span>glass war axe<span class="hljs-string"><span class="hljs-string">', 1), ('</span></span>steel mace<span class="hljs-string"><span class="hljs-string">', 1), ('</span></span>chitin guantlet - right<span class="hljs-string"><span class="hljs-string">', 1), ('</span></span>chitin guantlet - left<span class="hljs-string"><span class="hljs-string">', 1), ('</span></span>chitin boots<span class="hljs-string"><span class="hljs-string">', 1), ('</span></span>chitin greaves<span class="hljs-string"><span class="hljs-string">', 1), ('</span></span>chitin pauldron - right<span class="hljs-string"><span class="hljs-string">', 1), ('</span></span>chitin pauldron - left<span class="hljs-string"><span class="hljs-string">', 1), ('</span></span>chitin cuirass<span class="hljs-string"><span class="hljs-string">', 1)]</span></span></code> </pre> <br>  (Interestingly, there are three problems with the ‚ÄúArgonian guy‚Äù (agronian guy) named Tarhiel. First, the name of his race is spelled Argonian. Secondly, he is not an Argonian, but a Wood Elf. And finally he has <a href="http://www.uesp.net/wiki/Morrowind:Tarhiel">mental problems, but also abilities</a> . <br><br>  Next, we turn to attempts to decode CELL data, in which there are other interesting points (for example, the fact that they contain most of what the player can perceive).  But we have already talked about the basics and the most boring, so we will start moving faster and maybe we will get to create a real movement graph! <br><br><h2>  Part 3 </h2><br>  Today, in the Morrowind project, we will take decades of studying the process of visualizing 3D scene descriptions into beautiful photorealistic worlds, and throw them into the trash. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/940/f8c/243/940f8c243ea5219411c0847adee26630.png"></div><br>  <em>I finally gave up trying to non-trivial formatting in WordPress.</em>  <em>I hope he will not spoil the text at least in the pictures.</em> <br><br><h1>  Load cell data </h1><br>  There are several difficulties with parsing Morrowind cells.  The first is how to give cells unique names.  This is easy to do in the case of internal cells, because they have the NAME field, for example, ‚ÄúUncle's Workshop Sweet Share‚Äù (and this is <a href="http://www.uesp.net/wiki/Bloodmoon:Uncle_Sweetshare%26">not a joke</a> ).  However, external cells can be about three different types.  The first is the cities and remarkable landmarks, like those shown in the picture.  They have RGNN, NAME and the coordinates of the location of a huge outer square cell.  However, there are many Vivek cells (because Vivec is <a href="http://www.uesp.net/wiki/Morrowind:Vivec_%2528city%2529">huge</a> ), so we will use the coordinates of the area to identify them. <br><br>  Secondly, wasteland cells, for example, other parts of the region of the Ascadian Islands will be called using this method and their external coordinates. <br><br>  Finally, there are external cells with no cell name and area, but with coordinates ‚Äî in the TES Construction Set they are called Wilderness [x, y], so we will use the same name. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cb/d82/e09/3cbd82e09c260f81742d514afd837918.jpg" alt="mw <em> map </ em> vivec"></div><br>  <em>Each of these areas is itself a city, and they are all connected by bridges.</em>  <em>In addition, they are on the water.</em>  <em>Who would not want to live here?</em> <br><br>  The next step is to parse the contents of each cell, which is essentially an object ID and other data about the current link instance (for example, position, amount of health (for NPC) or possible destinations (for doors or NPCs offering transport services)). <br><br>  And, yes, sometimes the links can be deleted - but instead of simply deleting the data from the file, they are simply marked as deleted.  Perhaps this is because it would have to rewrite the entire file to remove them (because all the pointers in the file must be recalculated) - today this is nonsense, but in 2002 this would probably take too many resources. <br><br>  It is also worth mentioning that object definitions can appear before or after they are referenced, so we have to parse the file in two passes - first writing down only the link IDs as strings, and then linking them to Python objects. <br><br>  Fuh, the work is complete! <br><br><pre> <code class="python hljs">In [<span class="hljs-number"><span class="hljs-number">1</span></span>]: mages Out[<span class="hljs-number"><span class="hljs-number">1</span></span>]: Vivec, Guild of Mages In [<span class="hljs-number"><span class="hljs-number">2</span></span>]: mages.is_interior Out[<span class="hljs-number"><span class="hljs-number">2</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> In [<span class="hljs-number"><span class="hljs-number">3</span></span>]: mages.destinations Out[<span class="hljs-number"><span class="hljs-number">3</span></span>]: [(Vivec, Foreign Quarter Plaza, (<span class="hljs-number"><span class="hljs-number">-826.792800</span></span>, <span class="hljs-number"><span class="hljs-number">357.833600</span></span>, <span class="hljs-number"><span class="hljs-number">309.695400</span></span>))]</code> </pre> <br>  I did not add location cells to the list of destination points to which NPCs could be transferred from a cell to a player (for example, in the case of teleportation services) - it lists only the locations to which the doors in the cell lead. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d45/5ee/c36/d455eec36c095a9f79395d1ecb7d4fd3.png"></div><br>  <em>The full version is <a href="">here</a> , but neatly - it weighs approximately 10MB.</em> <br><br>  Even using only this information we can create beautiful graphs.  For example, I created the picture shown above in GraphViz, the nodes in it are cells and they are connected by edges when there is a door between them.  The big group in the middle is Vivek.  <a href="http://www.uesp.net/wiki/Morrowind:Balmora">Small</a> groups are scattered around the picture; these are not such big cities (like <a href="http://www.uesp.net/wiki/Morrowind:Balmora">Balmora</a> , <a href="http://www.uesp.net/wiki/Morrowind:Caldera">Caldera</a> or <a href="http://www.uesp.net/wiki/Morrowind:Ald%26">Ald'Runa</a> ).  Here there are also star-like formations - the center is the cell with the name, and the cells connected to it will be internal, which can be penetrated through it - these are smaller settlements. <br><br>  But we did not strive for this.  We want to know how to get from point A to point B with everything that the world can offer us, not just doors.  Let's talk about how we describe the real movement graph. <br><br><h1>  Create a route planner </h1><br>  Obviously, the game has an infinite number of points, but we do not need to consider them all.  We need to consider only the starting point, the end point and all possible important points through which our route can pass.  Therefore, we can simply specify the nodes of the graph as follows: <br><br><ul><li>  For each object that offers ‚Äúmoving‚Äù services (NPCs / doors), the location of the object and the moving point </li><li>  The location of each Divine / Almsivi Intervention marker. </li></ul><br>  That's all.  The description of our route will then be approximately as follows: ‚ÄúFrom the starting point go up to this door (point 1), go through it to another cell (point 2), go up to the NPC offering transport services (point 3), move to another city (point 4 ), go to the destination (point 5). "  So let's see how you can connect the nodes of the graph. <br><br><ul><li>  The location of the move offering service (door, teleport / Silt Strider NPC driver) is connected to the destination point with an edge with a length of 0. </li><li>  If two nodes are in the same cell (or both are in the outside world), then they are connected by an edge whose length is proportional to the distance between them (that is, we ignore, for example, mountains in the outside world and an impassable obstacle in internal cells). </li><li>  Each node is connected to the nearest Temple / Imperial Fort (using direct Euclidean distance in the case of external cells or distance from the nearest external cell in the case of internal cells). </li></ul><br>  Using this method, I came to the displacement graph consisting of 6424 vertices and 16065 edges only teleportation - they include Intervention doors / transport services / spells, but not direct movements inside the cells, because in this case it is very easy to find the distance between any two dots on the fly. <br><br>  One interesting feature of the shortest path search algorithms is that finding the shortest path between two nodes (the shortest path for one pair) is as computationally expensive (it has the same asymptotic complexity) as finding the shortest path from a node to all points of the graph (shortest path). path from one point).  It is intuitively clear that this happens because our ideal path for the task of one pair can include any point of the graph, so we still calculate the shortest path from one source to this point. <br><br>  With such things <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC_%25D0%2594%25D0%25B5%25D0%25B9%25D0%25BA%25D1%2581%25D1%2582%25D1%2580%25D1%258B">Dijkstra's algorithm</a> copes quite well, finding the shortest paths from one point to all points in O (| V | ¬≤) (where | V | is the number of nodes in the graph).  It can be improved using the <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25B8%25D0%25B1%25D0%25BE%25D0%25BD%25D0%25B0%25D1%2587%25D1%2587%25D0%25B8%25D0%25B5%25D0%25B2%25D0%25B0_%25D0%25BA%25D1%2583%25D1%2587%25D0%25B0">Fibonacci heap</a> for storing unexplored vertices and getting those closest to O (1), which gives us the time complexity O (| E | + | V | log | V |).  I decided that searching for only 6000 vertices would not take too much time, so I didn‚Äôt implement it, but maybe I‚Äôll do it later. <br><br>  I used <a href="http://www.uesp.net/wiki/Morrowind:Master_Aryon">Arion</a> as an experimental rat in this experiment - he becomes the main questgiver at the later stages <a href="http://www.uesp.net/wiki/Morrowind:House_Telvanni">of the Telvanni</a> quest line and lives in a rather remote tower in the wilderness with an almost complete lack of transportation services.  Therefore, although you can use Mark / Recall to get to him, his quests can send you to different points of the game world, getting into which quickly becomes a non-trivial task. <br><br>  After feeding this graph to Dijkstra‚Äôs algorithm (which took about 10 minutes, which is quite long), I received two lists: the first one for each point indicates the weight of the cheapest (in our case, fast) route from Arion to this point.  The second for each point indicates the previous point on the fastest route.  Thanks to this, we can quickly recreate the optimal route by following these links to the point of interest. <br><br>  For example, how do we get from Arion to the Dunmer fortress of <a href="http://www.uesp.net/wiki/Morrowind:Hlormaren">Chlormaren</a> on the other side of the island?  Like this: <br><br><pre> <code class="python hljs">target Out[<span class="hljs-number"><span class="hljs-number">35</span></span>]: (Hlormaren, Dome, (<span class="hljs-number"><span class="hljs-number">384.000000</span></span>, <span class="hljs-number"><span class="hljs-number">-408.000000</span></span>, <span class="hljs-number"><span class="hljs-number">384.000000</span></span>)) route = chain_prev(prev, target) route Out[<span class="hljs-number"><span class="hljs-number">37</span></span>]: [(Tel Vos, Aryon<span class="hljs-string"><span class="hljs-string">'s Chambers, (3905.517000, 2935.360000, 15752.000000)), (Wolverine Hall, [18,3], (148881.700000, 28453.790000, 1495.193000)), (Wolverine Hall, [18,3], (148880.000000, 28360.000000, 1464.000000)), (Sadrith Mora, Wolverine Hall: Imperial Shrine, (-64.000000, -96.000000, 0.000000)), (Sadrith Mora, Wolverine Hall: Imperial Shrine, (-320.000000, -224.000000, 32.000000)), (Sadrith Mora, Wolverine Hall, (2560.000000, 4064.000000, 14240.000000)), (Sadrith Mora, Wolverine Hall, (2560.000000, 3968.000000, 14528.000000)), (Sadrith Mora, Wolverine Hall: Mage'</span></span>s Guild, (<span class="hljs-number"><span class="hljs-number">448.000000</span></span>, <span class="hljs-number"><span class="hljs-number">192.000000</span></span>, <span class="hljs-number"><span class="hljs-number">160.000000</span></span>)), (Sadrith Mora, Wolverine Hall: Mage<span class="hljs-string"><span class="hljs-string">'s Guild, (-70.134480, 434.521700, 65.990490)), (Balmora, Guild of Mages, (-755.896600, -1002.733000, -644.627900)), (Balmora, [-3,-2], (-22130.610000, -8582.789000, 889.572800)), (Hlormaren, [-6,-1], (-43200.000000, -3448.000000, 3072.000000)), (Hlormaren, Dome, (320.000000, -256.000000, 402.000000)), (Hlormaren, Dome, (384.000000, -408.000000, 384.000000))]</span></span></code> </pre> <br>  The disadvantage here is that we don‚Äôt actually see the mode of movement required for the transition between nodes, so knowledge of the game is required to decipher the travel plan.  In essence, we need to use the Divine Intervention spell to get to Fort Wolverin Hall, then enter the Imperial Sanctuary, unceremoniously go through it to the inner part of the fort, enter the Magician's Guild, teleport to Balmor and then leave / fly away from there to Chlormarin. <br><br>  What about getting into the <a href="http://www.uesp.net/wiki/Morrowind:Sarys_Ancestral_Tomb">family tomb of Saris</a> , which is located on a remote island in the southwestern edge of the map?  Easier nowhere. <br><br><pre> <code class="python hljs">[(Tel Vos, Aryon<span class="hljs-string"><span class="hljs-string">'s Chambers, (3905.517000, 2935.360000, 15752.000000)), (Wolverine Hall, [18,3], (148881.700000, 28453.790000, 1495.193000)), (Wolverine Hall, [18,3], (148880.000000, 28360.000000, 1464.000000)), (Sadrith Mora, Wolverine Hall: Imperial Shrine, (-64.000000, -96.000000, 0.000000)), (Sadrith Mora, Wolverine Hall: Imperial Shrine, (-320.000000, -224.000000, 32.000000)), (Sadrith Mora, Wolverine Hall, (2560.000000, 4064.000000, 14240.000000)), (Sadrith Mora, Wolverine Hall, (2560.000000, 3968.000000, 14528.000000)), (Sadrith Mora, Wolverine Hall: Mage'</span></span>s Guild, (<span class="hljs-number"><span class="hljs-number">448.000000</span></span>, <span class="hljs-number"><span class="hljs-number">192.000000</span></span>, <span class="hljs-number"><span class="hljs-number">160.000000</span></span>)), (Sadrith Mora, Wolverine Hall: Mage<span class="hljs-string"><span class="hljs-string">'s Guild, (-70.134480, 434.521700, 65.990490)), (Vivec, Guild of Mages, (3.520470, 1391.325000, -385.853300)), (Ebonheart, [1,-13], (8703.056000, -100602.000000, 1383.638000)), (Bitter Coast Region, [-5,-9], (-37659.390000, -69956.550000, 322.489000)), (Sarys Ancestral Tomb, (7028.375000, 4415.659000, 15001.790000))]</span></span></code> </pre> <br>  We need to go back to the Sadrit Mora's Guild and teleport, this time to Vivec.  Then we once again cast Divine Intervention and find ourselves in Ebonhart, which is on the same boat ride from the island to the tomb. <br><br>  Later in the Morrowind project we will try to make the recommendations of the planner a little more understandable by placing them on the game map.  Maybe mapping and other things.  Perhaps the article will even be the source code! <br><br><h2>  Part 4 </h2><br>  I welcome you again to the Morrowind project, in which we will use technology to put pressure on people in their own political interests. <br><br>  This Saturday morning a couple of hangover Telvanni wizards approached my house.  Last night, they went to the tower of Master Arion to skip a glass, which quickly turned into several glasses.  In short, Arion managed to get somewhere, and since then no one has seen him.  Moreover, next Monday there will be a meeting of the Council, and the absence of Arion will be a disaster. <br><br>  The wizards asked me if I could show locations on the map where Arion might be located in order to concentrate the efforts of my agents and have time to find him before the meeting. <br><br>  Having imagined which posts you can write about in your blog, I agreed. <br><br><h2>  Graph regeneration </h2><br>  At first I had to change the weights between the edges of the displacement graph, because in the internal game time, moving on a silt strider or boat is not instantaneous.  But it can still be calculated from the distance: the speed of movement is a game parameter, by default equal to 16000 units per game hour.  For example, the distance from Seyda Ning to Balmora is about 55,000 units, so if at the beginning of the game you decided to spend money on public transport and not go on foot, then you would get to Balmore and complete your first quest in less than 3.5 hours of play. <br><br>  To determine the time of movement on foot between locations also required research.  The minimum walking speed in the game is 100 game units per second of the real world, and the game time by default flows 30 times faster than the real one.  That is, the passage of 16,000 units will require approximately 16,000/100 * 30/3600 = 1 h 20 min of playing time.  As you can see, this is not much slower than riding a silt strider, and if you <a href="http://vignette4.wikia.nocookie.net/elderscrolls/images/2/23/Silt_Strider_by_mage_116.jpg/revision/latest%3Fcb%3D20141211235520">see it</a> , you will understand why. <br><br>  Obviously, if the words ‚ÄúGuild Guide‚Äù are in the name of the NPC relocation class, then relocating with it does not take time, because it is magic. <br><br>  By rebuilding the graph and running Dijkstra‚Äôs algorithm for it again, we can easily determine how long it would take Arion to move to any place in the game world, given that he used the fastest route.  We need to go through all points of the graph where we know the shortest travel time, and find the one for which the total travel time (the shortest time to move to this point + time to walk from this point to the destination point) will be the smallest. <br><br>  There is an optimization that I did not use: in fact, we are interested only in those points of the graph, into which we can get by any route, except on foot.  Consider this case: if the shortest path to a point is created from teleportation to some point A, and then walking to point B, and then walking to point C (all this in a straight line), then why not walk directly from A to C (we assume here that Arion can levitate and move between the points in a straight line, so any three points in the outer cells follow the triangle inequality). <br><br>  But, of course, simply giving Telvanni wizards a list of in-game coordinates is not worth it.  They need a map, and I will give them a map.  Affinity card, oddly enough. <br><br><h2>  A quick, incomplete and mostly erroneous introduction to linear algebra </h2><br>  The problem here is that we want to find a way to convert a pair of pixel coordinates on the game map to the coordinates of the game world.  Fortunately, this transformation has an important property: the straight line between any two points on the game map will also be direct in the world itself.  Such transformations are called affine: they can be created from primitive operations like transfer, rotation, reflection, etc. <br><br>  The good news is that they can be presented as a matrix product. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>G</mi><mi>A</mi><mi>M</mi><mi>E</mi></mrow></msub><mspace linebreak=&quot;newline&quot; /><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>G</mi><mi>A</mi><mi>M</mi><mi>E</mi></mrow></msub><mspace linebreak=&quot;newline&quot; /><mn>1</mn><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><mo>=</mo><mi>M</mi><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub><mspace linebreak=&quot;newline&quot; /><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub><mspace linebreak=&quot;newline&quot; /><mn>1</mn><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="14.226ex" viewBox="0 -780.1 40358 6125.1" role="img" focusable="false" style="vertical-align: -12.414ex; max-width: 778px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(15549,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-67" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-69" x="1626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6E" x="1972" y="0"></use><g transform="translate(2572,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-78" x="3070" y="0"></use></g><g transform="translate(6215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-78" x="0" y="0"></use><g transform="translate(572,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-41" x="786" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-4D" x="1537" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-45" x="2588" y="0"></use></g></g></g><g transform="translate(18698,-1200)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-79" x="0" y="0"></use><g transform="translate(490,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-47" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-41" x="786" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-4D" x="1537" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-45" x="2588" y="0"></use></g></g><g transform="translate(11647,-2532)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-65" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6E" x="1217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-64" x="1817" y="0"></use><g transform="translate(2341,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-78" x="3070" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-3D" x="6261" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-4D" x="7317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-62" x="8619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-65" x="9048" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-67" x="9515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-69" x="9995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6E" x="10341" y="0"></use><g transform="translate(10941,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-78" x="3070" y="0"></use></g><g transform="translate(14584,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-78" x="0" y="0"></use><g transform="translate(572,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-41" x="1051" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-50" x="1802" y="0"></use></g></g></g><g transform="translate(18980,-3732)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-79" x="0" y="0"></use><g transform="translate(490,-163)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-41" x="1051" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-50" x="1802" y="0"></use></g></g><g transform="translate(17187,-5064)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-65" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6E" x="1217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-64" x="1817" y="0"></use><g transform="translate(2341,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-78" x="3070" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>G</mi><mi>A</mi><mi>M</mi><mi>E</mi></mrow></msub><mspace linebreak="newline"></mspace><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>G</mi><mi>A</mi><mi>M</mi><mi>E</mi></mrow></msub><mspace linebreak="newline"></mspace><mn>1</mn><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><mo>=</mo><mi>M</mi><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub><mspace linebreak="newline"></mspace><msub><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mi>M</mi><mi>A</mi><mi>P</mi></mrow></msub><mspace linebreak="newline"></mspace><mn>1</mn><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ begin {pmatrix} x_ {GAME} \\ y_ {GAME} \\ 1 \ end {pmatrix} = M \ begin {pmatrix} x_ {MAP} \\ y_ {MAP} \\ 1 \ end {pmatrix} </script></p><br>  Therefore, if we have a pair of coordinates on the map and this matrix is ‚Äã‚ÄãM 3x3, then we will be able to calculate the real in-game coordinates, and vice versa.  The third component of the vector, equal to 1, is a dirty hack, which allows us to encode transfers (motion), because otherwise the vector (0, 0) on the map would correspond to the vector (0, 0) in the game.  Read more about this in <a href="https://en.wikipedia.org/wiki/Transformation_matrix">Wikipedia</a> . <br><br>  How do we find such a matrix?  Well, we can use it to convert several vectors at the same time: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>\&amp;#xA0;begin&amp;#xA0;{pmatrix}&amp;#xA0;x_&amp;#xA0;{GAME,&amp;#xA0;1}&amp;#xA0;&amp;amp;&amp;#xA0;x_&amp;#xA0;{GAME,&amp;#xA0;2}&amp;#xA0;&amp;amp;&amp;#xA0;x_&amp;#xA0;{GAME,&amp;#xA0;3}&amp;#xA0;\\&amp;#xA0;y_&amp;#xA0;{GAME,&amp;#xA0;1}&amp;#xA0;&amp;amp;&amp;#xA0;y_&amp;#xA0;{GAME,&amp;#xA0;2}&amp;#xA0;&amp;amp;&amp;#xA0;y_&amp;#xA0;{GAME,&amp;#xA0;3}&amp;#xA0;\\&amp;#xA0;1&amp;#xA0;&amp;amp;&amp;#xA0;1&amp;#xA0;&amp;amp;&amp;#xA0;1&amp;#xA0;\&amp;#xA0;end&amp;#xA0;{pmatrix}&amp;#xA0;=&amp;#xA0;M&amp;#xA0;\&amp;#xA0;begin&amp;#xA0;{pmatrix}&amp;#xA0;x_&amp;#xA0;{MAP,&amp;#xA0;1}&amp;#xA0;&amp;amp;&amp;#xA0;x_&amp;#xA0;{MAP,&amp;#xA0;2}&amp;#xA0;&amp;amp;&amp;#xA0;x_&amp;#xA0;{MAP,&amp;#xA0;3}&amp;#xA0;\\&amp;#xA0;y_&amp;#xA0;{MAP,&amp;#xA0;1}&amp;#xA0;&amp;amp;&amp;#xA0;y_&amp;#xA0;{MAP,&amp;#xA0;2}&amp;#xA0;&amp;amp;&amp;#xA0;y_&amp;#xA0;{MAP,&amp;#xA0;3}&amp;#xA0;\\&amp;#xA0;1&amp;#xA0;&amp;amp;&amp;#xA0;1&amp;#xA0;&amp;amp;&amp;#xA0;1&amp;#xA0;\&amp;#xA0;end&amp;#xA0;{pmatrix}</mtext></merror></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><span class="noError" aria-hidden="true" style="display: inline-block;">\&nbsp;begin&nbsp;{pmatrix}&nbsp;x_&nbsp;{GAME,&nbsp;1}&nbsp;&amp;&nbsp;x_&nbsp;{GAME,&nbsp;2}&nbsp;&amp;&nbsp;x_&nbsp;{GAME,&nbsp;3}&nbsp;\\&nbsp;y_&nbsp;{GAME,&nbsp;1}&nbsp;&amp;&nbsp;y_&nbsp;{GAME,&nbsp;2}&nbsp;&amp;&nbsp;y_&nbsp;{GAME,&nbsp;3}&nbsp;\\&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}&nbsp;=&nbsp;M&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;x_&nbsp;{MAP,&nbsp;1}&nbsp;&amp;&nbsp;x_&nbsp;{MAP,&nbsp;2}&nbsp;&amp;&nbsp;x_&nbsp;{MAP,&nbsp;3}&nbsp;\\&nbsp;y_&nbsp;{MAP,&nbsp;1}&nbsp;&amp;&nbsp;y_&nbsp;{MAP,&nbsp;2}&nbsp;&amp;&nbsp;y_&nbsp;{MAP,&nbsp;3}&nbsp;\\&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>\&nbsp;begin&nbsp;{pmatrix}&nbsp;x_&nbsp;{GAME,&nbsp;1}&nbsp;&amp;&nbsp;x_&nbsp;{GAME,&nbsp;2}&nbsp;&amp;&nbsp;x_&nbsp;{GAME,&nbsp;3}&nbsp;\\&nbsp;y_&nbsp;{GAME,&nbsp;1}&nbsp;&amp;&nbsp;y_&nbsp;{GAME,&nbsp;2}&nbsp;&amp;&nbsp;y_&nbsp;{GAME,&nbsp;3}&nbsp;\\&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}&nbsp;=&nbsp;M&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;x_&nbsp;{MAP,&nbsp;1}&nbsp;&amp;&nbsp;x_&nbsp;{MAP,&nbsp;2}&nbsp;&amp;&nbsp;x_&nbsp;{MAP,&nbsp;3}&nbsp;\\&nbsp;y_&nbsp;{MAP,&nbsp;1}&nbsp;&amp;&nbsp;y_&nbsp;{MAP,&nbsp;2}&nbsp;&amp;&nbsp;y_&nbsp;{MAP,&nbsp;3}&nbsp;\\&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ begin {pmatrix} x_ {GAME, 1} & x_ {GAME, 2} & x_ {GAME, 3} \\ y_ {GAME, 1} & y_ {GAME, 2} & y_ {GAME, 3} \\ 1 & 1 & 1 \ end {pmatrix} = M \ begin {pmatrix} x_ {MAP, 1} & x_ {MAP, 2} & x_ {MAP, 3} \\ y_ {MAP, 1} & y_ {MAP, 2} & y_ {MAP, 3} \\ 1 & 1 & 1 \ end {pmatrix} </script></p><br>  And this can be rewritten as follows (by inverting the matrix to the right and multiplying the whole equation by it): <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>M&amp;#xA0;=&amp;#xA0;\&amp;#xA0;begin&amp;#xA0;{pmatrix}&amp;#xA0;x_&amp;#xA0;{GAME,&amp;#xA0;1}&amp;#xA0;&amp;amp;&amp;#xA0;x_&amp;#xA0;{GAME,&amp;#xA0;2}&amp;#xA0;&amp;amp;&amp;#xA0;x_&amp;#xA0;{GAME,&amp;#xA0;3}&amp;#xA0;\\&amp;#xA0;y_&amp;#xA0;{GAME,&amp;#xA0;1}&amp;#xA0;&amp;amp;&amp;#xA0;y_&amp;#xA0;{GAME,&amp;#xA0;2}&amp;#xA0;&amp;amp;&amp;#xA0;y_&amp;#xA0;{GAME,&amp;#xA0;3}&amp;#xA0;\\&amp;#xA0;1&amp;#xA0;&amp;amp;&amp;#xA0;1&amp;#xA0;&amp;amp;&amp;#xA0;1&amp;#xA0;\&amp;#xA0;end&amp;#xA0;{pmatrix}&amp;#xA0;\&amp;#xA0;begin&amp;#xA0;{pmatrix}&amp;#xA0;x_&amp;#xA0;{MAP,&amp;#xA0;1}&amp;#xA0;&amp;amp;&amp;#xA0;x_&amp;#xA0;{MAP,&amp;#xA0;2}&amp;#xA0;&amp;amp;&amp;#xA0;x_&amp;#xA0;{MAP,&amp;#xA0;3}&amp;#xA0;\\&amp;#xA0;y_&amp;#xA0;{MAP,&amp;#xA0;1}&amp;#xA0;&amp;amp;&amp;#xA0;y_&amp;#xA0;{MAP,&amp;#xA0;2}&amp;#xA0;&amp;amp;&amp;#xA0;y_&amp;#xA0;{MAP,&amp;#xA0;3}&amp;#xA0;\\&amp;#xA0;1&amp;#xA0;&amp;amp;&amp;#xA0;1&amp;#xA0;&amp;amp;&amp;#xA0;1&amp;#xA0;\&amp;#xA0;end&amp;#xA0;{pmatrix}&amp;#xA0;^&amp;#xA0;{-&amp;#xA0;1}</mtext></merror></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><span class="noError" aria-hidden="true" style="display: inline-block;">M&nbsp;=&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;x_&nbsp;{GAME,&nbsp;1}&nbsp;&amp;&nbsp;x_&nbsp;{GAME,&nbsp;2}&nbsp;&amp;&nbsp;x_&nbsp;{GAME,&nbsp;3}&nbsp;\\&nbsp;y_&nbsp;{GAME,&nbsp;1}&nbsp;&amp;&nbsp;y_&nbsp;{GAME,&nbsp;2}&nbsp;&amp;&nbsp;y_&nbsp;{GAME,&nbsp;3}&nbsp;\\&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;x_&nbsp;{MAP,&nbsp;1}&nbsp;&amp;&nbsp;x_&nbsp;{MAP,&nbsp;2}&nbsp;&amp;&nbsp;x_&nbsp;{MAP,&nbsp;3}&nbsp;\\&nbsp;y_&nbsp;{MAP,&nbsp;1}&nbsp;&amp;&nbsp;y_&nbsp;{MAP,&nbsp;2}&nbsp;&amp;&nbsp;y_&nbsp;{MAP,&nbsp;3}&nbsp;\\&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}&nbsp;^&nbsp;{-&nbsp;1}</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>M&nbsp;=&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;x_&nbsp;{GAME,&nbsp;1}&nbsp;&amp;&nbsp;x_&nbsp;{GAME,&nbsp;2}&nbsp;&amp;&nbsp;x_&nbsp;{GAME,&nbsp;3}&nbsp;\\&nbsp;y_&nbsp;{GAME,&nbsp;1}&nbsp;&amp;&nbsp;y_&nbsp;{GAME,&nbsp;2}&nbsp;&amp;&nbsp;y_&nbsp;{GAME,&nbsp;3}&nbsp;\\&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;x_&nbsp;{MAP,&nbsp;1}&nbsp;&amp;&nbsp;x_&nbsp;{MAP,&nbsp;2}&nbsp;&amp;&nbsp;x_&nbsp;{MAP,&nbsp;3}&nbsp;\\&nbsp;y_&nbsp;{MAP,&nbsp;1}&nbsp;&amp;&nbsp;y_&nbsp;{MAP,&nbsp;2}&nbsp;&amp;&nbsp;y_&nbsp;{MAP,&nbsp;3}&nbsp;\\&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}&nbsp;^&nbsp;{-&nbsp;1}</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> M = \ begin {pmatrix} x_ {GAME, 1} & x_ {GAME, 2} & x_ {GAME, 3} \\ y_ {GAME, 1} & y_ {GAME, 2} & y_ {GAME, 3} \\ 1 & 1 & 1 \ end {pmatrix} \ begin {pmatrix} x_ {MAP, 1} & x_ {MAP, 2} & x_ {MAP, 3} \\ y_ {MAP, 1} & y_ {MAP, 2} & y_ {MAP, 3} \\ 1 & 1 & 1 \ end {pmatrix} ^ {- 1} </script></p><br>  In essence, if we take three sets of coordinates in the game world and on the map, then we can use them to recreate their relationships.  In addition, these three points cannot be on one straight line, because in this case the determinant of the map coordinate matrix would be zero and it would not have an inverse matrix. <br><br>  Therefore, I chose the game coordinates of three points, which are fairly widely distributed (to minimize the error) and tried to determine the corresponding pixel coordinates on the map. <br><br>  As a result, I came to this matrix: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>M&amp;#xA0;=&amp;#xA0;\&amp;#xA0;begin&amp;#xA0;{pmatrix}&amp;#xA0;185.38&amp;#xA0;&amp;amp;&amp;#xA0;-0.43327&amp;#xA0;&amp;amp;&amp;#xA0;-126720&amp;#xA0;\\&amp;#xA0;1.2986&amp;#xA0;&amp;amp;&amp;#xA0;-0.018372&amp;#xA0;&amp;amp;&amp;#xA0;218470&amp;#xA0;\\&amp;#xA0;0&amp;#xA0;&amp;amp;&amp;#xA0;0&amp;#xA0;&amp;amp;&amp;#xA0;1&amp;#xA0;\&amp;#xA0;end&amp;#xA0;{pmatrix}</mtext></merror></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><span class="noError" aria-hidden="true" style="display: inline-block;">M&nbsp;=&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;185.38&nbsp;&amp;&nbsp;-0.43327&nbsp;&amp;&nbsp;-126720&nbsp;\\&nbsp;1.2986&nbsp;&amp;&nbsp;-0.018372&nbsp;&amp;&nbsp;218470&nbsp;\\&nbsp;0&nbsp;&amp;&nbsp;0&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>M&nbsp;=&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;185.38&nbsp;&amp;&nbsp;-0.43327&nbsp;&amp;&nbsp;-126720&nbsp;\\&nbsp;1.2986&nbsp;&amp;&nbsp;-0.018372&nbsp;&amp;&nbsp;218470&nbsp;\\&nbsp;0&nbsp;&amp;&nbsp;0&nbsp;&amp;&nbsp;1&nbsp;\&nbsp;end&nbsp;{pmatrix}</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> M = \ begin {pmatrix} 185.38 & -0.43327 & -126720 \\ 1.2986 & -0.018372 & 218470 \\ 0 & 0 & 1 \ end {pmatrix} </script></p><br>  To test it, I plotted the three reference points that I used to calculate it (red), as well as Arion‚Äôs original location (blue dot): the outer door to his house is located in the game coordinates (85730.77, 117960.3, 5081.284), which we through are tied to (1147.33, 555.21). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5b8/6c4/551/5b86c45512ff5f3c6793fc88e08ca570.png"></div><br>  <em>From here I see your home!</em> <br><br>  In the next part, I will tell you how I managed to find Arion and save the Council of Telvanni from collapse. <br><br><h2>  Part 5 </h2><br>  A good visualization of where Arion might be is already very close.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I chose the stupidest approach: go through all the pixels of the map, convert each of them to the point of the game world, and find the time it would take Arion to get there (using the method I mentioned above: go through all the points of the graph, which we know the shortest time of movement and find the one for which the total time of movement (the shortest time of movement to this point + time to move from this point on foot to the destination point) is the smallest). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But I forgot that I work in Python and that I will have to go for about 2400 possible routes through external points for each point of the map. And there are only 1650x1900 = about 3 million points. Of course, you can come up wisely and use different optimizations (for example, collect external points that are close enough to each other and process them as one, or use the triangle inequality (what I said in the previous part), or consider blocks of 2x2 maps, not every pixel , or use all 4 cores of my processor instead of one). Or I can just make a decision in a C ++ program.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Therefore, I have merged into the file a dump of the list of known external coordinates and the time of the shortest routes to them, as well as the in-game coordinates of more than three million map points that interested me. The program took them and gave the shortest time for each coordinate considered that Arion would have needed to get there from his tower. In fact, it took 40 lines of code and 10 seconds of calculations. It is rather surprising how quickly problems can be solved if you communicate directly with the hardware. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then I used the contour chart from matplotlib to visualize the resulting heat map. I did not manage to put it on the map in its original resolution, but the wizards were still extremely impressed and said that I could contact them when I became interested in finding the means for my startup.</font></font><br><br><h2>  ! </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e4f/45f/f67/e4f45ff67a61a23b1558c30ef96615e6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It actually makes sense. There is a two-hour circle around Arion‚Äôs house (in the northeastern part of the island), from which he can walk or teleport to Wolverin Hall using Divine Intervention (to the island east of Vanderfell). In Wolverin Hall there is the Mages Guild, so he could instantly move to one of the four main cities (circle along the western edge of the island). That is, there are quite a few places that can be reached in two hours! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After that, he could take a silt strider or a boat, which would slow him down. For four hours, he could barely get to Gnisis (the northeastern corner of the island) or Maar Ghana (a small arc in the upper part of the four-hour contour around the main settlements). Of course, he could walk four hours from his starting point, but he would not get far.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In six hours he could have reached anywhere in the island, and in eight hours he could reach the northern edges of Dagon Fel, a small island north of Vvardenfell. Finally, after about 11 hours, he was likely to have breakfast with </font></font><a href="http://www.uesp.net/wiki/Morrowind:Big_Head%26"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bolshegolov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the most isolated corner of Morrowind. Maybe he had some </font></font><a href="http://www.uesp.net/wiki/Morrowind:Sheogorath%26"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">business there</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The wizards said that the last time they saw Arion was at about two in the morning, so by this time he had been away for almost 10 hours. Fortunately, while we were trying to find out if he could choose the most efficient route, in order to get as far away from his tower as possible, we heard a loud noise from the neighboring cabinet, from which Arion was sleeping, but unscathed.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the end, he liked my outline schedule so much that he hung it on his wall. </font><font style="vertical-align: inherit;">Some say that the tower manager still uses it to search for people lost after Arion‚Äôs crazy parties. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the next part of the Morrowind project, we will talk about my appointment to the position in the Vvardenfell Bureau of National Statistics to analyze the island‚Äôs demography.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Part 6 </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, Arion returned to his tower, and the entire population of the island maximized the effectiveness of their travels. </font><font style="vertical-align: inherit;">It is time to take on another task and create some more beautiful pictures. </font><font style="vertical-align: inherit;">The next question was simple: where do all these people live and what do they do?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's try to use all the power of our excellent matrix, which transforms in-game coordinates into coordinates on a map and create something like a heat map of the population. This is easy to do, because we already have all the pieces of the puzzle: we know where all the NPCs are and what they do, their race and gender. The only problem with working with NPCs is in the inner cells: remember that the inner spaces are completely separate mini-worlds? This means that we cannot simply display the character‚Äôs location by taking the coordinates of two doors and adding the NPC offset relative to the door, because the inside of the interior is often larger than they look from the outside. Since we will only be able to review the world, I decided not to care about such accuracy: the external location of the NPC is just the location of the nearest external door,to which they can get close (by the number of cells that they must pass in order to go outside).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Armed with these tools, I walked around all the NPCs in the world, got their external location, and converted it to coordinates on a map. I had a matrix the size of a map in which these coordinates accumulated: the number for each pixel was the number of NPCs whose external coordinates correspond to this square. This meant that I would get a disproportionately large number of people accumulating at the doors of densely populated interiors, which was not optimal because it was difficult to see the image (after all, it was just one pixel). In addition, it poorly reflected the in-game reality: first of all, we are interested in the population of individual cities / regions, but people still do not stand in one place, but wander around the neighborhood. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Therefore, I applied to my matrix</font></font><a href="https://en.wikipedia.org/wiki/Gaussian_blur"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gaussian blur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, one pixel instead of 10 people is assigned to about 2.2, for the neighboring pixel - 1.1, for a pixel in two pixels from the original one - 0.5, and so on. </font><font style="vertical-align: inherit;">This is similar to the fact that we cut people into pieces and throw these parts of the bodies so that a comfortable pile of them is assembled, because that's how we do it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Having finished with this, I normalized the matrix so that all values ‚Äã‚Äãwere in the range from 0 to 1, applied one of the </font></font><a href="https://matplotlib.org/examples/color/colormaps_reference.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">many color maps available in matplotlib</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (I liked the card called blues) and mixed it with the original map. </font><font style="vertical-align: inherit;">I also experimented with using the function of converting input values ‚Äã‚Äãbefore transferring them to a color map, because I did not like its default appearance - I chose a </font></font><a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25BE%25D0%25B3%25D0%25B8%25D1%2581%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B5_%25D1%2583%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logistic function</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>k</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo>&amp;#x2212;</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msup></mrow></mfrac></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.179ex" height="5.431ex" viewBox="0 -1402.6 8257.7 2338.3" role="img" focusable="false" style="vertical-align: -2.173ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-74" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-29" x="1301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-3D" x="1968" y="0"></use><g transform="translate(2747,0)"><g transform="translate(397,0)"><rect stroke="none" width="4992" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-31" x="2246" y="676"></use><g transform="translate(60,-790)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-2B" x="722" y="0"></use><g transform="translate(1723,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,288)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6B" x="778" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-28" x="1300" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-74" x="1689" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-2212" x="2051" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-63" x="2829" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMAIN-29" x="3263" y="0"></use></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><mo>‚àí</mo><mi>k</mi><mo stretchy="false">(</mo><mi>t</mi><mo>‚àí</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></msup></mrow></mfrac></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5">f(t) = \frac{1}{1 + e^{-k(t-c)}}</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I have not used any methodology here: variable </font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> changes the slope of the curve (the speed of movement of values ‚Äã‚Äãfrom the left side of the color map to the right side and the increase in brightness), and the variable</font></font><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> k </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> changes the centering function, so I experimented with them until the picture looked good. </font><font style="vertical-align: inherit;">With this in mind, let's see what happened as a result!</font></font><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.455ex" viewBox="0 -520.7 433.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/354268/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgjrpYWK2IjyeOKEBU-tDCEgFhCeQ#MJMATHI-63" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> c </script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/56a/186/3a8/56a1863a86698477c0f9d5d91fe58f16.jpg"></div><br> <code>draw_npcs(filter_sigma=25, sigmoid_k=8, sigmoid_c=0.2, output='map_population.png')</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In large cities we got dark spots. From bottom to top: </font></font><a href="http://en.uesp.net/wiki/Morrowind:Vivec_(city)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vivek</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (and </font></font><a href="http://en.uesp.net/wiki/Morrowind:Ebonheart"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ebonhart</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> next to it </font><font style="vertical-align: inherit;">), then </font></font><a href="http://en.uesp.net/wiki/Morrowind:Balmora"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Balmor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (in the southwestern part of the island), </font></font><a href="http://en.uesp.net/wiki/Morrowind:Sadrith_Mora"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sadrit Mora</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (in the east), </font></font><a href="http://en.uesp.net/wiki/Morrowind:Ald%26"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ald'Rune</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (north of Balmora) and </font></font><a href="http://en.uesp.net/wiki/Morrowind:Gnisis"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gnisis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (northeast of Ald ' Fleece). There are also smaller spots here - either small settlements or large dungeons / fortresses / shrines. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What else can we do about it? How about mapping all the </font></font><a href="http://en.uesp.net/wiki/Morrowind:Dunmer"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dark elves</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? Yes, easily, just pass not all NPCs:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9a7/c57/324/9a7c573244af3cb66125be76638eb416.jpg"></div><br> <code>draw_npcs(filter_sigma=25, mark_npcs=[n for n in npcs if n.race == 'Dark Elf'], sigmoid_k=8, sigmoid_c=0.2, output='map_population_darkelf.png')</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yes, it looks </font></font><a href="https://xkcd.com/1138/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">exactly like a heat map of the population</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Maybe check where they are too much or too little? We can separate these two layers one on another and get the proportion of dark elves in the whole population: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b4c/56f/b0e/b4c56fb0e909d827dcccf5221785cdcf.jpg"> <code>draw_npcs(relative=True, filter_sigma=50, mark_npcs=[n for n in npcs if n.race == 'Dark Elf'], sigmoid_k=4, sigmoid_c=0.5, output='map_population_darkelf_relative.png')</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For this picture I had to play </font><font style="vertical-align: inherit;">around </font><font style="vertical-align: inherit;">with the parameters (I increased the blur radius and moved the center of the sigmoidal curve to 0.5), but we can see that dark elves (Aboriginal Morrowind is less represented in the southwestern part of the island (it is more cosmopolitan and hospitable towards strangers) and more represented in the eastern territories, as well as around </font></font><a href="http://en.uesp.net/wiki/Morrowind:Ashlanders"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ashlander camps</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (which are almost entirely composed of them). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What else can we do? There is slavery in Morrowind! Let's find out where all the slaves are concentrated:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e9f/284/1d7/e9f2841d7fbeb5f62a8aa8344e3a2ee8.jpg"></div><br> <code>draw_npcs(relative=True, filter_sigma=25, mark_npcs=[n for n in npcs if n.class_name == 'Slave'], sigmoid_k=8, sigmoid_c=0.2, output='map_population_slave_relative.png')</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are no spots around big cities - this is logical, because it is not a relative share. Instead, spotted random dungeons and plantations of the world, which contain slaves, including </font></font><a href="http://en.uesp.net/wiki/Morrowind:Abebaal_Egg_Mine"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Abebaal Egg Mine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="http://en.uesp.net/wiki/Morrowind:Dren_Plantation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drain Plantation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="http://en.uesp.net/wiki/Morrowind:Slave_Markets"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">several slave markets</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://en.uesp.net/wiki/Morrowind:Rotheran"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rotheran</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><a href="https://en.uesp.net/wiki/Morrowind:Hlormaren"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chlormairen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (interestingly, for the latter, the spot (to the west of Balmora, behind great water) in the west of the fortress itself, because the slaves are kept in the sewer, the outlet of which is located somewhere here). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, we would never use this tool for our own selfish purposes:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c1/747/184/4c1747184422746876ef17d7ef46e2fb.jpg"></div><br> <code>draw_npcs(relative=True, filter_sigma=50, mark_npcs=[n for n in npcs if n.is_female], sigmoid_k=12, sigmoid_c=0.7, output='map_population_female_relative.png')</code> <br> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are very few places on the island in which there are too many women (note that I set the center of the sigmoidal curve to 70%). One of them is the city of </font></font><a href="http://en.uesp.net/wiki/Morrowind:Tel_Mora"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tel Mora</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the northeast. This happened because the governor of the city "does not like the presence of men" and all the inhabitants of this city are actually women. Another place is </font></font><a href="http://en.uesp.net/wiki/Morrowind:Odirniran_(place)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Odirniran</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the southeast, Telvanni fortress, attacked by House Hlaalu. To the northwest there is an </font></font><a href="http://en.uesp.net/wiki/Morrowind:Assu"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with two wizards, and to the north of him there is </font></font><a href="http://en.uesp.net/wiki/Morrowind:Tel_Uvirith"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tel Uvir</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a fortress being built for the player as part of the Telvanni quest line. At the beginning of the game it is disabled (and invisible), but the program. Of course, it does not care.</font></font><br><br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally, I broke the code used to get all the graphs into a set of modules and </font></font><a href="https://github.com/mildbyte/project-morrowind"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uploaded it to GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">You need the usual scientific Python toolkit (NumPy, SciPy, matplotlib, and PIL) and the C ++ compiler. </font><font style="vertical-align: inherit;">I decided that it would be a bad idea to publish the game data dump I received, so you will have to do it yourself: you will need the original Morrowind.esm and Enchanted Editor data file (instructions for creating the dump are in the README). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Given all this, I ran the code again, and he gave me a set of images similar to those used in this post, which I was incredibly happy about.</font></font></div><p>Source: <a href="https://habr.com/ru/post/354268/">https://habr.com/ru/post/354268/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354258/index.html">And if we do not design a system for managing the production of IT products. Part 2. Basic solution structure</a></li>
<li><a href="../354260/index.html">How to earn your first $ 100 in the Google Play Market - my experience</a></li>
<li><a href="../354262/index.html">"The secret passenger": collecting feedback from consumers "on the fly"</a></li>
<li><a href="../354264/index.html">What's New in PostgreSQL 11: JSONB Transforms</a></li>
<li><a href="../354266/index.html">Internship in e-Legion</a></li>
<li><a href="../354270/index.html">Insolence and enthusiasm for rapid growth from Aviasales</a></li>
<li><a href="../354274/index.html">Using libpam when setting up SOCKS Dante server</a></li>
<li><a href="../354276/index.html">"End of the World" will not be</a></li>
<li><a href="../354278/index.html">Right-sided assignment and other unusual programming techniques in C #</a></li>
<li><a href="../354280/index.html">Javascript es6: write less - do more</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>