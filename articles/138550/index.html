<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Performance test of containers and pointers to objects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 

 This article describes the performance test of filling (push_back) containers with objects containing different types of pointers to d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Performance test of containers and pointers to objects</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br><br>  This article describes the performance test of <b>filling</b> (push_back) containers with objects containing different types of pointers to different data types.  The test is complex, combining typical tasks of creating a pointer to an object, copying an object, filling a container, freeing the memory allocated for an object by means of a smart pointer and the standard delete operator.  Three containers of the standard template library will be tested - vector, list, deque, three types of pointers - std :: shared_ptr, std :: auto_ptr and a simple pointer.  As test data types (for which pointers will be created), long, std :: string, char, an arbitrary class are used. <br><br><h4>  Test description </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The source code is written in MS Visual Studio 2010, and requires the compiler to support lambda functions. <br>  Let some class contain a description of the pointer T to the data type Type. <a name="habracut"></a>  The constructor will create an object and initialize it with the passed parameter.  The copy constructor will copy the value located at the address of the specified object, as well as its name and the requirement to output messages about the life of the object to the console. <br><br><pre><code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Type</span></span></span><span class="hljs-class"> &gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test_type_and_smart_pointer</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: test_type_and_smart_pointer( <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>&amp; val, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> msg, Type type_val ) : _msg( msg ), _name( val ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( _msg ) <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"created "</span></span> &lt;&lt; _name &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; x.reset( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Type ); *x = type_val; } ~test_type_and_smart_pointer() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( _msg ) <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"deleted "</span></span> &lt;&lt; _name &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } test_type_and_smart_pointer(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> test_type_and_smart_pointer &amp; W) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( W._msg ) <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"copied "</span></span> &lt;&lt; W._name &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;x.reset( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Type ); *(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;x) = *(Wx); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;_name = W._name; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;_msg = W._msg; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: T x; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _msg; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> _name; };</code> </pre> <br><br>  Template parameters: <br><ul><li>  class T is the default smart pointer class </li><li>  typename Type - the data type of the object being created. </li></ul><br>  Members of the test_type_and_smart_pointer class: <br><ul><li>  T x - the object pointer itself, </li><li>  bool _msg - informational messages output flag </li><li>  std :: string _name is the name of the created object. </li></ul><br><br>  Create a similar class for the case if the pointer T to Type is a standard. <br><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">typename</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Type</span></span></span><span class="hljs-class"> &gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test_type_and_simple_pointer</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: test_type_and_simple_pointer( <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>&amp; val, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> msg, Type type_val ) : _msg( msg ), _name( val ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( _msg ) <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"created "</span></span> &lt;&lt; _name &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; x = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Type; *x = type_val; } ~test_type_and_simple_pointer() { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> x; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( _msg ) <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"deleted "</span></span> &lt;&lt; _name &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } test_type_and_simple_pointer(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> test_type_and_simple_pointer &amp; W) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( W._msg ) <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"copied "</span></span> &lt;&lt; W._name &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;x = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Type( *(Wx) ); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;_name = W._name; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;_msg = W._msg; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: T x; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _msg; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> _name; };</code> </pre><br><br>  Now we need functions that create the above described objects: <br><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> _Ptr, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Container, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> msg &gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_smart_ptr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> big_data, T val )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>; test_type_and_smart_pointer&lt; _Ptr, T &gt; x( <span class="hljs-string"><span class="hljs-string">"a001"</span></span>, msg, val ); test_type_and_smart_pointer&lt; _Ptr, T &gt; x2( x ); Container cnt; cnt.push_back( x ); cnt.push_back( x2 ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( big_data ) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= <span class="hljs-number"><span class="hljs-number">100</span></span>; i++ ) { test_type_and_smart_pointer&lt; _Ptr, T &gt; xx( <span class="hljs-string"><span class="hljs-string">"a002"</span></span>, msg, val ); test_type_and_smart_pointer&lt; _Ptr, T &gt; xx2( xx ); cnt.push_back( xx ); cnt.push_back( xx2 ); } cnt.clear(); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt; <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Container, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> msg &gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_simple_ptr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> big_data, T val )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>; test_type_and_simple_pointer&lt; T*, T&gt; x( <span class="hljs-string"><span class="hljs-string">"b001"</span></span>, msg, val ); test_type_and_simple_pointer&lt; T*, T&gt; x2( x ); Container cnt; cnt.push_back( x ); cnt.push_back( x2 ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( big_data ) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= <span class="hljs-number"><span class="hljs-number">100</span></span>; i++ ) { test_type_and_simple_pointer&lt; T*, T&gt; xx( <span class="hljs-string"><span class="hljs-string">"b002"</span></span>, msg, val ); test_type_and_simple_pointer&lt; T*, T&gt; xx2( xx ); cnt.push_back( xx ); cnt.push_back( xx2 ); } cnt.clear(); }</code> </pre> <br><br>  For example, these functions will work in two modes: creating a pair of pointers to objects and placing them in a container, and cyclically creating pointers to objects and filling the container. <br>  The time spent executing the functions test_smart_ptr and test_simple_ptr will measure _time_test: <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">double</span></span> _time_test( std::<span class="hljs-keyword"><span class="hljs-keyword">function</span></span>&lt; <span class="hljs-type"><span class="hljs-type">void</span></span>() &gt; test_func, unsigned <span class="hljs-type"><span class="hljs-type">int</span></span> times ) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> namespace std; <span class="hljs-type"><span class="hljs-type">double</span></span> start = <span class="hljs-number"><span class="hljs-number">0</span></span>, end = <span class="hljs-number"><span class="hljs-number">0</span></span>; start = GetTickCount(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( unsigned <span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; times; i++ ) { test_func(); } end = GetTickCount() - <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>; //cout &lt;&lt; "Elapsed ms: " &lt;&lt; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> &lt;&lt; // " for " &lt;&lt; times &lt;&lt; " times " &lt;&lt; endl; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; }</code> </pre><br><br>  Required header files: <br><br><pre> <code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> <span class="hljs-comment"><span class="hljs-comment">"iostream"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> <span class="hljs-comment"><span class="hljs-comment">"string"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> <span class="hljs-comment"><span class="hljs-comment">"vector"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> <span class="hljs-comment"><span class="hljs-comment">"list"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> <span class="hljs-comment"><span class="hljs-comment">"deque "</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">Windows</span></span>.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> <span class="hljs-comment"><span class="hljs-comment">"functional"</span></span></code> </pre><br><br>  A simplest class without dynamic memory allocations is used as an object of an arbitrary type. <br><br><pre> <code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">some_obj</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: some_obj() { i = <span class="hljs-number"><span class="hljs-number">90000</span></span>; s = <span class="hljs-string"><span class="hljs-string">"1231231231231231231232"</span></span>; d = <span class="hljs-number"><span class="hljs-number">39482.27392</span></span>; } ~some_obj() { } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> s; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> d; };</code> </pre><br><br>  So, how was the test.  72 lambda functions are described, each of which, upon completion, brings the heap to its initial state. <br><br><pre> <code class="hljs ruby">int main() { using namespace std; const long long_val = <span class="hljs-number"><span class="hljs-number">900000000</span></span>; const char ch = <span class="hljs-string"><span class="hljs-string">'a'</span></span>; const string str = <span class="hljs-string"><span class="hljs-string">"abc"</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ auto f_01 = [&amp;]() -&gt; void { test_smart_ptr&lt; shared_ptr&lt; long &gt;, long, vector&lt; test_type_and_smart_pointer&lt; shared_ptr&lt; long &gt;, long &gt; &gt;, false &gt;( false, long_val ); }; auto f_02 = [&amp;]() -&gt; void { test_smart_ptr&lt; shared_ptr&lt; char &gt;, char, vector&lt; test_type_and_smart_pointer&lt; shared_ptr&lt; char &gt;, char &gt; &gt;, false &gt;( false, ch ); }; auto f_03 = [&amp;]() -&gt; void { test_smart_ptr&lt; shared_ptr&lt; string &gt;, string, vector&lt; test_type_and_smart_pointer&lt; shared_ptr&lt; string &gt;, string &gt; &gt;, false &gt;( false, str ); }; auto f_04 = [&amp;]() -&gt; void { some_obj x; test_smart_ptr&lt; shared_ptr&lt; some_obj &gt;, some_obj, vector&lt; test_type_and_smart_pointer&lt; shared_ptr&lt; some_obj &gt;, some_obj &gt; &gt;, false &gt;( false, x ); }; ... _time_test( f_01, 100000 ); _time_test( f_02, 100000 ); _time_test( f_03, 100000 ); _time_test( f_04, 100000 ); ... return 0; }</span></span></code> </pre><br><br>  The full code of the main function is not given, because it is cumbersome, but in the first block of lambda functions for the shared_ptr pointer, the general trend of pattern parameter combinations is visible. <br><br>  Each f_nn function was performed 15 times and the measurement result was averaged (the launch was in the release mode <b>not from under the studio</b> ).  The unit takes the smallest elapsed time, i.e.  the remaining values ‚Äã‚Äãare in proportion. <br><br><h4>  Test results </h4><br><br>  The color indicates the fastest data type <b>for each pointer type</b> among all containers: <br><br> <a href="http://fastpic.ru/"><img src="http://i31.fastpic.ru/big/2012/0219/6c/46fa59a6cd70ba1355b57472994af66c.png"></a> <br><br>  The fastest data types <b>for each container</b> among all pointer types: <br><br> <a href="http://fastpic.ru/"><img src="http://i31.fastpic.ru/big/2012/0219/4c/25f9b2765dd026a32533a146e704314c.png"></a> <br><br>  The fastest container when filling in all data types and <b>in all pointers</b> : <br><br> <a href="http://fastpic.ru/"><img src="http://i31.fastpic.ru/big/2012/0219/a2/5fa279866d215b68b4d6e87b4d56e6a2.png"></a> <br><br><h4>  What can be useful to extract? </h4><br><br>  First, the test results show which container fills up faster. <br>  Secondly, it is clear how pointers on typical tasks work in proportion to speed. </div><p>Source: <a href="https://habr.com/ru/post/138550/">https://habr.com/ru/post/138550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138542/index.html">About how things are with data centers in Russia in fact</a></li>
<li><a href="../138543/index.html">In the footsteps of human curiosity</a></li>
<li><a href="../138544/index.html">Comparing libraries for archiving in .Net</a></li>
<li><a href="../138546/index.html">For those who want the weird: monads in Python</a></li>
<li><a href="../138549/index.html">ERP Development</a></li>
<li><a href="../138551/index.html">The free free font Prosto has been published</a></li>
<li><a href="../138553/index.html">Sony Ericsson officially becomes Sony</a></li>
<li><a href="../138554/index.html">Review of the registrar AdvoCam-HD2</a></li>
<li><a href="../138555/index.html">Guidelines for choosing a records management system: a document viewer</a></li>
<li><a href="../138557/index.html">Updated MSDN Russian-language web development section: new design, new training courses and articles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>