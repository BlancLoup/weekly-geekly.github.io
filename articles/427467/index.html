<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The quickest introduction to Reactive Programming</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The purpose of this article is to show by example why reactive programming is needed, how it relates to functional programming, and how it can be used...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The quickest introduction to Reactive Programming</h1><div class="post__text post__text-html js-mediator-article"><p>  The purpose of this article is to show by example why reactive programming is needed, how it relates to functional programming, and how it can be used to write declarative code that can be easily adapted to new requirements.  In addition, I want to do this as briefly and simply as possible with an example close to the real one. </p><br><p> Take the following task: <br>  <em>There is a service with REST API and endpoint <code>/people</code> .</em>  <em>When a POST request to this endpoint is created, a new entity is created.</em>  <em>Write a function that accepts an array of objects of the form <code>{ name: 'Max' }</code> and creates a set of entities using the API (in English, this is called a batch operation).</em> <em><br></em> </p><br><p>  Let's solve this problem in an imperative style: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> request = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'superagent'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">batchCreate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bodies</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> calls = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> body <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> bodies) { calls.push( request .post(<span class="hljs-string"><span class="hljs-string">'/people'</span></span>) .send(body) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.status) ) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all(calls) }</code> </pre><br><p>  For comparison, let's rewrite this piece of code in a functional style.  For simplicity, the functional style will be understood as: </p><br><ol><li>  Using functional primitives ( <em>.map</em> , <em>.filter</em> , <em>.reduce</em> ) instead of imperative loops ( <em>for</em> , <em>while</em> ) </li><li>  The code is organized in "pure" functions - they depend only on their arguments and do not depend on the state of the system </li></ol><a name="habracut"></a><br><p>  Functional code: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> request = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'superagent'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">batchCreate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bodies</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> calls = bodies.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">body</span></span></span><span class="hljs-function"> =&gt;</span></span> request .post(<span class="hljs-string"><span class="hljs-string">'/people'</span></span>) .send(body) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.status) ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.all(calls) }</code> </pre> <br><p>  We received a piece of code of the same size and it is worth admitting that it is not clear why this piece is better than the previous one. <br>  In order to understand how the second piece of code is better - you need to start changing the code, imagine that a new requirement has appeared for the original task: <br>  <em>The service that we call has a limit on the number of requests in a period of time: in one second one client can execute no more than five requests.</em>  <em>Performing more requests will cause the service to return a 429 HTTP error (too many requests).</em> <em><br></em> </p><br><p>  In this place, it is probably worth stopping and trying to solve the problem yourself,% username% </p><br><p>  Let's take our functional code as a basis and try to change it.  The main problem of "pure" functional programming is that it does not "know" anything - about the runtime environment and input-output (in English there is a <strong>side effect</strong> for this), but in practice we are constantly working with them. <br>  To fill this gap, Reactive Programming comes to the rescue - a set of approaches trying to solve the problem of side effects.  The most famous implementation of this paradigm is the <a href="https://github.com/ReactiveX/rxjs">Rx</a> library, which uses the concept of <a href="https://en.wikipedia.org/wiki/Reactive_Streams">reactive streams</a> </p><br><p>  What is reactive streams?  In short, this is an approach that allows you to apply functional primitives (.map, .filter, .reduce) to something distributed over time. </p><br><p>  For example, we transmit a set of commands over the network - we do not need to wait until we receive the entire set, we represent it as a reactive stream and can work with it.  Here there are two more important concepts: </p><br><ul><li>  the flow can be infinite or arbitrarily long distributed in time </li><li>  the sending party sends the command only if the receiving one is ready to process it (backpressure) </li></ul><br><p>  The purpose of this article is to find easy ways, therefore, we will take the <a href="https://highlandjs.org/">Highland</a> library, which tries to solve the same problem as Rx, but is much easier to learn.  The idea behind it is simple: let's take <a href="https://nodejs.org/api/stream.html">Node.js streams</a> as a basis and we will ‚Äúpour‚Äù data from one Stream into another. </p><br><p>  Let‚Äôs get started: let's start with a simple one ‚Äî let's make our code ‚Äúreactive‚Äù without adding new functionality </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> request = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'superagent'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> H = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'highland'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">batchCreate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bodies</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> H(bodies) .flatMap(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">body</span></span></span><span class="hljs-function"> =&gt;</span></span> H(request .post(<span class="hljs-string"><span class="hljs-string">'localhost:3000/people'</span></span>) .send(body) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.status) ) ) .collect() .toPromise(<span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>) }</code> </pre> <br><p>  What you should pay attention to: </p><br><ul><li>  H (bodies) - we create stream from array </li><li>  .flatmap and callback which it accepts.  The idea is quite simple - we wrap the Promise into a thread constructor in order to get a stream with a single value (or an error. It is important to understand that this is the value, not the Promise). <br>  As a result, it gives us a stream of threads - with the help of flatMap we smooth it into one stream of values ‚Äã‚Äãthat we can operate on (who said the monad?) </li><li>  .collect - we need to collect all values ‚Äã‚Äãat one "point" into an array </li><li>  .toPromise - returns us a Promise that will be fulfilled at the moment when we have the value from the stream </li></ul><br><p>  Now let's try to implement our requirement: </p><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> request = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'superagent'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> H = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'highland'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">batchCreate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">bodies</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> H(bodies) .flatMap(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">body</span></span></span><span class="hljs-function"> =&gt;</span></span> H(request .post(<span class="hljs-string"><span class="hljs-string">'localhost:3000/people'</span></span>) .send(body) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.status) ) ) .ratelimit(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) .collect() .toPromise(<span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>) }</code> </pre> <br><p>  Thanks to the concept of backpressure, this is just one line of .ratelimit in this paradigm.  In Rx, this takes up about <a href="https://www.g9labs.com/2016/03/21/lossless-rate-limiting-with-rxjs/">the same amount of space</a> . </p><br><p>  Well, that's all, I am interested in your opinion: </p><br><ul><li>  Did I manage to achieve the result declared at the beginning of the article? </li><li>  Is it possible to achieve a similar result using a mandatory approach? </li><li>  Are you interested in Reactive programming? </li></ul><br><p>  PS: here you can find another one of <a href="https://habr.com/post/325320/">my articles about Reactive Programming</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/427467/">https://habr.com/ru/post/427467/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../427455/index.html">Satellite provider OneWeb will try to get frequencies in Russia</a></li>
<li><a href="../427457/index.html">"The third wave" of AI and systems for state security</a></li>
<li><a href="../427459/index.html">LED lamps Diall from the store Castorama</a></li>
<li><a href="../427461/index.html">The beauty of non-unnamed JavaScript functions</a></li>
<li><a href="../427465/index.html">What happens behind the scenes C #: the basics of working with the stack</a></li>
<li><a href="../427469/index.html">Revenue and profits of electronics manufacturers, or who has more margin</a></li>
<li><a href="../427471/index.html">Developing unmanned vehicles in high school with LEGO EV3</a></li>
<li><a href="../427473/index.html">What problems Temlida can solve with the game</a></li>
<li><a href="../427475/index.html">Android LiveData at Kotlin using Retrofit and coroutines</a></li>
<li><a href="../427477/index.html">We are preparing hierarchical clustering or how I have identified specializations from resumes.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>