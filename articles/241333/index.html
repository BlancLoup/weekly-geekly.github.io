<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Building a mirrored volume on Windows Server 2008 r2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Understanding Disk Mirroring (RAID 1) 
 When using a mirrored raid array, two identical volumes are located on two different physical disks. Any data ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Building a mirrored volume on Windows Server 2008 r2</h1><div class="post__text post__text-html js-mediator-article"><h4>  Understanding Disk Mirroring (RAID 1) </h4><br>  When using a mirrored raid array, two identical volumes are located on two different physical disks.  Any data recorded in the mirrored volume is actually recorded on both disks, so that in case of failure of one of the disks, the data are available on the second.  Unlike a stripe, when I / O speeds increase due to the distribution of one logical volume across multiple physical disks and parallel block write / read, mirroring reduces performance due to the fact that all transactions write data to each disk in the array. <br><br><h4>  Create a mirror (RAID 1) using ‚ÄúDisk Management‚Äù </h4><br>  To create a mirrored disk array, the disks must be converted from normal to dynamic.  In this section we analyze the possibility of creating a ‚Äúmirror‚Äù of two identical hard disks in Windows 2008. <br><img src="https://habrastorage.org/files/8af/e46/2a8/8afe462a8a7a444ea6fc2fd97d2c5c15.png"><br><a name="habracut"></a><br>  To do this, run "Disk Management".  This can be done from the command line by executing the <b>compmgmt.msc</b> command or from the ‚ÄúStart‚Äù menu by selecting Storage -&gt; Disk Management. <br>  In our example, the system contains 3 disks, numbered 0, 1 and 2, respectively.  Disk 0 is a system disk, disks 1 and 2 will be used to create a ‚Äúmirror‚Äù. <br>  In Disk Management, right-click on an unlabeled area in the graphic display of the first disk used for the mirrored volume.  Select "New Mirrored Volume ..." to launch the New Mirror Volume Wizard.  Clicking "Next" on the welcome screen will take you to the disk selection window.  As mentioned earlier, the mirror array should consist of two disks.  In the "Selected" column, the wizard will display only the currently selected disk.  More than one disk is required to continue.  To add a disk to a mirrored volume, select the second disk from the available disks in the left column and click ‚ÄúAdd‚Äù: <br><br><img src="https://habrastorage.org/files/ca9/9b4/e95/ca99b4e95a2a4bf29b80f84ae4f5ea70.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After selecting the drives, click Next to create and assign a drive letter or mount point to the volume.  The ‚ÄúNext‚Äù button will bring up the ‚ÄúFormat Volume‚Äù window, where you can select the file system type and the possibility of compression.  To display a summary of the operation being performed, click Next.  To confirm the operation, click "Finish";  the volumes will be formatted and a mirrored volume will be created, ready to use. <br><br>  If you use only two disks, you can get the following picture: <br><br><img src="https://habrastorage.org/files/1a6/3b5/ec0/1a63b5ec05004deb9963110ffb1968c2.jpg"><br><br>  And to get rid of the reserved area, which is present on only one disk, we will perform the following actions: <br>  Run the command with administrative privileges <br><pre> bcdboot c: \ windows / sc:
</pre><br>  This command creates a system partition.  More information on using bcdboot is on <a href="http://technet.microsoft.com/ru-ru/library/dd744347(v%3Dws.10).aspx">the Microsoft technical site</a> . <br>  After receiving the message ‚ÄúBoot files successfully created.‚Äù, Go to disk management and mark section C: as active.  After that, reboot and delete this volume using Disk Management. <br><br><h4>  Creating a mirror (RAID 1) array on the command line </h4><br>  You can also create a mirrored volume from the command line using the diskpart application.  It can be run from an open command window or from the Start menu by typing ‚Äúdiskpart‚Äù in the line.  The DISKPART&gt; prompt appears and shows that diskpart is up and ready to go. <br>  First of all, we will find out which disks are connected to the server.  This information can be found using the ‚Äúlist disk‚Äù command: <br><pre> DISKPART&gt; list disk

   Disk ### Status Size Free Dyn Gpt
   -------- ---------- ------- ------- --- ---
   Disk 0 Online 30 GB 0 B
   Disk 1 Online 8 GB 8189 MB
   Disk 2 Online 8 GB 8189 MB
</pre><br><br>  As an example, let's merge disks 1 and 2 into a mirrored volume. To do this, we first create a simple volume on the first disk and add a second disk for mirroring. <br>  The first volume is created using the ‚Äúcreate volume‚Äù command and the ‚Äúdisk =‚Äù parameter.  The size of the volume can be set by the additional parameter ‚Äúsize =‚Äù.  Without this parameter, diskpart will create a volume the size of all available disk space.  For example: <br><pre> DISKPART&gt; create volume simple disk = 1
</pre><br>  The first volume has been created and now we are adding disk 2 as a mirror volume. To do this, a simple command is executed: <br><pre> add disk = 2
</pre><br>  To check the new configuration, use the ‚Äúlist volume‚Äù command: <br><pre> DISKPART&gt; list volume

   Volume ### Ltr Label Fs Type Size Status Info
   ---------- --- ----------- ----- ---------- ------- ---- ----- --------
   Volume 0 C NTFS Partition 30 GB Healthy System
 * Volume 1 RAW Mirror 8189 MB Healthy
</pre><br>  As you can see, the new volume is displayed as "Volume 1" with the type "Mirror".  ‚ÄúRAW‚Äù is specified as a file system because the file system has not yet been formatted.  This can be done using the same diskpart application: <br><pre> DISKPART&gt; select volume 1
 DISKPART&gt; format fs = ntfs label = "Mirrored Volume"

   100 percent completed

 DiskPart successfully formatted the volume.
</pre><br>  After formatting, assign a literal value or mount point to it: <br>  Assign a letter value: <br><pre> DISKPART&gt; assign letter = E:

 Diskpart successfully assigned drive letter or mount point.
</pre><br>  Assign mount point: <br><pre> DISKPART&gt; assign mount = \ MIRROR

 Diskpart successfully assigned drive letter or mount point.
</pre><br>  After successful completion of all operations, the new mirrored volume is ready for use. <br><br><h4>  Adding a mirrored volume to an existing one </h4><br>  You can create a mirrored raid array by adding a volume to an existing one using disk management or diskpart from the command line.  When adding a mirror to an existing volume, Windows creates a second volume of the same size and type of file system on the second disk and copies (this process is also called synchronization) data into the mirror. <br>  To mirror an existing volume in disk management, right-click on the volume and select ‚ÄúAdd Mirror‚Äù to open the Add Mirror dialog: <br><br><img src="https://habrastorage.org/files/97f/4d0/f7e/97f4d0f7ec0247d1954c0dd3007f6635.jpg"><br><br>  The window above displays the disks available for mirroring.  Select the desired drive and click "Next."  A warning may appear if additional actions are required (for example, converting a regular disk to a dynamic disk).  Click "Yes."  The synchronization process will start and the execution status will be displayed graphically. <br>  To do the same from the command line, start diskpart and check for the required volumes with the command: <br><pre> DISKPART&gt; list volume

   Volume ### Ltr Label Fs Type Size Status Info
   ---------- --- ----------- ----- ---------- ------- ---- ----- --------
   Volume 0 C NTFS Partition 30 GB Healthy System
   Volume 1 E My Volume NTFS Partition 8189 MB Healthy
</pre><br><br>  Let us consider the possibility of mirroring the volume "Volume 1".  The disk where the mirroring will be configured can be seen with the ‚Äúlist disk‚Äù command: <br><pre> DISKPART&gt; list disk

   Disk ### Status Size Free Dyn Gpt
   -------- ---------- ------- ------- --- ---
   Disk 0 Online 30 GB 0 B
 * Disk 1 Online 8 GB 0 B
   Disk 2 Online 8 GB 8189 MB
</pre><br><br>  Above it was clear that Volume 1 has a size of 8GB.  Thus, for its mirroring you need a disk of at least 8GB.  Note that if the disks are not dynamic, they will need to be converted by the commands: <br><pre> select disk 1
 convert dynamic
 select disk 2
 convert dynamic
</pre><br><br>  Next, select the desired volume on disk 1: <br><pre> DISKPART&gt; select disk 1
 DISKPART&gt; select volume 2

 Volume 2 is the selected volume.
</pre><br><br>  And finally, we mirror them with the ‚Äúadd =‚Äù command, specifying the disk number used for this (in our case it is disk 2): <br><pre> DISKPART&gt; add disk = 2

 Diskpart succeeded in adding a mirror to the volume.
</pre><br><br>  After that, Windows Server 2008 will start synchronization, the time of which depends on the size of the mirrored volume.  During synchronization, in the volume list, mirrored (with the Mirror type) will have the ‚ÄúRebuild‚Äù status.  After the end - Healthy. <br><br><h4>  Disassembling and removing the mirror disk array </h4><br>  Windows Server 2008 includes the functions of disassembling a mirrored raid array (two separate and independent volumes are created containing identical data) and ‚Äúmirror‚Äù deletions (in this case, all data on the ‚Äúmirror‚Äù is deleted). <br>  To disassemble a disk array using Disk Management, right-click on one of the volumes and select ‚ÄúBreak Mirrored Volume‚Äù in the menu that appears. <br>  From the command line, in the diskpart application, use a ‚Äúbreak‚Äù command indicating one of the two disks of the mirrored raid array: <br><pre> DISKPART&gt; break disk = 2
</pre><br><br>  To remove a mirror from the array, delete all synchronized data, right-click on the mirrored volume in Disk Management and select "Remove Mirror".  Alternatively, you can use the ‚Äúbreak‚Äù command in the diskpart with the NOKEEP parameter: <br><pre> DISKPART&gt; break nokeep disk = 2
</pre><br><br><h4>  Recovery mirror raid array </h4><br>  If one of the disks of the raid array fails, even in this case there is good news - in contrast to the ‚Äústrap‚Äù, all the data relevant at the time of the accident remained on the second disk.  In this case, it is important to replace the failed disk and rebuild the mirror before the second disk stops working. <br>  Right-click on the damaged volume and select "Remove Mirror".  Next, connect a new disk of sufficient size to create a mirror.  Right-click on the work volume from the current mirror and select ‚ÄúAdd Mirror‚Äù in the menu that appears, select the new disk and click ‚ÄúAdd Mirror‚Äù.  Windows will rebuild a mirrored raid array using a new disk.  As mentioned earlier, the time for reassembly and synchronization of data depends on the performance of the disks and their size. </div><p>Source: <a href="https://habr.com/ru/post/241333/">https://habr.com/ru/post/241333/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../241323/index.html">Design Patterns</a></li>
<li><a href="../241325/index.html">The FBI has asked the US Congress to legally weaken the protection of iOS and Android devices</a></li>
<li><a href="../241327/index.html">What is holacracy and why you don't need it</a></li>
<li><a href="../241329/index.html">The spread of smartphones: what does the market do to attract the ‚Äúlater majority‚Äù?</a></li>
<li><a href="../241331/index.html">Startup Marketing (continued): Nine Traffic Quality Levels</a></li>
<li><a href="../241335/index.html">How to use the API of a site that does not have an API?</a></li>
<li><a href="../241339/index.html">Startup marketing: A client who disappeared at the bottom of a funnel and why pay too much attention to traffic is dangerous for your business</a></li>
<li><a href="../241341/index.html">About the state of affairs in OpenStack for service providers</a></li>
<li><a href="../241343/index.html">Computer vision: recognizing clothes in a photo using a mobile application</a></li>
<li><a href="../241345/index.html">Pangu released iOS 8.1 jailbreak without Cydia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>