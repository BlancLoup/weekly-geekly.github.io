<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Acquaintance with testing in Python. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All good! 

 From our desk to yours ... That is, from our Python Developer course, despite the rapidly approaching New Year, we prepared for you an in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Acquaintance with testing in Python. Part 1</h1><div class="post__text post__text-html js-mediator-article">  All good! <br><br>  <s>From our desk to yours ...</s> That is, from our Python Developer course, despite the rapidly approaching New Year, we prepared for you an interesting translation about various testing methods in Python. <br><br>  This guide is for those who have already written a cool Python application, but have not yet written for <br>  them tests. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Testing in Python is an extensive topic with a lot of subtleties, but it is not necessary to complicate things.  In a few simple steps you can create simple tests for the application, gradually increasing the complexity based on them. <br><br>  In this tutorial, you will learn how to create a basic test, run it, and find all the bugs before users do it!  You will learn about the tools available to write and run tests, check the performance of the application, and even look at security issues. <br><br><img src="https://habrastorage.org/webt/kh/va/x5/khvax5ew8tluy6c9muhw-oei7cm.png"><br><a name="habracut"></a><br>  <b>Testing Code</b> <br><br>  You can test the code in different ways.  In this tutorial, you will learn from simplest to advanced methods. <br><br>  <i><b>Automated vs.</b></i>  <i><b>Manual Testing</b></i> <i><br></i> <br>  Good news!  Most likely you have already done the test, but have not yet realized this.  Remember how you first launched the app and used it?  Did you test and experiment with the features?  This process is called exploratory testing, and is a form of manual testing. <br><br>  Research testing - testing that is conducted without a plan.  During research testing, you explore the application. <br><br>  To create a complete list of manual tests, it is enough to make a list of all the functions of the application, the various types of input that it accepts, and the expected results.  Now, every time you change something in the code, you need to re-check each of the elements of this list. <br><br>  Sounds bleak, right? <br><br>  Therefore, we need automatic tests.  Automatic testing - the execution of a test plan (parts of an application that require testing, the order in which they are tested and expected results) using a script, and not by human hands.  Python already has a set of tools and libraries to help you create automated tests for your application.  Consider these tools and libraries in our tutorial. <br><br>  <i><b>Modular Tests VS.</b></i>  <i><b>Integration Tests</b></i> <br><br>  The world of testing is full of terms, and now, knowing the difference between manual and automated testing, we will go down a level deeper. <br><br>  Think about how you can test the headlights of a car?  You turn on the headlights (let's call it the test step), get out of the car yourself, or ask a friend to check that the headlights are lit (and this is a test proposition).  Testing multiple components is called integration testing. <br><br>  Think of all the things that need to work correctly for a simple task to produce the correct result.  These components are similar to parts of your application: all those classes, functions, modules that you wrote. <br><br>  The main difficulty of integration testing occurs when the integration test does not give the correct result.  It is difficult to assess the problem without being able to isolate the broken part of the system.  If the lights are not lit, the bulbs may be broken.  Or maybe the battery is dead?  Or maybe the problem is in the generator?  Or even a failure in the computer machine? <br><br>  Modern cars themselves will notify you of the failure of light bulbs.  This is determined by the unit test. <br><br>  The unit test (unit test) is a small test that checks the correctness of a separate component.  A unit test helps isolate a breakdown and fix it faster. <br><br>  We talked about two types of tests: <br><br><ol><li>  Integration test, verifying the components of the system and their interaction with each other; </li><li>  A unit test that checks a particular component of an application. </li><li>  You can create both tests in Python.  To write a test for the built-in function sum (), you need to compare the output of sum () with known values. </li></ol><br>  For example, this is how you can verify that the sum of the numbers (1, 2, 3) is 6: <br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sum([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]) == <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span></code> </pre> <br>  Values ‚Äã‚Äãare correct, so nothing will be displayed in the REPL.  If the result of <code>sum()</code> incorrect, an <code>AssertionError</code> will be <code>AssertionError</code> with the message ‚ÄúShould be 6‚Äù (‚ÄúShould be 6‚Äù).  Check the assertion statement again, but now with incorrect values, to get <code>AssertionError</code> : <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sum([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) == <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span> Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; AssertionError: Should be <span class="hljs-number"><span class="hljs-number">6</span></span></code> </pre> <br>  In the REPL, you will see <code>AssertionError</code> , since the value of <code>sum()</code> not equal to 6. <br><br>  Instead of REPL, put this in a new Python file called <code>test_sum.py</code> and execute it again: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_sum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sum([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]) == <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">"__main__"</span></span>: test_sum() print(<span class="hljs-string"><span class="hljs-string">"Everything passed"</span></span>)</code> </pre> <br>  Now you have a written test case (test case), statement and entry point (command line).  Now this can be done on the command line: <br><br><pre> <code class="python hljs">$ python test_sum.py Everything passed</code> </pre> <br>  You see a successful result, ‚ÄúEverything passed‚Äù. <br><br>  <code>sum()</code> in Python accepts any iterated input as the first argument.  You checked the list.  Let's try to test the tuple.  Create a new file called <code>test_sum_2.py</code> with the following code: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_sum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sum([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]) == <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_sum_tuple</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sum((<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)) == <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">"__main__"</span></span>: test_sum() test_sum_tuple() print(<span class="hljs-string"><span class="hljs-string">"Everything passed"</span></span>)</code> </pre><br>  Having <code>test_sum_2.py</code> , the script will <code>test_sum_2.py</code> error, since s <code>um() (1, 2, 2)</code> must be equal to 5, not 6. As a result, the script produces an error message, a line of code and a traceback: <br><br><pre> <code class="python hljs">$ python test_sum_2.py Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"test_sum_2.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; test_sum_tuple() File <span class="hljs-string"><span class="hljs-string">"test_sum_2.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> test_sum_tuple <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sum((<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)) == <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span> AssertionError: Should be <span class="hljs-number"><span class="hljs-number">6</span></span></code> </pre> <br>  You can see how an error in the code causes an error in the console with information about where it occurred and what the expected result was. <br><br>  Such tests are suitable for simple verification, but what if there are more errors than in one?  Test runners come to the rescue.  The test runner is a special application designed for conducting tests, checking output data and providing tools for debugging and diagnosing tests and applications. <br><br>  <i><b>Selection of Test Artist</b></i> <br><br>  For Python there are a lot of executors of tests.  For example, unittest is built into the standard Python library.  In this tutorial, we will use test cases and unittest test executers.  The principles of unittest work are easily adapted for other frameworks.  We list the most popular test performers: <br><br><ul><li>  unittest; </li><li>  nose or nose2; </li><li>  pytest. </li></ul><br>  It is important to choose a test performer that meets your requirements and experience. <br><br>  <b>unittest</b> <br><br>  unittest is built into the standard Python library since version 2.1.  You will surely come across it in commercial Python applications and open source projects. <br>  In unittest there is a test framework and a test performer.  When writing and executing tests you need to follow some important requirements. <br><br>  unittest requires: <br><br><ul><li>  Put tests in classes as methods; </li><li>  Use special approval methods.  Class TestCase instead of the usual assert expression. </li></ul><br><br>  To turn a previously written example into a unittest test case, you need to: <br><br><ol><li>  Import unittest from standard library; </li><li>  Create a class called <code>TestSum</code> that will inherit the class <code>TestCase</code> ; </li><li>  Convert test functions to methods, adding <code>self</code> as the first argument; </li><li>  Modify assertions by adding the use of the <code>self.assertEqual()</code> method in the <code>TestCase</code> class; </li><li>  Change the entry point in the command line to call <code>unittest.main()</code> . </li></ol><br>  Following these steps, create a new test_sum_unittest.py file with this code: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> unittest <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestSum</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(unittest.TestCase)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_sum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.assertEqual(sum([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]), <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_sum_tuple</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.assertEqual(sum((<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)), <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: unittest.main()</code> </pre> <br>  Doing this on the command line will result in one successful completion (indicated by.) And one unsuccessful (indicated by F): <br><br><pre> <code class="python hljs">$ python test_sum_unittest.py .F ====================================================================== FAIL: test_sum_tuple (__main__.TestSum) ---------------------------------------------------------------------- Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"test_sum_unittest.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> test_sum_tuple self.assertEqual(sum((<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)), <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span>) AssertionError: Should be <span class="hljs-number"><span class="hljs-number">6</span></span> ---------------------------------------------------------------------- Ran <span class="hljs-number"><span class="hljs-number">2</span></span> tests <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.001</span></span>s FAILED (failures=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  Thus, you have completed two tests with the help of the test performer unittest. <br><br>  <i>Note: If you are writing test cases for Python 2 and 3, be careful.</i>  <i>In versions of Python 2.7 and below, unittest is called unittest 2. When you import from unittest, you will get different versions with different functions in Python 2 and Python 3.</i> <br><br>  To learn more about unittest, read the <a href="https://docs.python.org/3/library/unittest.html">unittest documentation</a> . <br><br>  <b>nose</b> <br><br>  Over time, after writing hundreds or even thousands of tests for an application, it becomes increasingly difficult to understand and use unittest output data. <br><br>  Nose is compatible with all tests written with the unittest framework, and can be replaced by a test performer.  The development of nose, as an open source application, began to slow down, and nose2 was created.  If you start from scratch, it is recommended to use nose2. <br><br>  To get started with nose2, you need to install it from PyPl and run it on the command line.  nose2 will try to find all test creaks with <code>test*.py</code> in the name and all test cases inherited from unittest.TestCase in your current directory: <br><br><pre> <code class="python hljs">$ pip install nose2 $ python -m nose2 .F ====================================================================== FAIL: test_sum_tuple (__main__.TestSum) ---------------------------------------------------------------------- Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"test_sum_unittest.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> test_sum_tuple self.assertEqual(sum((<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)), <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span>) AssertionError: Should be <span class="hljs-number"><span class="hljs-number">6</span></span> ---------------------------------------------------------------------- Ran <span class="hljs-number"><span class="hljs-number">2</span></span> tests <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.001</span></span>s FAILED (failures=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  This is how the test created in <code>test_sum_unittest.py</code> from the nose2 test performer.  nose2 provides many command line flags for filtering executable tests.  To learn more, we advise you to familiarize yourself with the <a href="https://nose2.readthedocs.io/">documentation of Nose 2</a> . <br><br>  <b>pytest</b> <br><br>  pytest supports unittest test cases.  But the real advantage of pytest is its test cases.  Pytest test cases - a series of functions in a Python file with test_ at the beginning of the name. <br><br>  It has other useful features: <br><br><ul><li>  Support for assert built-in expressions instead of using special self.assert * () methods; </li><li>  Support filtering test cases; </li><li>  The ability to restart from the last failed test; </li><li>  An ecosystem of hundreds of plug-ins that extend functionality. </li></ul><br>  An example TestSum test case for pytest will look like this: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_sum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sum([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]) == <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_sum_tuple</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> sum((<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)) == <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-string"><span class="hljs-string">"Should be 6"</span></span></code> </pre> <br>  You got rid of TestCase, using classes and command line entry points. <br>  More information can be found on the <a href="https://docs.pytest.org/en/latest/">Pytest Documentation Site</a> . <br><br>  <b>Writing the First Test</b> <br><br>  Let's unite everything that we have already learned, and instead of the built-in <code>sum()</code> function, we will test a simple implementation with the same requirements. <br><br>  Create a new folder for the project, inside which create a new folder called my_sum.  Inside my_sum, create an empty file called <code>_init_.py</code> .  The presence of this file means that the my_sum folder can be imported as a module from the parent directory. <br><br>  The folder structure will look like this: <br><br> <code>project/ <br> ‚îÇ <br> ‚îî‚îÄ‚îÄ my_sum/ <br> ‚îî‚îÄ‚îÄ __init__.py</code> <br> <br>  Open <code>my_sum/__init__.py</code> and create a new function called <code>sum()</code> , which takes as input iterable (list, tuple, set) and adds the values. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(arg)</span></span></span><span class="hljs-function">:</span></span> total = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> val <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> arg: total += val <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> total</code> </pre> <br>  In this example, a variable called <code>total</code> , all values ‚Äã‚Äãin <code>arg</code> are <code>arg</code> and added to <code>total</code> .  Then, at the end of the iteration, the result is returned. <br><br>  <b>Where to Write a Test</b> <br><br>  You can start writing a test by creating a <code>test.py</code> file, which will contain your first test case.  For testing, the file should have the ability to import your application, so put <code>test.py</code> in the folder above the package.  The directory tree will look like this: <br><br> <code>project/ <br> ‚îÇ <br> ‚îú‚îÄ‚îÄ my_sum/ <br> ‚îÇ ‚îî‚îÄ‚îÄ __init__.py <br> | <br> ‚îî‚îÄ‚îÄ test.py</code> <br> <br>  You will notice that as you add new tests, your file becomes more cumbersome and difficult to maintain, so we advise you to create the <code>tests/</code> folder and divide the tests into several files.  Make sure that the names of all files begin with <code>test_</code> , so that test performers understand that the Python files contain the tests that need to be run.  On large projects, tests are divided into several directories depending on their purpose or use. <br><br>  <i>Note: And what is your application is a single script?</i> <i><br></i>  <i>You can import any script attributes: classes, functions, or variables using the built-in function <code>__import__()</code> .</i>  <i>Instead of <code>from my_sum import sum</code> write the following:</i> <br><br><pre> <code class="python hljs">target = __import__(<span class="hljs-string"><span class="hljs-string">"my_sum.py"</span></span>) sum = target.sum</code> </pre> <br>  <i>When using <code>__import__()</code> you do not have to turn the project folder into a package, and you can specify the file name.</i>  <i>This is useful if the file name conflicts with the names of the standard package libraries.</i>  <i>For example, if <code>math.py</code> conflicts with the math module.</i> <br><br>  <b>How to Structure a Simple Test</b> <br><br>  Before writing tests, you need to solve a few questions: <br><br><ol><li>  What do you want to test? </li><li>  Are you writing a unit test or integration test? </li></ol><br>  Now you are testing <code>sum()</code> .  For it, you can check different behaviors, for example: <br><br><ul><li>  Is it possible to sum up the list of integers? </li><li>  Is it possible to sum up a tuple or a set? </li><li>  Is it possible to sum up the list of floating point numbers? </li><li>  What happens if you give a bad value to the input: a single integer or a string? </li><li>  What happens if one of the values ‚Äã‚Äãis negative? </li></ul><br>  The easiest way to test a list of integers.  Create a <code>test.py</code> file with the following code: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> my_sum <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sum <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestSum</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(unittest.TestCase)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_list_int</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Test that it can sum a list of integers """</span></span> data = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] result = sum(data) self.assertEqual(result, <span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: unittest.main()</code> </pre> <br>  The code in this example is: <br><br><ul><li>  Imports <code>sum()</code> from the <code>my_sum()</code> package you created; </li><li>  Defines a new test case class called TestSum, which <code>unittest.TestCase</code> ; </li><li>  Defines a test method <code>.test_list_int()</code> for testing an integer list.  The <code>.test_list_int()</code> method will do the following </li></ul>  : <br><ol><li>  Declare a <code>data</code> variable with a list of values <code>(1, 2, 3)</code> ; </li><li>  <code>my_sum.sum(data)</code> value <code>my_sum.sum(data)</code> variable <code>result</code> ; </li><li>  Determines that the result value is 6 using the <code>.assertEqual()</code> method on the <code>unittest.TestCase</code> class. </li></ol><br><ul><li>  Specifies the entry point of the command line that launches the unit test executable <code>.main()</code> . </li></ul><br>  If you don‚Äôt know what self is, or as defined by <code>.assertEqual()</code> , then you can refresh your knowledge of object-oriented programming with <a href="https://realpython.com/python3-object-oriented-programming/">Python 3 Object-Oriented Programming</a> . <br><br>  <b>How to Write Statements</b> <br><br>  The final step in writing a test is to check that the output matches the known values.  This is called assertion.  There are several general guidelines for writing statements: <br><br><ul><li>  Check that the tests are repeatable and run them several times to make sure that they give the same results each time; </li><li>  Check and confirm the results that relate to your input data - check that the result is really the sum of the values ‚Äã‚Äãin the example <code>sum()</code> . </li></ul><br>  In unittest, there are many methods for validating the values, types, and existence of variables.  Here are some of the most commonly used methods: <br><br><table><tbody><tr><th>  Method </th><th>  Equivalent </th></tr><tr><td>  .assertEqual (a, b) </td><td>  a == b </td></tr><tr><td>  .assertTrue (x) </td><td>  bool (x) is true </td></tr><tr><td>  .assertFalse (x) </td><td>  bool (x) is False </td></tr><tr><td>  .assertIs (a, b) </td><td>  a is b </td></tr><tr><td>  .assertIsNone (x) </td><td>  x is None </td></tr><tr><td>  .assertIn (a, b) </td><td>  a in b </td></tr><tr><td>  .assertIsInstance (a, b) </td><td>  isinstance (a, b) </td></tr></tbody></table><br><br>  <code>.assertIs()</code> , <code>.assertIsNone()</code> , <code>.assertIn()</code> , and <code>.assertIsInstance()</code> have opposite methods called <code>.assertIsNot()</code> and so on. <br><br>  <b>Side effects</b> <br><br>  Writing tests is more difficult than just looking at the return value of a function.  Often, code execution changes other parts of the environment: class attributes, filesystem files, values ‚Äã‚Äãin the database.  This is an important part of testing, which is called side effects.  Decide whether you are testing a side effect before including it in your list of statements. <br><br>  If you find that there are a lot of side effects in the block of code you want to test, then you are violating the <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B8%25D0%25BD%25D1%2586%25D0%25B8%25D0%25BF_%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25BD%25D1%2581%25D1%2582%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B9_%25D0%25BE%25D1%2582%25D0%25B2%25D0%25B5%25D1%2582%25D1%2581%25D1%2582%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">principle of sole responsibility</a> .  Violating the principle of sole responsibility means that a piece of code does too many things and requires refactoring.  Adherence to the sole responsibility principle is a great way to design code for which it‚Äôs easy to write simple repeatable unit tests and, ultimately, create reliable applications. <br><br>  <b>Launch of the First Test</b> <br><br>  You have created the first test and now you need to try it out.  It is clear that it will be passed, but before creating more complex tests, you need to make sure that even such tests are performed successfully. <br><br>  <b>Running Test Performers</b> <br><br>  The test runner is a Python application that executes test code, validates assertions, and displays test results in the console.  At the end of test.py, add this small piece of code: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: unittest.main()</code> </pre> <br>  This is the command line entry point.  If you run this script by running python <code>test.py</code> on the command line, it will call <code>unittest.main()</code> .  This starts the test <code>unittest.TestCase</code> , detecting all the classes in this file inherited from <code>unittest.TestCase</code> . <br><br>  This is one of the many ways to run the unittest executor.  If you have a single test file called <code>test.py</code> , calling python test.py is a great way to get started. <br><br>  Another way is to use the unittest command line.  Let's try: <br><br><pre> <code class="python hljs">$ python -m unittest test</code> </pre> <br>  This will execute the same test module (called <code>test</code> ) via the command line.  You can add additional parameters to change the output.  One of them is -v for verbose.  Let's try the following: <br><br><pre> <code class="bash hljs">$ python -m unittest -v <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> test_list_int (test.TestSum) ... ok ---------------------------------------------------------------------- Ran 1 tests <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0.000s</code> </pre><br>  We ran one test from test.py and output the results to the console.  Verbose mode lists the names of the tests performed and the results of each one. <br><br>  Instead of providing the name of the module containing the tests, you can request auto-detection using the following: <br><br><pre> <code class="python hljs">$ python -m unittest discover</code> </pre> <br>  This command will search for files in the current directory with <code>test*.py</code> in the name to test them. <br><br>  If there are several test files and the pattern of the <code>test*.py</code> name is observed, you can pass the directory name with the -s flag and the folder name. <br><br><pre> <code class="python hljs">$ python -m unittest discover -s tests</code> </pre> <br>  unittest will run all the tests in a single test plan and display the results. <br>  Finally, if your source code is not in the root directory, but in a subdirectory, for example, in a folder called src /, you can use the -t flag to tell unittest where to run the tests in order to import modules correctly: <br><br><pre> <code class="python hljs">$ python -m unittest discover -s tests -t src</code> </pre> <br>  unittest will find all the <code>test*.py</code> files in the <code>src/</code> directory inside the <code>tests</code> , and then execute them. <br><br>  <b>Understanding the Results of Testing</b> <b><br></b> <br>  It was a very simple example where everything went well, so let's try to understand the output of the failed test. <br><br>  <code>sum()</code> must accept other lists of a numeric type, such as a fraction, for input. <br><br>      <code>test.py</code>      <code>Fraction</code>   <code>fractions</code>  . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fractions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Fraction</code> </pre> <br>     ,   .   , ,   ¬º, ¬º  ‚Öñ   1: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> unittest <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> my_sum <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sum <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestSum</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(unittest.TestCase)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_list_int</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Test that it can sum a list of integers """</span></span> data = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>] result = sum(data) self.assertEqual(result, <span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_list_fraction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Test that it can sum a list of fractions """</span></span> data = [Fraction(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), Fraction(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>), Fraction(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>)] result = sum(data) self.assertEqual(result, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: unittest.main()</code> </pre><br>       python -m unittest test,  : <br><br><pre> <code class="python hljs">$ python -m unittest test F. ====================================================================== FAIL: test_list_fraction (test.TestSum) ---------------------------------------------------------------------- Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"test.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> test_list_fraction self.assertEqual(result, <span class="hljs-number"><span class="hljs-number">1</span></span>) AssertionError: Fraction(<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) != <span class="hljs-number"><span class="hljs-number">1</span></span> ---------------------------------------------------------------------- Ran <span class="hljs-number"><span class="hljs-number">2</span></span> tests <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.001</span></span>s FAILED (failures=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>       : <br><br><ul><li>        :   (F),   (.); </li><li> FAIL     : </li></ul><br><ol><li>    ( <code>test_list_fraction</code> ); </li><li>   ( <code>test</code> )  - ( <code>TestSum</code> ); </li><li>    ; </li><li>      (1)    (Fraction(9, 10)) </li></ol><br> ,            -v   <code>python -m unittest</code> . <br><br> <b>   PyCharm</b> <br><br>    PyCharm IDE,    unittest  pytest,   : <br><br><ol><li>   Project tool,   tests. </li><li>       unittest. , 'Unittests in my Tests‚Ä¶'. </li></ol><br>   unittest        PyCharm: <br><br><img src="https://habrastorage.org/webt/i0/5e/xv/i05exvqd-ph8-jisw2a1ejgop_c.png"><br><br>     <a href="https://www.jetbrains.com/help/pycharm/performing-tests.html"> PyCharm</a> . <br><br> <b>   Visual Studio Code</b> <br><br>    Microsoft Visual Studio Code IDE,  unittest, nose  pytest     Python. <br><br>     ,    ,  Command Palette  Ctrl+Shift+P   ‚ÄúPython test‚Äù.    : <br><br><img src="https://habrastorage.org/webt/b1/zs/10/b1zs10n-ydybrqz62ywpknjp89q.png"><br><br>  Debug All Unit Tests,   VSCode      .        (unittest)    (.). <br><br>   ,                    ,   : <br><br><img src="https://habrastorage.org/webt/rk/k6/cm/rkk6cmqzjwmtc-4upzozzurcjh4.png"><br><br> ,   ,     . <br><br>  THE END <br><br>         ,   Django  Flask. <br><br>       ,  ,      <a href="https://otus.pw/Bb8F/">  </a> . </div><p>Source: <a href="https://habr.com/ru/post/433358/">https://habr.com/ru/post/433358/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433348/index.html">Typed DSL in TypeScript from JSX</a></li>
<li><a href="../433350/index.html">Digital events in Moscow from December 17 to 23</a></li>
<li><a href="../433352/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ343 (December 10 - 16, 2018)</a></li>
<li><a href="../433354/index.html">News from the world of OpenStreetMap ‚Ññ438 (04.12.2018-10.12.2018)</a></li>
<li><a href="../433356/index.html">Malefactors learned to bypass two-factor authentication of Yahoo Mail and Gmail</a></li>
<li><a href="../433360/index.html">Scientists have tried to predict when electric airplanes will become reality</a></li>
<li><a href="../433362/index.html">9 principles of beauty, simplicity and care in the UX</a></li>
<li><a href="../433364/index.html">LDraw + Unity. How I generated Lego</a></li>
<li><a href="../433366/index.html">Work with external resources in Unity3D</a></li>
<li><a href="../433368/index.html">How to apply grocery thinking to the world: the example of sweatshirts</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>