<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PostgreSQL, TCL, and others: A critical error in the RE engine. Possible vulnerability</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to draw the attention of the habrasoobshchestvo to a possible ‚Äúvulnerability‚Äù in TCL, PostgreSQL and theoretically in some other systems using ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PostgreSQL, TCL, and others: A critical error in the RE engine. Possible vulnerability</h1><div class="post__text post__text-html js-mediator-article"> I want to draw the attention of the habrasoobshchestvo to a possible ‚Äúvulnerability‚Äù in TCL, PostgreSQL and theoretically in some other systems using modules of regular expressions or NFA utilities, originally written by Henry Spencer himself.  Modified sources can be found a hundred (from the same Sun Microsystems, UUNET, etc.).  And although I don‚Äôt think that the bug exists initially from the distant 90s, if only because Henry, in his old sources, did not find the code where this error occurs, it‚Äôs still worth checking your systems. <br><br>  And so the error: it is busyloop at the stage of compilation of a regular expression of the form <code>(((((x)*)*)*)*)*</code> .  And it is not the execution, but the compilation, i.e.  if there is a regularity validation check and it is based on the same NFA code, we have the same infinite loop + 100% cpu usage. <br><br>  An error was found by colleagues on the opensource project TCL, in all its current versions (including develop).  Knowing that Postgres uses a similar API, it was easy to find out that feeding this regular Postgres expression results in a complete hang of the thread (process) processing the request. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An error occurs when such a grouping is only in the fifth or more order of nesting - i.e.  four nested groups are correctly compiled and executed. <br><a name="habracut"></a><br>  PostgreSQL example: <br><pre> <code class="sql hljs">postgres=<span class="hljs-comment"><span class="hljs-comment"># select 1 where 'x' ~ '((((x)*)*)*)*'; ?column? ---------- 1 (1 row) postgres=# select 1 where 'x' ~ '(((((x)*)*)*)*)*';</span></span></code> </pre>  <b>! busyloop!</b> <br><br>  Example for TCL: <br><pre> <code class="python hljs">% regexp -about {((((x)*)*)*)*} <span class="hljs-number"><span class="hljs-number">4</span></span> REG_UEMPTYMATCH % regexp -about {(((((x)*)*)*)*)*}</code> </pre>  <b>! busyloop!</b> <br><br>  Since  This error causes the thread to hang up at 100% busy, and since there are already bug reports (which, by the way, are being actively studied by hackers and the Kiddys script), as long as a search is in progress and the bug fix will not be released, I recommend checking your projects ( products) and in the case of a positive result, turn off the possibility of generating similar regular expressions or foreign input regulars in general. <br><br>  Today, I dropped a bug-tracker of one of my friends in such a way twice, after hearing the abuse first, then that nothing was visible in the logs (the post arguments were disabled in the log), I heard thanks.  For, forewarned - armed. <br><br>  From the proven <b>vulnerable:</b> <br>  TCL 8.4, 8.5, 8.6 - <b>FAILED</b> . <br>  PostgreSQL 8.4, 9.1 - <b>FAILED</b> . <br><br>  <b>Not subject to</b> error: <br>  Python 2.5.2 and 2.7 - <b>OK</b> . <br>  UPD: PostgreSQL 9.2.3 - <b>OK</b> .  (according to the comments of uv. <a href="https://habrahabr.ru/users/starius/" class="user_link">starius</a> ). <br>  UPD: PostgreSQL 9.2.1, 9.2.2-2 - <b>OK</b> .  (thanks to <a href="https://habrahabr.ru/users/catlion/" class="user_link">catlion</a> and <a href="https://habrahabr.ru/users/sdevalex/" class="user_link">sdevalex</a> ). </div><p>Source: <a href="https://habr.com/ru/post/169183/">https://habr.com/ru/post/169183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../169169/index.html">We remove advertising on the new site Computerra</a></li>
<li><a href="../169171/index.html">What to do in the case of large-scale alien invasion?</a></li>
<li><a href="../169175/index.html">Economic efficiency from the implementation of ERP-system</a></li>
<li><a href="../169177/index.html">Poll on how to be copyrighted</a></li>
<li><a href="../169181/index.html">Threat Report for the second half of 2012: Internet</a></li>
<li><a href="../169187/index.html">Dependency Injection Introduction</a></li>
<li><a href="../169189/index.html">CodenameOne or Java vs HTML5</a></li>
<li><a href="../169191/index.html">We want to show you WCAG: we are learning the basics of web accessibility to music.</a></li>
<li><a href="../169193/index.html">How to recover text in one minute after unsuccessful web form submission</a></li>
<li><a href="../169195/index.html">AppFuscator - .NET cloud protection</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>