<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recommended Systems: SVD and Basic Predictors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last time I talked, while in the most general terms, about singular decomposition - the main tool of modern collaborative filtering. However, last tim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recommended Systems: SVD and Basic Predictors</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/company/surfingbird/blog/139863/">Last time</a> I talked, while in the most general terms, about singular decomposition - the main tool of modern collaborative filtering.  However, last time we mostly talked only about general mathematical facts: that SVD is a very cool thing that gives good low-rank approximations.  Today we will continue the conversation about SVD and discuss how, in fact, use all this mathematics in practice. <br><img src="https://habrastorage.org/getpro/habr/post_images/700/e82/e84/700e82e847f7c48401af4ab05f18b936.jpg" alt="image"><br><br><a name="habracut"></a>  And we will start from afar again: let's look at what the rating of one product will be made of.  First, it may well be that the user is kind and gives everyone good ratings in a row;  or, conversely, evil and rating clamps.  If you do not take into account this basic factor, it will not work - without adjusting for the average, the ratings of different users cannot be compared.  On the other hand, some products are simply better than others (or at least promoted better), and this should also be taken into account in the same way. <br><br>  Therefore, we will start by introducing the so-called baseline predictors (baseline predictors) <img src="https://habrastorage.org/getpro/habr/post_images/164/5a1/22a/1645a122a737c5300dedcf306eb216f3.png" alt="image">  that are made up of the basic predictors of individual users <img src="https://habrastorage.org/getpro/habr/post_images/84a/299/1ab/84a2991abad736a00cfa8e8a61aefbc7.png" alt="image">  and basic predictors of individual products <img src="https://habrastorage.org/getpro/habr/post_images/f24/9f2/a28/f249f2a2898193b5b6adbf5519b5d92e.png" alt="image">  , and also just the general average rating on base <i>Œº</i> : <br><img src="https://habrastorage.org/getpro/habr/conversation/105/b24/143/105b24143c3965352bbb83070091cbe3.png" alt="image"><br>  If we want to find only basic predictors, we will have to find such <i>Œº</i> , <img src="https://habrastorage.org/getpro/habr/post_images/84a/299/1ab/84a2991abad736a00cfa8e8a61aefbc7.png" alt="image">  and <img src="https://habrastorage.org/getpro/habr/post_images/f24/9f2/a28/f249f2a2898193b5b6adbf5519b5d92e.png" alt="image">  for which <img src="https://habrastorage.org/getpro/habr/post_images/164/5a1/22a/1645a122a737c5300dedcf306eb216f3.png" alt="image">  best approximate available ratings. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Then you can add the actual factors - now that we have made an amendment to the basic predictors, the residuals will be comparable with each other, and you can hope to get reasonable factors: <br><img src="https://habrastorage.org/getpro/habr/post_images/228/3b9/49f/2283b949ffc73cf2a362c4cb1e361c50.png" alt="image"><br>  Where <img src="https://habrastorage.org/getpro/habr/post_images/fb5/7a7/390/fb57a73900be680f7d18620c570ca8fa.png" alt="image">  - a vector of factors representing product <i>a</i> , and <img src="https://habrastorage.org/getpro/habr/post_images/6c8/525/cc8/6c8525cc809870cc5c209d8e6e02a49e.png" alt="image">  Is a factor vector representing user <i>i</i> . <br><br>  It may seem that finding, for example, basic predictors is a very simple matter: let's just calculate the average rating for the entire base. <img src="https://habrastorage.org/getpro/habr/post_images/388/597/ad8/388597ad81ccb46088d15e03e77363f6.png" alt="image">  , we take it for <i>Œº</i> , then we subtract it from each rating and calculate the average ratings <img src="https://habrastorage.org/getpro/habr/post_images/ea8/1cb/31b/ea81cb31b883cc286cba3ec79a507146.png" alt="image">  by users and <img src="https://habrastorage.org/getpro/habr/post_images/8bd/097/f6d/8bd097f6d19ad3de05dc80072400615d.png" alt="image">  by products.  However, it would be wrong to consider these predictors in this way: in fact, they depend on each other, and they should be optimized together. <br><br>  Now we can return to the original problem and formulate it exactly: we need to find the best predictors that approximate <br><img src="https://habrastorage.org/getpro/habr/post_images/228/3b9/49f/2283b949ffc73cf2a362c4cb1e361c50.png" alt="image"><br><br>  What does "best" mean here?  The first approximation to the answer to this question is: the ‚Äúbest‚Äù are those who make the least mistakes on the available data.  How to determine the error?  You can, for example, add the squares of deviations (by the way, why squares? We will also talk about this in the next series) for those ratings that we already know: <br><img src="https://habrastorage.org/getpro/habr/post_images/cd7/345/5a1/cd73455a1a4c940c6373ade61acfb528.png" alt="image"><br><br>  And how to minimize such a function?  It is very simple - by a gradient descent: we take the partial derivatives for each argument and move in the direction opposite to the direction of these partial derivatives.  The error function is a quadratic surface, so no surprises await us here. <br><br>  However, if we now write out and implement formulas for the gradient descent on the resulting error function <i>L</i> , the practical result on real datasets is unlikely to please us.  In order to teach the good values ‚Äã‚Äãof predictors and factors, we, generally speaking, would like to understand other important concepts of machine learning ‚Äî <i>overfitting</i> and <i>regularization</i> , and we will see this in practice in one of the following series.  In the meantime, just believe that you still need to penalize for too large values ‚Äã‚Äãof the learning variables;  for example, you can simply add the sum of squares of all factors and predictors to the error function. <br><br>  As a result, the error function looks like <br><img src="https://habrastorage.org/getpro/habr/post_images/d40/a51/533/d40a51533433a1f73faec4615808d18a.png" alt="image"><br>  where Œª is a regularization parameter. <br><br>  If we take the partial derivatives of each of the variables to be optimized, we obtain simple rules for the (stochastic) gradient descent: <br><img src="https://habrastorage.org/getpro/habr/post_images/99b/b86/79d/99bb8679d2c1292d0dd95740cb0c1d77.png" alt="image"><br>  for all <i>j</i> , where <img src="https://habrastorage.org/getpro/habr/post_images/f16/779/da2/f16779da24034645c49aeed2ff4d91d7.png" alt="image">  - error on this test example, and Œ≥ - learning speed.  This model is called SVD ++, and it was she who formed the basis of the winning model in the Netflix Prize (although, of course, she could not win alone - why and what to do, we'll also talk later). <br><br>  Next time I will try to analyze a specific example: apply SVD to the preference matrix, analyze what happens, highlight the main difficulties.  I hope it will be interesting! </div><p>Source: <a href="https://habr.com/ru/post/140555/">https://habr.com/ru/post/140555/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140548/index.html">Russia joins ISOC</a></li>
<li><a href="../140549/index.html">Pricing strategies for new gTLDs</a></li>
<li><a href="../140551/index.html">Manual PaintCAD Graphic Editor</a></li>
<li><a href="../140552/index.html">Networks for the smallest. Part Three Static routing</a></li>
<li><a href="../140554/index.html">Manage wheelchair and PC using language</a></li>
<li><a href="../140556/index.html">Was the economy littered? Let's defragment it!</a></li>
<li><a href="../140557/index.html">GCC-4.7 release</a></li>
<li><a href="../140559/index.html">Reserved domains in the zone. XXX receive 1.3 million hits per day</a></li>
<li><a href="../140560/index.html">A small firm has declared its rights to 482 top-level domains.</a></li>
<li><a href="../140561/index.html">The first mobile LTE-network in Moscow was launched with several administrative violations, states Roskomnadzor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>