<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HEIST allows you to receive encrypted information in the HTTPS channel in clear text</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The HTTPS protocol extension, which protects millions of sites and hundreds of millions of users, is vulnerable to a new type of attack. The exploit a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HEIST allows you to receive encrypted information in the HTTPS channel in clear text</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/4de/69c/f11/4de69cf11bf538050437ef98cb8b25cc.png"><br><br>  The HTTPS protocol extension, which protects millions of sites and hundreds of millions of users, is vulnerable to a new type of attack.  The exploit allows you to get encrypted email addresses, insurance numbers and other personal data of users.  Moreover, the attacker does not need to monitor or control the victim‚Äôs Internet connection. <br><br>  In other words, the exploit does not require the use of the MITM (man-in-the-middle) scheme.  Instead, the victim is attacked with the help of an innocent JavaScript file hidden in an advertisement or ‚Äústitched‚Äù directly into the page of the malicious site.  Malicious code after successful execution can request a number of types of pages protected by SSL or TSL protocol and receive the exact size of files with encrypted data, which are transmitted in protected mode.  A new type of attack called HEIST (HTTP Encrypted Information can be Stolen Through TCP-Windows). <br><a name="habracut"></a><br>  This attack works <a href="https-pages/">due to the fact</a> that the script examines the type of response the framework gives to the client (usually a browser) from which the HTTP request came.  Once an attacker receives information about the exact size of the encrypted data, he can use several previously known exploits to obtain test information hidden inside the encrypted file. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      More specifically, <a href="https-protected-pages/">BREACH</a> (Browser Reconnaissance &amp; Exfiltration via Adaptive Compression of Hypertext) and <a href="https-sessions/">CRIME</a> exploits are used here.  BREACH allows you to get test information from a protected file in just 30 seconds.  CRIME does not lag behind its fellow.  CRIME allows you to select the content of cookies by using multiple requests, observing the values ‚Äã‚Äãthat zlib gives out.  The exploit decrypts the value of cookies by 4-6 requests for each base64 byte. <br><br>  HEIST technology was shown and explained at the <a href="&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjQZS8cU6MA-nNwRM-hRpZ3Hr37Ow#heist-">Black Hat conference</a> .  According to information security experts, HEIST allows you to conduct attacks faster and more efficiently than before.  Especially since the MITM scheme is no longer needed.  The attackers get the necessary information almost immediately after the victim visits an infected site or a site with infected ads. <br><br>  Until now, the attacker needed to actively control the traffic from the server to the user.  HEIST allows you to remove this restriction.  The exploit uses TCP characteristics as a quasi-cryptographic secondary channel to estimate the size of the HTTPS response.  TCP splits large transmissions into smaller fragments of a certain size, called frames.  In the following, frames are grouped inside ‚ÄúTCP windows‚Äù, sent one at a time.  TCP sends a new window only after receiving confirmation of receipt of the previous frame group. <br><br>  HEIST can calculate the number of frames and windows by interacting with a set of recently approved APIs.  This is Resource Timing and Fetch.  As a result, it turns out to determine the exact size of the HTTPS response.  And then, as mentioned above, BREACH and CRIME come into play.  At the exit, the attacker gets previously closed information.  Experts have already presented the results of their work by Google and Microsoft.  So the method presented on Black Hat did not come as a surprise to these companies.  An attacker only needs to know the victim's CSRF token, after which the user‚Äôs account on a specific site can be compromised. <br><br>  According to the authors of the work presented on Black Hat, the user can reduce the likelihood of a successful HEIST attack by prohibiting third-party cookies in the browser settings.  On the other hand, a number of services simply will not work without third-party cookies. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e1f/bec/d0b/e1fbecd0b1b6f878ff1183f6155af46e.png"><br><br>  When demonstrating the attack, we were able to measure the size of the encrypted responses for the New York Times, using the site targetwebsite.com. <br><br>  HEIST is also effective against HTTP / 2, the updated HTTP standard.  In some situations, the HTTP / 2 features even increase HEIST performance.  In particular, if HTTP / 2 is used, the exploit can simultaneously poll several sources. <br><br>  Now, according to the authors of the work, the combined attack using BREACH and HEIST is one of the most simple methods of compromising user accounts of various resources. <br><br>  <b>Our other publications:</b> <br><ul><li>  <a href="https://habrahabr.ru/company/kingservers/blog/260357/">Accidents in data centers that were (almost) impossible to foresee</a> </li><li>  <a href="https://habrahabr.ru/company/kingservers/blog/307012/">Rating of programming languages ‚Äã‚Äãin 2016</a> </li><li>  <a href="https://habrahabr.ru/company/kingservers/blog/259411/">Uptime Institute introduced a new certification system for data centers</a> Ó§á </li><li>  <a href="https://habrahabr.ru/company/kingservers/blog/257699/">How Facebook saved 75% of the energy required to store photos of cats and user selfie</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/307206/">https://habr.com/ru/post/307206/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307196/index.html">Who is Caviar? School of creative thinking for the digital world</a></li>
<li><a href="../307198/index.html">10 tricks to feel like a specialist, working with Google Drive</a></li>
<li><a href="../307200/index.html">Work with OrnaJS library</a></li>
<li><a href="../307202/index.html">Security Week 31: News from Blackhat</a></li>
<li><a href="../307204/index.html">8 lectures to help understand machine learning and neural networks</a></li>
<li><a href="../307208/index.html">Debian Linux and Tor for a secure deb</a></li>
<li><a href="../307210/index.html">Common mistakes of the novice HTML maker-up</a></li>
<li><a href="../307212/index.html">Do not Perseids uniform or Model flash satellite with their own hands</a></li>
<li><a href="../307214/index.html">Mikrotik QOS in distributed systems or smart shapers</a></li>
<li><a href="../307218/index.html">How many neurons do you need to find out if the Alexander Nevsky Bridge is divorced?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>