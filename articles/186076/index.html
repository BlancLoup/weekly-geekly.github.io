<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Universal Analytics - New Generation Web Analytics</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Universal Analytics is a new version of Google Analytics web analytics. 

 The principles of Universal Analytics differ from the principles of the pre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Universal Analytics - New Generation Web Analytics</h1><div class="post__text post__text-html js-mediator-article"> <i>Universal Analytics is a new version of Google Analytics web analytics.</i> <br><br>  The principles of Universal Analytics differ from the principles of the previous version of the system.  If you are wondering what the Google Analytics update is and what has been useful in this system, you have come across the article you need. <br><br>  While collecting information during the preparation of this article, I spent a lot of time finding something useful (by useful I mean cases using this system), however, it turned out that I could find practical advice on the Internet (both Western and ours) not so simple - they are simply not there (with rare exceptions).  Since almost half a year has passed since the release of Universal Analytics in Beta mode (the system continues to work in this mode and now, but for Google a long testing period is a common situation), a natural question is ‚Äúwhy?‚Äù.  Do companies really see no point in investing now (despite the ‚Äúfree‚Äù system, they still have to invest, since all the settings that you implemented in the previous version will not be transferred automatically to the new version) in the transition from Google Analytics to Universal Analytics?  Running a little ahead, I will express my opinion: in many cases it is worth it. <br><a name="habracut"></a><br>  <b>What is new in Universal Analytics?</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It will be correct to indicate at the very beginning that the Universal Analytics user interface is almost identical to the interface of the previous version.  That is, Universal Analytics is not a new web analytics system, it is primarily a long overdue update of the data analytics approach in Google Analytics. <br><br>  The first thing that has changed with the release of the new version is the <b>process of data collection</b> .  Google Analytics used 5 different cookies to collect information about visitors, each of which contained information about the visitor: a keyword, a source of traffic, a campaign name, a page number in a session on the site and some other indicators.  Each time a visitor went to a page on your site, the Google Analytics tracking code reads this vast array of information from cookies and sends it to the data collection server. <br><br>  Universal Analytics has a slightly different approach to accomplishing the same task.  Only one Cookie is stored in the visitor's browser, which actually contains one unique unique identification number of the site visitor (client ID).  The updated tracking code reads this cookie and transmits to Google‚Äôs server not the entire huge array of indicators listed in the previous paragraph, but only the unique number of the visitor who made this hit.  What is the difference?  A much smaller amount of data is transmitted to Universal Analytics servers.  Next, Google already on its servers calculates what page this account has in the user session, whether the visitor was on the site earlier, whether any user variable was assigned to this visitor or not, and so on.  According to Google, a full transition to Universal Analytics will increase the average speed of the global Internet by 5% (taking into account the fact that Google Analytics is installed on 80% of all sites in the world). <br><br>  Having in hands a unique ID of the visitor (access to it is possible to receive the standard JS methods kindly provided by Google) it would be logical to assume that Google will present ample opportunities for its use. <br><br>  Having access to a unique visitor ID, it becomes possible to <b>cross-platform tracking of</b> the same visitor.  If earlier, a visitor, going to the site first from a home computer, and then, for example, from a mobile device, was in fact two visitors to us at once, now we have the opportunity, at the moment when the visitor logs in to the site, to inform the analytics system, that the same visitor returned to the site and link all the information about the second visit to the same visitor (read, rewrite his only Coookie). <br><br>  Moreover, thanks to the new measurement and data transfer protocol ( <b>new measurement protocol</b> ), it becomes possible not only to rewrite the Client ID, but also to independently generate various types of hits, which are then transmitted from any devices with Internet access and capable of sending a standard HTTP request. <br><br>  I will give an example of using this technology: a visitor goes to the website of an online store, makes a purchase through a basket and chooses a delivery method - self-pickup, and a payment method - payment upon receipt of the goods.  Being in the ‚ÄúGoogle Analytics stage‚Äù you would not have had the opportunity at the time of receiving the money to transfer to the Google server that the visitor, who made an order a few days ago on the site, nevertheless took it from the pickup point and paid in cash.  And now there is such an opportunity: you just have to make one of your devices used for making a purchase at a pickup point (for example, a barcode scanner) generate a simple HTTP request that sends information about the transaction directly to Google, assigning this hit the same visitor who made a purchase a few days ago. <br><br>  Another new feature from the list of the most important functions is the <b>creation of your own parameters and metrics</b> .  The traffic source, browser, screen resolution are all examples of the standard options that are currently available in Google Anaytics.  The bounce rate, conversion rate are all examples of predefined metrics. <br><br>  Imagine that you, for example, store in your CRM system the gender (M or F) of each client.  You may be interested in the opportunity to find out the conversion rate in purchases or registration of representatives of each sex.  This information may be useful for optimizing the site and advertising campaigns.  To do this, you just need to create a new parameter in Google Analytics - gender, and then teach your CRM system to generate a hit containing information about a new indicator created inside Universal Analytics. <br><br>  It is also worth mentioning, perhaps, the migration of some basic system settings that previously ‚Äúlived‚Äù in the developers' monastery and required changes in the tracking code, and now they exist directly inside the Universal Analytics interface and their settings are available there.  These include the lifetime of the session and the campaign, the attribution of key queries that contained the brand name to direct traffic, the exclusion of transitions from certain domains from the traffic of transitions and some others. <br><br>  Further, in my opinion, it would be correct to give an example of the use of new features of Universal Analytics.  In our company, as well as, it seems to me, in most other companies that use paid channels to attract visitors to the site, until now this tool did not allow conveniently and segmented, perhaps, the most important metric for business, and sales in an automatic or semi-automatic mode. , on a variety of interesting business indicators.  It is clear that Google Analytics existed and there is a report on e-commerce, but it was possible to transfer data to this report only at the time of placing an order on the website, and not at the time of receipt of money on the company's account, which, of course, somewhat distorted the real results of the company's activities on the Internet.  Further description of how we solved this problem in our country. <br><br>  <b>Step 1. Install and configure Universal Analytics and Google Tag Manager</b> <br><br>  Despite the fact that the article is not about this, I cannot help writing a few introductory words about the Google Tag Manager, since we used this tool to solve the problem, and some readers of this article could not hear about it. <br><br>  Google Tag Manager allows you to easily manage tags (designed to track or optimize marketing) on ‚Äã‚Äãa website.  To understand the purpose of the Google Tag Manager, I‚Äôll give an example: let's say your site now uses Google Analytics, Google Adwords is used to attract visitors, and, for example, Google‚Äôs experiments are used to conduct a | b-tests on the site‚Äôs pages, this actually means the presence of 3 different types of tracking codes on the site.  Add to this another possible transition to Universal Analytics, as well as event and e-commerce event codes, and you‚Äôll have a long list of tags scattered across your site. <br><br>  The work of the Google Tag Manager is based on the use of one tag - the so-called container, which must be placed on all pages of the site instead of individual tags, such as AdWords, Google Analytics, Floodlight, and others.  After you post a container fragment on the website, tags will be added, updated and managed in the Google Tag Manager Manager account in the web interface. <br><br>  In addition, Google Tag Manager allows you to reduce the risk of unfair use of your unique account number, for example, by your competitors.  If the site has a ‚Äúbare‚Äù Universal Analytics code, anyone can send a hit to your statistics with information about a transaction that has occurred, knowing the identification number of your Universal Analytics account (UA-XXX-YY), which will spoil your statistics and may create an incorrect idea of results of your company. <br><br>  So, to solve our problem, first of all we install the Google Tag Manager. <br><br>  Go to the Google Tag Manager website <a href="http://www.google.com/tagmanager/">www.google.com/tagmanager</a> (GTM) and register a new account: <br><br><img src="https://habrastorage.org/getpro/megamozg/post_images/f2a/cb7/40b/f2acb740b848cf281d0046bf4fe65af0.png" alt="image"><br><br>  In the fields Account name and Container name enter the address of the site (or domain name).  Click the Create account button.  Then GTM will offer you a special code that must be placed on all pages of your site immediately after the tag. <br><br><img src="https://habrastorage.org/getpro/megamozg/post_images/271/050/98f/27105098f126f5fd34cdc082ee798bc9.png" alt="image"><br><br>  After the proposed GTM code is placed in the right place on all pages of your site, go to Google Analytics, log in with your existing Google login and password for your account (which currently tracks your site traffic) and create a new web resource specially for Universal Analytics (hereinafter referred to as UA): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a8/aa6/3a1/5a8aa63a1b156ba655ddf1640da705eb.png" alt="image"><br><br>  In the settings of the new web resource, select the tracking method - Universal Analytics, enter the name and address of the site, as well as TimeZone: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/af3/7e3/35f/af37e335f6c32ff5162312459dd86162.png" alt="image"><br><br>  Click the button ‚ÄúGet tracking ID‚Äù and the service redirects us to the page with the code UA, which is recommended to us once [IMG] http://i47.fastpic.ru/big/2013/0709/1f/bec6c0e37deb4c888fa9aa0daa22171f.png [/ IMG] to place as well as the GTM container code immediately after the tag: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2d9/60e/2bb/2d960e2bbc23c4fefae88914f3cc3a6d.png" alt="image"><br><br>  Next, we return to the GTM website in order to add a new tag with the code UA to the previously created container.  To do this, click on the New Tag button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a22/57e/4fe/a2257e4fe19d7872651a0280a6ecaf73.png" alt="image"><br><br>  Specify the name of the tag (for example, Universal Analytics Code), select the type of the created tag (Tag Type) from the offered list and then add the identifier of your account to the appropriate field (Tracking Id): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/661/91f/a93/66191fa935835b11b2c5804dafc62d86.png" alt="image"><br><br>  Also, we need to specify a rule (Add Rule to Fire Tag), in which the UA code will work.  Select the available All Pages option (we need the UA tracking code to run on all pages of the site): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aec/551/052/aec55105220f0fd6192ea63a96f1a3d5.png" alt="image"><br><br>  No more changes on this page are needed - click the Save button. <br>  In order for the changes made to the GTM container to take effect (and the UA code is started to be executed), you must click the Create Version button: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/278/1d2/5df/2781d25dffe3cfba6e8adf301b156b31.png" alt="image"><br><br>  And then press the Publish button: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eaa/f1a/2da/eaaf1a2daf30b9074bfc73551b2f1672.png" alt="image"><br><br>  Congratulations, the UA code was successfully entered into the GTM container on your site. <br><br>  It remains to wait a bit to make sure that we did everything correctly and the statistics of visits to your site began to be transmitted to the corresponding UA profile (When creating a new web resource, 1 default profile is automatically created, to which all statistics of visits to the site are transmitted. About the data structure, the difference See profiles from web resources and accounts in the Google Analytics Help <a href="https://support.google.com/analytics/answer/1009618%3Fhl%3Dru">support.google.com/analytics/answer/1009618?hl=en</a> ). <br><br>  <b>Step 2. Integrating Universal Analytics with a CRM system</b> <br><br>  In our company, CRM-system HighRise (37signals.com) is used for customer relationship management.  As mentioned at the beginning of the article, the main task that needs to be solved with the help of UA is the correct transfer of company revenue data into the UA interface for further calculating the ROI of advertising (and non-advertising) channels, as well as segmentation of this metric according to various preset parameters. <br><br>  This is how the HighRise system launch window looks like: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c41/d56/264/c41d56264e12f9ed83f61fa55ce1d54f.png" alt="image"><br><br>  The main object in this system is the contact person (representative) of the company with which cooperation is being negotiated. <br><br>  New contacts in HighRise are created automatically (using the HighRise API) when filling out one of the contact forms on our website: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/511/07b/cad/51107bcad0651b9414fea0c04ad37eab.png" alt="image"><br><br>  Next, for each contact person, the consultants manually specify the type and the deadline for the task to be performed. <br><br>  If you go down a level, you can see that for each contact person the types of deals (deals) that are to be carried out (or have already been completed) are created and stored: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b8e/846/d3f/b8e846d3f3e4f0835282bd2cc9dc1462.png" alt="image"><br><br>  Each transaction has 3 statuses: Lost (the transaction is lost, there will be no payment), Pending (the transaction is in the process of discussion), Win (the transaction took place, payment was received to the organization‚Äôs account). <br><br>  Given all the above information about the features of CRM system HighRise, the main task can be reformulated as follows: <br><br>  When the status of the transaction changes from Pending to Win, it is necessary to transfer information to the UA about the amount of the transaction in relation to the visitor who submitted the application on the website. <br><br>  This task is implemented in 2 stages: <br><br>  1. When a new contact is entered into HighRise, it is necessary to save his unique Client ID in a separate field <br>  2. When the status of the transaction changes from Pending to Win, you need to generate a hit that will transmit information about the volume of the transaction inside the UA, while correctly attributing the volume of the transaction to the corresponding visitor. <br><br>  The first stage is relatively simple.  In the help for UA developers, there is a JS code that allows you to determine the unique identification number of the visitor who is on the site.  It looks like this: <br><br> <code>ga(function(tracker) { <br> var clientId = tracker.get('clientId'); <br> });</code> <br> <br>  Clientid variable will be assigned a unique site visitor number.  Calling this method at the moment when the visitor fills out the application form for the service, while on the company's website, it is possible to save the visitor's ClientId in one of the available fields for the new contact person (for example, you can always use the free ‚ÄúFax‚Äù field for these needs). <br><br>  Thus, we enter into our CRM system a unique visitor identification number, which in UA is tied to the parameters ‚ÄúTraffic Source‚Äù, ‚ÄúCity‚Äù, ‚ÄúAdvertising Campaign‚Äù and others. <br><br>  Go to the second step.  As I mentioned at the beginning of the article, one of the main innovations in UA (and at the same time different from Google Analytics) is the ability to send hits inside the UA using regular HTTP requests.  That is, in fact, any device with access to the Internet can transmit information inside the UA system. <br><br>  Example http request: <br><br> <code><a href="http://www.google-analytics.com/collect%3Fv%3D1%26tid%3DUA-xxxx%26cid%3D555%26otherparameters"></a> www.google-analytics.com/collect?v=1&amp;tid=UA-xxxx&amp;cid=555&amp;otherparameters <br> v:  (    1) <br> tid: (  - UA) <br> cid: (  )</code> <br> <br>  When using a server based CRM system, the problem would be solved as follows: it would be necessary to refine the CRM system so that when the status of the transaction from Pending to Win changes, an HTTP request with the parameters we need is sent. <br><br>  Our company, however, uses web based CRM and it is natural to change the code of such a system, we have no opportunity.  The task, however, does not become much more difficult - fortunately, we are able to use the rich features of the HighRise API.  We need to write a small script that highlights all the latest ‚Äúwon‚Äù (win) transactions and transmits information on them inside Universal Analytics. <br><br>  It would seem that we are close to solving our problem.  However, at this point, we recall that in UA (as well as, in fact, in Google Analytics) there is no metric that allows you to consolidate information about income.  Here we come to the aid of another useful innovation in Universal Analytics - the ability to create your own parameters and metrics (we are in this case interested in metrics). <br><br>  So, it is said - done.  We return to the Google Analytics website, select the Universal Analytics web resource we created earlier from the list of accounts and resources, and click the Administrator button in the upper right corner.  Next, go to the tab User Defined, then - Custom Indicators: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ccb/ecd/cb8/ccbecdcb88918fb6652f4452b2f931e2.png" alt="image"><br><br>  Create a new custom indicator, indicating the type - Currency, as well as the minimum and maximum values: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f1/0c4/a5a/3f10c4a5a93d5991a83ebdec5271dfc4.png" alt="image"><br><br>  After creating a new metric, we also need to create a new custom report (generating a report using custom metrics is only possible using the custom report functionality ‚Äî this metric cannot be used in standard reports).  To do this, click on the Settings button, then - New user report.  In the appeared window we set the following data: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c45/c53/cdf/c45c53cdfa6f666399f2565d122b81ce.png" alt="image"><br><br>  Press the Create Report button and get the following table at the output: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/815/f80/b5c/815f80b5ca8aee233cede6907cf26b28.png" alt="image"><br><br>  So, we have created a custom metric and a simple user report to which we can later transfer the data we need for analysis.  In a similar way, you can create any other reports combining parameters and indicators (both custom and standard). <br><br>  I will not describe the process of writing the script and its code, since the article is not about the HighRise API, but go to the format (example) of the HTTP ‚Äìrequest.  The HTTP request looks like this: <br><br> <code><a href="http://www.google-analytics.com/collect%3Fv%3D1%26tid%3DUA-XXXX-YYY%26cid%3D1161411544.1373152807%26t%3Devent%26ec%3Dtransaction%26ea%3DXenia%26cm1%3D500000"></a> www.google-analytics.com/collect?v=1&amp;tid=UA-XXXX-YYY&amp;cid=1161411544.1373152807&amp;t=event&amp;ec=transaction&amp;ea=Xenia&amp;cm1=500000,  <br> v=1 ‚Äì  (    1) <br> tid= UA-XXXX-YYY ‚Äì   Universal Analytics <br> cid=1161411544.1373152807 ‚Äì Client ID  <br> t=event ‚Äì  ,    (       ,     (event),   (transaction).         <br> e=transaction ‚Äì   <br> ea=Xenia -    (         ,  ) <br> cm1=500000 ‚Äì   (     )</code> <br> <br>  We return to the custom report we created to verify that the data on completed transactions began to be transferred from the CRM system: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0c6/db3/e65/0c6db3e6546015338458b2f42b69f922.png" alt="image"><br><br>  Problem solved <br>  I hope the material will be useful to you! <br>  All good analytics and high ROI. </div><p>Source: <a href="https://habr.com/ru/post/186076/">https://habr.com/ru/post/186076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../186064/index.html">Tizen App Challenge App Competition</a></li>
<li><a href="../186066/index.html">Metric # 14 - Podcast on technologies and design of interfaces and services</a></li>
<li><a href="../186068/index.html">How we bought a BlackBerry Curve 9220 smartphone</a></li>
<li><a href="../186072/index.html">Rootkits: security issues and development trends</a></li>
<li><a href="../186074/index.html">Connect to the online broadcast of the international final of the Imagine Cup!</a></li>
<li><a href="../186078/index.html">We write our Orm for Android with Canas and Senorites</a></li>
<li><a href="../186080/index.html">PHPStorm + XDebug + Bitbucket: development on a remote server in a small team</a></li>
<li><a href="../186082/index.html">Browser game with the eyes of a game designer</a></li>
<li><a href="../186084/index.html">Resize animated GIF images using PHP + GD</a></li>
<li><a href="../186086/index.html">Google has released a patch for the vulnerability in Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>