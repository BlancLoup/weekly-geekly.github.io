<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Oberon in UAV programming</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all. 

 Oberon articles often mention the use of Oberon in programming satellites, hydroelectric power stations, nuclear power plants, and...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Oberon in UAV programming</h1><div class="post__text post__text-html js-mediator-article">  Good day to all. <br><br>  Oberon articles often mention the use of Oberon in programming satellites, hydroelectric power stations, nuclear power plants, and so on.  Severe industrial software systems.  Of course, I would like to have real code examples for each case, but this is not always possible, and therefore it seems that there are no products like that.  To correct this situation today I would like to talk about programming UAVs on Oberon. <br><a name="habracut"></a><br>  Since I never worked with a UAV myself, and used a microcontroller to use LEDs for flashing only (with the help of Oberon, of course), I asked to tell about my work an active participant in the Oberon developer community in Russia.  His name is Alexander. <br><br>  Further in the text <b>A.</b> - Alexander, <b>O.</b> - <a href="http://habrahabr.ru/users/oberon87/" class="user_link">oberon87</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>O .:</b> A few words about your work. <br>  <b>A .:</b> I work in a company that develops unmanned aerial vehicles, and I write programs for automatic aircraft control systems.  Aircraft are used mainly for aerial photography. <br><br>  <b>O .:</b> Why is Oberon, because there are a lot of microcontrollers and languages ‚Äã‚Äãon the market (mostly C)? <br>  <b>A .: The</b> reliability of onboard programs is important to us. <br><br>  Programs of early automatic control systems (in the 2000s and earlier) were run on MCS 51 microcontrollers and were written in the Pascal and Assembler programming languages ‚Äã‚Äãusing the EmbeddedPascal compiler.  The MCS 51 at the time was chosen because of its popularity. <br><br>  But gradually the resources of the microcontroller began to be missed, the compiler contained errors (which were avoided using assembler) due to the complexity of the MCS 51 architecture, new microcontrollers and the Astrobe compiler appeared, and since 2010 we began to write programs in the Oberon programming language under the NXP LPC2000 microcontrollers.  &lt;...&gt; Another difference from the previous system is that the new one is based on the use of cheaper and more compact sensors, which were not there before. <br><br>  The ARM architecture is simpler than MCS 51, and the Oberon programming language is simpler than Pascal, but still there were errors in the Astrobe compiler implementation that were gradually found and corrected. <br>  In fact, I do not even use all the features of the Oberon language - I do not use dynamic memory and garbage collection. <br><br>  I also do not like the syntax of C. <br><br>  <b>O .:</b> What did you use, how did you write the code in oberon, how easy / difficult is it? <br>  <b>A .:</b> As I already wrote, the reliability of onboard programs is important to us.  Using a simple programming language helps to write reliable programs.  Oberon is just as it is, it was conceived.  The compiler must also be reliable.  That is, if possible, too simple.  In order for the compiler to be simple, there must be a simple programming language and a target architecture.  This architecture is RISC. <br><br>  In 2014, I wrote my Oberon compiler for modern microcontrollers with the ARMv7-M architecture (Cortex-M4F) based on the Oberon-&gt; RISC compiler from <a href="http://www.projectoberon.com/">Project Oberon</a> Niklaus Wirth, and the program for the new automatic control system was written using it. <br><br>  The compiler was easy to write because it was already written (and because it contains the correct separation of functions into frontend and backend), and I just had to rewrite the background compiler (code generator) and write the linker.  And since the programming language is simple and the architecture of ARMm7-M is simple, it did not take long.  In order to write a compiler, I only needed to study the architecture of ARMv7-M and some features of modern microcontrollers (STM32 and LPC) for writing a linker. <br><br>  When writing system modules for microcontrollers NXP used User Manual, for STM32 - Reference Manual and datasheet.  I liked the NXP documentation more than the ST Microelectronics.  To understand the ambiguous places in the Reference Manual, I had to look at the sources of Keil libraries. <br><br>  When I wrote the compiler, I myself made a few mistakes, but I quickly found them and corrected them as I wrote the autopilot program, which I immediately experienced on a software-hardware model.  One error due to carelessness (indicated the wrong register as a parameter when generating one of the instructions), two due to the fact that I had to optimize one place, and this change required a change in the code generator elsewhere, but I did not immediately guess .  And two more three errors were found in the original compiler (one was probably made due to inattention, the other two were of the same type). <br><br>  After I wrote the compiler, I also had to write basic system modules to support microcontrollers ‚Äî to configure the kernel (PLL) and to work with the peripherals.  It was also easy to do. <br><br>  <b>O .:</b> Can you give an example code? <br>  <b>A .:</b> I did not find anything that can be cited as an example.  Well, here is a simple integer implementation of the low-pass filter: <br><pre><code class="hljs delphi">MODULE IntRC; <span class="hljs-comment"><span class="hljs-comment">(* Alexander Shiryaev, 2015.01 *)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> RC* = <span class="hljs-keyword"><span class="hljs-keyword">RECORD</span></span> rc*, n*: INTEGER <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">PROCEDURE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-function">* </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">VAR</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rc: RC; x, n: INTEGER)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> rc.rc := LSL(x, n); rc.n := n <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> Init; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">PROCEDURE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Set</span></span></span><span class="hljs-function">* </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">VAR</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rc: RC; x: INTEGER)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> rc.rc := LSL(x, rc.n) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">PROCEDURE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ASR1</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, n: INTEGER)</span></span></span><span class="hljs-function">:</span></span> INTEGER; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> x &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> INC(x, LSL(<span class="hljs-number"><span class="hljs-number">1</span></span>, n - <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> RETURN ASR(x, n) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> ASR1; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">PROCEDURE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">* </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">VAR</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rc: RC; x: INTEGER)</span></span></span><span class="hljs-function">:</span></span> INTEGER; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">PROCEDURE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ASR2</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, n: INTEGER)</span></span></span><span class="hljs-function">:</span></span> INTEGER; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> x &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> INC(x, LSL(<span class="hljs-number"><span class="hljs-number">1</span></span>, n) - <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> RETURN ASR(x, n) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> ASR2; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> rc.rc := rc.rc + ASR2(LSL(x, rc.n) - rc.rc, rc.n) RETURN ASR1(rc.rc, rc.n) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> Update; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">PROCEDURE</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function">* </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rc: RC)</span></span></span><span class="hljs-function">:</span></span> INTEGER; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> RETURN ASR1(rc.rc, rc.n) <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> Get; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> IntRC.</code> </pre> <br><br>  <b>O .:</b> Thanks for the info. <br><br>  As you can see from the interview, in order to start working with Oberon and increase the reliability of their products, you do not need anything but desire.  Each stage of development is so simple that there is nothing to even write about it. <br>  <s>Drink carrot juice!</s> <br>  Use Oberon for microcontrollers! <br><br>  PS and do not forget to visit the <a href="http://oberoncore.ru/">site of the Russian Oberon community</a> for more information. </div><p>Source: <a href="https://habr.com/ru/post/258695/">https://habr.com/ru/post/258695/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258685/index.html">The document that was waiting</a></li>
<li><a href="../258687/index.html">Travel to the world of technology - drones, cows surveillance, 3D printing of flying UAVs</a></li>
<li><a href="../258689/index.html">DevExpress at DevCon 2015</a></li>
<li><a href="../258691/index.html">Motion sensor for switching radio stations - part I</a></li>
<li><a href="../258693/index.html">Again about domain-based development (Domain-Driven Design, DDD)</a></li>
<li><a href="../258699/index.html">Robots and 3D printing</a></li>
<li><a href="../258701/index.html">IBM FlashSystem 820 storage system overview and testing</a></li>
<li><a href="../258705/index.html">Geo-targeting by city (region, country) for WordPress</a></li>
<li><a href="../258707/index.html">Digestible call of Java methods from native code</a></li>
<li><a href="../258709/index.html">Transparent transition PgQ -> RabbitMQ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>