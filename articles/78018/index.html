<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sparse NTFS files</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="NTFS has support for sparse files. These are files that take up less disk space than their own size. This technology is not related to the built-in su...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sparse NTFS files</h1><div class="post__text post__text-html js-mediator-article"> NTFS has support <b>for</b> sparse files.  These are files that take up less disk space than their own size.  This technology is not related to the built-in support for NTFS file compression, as the saving of disk space in sparse files is based on a different principle.  No data compression is performed.  Instead, in the file are released areas occupied only by zeros (0x00).  An application that reads a sparse file, when it reaches the area with zeros, reads zeros, but a real disk read will not occur. <br><a name="habracut"></a><br>  In this way, you can create giant-sized files, consisting of zeros, but on the disk they can take only a few kilobytes.  Real disk space is allocated when some other data is written instead of 0x00.  Sparseness will help save disk space only in such files that have really large empty areas. <br><br>  I will demonstrate how to work with sparse files using the fsutil command line utility. <br><br>  Using the utility, create an empty large file: <br> <code>fsutil file createnew test.nul 10000000000</code> <br> <br>  Give the file the attribute "sparse": <br> <code>fsutil sparse setflag test.nul</code> <br> <br>  The attribute itself does not yet save disk space.  It is also necessary to mark the area to be freed inside the file.  We have the entire file empty, so the area can be set to the file size. <br> <code>fsutil sparse setrange test.nul 0 10000000000</code> <br> <br>  Is done.  See the result. <br><img src="http://amdf.fatal.ru/img/sparsefile.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How to do these operations in your programs using API functions, you can look at the source code of a small utility that I wrote in 2006.  It is also a console, and also as fsutil is able to assign the sparse attribute and set the range of the region to be freed.  In addition, my program can itself look for empty areas larger than a certain size in the file and free them.  There is no need to calculate the offset itself. <br><br>  References: <br><ul><li>  <a href="http://hex.pp.ua/ntfs-sparse-files.php">Details about sparse files</a> </li><li>  <a href="http://hex.pp.ua/sparse-file-utility.php">The program for creating sparse files in NTFS</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/78018/">https://habr.com/ru/post/78018/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../78005/index.html">Nigma will share a million transitions</a></li>
<li><a href="../78012/index.html">SharePoint security - Part 1: Introduction</a></li>
<li><a href="../78014/index.html">What would you pay a startup for? What should a pro account have compared to the free version?</a></li>
<li><a href="../78016/index.html">Online passport copy fraud</a></li>
<li><a href="../78017/index.html">Tale of why I got up and left</a></li>
<li><a href="../78019/index.html">Internet providers merge info on subscribers?</a></li>
<li><a href="../78022/index.html">The problem with running WM</a></li>
<li><a href="../78023/index.html">Nested Grids with ExtJS 3.0</a></li>
<li><a href="../78024/index.html">PropertyGrid in Visual Studio: mapping fields associated with collections of objects</a></li>
<li><a href="../78026/index.html">How to take my money from the Yandex wallet. Part 5. Failure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>