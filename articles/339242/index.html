<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About traffic interception: 4-10% of encrypted HTTPS traffic is intercepted today</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most recently I happened to stumble upon a very curious overseas article . I would like to compare the facts stated there with the Russian experience....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About traffic interception: 4-10% of encrypted HTTPS traffic is intercepted today</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/59/d3/ac/59d3acf0e8087492868388.png"><br><br>  Most recently I happened to stumble upon a very <a href="https://blog.cloudflare.com/understanding-the-prevalence-of-web-traffic-interception/">curious overseas article</a> .  I would like to compare the facts stated there with the Russian experience.  Feel free to share your thoughts in comments.  Spoiler: chef, everything is gone! <a name="habracut"></a><br><br>  In this article we will look at the problem of intercepting encrypted web traffic and its impact on online security.  According to a study published in <a href="https://jhalderm.com/pub/papers/interception-ndss17.pdf">NDSS 2017</a> , today between 4% and 10% of HTTPS traffic is intercepted.  Analysis of interceptions has shown that although they do not always do harm, nevertheless, interception tools often weaken the encryption used to ensure the security of communications, which increases the risks for users. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  <font color="#cc0000">How is encrypted traffic intercepted?</font> </h3><br><img src="https://habrastorage.org/webt/59/d3/a8/59d3a8fc9e67f005376655.png"><br><br>  As shown in the illustration, the traffic is intercepted by a ‚Äú <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D1%2582%25D0%25B0%25D0%25BA%25D0%25B0_%25D0%25BF%25D0%25BE%25D1%2581%25D1%2580%25D0%25B5%25D0%25B4%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25B0">mediator attack</a> ‚Äù.  Special software redirects an encrypted connection to itself and pretends to be the requested site.  The interceptor then opens a new encrypted connection to the target site and proxies the data through itself, between the two connections, which makes the interception mostly ‚Äúinvisible‚Äù.  Since the interceptor gains access to unencrypted data within the connection, it can read, modify and block any content transmitted or received by the client. <br><br>  There are two main ways to intercept connections: local and remote. <br><br>  <b>Local interception</b> : when the interceptor is executed directly on the user's computer, the network stack of the operating system is modified to intercept and redirect connections to the interceptor.  This approach is commonly used by antivirus software to monitor network connections to identify malicious downloads and attempts by malware to steal data or embed advertising. <br><br>  <b>Remote interception</b> : performed by inserting into the network monitoring path connecting the user's computer to the site accessed by the user.  For example, this can be done by redirecting network traffic to the interceptor through firewall policies.  Network interception is usually performed by ‚Äúsecurity blocks‚Äù (the security box) that attempt to detect attacks or monitor corporate data leaks from all computers on the network.  These devices are also often used to intercept and analyze e-mail. <br><br><img src="https://habrastorage.org/webt/59/d3/a9/59d3a98aa07c5770831798.png"><br><br>  An important aspect of interception is how applications impersonate sites, and user browsers do not notice substitution.  Usually, when an HTTPS connection is established, the browser authenticates the site by checking the certificate presented on it.  If the certificate fails validation, then the browser issues a warning, as in the picture above, that the connection is potentially unsafe.  Therefore, the ‚Äúimpossibility of falsifying‚Äù TLS certificates is the cornerstone of online security.  This is a technical tool that gives us confidence that we communicate with the right side, and not with an impostor. <br><br><img src="https://habrastorage.org/webt/59/d3/a9/59d3a9a92ab6e145802195.png"><br><br>  The question arises, how can HTTPS interceptors generate valid certificates for all sites if they were created as non-existent?  The answer lies in the procedure for determining by the browser the validity of the certificate.  If in general, when installing a new connection, the browser looks to see whether the certificate presented on the site is signed by one of the certification authorities.  Center certificates are stored locally on a computer, <a href="https://technet.microsoft.com/en-us/library/cc754841.aspx">in a trusted store</a> , so any certificate of a certification authority that is added there can be used to generate a valid certificate for any site. <br><br>  Therefore, it is easiest for an interceptor to forge certificates not through some sophisticated cryptographic attack, but by adding its own ‚Äúroot‚Äù certificate to the storage on the computer.  Then the browser will trust any certificate signed by the interceptor.  This is not a vulnerability, because adding a certificate is, of course, possible only if the interceptor has access to the computer's file system, or if the certificate has been installed by the sysadmin. <br><br><h3>  <font color="#cc0000">How common is HTTPS interception?</font> </h3><br>  Measuring the number of interceptions is not an easy task, because interceptors do not advertise themselves.  So for recording the facts of interception, we used an improved version of the network fingerprint technology, known as TLS fingerprinting.  This allowed us to determine which software makes the connection (interceptor or browser).  The technology evaluates the design of the client welcome TLS packet (for example, cipher suites and TLS options) and compares it with a database of known fingerprints.  Their reliability is very high, especially compared to the user-agent advertised in the HTTP request. <br><br><img src="https://habrastorage.org/webt/59/d3/aa/59d3aa1e15e44206234582.png"><br><br>  Researchers evaluated the work of a large online store, the Cloudflare site and the Firefox update servers.  Estimated amount of browser traffic intercepted by their services.  It is important to have a lot of ‚Äúpoints of view‚Äù, because the result varies depending on where you look from.  For example, in general, the proportion of intercepted HTTPS connections varies from 4% to 10%.  This is a lot, but it is important to remember that not all interceptions are performed by intruders. <br><br><img src="https://habrastorage.org/webt/59/d3/aa/59d3aa3a8bd54232331240.png"><br><br>  Having smashed the traffic on Cloudflare and the online store by operating systems, it turned out that it intercepts with Windows much more often than with MacOS.  Traffic from Android and iOS is intercepted much less frequently than from desktop OS.  The full partition can be viewed on page 13 of our report (link at the beginning of the article). <br><br><img src="https://habrastorage.org/webt/59/d3/aa/59d3aa587a26d631135619.png"><br><br>  Splitting Firefox update traffic capturing shows a very different picture.  Most often intercept mobile providers involved.  In part, this can be explained by the fact that the desktop version of Firefox uses a separate storage for root SSL certificates, which makes it a less likely candidate for interception compared to other browsers. <br><br><h3>  <font color="#cc0000">Who and why is engaged in interception on communications?</font> </h3><br>  Contrary to popular belief, intercepting traffic is not necessarily harmful.  According to the study, traffic is usually intercepted for two opposite reasons: <br><br>  ‚Ä¢ <b>Improved security</b> : Antivirus and some corporate firewalls / IPS intercept traffic to protect their users.  They want to scan encrypted traffic, trying to prevent the penetration of malware or monitor data leakage.  Some parent software and ad blockers use a similar approach to block traffic to certain sites. <br><br>  ‚Ä¢ <b>Malicious activity</b> : at the other end of the spectrum is malicious software that intercepts in order to embed advertising or steal confidential data. <br><br><img src="https://habrastorage.org/webt/59/d3/aa/59d3aabc2b659749412239.png"><br><br>  Having identified the "prints" of well-known products, the researchers were able to attribute to their account a considerable share of interceptions.  In this case, several applications still could not be determined, which may well be malicious software. <br><br><h3>  <font color="#cc0000">How does interception of HTTPS traffic affect security?</font> </h3><br>  If the interception is not done for selfish purposes, then why can it weaken online security at all? <br><br><img src="https://habrastorage.org/webt/59/d3/aa/59d3aaf2c09ef450193627.png"><br><br>  The main reason is that most interception products do not use the best cryptography.  And when interception is performed, the connection from the interceptor to the site uses unsafe user data encryption instead of more robust algorithms used in modern browsers. <br><br><img src="https://habrastorage.org/webt/59/d3/ab/59d3ab0e8a6b1826288046.png"><br><br>  And because of weak / vulnerable encryption, traffic becomes more vulnerable to attacks.  Hackers can also intercept encrypted connections and steal data such as documents, emails and instant messengers.  In some cases, for example, with Komodia, the <a href="https://www.eff.org/deeplinks/2015/02/dear-software-vendors-please-stop-trying-intercept-your-customers-encrypted">implementation of cryptography is so bad</a> that an attacker can intercept any encrypted communications with minimal effort. <br><br><img src="https://habrastorage.org/webt/59/d3/ab/59d3ab87177eb895188087.png"><br><br>  To calculate the effect of HTTPS interceptions on connection security, researchers analyzed the security of cryptographic stacks used by interceptors.  In general, 65% of intercepted connections to Firefox update servers have reduced security, and 37% were easily vulnerable to ‚Äúintermediary attacks‚Äù due to vulgar cryptographic errors (for example, certificates were not validated) [65.7% + 36.8% = 102, 5%, but in the original - approx.  translator].  Not much better was the situation with traffic on Cloudflare. <br><br>  To finish on a ‚Äúpositive‚Äù note, you need to mention that in rare cases (4.1% from an online store and 14% from Cloudflare), interception increases the security of connections.  But this is mostly a consequence of the ranking of weaker ciphers (RC4 and 3DES). <br><br>  In general, HTTPS intercepts are more common than expected (4% -10%), and they entail serious risks because they degrade the quality of encryption.  Moreover, the HTTPS implementations used to intercept do not have the same automatic update mechanisms as in browsers, which makes the use of fixes less likely.  Passive and intercepting intermediate devices <a href="https://bugs.chromium.org/p/chromium/issues/detail%3Fid%3D733223">also affected</a> the delayed release of TLS 1.3 in browsers. <br><br>  We hope that drawing attention to this problem will help software vendors who rely on interception to realize the riskiness of this practice.  Well, we have another topic for discussion. </div><p>Source: <a href="https://habr.com/ru/post/339242/">https://habr.com/ru/post/339242/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339232/index.html">Rapid application development on Angular + Ag-Grid</a></li>
<li><a href="../339234/index.html">Announcement RamblerElixir # 4</a></li>
<li><a href="../339236/index.html">Do you have a fast site? And if I check?</a></li>
<li><a href="../339238/index.html">Squeeze all the juice from Chromium to Linux</a></li>
<li><a href="../339240/index.html">Generate short texts with limiting conditions - for advertising and other purposes.</a></li>
<li><a href="../339246/index.html">Few prefab tasks on bash</a></li>
<li><a href="../339248/index.html">The first hackathon Skyeng: 15 working projects in two days</a></li>
<li><a href="../339250/index.html">Identify hidden data dependencies to improve the quality of the forecast in machine learning</a></li>
<li><a href="../339252/index.html">Octopus Deploy. Improving the world in a bloody enterprise</a></li>
<li><a href="../339258/index.html">English subtitles with Leo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>