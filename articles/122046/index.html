<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating hybrid Qt Quick and C ++ applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon,% username%! 

 A little background: 

 Some time ago, I did a laboratory friend, whose subject is the Hamming code. The program was an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating hybrid Qt Quick and C ++ applications</h1><div class="post__text post__text-html js-mediator-article"><h4>  Good afternoon,% username%! </h4><br><br><h5>  A little background: </h5><br><br>  Some time ago, I did a laboratory friend, whose subject is the Hamming code.  The program was an ordinary Qt application with a minimum set of controls.  The delivery was successful, some time has passed, and now his friend also needs to pass a laboratory on the same subject.  The same program, obviously, can not be passed.  Then the question arises - how to make a program with three buttons and two text boxes unlike the previous one?  I had the idea to rewrite the interface using Qt Quick, and leave the logic and calculations of the program in C ++, and at the same time tell interested people how I usually do things like that.  According to Qt Quick, there is not so much literature, especially in Russian, so I really hope that this article will be useful and interesting. <a name="habracut"></a>  To clarify, the focus is on how Qt Quick interacts with C ++, to a lesser extent, the basics of Qt and QML, but not the counting of Hamming codes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Creation of the frame </h5><br><br>  So, the last seconds of installing Qt Sdk in my work, we are starting. <br>  Open QtCreator, create a new project like ‚ÄúQt GUI application‚Äù.  Select a directory, name, then in this window of the wizard: <br><img src="http://img12.imageshost.ru/img/2011/06/15/image_4df8f2bc5ce7a.png" alt="image"><br>  remove the checkbox "Create form".  We do not need it, we will write the entire interface with pens. <br>  In the generated mainwindow.h file, include the following header files: <br><br>  #include #include &lt;QtDeclarative / QDeclarativeContext&gt; <br>  #include &lt;QtDeclarative / QDeclarativeView&gt; <br><br>  In the constructor of the class MainWindow make the following changes: <br><br> <code>MainWindow::MainWindow(QWidget *parent) <br> : QMainWindow(parent) <br> { <br> QDeclarativeView* dv = new QDeclarativeView(); <br> dv-&gt;setSource(QUrl("qrc:/main.qml")); <br> QDeclarativeContext* cntx = dv-&gt;rootContext(); <br> cntx-&gt;setContextProperty("window",this); <br> <br> dv-&gt;setResizeMode(QDeclarativeView::SizeRootObjectToView); <br> setCentralWidget(dv); <br> }</code> <br> <br>  I will explain a little bit - we create a widget of the type QDeclarativeView - this is an element capable of displaying QML.  Then we set the name of the root QML element - main.qml, which is taken from the resources that we add later.  Then we get the context of the widget to add a new property ‚Äúwindow‚Äù in it.  Now from QML it will be possible to access the object called window - this is our form.  Why this is needed will become clear a little later.  The resizing mode is set below - now the root QML element will resize according to the window, and not vice versa.  The setCentralWidget method sets a central widget for QMainWindow.  Anyone who has experienced Qt is undoubtedly familiar with it. <br><br>  Our project needs a QML file, as mentioned above.  Add it: <br><img src="http://img12.imageshost.ru/img/2011/06/15/image_4df8f2d239448.png" alt="image"><br>  Now add the resource file in a similar way: <br><img src="http://img12.imageshost.ru/img/2011/06/15/image_4df8f552b9ada.png" alt="image"><br><br>  It opens automatically, click ‚ÄúAdd‚Äù -&gt; ‚ÄúAdd prefix‚Äù below, ‚Äú/ new / prefix1‚Äù appears.  We erase and leave only ‚Äú/‚Äù for simplicity.  Now add the main.qml file (‚ÄúAdd‚Äù -&gt; ‚ÄúAdd file‚Äù).  Another little thing - you need to make one change to the * .pro file <br>  QT + = core declarative <br>  In this simple way, we expose the project to a dependency on the QtDeclarative4 library. <br><br>  Now you can safely run the project and see ... White square 100 to 62 :) But appearance is deceptive - in fact it is much more than a white square, this application, whose interface is written in QML, and the logic in C ++. <br>  Something like this begins the creation of any application that will be a hybrid of Qt Quick and C ++.  The main point is getting the root context of the QDeclarativeView widget, adding a new property to access the C ++ object.  This property will become a kind of bridge between QML and C ++. <br><br><h5>  Creation of interface and logic </h5><br>  So, the creation of the base is passed, now the logic of the work. <br>  In the mainwindow.h file we add to the class description <br> <code>public slots: <br> QString slotEncode(QString sIn); <br> QString slotDecode(QString sIn); <br> bool slotCheck(int val); <br></code> <br>  By name it is clear that the first two slots will be engaged in coding and decoding.  Both will accept the input string that the user enters in QML, and return, respectively, the encoded or decoded version.  Why slots instead of ordinary functions?  Because it is slots, as well as functions, declared using the Q_INVOKABLE macro (see the documentation for details) can be called from QML by referring to an object made visible using setContextProperty ().  Simply put, it will be possible to write window.slotEncode () in QML :) Also, all the properties declared using the Q_PROPERTY macro are available from the QML code - they can be accessed directly by name. <br><br>  I will take the implementation of these slots from the old project, and will not give them here in full, you can download the archive from the link below.  There is also a small reservation - in the process of encoding and decoding a table is built, which I didn‚Äôt want to rewrite at all, so it will remain in its original form and will simply be shown in a separate window.  A slotCheck (int v) slot was also added for service purposes, used only in the process of counting the code, and of course, you need to add it, but you shouldn‚Äôt think at all what it is for - because it doesn‚Äôt belong to the lesson! <br><br>  Now it remains only to make the program interface :) <br>  Perhaps, I will give out that version of the interface, which is done in 15 minutes, by an ordinary programmer without a creative view of the world (although usually my girl artist helps me to do such things): <br> <code>import QtQuick 1.0 <br> <br> Rectangle { <br> width: 365 <br> height: 200 <br> gradient: Gradient { <br> GradientStop { <br> position: 0 <br> color: "#696363" <br> } <br> <br> GradientStop { <br> position: 1 <br> color: "#000000" <br> } <br> } <br> <br> Text { <br> id: text1 <br> x: 37 <br> y: 27 <br> color: "#fbfbfb" <br> text: " " <br> style: Text.Raised <br> font.pixelSize: 12 <br> } <br> <br> Text { <br> id: text2 <br> x: 198 <br> y: 27 <br> color: "#ffffff" <br> text: " " <br> style: Text.Raised <br> font.pixelSize: 12 <br> } <br> <br> //    . <br> Rectangle { <br> color: "#4de013" <br> radius: 6 <br> border.width: 5 <br> border.color: "#f5f9f4" <br> x: 36 <br> y: 66 <br> width: 133 <br> height: 20 <br> TextInput { <br> id: text_input1 <br> width: parent.width - 20 <br> height: parent.height - 5 <br> anchors.horizontalCenter: parent.horizontalCenter <br> anchors.verticalCenter: parent.verticalCenter <br> text: "" <br> <br> font.pixelSize: 12 <br> } <br> } <br> <br> //    . <br> Rectangle { <br> color: "#48c819" <br> radius: 6 <br> border.width: 5 <br> border.color: "#f5f9f4" <br> width: 133 <br> height: 20 <br> x: 201 <br> y: 66 <br> TextInput { <br> id: text_input2 <br> width: parent.width - 20 <br> height: parent.height - 5 <br> anchors.horizontalCenter: parent.horizontalCenter <br> anchors.verticalCenter: parent.verticalCenter <br> text: "" <br> font.pixelSize: 12 <br> } <br> } <br> <br> //  . <br> Rectangle { <br> id: bEncode <br> property alias text: label.text <br> <br> width: 135 <br> height: 60 <br> radius: 20 <br> border.width: 2 <br> border.color: "#090606" <br> <br> gradient: Gradient { <br> GradientStop { <br> id: gradientstop1 <br> position: 0.01 <br> color: "#ffffff" <br> } <br> <br> GradientStop { <br> id: gradientstop2 <br> position: 0.28 <br> color: "#867d7d" <br> } <br> <br> GradientStop { <br> id: gradientstop3 <br> position: 1 <br> color: "#000000" <br> } <br> } <br> <br> signal clicked() <br> x: 36 <br> y: 110 <br> <br> Text { <br> id: label <br> color: "#ffffff" <br> text: "" <br> font.strikeout: false <br> font.pointSize: 10 <br> horizontalAlignment: Text.AlignHCenter <br> anchors.centerIn: parent <br> } <br> <br> MouseArea { <br> id: mouseArea <br> anchors.fill: parent <br> hoverEnabled: true <br> onClicked: { <br> text_input2.text = window.slotEncode(text_input1.text) <br> } <br> onEntered: { <br> bEncode.state = "green" <br> } <br> onExited: { <br> bEncode.state = "gray" <br> } <br> } <br> states: [ <br> State { <br> name: "gray" <br> }, <br> State { <br> name: "green" <br> <br> PropertyChanges { <br> target: gradientstop1 <br> color: "#ffffff" <br> } <br> <br> PropertyChanges { <br> target: gradientstop2 <br> color: "#34c22a" <br> } <br> <br> PropertyChanges { <br> target: gradientstop3 <br> color: "#000000" <br> } <br> } <br> ] <br> <br> } <br> <br> //  . <br> Rectangle { <br> id: bDecode <br> property alias text: label.text <br> <br> width: 136 <br> height: 60 <br> radius: 20 <br> border.width: 2 <br> border.color: "#090606" <br> <br> gradient: Gradient { <br> GradientStop { <br> id: gradientstop21 <br> position: 0.01 <br> color: "#ffffff" <br> } <br> <br> GradientStop { <br> id: gradientstop22 <br> position: 0.28 <br> color: "#867d7d" <br> } <br> <br> GradientStop { <br> id: gradientstop23 <br> position: 1 <br> color: "#000000" <br> } <br> } <br> <br> signal clicked() <br> x: 200 <br> y: 110 <br> <br> Text { <br> id: label2 <br> text: "" <br> color: "#ffffff" <br> font.strikeout: false <br> font.pointSize: 10 <br> horizontalAlignment: Text.AlignHCenter <br> anchors.centerIn: parent <br> } <br> <br> MouseArea { <br> id: mouseArea2 <br> anchors.fill: parent <br> hoverEnabled: true <br> onClicked: { <br> text_input1.text = window.slotDecode(text_input2.text) <br> } <br> onEntered: { <br> bDecode.state = "green" <br> } <br> onExited: { <br> bDecode.state = "gray" <br> } <br> } <br> states: [ <br> State { <br> name: "gray" <br> }, <br> State { <br> name: "green" <br> <br> PropertyChanges { <br> target: gradientstop21 <br> color: "#ffffff" <br> } <br> <br> PropertyChanges { <br> target: gradientstop22 <br> color: "#34c22a" <br> } <br> <br> PropertyChanges { <br> target: gradientstop23 <br> color: "#000000" <br> } <br> } <br> ] <br> <br> } <br> } <br> <br></code> <br><br>  I'm not at all sure if the syntax will be highlighted correctly - let's hope that the similarity with JavaScript will play its positive role! <br><br>  Link to the source - <a href="http://zalil.ru/31269290">Tyk!</a> <br><br>  Result of work: <br><img src="http://img12.imageshost.ru/img/2011/06/17/image_4dfb09085fd34.png" alt="image"><br><br><h5>  Small total </h5><br><br>  The result of our work was a hybrid application.  In the future, the creation of such applications allows you to combine non-standard QtQuick interface with high-performance C ++ code.  I hope the article will be useful to those interested in these technologies, because the questions "Give Qt Quick literature" are becoming more common.  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/122046/">https://habr.com/ru/post/122046/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122038/index.html">Automatically add files to the WiX installer</a></li>
<li><a href="../122039/index.html">UserEcho visualization flexibly transforms to customer requests</a></li>
<li><a href="../122042/index.html">Introducing Evernote for Windows Phone 7</a></li>
<li><a href="../122043/index.html">Approach to testing code in real life. Part two</a></li>
<li><a href="../122044/index.html">One of the users of the Bitcoin system stole 25 thousand "coins" (approximately 300 thousand US dollars)</a></li>
<li><a href="../122047/index.html">A set of beta testers for virtual hosting</a></li>
<li><a href="../122050/index.html">How did ABBYY employees compete in throwing gadgets, or a little about a staff rally</a></li>
<li><a href="../122051/index.html">The factory for the production of ringtones on your site</a></li>
<li><a href="../122053/index.html">Sberbank - Always nearby</a></li>
<li><a href="../122054/index.html">PHP module for Tarantool</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>