<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Advantageous replacement with tiring arrays: review and tests of the HP 3PAR 7400 full-flash hardware</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kick such a box with extreme caution. 

 In general, I just wanted to say that if you watch an all-flash array to replace the tiring with a price per ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Advantageous replacement with tiring arrays: review and tests of the HP 3PAR 7400 full-flash hardware</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/424/def/dd8/424defdd844b4ee2a2607cab128db147.jpg"><br>  <i>Kick such a box with extreme caution.</i> <br><br>  In general, I just wanted to say that <b>if you watch an all-flash array to replace the tiring with a price per gigabyte a little lower</b> , reliable, and from a top vendor - read on.  The minimum American street price, announced by the vendor, starts with 19 thousand dollars.  But it is clear that on projects where such iron is needed, there is always a discount, a program or a special offer that can reduce the price of the specification, sometimes significantly.  Look inside to see why SSD can be cheaper than a tiring array, in particular, for VDI. <br><br>  The story began of this piece of iron with the fact that HP has long suspected that after about 2012, more and more server capacity will require fast storage systems.  Therefore, they bought the 3PAR office, which riveted good midrange storage systems, took the file, and it started.  What happened - now show. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Architecture </h4><br>  When I first got the HP 3PAR 7400 in my hands, I was skeptical of him as my younger brother in the Full Flash family of arrays.  But two days spent with the array, greatly changed my opinion. <br><br>  The HP 3PAR 7400 expands to 4 controllers, can carry 240 SSD drives, holds 96 Gb of RAM into each controller pair, and is simply very beautiful.  The iron part of the array is not much different from the usual mid-rande arrays, but the software was pleasantly surprised by its architecture.  It looks more like high-end software arrays, than to what I'm used to in the middle-level arrays. <br><br>  The facts are as follows: <br><br>  <b>The array can be expanded to 4 controllers,</b> that is, the HP 3PAR fault tolerance level (if properly configured) is much higher than that of most mid-level arrays. <br><br>  <b>Then the cache.</b>  In most mid-range arrays, the controller pair has a cache divided into read and write.  The write cache is mirrored between the controllers, but only as protection, and the heads use their memory separately.  If the storage system wants to get a significant part of the market, it needs to learn how to dynamically resize the memory allocated for reading and writing.  HP 3PAR went further.  Engineers made a Cache-Centric array with shared memory for all controllers.  As a result, a team of 4 controllers in the HP 3PAR works significantly better than 4 loosely coupled controllers in most mid-range storage systems. <br><br>  <b>Deduplication</b>  No one likes doing the same job twice.  With this marketing statement, many arrays rushed into the market, offering solutions with deduplication.  If to understand, the majority of these arrays do deduplication in the post-process.  Write data to disk, and then, when there is free time, read this data and try to deduplicate.  Thus, the work was done not twice, but four times.  In the plus - some gain in place with a small percentage of the record.  In other cases - not applicable.  3PAR does deduplication on the fly without recording intermediate data.  Thus, a well-deduplicated dataset results in a gain in the speed of the array (less data needs to be written to the disks, some of it is eliminated as already recorded), and space is saved. <br><br>  <b>The system also does not write empty (zero) blocks.</b>  They are eliminated at the level of ASICs. <br><br>  <b>Among us are left-handed and right-handed.</b>  Similarly with arrays.  There are Active \ Passive arrays (these are one-armed), Active \ Active ALUA (these are the average left-handers and right-handers), and there are honest Active \ Active.  HP 3PAR is exactly that.  The array controllers are equal, no problems with moving the moons and inactive paths. <br><br><img src="https://habrastorage.org/files/507/a68/de7/507a68de769b4a80a66224471d1444e1.jpg"><br>  <i>Array controller</i> <br><br>  <b>Updating arrays is better online.</b>  The average array during the upgrade reloads the controllers one by one, which means that the host at some time loses half the way.  Usually passes without problems, but sometimes a host can dull and not restore the path on time.  Updating the next controller will put the other half of the paths.  Applications of such treatment can not forgive and fall with a thud, causing alerts in the monitoring systems and gray hair on the heads of admins.  In 3PAR we tried to take into account the problems of ordinary people and save us from them.  In the event of a controller being upgraded or broken, its WWNs will temporarily move to the next controller.  As a result, the paths are not lost, the butt does not fall, and I will sleep more calmly (and more). <br><br>  <b>Placement of data.</b>  Typically, storage is sliced ‚Äã‚Äãinto fixed RAID groups.  The disadvantages of this approach are as follows: <br><ul><li>  The moons are located on only one RAID group. </li><li>  If the disk fails, one RAID group is involved in the rebuild.  Slow and unreliable. </li><li>  Need a dedicated HotSpare drive.  It is clear that the place must be reserved in any case, but the disk is idle.  I would like to use it, especially if it is an SSD in the FULL FLASH array. </li><li>  On the same set of disks can lie the moon only with the same level of protection. </li></ul><br>  Here the solution is this: all disks are cut into small pieces from which moons can be made.  For each moon, you can choose the level of protection and the number of pieces for which it will be considered as parity.  On one disk can lie the moon with a different level of protection, and each moon is smeared on all disks.  It turns out: <br><ul><li>  Each moon is evenly distributed across the storage disks. </li><li>  If the disk breaks, all disks of the array are involved in the rebuild. </li><li>  You do not need a dedicated HotSpare disk. </li><li>  On the same disks data with a different level of protection is easily placed. </li></ul><br>  Well, how do you like the functional?  For the price - mid-range.  Compare the functionality with what is in your server. <br><br>  <b>The theoretical part is over, it's time to move on to testing.</b>  I want to note that performance testing does not pretend to "complete report on the performance of the array."  This requires a week and several configuration options.  Here are a few basic tests that provide a general understanding of storage capabilities.  There are only 12 disks in the test piece. <br><br><img src="https://habrastorage.org/files/2f3/43d/75a/2f343d75a77043e799274eb1c95145b1.jpg"><br>  <i>Our copy</i> <br><br>  To assess the performance of storage systems with a large number of disks, you will have to use logic and a calculator.  I tested three types of load.  The charts below.  On the left - the moon without deduplication, on the right - the same moon with deduplication.  The data that I wrote to the disk is completely random and absolutely not deduplicating - it was interesting for me to look at the "overhead" of deduplication. <br><br><h4>  Test 1. 100% reading, 100% Random, blocks 4k </h4><br><img src="https://habrastorage.org/files/751/ca2/a33/751ca2a33f0f4c8bafd4a4f11b88a255.png"><br><br>  On 12 SSD drives, the array makes about 300,000 IO with a response time of less than a second.  Unfortunately, the response time on the moons with deduplication starts to ‚Äúcollapse‚Äù after 250,000 IO, but the result is still less than a millisecond. <br><br><h4>  Test 2. 70% read, 30% write, 100% Random, 4k blocks </h4><br><img src="https://habrastorage.org/files/5a8/a9e/a14/5a8a9ea14f504a90a39912010090ece8.png"><br><br>  From the graphs it is clear that the moon with deduplication noticeably lost in performance on a mixed load.  But 90,000 IO on a non-duplicated moon with a response less than 1 ms in a 12-disk storage system is a good result for midrange storage systems.  For moons with deduplication on this configuration, 45,000 is the ceiling, although the response time is normal. <br><br><h4>  Test 3. 100% record, 100% Random, blocks 4k </h4><br><img src="https://habrastorage.org/files/185/08e/c56/18508ec56a38475cb502dedd5c95da9c.jpeg"><br><br>  Quite worthy for 100% random recording.  The response time, of course, is a bit overstated, but this is easily solved by adding disks. <br><br><h4>  Test 4. Classic test with pulling out a disc on a mixed load. </h4><br><img src="https://habrastorage.org/files/e99/db5/50c/e99db550c6284e6e97e2fe376fb473ba.jpeg"><br><br>  It can be seen that the performance of the array fell slightly, but since all disks are involved in the rebuild at the same time, there was no sharp drop in performance. <br><br><h4>  The most important </h4><br>  The array will be an excellent all-flash substitute for the old man for use in a mixed or virtual environment.  An all-flash array is usually more expensive than a tiring solution, but if we consider in-line deduplication, then everything may not be so obvious.  With a deduplication ratio of 2, Flash arrays are starting to become cheaper than the tiring ones.  But you need to be considered for a specific case. <br><br>  The equipment is imported into Russia through a distributor.  On average, even now, it takes 8 weeks from placing an order to delivery.  Configurator bills are billed in dollars, if necessary we can convert the specification into rubles for the contract.  By the way, this equipment can be ordered on the program Flexible Capacity Service. <br><br><h4>  What do you need to know about this iron? </h4><br>  A maximum of 240 SSD drives can be scored in the array.  Interface - FC, 8 Gb / s, 8 ports, you can add another 16 ports FC or 10 GbE iSCSI.  At least two controllers, maximum 4 controllers.  RAID 1, RAID 5 and RAID 6. 64 GB cache per controller pair. <br><br><h4>  Special features </h4><br><ol><li>  The piece of iron is very cool.  <b>3PAR is good for mixed and virtual environments</b> , great for all well-duplicated data (all sorts of virtualization, VDI).  Can be used as a universal storage system.  It will work like a Kalashnikov machine gun, but the price per gigabyte in full Flash configuration will be slightly higher than that of tiring arrays. </li><li> There are some features.  <b>If you write a lot of information on the storage for a long time, the performance drops</b> .  In my opinion, this is due to the CMLC FLASH memory technology used in the disks, which makes it possible to significantly win the price of the disk.  It seems that the array at certain times artificially limits the recording speed in order to avoid premature disc wear, but there is no documentary evidence of this fact. </li><li>  <b>On board there is free (for other vendors, this option often goes for extra money) deduplication</b> , but don‚Äôt expect much deduplication of the database.  She sharpened for virtual environments.  Deduplication block - 16 kilobytes. </li><li>  Vendor writes the <b>price per gigabyte</b> 1.5 dollars.  In our test, it turned out higher, but still very tasty. </li></ol><br><br>  Here is a <a href="http://www8.hp.com/h20195/V2/getpdf.aspx/4AA5-9493ENW.pdf%3Fver%3D1.0">link</a> to the description of different technological chips of the array. <br><br><h4>  Line model differences </h4><br><img src="https://habrastorage.org/files/e3a/fe3/c20/e3afe3c20bc441318b22aff356eb1e9b.png"><br><br>  This testing is completed.  Ready to answer questions, write in the comments or directly to the email rpokruchin@croc.ru. </div><p>Source: <a href="https://habr.com/ru/post/267395/">https://habr.com/ru/post/267395/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267383/index.html">Envato says goodbye to Flash and ActiveDen</a></li>
<li><a href="../267387/index.html">Local number formatting speed</a></li>
<li><a href="../267389/index.html">Java collections: what many people forget</a></li>
<li><a href="../267391/index.html">Droidcon Moscow 2015: already this Friday</a></li>
<li><a href="../267393/index.html">Application and Desktop Virtualization: A New Look at Old Issues</a></li>
<li><a href="../267399/index.html">Selfish gene</a></li>
<li><a href="../267401/index.html">Spectral method on the example of simple problems of mathematical physics</a></li>
<li><a href="../267403/index.html">High Frequency Trading: A Guide from the Hero of the Flash Boys</a></li>
<li><a href="../267405/index.html">History how we want to make our world a little bit better</a></li>
<li><a href="../267407/index.html">I am a developer, but this is not my passion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>