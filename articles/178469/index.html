<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sending letters in HTML format with pictures</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The essence of the problem: 
 Actually I want to see a letter of the same kind as what Outlook sends. Everything is beautiful. But in the description ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sending letters in HTML format with pictures</h1><div class="post__text post__text-html js-mediator-article"><h4>  The essence of the problem: </h4><br>  Actually I want to see a letter of the same kind as what Outlook sends.  Everything is beautiful.  But in the description of the MailMessage class there is absolutely no documentation on how to make such a letter.  For example, if you write instead of a link to a picture, the name of the picture is in the attachment, then it will of course be displayed, but it will also be displayed as an attachment (which you don‚Äôt want). <br><br><h4>  Origins </h4><br>  When you try to send a letter in HTML format using .Net, without special actions, the letter is displayed incorrectly in mail systems and mail programs (not all), which is unpleasant.  Actually the trouble is that the pictures are visible as attachments and sometimes distort the form of the letter. <br><a name="habracut"></a><br><br><h4>  Decision </h4><br>  Having rummaged on the Internet, I found out that such a thing can be turned with the help of an alternative representation of a letter. <br>  It turns out that when sending a letter it may contain several views for displaying in a different format. <br>  But what to do with these ideas was not very clear; reading the documentation led me to the following: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  To create a letter with pictures that are not displayed without attachments, you need to create an alternative view and upload pictures there as resources </h5><br><br>  in this example, I will give only the code to create an alternative view and add it to the letter <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mailMessage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> System.Net.Mail.MailMessage(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mailHTML = <span class="hljs-comment"><span class="hljs-comment">//        var images = new List&lt;System.Net.Mail.LinkedResource&gt;(); //        //         img   System.Net.Mail.LinkedResource //      Images.         (  src) //   "cid:{ }",  { } -   ContentId   LinkedResource ... //             var htmlView = AlternateView.CreateAlternateViewFromString(mailHtml, Encoding.UTF8, MediaTypeNames.Text.Html); //         images.ForEach(htmlView.LinkedResources.Add); //         mailMessage.AlternateViews.Add(htmlView); //        </span></span></code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/178469/">https://habr.com/ru/post/178469/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../178457/index.html">What questions can be answered by analyzing 1,500,000 unique case histories?</a></li>
<li><a href="../178459/index.html">Report from InterSystems Global Summit 2013</a></li>
<li><a href="../178461/index.html">REG.RU presents ‚Äúflexible‚Äù hosting from Jelastic to Russian users</a></li>
<li><a href="../178463/index.html">Starter "from scratch", my experience, success stories</a></li>
<li><a href="../178467/index.html">Calls within the organization from the Corporate Portal</a></li>
<li><a href="../178473/index.html">edn: extensible data notation</a></li>
<li><a href="../178475/index.html">Becoming an analyst</a></li>
<li><a href="../178477/index.html">Overview of the restrictions imposed on exceptions, for example, inheritance and interface implementation</a></li>
<li><a href="../178481/index.html">A quick way to create an installer for a Java program</a></li>
<li><a href="../178483/index.html">Is there life in the world of PostPC? Part 3: having fun with iOS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>