<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We build Touch ID in iOS application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Starting with iOS 8, Apple provides access to the use of Touch ID technology (authentication using a fingerprint scanner embedded in th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We build Touch ID in iOS application</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/031/b62/67c/031b6267cfca4b86ba06f3adcf3f01e1.png"><br><br><h4>  Introduction </h4><br>  Starting with iOS 8, Apple provides access to the use of Touch ID technology (authentication using a fingerprint scanner embedded in the iPhone 5s) in third-party applications.  In this regard, I would like to share with you detailed information about what exactly became available to developers, how to embed it in your application, what behavior it has, and also share a convenient "wrapper" that implements the most, in my opinion, likely use of Touch ID. <a name="habracut"></a><br><br>  The required API is presented in the new LocalAuthentication framework.  At the moment, its functionality is limited to interaction with the fingerprint scanner, but judging by the more general name, its feature set is likely to expand in the future.  The framework does not provide any data about the user (which is generally logical), but only allows the user to be prompted to authenticate using biometrics (at the moment it is an integrated fingerprint scanner; however, it‚Äôs not about the scanner in the framework, more general word biometrics).  At the output, we get the status: either the authentication was successful, or something went wrong.  In fact, at almost any moment in time, one can determine whether the one who uses the device really owns it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This suggests using a Touch ID as additional protection when performing any important operations.  For example, when confirming the transfer of funds, changing any important settings, initializing a secure chat, etc., that is, where the application should be as sure as possible that the smartphone was not in the hands of the intruder. <br><br>  In order for the post to be not only readable but also reusable, I decided to describe integration with the Touch ID in the form of a ‚Äúwrapper‚Äù that implements the above described scenario, which in the future can save you several hours of working time.  The description is presented in the form of ‚Äúproblem-solution‚Äù, so that it is clear what is being done and for what.  And so, let's get started. <br><br><h4>  Task </h4><br>  When performing important operations in the application, you must be able to request user authentication using the built-in biometrics tools.  The need to request such authentication should be customizable by the user.  You also need to take into account that the application can work on earlier versions of the operating system and on devices that lack biometrics tools. <br><br><h4>  Decision </h4><br>  The solution will be presented in the BiometricAuthenticationFacade class. <br>  First of all, let's look at the most important thing - interaction with the LocalAuthentication framework.  This part is hidden from the user and is not accessible from the class interface. <br><br>  In a class extension, declare a property to hold the context: <br><pre><code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BiometricAuthenticationFacade</span></span></span><span class="hljs-class"> () @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">property</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nonatomic</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">strong</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LAContext</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">authenticationContext</span></span></span><span class="hljs-class">; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br>  Perform property initialization based on the availability of the API: <br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">instancetype</span></span>)init { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> = [<span class="hljs-keyword"><span class="hljs-keyword">super</span></span> init]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.isIOS8AndLater) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.authenticationContext = [[LAContext alloc] init]; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>; }</code> </pre><br>  Next, we define a method that will return the availability of using local authentication: <br><pre> <code class="objectivec hljs">- (<span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span>)isPassByBiometricsAvailable { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.authenticationContext canEvaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics error:<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>]; }</code> </pre><br>  As a parameter, the <code>canEvaluatePolicy:error:</code> method takes a type of local authentication.  Currently only one type of <code>LAPolicyDeviceOwnerAuthenticationWithBiometrics</code> , which speaks for itself.  Using biometrics may not be available if the device does not physically support this feature, or if the user has not enabled this feature in the smartphone settings. <br><br>  A request to perform a user's fingerprint scanning will be described as follows: <br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)passByBiometricsWithReason:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)reason succesBlock:(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(^)())successBlock failureBlock:(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(^)(<span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span> *error))failureBlock { [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.authenticationContext evaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics localizedReason:reason reply:^(<span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span> success, <span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span> *error) { <span class="hljs-built_in"><span class="hljs-built_in">dispatch_async</span></span>(dispatch_get_main_queue(), ^{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (success) { successBlock(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { failureBlock(error); } }); }]; }</code> </pre><br>  As parameters, the <code>evaluatePolicy:localizedReason:reply:</code> method takes the above described type of local authentication, a message that should briefly describe the reason for the request, and a block that will be asynchronously executed after the completion of the entire procedure. <br><br>  Please note that the execution of the <code>reply</code> block on the main stream is not guaranteed (in fact it is not called on the main one), therefore the <code>dispatch_async</code> call is added.  It would be possible to leave it as it is, but most developers assume that the block that is passed to the method called on the main thread will also be called on the main thread, and do not put an additional check.  It happened so historically. <br><br>  When calling the above described method, the system displays the dialog: <br><img src="https://habrastorage.org/files/887/282/fc8/887282fc8dae4cf2be0356dfb0f4cd5a.png"><br><ol><li>  The title uses the application name ( <code>CFBundleDisplayName</code> ); </li><li>  The string specified as the <code>localizedReason</code> parameter; </li><li>  With this field is not so simple.  When it is pressed, the dialog for entering the password will not appear, as you might have thought, but instead the <code>reply</code> block will be called with an error.  The error code is documented: <br><blockquote>  LAErrorUserFallback <br>  Authentication button has been canceled because the user has tapped the fallback button (Enter Password). <br></blockquote>  That is, it was intended.  As the user <a href="https://habrahabr.ru/users/flanker_4/" class="user_link">Flanker_4</a> explained, the system thus offers the application to independently perform alternative authentication: entering the application password.  That is, the implementation of dialogue and logic for entering and checking a password lies on the shoulders of the developer; </li><li>  Button to cancel the request.  As a result, the <code>reply</code> block will be called with the corresponding <code>LAErrorUserCancel</code> error. </li></ol><br>  If the scan was successful, the reply block will be called with a positive result. <br>  It should be noted that the dialog for scanning is not displayed every time the <code>evaluatePolicy:localizedReason:reply:</code> method is called.  That is, the success of the last scan has a certain lifetime.  Repeated authentication attempt within a few minutes will result in an instant call to the <code>reply</code> block with a positive result. <br><br>  If you use the wrong finger and try to scan it 5 times in a row, the system will offer to enter the password specified in the smartphone settings: <br><img src="https://habrastorage.org/files/24a/bf0/430/24abf04305004916b2dd5b898c346258.png"><br>  For clarity, I will clarify that it is impossible to turn on the scanner in the smartphone settings without creating a password. <br>  After the user enters the correct password, he will again be prompted to scan a fingerprint.  But, as the user of <a href="https://habrahabr.ru/users/simplix/" class="user_link">simplix noted</a> , if you know the device password, then the scanner can be disabled in the global settings of the device.  In fact, re-displaying the dialog for scanning does not make sense. <br><br>  This completes the interaction with <code>LocalAuthentication</code> . <br>  Let us turn to the implementation of the interface of our facade. <br><br>  Method to find out the availability of authentication.  The result is determined by the availability of the API and the scanner: <br><pre> <code class="objectivec hljs">- (<span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span>)isAuthenticationAvailable { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.isIOS8AndLater &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.isPassByBiometricsAvailable; }</code> </pre><br>  A method for determining whether authentication is enabled for an operation: <br><pre> <code class="objectivec hljs">- (<span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span>)isAuthenticationEnabledForFeature:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)featureName { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.isAuthenticationAvailable &amp;&amp; [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> loadIsAuthenticationEnabledForFeature:featureName]; }</code> </pre><br>  An example of a transaction could be access to settings, a cash transaction, etc. <br>  Power-on state is stored in NSUserDefaults.  Below is the implementation of the <code>loadIsAuthenticationEnabledForFeature:</code> method <code>loadIsAuthenticationEnabledForFeature:</code> <br><br>  Method to enable authentication for a specific operation: <br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)enableAuthenticationForFeature:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)featureName succesBlock:(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(^)())successBlock failureBlock:(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(^)(<span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span> *error))failureBlock { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.isAuthenticationAvailable) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> isAuthenticationEnabledForFeature:featureName]) { successBlock(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> saveIsAuthenticationEnabled:<span class="hljs-literal"><span class="hljs-literal">YES</span></span> forFeature:featureName]; successBlock(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { failureBlock(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.authenticationUnavailabilityError); } }</code> </pre><br>  The method is necessary so that the user of the application has the opportunity to independently determine operations for which additional verification is necessary. <br>  The enable state is stored in <code>NSUserDefaults</code> .  Below is an implementation of the <code>saveIsAuthenticationEnabled:forFeature</code> . <br><br>  Authentication off method for a specific operation: <br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)disableAuthenticationForFeature:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)featureName withReason:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)reason succesBlock:(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(^)())successBlock failureBlock:(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(^)(<span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span> *error))failureBlock { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.isAuthenticationAvailable) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> isAuthenticationEnabledForFeature:featureName]) { [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> passByBiometricsWithReason:reason succesBlock:^{ [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> saveIsAuthenticationEnabled:<span class="hljs-literal"><span class="hljs-literal">NO</span></span> forFeature:featureName]; successBlock(); } failureBlock:failureBlock]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { successBlock(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { failureBlock(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.authenticationUnavailabilityError); } }</code> </pre><br>  As you can see, to turn off, you need to make sure that we are dealing with the owner of the smartphone, and not the attacker. <br><br>  The method of requesting user authentication to access the operation: <br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)authenticateForAccessToFeature:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)featureName withReason:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)reason succesBlock:(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(^)())successBlock failureBlock:(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(^)(<span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span> *error))failureBlock { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.isAuthenticationAvailable) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ([<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> isAuthenticationEnabledForFeature:featureName]) { [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> passByBiometricsWithReason:reason succesBlock:successBlock failureBlock:failureBlock]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { successBlock(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { failureBlock(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.authenticationUnavailabilityError); } }</code> </pre><br>  Methods for storing and retrieving information about the need to authenticate a user to access an operation (not available from the class interface): <br><pre> <code class="objectivec hljs">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)saveIsAuthenticationEnabled:(<span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span>)isAuthenticationEnabled forFeature:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)featureName { <span class="hljs-built_in"><span class="hljs-built_in">NSUserDefaults</span></span> *userDefaults = [<span class="hljs-built_in"><span class="hljs-built_in">NSUserDefaults</span></span> standardUserDefaults]; <span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> *featuresDictionary = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">NSDictionary</span></span> *currentDictionary = [userDefaults valueForKey:kFeaturesDictionaryKey]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentDictionary == <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { featuresDictionary = [<span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> dictionary]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { featuresDictionary = [<span class="hljs-built_in"><span class="hljs-built_in">NSMutableDictionary</span></span> dictionaryWithDictionary:currentDictionary]; } [featuresDictionary setValue:@(isAuthenticationEnabled) forKey:featureName]; [userDefaults setValue:featuresDictionary forKey:kFeaturesDictionaryKey]; [userDefaults synchronize]; } - (<span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span>)loadIsAuthenticationEnabledForFeature:(<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)featureName { <span class="hljs-built_in"><span class="hljs-built_in">NSUserDefaults</span></span> *userDefaults = [<span class="hljs-built_in"><span class="hljs-built_in">NSUserDefaults</span></span> standardUserDefaults]; <span class="hljs-built_in"><span class="hljs-built_in">NSDictionary</span></span> *featuresDictionary = [userDefaults valueForKey:kFeaturesDictionaryKey]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [[featuresDictionary valueForKey:featureName] boolValue]; }</code> </pre><br>  <code>NSUserDefaults</code> used as storage.  All data is stored in a separate dictionary to reduce the likelihood of conflicts in the names of keys. <br>  This is where the main implementation of the facade ends. <br><br><h4>  Ending </h4><br>  And finally, for those who have mastered reading to the end, some interesting facts about the scanner in the iPhone 5s: <br><ul><li>  The probability of a false pass, i.  the fact that the imprint of a random person will be recognized as yours is 1 in 50,000; </li><li>  The system allows you to perform 5 scanning attempts before a user password is requested.  Thus, a brute-force attack cannot be performed, and the probability that a scanner can be hacked by an attacker is ‚âà0.0001; </li><li>  The scanner captures a bitmap image with a size of 88x88 pixels and a density of 500 ppi.  The resulting raster image is converted into a vector and is subjected to additional analysis; </li><li>  The resulting fingerprint data is stored in encrypted form in a special area (Secure Enclave) on the A7 processor.  The data is encrypted with a private key that is generated and written to Secure Enclave during the production of the processor in the factory.  Apple claims that neither the encrypted data nor the private key leaves the mobile device and are unknown to third parties, including Apple itself. </li></ul><br><br>  Source of interesting facts: <a href="http://www.apple.com/ipad/business/docs/iOS_Security_Feb14.pdf">iOS Security</a> <br>  The full version of the source code is available on GitHub: <a href="https://github.com/Visput/BiometricAuthenticationFacade">BiometricAuthenticationFacade</a> </div><p>Source: <a href="https://habr.com/ru/post/235699/">https://habr.com/ru/post/235699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235681/index.html">Entertaining web quest. Get the whole URL</a></li>
<li><a href="../235685/index.html">ASUS MEMO Pad 7 Tablet Review (ME176CX)</a></li>
<li><a href="../235689/index.html">Github stats</a></li>
<li><a href="../235691/index.html">Remove ads in uTorrent in 15 seconds</a></li>
<li><a href="../235693/index.html">Samsung introduced a new smartphone GALAXY Note 4 and its modification with a curved screen - GALAXY Note Edge</a></li>
<li><a href="../235701/index.html">GitHub's CSS</a></li>
<li><a href="../235703/index.html">Noise Security Bit # 9 (about Black Hat 2014 and Defcon 22)</a></li>
<li><a href="../235707/index.html">Raise SOC: ARM + FPGA</a></li>
<li><a href="../235711/index.html">Button gouging and pedaling Vim</a></li>
<li><a href="../235713/index.html">SMS virus under the Android OS or "Hello :) You photo ..."</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>