<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Basic principles of machine learning on the example of linear regression</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello colleagues! This is the blog of the open Russian- speaking date of the Scientology Lodge . We are already a legion, more precisely 2500+ people ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Basic principles of machine learning on the example of linear regression</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/c53/120/975/c53120975d6e450687a084f06abff1ed.jpg" align="right" width="320">  Hello colleagues!  This is the blog of the open Russian- <a href="http://ods.ai/">speaking date of the Scientology Lodge</a> .  We are already a legion, more precisely 2500+ people in Slak.  For a year and a half, we generated 800k + messages (for the sake of this, we gave us a corporate account.  Our people are everywhere and maybe even in your organization.  If you are interested in machine learning, but for some reason you don‚Äôt know about <a href="http://ods.ai/">Open Data Science</a> , then perhaps you are aware of the activities organized by the community.  The most ambitious of them is <a href="http://datafest.ru/">DataFest</a> , which was held recently at the office of <a href="https://corp.mail.ru/ru/press/events/307/">Mail.Ru Group</a> , in two days it was visited by 1,700 people.  We grow, our lodges open in the cities of Russia, as well as in New York, Dubai and even in Lviv, yes, we do not fight, and sometimes we even drink strong drinks together.  And yes, we are a non-profit organization, our goal is education.  We do everything for the sake of art.  (ps: in the photo you can watch the sitting of the lodge in one of the secret churches in Moscow). <br><br>  I have the honor of making the first post, and I will probably deviate from <a href="https://habrahabr.ru/users/mephistopheies/topics/">my usual neural network subjects</a> and make a post about basic machine learning concepts using the example of one of the simplest and most useful models - linear regression.  I will use the python language to demonstrate experiments and draw graphs, you can easily repeat all this on your computer.  Go. <br><a name="habracut"></a><br><h2>  Formalism </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2d4/41b/4b6/2d441b4b680a4e83a48a90d25d593cac.png" width="640"></div><br>  Machine learning is a subsection of artificial intelligence in which algorithms are studied that are capable of learning without direct programming of what needs to be learned.  Linear regression is a typical representative of machine learning algorithms.  To begin with, we will answer the question ‚Äúwhat does it mean to <i>study</i> at all?‚Äù.  We take the answer to this question from the <a href="http://www.cs.cmu.edu/~tom/mlbook.html">book of 1997</a> (it is worth noting that the table of contents of this book is not much different from modern books on machine learning). <br><br><blockquote>  It is said that the program is learning by experience. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.776ex" height="2.057ex" viewBox="0 -780.1 764.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-45" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> E </script>  regarding the class of tasks <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.057ex" viewBox="0 -780.1 704.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-54" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> T </script>  in terms of quality measures <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-4C" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> L </script>  if when solving a problem <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.057ex" viewBox="0 -780.1 704.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-54" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> T </script>  quality measured by measure <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-4C" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> L </script>  , increases with the demonstration of new experience <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.776ex" height="2.057ex" viewBox="0 -780.1 764.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-45" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> E </script>  . </blockquote><br>  We can distinguish the following tasks <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.057ex" viewBox="0 -780.1 704.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-54" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> T </script>  solved by machine learning: <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D1%2581_%25D1%2583%25D1%2587%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BC">learning with a teacher</a> , <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B1%25D0%25B5%25D0%25B7_%25D1%2583%25D1%2587%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258F">learning without a teacher</a> , <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D1%2581_%25D0%25BF%25D0%25BE%25D0%25B4%25D0%25BA%25D1%2580%25D0%25B5%25D0%25BF%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5%25D0%25BC">reinforcement</a> <a href="https://en.wikipedia.org/wiki/Active_learning_(machine_learning)">learning</a> , <a href="https://en.wikipedia.org/wiki/Active_learning_(machine_learning)">active learning</a> , <a href="https://en.wikipedia.org/wiki/Inductive_transfer">knowledge transfer</a> , etc.  Regression (as well as classification) belongs to the class of learning tasks with the teacher, when for a given set of features of the observed object it is necessary to predict some target variable.  As a rule, in teaching tasks with a teacher, experience <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.776ex" height="2.057ex" viewBox="0 -780.1 764.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-45" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> E </script>  represented as a set of pairs of features and target variables: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="noError" id="MJXp-Span-18" style="display: inline-block;">D&nbsp;=&nbsp;\&nbsp;left&nbsp;\&nbsp;{(x_i,&nbsp;y_i)&nbsp;\&nbsp;right&nbsp;\}&nbsp;_&nbsp;{i&nbsp;=&nbsp;1,&nbsp;\&nbsp;ldots,&nbsp;n}</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">D&nbsp;=&nbsp;\&nbsp;left&nbsp;\&nbsp;{(x_i,&nbsp;y_i)&nbsp;\&nbsp;right&nbsp;\}&nbsp;_&nbsp;{i&nbsp;=&nbsp;1,&nbsp;\&nbsp;ldots,&nbsp;n}</span></span><script type="math/tex" id="MathJax-Element-9"> D = \ left \ {(x_i, y_i) \ right \} _ {i = 1, \ ldots, n} </script>  .  In the case of linear regression, the feature description of the object is a valid vector. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mtext" id="MJXp-Span-20">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">c</span><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">x</span></span><span class="MJXp-mtext" id="MJXp-Span-26">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">n</span><span class="MJXp-mtext" id="MJXp-Span-29">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">b</span><span class="MJXp-msubsup" id="MJXp-Span-36"><span class="MJXp-mrow" id="MJXp-Span-37" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-39" style="vertical-align: 0.5em;">m</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.37ex" height="2.057ex" viewBox="0 -780.1 8339.7 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-78" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-69" x="2458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-6E" x="2803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-6D" x="3654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-61" x="4532" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="5062" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="5423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-62" x="6000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-62" x="6429" y="0"></use><g transform="translate(6859,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-6D" x="1074" y="581"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-10"> \ vec {x} \ in \ mathbb {R} ^ m </script>  , and the target variable is a scalar <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">y</span><span class="MJXp-mtext" id="MJXp-Span-42">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">n</span><span class="MJXp-mtext" id="MJXp-Span-45">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">b</span><span class="MJXp-mrow" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">R</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.722ex" height="2.419ex" viewBox="0 -780.1 5908 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-69" x="747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-6E" x="1093" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-6D" x="1943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-61" x="2822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="3351" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="3713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-62" x="4289" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-62" x="4719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-52" x="5148" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> y \ in \ mathbb {R} </script>  .  The simplest measure of quality <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-54"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-4C" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> L </script>  for the regression problem is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">L</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">y</span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-61">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">t</span><span class="MJXp-mrow" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">y</span></span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-69">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">t</span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">y</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-77">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">t</span><span class="MJXp-mrow" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">y</span></span><span class="MJXp-mtext" id="MJXp-Span-83">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">t</span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-91" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="36.03ex" height="2.901ex" viewBox="0 -935.7 15513.1 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMAIN-28" x="681" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-79" x="1071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMAIN-2C" x="1568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="2263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-61" x="2840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="3369" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-79" x="3731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMAIN-29" x="4228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMAIN-3D" x="4895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-6C" x="6202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-65" x="6500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-66" x="6967" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="7517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMAIN-28" x="7879" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-79" x="8268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMAIN-2212" x="8988" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="10239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-61" x="10815" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="11345" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-79" x="11706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-72" x="12454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-69" x="12905" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-67" x="13251" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="13731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="14308" y="0"></use><g transform="translate(14669,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMAIN-32" x="550" y="513"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-13"> L (y, \ hat {y}) = \ left (y - \ hat {y} \ right) ^ 2 </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-92"><span class="MJXp-mtext" id="MJXp-Span-93">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">t</span><span class="MJXp-mrow" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">y</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.145ex" height="2.419ex" viewBox="0 -780.1 2215 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-79" x="1717" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> \ hat {y} </script>  - this is our estimate of the real value of the target variable. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We have a task, data and a way to evaluate a program / model.  Let's define what a <i>model</i> is and what it means <i>to train a model</i> .  <i>A predictive model</i> is a parametric family of functions (a family of hypotheses): <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-99"><span class="noError" id="MJXp-Span-100" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;mathcal&nbsp;{H}&nbsp;=&nbsp;\&nbsp;left&nbsp;\&nbsp;{h&nbsp;\&nbsp;left&nbsp;(x,&nbsp;\&nbsp;theta&nbsp;\&nbsp;right)&nbsp;|&nbsp;\&nbsp;theta&nbsp;\&nbsp;in&nbsp;\&nbsp;Theta&nbsp;\&nbsp;right&nbsp;\}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;mathcal&nbsp;{H}&nbsp;=&nbsp;\&nbsp;left&nbsp;\&nbsp;{h&nbsp;\&nbsp;left&nbsp;(x,&nbsp;\&nbsp;theta&nbsp;\&nbsp;right)&nbsp;|&nbsp;\&nbsp;theta&nbsp;\&nbsp;in&nbsp;\&nbsp;Theta&nbsp;\&nbsp;right&nbsp;\}</span></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> \ Large \ mathcal {H} = \ left \ {h \ left (x, \ theta \ right) | \ theta \ in \ Theta \ right \} </script></p><br>  Where <br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">h</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">X</span><span class="MJXp-mtext" id="MJXp-Span-105">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">s</span><span class="MJXp-mtext" id="MJXp-Span-111">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">a</span><span class="MJXp-mtext" id="MJXp-Span-117">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">Y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.021ex" height="2.419ex" viewBox="0 -780.1 13786.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMAIN-3A" x="854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-58" x="1410" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-69" x="2874" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-6D" x="3220" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-65" x="4098" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-73" x="4565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-54" x="5284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="5989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-65" x="6565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="7032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-61" x="7393" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-72" x="8173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-69" x="8624" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-67" x="8970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="9450" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="10027" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-61" x="10388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-72" x="10918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-72" x="11369" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-6F" x="11821" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-77" x="12306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-59" x="13023" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> h: X \ times \ Theta \ rightarrow Y </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-129"><span class="MJXp-mtext" id="MJXp-Span-130">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.709ex" height="2.057ex" viewBox="0 -780.1 2888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-54" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-68" x="954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-65" x="1531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-74" x="1997" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-61" x="2359" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> \ Theta </script>  - many parameters </li></ul><br>  Thus, from a large family of hypotheses, we must choose some particular one, which, in terms of measure <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/322076/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjYmQ8IwirC8DzH7RrtJCiaQeT2bg#MJMATHI-4C" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> L </script>  is the best.  The process of this choice is called <i>the learning algorithm</i> : <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-138"><span class="MJXp-mtext" id="MJXp-Span-139">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">e</span><span class="MJXp-mtext" id="MJXp-Span-145">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">l</span><span class="MJXp-mrow" id="MJXp-Span-153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">M</span></span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-156">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">t</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">X</span><span class="MJXp-mtext" id="MJXp-Span-163">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">Y</span><span class="MJXp-mtext" id="MJXp-Span-170">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">t</span><span class="MJXp-msubsup" id="MJXp-Span-176"><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-178" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mtext" id="MJXp-Span-179">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">w</span><span class="MJXp-mtext" id="MJXp-Span-190">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">l</span><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">H</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-19"> \ Large \ mathcal {M}: \ left (X \ times Y \ right) ^ n \ rightarrow \ mathcal {H} </script></p><br>  It turns out that the learning algorithm is a mapping from a data set to a hypothesis space.  Usually the learning process with a teacher consists of two steps: <br><br><ol><li>  training: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">h</span><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-203">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">l</span><span class="MJXp-mrow" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">M</span></span><span class="MJXp-mtext" id="MJXp-Span-213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">t</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">D</span><span class="MJXp-mtext" id="MJXp-Span-220">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">t</span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> h = \ mathcal {M} \ left (D \ right) </script>  ; </li><li>  application: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-227"><span class="MJXp-mtext" id="MJXp-Span-228">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">t</span><span class="MJXp-mrow" id="MJXp-Span-232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">y</span></span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">h</span><span class="MJXp-mtext" id="MJXp-Span-236">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">t</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">x</span><span class="MJXp-mtext" id="MJXp-Span-243">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">t</span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> \ hat {y} = h \ left (x \ right) </script>  . </li></ol><br>  Often, models use the <i>principle of minimizing empirical risk</i> for learning.  Risk hypothesis <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> h </script>  call the expected value of the cost function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> L </script>  : <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-254"><span class="noError" id="MJXp-Span-255" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;Q&nbsp;\&nbsp;left&nbsp;(h&nbsp;\&nbsp;right)&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{E}&nbsp;_&nbsp;{x,&nbsp;y&nbsp;\&nbsp;sim&nbsp;P&nbsp;\&nbsp;left&nbsp;(x,&nbsp;y&nbsp;\&nbsp;right)}&nbsp;\&nbsp;left&nbsp;[L&nbsp;\&nbsp;left&nbsp;(h&nbsp;\&nbsp;left&nbsp;(x&nbsp;\&nbsp;right),&nbsp;y&nbsp;\&nbsp;right)&nbsp;\&nbsp;right]&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;int&nbsp;L&nbsp;\&nbsp;left&nbsp;(h&nbsp;\&nbsp;left&nbsp;(x&nbsp;\&nbsp;right),&nbsp;y&nbsp;\&nbsp;right)&nbsp;d&nbsp;P&nbsp;\&nbsp;left&nbsp;(x,&nbsp;y&nbsp;\&nbsp;right)&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-24"> \ Large \ begin {array} {rcl} Q \ left (h \ right) & = & \ text {E} _ {x, y \ sim P \ left (x, y \ right)} \ left [L \ left (h \ left (x \ right), y \ right) \ right] \\ & = & \ int L \ left (h \ left (x \ right), y \ right) d P \ left (x, y \ right) \ end {array} </script></p><br>  But, unfortunately, such an integral is not calculated, since  distribution <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">P</span><span class="MJXp-mtext" id="MJXp-Span-258">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">t</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">x</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">y</span><span class="MJXp-mtext" id="MJXp-Span-267">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">t</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> P \ left (x, y \ right) </script>  unknown, otherwise there would be no task.  But we can calculate the empirical risk estimate as the average value of the cost function: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-274"><span class="MJXp-mtext" id="MJXp-Span-275">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">e</span><span class="MJXp-msubsup" id="MJXp-Span-281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-283" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-284">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">t</span><span class="MJXp-mrow" id="MJXp-Span-289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">p</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-293">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">t</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">h</span><span class="MJXp-mtext" id="MJXp-Span-300">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">t</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-308">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">c</span><span class="MJXp-mrow" id="MJXp-Span-313"><span class="MJXp-mn" id="MJXp-Span-314">1</span></span><span class="MJXp-mrow" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">n</span></span><span class="MJXp-mtext" id="MJXp-Span-317">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">u</span><span class="MJXp-msubsup" id="MJXp-Span-320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">i</span><span class="MJXp-mo" id="MJXp-Span-324">=</span><span class="MJXp-mn" id="MJXp-Span-325">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">L</span><span class="MJXp-mtext" id="MJXp-Span-328">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">t</span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">h</span><span class="MJXp-mtext" id="MJXp-Span-335">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">t</span><span class="MJXp-mo" id="MJXp-Span-340" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-343" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-344">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">t</span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-354" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-355">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">t</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-26"> \ Large Q _ {\ text {emp}} \ left (h \ right) = \ frac {1} {n} \ sum_ {i = 1} ^ n L \ left (h \ left (x_i \ right), y_i \ right) </script></p><br>  Then, according to the principle of minimizing empirical risk, we must choose such a hypothesis <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">h</span><span class="MJXp-mtext" id="MJXp-Span-364">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">n</span><span class="MJXp-mtext" id="MJXp-Span-367">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">l</span><span class="MJXp-mrow" id="MJXp-Span-375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">H</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> h \ in \ mathcal {H} </script>  which minimizes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-381">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">t</span><span class="MJXp-mrow" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">p</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> Q _ {\ text {emp}} </script>  : <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-390"><span class="MJXp-mtext" id="MJXp-Span-391">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">e</span><span class="MJXp-mtext" id="MJXp-Span-397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">t</span><span class="MJXp-mrow" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">h</span></span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-404">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">g</span><span class="MJXp-mtext" id="MJXp-Span-408">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">i</span><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-413" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">h</span><span class="MJXp-mtext" id="MJXp-Span-415">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">n</span><span class="MJXp-mtext" id="MJXp-Span-418">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">l</span><span class="MJXp-mrow" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">H</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429" style="margin-right: 0.05em;">Q</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-430" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-431">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">t</span><span class="MJXp-mrow" id="MJXp-Span-436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">p</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-440">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">t</span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">h</span><span class="MJXp-mtext" id="MJXp-Span-447">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">t</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-29"> \ Large \ hat {h} = \ arg \ min_ {h \ in \ mathcal {H}} Q _ {\ text {emp}} \ left (h \ right) </script></p><br>  This principle has a significant drawback; solutions found in this way will be prone to <i>retraining</i> .  We say that the model has a <i>generalizing ability</i> , then, when an error on a new (test) data set (taken from the same distribution <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">P</span><span class="MJXp-mtext" id="MJXp-Span-456">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">t</span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">x</span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">y</span><span class="MJXp-mtext" id="MJXp-Span-465">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">t</span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> P \ left (x, y \ right) </script>  ) is small, or predictable.  The retrained model does not have a generalizing ability, i.e.  on the training data set, the error is small, and on the test data set, the error is much larger. <br><br><h2>  Linear regression </h2><br>  Let's limit the hypotheses space to linear functions from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">m</span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-475">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> m + 1 </script>  argument, we assume that the zero sign for all objects is equal to one <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-476"><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-479" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-481">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> x_0 = 1 </script>  : <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-482"><span class="noError" id="MJXp-Span-483" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;forall&nbsp;h&nbsp;\&nbsp;in&nbsp;\&nbsp;mathcal&nbsp;{H},&nbsp;h&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{x}&nbsp;\&nbsp;right)&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;w_0&nbsp;x_0&nbsp;+&nbsp;w_1&nbsp;x_1&nbsp;+&nbsp;w_2&nbsp;x_2&nbsp;+&nbsp;\&nbsp;cdots&nbsp;+&nbsp;w_m&nbsp;x_m&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;0}&nbsp;^&nbsp;m&nbsp;w_i&nbsp;x_i&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;vec&nbsp;{x}&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-33"> \ Large \ begin {array} {rcl} \ forall h \ in \ mathcal {H}, h \ left (\ vec {x} \ right) & = & w_0 x_0 + w_1 x_1 + w_2 x_2 + \ cdots + w_m x_m \\ & = & \ sum_ {i = 0} ^ m w_i x_i \\ & = & \ vec {x} ^ T \ vec {w} \ end {array} </script></p><br>  Empirical risk (cost function) takes the form of a root-mean-square error: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-484"><span class="noError" id="MJXp-Span-485" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;mathcal&nbsp;{L}&nbsp;\&nbsp;left&nbsp;(X,&nbsp;\&nbsp;vec&nbsp;{y},&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{2n}&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;n&nbsp;\&nbsp;left&nbsp;(y_i&nbsp;-&nbsp;\&nbsp;vec&nbsp;{x}&nbsp;_i&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;_i&nbsp;\&nbsp;right)&nbsp;^&nbsp;2&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{2n}&nbsp;\&nbsp;left&nbsp;\&nbsp;|&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;-&nbsp;X&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right&nbsp;\&nbsp;|&nbsp;_2&nbsp;^&nbsp;2&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{2n}&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{y}&nbsp;-&nbsp;X&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;^&nbsp;T&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{y}&nbsp;-&nbsp;X&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> \ Large \ begin {array} {rcl} \ mathcal {L} \ left (X, \ vec {y}, \ vec {w} \ right) & = & \ frac {1} {2n} \ sum_ {i = 1} ^ n \ left (y_i - \ vec {x} _i ^ T \ vec {w} _i \ right) ^ 2 \\ & = & \ frac {1} {2n} \ left \ | \ vec {y} - X \ vec {w} \ right \ | _2 ^ 2 \\ & = & \ frac {1} {2n} \ left (\ vec {y} - X \ vec {w} \ right) ^ T \ left (\ vec {y} - X \ vec {w} \ right) \ end {array} </script></p><br>  matrix rows <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> X </script>  - these are characteristic descriptions of observed objects.  One of the learning algorithms <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-488"><span class="MJXp-mtext" id="MJXp-Span-489">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">l</span><span class="MJXp-mrow" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">M</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> \ mathcal {M} </script>  such a model is the least squares method.  Calculate the derivative of the cost function: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-499"><span class="noError" id="MJXp-Span-500" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;\&nbsp;mathcal&nbsp;{L}}&nbsp;{\&nbsp;partial&nbsp;\&nbsp;vec&nbsp;{w}}&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial}&nbsp;{\&nbsp;partial&nbsp;\&nbsp;vec&nbsp;{w}}&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{2n}&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{y}&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;-2&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;+&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;^&nbsp;TX&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w&nbsp;}&nbsp;\&nbsp;right)&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{2n}&nbsp;\&nbsp;left&nbsp;(-2&nbsp;X&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;+&nbsp;2X&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> \ Large \ begin {array} {rcl} \ frac {\ partial \ mathcal {L}} {\ partial \ vec {w}} & = & \ frac {\ partial} {\ partial \ vec {w}} \ frac {1} {2n} \ left (\ vec {y} ^ T \ vec {y} -2 \ vec {y} ^ TX \ vec {w} + \ vec {w} ^ TX ^ TX \ vec {w } \ right) \\ & = & \ frac {1} {2n} \ left (-2 X ^ T \ vec {y} + 2X ^ TX \ vec {w} \ right) \ end {array} </script></p><br>  we equate to zero and find the solution explicitly: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-501"><span class="noError" id="MJXp-Span-502" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;\&nbsp;mathcal&nbsp;{L}}&nbsp;{\&nbsp;partial&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;=&nbsp;0&nbsp;&amp;&nbsp;\&nbsp;Leftrightarrow&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{2n}&nbsp;\&nbsp;left&nbsp;(-2&nbsp;x&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;+&nbsp;2X&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;=&nbsp;0&nbsp;\\&nbsp;&amp;&nbsp;\&nbsp;Leftrightarrow&nbsp;&amp;&nbsp;-X&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;+&nbsp;X&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;=&nbsp;0&nbsp;\\&nbsp;&amp;&nbsp;\&nbsp;Leftrightarrow&nbsp;&amp;&nbsp;X&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;=&nbsp;X&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;\\&nbsp;&amp;&nbsp;\&nbsp;Leftrightarrow&nbsp;&amp;&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;=&nbsp;\&nbsp;left&nbsp;(X&nbsp;^&nbsp;TX&nbsp;\&nbsp;right)&nbsp;^&nbsp;{-&nbsp;1}&nbsp;X&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y&nbsp;}&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> \ Large \ begin {array} {rcl} \ frac {\ partial \ mathcal {L}} {\ partial \ vec {w} = 0 & \ Leftrightarrow & \ frac {1} {2n} \ left (-2 x ^ T \ vec {y} + 2X ^ TX \ vec {w} \ right) = 0 \\ & \ Leftrightarrow & -X ^ T \ vec {y} + X ^ TX \ vec {w} = 0 \\ & \ Leftrightarrow & X ^ TX \ vec {w} = X ^ T \ vec {y} \\ & \ Leftrightarrow & \ vec {w} = \ left (X ^ TX \ right) ^ {- 1} X ^ T \ vec {y } \ end {array} </script></p><br>  Congratulations, ladies and gentlemen, we have just brought a machine learning algorithm with you.  We implement this algorithm.  Let's start with a dataset consisting of just one attribute.  We will take a random point on the sine and add noise to it ‚Äî in this way we will get the target variable;  the sign in this case will be the coordinate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> x </script>  : <br><br><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generate_wave_set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n_support=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1000</span></span></span></span><span class="hljs-function"><span class="hljs-params">, n_train=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">25</span></span></span></span><span class="hljs-function"><span class="hljs-params">, std=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.3</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> data = {} <span class="hljs-comment"><span class="hljs-comment">#        0  2*pi data['support'] = np.linspace(0, 2*np.pi, num=n_support) #     sin(x) + 1 #   ground truth data['values'] = np.sin(data['support']) + 1 #  support      ,    data['x_train'] = np.sort(np.random.choice(data['support'], size=n_train, replace=True)) #   sin(x) + 1   ,    data['y_train'] = np.sin(data['x_train']) + 1 + np.random.normal(0, std, size=data['x_train'].shape[0]) return data data = generate_wave_set(1000, 250)</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Drawing graphics</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'Shape of X is'</span></span>, data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].shape <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'Head of X is'</span></span>, data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>][:<span class="hljs-number"><span class="hljs-number">10</span></span>] margin = <span class="hljs-number"><span class="hljs-number">0.3</span></span> plt.plot(data[<span class="hljs-string"><span class="hljs-string">'support'</span></span>], data[<span class="hljs-string"><span class="hljs-string">'values'</span></span>], <span class="hljs-string"><span class="hljs-string">'b--'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, label=<span class="hljs-string"><span class="hljs-string">'manifold'</span></span>) plt.scatter(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>], data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>], <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-string"><span class="hljs-string">'g'</span></span>, <span class="hljs-string"><span class="hljs-string">'o'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.8</span></span>, label=<span class="hljs-string"><span class="hljs-string">'data'</span></span>) plt.xlim(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].max() + margin) plt.ylim(data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].max() + margin) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>, prop={<span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>}) plt.title(<span class="hljs-string"><span class="hljs-string">'True manifold and noised data'</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'x'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'y'</span></span>) plt.show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/files/e2e/f08/cee/e2ef08cee57a4320a24d39a94572f216.png"><br><br>  And now we implement the learning algorithm using the NumPy magic: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        X = np.array([np.ones(data['x_train'].shape[0]), data['x_train']]).T # ,   ,  numpy #   -        h w = np.dot(np.dot(np.linalg.inv(np.dot(XT, X)), XT), data['y_train']) #  :   y_hat = np.dot(w, XT)</span></span></code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Drawing graphics</b> <div class="spoiler_text"><pre> <code class="python hljs">margin = <span class="hljs-number"><span class="hljs-number">0.3</span></span> plt.plot(data[<span class="hljs-string"><span class="hljs-string">'support'</span></span>], data[<span class="hljs-string"><span class="hljs-string">'values'</span></span>], <span class="hljs-string"><span class="hljs-string">'b--'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, label=<span class="hljs-string"><span class="hljs-string">'manifold'</span></span>) plt.scatter(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>], data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>], <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-string"><span class="hljs-string">'g'</span></span>, <span class="hljs-string"><span class="hljs-string">'o'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.8</span></span>, label=<span class="hljs-string"><span class="hljs-string">'data'</span></span>) plt.plot(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>], y_hat, <span class="hljs-string"><span class="hljs-string">'r'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.8</span></span>, label=<span class="hljs-string"><span class="hljs-string">'fitted'</span></span>) plt.xlim(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].max() + margin) plt.ylim(data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].max() + margin) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>, prop={<span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>}) plt.title(<span class="hljs-string"><span class="hljs-string">'Fitted linear regression'</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'x'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'y'</span></span>) plt.show()</code> </pre><br></div></div><br><br><img src="https://habrastorage.org/files/685/dce/978/685dce97812345db9fceaa834f19ee23.png"><br><br>  As we can see, the line does not really coincide with this curve.  The root-mean-square error is <b>0.26704</b> conventional units.  Obviously, if instead of a line we used a third-order curve, the result would have been much better.  And, in fact, we can train non-linear models using linear regression. <br><br><h2>  Polynomial regression </h2><br>  In linear regression, we limited the hypotheses space only to linear functions of the signs.  Let us now expand the space of hypotheses to all polynomials of degree <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> p </script>  .  Then in our case, when the number of signs is equal to one <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">m</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-510">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> m = 1 </script>  , the hypothesis space will be as follows: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-511"><span class="noError" id="MJXp-Span-512" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;forall&nbsp;h&nbsp;\&nbsp;in&nbsp;\&nbsp;mathcal&nbsp;{H},&nbsp;h&nbsp;\&nbsp;left&nbsp;(x&nbsp;\&nbsp;right)&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;w_0&nbsp;+&nbsp;w_1&nbsp;x&nbsp;+&nbsp;w_1&nbsp;x&nbsp;^&nbsp;2&nbsp;+&nbsp;\&nbsp;cdots&nbsp;+&nbsp;w_n&nbsp;x&nbsp;^&nbsp;p&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;0}&nbsp;^&nbsp;p&nbsp;w_i&nbsp;x&nbsp;^&nbsp;i&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-42"> \ Large \ begin {array} {rcl} \ forall h \ in \ mathcal {H}, h \ left (x \ right) & = & w_0 + w_1 x + w_1 x ^ 2 + \ cdots + w_n x ^ p \\ & = & \ sum_ {i = 0} ^ p w_i x ^ i \ end {array} </script></p><br>  If you pre-calculate all the degrees of attributes in advance, then the problem again comes down to the algorithm described above ‚Äî the method of least squares.  Let's try to draw graphs of several polynomials of different degrees. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   p ,    degree_list = [1, 2, 3, 5, 7, 10, 13] cmap = plt.get_cmap('jet') colors = [cmap(i) for i in np.linspace(0, 1, len(degree_list))] margin = 0.3 plt.plot(data['support'], data['values'], 'b--', alpha=0.5, label='manifold') plt.scatter(data['x_train'], data['y_train'], 40, 'g', 'o', alpha=0.8, label='data') w_list = [] err = [] for ix, degree in enumerate(degree_list): #      dlist = [np.ones(data['x_train'].shape[0])] + \ map(lambda n: data['x_train']**n, range(1, degree + 1)) X = np.array(dlist).T w = np.dot(np.dot(np.linalg.inv(np.dot(XT, X)), XT), data['y_train']) w_list.append((degree, w)) y_hat = np.dot(w, XT) err.append(np.mean((data['y_train'] - y_hat)**2)) plt.plot(data['x_train'], y_hat, color=colors[ix], label='poly degree: %i' % degree)</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Drawing graphics</b> <div class="spoiler_text"><pre> <code class="python hljs">plt.xlim(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].max() + margin) plt.ylim(data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].max() + margin) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>, prop={<span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>}) plt.title(<span class="hljs-string"><span class="hljs-string">'Fitted polynomial regressions'</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'x'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'y'</span></span>) plt.show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/files/cfa/f27/384/cfaf27384fe047c5948c76c2d2ac5cbf.png"><br><br>  On the graph, we can observe two phenomena at once.  Do not pay attention to the 13th degree of the polynomial.  With an increase in the degree of the polynomial, the average error continues to decrease, although we sort of believed that it was the cubic polynomial that should best describe our data. <br><br><table><tbody><tr><th>  p </th><th>  error </th></tr><tr><td>  one </td><td>  0.26704 </td></tr><tr><td>  2 </td><td>  0.22495 </td></tr><tr><td>  3 </td><td>  0.08217 </td></tr><tr><td>  five </td><td>  0.05862 </td></tr><tr><td>  7 </td><td>  0.05749 </td></tr><tr><td>  ten </td><td>  0.0532 </td></tr><tr><td>  13 </td><td>  5.76155 </td></tr></tbody></table><br>  This is a clear sign of retraining, which can be seen by visualizing without even using a test data set: as the degree of the polynomial increases above the third, the model begins to <i>interpolate the</i> data, instead of <i>extrapolating</i> .  In other words, the graph of the function passes exactly through the points from the training data set, and the higher the degree of the polynomial, the more points it passes.  The degree of the polynomial reflects the <i>complexity of the</i> model.  Thus, complex models, in which there are a lot of degrees of freedom, can simply remember the entire training set, completely losing their generalizing ability.  This is a manifestation of the negative side of the principle of minimizing the empirical risk. <br><br>  Returning to the polynomial of the 13th degree, something is clearly wrong with him.  In theory, we expect that a 13th degree polynomial will describe the training data set even better, but the result shows that this is not the case.  From the course of linear algebra, we remember that the inverse matrix exists only for non-singular matrices, i.e.  those that do not have a linear dependence of columns or rows.  In the least squares method, we need to invert the following matrix: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-513"><span class="MJXp-mtext" id="MJXp-Span-514">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">t</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-522" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">X</span><span class="MJXp-mtext" id="MJXp-Span-524">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">t</span><span class="MJXp-msubsup" id="MJXp-Span-530"><span class="MJXp-mo" id="MJXp-Span-531" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-532" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-533">‚àí</span><span class="MJXp-mn" id="MJXp-Span-534">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> \ left (X ^ T X \ right) ^ {- 1} </script>  .  For testing linear dependence or <i>multicollinearity,</i> you can use <i><a href="https://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B8%25D1%2581%25D0%25BB%25D0%25BE_%25D0%25BE%25D0%25B1%25D1%2583%25D1%2581%25D0%25BB%25D0%25BE%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">the condition number of the matrix</a></i> .  One way to estimate this number for matrices is the ratio of the modulus of the maximum eigenvalue of the matrix to the modulus of the minimum eigenvalue.  A large number of conditionality of the matrix, or the presence of one or several eigenvalues ‚Äã‚Äãclose to zero indicates the presence of multicollinearity (or fuzzy multicollinearity, when <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-msubsup" id="MJXp-Span-536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-538" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-539">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">k</span><span class="MJXp-msubsup" id="MJXp-Span-547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-549" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-550" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> c_i \ approx k c_j + b </script>  ).  Such matrices are called weakly conditioned, and the task is incorrectly stated.  When inverting such a matrix, the solutions have large variance.  This is manifested in the fact that with a small change in the initial matrix, the inverted ones will be very different from each other.  In practice, this will emerge when you add just one to the 1000 samples, and the OLS solution will be completely different.  Let's look at the eigenvalues ‚Äã‚Äãof the resulting matrix, there is a surprise waiting for us there: <br><br><pre> <code class="python hljs">np.linalg.eigvals(np.cov(X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>:].T))</code> </pre><br><pre> <code class="hljs matlab">Out[<span class="hljs-number"><span class="hljs-number">10</span></span>]: array([ <span class="hljs-number"><span class="hljs-number">9.29965299e+17</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">4.04567033e+13</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">5.44657111e+09</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">3.54104756e+06</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">8.36745166e+03</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">6.82745279e+01</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">8.88434986e-01</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">2.42827315e-02</span></span>+<span class="hljs-number"><span class="hljs-number">0.00830052</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span>, <span class="hljs-number"><span class="hljs-number">2.42827315e-02</span></span><span class="hljs-number"><span class="hljs-number">-0.00830052</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span>, <span class="hljs-number"><span class="hljs-number">1.17621840e-03</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">1.72254789e-04</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">-5.68384880e-06</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> , <span class="hljs-number"><span class="hljs-number">2.39611454e-07</span></span>+<span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-built_in"><span class="hljs-built_in">j</span></span> ])</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/files/841/08d/82a/84108d82ab9e4955b42b68b81cf1ac05.jpg"></div><br>  All so, numpy returned two complex-valued eigenvalues, which goes against theory.  For symmetric and positive definite matrices (which is the matrix <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-552"><span class="MJXp-msubsup" id="MJXp-Span-553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-555" style="vertical-align: 0.5em;">t</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> X ^ t x </script>  ) all eigenvalues ‚Äã‚Äãmust be valid.  Perhaps this was due to the fact that when working with large numbers the matrix became slightly asymmetric, <i>but this is not exactly</i> ¬Ø \ _ () _ / ¬Ø.  If you suddenly find the reason for this behavior Numpai, please write in the comments. <br><br>  <b>UPDATE</b> (one of the members of the box named Andrei Oskin, with a nickname in the skoffer slak, without an account on the habr, prompts): <br><blockquote>  There is only one remark - it is not necessary to use the formula `(X ^ TX ^ {- 1}) X ^ T` to calculate the linear regression coefficients.  The problem with divergent values ‚Äã‚Äãis well known and in practice use `QR` or` SVD`. <br><br>  Well, that is, here is such a piece of code will give quite a decent result: <br><pre> <code class="python hljs">degree = <span class="hljs-number"><span class="hljs-number">13</span></span> dlist = [np.ones(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].shape[<span class="hljs-number"><span class="hljs-number">0</span></span>])] + \ list(map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> n: data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>]**n, range(<span class="hljs-number"><span class="hljs-number">1</span></span>, degree + <span class="hljs-number"><span class="hljs-number">1</span></span>))) X = np.array(dlist).T q, r = np.linalg.qr(X) y_hat = np.dot(np.dot(q, qT), data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>]) plt.plot(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>], y_hat, label=<span class="hljs-string"><span class="hljs-string">'poly degree: %i'</span></span> % degree)</code> </pre></blockquote><br>  Before proceeding to the next section, let's look at the amplitude of the polynomial regression parameters.  We will see that as the degree of the polynomial increases, the range of the coefficients grows almost exponentially.  Yes, they also jump in different directions. <br><br><div class="spoiler">  <b class="spoiler_title">Coefficients visualization</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ix, t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(w_list): degree, w = t fig, ax = plt.subplots() plt.bar(range(max(degree_list) + <span class="hljs-number"><span class="hljs-number">1</span></span>), np.hstack((w, [<span class="hljs-number"><span class="hljs-number">0</span></span>]*(max(degree_list) - w.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">1</span></span>))), color=colors[ix]) plt.title(<span class="hljs-string"><span class="hljs-string">'Magnitude of fitted LR parameters for poly:%i'</span></span> % degree) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'degree'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'value of w'</span></span>) ax.set_xticks(np.array(range(max(degree_list) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) ax.set_xticklabels(range(max(degree_list) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) plt.show()</code> </pre><br><img src="https://habrastorage.org/files/483/8c1/c81/4838c1c8117143388f6f66c17303c988.png"><br><img src="https://habrastorage.org/files/49b/4df/457/49b4df457cdd44c3b3a28e41fa3f2fe3.png"><br><img src="https://habrastorage.org/files/2eb/634/df4/2eb634df4b9b409c96ada009762ea0bf.png"><br><img src="https://habrastorage.org/files/53d/a95/d35/53da95d35b344c3e87a29ec98e658958.png"><br><img src="https://habrastorage.org/files/18d/5e5/34b/18d5e534b9a84b078ba9e576a6cfd344.png"><br><img src="https://habrastorage.org/files/d8e/a8c/662/d8ea8c6625f74a4fbb05b21bab81116e.png"><br><br></div></div><br><br><h2><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-557"><span class="MJXp-msubsup" id="MJXp-Span-558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-560" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> L ^ 2 </script>  Regularization </h2><br>  Regularization is a way to reduce the complexity of the model in order to prevent retraining or correct an incorrectly assigned task.  Usually this is achieved by adding some a priori information to the condition of the problem.  For example: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-561"><span class="MJXp-mtext" id="MJXp-Span-562">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">e</span><span class="MJXp-mtext" id="MJXp-Span-568">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">l</span><span class="MJXp-msubsup" id="MJXp-Span-576"><span class="MJXp-mrow" id="MJXp-Span-577" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">L</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-579" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">g</span></span></span><span class="MJXp-mtext" id="MJXp-Span-583">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">t</span><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">X</span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-591">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">c</span><span class="MJXp-mrow" id="MJXp-Span-595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">y</span></span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-598">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">c</span><span class="MJXp-mrow" id="MJXp-Span-602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">w</span></span><span class="MJXp-mtext" id="MJXp-Span-604">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">t</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-612">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">l</span><span class="MJXp-mrow" id="MJXp-Span-620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">L</span></span><span class="MJXp-mtext" id="MJXp-Span-622">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">t</span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">X</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-630">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">c</span><span class="MJXp-mrow" id="MJXp-Span-634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">y</span></span><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-637">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">c</span><span class="MJXp-mrow" id="MJXp-Span-641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">w</span></span><span class="MJXp-mtext" id="MJXp-Span-643">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">t</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-651">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">R</span><span class="MJXp-mtext" id="MJXp-Span-659">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">t</span><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-665">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">c</span><span class="MJXp-mrow" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">w</span></span><span class="MJXp-mtext" id="MJXp-Span-671">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">t</span><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-47"> \ Large \ mathcal {L} _ {reg} \ left (X, \ vec {y}, \ vec {w} \ right) = \ mathcal {L} \ left (X, \ vec {y}, \ vec {w} \ right) + \ lambda R \ left (\ vec {w} \ right) </script></p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-678"><span class="MJXp-mtext" id="MJXp-Span-679">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> \ lambda </script>  - is the coefficient of regularization, then how much we want to take into account the condition <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">R</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> R </script></li></ul><br>  On the graphs, we saw that the amplitude of the coefficient values ‚Äã‚Äãis too large, we will try to reduce it by adding a restriction to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-688"><span class="MJXp-msubsup" id="MJXp-Span-689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-691" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> L ^ 2 </script>  norm of parameter vector. <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-692"><span class="MJXp-mtext" id="MJXp-Span-693">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">R</span><span class="MJXp-mtext" id="MJXp-Span-700">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">t</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-706">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">c</span><span class="MJXp-mrow" id="MJXp-Span-710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">w</span></span><span class="MJXp-mtext" id="MJXp-Span-712">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">t</span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-720">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">c</span><span class="MJXp-mrow" id="MJXp-Span-725"><span class="MJXp-mn" id="MJXp-Span-726">1</span></span><span class="MJXp-mrow" id="MJXp-Span-727"><span class="MJXp-mn" id="MJXp-Span-728">2</span></span><span class="MJXp-mtext" id="MJXp-Span-729">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">t</span><span class="MJXp-mtext" id="MJXp-Span-734">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-735"><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-737">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">c</span><span class="MJXp-mrow" id="MJXp-Span-741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">w</span></span><span class="MJXp-mtext" id="MJXp-Span-743">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">t</span><span class="MJXp-mtext" id="MJXp-Span-749">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-750"><span class="MJXp-mrow" id="MJXp-Span-751" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-752" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-754">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-753">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-756">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">c</span><span class="MJXp-mrow" id="MJXp-Span-761"><span class="MJXp-mn" id="MJXp-Span-762">1</span></span><span class="MJXp-mrow" id="MJXp-Span-763"><span class="MJXp-mn" id="MJXp-Span-764">2</span></span><span class="MJXp-mtext" id="MJXp-Span-765">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">u</span><span class="MJXp-msubsup" id="MJXp-Span-768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">m</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">j</span><span class="MJXp-mo" id="MJXp-Span-772">=</span><span class="MJXp-mn" id="MJXp-Span-773">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-778">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-779" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-780">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">c</span><span class="MJXp-mrow" id="MJXp-Span-785"><span class="MJXp-mn" id="MJXp-Span-786">1</span></span><span class="MJXp-mrow" id="MJXp-Span-787"><span class="MJXp-mn" id="MJXp-Span-788">2</span></span><span class="MJXp-mtext" id="MJXp-Span-789">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">c</span><span class="MJXp-msubsup" id="MJXp-Span-793"><span class="MJXp-mrow" id="MJXp-Span-794" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">w</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-796" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mtext" id="MJXp-Span-797">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">c</span><span class="MJXp-mrow" id="MJXp-Span-801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">w</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-51"> \ Large R \ left (\ vec {w} \ right) = \ frac {1} {2} \ left \ | \ vec {w} \ right \ | _2 ^ 2 = \ frac {1} {2} \ sum_ {j = 1} ^ m w_j ^ 2 = \ frac {1} {2} \ vec {w} ^ T \ vec {w} </script></p><br>  The new cost function will look like this: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-803"><span class="MJXp-mtext" id="MJXp-Span-804">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">e</span><span class="MJXp-mtext" id="MJXp-Span-810">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">l</span><span class="MJXp-mrow" id="MJXp-Span-818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">L</span></span><span class="MJXp-mtext" id="MJXp-Span-820">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">t</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">X</span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-828">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">c</span><span class="MJXp-mrow" id="MJXp-Span-832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">y</span></span><span class="MJXp-mo" id="MJXp-Span-834" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-835">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">c</span><span class="MJXp-mrow" id="MJXp-Span-839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">w</span></span><span class="MJXp-mtext" id="MJXp-Span-841">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">t</span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-849">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">c</span><span class="MJXp-mrow" id="MJXp-Span-854"><span class="MJXp-mn" id="MJXp-Span-855">1</span></span><span class="MJXp-mrow" id="MJXp-Span-856"><span class="MJXp-mn" id="MJXp-Span-857">2</span></span><span class="MJXp-mtext" id="MJXp-Span-858">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">t</span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-864">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">c</span><span class="MJXp-mrow" id="MJXp-Span-868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">y</span></span><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">X</span><span class="MJXp-mtext" id="MJXp-Span-872">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">c</span><span class="MJXp-mrow" id="MJXp-Span-876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">w</span></span><span class="MJXp-mtext" id="MJXp-Span-878">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">t</span><span class="MJXp-msubsup" id="MJXp-Span-884"><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-886" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mtext" id="MJXp-Span-887">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">t</span><span class="MJXp-mo" id="MJXp-Span-892" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-893">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">c</span><span class="MJXp-mrow" id="MJXp-Span-897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">y</span></span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">X</span><span class="MJXp-mtext" id="MJXp-Span-901">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">c</span><span class="MJXp-mrow" id="MJXp-Span-905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">w</span></span><span class="MJXp-mtext" id="MJXp-Span-907">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">t</span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-915">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">c</span><span class="MJXp-mrow" id="MJXp-Span-920"><span class="MJXp-mtext" id="MJXp-Span-921">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">a</span></span><span class="MJXp-mrow" id="MJXp-Span-928"><span class="MJXp-mn" id="MJXp-Span-929">2</span></span><span class="MJXp-mtext" id="MJXp-Span-930">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">c</span><span class="MJXp-msubsup" id="MJXp-Span-934"><span class="MJXp-mrow" id="MJXp-Span-935" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">w</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-937" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mtext" id="MJXp-Span-938">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">c</span><span class="MJXp-mrow" id="MJXp-Span-942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">w</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-52"> \ Large \ mathcal {L} \ left (X, \ vec {y}, \ vec {w} \ right) = \ frac {1} {2} \ left (\ vec {y} - X \ vec {w } \ right) ^ T \ left (\ vec {y} - X \ vec {w} \ right) + \ frac {\ lambda} {2} \ vec {w} ^ T \ vec {w} </script></p><br>  Calculate the derivative of the parameters: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-944"><span class="noError" id="MJXp-Span-945" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;Large&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;\&nbsp;mathcal&nbsp;{L}}&nbsp;{\&nbsp;partial&nbsp;\&nbsp;vec&nbsp;{w}}&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial}&nbsp;{\&nbsp;partial&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;}&nbsp;\&nbsp;left&nbsp;(\&nbsp;frac&nbsp;{1}&nbsp;{2}&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{y}&nbsp;-&nbsp;X&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;^&nbsp;T&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{y}&nbsp;-&nbsp;X&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;+&nbsp;\&nbsp;frac&nbsp;{\&nbsp;lambda}&nbsp;{2}&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial}&nbsp;{\&nbsp;partial&nbsp;\&nbsp;vec&nbsp;{w}}&nbsp;\&nbsp;left&nbsp;(\&nbsp;frac&nbsp;{1}&nbsp;{2}&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{y}&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;-2&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;+&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;^&nbsp;TX&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;+&nbsp;\&nbsp;frac&nbsp;{\&nbsp;lambda}&nbsp;{2}&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;right)&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;-X&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;+&nbsp;X&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w&nbsp;}&nbsp;+&nbsp;\&nbsp;lambda&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-53"> \ Large \ begin {array} {rcl} \ Large \ frac {\ partial \ mathcal {L}} {\ partial \ vec {w}} & = & \ frac {\ partial} {\ partial \ vec {w} } \ left (\ frac {1} {2} \ left (\ vec {y} - X \ vec {w} \ right) ^ T \ left (\ vec {y} - X \ vec {w} \ right) + \ frac {\ lambda} {2} \ vec {w} ^ T \ vec {w} \ right) \\ & = & \ frac {\ partial} {\ partial \ vec {w}} \ left (\ frac {1} {2} \ left (\ vec {y} ^ T \ vec {y} -2 \ vec {y} ^ TX \ vec {w} + \ vec {w} ^ TX ^ TX \ vec {w} \ right) + \ frac {\ lambda} {2} \ vec {w} ^ T \ vec {w} \ right) \\ & = & -X ^ T \ vec {y} + X ^ TX \ vec {w } + \ lambda \ vec {w} \ end {array} </script></p><br>  And we will find a solution in explicit form: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-946"><span class="noError" id="MJXp-Span-947" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;\&nbsp;mathcal&nbsp;{L}}&nbsp;{\&nbsp;partial&nbsp;\&nbsp;vec&nbsp;{w}}&nbsp;=&nbsp;0&nbsp;&amp;&nbsp;\&nbsp;Leftrightarrow&nbsp;&amp;&nbsp;-X&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;+&nbsp;X&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;+&nbsp;\&nbsp;lambda&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;=&nbsp;0&nbsp;\\&nbsp;&amp;&nbsp;\&nbsp;Leftrightarrow&nbsp;&amp;&nbsp;X&nbsp;^&nbsp;TX&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;+&nbsp;\&nbsp;lambda&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;=&nbsp;X&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;\\&nbsp;&amp;&nbsp;\&nbsp;Leftrightarrow&nbsp;&amp;&nbsp;\&nbsp;left&nbsp;(X&nbsp;^&nbsp;TX&nbsp;+&nbsp;\&nbsp;lambda&nbsp;E&nbsp;\&nbsp;right)&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;=&nbsp;X&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;\\&nbsp;&amp;&nbsp;\&nbsp;Leftrightarrow&nbsp;&amp;&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;=&nbsp;\&nbsp;left&nbsp;(X&nbsp;^&nbsp;TX&nbsp;+&nbsp;\&nbsp;lambda&nbsp;E&nbsp;\&nbsp;right)&nbsp;^&nbsp;{-&nbsp;1}&nbsp;X&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{y}&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-54"> \ Large \ begin {array} {rcl} \ frac {\ partial \ mathcal {L}} {\ partial \ vec {w}} = 0 & \ Leftrightarrow & -X ^ T \ vec {y} + X ^ TX \ vec {w} + \ lambda \ vec {w} = 0 \\ & \ Leftrightarrow & X ^ TX \ vec {w} + \ lambda \ vec {w} = X ^ T \ vec {y} \\ & \ Leftrightarrow & \ left (X ^ TX + \ lambda E \ right) \ vec {w} = X ^ T \ vec {y} \\ & \ Leftrightarrow & \ vec {w} = \ left (X ^ TX + \ lambda E \ right) ^ {- 1} X ^ T \ vec {y} \ end {array} </script></p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">E</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> E </script>  - the unit diagonal matrix </li></ul><br>  This regression is called ridge regression.  And the crest is just the diagonal matrix which we add to the matrix <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-950"><span class="MJXp-msubsup" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-953" style="vertical-align: 0.5em;">t</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> X ^ t x </script>  with linearly dependent columns, the resulting matrix is ‚Äã‚Äãnot singular. <br><br><img src="https://habrastorage.org/files/452/f36/c79/452f36c79d7843109993de219dde7cd5.png"><br><br>  For such a matrix, the condition number will be: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-955"><span class="MJXp-mtext" id="MJXp-Span-956">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">c</span><span class="MJXp-mrow" id="MJXp-Span-961"><span class="MJXp-msubsup" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963" style="margin-right: 0.05em;">e</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-964" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">t</span><span class="MJXp-mrow" id="MJXp-Span-969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">x</span></span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-974">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">a</span></span><span class="MJXp-mrow" id="MJXp-Span-981"><span class="MJXp-msubsup" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983" style="margin-right: 0.05em;">e</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-984" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">t</span><span class="MJXp-mrow" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">n</span></span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-994">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">a</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ frac {e_ \ text {max} + \ lambda} {e_ \ text {min} + \ lambda} </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1001"><span class="MJXp-msubsup" id="MJXp-Span-1002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1004" style="vertical-align: -0.4em;">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> e_x </script>  - This is the eigenvalue of the matrix.  Thus, by increasing the regularization parameter, we decrease the number of conditionality, and the conditionality of the problem improves. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># define regularization parameter lmbd = 0.1 degree_list = [1, 2, 3, 10, 12, 13] cmap = plt.get_cmap('jet') colors = [cmap(i) for i in np.linspace(0, 1, len(degree_list))] margin = 0.3 plt.plot(data['support'], data['values'], 'b--', alpha=0.5, label='manifold') plt.scatter(data['x_train'], data['y_train'], 40, 'g', 'o', alpha=0.8, label='data') w_list_l2 = [] err = [] for ix, degree in enumerate(degree_list): dlist = [[1]*data['x_train'].shape[0]] + map(lambda n: data['x_train']**n, range(1, degree + 1)) X = np.array(dlist).T w = np.dot(np.dot(np.linalg.inv(np.dot(XT, X) + lmbd*np.eye(X.shape[1])), XT), data['y_train']) w_list_l2.append((degree, w)) y_hat = np.dot(w, XT) plt.plot(data['x_train'], y_hat, color=colors[ix], label='poly degree: %i' % degree) err.append(np.mean((data['y_train'] - y_hat)**2))</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Drawing graphics</b> <div class="spoiler_text"><pre> <code class="python hljs">plt.xlim(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].max() + margin) plt.ylim(data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].max() + margin) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>, prop={<span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>}) plt.title(<span class="hljs-string"><span class="hljs-string">'Fitted polynomial regressions with L2 reg'</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'x'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'y'</span></span>) plt.show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/files/ed9/1d8/040/ed91d804084046b9aa8f57fd3941f863.png"><br><br><table><tbody><tr><th>  p </th><th>  error </th></tr><tr><td>  one </td><td>  0.26748 </td></tr><tr><td>  2 </td><td>  0.22546 </td></tr><tr><td>  3 </td><td>  0.08803 </td></tr><tr><td>  ten </td><td>  0.05833 </td></tr><tr><td>  12 </td><td>  0.05585 </td></tr><tr><td>  13 </td><td>  0.05638 </td></tr></tbody></table><br>  As a result, even the 13th degree behaves as we expect.  The plots smoothed a bit, although we still see a slight retraining at degrees higher than the third, which is reflected in the interpolation of the data on the right side of the graph. <br><br><div class="spoiler">  <b class="spoiler_title">Coefficients visualization</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ix, t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(w_list_l2): degree, w = t fig, ax = plt.subplots() plt.bar(range(max(degree_list) + <span class="hljs-number"><span class="hljs-number">1</span></span>), np.hstack((w, [<span class="hljs-number"><span class="hljs-number">0</span></span>]*(max(degree_list) - w.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">1</span></span>))), color=colors[ix]) plt.title(<span class="hljs-string"><span class="hljs-string">'Magnitude of fitted LR parameters for poly:%i with L2 reg'</span></span> % degree) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'degree'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'value of w'</span></span>) ax.set_xticks(np.array(range(max(degree_list) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) ax.set_xticklabels(range(max(degree_list) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) plt.show()</code> </pre><br><img src="https://habrastorage.org/files/f9a/54f/e97/f9a54fe97ae14013bc7edc5fd0eb098e.png"><br><img src="https://habrastorage.org/files/849/23c/8e3/84923c8e364a4cc689031b2239aa1169.png"><br><img src="https://habrastorage.org/files/61f/ec4/119/61fec4119a3640a795877e36a4e15ee9.png"><br><img src="https://habrastorage.org/files/283/3e1/875/2833e18756f14932afa33a6b74b33891.png"><br><img src="https://habrastorage.org/files/249/915/60e/24991560e7674cd7835569f5145d1ecd.png"><br><img src="https://habrastorage.org/files/c35/947/6d8/c359476d88354ce59d0281e1b1103175.png"><br></div></div><br>  The amplitude of the coefficients also changed, although they did not stop jumping in different directions.  We remember that a third degree polynomial should best describe our data, we would like to see that as a result of regularization, all coefficients with polynomial signs of a degree higher than the third would be zero.  And it turns out that there is such a regularizer. <br><br><h2><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1005"><span class="MJXp-msubsup" id="MJXp-Span-1006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1008" style="vertical-align: 0.5em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> L ^ 1 </script>  regularization </h2><br>  Let us now try to limit the vector of model parameters using <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1009"><span class="MJXp-msubsup" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1012" style="vertical-align: 0.5em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> L ^ 1 </script>  rate: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1013"><span class="MJXp-mtext" id="MJXp-Span-1014">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">R</span><span class="MJXp-mtext" id="MJXp-Span-1021">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">t</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1027">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">c</span><span class="MJXp-mrow" id="MJXp-Span-1031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">w</span></span><span class="MJXp-mtext" id="MJXp-Span-1033">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">t</span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1041">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">t</span><span class="MJXp-mtext" id="MJXp-Span-1046">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1047"><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1049">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">c</span><span class="MJXp-mrow" id="MJXp-Span-1053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">w</span></span><span class="MJXp-mtext" id="MJXp-Span-1055">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">t</span><span class="MJXp-mtext" id="MJXp-Span-1061">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1062"><span class="MJXp-mrow" id="MJXp-Span-1063" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1064" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1065" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1067">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">u</span><span class="MJXp-msubsup" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">m</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1072"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">j</span><span class="MJXp-mo" id="MJXp-Span-1074">=</span><span class="MJXp-mn" id="MJXp-Span-1075">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1077">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">t</span><span class="MJXp-mrow" id="MJXp-Span-1082"><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1086" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-1087">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">t</span><span class="MJXp-mrow" id="MJXp-Span-1093"><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-61"> \ Large R \ left (\ vec {w} \ right) = \ left \ | \ vec {w} \ right \ | _1 = \ sum_ {j = 1} ^ m \ left | w_j \ right | </script></p><br>  Then the task will look like: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1095"><span class="MJXp-mtext" id="MJXp-Span-1096">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">e</span><span class="MJXp-mtext" id="MJXp-Span-1102">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">l</span><span class="MJXp-mrow" id="MJXp-Span-1110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">L</span></span><span class="MJXp-mtext" id="MJXp-Span-1112">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">t</span><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">X</span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1120">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">c</span><span class="MJXp-mrow" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">y</span></span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">c</span><span class="MJXp-mrow" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">w</span></span><span class="MJXp-mtext" id="MJXp-Span-1133">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">t</span><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1140" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">c</span><span class="MJXp-mrow" id="MJXp-Span-1146"><span class="MJXp-mn" id="MJXp-Span-1147">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1148"><span class="MJXp-mn" id="MJXp-Span-1149">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">n</span></span><span class="MJXp-mtext" id="MJXp-Span-1151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">u</span><span class="MJXp-msubsup" id="MJXp-Span-1154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">i</span><span class="MJXp-mo" id="MJXp-Span-1158">=</span><span class="MJXp-mn" id="MJXp-Span-1159">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1161">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">t</span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">c</span><span class="MJXp-msubsup" id="MJXp-Span-1171"><span class="MJXp-mrow" id="MJXp-Span-1172" style="margin-right: 0.05em;"><span class="MJXp-msubsup" id="MJXp-Span-1173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1175" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1176" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mtext" id="MJXp-Span-1177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">c</span><span class="MJXp-mrow" id="MJXp-Span-1181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">w</span></span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1186" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-1187">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">t</span><span class="MJXp-msubsup" id="MJXp-Span-1193"><span class="MJXp-mo" id="MJXp-Span-1194" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1195" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1196" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1197">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">a</span><span class="MJXp-mtext" id="MJXp-Span-1204">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">u</span><span class="MJXp-msubsup" id="MJXp-Span-1207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">m</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">j</span><span class="MJXp-mo" id="MJXp-Span-1211">=</span><span class="MJXp-mn" id="MJXp-Span-1212">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1214">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">t</span><span class="MJXp-mrow" id="MJXp-Span-1219"><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1223" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-1224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">t</span><span class="MJXp-mrow" id="MJXp-Span-1230"><span class="MJXp-mo" id="MJXp-Span-1231" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-62"> \ Large \ mathcal {L} \ left (X, \ vec {y}, \ vec {w} \ right) = \ frac {1} {2n} \ sum_ {i = 1} ^ n \ left (\ vec {x_i} ^ T \ vec {w} - y_i \ right) ^ 2 + \ lambda \ sum_ {j = 1} ^ m \ left | w_j \ right | </script></p><br>  We calculate the derivative with respect to the model parameters (I hope the distinguished gentlemen will not kick me, because I vzhuh and took the derivative modulo): <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1232"><span class="MJXp-mtext" id="MJXp-Span-1233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">e</span><span class="MJXp-mtext" id="MJXp-Span-1239">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">c</span><span class="MJXp-mrow" id="MJXp-Span-1244"><span class="MJXp-mtext" id="MJXp-Span-1245">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">l</span><span class="MJXp-mtext" id="MJXp-Span-1253">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">l</span><span class="MJXp-mrow" id="MJXp-Span-1261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">L</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1263"><span class="MJXp-mtext" id="MJXp-Span-1264">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">l</span><span class="MJXp-msubsup" id="MJXp-Span-1272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1274" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1276">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">c</span><span class="MJXp-mrow" id="MJXp-Span-1281"><span class="MJXp-mn" id="MJXp-Span-1282">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">n</span></span><span class="MJXp-mtext" id="MJXp-Span-1285">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">u</span><span class="MJXp-msubsup" id="MJXp-Span-1288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">i</span><span class="MJXp-mo" id="MJXp-Span-1292">=</span><span class="MJXp-mn" id="MJXp-Span-1293">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1295">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">t</span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">c</span><span class="MJXp-msubsup" id="MJXp-Span-1305"><span class="MJXp-mrow" id="MJXp-Span-1306" style="margin-right: 0.05em;"><span class="MJXp-msubsup" id="MJXp-Span-1307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1309" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1310" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mtext" id="MJXp-Span-1311">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">c</span><span class="MJXp-mrow" id="MJXp-Span-1315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">w</span></span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1320" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-1321">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">t</span><span class="MJXp-mo" id="MJXp-Span-1327" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1328">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">c</span><span class="MJXp-mrow" id="MJXp-Span-1332"><span class="MJXp-msubsup" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1335" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1337">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">a</span><span class="MJXp-mtext" id="MJXp-Span-1344">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">t</span><span class="MJXp-mrow" id="MJXp-Span-1349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">n</span></span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1357" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1358" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-63"> \ Large \ frac {\ partial \ mathcal {L}} {\ partial w_j} = \ frac {1} {n} \ sum_ {i = 1} ^ n \ left (\ vec {x_i} ^ T \ vec { w} - y_i \ right) \ vec {x_i} + \ lambda \ text {sign} (w_j) </script></p><br>  Unfortunately, this problem has no solution in an explicit form.  To find a good approximate solution, we will use the <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D1%2580%25D0%25B0%25D0%25B4%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25BD%25D1%258B%25D0%25B9_%25D1%2581%25D0%25BF%25D1%2583%25D1%2581%25D0%25BA">gradient descent</a> method, then the formula for updating the weights will take the form: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1359"><span class="MJXp-mtext" id="MJXp-Span-1360">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">e</span><span class="MJXp-mtext" id="MJXp-Span-1366">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">c</span><span class="MJXp-msubsup" id="MJXp-Span-1370"><span class="MJXp-mrow" id="MJXp-Span-1371" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">w</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1373" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1374">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">t</span><span class="MJXp-mrow" id="MJXp-Span-1379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">w</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1383" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-mtext" id="MJXp-Span-1384">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">c</span><span class="MJXp-mrow" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">w</span></span><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1391">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">a</span><span class="MJXp-mtext" id="MJXp-Span-1397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">c</span><span class="MJXp-mrow" id="MJXp-Span-1402"><span class="MJXp-mtext" id="MJXp-Span-1403">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">l</span><span class="MJXp-mtext" id="MJXp-Span-1411">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">l</span><span class="MJXp-mrow" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">L</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1421"><span class="MJXp-mtext" id="MJXp-Span-1422">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">l</span><span class="MJXp-mtext" id="MJXp-Span-1430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">c</span><span class="MJXp-mrow" id="MJXp-Span-1434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">w</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-64"> \ Large \ vec {w} _ {\ text {new}}: = \ vec {w} - \ alpha \ frac {\ partial \ mathcal {L}} {\ partial \ vec {w}} </script></p><br>  and one more hyper parameter appears in the task <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1436"><span class="MJXp-mtext" id="MJXp-Span-1437">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> \ alpha </script>  responsible for the speed of descent, it is called learning rate (learning rate) in machine learning. <br>  To program such an algorithm is not difficult, but we are waiting for another surprise: <br><br><pre> <code class="python hljs">lmbd = <span class="hljs-number"><span class="hljs-number">1</span></span> degree = <span class="hljs-number"><span class="hljs-number">13</span></span> dlist = [[<span class="hljs-number"><span class="hljs-number">1</span></span>]*data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].shape[<span class="hljs-number"><span class="hljs-number">0</span></span>]] + map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> n: data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>]**n, range(<span class="hljs-number"><span class="hljs-number">1</span></span>, degree + <span class="hljs-number"><span class="hljs-number">1</span></span>)) X = np.array(dlist).T <span class="hljs-comment"><span class="hljs-comment">#      def mse(u, v): return ((u - v)**2).sum()/u.shape[0] #   w = np.array([-1.0] * X.shape[1]) #    n_iter = 20 #     ,    lr = 0.00000001 loss = [] for ix in range(n_iter): w -= lr*(np.dot(np.dot(X, w) - data['y_train'], X)/X.shape[0] + lmbd*np.sign(w)) y_hat = np.dot(X, w) loss.append(mse(data['y_train'], y_hat)) print loss[-1]</span></span></code> </pre><br>  We get this error evolution: <br><br><pre> <code class="hljs css">1<span class="hljs-selector-class"><span class="hljs-selector-class">.3051230958e</span></span>+38 1<span class="hljs-selector-class"><span class="hljs-selector-class">.21979102398e</span></span>+58 1<span class="hljs-selector-class"><span class="hljs-selector-class">.14003816725e</span></span>+78 1<span class="hljs-selector-class"><span class="hljs-selector-class">.06549974318e</span></span>+98 9<span class="hljs-selector-class"><span class="hljs-selector-class">.95834819687e</span></span>+117 9<span class="hljs-selector-class"><span class="hljs-selector-class">.30724755635e</span></span>+137 8<span class="hljs-selector-class"><span class="hljs-selector-class">.69871743413e</span></span>+157 8<span class="hljs-selector-class"><span class="hljs-selector-class">.12997446782e</span></span>+177 7<span class="hljs-selector-class"><span class="hljs-selector-class">.59841727794e</span></span>+197 7<span class="hljs-selector-class"><span class="hljs-selector-class">.10161456943e</span></span>+217 6<span class="hljs-selector-class"><span class="hljs-selector-class">.63729401109e</span></span>+237 6<span class="hljs-selector-class"><span class="hljs-selector-class">.20333184222e</span></span>+257 5<span class="hljs-selector-class"><span class="hljs-selector-class">.79774315864e</span></span>+277 5<span class="hljs-selector-class"><span class="hljs-selector-class">.41867283397e</span></span>+297 <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">inf</span></span></code> </pre><br>  Even with such a small learning rate, the error still grows and very rapidly.  The reason is that each sign is measured at different scales, from small numbers in polynomial features of 1-2 degrees, to huge ones at 12-13 degrees.  In order for the iterative process to converge, it is necessary either to choose an extremely small learning rate or to normalize the signs in some way.  Apply the following transformation to the signs and try to start the process again: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1443"><span class="noError" id="MJXp-Span-1444" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;overline&nbsp;{\&nbsp;mu}&nbsp;_&nbsp;{\&nbsp;cdot&nbsp;j}&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{n}&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;n&nbsp;x_&nbsp;{ij}&nbsp;\\&nbsp;\&nbsp;overline&nbsp;{\&nbsp;sigma}&nbsp;_&nbsp;{\&nbsp;cdot&nbsp;j}&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;sqrt&nbsp;{\&nbsp;frac&nbsp;{1}&nbsp;{n}&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;n&nbsp;\&nbsp;left&nbsp;(x_&nbsp;{ij}&nbsp;-&nbsp;\&nbsp;overline&nbsp;{\&nbsp;mu}&nbsp;_&nbsp;{&nbsp;\&nbsp;cdot&nbsp;j}&nbsp;\&nbsp;right)&nbsp;^&nbsp;2}&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-66"> \ Large \ begin {array} {rcl} \ overline {\ mu} _ {\ cdot j} & = & \ frac {1} {n} \ sum_ {i = 1} ^ n x_ {ij} \\ \ overline {\ sigma} _ {\ cdot j} & = & \ sqrt {\ frac {1} {n} \ sum_ {i = 1} ^ n \ left (x_ {ij} - \ overline {\ mu} _ { \ cdot j} \ right) ^ 2} \ end {array} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1445"><span class="MJXp-mtext" id="MJXp-Span-1446">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">e</span><span class="MJXp-mtext" id="MJXp-Span-1452">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">c</span><span class="MJXp-msubsup" id="MJXp-Span-1456"><span class="MJXp-mrow" id="MJXp-Span-1457" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">x</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1459" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1460">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">t</span><span class="MJXp-mrow" id="MJXp-Span-1465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">w</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1470">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">c</span><span class="MJXp-mrow" id="MJXp-Span-1475"><span class="MJXp-mtext" id="MJXp-Span-1476">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">c</span><span class="MJXp-mrow" id="MJXp-Span-1480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">x</span></span><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1483">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">e</span><span class="MJXp-mrow" id="MJXp-Span-1492"><span class="MJXp-mtext" id="MJXp-Span-1493">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">u</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1496"><span class="MJXp-mtext" id="MJXp-Span-1497">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">e</span><span class="MJXp-mrow" id="MJXp-Span-1506"><span class="MJXp-mtext" id="MJXp-Span-1507">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">a</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-67"> \ Large \ vec {x} _ {\ text {new}} = \ frac {\ vec {x} - \ overline {\ mu}} {\ overline {\ sigma}} </script></p><br><br>  Such a transformation is called standardization, the distribution of each attribute now has a zero expectation and unit variance. <br><br><pre> <code class="python hljs">lmbd = <span class="hljs-number"><span class="hljs-number">1</span></span> degree = <span class="hljs-number"><span class="hljs-number">13</span></span> dlist = [[<span class="hljs-number"><span class="hljs-number">1</span></span>]*data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].shape[<span class="hljs-number"><span class="hljs-number">0</span></span>]] + map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> n: data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>]**n, range(<span class="hljs-number"><span class="hljs-number">1</span></span>, degree + <span class="hljs-number"><span class="hljs-number">1</span></span>)) X = np.array(dlist).T <span class="hljs-comment"><span class="hljs-comment">#      x_mean = X.mean(axis=0) #      x_std = X.std(axis=0) #   X = (X - x_mean)/x_std X[:, 0] = 1.0 w = np.array([-1.0] * X.shape[1]) n_iter = 100 lr = 0.1 loss = [] for ix in range(n_iter): w -= lr*(np.dot(np.dot(X, w) - data['y_train'], X)/X.shape[0] + lmbd*np.sign(w)) y_hat = np.dot(X, w) loss.append(mse(data['y_train'], y_hat)) plt.plot(loss) plt.title('Train error') plt.xlabel('Iteration') plt.ylabel('MSE') plt.show()</span></span></code> </pre><br>  Everything has become much better. <br><img src="https://habrastorage.org/files/9e7/ec4/164/9e7ec41641d74a9dbcb696eeb60c1ec2.png"><br><br>  Now draw all the graphics: <br><br><pre> <code class="python hljs">degree_list = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>] cmap = plt.get_cmap(<span class="hljs-string"><span class="hljs-string">'jet'</span></span>) colors = [cmap(i) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> np.linspace(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, len(degree_list))] margin = <span class="hljs-number"><span class="hljs-number">0.3</span></span> plt.plot(data[<span class="hljs-string"><span class="hljs-string">'support'</span></span>], data[<span class="hljs-string"><span class="hljs-string">'values'</span></span>], <span class="hljs-string"><span class="hljs-string">'b--'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, label=<span class="hljs-string"><span class="hljs-string">'manifold'</span></span>) plt.scatter(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>], data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>], <span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-string"><span class="hljs-string">'g'</span></span>, <span class="hljs-string"><span class="hljs-string">'o'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.8</span></span>, label=<span class="hljs-string"><span class="hljs-string">'data'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(u, v)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((u - v)**<span class="hljs-number"><span class="hljs-number">2</span></span>).sum()/u.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fit_lr_l1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(X, y, lmbd, n_iter=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">100</span></span></span></span><span class="hljs-function"><span class="hljs-params">, lr=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> w = np.array([<span class="hljs-number"><span class="hljs-number">-1.0</span></span>] * X.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>]) loss = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ix_iter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(n_iter): w -= lr*(np.dot(np.dot(X, w) - y, X)/X.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] +lmbd*np.sign(w)) y_hat = np.dot(X, w) loss.append(mse(y, y_hat)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> w, y_hat, loss w_list_l1 = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ix, degree <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(degree_list): dlist = [[<span class="hljs-number"><span class="hljs-number">1</span></span>]*data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].shape[<span class="hljs-number"><span class="hljs-number">0</span></span>]] + map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> n: data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>]**n, range(<span class="hljs-number"><span class="hljs-number">1</span></span>, degree + <span class="hljs-number"><span class="hljs-number">1</span></span>)) X = np.array(dlist).T x_mean = X.mean(axis=<span class="hljs-number"><span class="hljs-number">0</span></span>) x_std = X.std(axis=<span class="hljs-number"><span class="hljs-number">0</span></span>) X = (X - x_mean)/x_std X[:, <span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">1.0</span></span> w, y_hat, loss = fit_lr_l1(X, data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>], lmbd=<span class="hljs-number"><span class="hljs-number">0.05</span></span>) w_list_l1.append((degree, w)) plt.plot(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>], y_hat, color=colors[ix], label=<span class="hljs-string"><span class="hljs-string">'poly degree: %i'</span></span> % degree)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Drawing graphics</b> <div class="spoiler_text"><pre> <code class="python hljs">plt.xlim(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].max() + margin) plt.ylim(data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].min() - margin, data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>].max() + margin) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>, prop={<span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>}) plt.title(<span class="hljs-string"><span class="hljs-string">'Fitted polynomial regressions with L1 reg'</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'x'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'y'</span></span>) plt.show()</code> </pre><br></div></div><br><img src="https://habrastorage.org/files/bf0/025/160/bf0025160260474db10907412587d5a4.png"><br><table><tbody><tr><th>  p </th><th>  error </th></tr><tr><td>  one </td><td>  0.27204 </td></tr><tr><td>  2 </td><td>  0.23794 </td></tr><tr><td>  3 </td><td>  0.24118 </td></tr><tr><td>  ten </td><td>  0.18083 </td></tr><tr><td>  12 </td><td>  0.16069 </td></tr><tr><td>  13 </td><td>  0.15425 </td></tr></tbody></table><br>  If you look at the coefficients, we will see that most of them are close to zero (the fact that the 13th degree does not have a zero coefficient can be attributed to noise and a small number of examples in the training set; it is also worth remembering that now all signs are measured in the same scales). <br><br><div class="spoiler">  <b class="spoiler_title">Coefficients visualization</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ix, t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(w_list_l1): degree, w = t fig, ax = plt.subplots() plt.bar(range(max(degree_list) + <span class="hljs-number"><span class="hljs-number">1</span></span>), np.hstack((w, [<span class="hljs-number"><span class="hljs-number">0</span></span>]*(max(degree_list) - w.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">1</span></span>))), color=colors[ix]) plt.title(<span class="hljs-string"><span class="hljs-string">'Magnitude of fitted LR parameters for poly:%i with L1 reg'</span></span> % degree) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'degree'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'value of w'</span></span>) ax.set_xticks(np.array(range(max(degree_list) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) + <span class="hljs-number"><span class="hljs-number">0.5</span></span>) ax.set_xticklabels(range(max(degree_list) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) plt.show()</code> </pre><br><img src="https://habrastorage.org/files/3e6/b59/34a/3e6b5934a30147e1ae806a6038d2c6c3.png"><br><img src="https://habrastorage.org/files/88d/fb7/69d/88dfb769d6b74cd5886d10814d18fb2a.png"><br><img src="https://habrastorage.org/files/0ba/dab/7b5/0badab7b508847be8e7582d9cbc76c5d.png"><br><img src="https://habrastorage.org/files/062/794/9d0/0627949d030446919641ced2e0e97904.png"><br><img src="https://habrastorage.org/files/4ee/d04/88b/4eed0488bef44b90aa77b6a6d45485e3.png"><br><img src="https://habrastorage.org/files/5bd/f37/6ff/5bdf376ffb5647ff9bea5b222957f6ea.png"><br></div></div><br>  The described method of constructing a regression is called LASSO regression.  I would very much like to think that the uncle on a horse throws the rope and steals the coefficients, and zero remains in their place.  But no, LASSO = least absolute shrinkage and selection operator. <br><br><h2>  Bayesian interpretation of linear regression </h2><br>  The two regularizations described above, and the linear regression itself with a quadratic error function, can seem like some dirty empirical tricks.  But it turns out that if you look at this model from a different point of view, from the point of view of Bayesian statistics, everything becomes in places.  Dirty empirical tricks will become a priori assumptions.  At the heart of Bayesian statistics is the Bayes formula: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1513"><span class="MJXp-mtext" id="MJXp-Span-1514">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">e</span><span class="MJXp-mtext" id="MJXp-Span-1520">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">r</span><span class="MJXp-mrow" id="MJXp-Span-1526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">n</span></span><span class="MJXp-mrow" id="MJXp-Span-1532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">p</span><span class="MJXp-mtext" id="MJXp-Span-1534">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">t</span><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">y</span><span class="MJXp-mtext" id="MJXp-Span-1541">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">x</span><span class="MJXp-mtext" id="MJXp-Span-1546">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">t</span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1554">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">c</span><span class="MJXp-mrow" id="MJXp-Span-1560"><span class="MJXp-mtext" id="MJXp-Span-1561">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">r</span><span class="MJXp-mrow" id="MJXp-Span-1567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">e</span></span><span class="MJXp-mrow" id="MJXp-Span-1574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">p</span><span class="MJXp-mtext" id="MJXp-Span-1576">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">t</span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">x</span><span class="MJXp-mtext" id="MJXp-Span-1583">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">y</span><span class="MJXp-mtext" id="MJXp-Span-1588">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">t</span><span class="MJXp-mo" id="MJXp-Span-1594" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-1595">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">r</span><span class="MJXp-mrow" id="MJXp-Span-1601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">e</span></span><span class="MJXp-mrow" id="MJXp-Span-1606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">p</span><span class="MJXp-mtext" id="MJXp-Span-1608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">t</span><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">y</span><span class="MJXp-mtext" id="MJXp-Span-1615">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">t</span><span class="MJXp-mo" id="MJXp-Span-1621" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1622"><span class="MJXp-mtext" id="MJXp-Span-1623">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">r</span><span class="MJXp-mrow" id="MJXp-Span-1629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">d</span></span><span class="MJXp-mrow" id="MJXp-Span-1633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">p</span><span class="MJXp-mtext" id="MJXp-Span-1635">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">t</span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">x</span><span class="MJXp-mtext" id="MJXp-Span-1642">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">t</span><span class="MJXp-mo" id="MJXp-Span-1648" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-68"> \ Large \ color {green} {p \ left (y \ mid x \ right)} = \ dfrac {\ color {orange} {p \ left (x \ mid y \ right)} \ color {blue} {p \ left (y \ right)}} {\ color {red} {p \ left (x \ right)}} </script></p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1649"><span class="MJXp-mtext" id="MJXp-Span-1650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">r</span><span class="MJXp-mrow" id="MJXp-Span-1656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">e</span></span><span class="MJXp-mrow" id="MJXp-Span-1661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">p</span><span class="MJXp-mtext" id="MJXp-Span-1663">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">t</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">y</span><span class="MJXp-mtext" id="MJXp-Span-1670">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">t</span><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> \ color {blue} {p \ left (y \ right)} </script>  - a priori expectations (prior): how plausible is the hypothesis before observing the data; </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1677"><span class="MJXp-mtext" id="MJXp-Span-1678">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">r</span><span class="MJXp-mrow" id="MJXp-Span-1684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">e</span></span><span class="MJXp-mrow" id="MJXp-Span-1691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">p</span><span class="MJXp-mtext" id="MJXp-Span-1693">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">t</span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">x</span><span class="MJXp-mtext" id="MJXp-Span-1700">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1704">y</span><span class="MJXp-mtext" id="MJXp-Span-1705">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">t</span><span class="MJXp-mo" id="MJXp-Span-1711" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> \ color {orange} {p \ left (x \ mid y \ right)} </script>  - likelihood: how plausible is the data, provided that the hypothesis is correct; </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1712"><span class="MJXp-mtext" id="MJXp-Span-1713">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">r</span><span class="MJXp-mrow" id="MJXp-Span-1719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">d</span></span><span class="MJXp-mrow" id="MJXp-Span-1723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">p</span><span class="MJXp-mtext" id="MJXp-Span-1725">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">t</span><span class="MJXp-mo" id="MJXp-Span-1730" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">x</span><span class="MJXp-mtext" id="MJXp-Span-1732">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">t</span><span class="MJXp-mo" id="MJXp-Span-1738" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1739" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1740">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">u</span><span class="MJXp-msubsup" id="MJXp-Span-1743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1745" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">z</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">p</span><span class="MJXp-mtext" id="MJXp-Span-1748">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">t</span><span class="MJXp-mo" id="MJXp-Span-1753" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">x</span><span class="MJXp-mtext" id="MJXp-Span-1755">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">z</span><span class="MJXp-mtext" id="MJXp-Span-1760">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">t</span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">p</span><span class="MJXp-mtext" id="MJXp-Span-1768">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">t</span><span class="MJXp-mo" id="MJXp-Span-1773" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">z</span><span class="MJXp-mtext" id="MJXp-Span-1775">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">t</span><span class="MJXp-mo" id="MJXp-Span-1781" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71"> \ color {red} {p \ left (x \ right) = \ sum_ {z} p \ left (x \ mid z \ right) p \ left (z \ right)} </script>  - marginal probability or evidence: averaged over all possible hypotheses; </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1782"><span class="MJXp-mtext" id="MJXp-Span-1783">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">r</span><span class="MJXp-mrow" id="MJXp-Span-1789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">n</span></span><span class="MJXp-mrow" id="MJXp-Span-1795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">p</span><span class="MJXp-mtext" id="MJXp-Span-1797">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">t</span><span class="MJXp-mo" id="MJXp-Span-1802" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1803">y</span><span class="MJXp-mtext" id="MJXp-Span-1804">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">x</span><span class="MJXp-mtext" id="MJXp-Span-1809">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">t</span><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72"> \ color {green} {p \ left (y \ mid x \ right)} </script>  - posterior distribution: how plausible is the hypothesis with the observed data. </li></ul><br>  The statistics usually look for a point estimate of maximum likelihood (ML = maximum likelihood): <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1816"><span class="MJXp-mtext" id="MJXp-Span-1817">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">e</span><span class="MJXp-mtext" id="MJXp-Span-1823">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">t</span><span class="MJXp-msubsup" id="MJXp-Span-1828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1830" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1831">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">t</span><span class="MJXp-mrow" id="MJXp-Span-1836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">L</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1840">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843">g</span><span class="MJXp-mtext" id="MJXp-Span-1844">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">a</span><span class="MJXp-msubsup" id="MJXp-Span-1847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1849" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1850">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">a</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">p</span><span class="MJXp-mtext" id="MJXp-Span-1857">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">t</span><span class="MJXp-mo" id="MJXp-Span-1862" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863">D</span><span class="MJXp-mtext" id="MJXp-Span-1864">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867">d</span><span class="MJXp-mtext" id="MJXp-Span-1868">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">a</span><span class="MJXp-mtext" id="MJXp-Span-1874">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">t</span><span class="MJXp-mo" id="MJXp-Span-1880" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-73"> \ Large \ theta _ {\ text {ML}} = \ arg \ max _ {\ theta} p \ left (D \ mid \ theta \ right) </script></p><br><br>  While in the Bayesian approach they are interested in the posterior distribution: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1881"><span class="MJXp-mtext" id="MJXp-Span-1882">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1888">p</span><span class="MJXp-mtext" id="MJXp-Span-1889">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893">t</span><span class="MJXp-mo" id="MJXp-Span-1894" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1895">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1900">a</span><span class="MJXp-mtext" id="MJXp-Span-1901">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">D</span><span class="MJXp-mtext" id="MJXp-Span-1906">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911">t</span><span class="MJXp-mo" id="MJXp-Span-1912" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1913">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">p</span><span class="MJXp-mtext" id="MJXp-Span-1921">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">t</span><span class="MJXp-mo" id="MJXp-Span-1926" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">D</span><span class="MJXp-mtext" id="MJXp-Span-1928">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1929">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">d</span><span class="MJXp-mtext" id="MJXp-Span-1932">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937">a</span><span class="MJXp-mtext" id="MJXp-Span-1938">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">t</span><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">p</span><span class="MJXp-mtext" id="MJXp-Span-1946">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1947">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">t</span><span class="MJXp-mo" id="MJXp-Span-1951" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1952">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1956">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957">a</span><span class="MJXp-mtext" id="MJXp-Span-1958">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1962">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963">t</span><span class="MJXp-mo" id="MJXp-Span-1964" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-74"> \ Large p \ left (\ theta \ mid D \ right) \ propto p \ left (D \ mid \ theta \ right) p \ left (\ theta \ right) </script></p><br><br>  It often happens that the integral obtained as a result of Bayes output is extremely nontrivial (in the case of linear regression, this, fortunately, is not so), and then a point estimate is needed.  Then we are interested in the maximum posterior distribution (MAP = maximum a posteriori): <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1965"><span class="MJXp-mtext" id="MJXp-Span-1966">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971">e</span><span class="MJXp-mtext" id="MJXp-Span-1972">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1976">t</span><span class="MJXp-msubsup" id="MJXp-Span-1977"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1979" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1980">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984">t</span><span class="MJXp-mrow" id="MJXp-Span-1985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">P</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1989" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1990">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993">g</span><span class="MJXp-mtext" id="MJXp-Span-1994">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1996">a</span><span class="MJXp-msubsup" id="MJXp-Span-1997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1999" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2000">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">a</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">p</span><span class="MJXp-mtext" id="MJXp-Span-2007">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">t</span><span class="MJXp-mo" id="MJXp-Span-2012" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2013">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2018">a</span><span class="MJXp-mtext" id="MJXp-Span-2019">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2021">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2023">D</span><span class="MJXp-mtext" id="MJXp-Span-2024">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">t</span><span class="MJXp-mo" id="MJXp-Span-2030" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2031" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2032">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2033">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2035">g</span><span class="MJXp-mtext" id="MJXp-Span-2036">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">a</span><span class="MJXp-msubsup" id="MJXp-Span-2039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2041" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-2042">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2044">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047">a</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048">p</span><span class="MJXp-mtext" id="MJXp-Span-2049">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2050">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2052">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053">t</span><span class="MJXp-mo" id="MJXp-Span-2054" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">D</span><span class="MJXp-mtext" id="MJXp-Span-2056">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2058">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059">d</span><span class="MJXp-mtext" id="MJXp-Span-2060">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2061">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2062">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065">a</span><span class="MJXp-mtext" id="MJXp-Span-2066">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2071">t</span><span class="MJXp-mo" id="MJXp-Span-2072" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073">p</span><span class="MJXp-mtext" id="MJXp-Span-2074">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078">t</span><span class="MJXp-mo" id="MJXp-Span-2079" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2080">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2083">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2085">a</span><span class="MJXp-mtext" id="MJXp-Span-2086">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2087">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2091">t</span><span class="MJXp-mo" id="MJXp-Span-2092" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-75"> \ Large \ theta _ {\ text {MAP}} = \ arg \ max _ {\ theta} p \ left (\ theta \ mid D \ right) = \ arg \ max _ {\ theta} p \ left (D \ mid \ theta \ right) p \ left (\ theta \ right) </script></p><br><br>  Let's compare the ML and MAP hypotheses for linear regression, this will give us a clear understanding of the meaning of regularizations.  We assume that all objects from the training set were taken from the general population independently and uniformly distributed.  This will allow us to record the joint probability of data (likelihood) in the form: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2093"><span class="MJXp-mtext" id="MJXp-Span-2094">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2096">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2097">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2099">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100">p</span><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2102">D</span><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2104" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2105">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2108">o</span><span class="MJXp-msubsup" id="MJXp-Span-2109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2112">i</span><span class="MJXp-mo" id="MJXp-Span-2113">=</span><span class="MJXp-mn" id="MJXp-Span-2114">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">p</span><span class="MJXp-mo" id="MJXp-Span-2117" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2120" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2121" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-76"> \ Large p (D) = \ prod_ {i = 1} ^ n p (x_i) </script></p><br><br>  We will also assume that the target variable obeys the following law: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2122"><span class="MJXp-mtext" id="MJXp-Span-2123">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2125">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2128">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2129">y</span><span class="MJXp-mo" id="MJXp-Span-2130" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2131">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">c</span><span class="MJXp-msubsup" id="MJXp-Span-2135"><span class="MJXp-mrow" id="MJXp-Span-2136" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">w</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2138" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mtext" id="MJXp-Span-2139">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2140">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2141">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142">c</span><span class="MJXp-mrow" id="MJXp-Span-2143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144">x</span></span><span class="MJXp-mo" id="MJXp-Span-2145" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-2146">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153">n</span><span class="MJXp-mo" id="MJXp-Span-2154" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2155">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2158">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2162">n</span><span class="MJXp-mtext" id="MJXp-Span-2163">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2165">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2166">m</span><span class="MJXp-mtext" id="MJXp-Span-2167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2169">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2173">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174">l</span><span class="MJXp-mrow" id="MJXp-Span-2175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">N</span></span><span class="MJXp-mtext" id="MJXp-Span-2177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2178">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2179">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">t</span><span class="MJXp-mo" id="MJXp-Span-2182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2183">0</span><span class="MJXp-mo" id="MJXp-Span-2184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2185">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189">m</span><span class="MJXp-msubsup" id="MJXp-Span-2190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2192" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2193">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2196">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2197">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">t</span><span class="MJXp-mo" id="MJXp-Span-2199" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-77"> \ Large y = \ vec {w} ^ T \ vec {x} + \ epsilon, \ epsilon \ sim \ mathcal {N} \ left (0, \ sigma ^ 2 \ right) </script></p><br>  or <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2200"><span class="MJXp-mtext" id="MJXp-Span-2201">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2204">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2205">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2206">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207">p</span><span class="MJXp-mtext" id="MJXp-Span-2208">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2209">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2211">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">t</span><span class="MJXp-mo" id="MJXp-Span-2213" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2214">y</span><span class="MJXp-mtext" id="MJXp-Span-2215">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2216">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218">d</span><span class="MJXp-mtext" id="MJXp-Span-2219">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2221">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2222">c</span><span class="MJXp-mrow" id="MJXp-Span-2223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224">x</span></span><span class="MJXp-mo" id="MJXp-Span-2225" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2226">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2228">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229">c</span><span class="MJXp-mrow" id="MJXp-Span-2230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">w</span></span><span class="MJXp-mo" id="MJXp-Span-2232" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">m</span><span class="MJXp-msubsup" id="MJXp-Span-2238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2240" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2241">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2245">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246">t</span><span class="MJXp-mo" id="MJXp-Span-2247" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2248" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2249">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2251">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2254">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256">l</span><span class="MJXp-mrow" id="MJXp-Span-2257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2258">N</span></span><span class="MJXp-mtext" id="MJXp-Span-2259">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">t</span><span class="MJXp-mo" id="MJXp-Span-2264" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265">y</span><span class="MJXp-mtext" id="MJXp-Span-2266">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2268">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">d</span><span class="MJXp-mtext" id="MJXp-Span-2270">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2272">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">c</span><span class="MJXp-msubsup" id="MJXp-Span-2274"><span class="MJXp-mrow" id="MJXp-Span-2275" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">w</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2277" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mtext" id="MJXp-Span-2278">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281">c</span><span class="MJXp-mrow" id="MJXp-Span-2282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2283">x</span></span><span class="MJXp-mo" id="MJXp-Span-2284" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2285">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2286">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2288">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">m</span><span class="MJXp-msubsup" id="MJXp-Span-2290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2291" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2292" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2293">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2294">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2295">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2296">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2297">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2298">t</span><span class="MJXp-mo" id="MJXp-Span-2299" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-78"> \ Large p \ left (y \ mid \ vec {x}, \ vec {w}, \ sigma ^ 2 \ right) = \ mathcal {N} \ left (y \ mid \ vec {w} ^ T \ vec {x}, \ sigma ^ 2 \ right) </script></p><br>  Those.  the correct value of the target variable is made up of the value of the deterministic linear function and some unpredictable random error, with zero expectation and some variance.  Then, we can write the likelihood of the data as: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2300"><span class="MJXp-mtext" id="MJXp-Span-2301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2303">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2306">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">p</span><span class="MJXp-mtext" id="MJXp-Span-2308">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2309">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2310">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2312">t</span><span class="MJXp-mo" id="MJXp-Span-2313" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2314">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2317">c</span><span class="MJXp-mrow" id="MJXp-Span-2318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2319">y</span></span><span class="MJXp-mtext" id="MJXp-Span-2320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2321">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2322">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324">X</span><span class="MJXp-mo" id="MJXp-Span-2325" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2326">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2328">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2329">c</span><span class="MJXp-mrow" id="MJXp-Span-2330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2331">w</span></span><span class="MJXp-mo" id="MJXp-Span-2332" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2333">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2335">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2337">m</span><span class="MJXp-msubsup" id="MJXp-Span-2338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2339" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2340" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2341">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2342">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2346">t</span><span class="MJXp-mo" id="MJXp-Span-2347" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-2349">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2352">o</span><span class="MJXp-msubsup" id="MJXp-Span-2353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354" style="margin-right: 0.05em;">d</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">i</span><span class="MJXp-mo" id="MJXp-Span-2357">=</span><span class="MJXp-mn" id="MJXp-Span-2358">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-2360">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2363">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">l</span><span class="MJXp-mrow" id="MJXp-Span-2368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2369">N</span></span><span class="MJXp-mtext" id="MJXp-Span-2370">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">t</span><span class="MJXp-mo" id="MJXp-Span-2375" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2378" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-2379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2380">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2382">d</span><span class="MJXp-mtext" id="MJXp-Span-2383">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386">c</span><span class="MJXp-msubsup" id="MJXp-Span-2387"><span class="MJXp-mrow" id="MJXp-Span-2388" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2389">w</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2390" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mtext" id="MJXp-Span-2391">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2393">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394">c</span><span class="MJXp-msubsup" id="MJXp-Span-2395"><span class="MJXp-mrow" id="MJXp-Span-2396" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2397">x</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2398" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2399" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2400">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2402">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2403">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404">m</span><span class="MJXp-msubsup" id="MJXp-Span-2405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2407" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2408">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2409">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2411">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">t</span><span class="MJXp-mo" id="MJXp-Span-2414" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-79"> \ Large p \ left (\ vec {y} \ mid X, \ vec {w}, \ sigma ^ 2 \ right) = \ prod_ {i = 1} ^ n \ mathcal {N} \ left (y_i \ mid \ vec {w} ^ T \ vec {x} _i, \ sigma ^ 2 \ right) </script></p><br>  it is more convenient to recalibrate this expression: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2415"><span class="noError" id="MJXp-Span-2416" style="display: inline-block;">\&nbsp;Large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;mathcal&nbsp;{L}&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;ln&nbsp;p&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{y}&nbsp;\&nbsp;mid&nbsp;X,&nbsp;\&nbsp;vec&nbsp;{w},&nbsp;\&nbsp;sigma&nbsp;^&nbsp;2&nbsp;\&nbsp;right)&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;ln&nbsp;\&nbsp;prod_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;n&nbsp;\&nbsp;mathcal&nbsp;{N}&nbsp;\&nbsp;left&nbsp;(y_i&nbsp;\&nbsp;mid&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{x}&nbsp;_i,&nbsp;\&nbsp;sigma&nbsp;^&nbsp;2&nbsp;\&nbsp;right)&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;ln&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{\&nbsp;left&nbsp;(\&nbsp;sigma&nbsp;\&nbsp;sqrt&nbsp;{2&nbsp;\&nbsp;pi}&nbsp;\&nbsp;right)&nbsp;^&nbsp;n}&nbsp;e&nbsp;^&nbsp;{-&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{2&nbsp;\&nbsp;sigma&nbsp;^&nbsp;2}&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;n&nbsp;\&nbsp;left&nbsp;(y_i&nbsp;-&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{x}&nbsp;_i&nbsp;\&nbsp;right)&nbsp;^&nbsp;2}&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;-&nbsp;\&nbsp;frac&nbsp;{n}&nbsp;{2}&nbsp;\&nbsp;ln&nbsp;2&nbsp;\&nbsp;pi&nbsp;\&nbsp;sigma&nbsp;^&nbsp;2&nbsp;-&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{2&nbsp;\&nbsp;sigma&nbsp;^&nbsp;2}&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;n&nbsp;\&nbsp;left&nbsp;(y_i&nbsp;-&nbsp;\&nbsp;vec&nbsp;{w}&nbsp;^&nbsp;T&nbsp;\&nbsp;vec&nbsp;{x}&nbsp;_i&nbsp;\&nbsp;right)&nbsp;^&nbsp;2&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-80"> \ Large \ begin {array} {rcl} \ mathcal {L} & = & \ ln p \ left (\ vec {y} \ mid X, \ vec {w}, \ sigma ^ 2 \ right) \\ & = & \ ln \ prod_ {i = 1} ^ n \ mathcal {N} \ left (y_i \ mid \ vec {w} ^ T \ vec {x} _i, \ sigma ^ 2 \ right) \\ & = & \ ln \ frac {1} {\ left (\ sigma \ sqrt {2 \ pi} \ right) ^ n} e ^ {- \ frac {1} {2 \ sigma ^ 2} \ sum_ {i = 1} ^ n \ left (y_i - \ vec {w} ^ T \ vec {x} _i \ right) ^ 2} \\ & = & - \ frac {n} {2} \ ln 2 \ pi \ sigma ^ 2 - \ frac {1} {2 \ sigma ^ 2} \ sum_ {i = 1} ^ n \ left (y_i - \ vec {w} ^ T \ vec {x} _i \ right) ^ 2 \ end {array} </script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And suddenly we will see that the maximum likelihood estimate is the same as the least squares estimate. </font><font style="vertical-align: inherit;">We will generate a new data set of a larger size, find the ML solution and visualize it.</font></font><br><br><pre> <code class="python hljs">data = generate_wave_set(<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) X = np.vstack((np.ones(data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>].shape[<span class="hljs-number"><span class="hljs-number">0</span></span>]), data[<span class="hljs-string"><span class="hljs-string">'x_train'</span></span>])).T w = np.dot(np.dot(np.linalg.inv(np.dot(XT, X)), XT), data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>])</code> </pre><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drawing graphics</font></font></b> <div class="spoiler_text"><pre> <code class="python hljs">w0_support = np.linspace(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) w1_support = np.linspace(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-comment"><span class="hljs-comment"># create cartesian product of parameters wx_space = list(it.product(w0_support, w1_support)) w0, w1 = zip(*wx_space) # calculate MSE on dataset for each pairs of parameters y = ((data['y_train'][:, np.newaxis] - np.dot(X, np.array(wx_space).T))**2).mean(axis=0) plt.hexbin(w0, w1, C=y**(0.2), cmap=cm.jet_r, bins=None) plt.axvline(0, color='black', linestyle='-', label='origin') plt.axhline(0, color='black', linestyle='-') plt.axvline(w[0], color='w', linestyle='--', label='ML solution') plt.axhline(w[1], color='w', linestyle='--') plt.axes().set_aspect('equal', 'datalim') plt.title('ML solution') plt.xlabel('w_0') plt.ylabel('w_1') plt.legend(loc='upper left', prop={'size': 20}) plt.show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/files/1ce/60e/360/1ce60e36083c49a9ac211a3829d1789c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Different values ‚Äã‚Äãof all two parameters of the model are plotted on the abscissa and ordinate axis (we decide exactly linear regression, not polynomial), the background color is proportional to the likelihood value at the corresponding point of the parameter values. </font><font style="vertical-align: inherit;">The ML solution is at the very peak, where credibility is at its maximum. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let us find the MAP estimate of the linear regression parameters, for this we will have to set some prior distribution on the model parameters. </font><font style="vertical-align: inherit;">Let for a start it will again be a normal distribution:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2418">p</span><span class="MJXp-mrow" id="MJXp-Span-2419"><span class="MJXp-mo" id="MJXp-Span-2420" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.129em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.516em; margin-left: 0.03em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2421"><span class="MJXp-munderover" id="MJXp-Span-2422"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2424" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2423">w</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2425" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.129em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.516em; margin-left: 0.03em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2427"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2428">N</span></span><span class="MJXp-mrow" id="MJXp-Span-2429"><span class="MJXp-mo" id="MJXp-Span-2430" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2431"><span class="MJXp-munderover" id="MJXp-Span-2432"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2434" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433">w</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2435" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-mn" id="MJXp-Span-2436">0</span><span class="MJXp-mo" id="MJXp-Span-2437" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2439" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2441">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2440">0</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442">E</span><span class="MJXp-mo" id="MJXp-Span-2443" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81">p\left(\vec{w}\right) = \mathcal{N}\left(\vec{w} \mid 0, \sigma_0^2 E\right)</script>  . <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Normal distribution</font></font></b> <div class="spoiler_text"><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2444"><span class="MJXp-mstyle" id="MJXp-Span-2445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446">p</span><span class="MJXp-mrow" id="MJXp-Span-2447"><span class="MJXp-mo" id="MJXp-Span-2448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449">x</span><span class="MJXp-mo" id="MJXp-Span-2450" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2451">Œº</span><span class="MJXp-mo" id="MJXp-Span-2452" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2453">œÉ</span><span class="MJXp-mo" id="MJXp-Span-2454" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-2455" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2456" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2457">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2458">œÉ</span><span class="MJXp-msqrt" id="MJXp-Span-2459"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">‚àö</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2460">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2461">œÄ</span></span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2464" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2465">‚àí</span><span class="MJXp-mstyle" id="MJXp-Span-2466"><span class="MJXp-mfrac" id="MJXp-Span-2467" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2468"><span class="MJXp-mrow" id="MJXp-Span-2469" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2470" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2471">x</span><span class="MJXp-mo" id="MJXp-Span-2472" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2473">Œº</span><span class="MJXp-mo" id="MJXp-Span-2474" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2475" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2476">2</span><span class="MJXp-msubsup" id="MJXp-Span-2477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2479" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-82">\Large p\left(x \mid \mu, \sigma\right) = \frac{1}{\sigma \sqrt{2\pi}} e^{-\dfrac{\left(x - \mu\right)^2}{2\sigma^2}}</script></p><br><br><pre> <code class="python hljs">x = np.linspace(<span class="hljs-number"><span class="hljs-number">-5</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> scale <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> np.linspace(<span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">1.4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>): plt.plot(x, norm.pdf(x, scale=scale), label=<span class="hljs-string"><span class="hljs-string">'scale=%0.2f'</span></span> % scale) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>, prop={<span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>}) plt.title(<span class="hljs-string"><span class="hljs-string">'Normal distribution with different scale parameter'</span></span>) plt.show()</code> </pre><br><img src="https://habrastorage.org/files/0fd/a2b/1db/0fda2b1dba32463eadc0d4bd2cb5b41a.png"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Then the posterior distribution takes the form: </font></font><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2480"><span class="MJXp-mstyle" id="MJXp-Span-2481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2482">p</span><span class="MJXp-mrow" id="MJXp-Span-2483"><span class="MJXp-mo" id="MJXp-Span-2484" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2485"><span class="MJXp-munderover" id="MJXp-Span-2486"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2488" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2487">w</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2489" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-mrow" id="MJXp-Span-2490"><span class="MJXp-munderover" id="MJXp-Span-2491"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2493" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2492">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2494" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2495">X</span><span class="MJXp-mo" id="MJXp-Span-2496" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2498" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2499" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2500" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2501" style="margin-left: 0.333em; margin-right: 0.333em;">‚àù</span><span class="MJXp-mrow" id="MJXp-Span-2502"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2503">N</span></span><span class="MJXp-mrow" id="MJXp-Span-2504"><span class="MJXp-mo" id="MJXp-Span-2505" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2506"><span class="MJXp-munderover" id="MJXp-Span-2507"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2509" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2508">w</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2510" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-mn" id="MJXp-Span-2511">0</span><span class="MJXp-mo" id="MJXp-Span-2512" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2516">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2515">0</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2517">E</span><span class="MJXp-mo" id="MJXp-Span-2518" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-munderover" id="MJXp-Span-2519"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2525" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2520" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àè</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2521" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2522">i</span><span class="MJXp-mo" id="MJXp-Span-2523">=</span><span class="MJXp-mn" id="MJXp-Span-2524">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2526"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2527">N</span></span><span class="MJXp-mrow" id="MJXp-Span-2528"><span class="MJXp-mo" id="MJXp-Span-2529" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.307em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.227em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-2530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2531" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2532" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2533" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-msubsup" id="MJXp-Span-2534"><span class="MJXp-mrow" id="MJXp-Span-2535" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2536"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537">w</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2539" style="vertical-align: 0.532em;">T</span></span><span class="MJXp-msubsup" id="MJXp-Span-2540"><span class="MJXp-mrow" id="MJXp-Span-2541" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2542"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2544" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2543">x</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2545" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2546" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2548" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2549" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2550" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.307em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.227em; margin-left: -0.09em;">)</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-83">\Large p\left(\vec{w} \mid \vec{y}, X, \sigma^2\right) \propto \mathcal{N}\left(\vec{w} \mid 0, \sigma_0^2 E\right) \prod_{i=1}^n \mathcal{N}\left(y_i \mid \vec{w}^T \vec{x}_i, \sigma^2\right)</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If you write the logarithm of this expression, you can easily see that adding a normal prior distribution is the same as adding </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2551"><span class="MJXp-msubsup" id="MJXp-Span-2552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2553" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2554" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84">L^2</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">norms to the cost function. </font><font style="vertical-align: inherit;">Try it yourself. </font><font style="vertical-align: inherit;">It will also become clear that by varying the regularization parameter, we change the variance of the a priori distribution:</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556">Œª</span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2558" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2559">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2560">2</span><span class="MJXp-msubsup" id="MJXp-Span-2561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2562" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2564">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-2563">0</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85">\lambda = \frac{1}{2\sigma_0^2}</script>  . <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drawing graphics</font></font></b> <div class="spoiler_text"><pre> <code class="python hljs">w = np.dot(np.dot(np.linalg.inv(np.dot(XT, X)), XT), data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>]) <span class="hljs-comment"><span class="hljs-comment"># solve L2 problems for different values of w_l2 = {} lmbd_space = np.linspace(0.5, 1500, 500) for lmbd in lmbd_space: w_l2[lmbd] = np.dot(np.dot(np.linalg.inv(np.dot(XT, X) + lmbd*np.eye(X.shape[1])), XT), data['y_train']) w0_support = np.linspace(-3, 3, 1000) w1_support = np.linspace(-3, 3, 1000) wx_space = list(it.product(w0_support, w1_support)) w0, w1 = zip(*wx_space) y = ((data['y_train'][:, np.newaxis] - np.dot(X, np.array(wx_space).T))**2).mean(axis=0) plt.hexbin(w0, w1, C=y**(0.2), cmap=cm.jet_r, bins=None) plt.axvline(0, color='black', linestyle='-', label='origin') plt.axhline(0, color='black', linestyle='-') # plot prior distribution of parameters for i in range(1, 6): plt.gcf().gca().add_artist(plt.Circle((0, 0), i*0.3, color='black', linestyle='--', alpha=0.1)) plt.axvline(w[0], color='w', linestyle='--', label='ML solution') plt.axhline(w[1], color='w', linestyle='--') # plot MAP solutions flag = True for _, w_l2_solution in w_l2.items(): plt.plot(w_l2_solution[0], w_l2_solution[1], color='c', marker='.', mew=1, alpha=0.5, label='MAP L2 solution' if flag else None) flag = False plt.axes().set_aspect('equal', 'datalim') plt.title('ML and MAP L2 for different values of lambda') plt.xlabel('w_0') plt.ylabel('w_1') plt.legend(loc='upper left', prop={'size': 20}) plt.show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/files/fe5/709/fe6/fe5709fe61fd4f3b8832a61f5fa05b9c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now the circles coming from the center have been added to the chart - this is the density of the prior distribution (circles, not ellipses, because the covariance matrix of this normal distribution is diagonal, and the same number is on the diagonal). </font><font style="vertical-align: inherit;">The dots indicate various solutions to the MAP problem. </font><font style="vertical-align: inherit;">By increasing the regularization parameter (which is equivalent to reducing the variance), we force the solution to move away from the ML estimate and move closer to the center of the prior distribution. </font><font style="vertical-align: inherit;">With a large value of the regularization parameter, all parameters will be close to zero. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Naturally, we can impose another prior distribution on the model parameters, for example, the Laplace distribution, then we will get the same as</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2565"><span class="MJXp-msubsup" id="MJXp-Span-2566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2567" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2568" style="vertical-align: 0.5em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86">L^1</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> regularization. </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laplace distribution</font></font></b> <div class="spoiler_text"><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2569"><span class="MJXp-mstyle" id="MJXp-Span-2570"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2571">p</span><span class="MJXp-mrow" id="MJXp-Span-2572"><span class="MJXp-mo" id="MJXp-Span-2573" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2574">x</span><span class="MJXp-mo" id="MJXp-Span-2575" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2576">Œº</span><span class="MJXp-mo" id="MJXp-Span-2577" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2578">Œ≤</span><span class="MJXp-mo" id="MJXp-Span-2579" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-2580" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2581" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2582">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2583">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2584">Œ≤</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2586" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2587" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2588">‚àí</span><span class="MJXp-mstyle" id="MJXp-Span-2589"><span class="MJXp-mfrac" id="MJXp-Span-2590" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-2591"><span class="MJXp-mo" id="MJXp-Span-2592" style="margin-left: 0em; margin-right: 0em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2593">x</span><span class="MJXp-mo" id="MJXp-Span-2594" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595">Œº</span><span class="MJXp-mo" id="MJXp-Span-2596" style="margin-left: 0em; margin-right: 0em;">|</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597">Œ≤</span></span></span></span></span></span></span></span></span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-87">\Large p\left(x \mid \mu, \beta\right) = \frac{1}{2\beta} e^{-\dfrac{\left|x - \mu\right|}{\beta}}</script></p><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.stats <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> laplace x = np.linspace(<span class="hljs-number"><span class="hljs-number">-5</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> scale <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> np.linspace(<span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">1.4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>): plt.plot(x, laplace.pdf(x, scale=scale), label=<span class="hljs-string"><span class="hljs-string">'scale=%0.2f'</span></span> % scale) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>, prop={<span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>}) plt.title(<span class="hljs-string"><span class="hljs-string">'Laplace distribution with different scale parameter'</span></span>) plt.show()</code> </pre><br><img src="https://habrastorage.org/files/aea/2ca/2a4/aea2ca2a4d214ce8bd0dd0b75bcd790d.png"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Then the posterior distribution takes the form: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2598"><span class="MJXp-mstyle" id="MJXp-Span-2599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2600">p</span><span class="MJXp-mrow" id="MJXp-Span-2601"><span class="MJXp-mo" id="MJXp-Span-2602" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2603"><span class="MJXp-munderover" id="MJXp-Span-2604"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2606" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605">w</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2607" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-mrow" id="MJXp-Span-2608"><span class="MJXp-munderover" id="MJXp-Span-2609"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2611" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2610">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2612" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2613">X</span><span class="MJXp-mo" id="MJXp-Span-2614" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2616" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2617" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2618" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-2619" style="margin-left: 0.333em; margin-right: 0.333em;">‚àù</span><span class="MJXp-mtext" id="MJXp-Span-2620">Laplace</span><span class="MJXp-mrow" id="MJXp-Span-2621"><span class="MJXp-mo" id="MJXp-Span-2622" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.129em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.516em; margin-left: 0.03em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-2623"><span class="MJXp-munderover" id="MJXp-Span-2624"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2626" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625">w</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2627" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-mn" id="MJXp-Span-2628">0</span><span class="MJXp-mo" id="MJXp-Span-2629" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2630">Œ≤</span><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.129em;"><span class="MJXp-right MJXp-scale9" style="font-size: 1.516em; margin-left: 0.03em;">)</span></span></span><span class="MJXp-munderover" id="MJXp-Span-2632"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2633" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àè</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2634" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2635">i</span><span class="MJXp-mo" id="MJXp-Span-2636">=</span><span class="MJXp-mn" id="MJXp-Span-2637">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2639"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2640">N</span></span><span class="MJXp-mrow" id="MJXp-Span-2641"><span class="MJXp-mo" id="MJXp-Span-2642" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.307em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.227em; margin-left: -0.09em;">(</span></span><span class="MJXp-msubsup" id="MJXp-Span-2643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2644" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2645" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2646" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-msubsup" id="MJXp-Span-2647"><span class="MJXp-mrow" id="MJXp-Span-2648" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2649"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2651" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650">w</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2652" style="vertical-align: 0.532em;">T</span></span><span class="MJXp-msubsup" id="MJXp-Span-2653"><span class="MJXp-mrow" id="MJXp-Span-2654" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-2655"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-2657" style="margin-left: 0px; margin-right: 0px; font-size: 60%;">‚Üí</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2656">x</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2658" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2659" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2661" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2662" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2663" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.307em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.227em; margin-left: -0.09em;">)</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-88">\Large p\left(\vec{w} \mid \vec{y}, X, \sigma^2\right) \propto \text{Laplace}\left(\vec{w} \mid 0, \beta\right) \prod_{i=1}^n \mathcal{N}\left(y_i \mid \vec{w}^T \vec{x}_i, \sigma^2\right)</script></p><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drawing graphics</font></font></b> <div class="spoiler_text"><pre> <code class="python hljs">w_l1 = {} lmbd_space = np.linspace(<span class="hljs-number"><span class="hljs-number">0.001</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> lmbd <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm(lmbd_space): w_l1[lmbd] = fit_lr_l1(X, data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>], lmbd, n_iter=<span class="hljs-number"><span class="hljs-number">10000</span></span>, lr=<span class="hljs-number"><span class="hljs-number">0.001</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] w0_support = np.linspace(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) w1_support = np.linspace(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) wx_space = list(it.product(w0_support, w1_support)) w0, w1 = zip(*wx_space) y = ((data[<span class="hljs-string"><span class="hljs-string">'y_train'</span></span>][:, np.newaxis] - np.dot(X, np.array(wx_space).T))**<span class="hljs-number"><span class="hljs-number">2</span></span>).mean(axis=<span class="hljs-number"><span class="hljs-number">0</span></span>) plt.hexbin(w0, w1, C=y**(<span class="hljs-number"><span class="hljs-number">0.2</span></span>), cmap=cm.jet_r, bins=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) plt.axvline(<span class="hljs-number"><span class="hljs-number">0</span></span>, color=<span class="hljs-string"><span class="hljs-string">'black'</span></span>, linestyle=<span class="hljs-string"><span class="hljs-string">'-'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'origin'</span></span>) plt.axhline(<span class="hljs-number"><span class="hljs-number">0</span></span>, color=<span class="hljs-string"><span class="hljs-string">'black'</span></span>, linestyle=<span class="hljs-string"><span class="hljs-string">'-'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># function to plot rhomb def plot_rhomb(cx=0, cy=0, r=0.5): plt.gcf().gca().add_artist(plt.Rectangle((cx, cy - np.sqrt(2*r**2)), 2*r, 2*r, angle=45, color='black', linestyle='--', alpha=0.1)) # plot Laplace distribution density for i in range(1, 6): plot_rhomb(r=0.2*i) plt.axvline(w[0], color='w', linestyle='--', label='ML solution') plt.axhline(w[1], color='w', linestyle='--') # plot MAP solutions flag = True for _, w_l1_solution in w_l1.items(): plt.plot(w_l1_solution[0], w_l1_solution[1], color='c', marker='.', mew=1, alpha=0.5, label='MAP L1 solution' if flag else None) flag = False plt.axes().set_aspect('equal', 'datalim') plt.title('ML and MAP L1 for different values of lambda') plt.xlabel('w_0') plt.ylabel('w_1') plt.legend(loc='upper left', prop={'size': 20}) plt.show()</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/files/3ba/9ce/14d/3ba9ce14de964e4fada77c2995af82be.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Global dynamics has not changed: we increase the regularization parameter - the solution approaches the center of the prior distribution. </font><font style="vertical-align: inherit;">We can also observe that such a regularization contributes to finding sparse solutions: you can see two segments in which first one parameter is equal to zero, then the second parameter (at the end both are equal to zero). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And in fact, the two regularizers described are special cases of superimposing a </font></font><a href="https://en.wikipedia.org/wiki/Generalized_normal_distribution"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">generalized normal distribution</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as an a priori distribution on the linear regression parameters:</font></font><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2664"><span class="MJXp-mstyle" id="MJXp-Span-2665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2666">p</span><span class="MJXp-mrow" id="MJXp-Span-2667"><span class="MJXp-mo" id="MJXp-Span-2668" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669">x</span><span class="MJXp-mo" id="MJXp-Span-2670" style="margin-left: 0.333em; margin-right: 0.333em;">‚à£</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2671">Œ±</span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2673">Œ≤</span><span class="MJXp-mo" id="MJXp-Span-2674" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2675">Œº</span><span class="MJXp-mo" id="MJXp-Span-2676" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-2677" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2678" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2679">Œ≤</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-2680">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2681">Œ±</span><span class="MJXp-mi" id="MJXp-Span-2682">Œì</span><span class="MJXp-mrow" id="MJXp-Span-2683"><span class="MJXp-mo" id="MJXp-Span-2684" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-2685" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2686">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687">Œ≤</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2688" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2690" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2691" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2692">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-2693"><span class="MJXp-mrow" id="MJXp-Span-2694" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2695" style="vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-2696" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2697"><span class="MJXp-mo" id="MJXp-Span-2698">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2699">x</span><span class="MJXp-mo" id="MJXp-Span-2700">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701">Œº</span><span class="MJXp-mo" id="MJXp-Span-2702">|</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2703">Œ±</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2704" style="vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2705" style="vertical-align: 1.2em;">Œ≤</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-89">\Large p\left(x \mid \alpha, \beta, \mu\right) = \frac{\beta}{2\alpha \Gamma\left(\frac{1}{\beta}\right)} e^{-\left(\frac{\left|x - \mu\right|}{\alpha}\right)^\beta}</script></p><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drawing graphics</font></font></b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.stats <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gennorm x = np.linspace(<span class="hljs-number"><span class="hljs-number">-5</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> beta <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> np.linspace(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>): plt.plot(x, gennorm.pdf(x, beta=beta), label=<span class="hljs-string"><span class="hljs-string">'beta=%0.2f'</span></span> % beta) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>, prop={<span class="hljs-string"><span class="hljs-string">'size'</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>}) plt.title(<span class="hljs-string"><span class="hljs-string">'Generalized normal distribution with different beta parameter'</span></span>) plt.show()</code> </pre><br></div></div><br><br><img src="https://habrastorage.org/files/135/1c9/f5c/1351c9f5c9dc472586e0af7df3422ba6.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Or we can look at these regularizers in terms of limiting </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2706"><span class="MJXp-msubsup" id="MJXp-Span-2707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2708" style="margin-right: 0.05em;">L</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2709" style="vertical-align: 0.5em;">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90">L^p</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> norms, as in the previous part: </font></font><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2715"><span class="MJXp-mstyle" id="MJXp-Span-2716"><span class="MJXp-msubsup" id="MJXp-Span-2717"><span class="MJXp-mrow" id="MJXp-Span-2718" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2719" style="margin-left: 0em; margin-right: 0em;">‚Äñ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2720">x</span><span class="MJXp-mo" id="MJXp-Span-2721" style="margin-left: 0em; margin-right: 0em;">‚Äñ</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2722" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-2723" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2724"><span class="MJXp-mrow" id="MJXp-Span-2725" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2726" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-2727"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2733" style="margin-right: 0px; margin-left: 0px;">‚àû</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2728" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2729" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2730">i</span><span class="MJXp-mo" id="MJXp-Span-2731">=</span><span class="MJXp-mn" id="MJXp-Span-2732">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2734"><span class="MJXp-mrow" id="MJXp-Span-2735" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2736" style="margin-left: 0em; margin-right: 0em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2737">x</span><span class="MJXp-mo" id="MJXp-Span-2738" style="margin-left: 0em; margin-right: 0em;">|</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2739" style="vertical-align: 0.5em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-2740" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2741" style="vertical-align: 1.64em;"><span class="MJXp-mfrac" id="MJXp-Span-2742" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2743">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2744">p</span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-91">\Large \left\|x\right\|_p = \left( \sum_{i=1}^\infty \left|x\right|^p \right)^{\frac{1}{p}}</script></p><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drawing graphics</font></font></b> <div class="spoiler_text"><pre> <code class="python hljs">f, ax = plt.subplots(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) ax = reduce(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> a, b: a + b, ax.tolist()) a_list = np.linspace(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>*np.pi, <span class="hljs-number"><span class="hljs-number">361</span></span>) r_list = np.linspace(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.1</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ix, p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(np.linspace(<span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>)): points = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a_list: r_inner = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> r_list: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> np.linalg.norm([r*np.cos(a), r*np.sin(a)], p) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> r_inner.append(r) r = max(r_inner) points.append([r*np.cos(a), r*np.sin(a)]) points = np.array(points) ax[ix].plot(points[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], points[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]) ax[ix].set_aspect(<span class="hljs-string"><span class="hljs-string">'equal'</span></span>, <span class="hljs-string"><span class="hljs-string">'datalim'</span></span>) ax[ix].set_title(<span class="hljs-string"><span class="hljs-string">'Circle in Lp space, p=%0.2f'</span></span> % p)</code> </pre><br></div></div><br><img src="https://habrastorage.org/files/5a2/988/288/5a298828891046cab9b18cce196e0997.png"><br><br><h2>  Conclusion </h2><br> <a href="https://github.com/mephistopheies/dds/blob/master/lr_040117/ipy/lecture.ipynb"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> you will find jupyter notebook with all of the above and a few bonuses. </font><font style="vertical-align: inherit;">Special thanks to those who mastered this text to the end. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Those wishing to dig into this topic deeper, I recommend:</font></font><br><br><ul><li> <a href="http://logic.pdmi.ras.ru/~sergey/teaching/mlkfu2014.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lectures by Sergey Nikolenko</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , from where the idea of ‚Äã‚Äãthis jupyter notebook was borrowed;</font></font></li><li> <a href="https://www.youtube.com/playlist%3Flist%3DPL-U1Z5tJ1i-YA-GdNXmQ8TEB0jjeDrDb_"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boris Demeshev</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 's </font><a href="https://www.youtube.com/playlist%3Flist%3DPL-U1Z5tJ1i-YA-GdNXmQ8TEB0jjeDrDb_"><font style="vertical-align: inherit;">lectures</font></a><font style="vertical-align: inherit;"> on econometrics (from the 146th video), and his own </font></font><a href="https://ru.coursera.org/learn/ekonometrika"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">course on the course</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Understanding linear regression is the key to understanding more complex models, right down to deep neural networks. </font><font style="vertical-align: inherit;">If we take the sigmoid from the linear function, we get a logistic regression. </font><font style="vertical-align: inherit;">We mix several logrepressors in one layer - we get softmax regression / max entropy regression. </font><font style="vertical-align: inherit;">And if you stack several layers, there will be a non-network.</font></font> So it goes. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Join </font></font><a href="http://ods.ai/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ods.ai</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , come to our meetings, we will make ML great again!</font></font><br><br><img src="https://habrastorage.org/files/fd4/502/43d/fd450243dd604b81b9713213a247aa20.jpg"></div><p>Source: <a href="https://habr.com/ru/post/322076/">https://habr.com/ru/post/322076/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322064/index.html">We accept weather images with NOAA - easy</a></li>
<li><a href="../322066/index.html">R in enterprise tasks. Tricks and Tricks</a></li>
<li><a href="../322068/index.html">How I learned to code, created a web application and launched it on Product Hunt in 2 months</a></li>
<li><a href="../322070/index.html">How to write your keyboard for Android</a></li>
<li><a href="../322072/index.html">How computers were advertised in the 1990s</a></li>
<li><a href="../322078/index.html">Telegram bot, webhook and 50 lines of code</a></li>
<li><a href="../322080/index.html">Indoor Air Quality Monitor</a></li>
<li><a href="../322082/index.html">Transition from Google Analytics to Firebase</a></li>
<li><a href="../322084/index.html">How slyamzit Habr in a quick way</a></li>
<li><a href="../322088/index.html">Benefits of Enterprise Mobility Management with Citrix XenMobile</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>