<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Handling complex events with chains</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article describes a method for handling complex events using chains. As a practical application, a relatively simple task was chosen - forecastin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Handling complex events with chains</h1><div class="post__text post__text-html js-mediator-article">  This article describes a method for <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D0%25BA%25D0%25B0_%25D1%2581%25D0%25BB%25D0%25BE%25D0%25B6%25D0%25BD%25D1%258B%25D1%2585_%25D1%2581%25D0%25BE%25D0%25B1%25D1%258B%25D1%2582%25D0%25B8%25D0%25B9">handling complex events</a> using chains.  As a practical application, a relatively simple task was chosen - forecasting the movement of the exchange rate. <br><br>  In constructing the chains, the methodology described in the article <a href="http://habrahabr.ru/post/119049/">‚ÄúAutomatic analysis of texts without moderators‚Äù</a> and in comments to it was used.  After the description of the algorithm, a strategy with a positive expectation of profit will be proposed. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  When processing events, one has to look for a meaning.  If the sun shines from the sky and the southwest wind blows, what does this mean?  And if deaf peals suddenly became dark and audible, then how does this threaten? <br><br>  The answer to these questions lies in the future.  If the weather is good now, then you can go for a walk.  And if the clouds suddenly thickened, then it is necessary to prepare for the rain.  Thus, events from the present become prerequisites for shaping the future. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But the future does not exist.  Even if it is predetermined, a factor that can change the result to some degree or other can always appear.  You can only talk about a certain probability with which the forecast is executed. <br><br>  When forecasting it is necessary to operate with a limited set of information.  The more of it, the more time is spent on processing.  The need for processing deliberately makes instant reaction impossible.  Even if the processing takes seconds, but in a second much that can happen.  And the more complicated the methods involved, the greater the gap between the appearance of the initial data and the end result. <br><br>  Another factor is that the behavior of the environment is not always determined and determined.  This forces us to resort to empirical methods of research: first we fix the prerequisites, and then associate them with the consequences that have occurred.  The time between cause and effect gives an additional delay. <br><br>  If the behavior of the environment does not depend on its past states, then its prediction is <a href="http://www.mql5.com/ru/articles/248">impossible</a> - you never know what will happen in the next moment.  But in practice, stable cause-and-effect relationships still occur and sometimes exist from time immemorial. <br><br>  Thus, the task is reduced to the collection of necessary information, an empirical search for stable causal relationships and the use of results in forecasting. <br><br><h4>  Formulation of the problem </h4><br>  Let us try to predict the direction of movement of the EURUSD rate on the FOREX market.  We take the story in the form of one-minute bars and try to predict: will the price go up, or will the price go down?  If there is no certainty in either, then we give an indefinite answer.  The obtained answers are then compared with the real result and we find out if the prediction was correct or not. <br><br>  The MetaTrader 4 or 5 Strategy Tester is suitable as a platform for implementation. The fifth version is more preferable, as it supports Object-Oriented Programming, but it is quite possible to get by with the fourth one. <br><br>  Those who are familiar with the FOREX market and have dealt with Mechanical Trading Systems advisers are well aware of what is at stake.  The tester consistently goes through history, creating trading conditions that are close to reality and gives an assessment of the effectiveness of the adviser. <br><br>  When solving a problem, I implemented my tester in Java, which turned out to be justified for me. <br><br>  Next, we implement the chain construction algorithm and use it for prediction. <br><br>  As a result, it is necessary to conclude: is it possible to forecast in the FOREX market and is the chain building method justified? <br><br><h4>  Strategy testing </h4><br>  When testing, we determine the number of pips of the minimum income (MinProfit), maximum loss (MaxLoss) and set the amount of time for which we want to see the result (FeedbackHours).  The last parameter is the delay between the appearance of the original data and their use in forecasting.  To get closer to real conditions, we also take into account the spread (Spread). <br><br>  The parameters can be varied in a wide range, MinProfit and MaxLoss can be taken different from each other.  When solving the task, the following parameter values ‚Äã‚Äãwere chosen: <br><br>  MinProfit - 200 pips <br>  MaxLoss - 200 pips <br>  FeedbackHours - 24 * 7 hours <br>  Spread - 30 pips <br><br>  The MinProfit and MaxLoss parameters are not taken too long, so that the testing time is not too long.  With such parameters, the strategy will resemble pipsing.  Getting a steady income from pipsing is the dream of almost all traders.  Let's try to help them. <br><br>  The FeedbackHours parameter is chosen not too small, since with a smaller value, the result does not always have time to form.  If we consider that the goal is to search for long-term trends, then we can take large values ‚Äã‚Äãwithout serious consequences.  However, by reducing the waiting time for a result, you can gain an advantage in time. <br><br>  Spread sets a commission for each operation.  The traditional value was chosen, which is quite acceptable for solving the set task.  If desired, it can be taken even zero. <br><br>  When testing, the one-minute story for 2010-2011 was taken from the servers of InstaTrader and MetaQuotes.  It was technically difficult for me to do testing over a wider range (more than two years). <br><br><h4>  Interpretation of results </h4><br>  The accepted values ‚Äã‚Äãset the probability of winning if the price moves randomly at the level of 17/43 (approximately 0.3953). <br><br>  If the expert's advantage is close to this value, then we can say that the efficiency of the method is zero.  Such a result will indirectly indicate that, within the parameters adopted, the behavior of the EURUSD price on the FOREX market is completely random.  To change the situation it is necessary to change the parameters. <br><br>  If the result obtained is less than this value, then the method should be oriented precisely to the contrary.  That is, if the result is ‚ÄúBuy‚Äù, then you need to sell, if you get ‚ÄúSell‚Äù, then you need to buy. <br><br>  If the result is greater than 17/43, then we can say that the method is effective and its development can bring results. <br><br>  But even if the probability of winning is more than 0.5, it will be a mistake to assume that the so-called ‚Äúgrail‚Äù has been found.  The profitable method will spread very quickly and its advantages will be very quickly exhausted ( <a href="http://www.mql5.com/ru/forum/2072">1</a> , <a href="http://www.mql5.com/ru/forum/2176">2</a> ). <br><br>  This, in fact, is the ultimate goal of this work.  If statistical methods no longer justify themselves, then every opportunity for speculation will disappear. <br><br><h4>  rough estimation </h4><br>  First made a rough estimate.  That is, at every step the expert says ‚ÄúBuy‚Äù and ‚ÄúSell‚Äù at the same time.  The resulting gain gives information about trends in price behavior.  If the winning is close to 0.3953, then we can say that there is no certainty.  If it is more than 0.3953, then the price movement is subject to trends, if less, the movement is horizontal. <br><br>  Moreover, if the deviation in one direction or another is large enough, then strategies will be justified in which MinProfit is not equal to MaxLoss. <br><br>  Practical research has shown that in 2010‚Äì2011, a gain of 0.4250 was obtained, which is better than a gain at a random price of 0.0297.  The increase in the gain is quite noticeable, and it was observed throughout the testing time. <br><br>  Hereinafter, the standard deviation value is not given, since it was not calculated.  For all the importance of this parameter, in this evaluation work it was ignored. <br><br>  A rough estimate was also carried out for the period from 2000 to 2011 inclusive and a gain of 0.4212 was obtained.  That is, the price of EURUSD is generally subject to trends, sometimes more, sometimes less. <br><br><h4>  Price analysis </h4><br>  We will conduct a technical analysis, so we will study the form of price movement: bends, inclinations in one direction or another, under this or that angle.  You can attract a variety of different indicators, but in this case we use the Open price chain. <br><br>  For example, let's take the current date of January 4, 2010 and the time is 23:58.  At this time, the opening price was 1.44163.  And in the previous minute, the price was 1.44165, that is, the price changed by -2 points.  A minute earlier, the price was 1.44161, that is, the price has changed by +4 points.  The result is a chain: -2, +4, +3, +5, -6, +6, -2, +0, + 3 ... Chains, if necessary, can be made long. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/033/ec5/b3d/033ec5b3df1ebd9392ce8702167d4e71.png" alt="image"><br><br>  Similarly, you can perform a fundamental analysis.  To do this, we build chains of information coming from the news feed.  Obviously, for carrying out fundamental analysis requires significant computational resources and more complex methods of constructing chains, therefore, we are still not engaged in fundamental analysis. <br><br>  The resulting chains are taken for the quality characteristics of the price.  Next, we count them.  In memory, we search for a longer chain that is observed at a given time.  If nothing is found in the memory, we consider a chain of length 1 (in this case: -1). <br><br>  On the found chain we remember the final result (the price goes up, the price goes down, not determined).  If a certain result is obtained through this chain, that is, the price always goes up or the price always goes down or is not always determined, then leave it so.  Otherwise, we extend the chain by one and remember the current result for it. <br><br>  As a result, we obtain a database in which its behavior is known from the price configuration. <br><br>  To assess the effectiveness of using the resulting database when trading.  If there is a certain result in the current chain in memory, then we put on it.  As a result, in 2010‚Äì2011, a gain of 0.4281 was obtained, which is better than the rough analysis result by 0.0031 and better than the random price gain of 0.0328. <br><br>  The improvement is not very noticeable compared with the result of a rough analysis.  This can be explained by the fact that a relatively small range of price movement is chosen - 200 pips, and the strategy resembles a ‚Äúpipsing‚Äù.  On the other hand, this suggests that the chain building method may not be sufficiently effective and must be changed.  In the meantime, we will be satisfied with the fact that throughout the entire testing period the improvement in the result has been observed steadily. <br><br>  When testing on wider price movements, the expert shows more interesting results.  Even positive profitability is often demonstrated. <br><br>  However, at the stage of building chains, the effectiveness is not ensured, only the study of price behavior is carried out. <br><br><h4>  Signal matching </h4><br>  It is not excluded that in one minute we have a buy signal, and the next - for sale.  Provided that the price has not changed much - what to believe? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/283/c66/750/283c66750ea5594bd575aab8715a2fd2.png" align="left" alt="image">  Problem from the field of game theory.  We are trying to understand which of the signals are correct and which are distracting or even false.  As a result, it is necessary to outplay opponents, in this case, other participants in the FOREX market. <br><br>  We agree on the same principle: we build chains of the last signals, we take into account price changes, we collect statistics on winning. <br><br>  When testing for 2010-2011, a gain of 0.4293 was obtained, which is better than a simple analysis of the price of 0.0012. <br><br>  The increase in winning is almost negligible.  From time to time a very bad result was observed, it was much worse not only the result of a rough estimate, but also a result at a completely random price, that is, less than 0.3953.  Sometimes even the result was about 0.3.  But sometimes very successful periods were observed when the result, with such a high commission, was even at the level of 0.5.  Hence the conclusion - sometimes the expert beats the market, and sometimes the market beats the expert. <br><br>  When testing on wider price movements, the final result may be even worse.  Obviously, with this come into effect more complex combinations that take speculative money.  But the picture is the same - at times there is a significant gain, and at times - a significant loss. <br><br>  Obviously, the algorithm chosen for solving the problem is imperfect, but sometimes it allows improving the result. <br><br>  Further, in order to achieve maximum gain, it is necessary to select the best signals.  This task is the next stage. <br><br><h4>  Signal selection </h4><br>  Selection of signals has not yet been implemented, but there is an idea of ‚Äã‚Äãthe direction in which to move.  It is necessary to calculate the expectation of winning and to choose those chains whose expectation of winning gives hope for the maximum result.  To do this, we collect information on all the encountered chains, and we exclude those of them, whose advantage is below a certain threshold. <br><br>  An attempt was made to produce simple screenings.  A certain parameter is calculated, and if it is less (or more) than the average value, the signal is eliminated.  In some cases, it was possible to get a consistently winning strategy.  But not enough has been done to talk about the maximum result. <br><br>  Observations have shown that the identification of obviously unfavorable conditions is quite possible.  Often the strategy forced the expert to be passive when there was a large loss ratio. <br><br><h4>  Crisis management </h4><br>  Sometimes it happens that a wrong decision was made earlier and this became known later.  If there is still time to correct the situation, then it is necessary to take advantage of this, for example, to close a position before the losses become too great. <br><br><h4>  Conducting prophylaxis </h4><br>  At this stage, we collect statistics on emerging crisis situations and avoid them in advance. <br><br><h4>  An example of a profitable strategy </h4><br>  To demonstrate the effectiveness of the method, I will try to suggest a strategy with a positive expectation of winning.  Take the following parameter values: <br><br>  MinProfit - 300 pips <br>  MaxLoss - 2700 pips <br>  FeedbackHours - 24 * 7 * 4 hours <br>  Spread - 30 pips <br><br>  Due to the fact that in 2007 the result was too often not formed in 4 weeks (the price fluctuated less than 600 pips in the corridor for a long time), 2007 was calculated on the basis of FeedbackHours - 24 * 7 * 8 hours. <br><br>  <i>rough estimation</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/392/e20/2a8/392e202a8009fbdac631b05537721746.gif" alt="image"><br><br>  With such a strategy, a gain can be obtained only when the price moves horizontally and moves with a span of predominantly more than 600 pips, but less than 5400 pips.  From the results it can be seen that the predominantly horizontal price movement was observed only in the post-crisis 2009. <br><br>  <i>Price analysis</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/b08/4e5/9d8/b084e59d8c18e9c5efa7948d2aab7720.gif" alt="image"><br><br>  Price analysis gives an idea of ‚Äã‚Äãthe behavior.  If the behavior does not change with time, then the strategy will be winning.  From the results it can be seen that until 2008, inclusive, price behavior changes almost constantly, which means that strategies based on repeatability movements led to a loss. <br><br>  Perhaps this was the cause of the 2008 crisis, when financial institutions suffered huge losses and when several of the largest banks went bankrupt.  Beginning in 2009, predictability appeared in the price movement, which tends to grow over time.  This may be due to the fact that the scale of stimulating the economy at this time is also growing. <br><br>  <i>Signal matching</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/6f1/07e/f8c/6f107ef8c7bbe9470d614b34b35b03b5.gif" alt="image"><br><br>  Doing signal matching, we are trying to replay other market participants.  The attempt is successful and manages to reach a positive profitability by the results of 12 years.  In the post-crisis years, there has also been a steady positive profitability. <br><br>  <i>Signal selection</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/2e2/e99/bf5/2e2e99bf56d98ca84f00fb1bcb95b9ba.gif" alt="image"><br><br>  As mentioned above, the signal selection algorithm was not implemented, but simple screenings were implemented, in which those situations that were less common than usual were eliminated.  This allowed to improve the result, but according to the results of several years, after all, losses were observed.  Especially high unprofitability was observed in the pre-crisis 2007. <br><br>  Demonstrate even better results possible.  To do this, you can try, for example, to take a minimum profit of 200 pips and a maximum loss of 1800 pips, but more research is needed to find the optimal strategy.  If, however, to carry out crisis management, you can try to reduce losses by increasing total income. <br><br>  It should also be taken into account that in this assessment work, the calculation of many characteristics important for a trader, such as a drawdown, was not perfected.  Nevertheless, a positive expectation of profit is noticeable. <br><br><h4>  findings </h4><br>  The EURUSD price movement in the FOREX market is not accidental and its behavior, in most cases, has a tendency.  This indicates its predictability. <br><br>  The method of building chains allows you to improve the result, but in the described form is imperfect.  But, despite the imperfections, chains allow you to create strategies with a positive expectation of profit. <br><br>  Obviously, the search for causal relationships by statistical methods is justified, but its widespread use will lead to far-reaching consequences.  It will be possible not only to identify and level trends in a timely manner, but also to shape them. </div><p>Source: <a href="https://habr.com/ru/post/143539/">https://habr.com/ru/post/143539/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143529/index.html">Porn company sues Tumblr for copyright infringement</a></li>
<li><a href="../143532/index.html">The long awaited BioShock Infinite is delayed again</a></li>
<li><a href="../143533/index.html">Granny's Dancing on the Table - a new film under Creative Commons</a></li>
<li><a href="../143537/index.html">Physics of innovation</a></li>
<li><a href="../143538/index.html">MR template for writing services on Node.js</a></li>
<li><a href="../143540/index.html">How to scatter windows on desktops after loading</a></li>
<li><a href="../143542/index.html">Runetology (146): Head of Molotok.ru, Igor Tarasenko</a></li>
<li><a href="../143543/index.html">Designing a rotator algorithm by rating</a></li>
<li><a href="../143544/index.html">Word of Dokach</a></li>
<li><a href="../143545/index.html">Mozilla is worried - Windows RT will not be able to choose a browser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>