<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TLS SNI standard distribution</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Experts of Akamai share their observations on the percentage of TLS SNI extensions of the TLS protocol (RFC 4366) in the total amount of encrypted HTT...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>TLS SNI standard distribution</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/7ab/c17/ecf/7abc17ecfa444e8881c6de10b233e0f7.png"></div><br>  Experts of Akamai share their observations on the percentage of <a href="http://www.ietf.org/rfc/rfc4366">TLS SNI</a> extensions of the <a href="http://www.ietf.org/rfc/rfc4366">TLS protocol (RFC 4366)</a> in the total amount of encrypted HTTPS requests. <br><br>  In the past few years, there has been a rapid growth in the number of clients supporting TLS SNI (a standard that makes HTTPS much more scalable).  If at the beginning of 2014 only 85% of client HTTPS requests were made using TLS SNI, today many users of the Akamai service receive up to 99% of requests in the TLS SNI format. <br><a name="habracut"></a><br>  This indicates a global trend of deployment of sites using only SNI.  At the same time, 31% of sites from the Alexa Top 100k rating with valid HTTPS certificates communicate this certificate to the client only if the request is in the TLS SNI format. <br><br><img src="https://habrastorage.org/files/124/c99/579/124c99579e8c493787505cfaa44ef333.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When translating traffic to the HTTPS standard, there were two serious problems: the first was the inaccessibility of the certificates themselves, and the second was the technical difficulties with TLS virtual hosting.  The readily available, self-issued Domain Validation (DV) certificates provided by services like Let's Encrypt solved the first problem.  TLS Server Name Indication (SNI) is a technology that solves the second problem.  Until recently, its widespread implementation was hampered by a large number of customers who did not support this standard. <br><br>  The growing use of TLS SNI proves that it can already be considered a universal standard.  The remaining part of clients, which does not support TLS SNI, can solve this problem for about a year, if it wants to have access to all sites at all.  Especially with the growing use of HTTPS - about half of the pages are already loading over HTTPS, according to Firefox. <br><br>  TLS is at the heart of HTTPS, and encryption and authentication is carried out with it.  When Netscape developed SSL v3 and its fairly successful IETF-standardized descendant of TLS 0.1, they were faced with the fact that virtual hosting was not ready to use them.  For authentication, the client sends the message ‚ÄúClientHello‚Äù to the server and waits for the response ‚ÄúServerHello‚Äù, containing a security certificate identifying the server name.  If the name in the certificate does not match the name that the client expects to receive, a properly configured client should interrupt the connection and display an error message.  But in the case of virtual hosting, one server serves tens, hundreds, thousands, and at least millions of sites, and in this case the server must know which certificate to return to the client. <br><br>  If the ClientHello request does not contain the site name, the server serving HTTPS on port 443, there is nothing left but to allocate for each certificate (and, accordingly, the site) a separate IP.  For CDN services, such as Akamai, deployed in hundreds and thousands of locations, this means that hundreds and thousands of virtual IPs must be allocated for each certificate.  And due to the extremity of the pool of freely issued IPv4, it quickly turns into a fundamental problem that impedes growth and scaling. <br><br>  Identification by Server Name (SNI) was introduced in TLS in 2003 in RFC 3546. This enabled clients to include the name of the server with which they would like to establish a connection in the ClientHello request, enabling the server to understand which named certificate should be communicated to the client in the ServerHello message.  This SNI extension was the very route information that made virtual hosting possible, similar to the routing role of HTTP headers, which were introduced from the very beginning at the time of adopting HTTP / 1.0 in 1997.  In addition, load balancers in data centers are now able to use TLS SNI to distribute traffic sent to the common IP address to the correct back-end servers. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7ab/c17/ecf/7abc17ecfa444e8881c6de10b233e0f7.png"></div><br>  IPv6 and HTTP / 2, of course, could help solve the problem.  HTTP / 2 itself already requires clients to send TLS SNI.  And the virtually infinite IPv6 address space solves the problem of virtual addresses, and for this reason, Akamai introduces dual default addressing for its IPv4 + IPv6 clients since 2016.  But most of those clients that do not support TLS SNI do not support HTTP / 2 and IPv6 either. <br><br>  Inadequate customer acceptance made it difficult to implement TLS SNI in practice.  Previously widespread operating systems, such as Windows XP and Android 2.2, did not support TLS SNI, and the introduction of a strict requirement for an SNI request in the HTTPS protocol would leave them behind.  In 2013, Akamai saw that only 80% of clients support this protocol.  Even in April 2015, only 90% of HTTPS requests contained SNI.  The decrease in the number of clients that do not support this standard is also caused by other reasons that change the overall situation with HTTPS protocols, for example, the discontinuation of SHA-1 certificates. <br><br>  The situation has changed dramatically over the past two years.  Today, Akamai, on average, 98% percent of requests contain client-side TLS SNI.  However, most non-SNI-compliant clients are separate applications that have been developed privately and use old protocols on their individual routes.  Therefore, the median participant of the HTTPS exchange, the equipment that gives the client a certificate, is already seen by 99% of requests including SNI.  And 12% of such points already see 99.9% of the traffic with SNI authentication. <br><br>  If we exclude from consideration China, where SNI is used to a much lesser extent, and the United States, where there are a number of bots / agents that do not support SNI, the median participant, based on a sample of Akamai service users, will see 99.4% of requests containing SNI.  Even in the USA, the median participant sees 98.4% of SNI containing queries. <br><br>  If we take a closer look at clients who do not use SNI, then, according to Akamai, these include: <br><br><ul><li>  Current clients that use HTTPS traffic by intermediate proxies, for example, to exercise parental control or control corporate network traffic.  These intermediate proxies degrade the reliability of TLS encryption, and the logic of their work, which forces them to substitute server names, is contrary to the SNI ideology.  In addition, often these systems do not check certificates at all. <br><br></li><li>  The remaining systems are running Windows XP and even older versions of the OS.  It is not quite clear how they even connect after the cancellation of SHA-1, but perhaps they are also behind intermediate proxies that do not ask for certificates. <br><br></li><li>  Some bots / robots owned by search engines.  We contacted some of the top lines of the top lists, and they said that in the near future they would still introduce TLS SNI, too.  It seems that there are many benign and malicious bots that continuously scan the entire IPv4 space in search of HTTPS servers. <br><br></li><li>  Various clients and bots, written on the basis of old versions of WebKit, Java, curl and python.  Yes, and those customers who use more recent versions of these libraries should still have implemented mechanisms for proper initialization of the exchange based on TLS SNI.  This includes a wide range of clients - from malware to various headless browsers to analyze the performance of sites. <br><br></li><li>  Some private applications (download managers, applications for game consoles, some mobile applications).  They are usually isolated on certain sites. </li></ul><br>  Some sites wanted to switch to TLS SNI completely and were ready to lose from 10% to 20% of visitors.  Now, the transition to TLS SNI ‚Äúcuts off‚Äù only 1% of visitors, who are mostly bots, malware and insecure clients, so there will be much more people willing to switch to TLS SNI.  Let's Encrypt issued about 27 million free certificates, prompting a significant number of site operators to switch to HTTPS.  From the end of 2015, Akamai issues only TLS SNI-supporting certificates as part of its package offerings, prompting the sites to switch to this standard and, in fact, reserve for the future - forcing their potential users to also switch to TLS SNI. <br><br>  The transition to using SNI exclusively is already underway.  Today, approximately 75% of sites from Alexa top 1000 are accessible via the HTTPS protocol, 12% of them use only TLS SNI (that is, they report a certified certificate only in response to an SNI request).  Among the Alexa top 100k sites, only 55% use HTTPS, but among them, 31% are exclusively in the SNI format, despite the fact that many of them are still available via HTTP. <br><br>  The more sites will require TLS SNI, the more pressure customers will experience when they are forced to implement the SNI mechanism in their protocols.  The decrease in the number of non-SNI clients encourages websites to switch to new certificates faster, and this, in turn, causes non-SNI clients to switch to TLS SNI, just as it was at one time, in fact, with HTTPS as such. <br><br>  The trend is obvious: TLS SNI is becoming universal, generally accepted and, possibly, even the ‚Äúdefault‚Äù standard in HTTPS.  Client software developers should understand this and bear in mind the need for the correct implementation of this protocol in their packages. </div><p>Source: <a href="https://habr.com/ru/post/327410/">https://habr.com/ru/post/327410/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327400/index.html">C ++ Russia 2017 videos are available online.</a></li>
<li><a href="../327402/index.html">Do advertising on the Internet - quickly or correctly?</a></li>
<li><a href="../327404/index.html">Sending service messages to whatsapp via yowsup2 using http-get method, including Bacula backup server reports</a></li>
<li><a href="../327406/index.html">Features of the development of mobile MMO RTS. Part 5</a></li>
<li><a href="../327408/index.html">Why I don't want to program in Perl anymore</a></li>
<li><a href="../327412/index.html">DentalTap Service Overview - Business and Communication sections</a></li>
<li><a href="../327414/index.html">Restore 1C Enterprise (DBF) after formatting</a></li>
<li><a href="../327416/index.html">A systematic approach to testing Android applications, or what the developers were silent</a></li>
<li><a href="../327418/index.html">From Oracle to PostgreSQL - a 4-year path, a report by Andrei Rynkevich</a></li>
<li><a href="../327420/index.html">Already this year: Google plans to create a quantum computer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>