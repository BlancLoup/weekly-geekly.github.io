<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Duqu: Stuxnet's story continues ...</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Over the past few days, a lot of attention has been focused on the Win32 / Duqu malware. The fact is that by the characteristics of its implementation...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Duqu: Stuxnet's story continues ...</h1><div class="post__text post__text-html js-mediator-article">  Over the past few days, a lot of attention has been focused on the Win32 / Duqu malware.  The fact is that by the characteristics of its implementation Win32 / Duqu is similar to the well-known Win32 / Stuxnet.  Last year, we conducted a rather detailed analysis of the Win32 / Stuxnet worm, which resulted in the <a href="http://go.eset.com/us/resources/white-papers/Stuxnet_Under_the_Microscope.pdf">Stuxnet Under the Microscope</a> research report.  And now we are exploring Win32 / Duqu, having studied the modules and mechanisms for their operation, it can be argued that this malware is based on the same source codes or libraries as Win32 / Stuxnet itself.  Perhaps this is not even just the source code, but a framework for developing malware or cyber weapons.  The recovered Duqu driver code reminded us very much of what we already saw in Stuxnet.  These drivers are almost identical to what we saw last fall. <br><a name="habracut"></a><br>  From the moment we began to investigate Win32 / Duqu, we were interested in the question of how to identify the exact date of infection of a computer with this malware.  Such information is primarily useful for conducting forensic examination and restoring the picture of what happened.  We had an idea that if Duqu stores information about the moment of its self-removal, then there must be information with which this counting begins.  We managed to find an interesting thing, at the moment we have several sets of samples from various infected machines.  It turned out that during the infection process, the so-called main.dll is formed (the main component in the resources section of which other components are stored), in which the exact date of the infection is stored in UTC-format.  Below we provide the decompiled code that performs date verification: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0d2/d47/c09/0d2d47c09c9eef6d99802cb9b47db8d0.png" alt="image"><br><br>  Based on these data in the process of conducting a forensic examination of an infected machine, it is possible to establish the exact date and time of its infection. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The Duqu: the precursor to the next Stuxnet report lists Duqu's lifetime on an infected machine for 36 days, after which it is automatically deleted.  In order to find out the date of infection, you first need to decrypt the configuration files using a non-clever artisanal cryptoalgorithm: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dfa/d54/29d/dfad5429d8c5ef6466a72f09d8566bda.png" alt="image"><br><br>  After examining several sets of samples, we found that this date may change and most likely is set during the infection process based on the dropper configuration data.  We have one set of samples should have been removed in the same way after 36 days, but the second only after 30. <br><br>  The configuration file of infection 11/08/2011 at 7:50:01 and deletion after 36 days: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/933/506/e29/933506e2908ebcfa2259065c62d5fa8e.png" alt="image"><br><br>  The configuration file of infection on 18/08/2011 at 7:29:07 and deletion after 30 days: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bdf/bce/cfc/bdfbcecfcde66c3bd3595f6579292a94.png" alt="image"><br><br>  Duqu still contains many interesting technical details, and we continue our research. </div><p>Source: <a href="https://habr.com/ru/post/131304/">https://habr.com/ru/post/131304/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../131298/index.html">Subtext: communication in the pages of books</a></li>
<li><a href="../131299/index.html">SITH - CSS3 technology for smooth image change</a></li>
<li><a href="../131300/index.html">SQL Server 2008: backup wisely. Part 1: Theory</a></li>
<li><a href="../131301/index.html">Abnormal behavior of Flash Player 11 depending on whether debug player or not</a></li>
<li><a href="../131302/index.html">Megafon 3G modem + linux modifies sudoers</a></li>
<li><a href="../131305/index.html">Almost perfect scheme of fraud using Webmoney</a></li>
<li><a href="../131306/index.html">It's cold in hell today: Firefox from Microsoft</a></li>
<li><a href="../131307/index.html">The release of the kernel Linux 3.1</a></li>
<li><a href="../131308/index.html">Will 3D printing change the world?</a></li>
<li><a href="../131309/index.html">Google Nexus One is not likely to get updates to Android 4.0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>