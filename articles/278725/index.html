<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>First extortionist discovered for Apple OS X</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Experts from Palo Alto Networks discovered the first real extortionist (ransomware) for Apple OS X. The malware was named KeRanger and is detected by ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>First extortionist discovered for Apple OS X</h1><div class="post__text post__text-html js-mediator-article">  Experts from Palo Alto Networks <a href="http://researchcenter.paloaltonetworks.com/2016/03/new-os-x-ransomware-keranger-infected-transmission-bittorrent-client-installer/">discovered the</a> first real extortionist (ransomware) for Apple OS X. The malware was named KeRanger and is detected by our anti-virus products as <b>OSX / Filecoder.KeRanger.A</b> .  KeRanger is a <i>crypto-ransomware</i> or <i>filecoder type</i> that specializes in encrypting user files with a further demand for decryption. <br><br><img src="https://habrastorage.org/files/d61/414/0e1/d614140e1c1b495cbfac9995086d3689.png"><br><br>  To spread a malicious program, attackers chose an effective way to compromise software distributions called Transmission for OS X. This program is a simple, freely available BitTorrent client.  A few days ago, two Transmission v2.90 distributions were compromised by KeRanger and distributed on the client‚Äôs official website.  Since Transmission is free software, attackers could simply compile a special backdoored version and replace it with the developer‚Äôs server.  In addition, the compromised distribution was signed by a legitimate digital developer certificate for Mac. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/files/ddd/3b2/e4b/ddd3b2e4ba8641d2b9e3a5deaed4efa6.png"><br>  Fig.  Compromised Transmission distribution on the official website.  <i>(Palo Alto Networks data)</i> <br><br>  Since the file is provided with a legitimate digital signature, malware can successfully bypass the Apple Gatekeeper security software check.  After installing the compromised application, malicious code is activated on the user's computer.  After that, KeRanger waits for three whole days before the first connection with its C &amp; C server manager, using an anonymous Tor network.  Such a trick masks the presence of the extortioner after the direct compromise of the user. <br><br>  After connecting to C &amp; C, KeRanger initiates the process of encrypting certain types of user files on the computer.  To decrypt files, attackers require a one-bitcoin ransom (about $ 400).  In addition to this, KeRanger tries to encrypt backup files to prevent the user from being able to recover his data from them. <br><br><img src="https://habrastorage.org/files/08a/555/307/08a555307b934afa82ddfee8b31447d6.png"><br>  Fig.  Information about the digital signature of the malicious distribution.  The files were signed on March 4th.  <i>(Palo Alto Networks data)</i> <br><br>  As we already mentioned, both of the compromised distributions were signed with a legitimate digital certificate issued by Apple.  The developer ID in this digital certificate is "POLISAN BOYA SANAYI VE TICARET ANONIM SIRKETI (Z7276PX673)", which differs from the similar identifier used to sign previous legitimate versions of Transmission. <br><br>  The compromised distribution kit contains an additional file called General.rtf, located on the Transmission.app/Contents/Resources path.  This file is an executable Mach-O format, but to hide it, it uses the RTF document icon.  The executable file is packaged using UPX version 3.91.  When a user launches infected distributions for execution, the built-in legitimate Transmission.app/Content/MacOS/Transmission application copies the General.rtf file to the ~ / Library / kernel_service location and executes the ‚Äúkernel_service‚Äù file before the user starts using the GUI. <br><br><img src="https://habrastorage.org/files/c7a/814/c2b/c7a814c2b3ec420fa37bc009d2d8221d.png"><br>  Fig.  Badges of malicious objects in the distribution.  <i>(Palo Alto Networks data)</i> <br><br><img src="https://habrastorage.org/files/cb2/77a/a41/cb277aa4185c448da8c7f290a50233c1.png"><br>  Fig.  The KeRanger code executes referred to General.rtf, which specializes in file encryption and ransom requests.  <i>(Palo Alto Networks data)</i> <br><br>  The malware specializes in encrypting more than three hundred file types, including the following: <br><br><ul><li>  Documents: .doc, .docx, .docm, .dot, .dotm, .ppt, .pptx, .pptm, .pot, .potx, .potm, .pps, .ppsm, .ppsx, .xls, .xlsx, .xlsm, .xlt, .xltm, .xltx, .txt, .csv, .rtf, .tex </li><li>  Images: .jpg, .jpeg </li><li>  Audio and video: .mp3, .mp4, .avi, .mpg, .wav, .flac </li><li>  Archives: .zip, .rar., .Tar, .gzip </li><li>  Source code: .cpp, .asp, .csh, .class, .java, .lua </li><li>  Databases: .db, .sql </li><li>  Emails: .eml </li><li>  Certificates: .pem. </li></ul><br><img src="https://habrastorage.org/files/e87/887/0be/e878870bef2b4d57b955b3c011d22c8c.png"><br>  Fig.  Request for ransom, which was received by the extortionist from the C &amp; C server.  <i>(Palo Alto Networks data)</i> <br><br>  Encrypted KeRanger files receive the additional extension .encrypted to the already existing name.  To encrypt files, a procedure similar to Windows encryption is used; that is, it uses symmetric AES and asymmetric RSA encryption algorithms.  The encryption function is listed below.  To decrypt files, you need to get a private RSA key, with which you can decrypt the symmetric AES key stored in the body of each file. <br><br><img src="https://habrastorage.org/files/bc7/2f1/f5c/bc72f1f5cf97445098ed750a464e9642.png"><br>  Fig.  File encryption feature using AES. <br><br>  <b>Conclusion</b> <br><br>  The digital certificate that was used to sign the malicious files has already been revoked by Apple, and the security software Gatekeeper already detects the KeRanger files.  The authors of the Transmission Project were also notified of the incident and the compromised distributions were deleted from the server.  Apple added KeRanger signatures to its XProtect security tool, with the corresponding updates automatically received by Macs. </div><p>Source: <a href="https://habr.com/ru/post/278725/">https://habr.com/ru/post/278725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278701/index.html">Foreach - from the book PowerShell in depth</a></li>
<li><a href="../278705/index.html">AMD fixes microprocessor microcode vulnerability</a></li>
<li><a href="../278709/index.html">Conferences in 3CX Phone System</a></li>
<li><a href="../278711/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ201 (March 1 - 6, 2016)</a></li>
<li><a href="../278713/index.html">Everything you need to know about Unity 5, UWP applications and March 8</a></li>
<li><a href="../278729/index.html">Kibana-mother or Why do you need logs at all?</a></li>
<li><a href="../278731/index.html">Choosing a library to work with WebGL</a></li>
<li><a href="../278735/index.html">Ruby on Rails. Passenger quickstart</a></li>
<li><a href="../278737/index.html">The story about cunning ... Indian, encrypted procedures, DAC and "God mode"</a></li>
<li><a href="../278741/index.html">Gorgeous Six: girls who had a thermonuclear blast counted</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>