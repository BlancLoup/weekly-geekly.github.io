<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What the neural network saw on the first photo of a black hole</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Friends, many probably remember the images of the black hole that shocked everyone in April of this year. We found a very interesting material, in whi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What the neural network saw on the first photo of a black hole</h1><div class="post__text post__text-html js-mediator-article">  Friends, many probably remember the images of the black hole that shocked everyone in April of this year.  We found a very interesting material, in which we will talk about what the algorithms of artificial intelligence ‚Äúthink‚Äù about the image of a black hole.  With the translation of this material, we continue the series of publications dedicated to the launch of the course <a href="https://otus.pw/avid/">‚ÄúNeural networks in Python‚Äù</a> .  We warn you, the material turned out to be more entertaining than informational, but these images are definitely worth seeing.  Go. <br><br><img src="https://habrastorage.org/webt/8j/sh/jj/8jshjjmsaffjfpythqwm4zj8wpe.png"><br><br>  On April 11, scientists and engineers from the Event Horizon telescope team made a real breakthrough in understanding the processes that take place in outer space.  They presented the first image (photo) of the black hole.  This further strengthened Einstein‚Äôs general theory of relativity, namely the hypothesis that ‚Äúmassive objects cause distortion in space-time, which is reflected in the form of gravitational changes‚Äù. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Well, I am not a physicist or an astronomer to understand or explain how this works, but I, like millions of people working in various fields, are fascinated by the cosmos and especially the phenomenon of black holes.  The first image of a black hole caused a wave of delight around the world.  I am a deep learning specialist who mainly works with convolutional neural networks, and it became interesting to me that artificial intelligence algorithms ‚Äúthink‚Äù about the image of a black hole.  That is what we will talk about in the article. <br><br>  This passage from <a href="https://www.theepochtimes.com/historic-image-of-black-hole-said-to-prove-einsteins-theory-of-relativity_2876829.html">the Epoch Times</a> describes a black hole like this: ‚ÄúBlack holes consist of‚Äú a large amount of matter packed in a very small space ‚Äù, mostly formed from‚Äú remnants of a large star that died during a supernova explosion. ‚ÄùBlack holes are so strong gravitational field that even light cannot avoid it.  The resulting image of the black hole M87 is shown below.  This phenomenon is well explained in the article <a href="https://www.vox.com/science-and-health/2019/4/11/18306110/first-image-black-hole-eht-event-horizon-singularity">‚Äúaccording to 2 astrophysicists‚Äù</a> . <br><br><img src="https://habrastorage.org/webt/gs/nb/0p/gsnb0phqngbnxbjlcvq8luifema.png"><br>  <i>Black Hole - M87 - Event Horizon Telescope</i> <br><br><img src="https://habrastorage.org/webt/w1/x_/av/w1x_aviwkbyf5p7qtlvy847ques.png"><br><br>  <i>Different areas of the black hole.</i>  <i><a href="https://www.youtube.com/watch%3Ftime_continue%3D379%26v%3DpAoEHR4aW8I">Screenshot from vox video - Why this black hole photo is such a big deal</a></i> <br><br>  <b>1. What does CCN see on the black hole image?</b> <br><br>  CCN (Convolution Neural Network) - convolutional neural networks - a class of deep learning algorithms that are extremely effective in recognizing objects in the real world.  CCN is the best neural network for image interpretation and recognition.  Such neural networks are trained on millions of pictures and trained to recognize about 1000 different objects of the surrounding world.  I thought about showing the image of a black hole to two trained convolutional neural networks and see how they recognize it, what object of the world around it the black hole looks like the most.  This is not the wisest idea, since the black hole image was generated by combining various signals received from space using special equipment, but I just wanted to know how the picture would be interpreted without any additional information about the signals. <br><br><img src="https://habrastorage.org/webt/f4/h1/nq/f4h1nqbo52-rnqhn6b2pikkkl5w.png"><br>  <i>Neural Network Prediction VGG-16 - Match</i> <br><br><img src="https://habrastorage.org/webt/es/bu/dg/esbudgztfeyyhlgviplxi1tvz7c.png"><br>  <i>Neural Network Prediction VGG-19 - Match</i> <br><br><img src="https://habrastorage.org/webt/ob/gt/nk/obgtnkongvpjq7tmmevhxwntw7q.png"><br>  <i>ResNet-50 Neural Network Prediction - Candle</i> <br><br>  As we see in the above images, the trained VGG-16 and VGG-19 see the black hole as a match, and ResNet-50 thinks it is a candle.  If we draw an analogy with these objects, we will understand that it has some meaning, since both the burning match and the candle have a dark center surrounded by a dense bright yellow light. <br><br>  <b>2. What signs did CCN extract from the black hole image</b> <br><br>  I did one more thing, I visualized that they generate intermediate layers of VGG-16.  The deep learning networks are called deep because they have a certain number of layers, and each of them processes the presentation and features of the image at the input.  Let's see what the different layers of the network recognize from the incoming image.  The result was pretty beautiful. <br><br><img src="https://habrastorage.org/webt/zw/i8/eb/zwi8ebtigrz5mbqeqqjgr78esn8.png"><br>  <i>64 feature maps of the first convolutional layer VGG-16</i> <br><br>  If you take a closer look, you will see that a small bright area is a strong symptom, and that it is absorbed after passing through most filters.  Some interesting filter output is shown below, and they already really look like some kind of celestial object. <br><br><img src="https://habrastorage.org/webt/x9/rb/qq/x9rbqqgbkerobilpnnj_6n5y3ii.png"><br>  <i>4 of 64 feature maps of the first convolutional layer</i> <br><br><img src="https://habrastorage.org/webt/1r/oq/em/1roqemadoo5sc4yfdzapffcxs8g.png"><br>  <i>64 feature maps of the second convolutional layer VGG-16</i> <br><br>  Increase the scale of some interesting feature maps of the second layer of the neural network. <br><br><img src="https://habrastorage.org/webt/mx/c8/t6/mxc8t6bhobqs2hfgdfx9qotzhsm.png"><br>  <i>6 of 64 feature maps of the second convolutional layer</i> <br><br>  Now we will go even deeper and look at the third convolutional layer. <br><br><img src="https://habrastorage.org/webt/qb/5g/ir/qb5girdp83lu2x1hukhmytcjkoe.png"><br>  <i>128 feature maps of the third convolutional layer VGG-16</i> <br><br>  After approaching, we find a familiar drawing. <br><br><img src="https://habrastorage.org/webt/zp/03/2h/zp032hluvfctmjnne9q0xr0ezoa.png"><br>  <i>8 of the feature maps presented above on the third layer</i> <br><br>  Moving deeper, we get something like this. <br><br><img src="https://habrastorage.org/webt/tq/hx/bf/tqhxbfgfrm4ngcn4lbleyzk9aqs.png"><br>  <i>6 of 128 feature maps with 4 convolutional layers VGG-16</i> <br><br>  Going deeper, we get higher level abstract information, and when we visualize the 7th, 8th and 10th layers of convolution, we will see only high-level information. <br><br><img src="https://habrastorage.org/webt/67/w2/nq/67w2nq6c77rswgp7pirabi3ygv8.png"><br>  <i>Map of signs of the 7th convolutional layer</i> <br><br>  As we can see, many of the feature maps are dark and only learn specific high-level features necessary for recognizing this class.  In the deeper layers, they become more noticeable.  Now we zoom in and take a look at some filters. <br><br><img src="https://habrastorage.org/webt/te/70/-j/te70-ju3qtx7ha4ubdlebknprty.png"><br>  <i>6 feature cards</i> <br><br>  Now consider 512 feature maps of the 10th convolutional layer. <br><br><img src="https://habrastorage.org/webt/lp/p5/ez/lpp5ezrj0nagikmxjmhea9fdj_c.png"><br>  <i>Character maps of 10 convolutional layer.</i> <br><br>  Now you see that in most of the feature maps received, only the area of ‚Äã‚Äãthe picture is taken as a feature.  These are high-level signs that are visible to neurons.  Let's take a closer look at some of the feature maps listed above. <br><br><img src="https://habrastorage.org/webt/d8/zb/wh/d8zbwh1jq3tctobr83xquyafnxm.png"><br>  <i>Some of the feature maps of the 10 convolution level increased in size</i> <br><br>  Now that we have seen that CCN is trying to isolate a black hole from an image, we will try to transfer this image to the input to other popular neural network algorithms, such as Neural Style Transfer and DeepDream. <br><br>  <b>3. We try Neural Style Transfer and Deep Dream on the image of a black hole</b> <br><br>  <i>Neural style transfer</i> is a smart neural network that gives the ‚Äústyle‚Äù of one image to another source image and ultimately creates an artistic image.  If you still do not understand, the images below will explain the concept.  I used the site <i><a href="https://deepdreamgenerator.com/">deepdreamgenerator.com</a></i> to create various artistic images from the original image of a black hole.  Pictures turned out pretty interesting. <br><br><img src="https://habrastorage.org/webt/ti/li/xc/tilixcoaches3m1oeft0_feuxh4.png"><br>  <i>Transfer of style.</i>  <i>Images generated with deepdreamgenerator.com</i> <br><br>  <i>DeepDream</i> is a computer vision program created by Google engineer Alexander Mordvintsev that uses a convolutional neural network to search for and improve patterns in images using algorithmic paradolia, thus creating a hallucinogenic image from intentionally processed images. <br><br><img src="https://habrastorage.org/webt/1a/mu/hs/1amuhs5f5ixbxq1emqtj8o5jpe4.png"><br>  <i>Deep Dream.</i>  <i>Images generated with deepdreamgenerator.com</i> <br><br>  In <a href="https://www.youtube.com/watch%3Fv%3DSCE-QeDfXtA">these</a> Deep Dream <a href="https://www.youtube.com/watch%3Fv%3DSCE-QeDfXtA">videos,</a> you will see how much hallucinating images she can create. <br><br>  That's all!  I was extremely shocked when I saw the first photo of the black hole, and immediately wrote this little article.  The information in it may not be as useful, but the images created during its writing and shown above are completely worth it.  Enjoy the photos! <br><br>  Write in the comments, as you material.  We are waiting for everyone at <a href="https://otus.pw/LNyk/">the open door</a> on the course <a href="https://otus.pw/avid/">"Neural networks in Python"</a> . </div><p>Source: <a href="https://habr.com/ru/post/452646/">https://habr.com/ru/post/452646/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452624/index.html">Introduction to Spring Boot Actuator</a></li>
<li><a href="../452636/index.html">‚ÄúI am inevitability myself‚Äù: how do ecosystems appear and what can we expect from them</a></li>
<li><a href="../452638/index.html">How we launched 2GIS under CarPlay and are still unraveling</a></li>
<li><a href="../45264/index.html">SearchWiki</a></li>
<li><a href="../452644/index.html">DevConf X Web Developers Conference - June 21</a></li>
<li><a href="../452648/index.html">PHP: How to parse a complex XML file and not drown in your own code</a></li>
<li><a href="../45265/index.html">Convenient Backup</a></li>
<li><a href="../452652/index.html">Security Week 21: a hole in Whatsapp, a new vulnerability in Intel processors, Zero-Day in Windows</a></li>
<li><a href="../452662/index.html">HPE Servers at Selectel</a></li>
<li><a href="../452668/index.html">How to check cookies for compliance with GDPR - a new open tool will help</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>