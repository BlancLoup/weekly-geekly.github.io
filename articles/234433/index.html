<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A magic object for storing and transmitting heterogeneous data with type and value checking</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In PHP, for storing and transferring heterogeneous data (component configurations, parameter sets for functions, options for widgets, etc.) arrays are...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A magic object for storing and transmitting heterogeneous data with type and value checking</h1><div class="post__text post__text-html js-mediator-article">  In PHP, for storing and transferring heterogeneous data (component configurations, parameter sets for functions, options for widgets, etc.) arrays are usually used - their versatility and ease of use greatly contributes to this, but this causes the following problems: <br><br><ol><li>  When developing even in advanced IDE (development systems) and when executing an application, there is no control over the structure and data types in the array. </li><li>  IDE can do nothing to help with development, so that the names of possible array keys will have to be remembered-typed or somewhere searched-copied-pasted, which, apart from inconvenience and poor performance, increases the likelihood of a typo. </li><li>  It is difficult to control where the individual elements of this array are used and, accordingly, it is difficult to refactor, even despite the power of modern IDEs. </li></ol><br><br>  For small projects, these problems may still be insignificant, it is easier to control everything there, but as the amount of code grows, they become more noticeable. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      One of the well-known approaches that solves problems 2 and 3 is the creation of objects based on such pseudo-classes extending stdClass.  The class properties described in PHPDoc and specifying wherever an object of its class is used (in PHPDoc) allows the autocomplete to work and check possible property names, control where properties are applied and, if necessary, easily refactor them: <br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> integer $integer * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> integer[] $integers */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataStorage</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extend</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stdClass</span></span></span><span class="hljs-class"> </span></span>{ } $ds=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataStorage; $ds-&gt;integer=<span class="hljs-number"><span class="hljs-number">13</span></span>; $ds-&gt;integers=[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>];</code> </pre> <br>  But the problem with the control of values ‚Äã‚Äãis not solved this way, the IDE does not control the data that came from outside, not to mention that someone can ignore a warning in the IDE, as a result, incorrect data can lead to an unexpected error in an unexpected place.  In addition, as far as I know, PHPDoc does not yet allow you to specify a list of possible property values, which is often important. <br><br><h5>  <b>Add some PHP magic: StrictDataStorage</b> </h5><br>  Not finding a suitable solution to these problems, I developed a class that allows you to perform data checking based on PHPDoc, while also checking the values ‚Äã‚Äãas an additional bonus by the list of possible ones.  The class works similarly to the solution given above with stdClass - a class inherited from StrictDataStorage is created and its <code>@property</code> types are described in PHPDoc via <code>@property</code> .  When assigning values ‚Äã‚Äãto properties, values ‚Äã‚Äãare checked for compliance with the type described and by the result of the check, either an assignment occurs or an error handler is triggered ‚Äî an exception is thrown by default.  When checking supports all phpdoc data types except callable, the enumeration of several possible types through |  and arrays described by [] at the end of the type. <br>  In addition to the <code>@property</code> element, <code>@enum</code> and <code>@options</code> . <br><br><h6> <code>@enum</code> </h6> <br>  Allows you to specify a list of possible values ‚Äã‚Äãfor the property.  The study of information available on the Internet has led to the conclusion that there is currently no standard or even an agreement on this issue, so for the time being it has come up with its own version that does not conflict with <code>@property</code> .  The <code>@enum</code> syntax <code>@enum</code> similar to <code>@property</code> - first comes the description of possible values, then the name of the property.  Possible values ‚Äã‚Äãare specified in two ways. <br><ol><li>  A list in square brackets - the contents of the brackets can be disassembled via json_decode (), therefore it should be in format, which means, first of all, the use of double quotes for framing strings. </li><li>  By the name of the class in which the values ‚Äã‚Äãare stored, this class must support the EnumArrayableInterface interface, which lies in the same repository. In principle, SplEnum support can be made. </li></ol><br><br><h6> <code>@options</code> </h6> <br>  Contains class operation settings separated by commas, currently two values ‚Äã‚Äãare supported: <br><ul><li>  <b>PhpDocNotRequired</b> - by default, if the property is not described by the <code>@enum</code> or <code>@property</code> element, then it is impossible to assign a value to it, the presence of PhpDocNotRequired in <code>@options</code> includes a less strict verification mode - the <code>@options</code> . Property.  assigned even if not described.  This mode allows you to describe only those properties for which value checking is important. </li><li>  <b>StrictNumberTypeCheck</b> - by default, if a property is described as an <i>integer</i> or <i>float</i> , then strings containing numbers are also tested, as is commonly used in PHP, adding StrictNumberTypeCheck to <code>@options</code> activates a more strict mode of checking numbers - the strings will not pass! </li></ul><br><br><h5>  <b>Example</b> </h5><br>  The class StrictDataStorage is laid out here <a href="https://github.com/Yannn/php-strict-data">github.com/Yannn/php-strict-data</a> , as it works I will illustrate with the example of the successor SampleDataStorage given in the same place: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> integer $integer * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> Closure $callback * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> mixed $mixed * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> integer[] $integers * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@enum</span></span></span><span class="hljs-comment"> SampleEnum[] $integers * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> float|string $enumFloat * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@enum</span></span></span><span class="hljs-comment"> ["1.8","7","9"] $enumFloat * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> string[] $enumArray * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@enum</span></span></span><span class="hljs-comment"> ["one","two"][] $enumArray * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@options</span></span></span><span class="hljs-comment"> PhpDocNotRequired|StrictNumberTypeCheck */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SampleDataStorage</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StrictDataStorage</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre><br>  Since  specified <code>@options PhpDocNotRequired</code> for an object of the <i>SampleDataStorage</i> class <i>you</i> can assign a value to any property, but if you assign the properties $ integer, $ callback, $ mixed, $ integers, $ enumFloat, $ enumArray, the values ‚Äã‚Äãwill be checked according to the rules described in <code>@property</code> and <code>@enum</code> : <br><ul><li>  The value of <b>$ integer</b> db.  necessarily an integer, if you remove the value <i>StrictNumberTypeCheck</i> from <code>@options</code> , you can assign a string containing an integer. </li><li>  The value of <b>$ callback</b> db.  necessarily closure, i.e.  an object of type Closure. </li><li>  The value of <b>$ mixed</b> m.  Any - the type is not checked. </li><li>  The value of <b>$ integers d.</b>  array of integers, while the list of possible values ‚Äã‚Äãof the elements of the array will be obtained by the <i>getEnumValues ‚Äã‚Äã()</i> method from <i>SampleEnum</i> . </li><li>  The value of <b>$ enumFloat d.</b>  a fractional number or a string, with possible values ‚Äã‚Äãlisted in the list <code>["1.8","7","9"]</code> . </li><li>  The value of <b>$ enumArray should</b> be.  array of strings, while the possible values ‚Äã‚Äãof the elements of the array are listed in the list <code>["one","two"]</code> . </li></ul><br>  If the value does not correspond to the specified rules, an exception will be raised.  Methods that handle errors are implemented as protected, so that the behavior when an error is easily changed by inheritance. <br><br><h5>  <b>Compatibility Requirements</b> </h5><br>  Since  I have been using PHP 5.4 for a long time, and the class requires PHP&gt; = 5.4; there seems to be no other special requirements. <br><br>  I would be happy for comments, suggestions and of course bugreports. </div><p>Source: <a href="https://habr.com/ru/post/234433/">https://habr.com/ru/post/234433/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234415/index.html">Complain about health: as we understood that the main thing is support</a></li>
<li><a href="../234417/index.html">Some interesting and useful things for web developer # 26</a></li>
<li><a href="../234427/index.html">Bookmarklet: Analysis of Essential Points, Part One</a></li>
<li><a href="../234429/index.html">Doctors from Peking University for the first time implanted a vertebra printed on a 3D printer to a man</a></li>
<li><a href="../234431/index.html">Interorbital tug</a></li>
<li><a href="../234437/index.html">Low-cost multi-camera FullHD video recording of the concert with their own hands</a></li>
<li><a href="../234439/index.html">Run objective-c code on Android devices</a></li>
<li><a href="../234441/index.html">How I built a network in Astrakhan for 9 years</a></li>
<li><a href="../234443/index.html">Running VMWare images on real hardware and other nuances of Zalman VE-300</a></li>
<li><a href="../234447/index.html">How to make background-size work in old IE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>