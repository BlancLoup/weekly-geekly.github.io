<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Goodbye XML-build ... Hello Rake!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 

 Today ( Monday, April 26th, 2010 at 8:54 am? Approx. Transl. ) I once again tweeted that I am not a fan of build systems for projects ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Goodbye XML-build ... Hello Rake!</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br><br>  Today ( <i>Monday, April 26th, 2010 at 8:54 am? Approx. Transl.</i> ) I once again tweeted that I am not a fan of build systems for projects based on XML.  Yes, I understand why they are needed.  Yes, they were good in their time.  And yes, I still use them every day.  But despite all this, I believe that there are more convenient ways to solve this problem.  The most frequent answer to my tweet was the words: ‚ÄúWell, what‚Äôs the alternative?‚Äù One of the most important things life has taught me is that you shouldn‚Äôt complain about anything until you have nothing to offer in return.  So here and now I will propose an alternative solution ... <br><a name="habracut"></a><br><h4>  Problem </h4><br><br>  Before we dive into the discussion, let me ask you a question ... what do the developers ( <i>programmers, approx. Transl.</i> ) Do best at?  I'll answer for myself: <b><a href="http://habrahabr.ru/post/127874/">write code</a></b> .  In that case, why should we twist our brains by cramming multi-letters into monstrous XML files?  Why can't we just write code?  It is usually said that XML-based applications make it easier to make changes without recompiling, have more flexibility, and make it easier to write tools, because  they are based on a format that everyone understands.  But personally, I really do not think this tool is so valuable.  For me, this is more likely just remnants of former hysteria about XML, which took place in the programming world a few years ago.  Who has been working with such assembly systems for several years can confirm that at first they looked ridiculous and stupid. <br>  People are so enthusiastic about glorifying XML that they forget to point out what we are losing by starting to write code in XML.  For example, what about all those tools that our industry has spent so much time improving.  We lose our usual editors, debuggers, libraries, and other tools only to take advantage of several minor advantages that XML has.  Not every task can be described in XML.  After all, XML files are simply a configuration system for code that runs in its background.  In the end, we still return to writing scripts that run through the configuration in XML. <br>  So what is the advantage of XML?  Can we parse it easily?  But how often do you write a parser for file collector?  You simply write the XML config and feed it to NAnt.  You yourself do not need to parse anything.  No need to compile?  Okay, the first argument is worth it, because we don‚Äôt want to build our build script before we build the project itself.  Otherwise, we will have to write a build script for the build script for the build script ... etc.  "Chicken, the egg of satisfaction" ( <i>pleases the translation of the problem "Chicken &lt;-&gt; egg" performed by translate.google.com, approx. Transl.</i> ).  Well, this is only a limitation of some languages.  What about a language that does not require compilation, which can be performed similarly to NAnt and MSBuild by passing the executable file a link to the interpreted file?  You understand what I am doing.  There are many languages ‚Äã‚Äãthat work in this way, and several of them work on the .Net platform. <br>  If you follow my blog, you‚Äôve probably noticed that I‚Äôm a Ruby fan ( <i>and I, comment transl.</i> ).  Despite the fact that I do not work professionally with him, I am in permanent admiration for the simplicity and beauty of this language.  And although in the world of Ruby compilation is a rather rarely used procedure, but the need for the project's build process is as great as in our world of statically compiled languages.  By the way, people, and you know that one of the common misconceptions about assembly in the .Net world is that assembly is needed only for compilation!  Ufff!  It felt better ... In languages ‚Äã‚Äãlike C #, of course, compilation is done during assembly, but after that there is still a lot of work to be done.  The collector often has to prepare and run unit tests, copy files, package a distribution kit and, possibly, ship it in a layout.  A collector is a rock on which a complex process is repeated, time after time. <br>  So, we have Ruby.  More precisely, IronRuby 1.0 (at the time of writing the translation, version 1.1 is relevant).  And we can use it to create a collector, which is easy and pleasant to use!  So?  Surely. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  IronRuby installation overview </h4><br>  First, download the distribution from the official website <a href="http://ironruby.net/">http://ironruby.net/</a> .  There you can download distributions for both .Net 2.0 and .Net 4.0.  The installation process should not depend on the particular choice. <br>  Download the zip file ... <br>  <i>*** From the translator:</i> <i><br></i>  <i>An automated installer is already available on the site that will do the necessary operations to set up the system;</i>  <i>You can also download the source code of the interpreter and / or library for embedding into your application.</i>  <i>Therefore, I omit the manual installation description as unnecessary.</i> <i><br></i> <br><br>  After successful installation of the interpreter, you can run an interactive interpreter (the ‚Äúir‚Äù command) via the command line and get the opportunity to play around with Ruby. <br><pre><code class="ruby hljs">puts <span class="hljs-string"><span class="hljs-string">"CodeThinked.com is awesome!!"</span></span></code> </pre> <br><br><h4>  Run Rake </h4><br>  Rake is the tool we talked about above.  It does not use XML.  This is just a script written entirely in Ruby.  If you write in interpreted languages, then theoretically you need not use XML to solve the assembly problem.  You can <b>just write code</b> .  IronRuby comes with its own version of Rake, and to make sure that everything is set up correctly, you just need to type "rake" on the command line.  After a few seconds, you should receive a message stating that no rake file was found.  Now let's create a project and a simple rake file for it. <br>  The first thing I do is create a directory for the project (let it be c: \ development \ RakeTest).  In the specified directory, create a file Rakefile.rb.  Next, open it in your favorite text editor ( <i>for example, NotePad ++, approx. Transl.</i> ) And place the following code into it: <br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'rake'</span></span> task <span class="hljs-symbol"><span class="hljs-symbol">:default</span></span> =&gt; [<span class="hljs-symbol"><span class="hljs-symbol">:congratulate_me</span></span>] desc <span class="hljs-string"><span class="hljs-string">"Tells you that you are awesome"</span></span> task <span class="hljs-symbol"><span class="hljs-symbol">:congratulate_me</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> puts <span class="hljs-string"><span class="hljs-string">"Congrats, you have rake running. Wasn't that easy?"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  After that, it remains to you in the command line to go to the directory with this file and type "rake".  In response, you should get ‚ÄúCongrats, you have rake running.  Wasn't that easy? ‚Äù <br>  And it really is simple, isn't it?  Now at your disposal a full-fledged collector.  In the code above, you can see the connection of the Rake library, the default setting for launching the task ‚Äúcongratulate_me‚Äù, as well as the definition of the task itself along with its description.  It looks like a simple nant script, but the Ezhkin cat, we wrote the code. <br>  Now let's see what it will cost us to add additional tasks and merge them into one task, or run the assembly not from the default task, but from some other one.  So, add a couple of tasks to the script: <br><pre> <code class="ruby hljs">task <span class="hljs-symbol"><span class="hljs-symbol">:congratulate_team</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> puts <span class="hljs-string"><span class="hljs-string">"Congrats to the team!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> task <span class="hljs-symbol"><span class="hljs-symbol">:congratulate_everyone</span></span> =&gt; [<span class="hljs-symbol"><span class="hljs-symbol">:congratulate_me</span></span>,<span class="hljs-symbol"><span class="hljs-symbol">:congratulate_team</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> puts <span class="hljs-string"><span class="hljs-string">"Phew, that was a lot of congrats"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  You see how things got a bit more complicated.  We have one task that just spits a string into the console, and there is another one that has an array following the name.  This is an analogue of the NAnt functionality which allows assigning the dependence of this task on others.  This allows you to run others before performing this task.  Now, if we change the name of the default task to ‚Äúcongratulate_everyone‚Äù in Rakefile.rb, we will see that when the build script is run, the task congratulate_everyone is executed after the successful execution of the other two.  And we, by the way, do not necessarily specify the default task.  We can call a specific task by its name.  This is done like this: ‚Äúrake congratulate_team‚Äù. <br>  We have already emulated many of the things that NAnt or MSBuild frameworks can do.  This is because these frameworks simply allow us to combine several tasks in a sequence to perform a specific action.  We also have a set of tasks in the script and the ability to perform them in a certain sequence.  And we do not need any special configs.  We can simply declare a variable in the script or read the data from where we want.  In addition, we can connect to the script other ruby-files, thereby gaining access to the settings, code and tasks from different places.  It seems we were able to do a lot of things that allow us to make XML, but for free. <br>  There is only one problem left - to do the same that they can, isn‚Äôt it?  After all, we ultimately want to have the opportunity to build studio solutions, run tests, reach the version control system, copy and zip files, shove files on FTP, etc.  Maybe we missed something?  So will we be able to catch up with MSBuild and NAnt?  Good for asking. <br><br><h4>  We are friends Rake and .Net </h4><br>  You can ask questions: So where do I get all these tasks for the script?  By chance, would I have to beat them hand to hand?  Can this problem be solved already?  And guess what I will answer you!  Of course, this problem has already been solved for you.  The cure for smut disease is called " <b>Albacore</b> ".  This is a small project on github.  Do not rush to install it right now.  I'll tell you now how to do it in two accounts. <br>  IronRuby comes with a special tool ‚Äúigem‚Äù (analogue of ‚Äúgem‚Äù in MRI Ruby).  This tool allows you to install additional IronRuby packages on your machine.  This tool takes care of copying the package from the repository to the machine along with its dependencies.  So one command "igem install albacore" in the console will be installed everything you need to work Albacore.  You just need to add just one line to the rake file: <br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'albacore'</span></span></code> </pre> <br>  Now I am going to create a simple project of the .Net console application ‚ÄúRakeTestApp‚Äù and use his example to see how the assembly works through Albacore.  I will begin by adding a config to the projects with the name, for example, ‚ÄúAutomatedRelease‚Äù, and then in each of the projects in the solution I will change the build working directory to ‚Äú../build_output‚Äù.  This way I can run a special msbuild task provided by Albacore at our disposal to process the .sln file and compile our solution. <br>  First, I will create a task that will perform all the others one by one: <br><pre> <code class="ruby hljs">task <span class="hljs-symbol"><span class="hljs-symbol">:full</span></span> =&gt; [<span class="hljs-symbol"><span class="hljs-symbol">:clean</span></span>,<span class="hljs-symbol"><span class="hljs-symbol">:build_release</span></span>,<span class="hljs-symbol"><span class="hljs-symbol">:run_tests</span></span>]</code> </pre> <br>  Then I will create a task that will delete the working directory of the build_output, i.e.  will perform a cleanup. <br><pre> <code class="ruby hljs">task <span class="hljs-symbol"><span class="hljs-symbol">:clean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> FileUtils.rm_rf <span class="hljs-string"><span class="hljs-string">'build_output'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  As you can see, we do not need any special tasks to simply delete the files.  The necessary functionality is already implemented in standard Ruby libraries.  Now I will create the first task inherited from the Albacore task.  This task will compile the solution: <br><pre> <code class="ruby hljs">msbuild <span class="hljs-symbol"><span class="hljs-symbol">:build_release</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|msb|</span></span> msb.properties <span class="hljs-symbol"><span class="hljs-symbol">:configuration</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:AutomatedRelease</span></span> msb.targets <span class="hljs-symbol"><span class="hljs-symbol">:Build</span></span> msb.solution = <span class="hljs-string"><span class="hljs-string">"RakeTestApp/RakeTestApp.sln"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  So, instead of ‚Äútask‚Äù we used ‚Äúmsbuild‚Äù and called the task ‚Äúbuild_release‚Äù.  This task takes one parameter - the configuration.  Here we set the configuration to ‚ÄúAutomatedRelease‚Äù, specify the desired target and the path to the descriptor of the solution that needs to be collected.  We also have tests that need to be run during assembly.  We can inherit the task from the NUnit Albacore task.  It will look like this: <br><pre> <code class="ruby hljs">nunit <span class="hljs-symbol"><span class="hljs-symbol">:run_tests</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|nunit|</span></span> nunit.path_to_command = <span class="hljs-string"><span class="hljs-string">"tools/nunit/nunit-console.exe"</span></span> nunit.assemblies <span class="hljs-string"><span class="hljs-string">"build_output/RakeTestAppTests.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  Again, this task takes one argument, through which we can set some parameters for the task.  Here we simply specify the executable file and the list of assemblies with tests (the separator is a comma). <br><br><h4>  Now all together </h4><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'rake'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'albacore'</span></span> task <span class="hljs-symbol"><span class="hljs-symbol">:default</span></span> =&gt; [<span class="hljs-symbol"><span class="hljs-symbol">:full</span></span>] task <span class="hljs-symbol"><span class="hljs-symbol">:full</span></span> =&gt; [<span class="hljs-symbol"><span class="hljs-symbol">:clean</span></span>,<span class="hljs-symbol"><span class="hljs-symbol">:build_release</span></span>,<span class="hljs-symbol"><span class="hljs-symbol">:run_tests</span></span>] task <span class="hljs-symbol"><span class="hljs-symbol">:clean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> FileUtils.rm_rf <span class="hljs-string"><span class="hljs-string">'build_output'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> msbuild <span class="hljs-symbol"><span class="hljs-symbol">:build_release</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|msb|</span></span> msb.properties <span class="hljs-symbol"><span class="hljs-symbol">:configuration</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:AutomatedRelease</span></span> msb.targets <span class="hljs-symbol"><span class="hljs-symbol">:Build</span></span> msb.solution = <span class="hljs-string"><span class="hljs-string">"RakeTestApp/RakeTestApp.sln"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> nunit <span class="hljs-symbol"><span class="hljs-symbol">:run_tests</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|nunit|</span></span> nunit.path_to_command = <span class="hljs-string"><span class="hljs-string">"tools/nunit/nunit-console.exe"</span></span> nunit.assemblies <span class="hljs-string"><span class="hljs-string">"build_output/RakeTestAppTests.dll"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><br>  That's all!  We created a simple build tool with IronRuby, Rake and Albacore.  But this is only a small fraction of what Albacore can do.  With this library, I can use ndepend, ncover, sftp, sql commands, archive directories with zip, call ssh, unzip and more.  All these lego actions are performed with Albacore. <br><br><h4>  Conclusion </h4><br>  If you, as I feel tired of building through XML-configs, then I advise you to try IronRuby, Rake and Albacore.  In the worst case scenario, it will be a small amount of time.  But on the other hand, if it burns out, you will be free from the <s>Tatar-Mongolian</s> Yoke of the oppression of XML-configs forever.  Hope you enjoyed it! <br><br>  Here is a link to <a href="">sortsy</a> . </div><p>Source: <a href="https://habr.com/ru/post/148618/">https://habr.com/ru/post/148618/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148611/index.html">How does the architecture of Skype</a></li>
<li><a href="../148612/index.html">Beautiful print to PDF from Django</a></li>
<li><a href="../148613/index.html">mashina.org is not available under Beeline</a></li>
<li><a href="../148615/index.html">Why Google is a great ISP</a></li>
<li><a href="../148616/index.html">Happy System Administrator!</a></li>
<li><a href="../148619/index.html">Review of the AdvoCam-FD3 DVR and Action Kit</a></li>
<li><a href="../148621/index.html">My questions to Mountain Lion</a></li>
<li><a href="../148623/index.html">MongoDB and C #. New features and non-obvious problems</a></li>
<li><a href="../148625/index.html">How to steal a million?</a></li>
<li><a href="../148627/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ16 (July 21 - 27, 2012)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>