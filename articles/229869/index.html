<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using Rainmeter Skin in Enterprise</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear habravchane. Many use the Rainmeter for purely visual improvements to the desktop of the operating system, but I got the idea to use it...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using Rainmeter Skin in Enterprise</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/getpro/habr/post_images/de9/920/54f/de992054f828e4439388af773a9e3119.png" alt="image">  Good day, dear habravchane.  Many use the Rainmeter for purely visual improvements to the desktop of the operating system, but I got the idea to use it as an add-on to the desktop for users in the enterprise.  For example, system information for the user and administrator, access to administrative functions from the panel, launch shortcuts (RPD, URL, BAT), etc. <br><a name="habracut"></a><br><h5>  How did it all begin? </h5><br>  Somehow during the release of Iconia Tab on the x86 platform, I used Windows 7, and under the touchscreen, this brainchild of Microsoft doesn‚Äôt fit and had to invent some tricks.  Once I came across an article in which some intelligent person came up with a skin for Rainmeter in the form of several keys that played the role of CTRL + C, CTRL + V and their ilk.  So I first met Rainmeter.  But this acquaintance then was short-lived, since I soon sold the tablet and bought more finger oriented on the Android OS.  But after a while I returned to the Rainmeter skins in the form of a clock and a sound card switch, as I had more than one thing in my system at that time, and it was necessary to transfer the sound output to headphones, speakers or TV.  Somewhere at the same time at work there was a need to control the labels on the computers of users, by itself I wanted to somehow use the crutches, and not to raise the domain and push everything you need there.  At first it was decided to try using RocketDock, but he showed himself from the worst side, and then he stopped working adequately.  It was then that I remembered Rainmeter, which could solve this problem, as well as replace desktop widgets with PING statistics to servers and remote objects. <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/ef0/cb7/5d8/ef0cb75d83f3864a3b401ca52890ad7c.png">  This is how the widget looked with ping to the servers, and there were about 5-10 of these.  By itself, all this was inconvenient, it was necessary to configure on each administrator computer separately, and it all ate a large amount of RAM.  This is how my epic on programming a versatile widget for the organization in which I work began. <br><br><h5>  General Description Rainmeter </h5><br>  The common description of the program slightly incorrectly reflects its essence, since in fact the Rainmeter is a kind of scripting language for writing your own widgets for Windows.  In no way, its capabilities are not limited to displaying statistics on the used CPU and RAM resources.  For those who do not know what it is, we look at the screenshots, or by scoring Google ‚ÄúRainmeter‚Äù we look at the pictures. <br>  Rainmeter can be different: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/6b7/2a4/5ef/6b72a45ef9ccf51c9bf22fbcd8f7e70c.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/762/6b2/cac/7626b2cac1c674f1b861ee05fe3dfa31.png"><br><br>  Only flight of fancy or hardware of your computer can limit you.  In fact, people write skins for the program, who is in that much.  Sometimes masterpieces are made, and sometimes clocks or panels that are dull.  I do not consider myself at least some pros in writing skins for Rainmeter, but I can describe the general principles for you. <br><br>  The program has a management console through which we can set the configuration of various skins, as well as watch logs, create themes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26a/f87/7b9/26af877b9ece66bc626bf1ae1e0d0b3d.png"><br><br>  The skins themselves are stored in the user <i>'s</i> folder <i>‚Äúmy documents \ Rainmeter \ Skins‚Äù</i> , where the folders with your skins are already stored.  I have for example <i>IT-Solutions</i> , and in it the <i>index.ini</i> file.  So, the main skin code is stored just in such INI files.  In simple terms, the code itself is objects and dimensions.  Measurements are objects that are not displayed on their own in the body of the skin, but collect some information, for example, about the CPU load.  Objects - as such, are skin interface elements, such as: images, text, and so on.  In general, the ‚Äúprogramming‚Äù of the skin is built on this all. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ae1/0bb/3a0/ae10bb3a0cc2b7e2e7ad76c9f2711d77.png"><br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/fc2/b28/4df/fc2b284df4e320ee75bdb6672eaf7f62.png">  And this is how this code looks in work. <br><br>  In principle, nothing complicated, 1 element of data collection (plug-in for Rainmeter), 2 text elements (title and content), 2 image elements (edit key and orange bar).  Each object has its own parameters that can be modified in the code.  All parameters indicate exactly how they are written, it is very difficult to get confused.  The program also has the ability to work with LUA code, but everything is organized through special functions for input and output of data from LUA to the Rainmeter and back. <br><br><h5>  What should be implemented in the skin for the company? </h5><br>  I want to immediately note that the creation of even a plain-skinned one is some kind of development.  The problem is that no one can help especially with this, you have to think about the necessity and their implementation in the code.  I started by saying that we need to receive data on the status (on the network, not on the network) of servers, remote sites and central switches, but we also had to somehow display all the keys on the desktop of all users to navigate through the URL or launch RDP connect.  Of course, immediately thought that you can add some other features.  It was decided to add quick access to administrative functions, a personal notebook (local), beautiful watches, computer statistics (to make it easier to diagnose users by phone), as well as in thought the general calendar of work for the sections \ departments \ enterprises and notebooks for divisions.  Well, it would be nice to add your own Christmas tree to the desktop of users in the new year, otherwise they themselves start downloading trees with viruses in the kit. <br><br><h5>  First try </h5><br>  It was also necessary not to forget that different users have different screen resolutions, as well as different preferences in the appearance of the desktop.  For the first time, pushing off from the standard scheme of writing skins, I set to work.  The code of one of the panels was quickly sawn, and a decent watch was also found.  I threw in the keys, mounted the clock, created a panel that would be sized to fit the screen, taking into account the panel.  But after a couple of days of work, it was suddenly realized that if the address of the RDP server or the URL of a page was changed, it would be very difficult to change the same values ‚Äã‚Äãfor each user.  I decided to rewrite everything anew, but, already focusing on the network component and as it turned out, I did not lose.  In Rainmeter, there is an <i>Include</i> function, which works very well at connecting files stored on a Samba resource.  I can give the following code as an example: <br><br><pre><code class="bash hljs">[CONFIG_LOADER] @Include=<span class="hljs-comment"><span class="hljs-comment">#SERVER_SKIN_PATH#./configs/@config-loader.cfg</span></span></code> </pre> <br><br>  Variables in Rainmeter have the form <i># ololo #</i> , and they must also be declared in a separate <i>[Variables]</i> object.  By the way, the work of variables can cause very strong discomfort for those who are accustomed to the usual programming languages ‚Äã‚Äãor even php.  Sometimes the variables simply do not work, and you cannot understand the reason, because logically everything is fine, and especially in another place the same approach works, it is not here.  But you have no compiler at all, no error output.  Although it may be in the logs, I have never looked into it. <br><br><pre> <code class="bash hljs">[Variables] SERVER_SKIN_PATH=\\nas.ag\soft\IT-Solutions.v7 PANEL_WIDTH=300 PANEL_HEIGHT=<span class="hljs-comment"><span class="hljs-comment">#WORKAREAHEIGHT# PANEL_TOPPLACE_X=(#SCREENAREAWIDTH# - #PANEL_WIDTH#) PANEL_TOPPLACE_Y=0 PANEL_SOLIDCOLOR=0,0,0,200 PANEL_PADDING_SIZE=10 PANEL_PADDING_SIDE=5 PANEL_SPACING=5</span></span></code> </pre><br><br>  And in objects the call of variables looks as follows: <br><br><pre> <code class="bash hljs">[PANEL] Meter=Image X=<span class="hljs-comment"><span class="hljs-comment">#PANEL_TOPPLACE_X# Y=#PANEL_TOPPLACE_Y# W=#PANEL_WIDTH# H=#PANEL_HEIGHT# SolidColor=#PANEL_SOLIDCOLOR# ;RightMouseDownAction=!Execute [ ]</span></span></code> </pre><br><br>  As I could see, variables are best declared at the beginning of the file and always in the correct sequence.  If you use another in the variable, then do not forget to set the donor variable first.  For example: <br><br><pre> <code class="bash hljs">SCREENWIDTH=1024 PANELWIDTH=<span class="hljs-comment"><span class="hljs-comment">#SCREENWIDTH# - 700</span></span></code> </pre><br><br>  Between mathematical operations and values, spaces are definitely needed, if you write a "formula", then each mathematical expression must be enclosed in brackets: <br><br><pre> <code class="bash hljs">PANELWIDTH=(<span class="hljs-comment"><span class="hljs-comment">#SCREENWIDTH# ‚Äì 700) + 10</span></span></code> </pre><br><br>  And it turned out that I had only the <i>index.ini</i> in the local folder with a bunch of <i>include</i> and a <i>config</i> file with the local configuration, in which data such as username were included to query for this samba configuration file variable.  At that moment I didn‚Äôt think much about the speed of such a skin, but I thought about the amount of memory that such a skin can begin to use.  The final solution seemed simple to me, to increase the skin update timing from 1 second to 10 or 30, and possibly a minute.  Based on this position, I programmed the skin in the form of one integral project, how sites are programmed, the entry point as <i>index.ini</i> , and everything else is loaded depending on the conditions.  Unfortunately, the conditions in Rainmeter can not directly affect the download of certain files, not counting some crutches through LUA or the standard functions of windows, caused by the conditions in the script.  As a result, it turned out that when the script was initialized, all the elements were loaded at once, and I gave them the display parameters, visible or not. <br><br><pre> <code class="bash hljs">DynamicVariables=1 Hidden=[VARIABLES_HIDE_CONTENT_LOCAL]</code> </pre><br><br>  This is how, in a variable, I defined skin layers, which at one time or another would have to be visible.  At first, everything worked out with a bang, but with the addition of all the new functionality, the skin began to take up too much space in memory (although for our computers with 4GB of RAM on board this is not a problem), but at the same time it began to noticeably slow down.  I had to figure out how to get around this problem.  At first I dug in the direction of the conditions of connection of various components, but often rested on a small number of possibilities in the Rainmeter.  I had to return to the scheme, where each layer is a separate file (entry point) for the Rainmeter.  In general, I am initially a web programmer, I often use php in my work, and I know firsthand about crutches.  But doing something in the Rainmeter is more complicated than outputting one image and a couple of lines of text is associated with powerful crutches, and if you want to still realize the idea, you have to resort to using things that are not obvious at first glance.  For example, LUA (I met him recently, purely because of Rainmeter) or use the functions of Windows and others like writing scripts in cmd or powershell. <br><br>  A bit about nesting files in the skin.  A skin is considered a folder in <i>Rainmeter \ Skins</i> with ini files attached to it.  If there are several such files, only one of them can be active in one such folder.  When you turn on the next, the previous one turns off.  Of course, such a problem can be circumvented by creating subfolders and placing new ini files there if necessary.  This option was adopted by me for the final implementation of the project.  And the fact that we have at this time? <br><br><h5>  Project Development Plan </h5><br>  The final project is called <i>‚ÄúIT-Solutions‚Äù</i> .  I will use it bundled with Windows 7 x86 installed on our office computers.  For myself, I created a notation system.  The skin consists of two ‚Äúblocks‚Äù, ‚Äúblock‚Äù - these are the main elements of the skin, in essence it is a skin panel and a workspace.  The panel is placed in the right corner with a width of 300 pixels, and the rest of the space, if necessary, can take up the workspace or as I called this element ‚ÄúContent‚Äù.  And that we receive in the form of blocks 2 elements: ‚ÄúPanel‚Äù and ‚ÄúContent‚Äù.  Each block is determined by its specific ‚Äúgrid‚Äù - this is the location of the functional elements of the block.  For example, the panel has top, content and footer.  In the top we have the panel switching keys, the main modules hang in the content, and the non-replaceable statistics module in the footer.  Modules are skin components that contain some specific code set, for example, a key module or a clock.  There are also groups of elements, they are combined with each other by reference to one variable, which determines the visibility of elements at a given time on the skin.  Coordinates (grid) was calculated manually, hence a large number of configurations, since you have to specify the exact dimensions and coordinates of absolutely all elements.  And you also need to take into account the possibility of different screen resolutions. <br><br>  At the request of the guys who very often travel on business trips, the local notebook was also listed.  It is necessary that the skin does not stop working without connecting to the network, which means that we need to store local content in it.  Statistics in the footer and content notebook.  These two modules are stored in the skin locally and can be used by the user without connecting to the enterprise network. <br><br><ul><li>  <b>notepad</b> - a local module that collects data from a txt file using a special plug-in for the Rainmeter </li><li>  <b>statistic</b> is a local module that collects and displays statistics about a computer: CPU utilization, RAM, hard disk, network address and delay to the server, Internet and network connection </li></ul><br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/9f9/c08/2f9/9f9c082f9238224484edf67723f6b0d5.png">  If the local part of the skin is loaded first with us, then for those sitting in the enterprise network, you need to load some additional functions and for this purpose a system of layers was invented.  Each block is divided into several layers.  For the panel, these are the local, user, and ‚Äúpinger‚Äù layers.  Exactly at this moment of development, it was decided to apply modularity.  The division of the entire skin into its component parts, which can later be used in different places. <br><br>  It goes without saying that the content in the skin is updated remotely and without the need for an individual update on each of the computers, from here I concluded that you need to load the rest of the giblets from a samba resource.  So the rest of the code is mainly located at \\ nas.ag \ soft \ rainmeter \ on the production drive.  Only the calling code is stored in local files, but sometimes we may need to refine it and LUA will come to our rescue in this case.  In the initializer file, I embedded the LUA file, which will check the relevance of the skin version, and if there is a mismatch, it will download files from the server and then restart the skin.  In the local part, located in the skin folder, we have the following files: <br><br><ul><li>  <b>Index.ini</b> - the initializer for launching everything else.  If we are working locally, only local skin components are loaded - this is the initializer index.ini, and the LUA skin update check script and the first layer of @PANEL, which contains a local notepad, is loaded in it. </li><li>  <b>CONTENT</b> - this contains layers of the main skin window. </li><li>  <b>PANEL</b> - it contains layers of the skin panel </li><li>  <b>WINDOWS</b> is a tooltip for content and panel. </li></ul><br>  Of course, all these conventions used only in my skin.  When switching to another layer, the first one turns off.  This possibility allowed me to realize switching between layers without additional crutches.  When all the layers were in the same ini file, switching between them worked faster, but at the same time the initial loading of the skin took a very long time (about 2-5 seconds). <br><br>  Let's talk a little more about <i>index.ini</i> - this file is an initializer, it loads the general configuration into itself (to access network components), and then loads an initialization script from the LUA network, which includes version checking and skin update, if necessary .  Next we have a LUA script that switches the layer, since if there is a network, you need to load <i>layer2</i> , which contains special content for users. <br><br>  Local files: <br><pre> <code class="bash hljs">/ IT-Solutions /@CONTENT Layer1.ini Layer2.ini /@PANEL Layer1.ini Layer2.ini Layer3.ini /@WINDOWS Content.ini Panel.ini /backgrounds CONTENT.cfg PANEL.cfg /configs @config-loader.cfg Config.cfg Styles.cfg User.cfg Variables.cfg /LUA initialize.lua /modules Notepad.cfg Statistic.cfg / Resources /img Edit.png Refresh.png Notepad.txt</code> </pre><br><br>  As you can see, a considerable number of different files are used for decoration.  Block layers, configuration for backdrops (backgrounds), configurations of various kinds (@ config-loader - download network configuration files, config - general configuration, sytles - text display styles, user - user configuration, variables - variables), LUA initialization script, a couple modules and some files for them. <br><br>  From the network side everything is a bit more complicated, but, in general, everything is in the same vein.  Each layer in the skin requests the corresponding file from the network and draws itself from it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b35/19a/2b1/b3519a2b17b60cd8d80f22e89f2f7e33.png"><br><br>  The following modules were allocated for network operation. <br><br><ul><li>  <b>buttons</b> - the module of the keys including the launch of exe, bat, url, html.  This is a small file that includes 15 image objects and activated links by clicking on them.  Where to get the pictures and where the link leads we will learn from a special configuration file, separate for the module. <br><br><pre> <code class="bash hljs">[PANEL_CONTENT_BUTTONS-FIRST-1-button] Meter=Image ImageName=<span class="hljs-comment"><span class="hljs-comment">#SERVER_SKIN_PATH#\images\buttons\#PANEL_CONTENT_BUTTONS-FIRST-1-button-icon# W=50 H=50 X=(#PANEL_CONTENT_TOPPLACE_X# + 10) Y=(#PANEL_CONTENT_TOPPLACE_Y# + 10) leftmouseupaction=!Execute ["#PANEL_CONTENT_BUTTONS-FIRST-1-button-url#"] ;   DynamicVariables=1 Hidden=[VARIABLES_HIDE_CONTENT_USERS]</span></span></code> </pre><br><br>  Fifteen here such <i>Meter</i> .  Naturally, the coordinates are lined up for each picture, 3 rows of 5 pictures each.  The <i>leftmouseupaction</i> parameter shows us what we need to activate by pressing.  And here is the configuration: <br><br><pre> <code class="bash hljs">;   ; 1  PANEL_CONTENT_BUTTONS-FIRST-1-button-icon=windows 8.png ;PANEL_CONTENT_BUTTONS-FIRST-1-button-icon=default/simple_gray_comp.ico PANEL_CONTENT_BUTTONS-FIRST-1-button-url=::{20D04FE0-3AEA-1069-A2D8-08002B30309D} PANEL_CONTENT_BUTTONS-FIRST-1-button-text=  ; 2  PANEL_CONTENT_BUTTONS-FIRST-2-button-icon=office 2013.png PANEL_CONTENT_BUTTONS-FIRST-2-button-url=::{450D8FBA-AD25-11D0-98A8-0800361B1103} PANEL_CONTENT_BUTTONS-FIRST-2-button-text=  ; 3  PANEL_CONTENT_BUTTONS-FIRST-3-button-icon=skydrive.png PANEL_CONTENT_BUTTONS-FIRST-3-button-url=explorer<span class="hljs-string"><span class="hljs-string">" "</span></span>\\nas.ag\public PANEL_CONTENT_BUTTONS-FIRST-3-button-text= ; 4  PANEL_CONTENT_BUTTONS-FIRST-4-button-icon=music.png PANEL_CONTENT_BUTTONS-FIRST-4-button-url=explorer<span class="hljs-string"><span class="hljs-string">" "</span></span>\\nas.ag\media PANEL_CONTENT_BUTTONS-FIRST-4-button-text=  ; 5  PANEL_CONTENT_BUTTONS-FIRST-5-button-icon=phone.png PANEL_CONTENT_BUTTONS-FIRST-5-button-url=http://phones.ag/ PANEL_CONTENT_BUTTONS-FIRST-5-button-text=</code> </pre><br><br>  As you can see, no tricks is complete.  The first labels send us to the addresses: "my computer" and "my documents".  The third and fourth keys send us to the samba resource, but we open it through the explorer, giving it the corresponding address.  5 key sends us to the URL, but the benefit of the browser by default will open the page itself, but sometimes there are times when you need to specify a specific browser to open the necessary page.  In this case, it is necessary to act by analogy with the samba ball.  There was a situation when the site needed to be opened only through Internet Explorer, since the site of one of the government agencies was written in asp, specifically under IE and to complete everything, a hardware key is also required to enter the site.  But this situation is not new now, so I don‚Äôt surprise anyone with this. <br></li><li>  <b>clock</b> - beautiful watch <br><br><pre> <code class="bash hljs">;    CLOCK PANEL_CONTENT_CLOCK_TOP_X=(<span class="hljs-comment"><span class="hljs-comment">#PANEL_FOOTER_TOPPLACE_X# + 70) PANEL_CONTENT_CLOCK_TOP_Y=(#PANEL_FOOTER_TOPPLACE_Y# - 150) PANEL_CONTENT_CLOCK_WIDTH=#PANEL_WIDTH# PANEL_CONTENT_CLOCK_HEIGHT=70</span></span></code> </pre><br><br>  This is a clock configuration that determines the position of the upper left corner, as well as the width and height of the module.  In the code itself, the remaining parts of the module are already adjusted to these coordinates, and are not rigidly specified with respect to the dimensions and coordinates of the panel or the entire skin.  I will not give the clock code, since it can always be downloaded and used, the ‚Äú <i>Cowon Clock</i> ‚Äù is used for the watch. <br></li><li>  <b>pinger</b> - a special module with access statistics to resources, as well as the ability to quickly connect through various protocols <br><pre> <code class="bash hljs"> ;   PINGER PANEL_CONTENT_PINGER_UPDATE_RATE=15 PANEL_CONTENT_PINGER_TIMEOUT=2000 ;PANEL_CONTENT_PINGER_PINGERPATH=123 ;PANEL_CONTENT_PINGER_PINGERPATH=<span class="hljs-comment"><span class="hljs-comment">#SERVER_SKIN_PATH#\modules\pinger.cfg ; 1  PANEL_CONTENT_PINGER_1_TEXT=Google.com PANEL_CONTENT_PINGER_1_ADDRESS=8.8.8.8 ; 2  PANEL_CONTENT_PINGER_2_TEXT=Kerio N:10 PANEL_CONTENT_PINGER_2_ADDRESS=192.168.10.1</span></span></code> </pre><br><br>  This is the configuration of the module, there are 47 such lines in it, this is the maximum number that fits into the FullHD resolution.  Monitors with a lower resolution were not taken into account, since the module will work only on the computers of system administrators.  The module code consists of 47 assemblies of objects and an additional assembly for a pop-up window. <br><br><pre> <code class="bash hljs">[PINGER_1_STATUS] Measure=Plugin Plugin=PingPlugin DestAddress=<span class="hljs-comment"><span class="hljs-comment">#PANEL_CONTENT_PINGER_1_ADDRESS# UpdateRate=#PANEL_CONTENT_PINGER_UPDATE_RATE# Timeout=#PANEL_CONTENT_PINGER_TIMEOUT# TimeoutValue = -999 IfBelowValue = 0 IfBelowAction = [!SetOption PINGER_1_VALUE FontColor 255,0,0,255][!UpdateMeter PINGER_1_VALUE][!redraw] IfAboveValue = -1 IfAboveAction = [!SetOption PINGER_1_VALUE FontColor 0,255,0,255][!UpdateMeter PINGER_1_VALUE][!redraw]</span></span></code> </pre><br><br>  This is the first object in the assembly, which is the ping state collector through a special plugin.  And also at the end of the object we see the conditions that repaint the text color parameter of the value object.  Values ‚Äã‚Äãare repainted when the ping parameter is within the required limits. <br><br><pre> <code class="bash hljs">[PINGER_1_LABEL] Meter=STRING MeterStyle=PANEL_FOOTER_STATISTIC_LEFTTEXT X=(<span class="hljs-comment"><span class="hljs-comment">#PANEL_CONTENT_TOPPLACE_X# + 0) Y=(#PANEL_CONTENT_TOPPLACE_Y# + 0) W=290 H=14 Text="#PANEL_CONTENT_PINGER_1_TEXT#" LeftMouseUpAction=[!SetOption PINGER_MENU_HIDE Formula 0][!SetOption PINGER_MENU_LABEL Text "#PANEL_CONTENT_PINGER_1_TEXT#"][!SetOption PINGER_MENU_TEXT_PING LeftMouseUpAction "!Execute[ping.exe #PANEL_CONTENT_PINGER_1_ADDRESS# -t][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_TRACERT LeftMouseUpAction "!Execute[tracert.exe #PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_HTTP LeftMouseUpAction "!Execute[http://#PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_SSH LeftMouseUpAction "!Execute[#SERVER_SKIN_PATH#\inc\exe\putty.exe #PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_RDP LeftMouseUpAction "!Execute[mstsc.exe /v:#PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_VNC LeftMouseUpAction "!Execute[#SERVER_SKIN_PATH#\inc\exe\vnc.exe #PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_LM LeftMouseUpAction "!Execute[][!SetOption PINGER_MENU_HIDE Formula 1]"] ;   DynamicVariables=1 Hidden=[VARIABLES_HIDE_CONTENT_ADMINS]</span></span></code> "Execute [http!: // # PANEL_CONTENT_PINGER_1_ADDRESS #] [SetOption PINGER_MENU_HIDE Formula <code class="bash hljs">[PINGER_1_LABEL] Meter=STRING MeterStyle=PANEL_FOOTER_STATISTIC_LEFTTEXT X=(<span class="hljs-comment"><span class="hljs-comment">#PANEL_CONTENT_TOPPLACE_X# + 0) Y=(#PANEL_CONTENT_TOPPLACE_Y# + 0) W=290 H=14 Text="#PANEL_CONTENT_PINGER_1_TEXT#" LeftMouseUpAction=[!SetOption PINGER_MENU_HIDE Formula 0][!SetOption PINGER_MENU_LABEL Text "#PANEL_CONTENT_PINGER_1_TEXT#"][!SetOption PINGER_MENU_TEXT_PING LeftMouseUpAction "!Execute[ping.exe #PANEL_CONTENT_PINGER_1_ADDRESS# -t][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_TRACERT LeftMouseUpAction "!Execute[tracert.exe #PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_HTTP LeftMouseUpAction "!Execute[http://#PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_SSH LeftMouseUpAction "!Execute[#SERVER_SKIN_PATH#\inc\exe\putty.exe #PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_RDP LeftMouseUpAction "!Execute[mstsc.exe /v:#PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_VNC LeftMouseUpAction "!Execute[#SERVER_SKIN_PATH#\inc\exe\vnc.exe #PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_LM LeftMouseUpAction "!Execute[][!SetOption PINGER_MENU_HIDE Formula 1]"] ;   DynamicVariables=1 Hidden=[VARIABLES_HIDE_CONTENT_ADMINS]</span></span></code> PANEL_CONTENT_PINGER_1_ADDRESS #]! [SetOption PINGER_MENU_HIDE Formula <code class="bash hljs">[PINGER_1_LABEL] Meter=STRING MeterStyle=PANEL_FOOTER_STATISTIC_LEFTTEXT X=(<span class="hljs-comment"><span class="hljs-comment">#PANEL_CONTENT_TOPPLACE_X# + 0) Y=(#PANEL_CONTENT_TOPPLACE_Y# + 0) W=290 H=14 Text="#PANEL_CONTENT_PINGER_1_TEXT#" LeftMouseUpAction=[!SetOption PINGER_MENU_HIDE Formula 0][!SetOption PINGER_MENU_LABEL Text "#PANEL_CONTENT_PINGER_1_TEXT#"][!SetOption PINGER_MENU_TEXT_PING LeftMouseUpAction "!Execute[ping.exe #PANEL_CONTENT_PINGER_1_ADDRESS# -t][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_TRACERT LeftMouseUpAction "!Execute[tracert.exe #PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_HTTP LeftMouseUpAction "!Execute[http://#PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_SSH LeftMouseUpAction "!Execute[#SERVER_SKIN_PATH#\inc\exe\putty.exe #PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_RDP LeftMouseUpAction "!Execute[mstsc.exe /v:#PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_VNC LeftMouseUpAction "!Execute[#SERVER_SKIN_PATH#\inc\exe\vnc.exe #PANEL_CONTENT_PINGER_1_ADDRESS#][!SetOption PINGER_MENU_HIDE Formula 1]"][!SetOption PINGER_MENU_TEXT_LM LeftMouseUpAction "!Execute[][!SetOption PINGER_MENU_HIDE Formula 1]"] ;   DynamicVariables=1 Hidden=[VARIABLES_HIDE_CONTENT_ADMINS]</span></span></code> </pre><br><br>  This object is a text with the name of the pinged address.  The funny thing about it is that by clicking the left mouse button a window should appear in which we can choose the method of connecting to this address.  This is where I‚Äôm hiding a little trick, even as I programmed this module as an integral structure, I introduced the <i>Hidden</i> parameter to each skin object.  My popup window is initially hidden.  But when you click on the name of the window magically appears, since we change its parameter <i>Hidden</i> from 1 to 0. But here we have another problem.  Rainmeter does not contain the ability to create custom functions and make the necessary variables in them.  Or create 47 identical forms of pop-up windows, but with their own parameters for each address.  Or create one window and replace the necessary values ‚Äã‚Äãin it.  I went the second way and below is a screenshot of what happened.  And in the code, it all looks like a long line, which is processed by pressing the left mouse button.  Of course, it was possible to follow the path of creating an additional ini file, but I do not know how to transfer variables from one skin to another without using crutches like writing necessary data to a file and then reading from it.  Of course, I could try to replace the data in the variables, but my attempt to replace the variables was not successful.  The variables <i>[Variables]</i> cannot be changed after the launch of the skin, but you can replace the mathematical variables. <br><br><pre> <code class="bash hljs">[VARIABLES_HIDE_TOP] Measure=Calc Formula=0</code> </pre><br><br>  But in such "variables" we can store only numerical values, and they are not suitable for transmitting text or ip addresses.  It is because of the problematic nature of these solutions that I immediately change the values ‚Äã‚Äãin the popup window objects. <br><br><pre> <code class="bash hljs">[PINGER_1_VALUE] Meter=STRING MeterStyle=PANEL_FOOTER_STATISTIC_RIGHTTEXT MeasureName=PINGER_1_STATUS X=270r Y=0r W=290 H=14 Text=%1 ms ;   DynamicVariables=1 Hidden=[VARIABLES_HIDE_CONTENT_ADMINS] [PINGER_1_BAR] Meter=IMAGE X=-250r Y=15r W=250 H=1 SolidColor=<span class="hljs-comment"><span class="hljs-comment">#STATISTIC_LOCAL_BARCOLOR# ;   DynamicVariables=1 Hidden=[VARIABLES_HIDE_CONTENT_ADMINS]</span></span></code> </pre><br><br>  Further, as we see, we have an object of outputting the value and a bar that simply decorates our skin.  It is possible that the bar will have to be removed when adapting the skin to weaker machines.  And in the object of the value, we take the data from the questionnaire and the same questionnaire tints the value in green or red, depending on whether the rainmeter received a ping response. <br>  I will not give an example of a pop-up window, since basically it consists of a picture and text with a link to the necessary program for opening the received address. <br></li><li>  <b>runner</b> - access to the administrative functions of the computer.  As well as the rest of the keys in the skin, it consists of a picture and text with a link to the application being opened.  It is a pop-up window. </li><li>  <b>switcher</b> - module in the TOP panel, to switch between layers.  Essentially, there are 3 pictures with links to switch between ini files of the <i>@PANEL</i> skin </li></ul><br><br>  In the end, everything looks like this: <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/de4/db0/534/de4db05346ad70e1433f6e91d5323567.png"><img src="https://habrastorage.org/getpro/habr/post_images/a17/581/89c/a1758189c99aeca168ab475bf61e70fe.png"><br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/a0e/17b/eda/a0e17beda8815c4bb7435db60ff4abe3.png"><img src="https://habrastorage.org/getpro/habr/post_images/903/b33/7c7/903b337c75883ce42158edd2bbe68e4e.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d4/c96/23c/9d4c9623c28f0fefa03d197382a4345c.png"><br><br>  Things like "calendar" and "tasks" have not yet been completed.  Access to admin functions is provided through the <i>execas</i> program.  As one of the access keys, an HTML file with JS code is used, which automatically authorizes each of the users on Yandex mail.  The pop-up access window in ‚Äú <i>pinger</i> ‚Äù allows you to immediately access, via various <i>types of</i> clients, the necessary address.  And this whole mess eats no more than 30 MB of RAM, as opposed to 100 MB, at a time when all the code was loaded from one file. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cd6/b20/705/cd6b207050a1b8b43c38c77388ef1ece.png"><br><br>               ,         .             ,    -    ,    Rainmeter   .    2  <i>index.ini</i>    ,         ,         .  ,  .        , ,       ,   ,  ,  ‚Äú <i>Cowon Clock</i> ‚Äù. <br><br><h5>  Future plans </h5><br>     .      ,            ,      .      ,       (    ),      .        -              , Rainmeter        .        .    ,    10 .      ,      ,    .    ,        ,     .      ,      .        ,       .   ,              . <br>       :    ,      HD (     ),       . <br><br><h5>  Afterword </h5><br>  Thanks for the tip.  ,     ,    ,      ?                . <br><br>           ,          , ,  ,  .         700 ,       DSL    wifi  .       ,          ,       ,       ,  .   ,        ,  ,   .     ,           ,           .  ,     ,            .    ,   ,   -         ,        . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It would seem, why not do the same thing in C # or Delphi, the choice of many adequate development environments and languages, but the point is to test. When programming such a skin, all the time you have to invent something for yourself, look for non-logical solutions to the problem. But you know, it works. Moreover, none of those who may come to work after me will be able to maintain the system, but if you leave behind you instructions and software developed with a very low level of entry, you can hope that former ptushniki will be able to come to the least programming and love this thing.</font></font><br>          ,     , ,    .       ,    ,   ,   .               .             , ,    ,        ,      . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hanging shortcuts in the ‚ÄúKeys‚Äù section allow users to no longer remember boring addresses and connection instructions. It would seem that something difficult to remember such addresses as: wiki.ag or phones.ag, but you won‚Äôt believe, almost no one remembers them. But services are created for a reason. Wiki engine is needed in the enterprise for documentation and not only for programmers or network administrators, but also for communications workers, accountants, lawyers and economists. A lot of instructions can be stored there and some data about those works that in the future will have to be done again. How often did it happen that a burned hard disk, on the computer of the chief accountant, buried the work of the entire accounting department for a week. In the same place ten programs and each of which demands the special approach. Somewhere a hardware key is required, somewhere a certificate,but somewhere you need to podshamanit the configuration, since the addresses of the bank‚Äôs servers have changed, and the bank hasn‚Äôt been able to update the client‚Äôs bank‚Äôs version, because the people who wrote the first version have long since quit. As everyone knows, there is no life behind the MKAD, and as it was correctly noted, usually in enterprises one or several software engineers do the work of a communications man and installer and system administrator, and at leisure they also need to concoct a site for the office.and in their leisure time they also need to concoct a website for an office.and in their leisure time they also need to concoct a website for an office.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Well, having discussed the possibilities of Rainmeter with a couple of colleagues, we came to the conclusion that statistics about the computer would be very useful for us. </font><font style="vertical-align: inherit;">Diagnose by phone will be easier. </font><font style="vertical-align: inherit;">After all, when a user says that the Internet does not work for him - this does not mean that he really does not work. </font><font style="vertical-align: inherit;">It is possible that someone was mistaken with entering the address in the browser. </font><font style="vertical-align: inherit;">And asking for a look at the color of the labels at the bottom of the panel is still easier than asking to ping. </font><font style="vertical-align: inherit;">Yes, we have the ability to connect remotely to the working sessions of users, but sometimes this is unnecessary, since the issue can be solved in one phrase. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the course of working on the skin I used official documentation and articles on the sites:</font></font><br><br><ul><li> <a href="http://docs.rainmeter.net/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">docs.rainmeter.net</font></font></a> </li><li> <a href="http://furious.freedom-vrn.ru/articles/hardware/39-rainmeter-manual.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">furious.freedom-vrn.ru/articles/hardware/39-rainmeter-manual.html#spoiler_0</font></font></a> </li><li> <a href="http://www.nextwindows.ru/forum/topic_2425"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">www.nextwindows.ru/forum/topic_2425</font></font></a> </li></ul><br>          Google </div><p>Source: <a href="https://habr.com/ru/post/229869/">https://habr.com/ru/post/229869/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../229857/index.html">Android Wear: What went wrong?</a></li>
<li><a href="../229859/index.html">Report from Dribbble Meetup 2014 in Moscow</a></li>
<li><a href="../229861/index.html">"Test Zone" Beeline: go to the tight lock, dress warmer at the gym and turn off the phones</a></li>
<li><a href="../229863/index.html">Sentri: Home Security System for Geeks</a></li>
<li><a href="../229867/index.html">Setting up a modern Puppet server from scratch</a></li>
<li><a href="../229873/index.html">Continuous Integration in 10 lines of code or why BuildBot, Jenkins, TeamCity and the like are needed</a></li>
<li><a href="../229875/index.html">New VDI service from SFCLOUD set</a></li>
<li><a href="../229877/index.html">Experience using AR.Drone 2.0 in conjunction with Windows</a></li>
<li><a href="../229879/index.html">Syringe - declarative IoC Container for PHP</a></li>
<li><a href="../229881/index.html">Update 1.0.8.19 for SailfishOS has been released</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>