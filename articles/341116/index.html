<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúI will find out! I recognize my brother Kohl! "- The realities of modern information security in the field of wireless technologies</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Plowing the vast expanses of the Internet, I repeatedly stumbled upon displeased reviews of users of the free Wi-Fi network of the Moscow metro MT_FRE...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúI will find out! I recognize my brother Kohl! "- The realities of modern information security in the field of wireless technologies</h1><div class="post__text post__text-html js-mediator-article">  Plowing the vast expanses of the Internet, I repeatedly stumbled upon displeased reviews of users of the free Wi-Fi network of the Moscow metro MT_FREE.  The problem was (by the way, things are still there) that the Wi-Fi network of ground-based urban transport had the same name as in the subway.  Imagine a situation: you go somewhere, listen to music, do not touch anyone, and then there is a byscis - a bus arises before you;  your phone notices the familiar Wi-Fi network and, utterly pleased with its resourcefulness, (to you, of course, not questioning) is speedily connected to it.  Instead of music, now you hear only the moaning sound of the bus leaving the distance. <br><br><img src="https://habrastorage.org/webt/cu/_q/-y/cu_q-yh2177sspkfqwczdtjyirw.jpeg"><a name="habracut"></a><br><br>  So, wait a second ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  <b>DO NOT EVEN THINK!</b> <br><br>  Material provided for informational purposes only.  I do not bear responsibility for any actions you have committed upon reading this article. </blockquote>  Another thing. <br><br><h3>  ‚ÄúAnd what actually happened?‚Äù </h3><br>  The other day I made a simple unit (which is in essence a mixture of powerbank and the well-known Orange Pi with an integrated Wi-Fi module), with which I had just set up an experiment, the task of which was to count the number of citizens (and also their warning about that they should be more serious about the integrity and security of their data), that they do not care about their security in the network.  Its essence is simple - OpenWrt is placed on an orange with dnsmasq (the latter is configured so that the client receives the same answer to any DNS request - it must contain the address of the local gateway on which the web server rotates) and an open Wi-Fi network, which is assigned the same notorious SSID - ‚ÄúMT_FREE‚Äù, after which the number of people and their smartphones (together with other devices) that connected to this network is counted. <br><br><div class="spoiler">  <b class="spoiler_title">We get a toy</b> <div class="spoiler_text">  /etc/dnsmasq.conf <br><blockquote>  ... <br><br>  address = / # / 192.168.1.1 </blockquote><br><br>  / etc / config / uhttpd <br><br><blockquote>  config uhttpd 'main' <br><br>  ... <br><br>  option error_page '/index.html' </blockquote><br><br>  / etc / config / dhcp <br><br><blockquote>  config dnsmasq <br><br>  ... <br><br>  option leasefile '/usr/share/dhcp/dhcp.leases' </blockquote><br><br>  / usr / bin / honeypot <br><br><pre><code class="hljs dos">### ###     ###    ### dhcp.leases  php.leases ### while :; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> clear &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -e "I'm $HOSTNAME!\\n`<span class="hljs-built_in"><span class="hljs-built_in">date</span></span> +<span class="hljs-variable"><span class="hljs-variable">%H:%</span></span>M:%S`\\n\\nDHCP leases: `wc -l /usr/share/dhcp/dhcp.leases`\\nPHP leases: `wc -l /usr/share/dhcp/php.leases`" &amp;&amp; sleep <span class="hljs-number"><span class="hljs-number">1</span></span>; done</code> </pre> </div></div><br>  For some time, data is collected and written to a file (in my case, dhcp.leases and php.leases).  The dhcp.leases file contains the information needed by the DHCP server to enforce certain IP addresses for each client for some time (some kind of lease).  A little different is the case with the php.leases file - after a user deliberately clicking on the ‚ÄúEnter Internet‚Äù button, a new line with pre-defined text is written to the file.  This is necessary in order to calculate the number of people that could be pressed on the button <s>and put themselves in danger</s> later.  Just want to draw attention to the fact that this is an ugly to horror crutch that was written on the knee (literally) for a few minutes in a shaking bus. <br><br><div class="spoiler">  <b class="spoiler_title">That's how this utter ugliness looks</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> shell_exec(<span class="hljs-string"><span class="hljs-string">'echo `date +%H:%M:%S` New DHCP lease and user action! &gt;&gt; /usr/share/dhcp/php.leases'</span></span>); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> </div></div><br><h3>  Well well!  And what about delicious? </h3><br>  You, probably, have already guessed without me - these are statistical data that the box has been carefully tamping for four hours.  I hasten to notice - the experiment began at seven in the morning and ended at exactly noon.  The venue is a rather large town near Moscow. <br><br>  For a relatively short period of time, a total of 95 devices managed to connect to my access point, of which: <br><br><ul><li>  24 ‚ÄúiPhone‚Äù phones (which is noteworthy - as a rule, their hostnames contain the names of the owners) </li><li>  31 Android phones </li><li>  1 "Windows Phone" </li><li>  1 BlackBerry </li><li>  10 "Redmi" by Xiaomi </li><li>  7 portable personal computers like "laptop" </li><li>  A number of other devices that support Wi-Fi connectivity. </li></ul><br><br><img src="https://habrastorage.org/webt/zz/ao/d4/zzaod4pa0yohuwh3li5ht2e8cga.png"><br><br>  79% of the devices connected to the access point offline, ie, without human intervention.  Only 20 people clicked on the ‚ÄúEnter Internet‚Äù button (21% of the total amount of all connected devices). <br><br><div class="spoiler">  <b class="spoiler_title">What is it fraught with?</b> <div class="spoiler_text">  Social engineering is a scary beast that ordinary citizens usually overlook.  We should be wary of this. <br><br>  As user <a href="https://habrahabr.ru/users/shanker/" class="user_link">shanker noted</a> , <br><blockquote>  Threats during automatic connection: <br>  1. Evilgrade type attack <br>  2. Social engineering and password removal (redirect to a similarly controlled site, but without HTTPS, or substitution for an illegitimate certificate) <br>  3. <a href="https://habrahabr.ru/company/pentestit/blog/339744/">Mining of cryptocurrency by upgrading the content issued to browsers</a> <a href="https://habrahabr.ru/company/pentestit/blog/339744/"><br></a>  4. Exploitation of vulnerabilities in browsers (by injection of exploits into the requested pages). </blockquote></div></div><br><div class="spoiler">  <b class="spoiler_title">How to protect yourself?</b> <div class="spoiler_text">  Disable auto-connect to Wi-Fi hotspots and clear the list of access points stored in the device‚Äôs memory. </div></div><br>  Now I would like to go directly to the practical part and show my ‚Äúmiracle machine‚Äù in action. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/9ypdGInEHuo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><div class="spoiler">  <b class="spoiler_title">‚ÄúComrades!</b>  <b class="spoiler_title">See all!</b>  <b class="spoiler_title">Lovers are beaten! ‚Äù</b> <div class="spoiler_text">  Due to the fact that in the world I am a seventeen year old convoy and I study at college, any criticism from the community is welcome.  Learning, as they say ... Light! </div></div><br>  I am very grateful for the attention paid, amico!  See you again! </div><p>Source: <a href="https://habr.com/ru/post/341116/">https://habr.com/ru/post/341116/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341106/index.html">Android O and background services</a></li>
<li><a href="../341108/index.html">Moxy Strategies (Part 2)</a></li>
<li><a href="../341110/index.html">Another operating system architecture</a></li>
<li><a href="../341112/index.html">Another virtual machine architecture (part one)</a></li>
<li><a href="../341114/index.html">Another virtual machine architecture (part two)</a></li>
<li><a href="../341118/index.html">Those. support. How much money can you make on this? (Part 2 - "Abroad")</a></li>
<li><a href="../341120/index.html">The project is blind: we dive headlong</a></li>
<li><a href="../341122/index.html">Yulmart game theory</a></li>
<li><a href="../341126/index.html">Vibe.js - an attempt to make state management without pain</a></li>
<li><a href="../341128/index.html">Economic experiments in virtual reality</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>