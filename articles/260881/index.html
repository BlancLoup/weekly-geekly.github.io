<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>First-aid kit sysadmin. Minimal set of utilities for the most effective problem solving</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Each sysadmin sometimes has to maintain computers of his acquaintances or make home-based trips. In this case, he helps a proven set of utilities. Our...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>First-aid kit sysadmin. Minimal set of utilities for the most effective problem solving</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/587/d98/f04/587d98f04c3872c730dfcc6b9d977057.jpg" alt="image"><br><br>  Each sysadmin sometimes has to maintain computers of his acquaintances or make home-based trips.  In this case, he helps a proven set of utilities.  Our review will tell only about free ones that do not require installation and which have become the de facto standard. <br><a name="habracut"></a><br><h4>  Autoruns </h4><br>  This program has become the hallmark of Mark Russinovich and Winternals Software (better known by the name of the site - Sysinternals.com), long taken up by Microsoft.  Now it is still being developed by the author, but legally owned by Microsoft‚Äôs technical department.  The current version is 13.3 written in April 2015.  Since v.13.0, the program has become not just more convenient, it has received a number of new functions, in particular, advanced filtering tools, integration with other system utilities and online services. <br><br>  Autoruns displays the most comprehensive and most detailed list of startup components, regardless of their type.  The utility shows how to download all drivers, programs (including system ones) and their modules by registry keys.  It even generates a list of all the extensions of Windows Explorer, the toolbar, automatically launched services, and many other objects, usually eluding other similar programs. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Color coding helps you quickly identify standard components that have a Microsoft digital signature, suspicious files, and erroneous lines that refer to non-existent files in a list of hundreds of records.  To disable the ability to autorun any component, simply uncheck the box opposite it to the left. <br><br><img src="https://habrastorage.org/files/70d/b78/5fa/70db785fa14d42e0be310c3a3b0608db.jpg"><br>  The ghosts of autorun objects in Autoruns are highlighted in yellow. <br><br>  Some components are automatically downloaded only when logging in to the system under a certain account.  In Autoruns, you can select records corresponding to each account and view them separately. <br><br>  Deserves attention and command line mode.  It is extremely convenient for exporting the list of startup items to a text file, creating advanced reports and selective anti-virus scanning of all suspicious objects.  Full help can be found <a href="https://technet.microsoft.com/en-us/sysinternals/bb963902.aspx">on the site</a> , here is an example of a typical command: <br><br><pre><code class="dos hljs">autorunsc -a blt -vrs -vt &gt; C:\Autor.log</code> </pre> <br>  Here, `autorunsc` is a program module that runs in command line mode.  The `-a` option indicates that objects to be checked are listed after it.  In the example there are three: b - boot execute (that is, everything that loads after the system is started and before the user enters);  l - logon, autoload components of a specific user, and t - scheduled tasks.  If instead of listing blt you specify an asterisk (*), then all startup objects will be checked. <br><br>  The keys `-vrs` and` -vt` indicate the mode of operation with the VirusTotal online service.  The first set is for sending only those files that do not have a Microsoft digital signature and have not been previously checked.  If at least one anti-virus out of fifty considers the file malicious, a detailed report will open in a separate browser tab.  The second set of keys is needed so that each time the tab with the user agreement on the use of the VirusTotal service does not open and you do not have to confirm acceptance of it. <br><br>  Autorunsc report is usually obtained in tens and hundreds of kilobytes.  Reading it on the screen is inconvenient, so in the example the output is redirected to a log file.  This is a plain text format encoded in UCS-2 Little Endian.  Here is an example of a recording from it with one false positive: <br><br><pre> <code class="dos hljs">HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run Adobe ARM "C:\Program Files (x86)\Common Files\Adobe\ARM\<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>\AdobeARM.exe" Adobe Reader and Acrobat Manager Adobe Systems Incorporated <span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">801</span></span>.<span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">4720</span></span> c:\program files (x86)\common files\adobe\arm\<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>\adobearm.exe <span class="hljs-number"><span class="hljs-number">20</span></span>.<span class="hljs-number"><span class="hljs-number">11</span></span>.<span class="hljs-number"><span class="hljs-number">2014</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">03</span></span> VT detection: <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">56</span></span> VT permalink: (   VirusTotal).</code> </pre><br><img src="https://habrastorage.org/files/82d/1dd/d34/82d1ddd342f24e4197380a69f9b5ca27.jpg"><br>  Two unsigned drivers turned out to be clean, and one signed driver has a VT reaction. <br><br>  Download Autoruns <a href="https://technet.microsoft.com/en-us/sysinternals/bb963902.aspx">on this page</a> . <br><br><h4>  Process explorer </h4><br>  The version of the program Autoruns with a graphical interface can work together with another utility of the same author - Process Explorer (PE).  If you first start PE, and then Autoruns, then the last menu will have additional items about viewing the properties of each active process from the autorun menu. <br><br>  In the PE settings, you can specify the desired way to display all active processes: a simple list with sorting by name or CPU utilization level, or a tree with dependencies.  An option is also set there that allows you to check unknown files (determined by hash) in VirusTotal.  If you turn it on, then after some time the result of the check will appear on the right.  All objects for which at least one anti-virus swears will be highlighted in red. <br><br>  When you press &lt;Ctrl + L&gt;, the window is split horizontally, and in the lower part, full information about the selected process and its actions in the system is displayed.  Pressing &lt;Ctrl + I&gt; will bring up an additional window with indicators of CPU utilization, GP, RAM, I / O intensity, drive utilization, and network.  For each component, the total load and the most demanding process are displayed.  For GP, even the percentage of occupied video memory and the load on each chip are shown, if there are several of them.  Now it is especially important, since many (malicious) programs actively use video cards for non-graphical calculations.  Especially this behavior is typical for Trojan miners cryptocurrency. <br><br><img src="https://habrastorage.org/files/1e7/ecd/805/1e7ecd8059ae4ccb8ad06c1bdf20dd04.jpg"><br>  The test Trojan does not look suspicious yet, and four antiviruses are already fighting on ¬µTorrent <br><br>  By right-clicking on any process from the PE list, a context menu appears.  It duplicates all the functions of the built-in Task Manager and adds several new ones.  In particular, with one click you can send the appropriate file to a suspicious process for analysis in VirusTotal, search for its description on the Internet, make a dump or suspend execution.  The paused process stops responding to any commands (including internal), and it becomes easier to analyze.  After you have dealt with it, you can send the ‚Äúresume‚Äù (resume) command through Process Explorer.  Of course, without urgent need, you should not do this with system processes and utilities that perform low-level operations.  BIOS / UEFI flashing, changing disk layout, partition alignment and other similar operations should not be interrupted. <br><br>  Usually in the title of each window the name of the application that generated it is indicated, but it happens that they remain nameless.  This is especially true for Trojans, which mimic the work of well-known programs or small dialog boxes with error codes.  Process Explorer has a handy ‚Äúfind process by window‚Äù function.  It is enough to click this button on the top panel and, holding the left mouse button, move the cursor to the area of ‚Äã‚Äãthe strange window.  The corresponding process is automatically highlighted in the PE table. <br><br><img src="https://habrastorage.org/files/858/804/0fd/8588040fdd55443ab3ae8b79b6dfb29d.jpg"><br>  Test Trojan suspended via Process Explorer <br><br>  To use all the features of Process Explorer, you need to run it with administrator rights and (in some cases) install Debugging Tools for Windows.  They can be <a href="https://msdn.microsoft.com/en-us/windows/hardware/hh852365">downloaded separately</a> or downloaded as part of the <a href="https://msdn.microsoft.com/library/windows/hardware/ff557573">Windows Driver Kit</a> .  The latest version of Process Explorer can be downloaded <a href="https://technet.microsoft.com/en-us/sysinternals/bb896653.aspx">from the Microsoft website</a> . <br><br><h4>  Unlocker </h4><br>  Without a doubt, Mark Russinovich is a real guru among the authors of system utilities for Windows, but his programs were created as universal tools.  Sometimes it is worth using more highly specialized means.  Such as the creation of the French programmer Cedrick Collom (Cedrick Collomb).  Its tiny utility Unlocker can only do one thing: unlock a file system object that is occupied by a process in order to regain control of it.  Although the latest version was released in 2013, the program still performs its functions best of all.  For example, it allows you to unload dynamic libraries from memory, delete the index.dat file, work with file names that are forbidden in Windows, and perform most actions without rebooting. <br><br><img src="https://habrastorage.org/files/ef5/7fa/8ff/ef57fa8ff1784596b2a40dd8c9d4d5d6.jpg"><br>  Some process blocks the removal of Safari <br><br>  Unloker defines the descriptors of running processes that are currently blocking work with the desired file or directory.  Such blocking is required to eliminate the mutual influence of applications in a multitasking environment.  During normal operation of the OS and programs, it excludes accidental deletion of used files, but sometimes there are errors.  As a result, one of the applications may freeze or remain in memory after the window is closed.  Then the file system object can remain locked even after this is no longer necessary. <br><br>  Today, the list of active processes in an ordinary user starts from fifty, so you can search for zombies among them for a long time.  Unlocker helps to immediately determine which process blocks the change or deletion of the selected file or directory.  Even if he cannot find out because of the limitations of the Win32 API, he will offer to force the desired action: rename, move, or delete the object. <br><br><img src="https://habrastorage.org/files/ba0/e80/189/ba0e801891424484a37251a658a9b3f2.jpg"><br>  Unlocker did not find the cause of the lock, but it can delete the recalcitrant file <br><br>  Sometimes several programs can access one directory at once, so several descriptors are defined at once among the processes blocking it.  Unlocker has the ability to unlock all of them with one button. <br><br>  Starting from version 1.9.0, 64-bit versions of Windows are supported.  The utility can be integrated into the context menu of the explorer or run in graphical mode as a portable application.  You can also install Unlocker Assistant.  It will hang in the tray and automatically cause Unlocker whenever the user tries to perform manipulations with the locked file.  Running with the `-h` key will display help on command line mode.  The utility is available in forty languages, although there is nothing special to translate in it - everything is so intuitively clear. <br><br><h4>  AVZ </h4><br>  Looking at the list of features of the AVZ utility, I would like to call it analytical, not anti-virus.  The tiny program of Oleg Zaitsev has many irreplaceable functions that facilitate the daily tasks of the administrator and the life of the advanced user.  It will help you do system research, restore stray settings of embedded OS components to default settings, detect any changes since the last audit, find potential security problems, remove Trojan components from SPI Winsock and reconnect to the Internet, detect strange program behavior and detect rootkits. kernels. <br><br><img src="https://habrastorage.org/files/fb9/4f4/048/fb94f404877349b2afde716776c1df18.jpg"><br>  AVZ contains many system analysis tools. <br><br>  Known malware is better to remove using other virus scanners.  AVZ is useful for dealing with an unknown evil, finding holes through which it can leak, and eliminating the effects of infection.  In most cases, AVZ can do without reinstalling the OS, even after a severe virus attack. <br><br>  You can use AVZ as a portable application, but the full set of utility functions will be revealed only if you install AVZPM - your own kernel mode driver.  It controls all modules, drivers, and active applications, making it easy to identify masking processes and any technology to replace their identifiers. <br><br>  AVZGuard is another kernel mode driver that can be activated from the AVZ menu.  It restricts the access of active processes by suppressing anti-virus activity on the infected computer.  This approach allows you to run from the AVZ window any application (including another antivirus) in protected mode. <br><br>  One of the cunning technologies of countering malware remains the method of blocking its files and recreating the elements deleted by the antivirus the next time the OS is loaded.  Manually it partially costs using Unlocker, but AVZ has its own technology - Boot Cleaner.  This is another kernel-mode driver that extends the capabilities of the delayed-delete feature on Windows that is restarted.  It loads earlier, logs the results of work and can delete registry entries, as well as files. <br><br>  AVZ itself also has a lot of know-how.  It is capable of checking alternative NTFS streams and speeding up the scan by excluding files from it that have been identified as safe from a Microsoft catalog or from its own database.  All threats can be searched for certain types - for example, immediately exclude the HackTool category.  There are separate modules for searching for keyboard interceptors, open ports with Trojan horses and behavioral analysis.  AVZ allows you to copy suspicious and deleted files in separate folders for further detailed examination. <br><br><img src="https://habrastorage.org/files/851/ab3/300/851ab3300d3c4f119db0ded138af21fc.jpg"><br>  Creating a detailed study protocol in AVZ <br><br>  The requirement to send reports to AVZ and its System Investigation Module has become standard practice in many virology forums, where they seek help in solving non-trivial problems. <br><br>  Of course, the first-aid kit of an experienced admin may have more than one dozen programs, but these four utilities will suffice to solve most of the tasks.  The rest you can easily find in the selections on the links specified in the article. <br><br><blockquote><h4>  Www </h4><br>  The complete archive of system utilities SysInternals - 73 programs <a href="">live.sysinternals.com/Files/SysinternalsSuite.zip</a> <br>  The complete archive of system utilities NirSoft - 56 programs <a href="http://www.nirsoft.net/system_tools.html">www.nirsoft.net/system_tools.html</a> <br>  Developer site AVZ <a href="http://z-oleg.com/">z-oleg.com</a> </blockquote><br><blockquote><h4>  WARNING! </h4><br>  Using system utilities requires an understanding of the logic of their work and the device itself OS.  Check out the help before making changes to the registry and interfere with the work of active processes. </blockquote><br><img src="https://habrastorage.org/files/270/d89/03d/270d8903d5fc42ae9e59e4e73b5bf8ca.jpg"><br><br>  <i>First published in Hacker Magazine # 197.</i> <i><br></i>  <i>Posted by: 84ckf1r3</i> <br><br>  Subscribe to "Hacker" <br><ul><li>  <a href="https://xakep.ru/wp-admin/profile.php%3Fpage%3Dpaywall_subscribes">Site materials</a> </li><li>  <a href="http://bit.ly/habr_subscribe_paper">Paper version</a> </li><li>  <a href="http://bit.ly/xakep_on_ipad">Hacker on iOS / iPad</a> </li><li>  <a href="http://bit.ly/habr_android">"Hacker" on Android</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/260881/">https://habr.com/ru/post/260881/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260869/index.html">ELK + R as log repository</a></li>
<li><a href="../260873/index.html">How to learn on ABAPer?</a></li>
<li><a href="../260875/index.html">Exceptionally simple tasks using AppSec .NET</a></li>
<li><a href="../260877/index.html">Wirmaker Abbreviations: WIM, CSRSS, EMET, CCMP, EFS, SEHOP, ASLR, KPP, UAC, DEP and one more thing</a></li>
<li><a href="../260879/index.html">Malware for OS X: the complete chronicle. The most iconic apple pests of this decade</a></li>
<li><a href="../260889/index.html">Microsoft cloud services popularity rating in 2015</a></li>
<li><a href="../260891/index.html">Copy dallas keys. Record on rw1990 (rw1990.1)</a></li>
<li><a href="../260893/index.html">Streets and Heroes</a></li>
<li><a href="../260895/index.html">How I painted the design of the application for the contest Mail.Ru Group</a></li>
<li><a href="../260897/index.html">Small joys of structured metadata</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>