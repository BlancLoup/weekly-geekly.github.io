<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Functional thinking. Part 5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous post about currying, we saw how functions with several parameters are split up into smaller functions, with one parameter. This is a m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Functional thinking. Part 5</h1><div class="post__text post__text-html js-mediator-article"><p>  In the previous post about currying, we saw how functions with several parameters are split up into smaller functions, with one parameter.  This is a mathematically correct solution, but there are other reasons for doing so ‚Äî it also leads to a very powerful technique called <strong>partial application of functions</strong> .  This style is very widely used in functional programming, and it is very important to understand it. </p><br><p><img src="https://habrastorage.org/webt/7j/cd/7x/7jcd7xzdvnhpyxuebjvbzb1uiqs.jpeg"></p><br><ul><li>  <strong><a href="https://habr.com/company/microsoft/blog/415189/">First part</a></strong> </li><li>  <strong><a href="https://habr.com/company/microsoft/blog/420039/">The second part of</a></strong> </li><li>  <strong><a href="https://habr.com/company/microsoft/blog/422115/">The third part</a></strong> </li><li>  <strong><a href="https://habr.com/company/microsoft/blog/430620/">Fourth part</a></strong> <a name="habracut"></a></li></ul><br><h1>  Partial application of functions </h1><br><p>  The idea of ‚Äã‚Äãpartial application is that if we fix the first N parameters of the function, we get a new function with the remaining parameters.  From the discussion of currying it was possible to see how the partial application occurs naturally. <br>  A few simple examples to illustrate: </p><br><pre><code class="plaintext hljs">//  ""       +  42 let add42 = (+) 42 //    add42 1 add42 3 //       //      [1;2;3] |&gt; List.map add42 //          "" let twoIsLessThan = (&lt;) 2 //   twoIsLessThan 1 twoIsLessThan 3 //      twoIsLessThan [1;2;3] |&gt; List.filter twoIsLessThan //   ""       printfn let printer = printfn "printing param=%i" //      printer    [1;2;3] |&gt; List.iter printer</code> </pre> <br><p>  In each case, we create a partially applied function that can be reused in different situations. </p><br><p>  And of course, partial application makes it easy to fix the function parameters.  Here are some examples: </p><br><pre> <code class="plaintext hljs">//    List.map let add1 = (+) 1 let add1ToEach = List.map add1 //   "add1"  List.map //  add1ToEach [1;2;3;4] //    List.filter let filterEvens = List.filter (fun i -&gt; i%2 = 0) //    //  filterEvens [1;2;3;4]</code> </pre> <br><p>  The following, more complex example illustrates how the same approach can be used to transparently create "embedded" behavior. </p><br><ul><li>  We create a function that adds two numbers, but in addition it accepts a logging function that will log these numbers and the result. </li><li>  The logging function takes two parameters: (string) "name" and (generic) "value", therefore, it has the signature <code>string-&gt;'a-&gt;unit</code> . </li><li>  Then we create various implementations of the logging function, such as a console logger or a logger based on a popup window. </li><li>  Finally, we partially apply the main function to create a new function, with a closed logger. </li></ul><br><pre> <code class="plaintext hljs">//      - let adderWithPluggableLogger logger xy = logger "x" x logger "y" y let result = x + y logger "x+y" result result //  -      let consoleLogger argName argValue = printfn "%s=%A" argName argValue //           let addWithConsoleLogger = adderWithPluggableLogger consoleLogger addWithConsoleLogger 1 2 addWithConsoleLogger 42 99 //  -      let popupLogger argName argValue = let message = sprintf "%s=%A" argName argValue System.Windows.Forms.MessageBox.Show( text=message,caption="Logger") |&gt; ignore //    -       let addWithPopupLogger = adderWithPluggableLogger popupLogger addWithPopupLogger 1 2 addWithPopupLogger 42 99</code> </pre> <br><p>  These functions with a closed logger can be used like any other functions.  For example, we can create partial applications for appendix 42, and then pass it to the list function, as we did for the simple function " <code>add42</code> ". </p><br><pre> <code class="plaintext hljs">//         42 let add42WithConsoleLogger = addWithConsoleLogger 42 [1;2;3] |&gt; List.map add42WithConsoleLogger [1;2;3] |&gt; List.map add42 //    </code> </pre> <br><p>  Partially applied functions are a very useful tool.  We can create flexible (albeit complex) library functions, and it is easy to make them reusable by default, so the complexity will be hidden from client code. </p><br><h2>  Designing functions for partial applications </h2><br><p>  Obviously, the order of the parameters can seriously affect the convenience of partial applications.  For example, most functions in <code>List</code> such as <code>List.map</code> and <code>List.filter</code> have a similar form, namely: </p><br><pre> <code class="plaintext hljs">List-function [function parameter(s)] [list]</code> </pre> <br><p>  The list is always the last parameter.  A few examples in full form: </p><br><pre> <code class="plaintext hljs">List.map (fun i -&gt; i+1) [0;1;2;3] List.filter (fun i -&gt; i&gt;1) [0;1;2;3] List.sortBy (fun i -&gt; -i ) [0;1;2;3]</code> </pre> <br><p>  The same examples using partial applications: </p><br><pre> <code class="plaintext hljs">let eachAdd1 = List.map (fun i -&gt; i+1) eachAdd1 [0;1;2;3] let excludeOneOrLess = List.filter (fun i -&gt; i&gt;1) excludeOneOrLess [0;1;2;3] let sortDesc = List.sortBy (fun i -&gt; -i) sortDesc [0;1;2;3]</code> </pre> <br><p>  If library functions were implemented with a different order of arguments, partial application would be much less convenient. </p><br><p>  When you write your function with many parameters, you can think about their best order.  As with all design issues, there is no ‚Äúright‚Äù answer, but there are a few generally accepted recommendations. </p><br><ol><li>  Put in the beginning of the parameters that are likely to be static </li><li>  Put the latest data structures or collections (or other variable parameters) </li><li>  For a better perception of operations, such as subtraction, it is desirable to observe the expected order. </li></ol><br><p>  The first tip is simple.  The parameters that are most likely to be ‚Äúfixed‚Äù by partial application should go first, as in the examples with the logger above. </p><br><p>  Following the second tip makes it easy to use the pipeline operator and composition.  We have already seen this many times in the examples with functions on lists. </p><br><pre> <code class="plaintext hljs">//          let result = [1..10] |&gt; List.map (fun i -&gt; i+1) |&gt; List.filter (fun i -&gt; i&gt;5)</code> </pre> <br><p>  Similarly, partially applied functions on lists are easily subject to composition, since  list parameter can be omitted: </p><br><pre> <code class="plaintext hljs">let compositeOp = List.map (fun i -&gt; i+1) &gt;&gt; List.filter (fun i -&gt; i&gt;5) let result = compositeOp [1..10]</code> </pre> <br><h3>  Wrapping BCL functions for partial applications </h3><br><p>  The functions of the base class library (base class library - BCL) .NET are easily accessible from F #, but they are designed for use in functional languages ‚Äã‚Äãsuch as F #.  For example, most functions require a data parameter at the beginning, while in F #, the data parameter should generally be the last. </p><br><p>  However, it is easy enough to write wrappers to make these functions more idiomatic.  In the example below, the string .NET functions are rewritten so that the target string is used last, not first: </p><br><pre> <code class="plaintext hljs">//     .NET  let replace oldStr newStr (s:string) = s.Replace(oldValue=oldStr, newValue=newStr) let startsWith lookFor (s:string) = s.StartsWith(lookFor)</code> </pre> <br><p>  After the line has become the last parameter, you can use these functions in pipelines as usual: </p><br><pre> <code class="plaintext hljs">let result = "hello" |&gt; replace "h" "j" |&gt; startsWith "j" ["the"; "quick"; "brown"; "fox"] |&gt; List.filter (startsWith "f")</code> </pre> <br><p>  or in the composition of functions: </p><br><pre> <code class="plaintext hljs">let compositeOp = replace "h" "j" &gt;&gt; startsWith "j" let result = compositeOp "hello"</code> </pre> <br><h3>  Understanding the pipeline operator </h3><br><p>  After you have seen the partial application in business, you can understand how pipeline functions work. </p><br><p>  The pipeline function is defined as: </p><br><pre> <code class="plaintext hljs">let (|&gt;) xf = fx</code> </pre> <br><p>  All it does is allow the argument to be set before the function, not after. </p><br><pre> <code class="plaintext hljs">let doSomething xyz = x+y+z doSomething 1 2 3 //    </code> </pre> <br><p>  In the case when the function <code>f</code> has several parameters, and the last parameter of the function <code>f</code> will act as the input value <code>x</code> pipeline.  The actually passed function is already partially applied and expects only one parameter - the input value for pipelining (T e <code>x</code> ). </p><br><p>  Here is a similar example rewritten for partial application. </p><br><pre> <code class="plaintext hljs">let doSomething xy = let intermediateFn z = x+y+z intermediateFn //  intermediateFn let doSomethingPartial = doSomething 1 2 doSomethingPartial 3 //       3 |&gt; doSomethingPartial //    ,       </code> </pre> <br><p>  As you've already seen, the pipeline operator is extremely common in F #, and is used whenever you want to preserve the natural flow of data.  Some more examples you may have encountered: </p><br><pre> <code class="plaintext hljs">"12" |&gt; int //   "12"  int 1 |&gt; (+) 2 |&gt; (*) 3 //  </code> </pre> <br><h3>  Reverse conveyor operator </h3><br><p>  From time to time you can meet the inverse pipeline operator "&lt;|". </p><br><pre> <code class="plaintext hljs">let (&lt;|) fx = fx</code> </pre> <br><p>  It seems that this function does nothing, so why does it exist? </p><br><p>  The reason is that when the inverse pipelined operator is used as a binary operator in the infix style, it reduces the need for brackets, which makes the code cleaner. </p><br><pre> <code class="plaintext hljs">printf "%i" 1+2 //  printf "%i" (1+2) //   printf "%i" &lt;| 1+2 //   </code> </pre> <br><p>  You can use pipelines in two directions at once to get pseudoinfix notation. </p><br><pre> <code class="plaintext hljs">let add xy = x + y (1+2) add (3+4) //  1+2 |&gt; add &lt;| 3+4 //  </code> </pre> <br><h1>  Additional resources </h1><br><p>  For F #, there are many tutorials, including materials for those who come with C # or Java experience.  The following links may be helpful as you learn more about F #: </p><br><ul><li>  <a href="https://docs.microsoft.com/en-US/dotnet/fsharp/">F # Guide</a> </li><li>  <a href="https://swlaschin.gitbooks.io/fsharpforfunandprofit/content/">F # for Fun and Profit</a> </li><li>  <a href="https://en.wikibooks.org/wiki/F_Sharp_Programming">F # Wiki</a> </li><li>  <a href="https://learnxinyminutes.com/docs/fsharp/">Learn X in Y Minutes: F #</a> </li></ul><br><p>  Several other ways <a href="https://docs.microsoft.com/en-us/dotnet/fsharp/get-started/">to get started with learning F # are</a> also described. </p><br><p>  Finally, the F # community is very friendly to beginners.  There is a very active Slack chat, supported by the F # Software Foundation, with rooms for beginners that you <a href="http://foundation.fsharp.org/join">can freely join</a> .  We strongly recommend that you do this! </p><br><p>  Do not forget to visit the site of the <a href="http://fsharplang.ru/">Russian-speaking community F #</a> !  If you have any questions about learning the language, we will be happy to discuss them in chat rooms: </p><br><ul><li>  Room <code>#ru_general</code> in <a href="http://foundation.fsharp.org/join">Slack chat F # Software Foundation</a> </li><li>  <a href="https://t.me/Fsharp_chat">chat in Telegram</a> </li><li>  <a href="http://gitter.im/fsharplang_ru">chat in gitter</a> </li></ul><br><h2>  About authors of translation </h2><br><p>  Translated by <a href="https://habrahabr.ru/users/kleidemos/"><em>@kleidemos</em></a> <br><img src="https://habrastorage.org/getpro/habr/post_images/f95/c6d/92c/f95c6d92c5b1126b093792a43955aa43.png" width="56" height="56">  Translation and editorial changes are made by the efforts of the <a href="http://fsharplang.ru/">Russian-speaking community of F # -developers</a> .  We also thank <a href="https://habrahabr.ru/users/schvepsss/"><em>@schvepsss</em></a> and <a href="https://habr.com/users/shwars/"><em>@shwars</em></a> for preparing this article for publication. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/430622/">https://habr.com/ru/post/430622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../430612/index.html">As in the 1980s, people downloaded radio games</a></li>
<li><a href="../430614/index.html">Black Friday 2018 at Madrobots</a></li>
<li><a href="../430616/index.html">Workshop "Testing and Monitoring", November 27, Moscow</a></li>
<li><a href="../430618/index.html">Vue.js SSR & Mobile Safari: Unobvious Problem With Too Smart Software</a></li>
<li><a href="../430620/index.html">Functional thinking. Part 4</a></li>
<li><a href="../430626/index.html">Announcement of Moscow GraphQL Meetup</a></li>
<li><a href="../430628/index.html">Forchun algorithm, implementation details</a></li>
<li><a href="../430630/index.html">Comparison sneak "Two Balls" from the 60s and 2016. From the sole to the laces</a></li>
<li><a href="../430634/index.html">Creating a software module for the programmer XELTEK SuperPro 6100</a></li>
<li><a href="../430636/index.html">Cerebellum and basal nuclei instead of a crystal ball: how the brain predicts the future</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>