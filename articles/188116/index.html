<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic update of Adobe Flash Player & Java RE in the Windows / AD domain</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 
 I uploaded a script on the gitkhub VBS that has been keeping the installed versions of Java & Flash on users' computers in the Windows domain...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic update of Adobe Flash Player & Java RE in the Windows / AD domain</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br>  I uploaded a script on the gitkhub VBS that has been keeping the installed versions of Java &amp; Flash on users' computers in the Windows domain (Active Directory) for more than a year, with minimal administrative effort and minimal inconvenience to users. <br><br>  Why I had to reinvent the wheel and how to use this script, see below. <br><a name="habracut"></a><br><br><h4>  intro </h4><br>  It‚Äôs no secret that Flash &amp; Java‚Äôs vulnerabilities, which are exploited during regular visits to malicious or hacked sites, are one of the most popular attacks on computers today (for example, mysql.com in September 2011) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And although Adobe and Oracle have already implemented auto-update mechanisms in their products, their essential drawback is the difficulty in setting up and operating.  In order to use the automatic update mechanism from Adobe, you will have to browse the 50-page <a href="http://www.adobe.com/devnet/flashplayer/articles/flash_player_admin_guide.html">Administration Guide</a> and do a lot of actions, and to install the update from Sun, you need the user to have local administrator rights, which is often found among home users and never in a domain network a good administrator. <br><br>  The question on serverfault.com <a href="http://serverfault.com/questions/22429/how-do-you-manage-java-in-your-windows-active-directory-environment">‚ÄúHow do you manage Java in your Windows / Active Directory environment?‚Äù</a> Did not receive a clear answer, just general words about using scripts and Group Policy, manually reassembling MSI packages, using third-party services (ninite.com).  However, all this requires constant manual work, and for a good admin everything should happen automatically. <br><br>  Thus, maintaining the current versions of the installed browser plug-ins is shifted onto the administrator‚Äôs shoulders and becoming a serious task - it‚Äôs necessary to track the appearance of updates on manufacturers ‚Äôwebsites (this is easy to do with planned updates, and sometimes urgent ones are unplanned), download and upload to a local repository, create installation files (for example, MSI), monitor the progress of deployment of updates ... <br>  Large companies use large products like SCCM for these purposes, medium ones use WSUS + <a href="http://localupdatepubl.sourceforge.net/">Local Update Publisher</a> (there is a <a href="http://habrahabr.ru/post/150518/">tutorial</a> on <a href="http://habrahabr.ru/users/yosemity/" class="user_link">Habr√©</a> about it from <a href="http://habrahabr.ru/users/yosemity/" class="user_link">yosemity</a> , and <a href="http://habrahabr.ru/users/foxyovovich/" class="user_link">foxyovovich</a> suggested a <a href="http://sourceforge.net/apps/mediawiki/localupdatepubl/index.php%3Ftitle%3DMain_Page">wiki</a> where everything is described about java, flash, reader), and small ones simply start the process on drift.  What is interesting, on request ‚Äúautomatic update of java‚Äù in Google on the first page, half of the links focus on the problem of <i>how to disable automatic updating of Java</i> . <br><br><h4>  FJUpdater.vbs </h4><br>  For those who already have AD, but WSUS is not yet (or WSUS is, but there is no time / opportunity / desire to do manual work) I suggest FJUpdater.vbs.  This is a VBS script written 1.5 years ago to simplify your life and automate the execution of this task.  The script checks the relevance of Java &amp; Flash versions installed on the computer (comparing with information from Sun &amp; Adobe sites or local repository), and, if necessary, automatically downloads (via the Internet (HTTP) or local area network (SMB) respectively) and installs updates.  It is proposed to run the script on users' computers through group policies (GPO) - the ‚ÄúStartup‚Äù option in the ‚ÄúComputer Configuration‚Äù section.  In this case, the updates will be installed with local administrator rights when the computer is booted, silently and invisibly to the user. <br><br>  About errors and the results of their activities can send a report to the mail. <br>  The script successfully works in 6 companies that are not related to each other, within my area of ‚Äã‚Äãresponsibility, with a number of users from 10 to 300. <br><h5>  General scheme of installation and operation </h5><br><br>  1) Create a network folder that is <b>writeable</b> for the user account, on behalf of which the update check on the Internet will be launched, and <b>readable</b> for the Domain Computers group. <br><br>  2) Download the script, place it, for example, in the NETLOGON folder on the domain controller and edit the send mail section and save installers path in the <b>csInstallerPath</b> constant. <br><br>  3) Select any computer (for example, a virtual machine) with the same OS as the users.  This computer will be the control ‚Äúreference indicator‚Äù - versions of plug-ins via the Internet will be compared with it.  Therefore, it should be installed all the plugins and set up their regular checks. <br><br>  To do this, first run the script with the key <b>/ WEBModeSaveInstallForce</b> .  The current versions of the installers are downloaded and placed in the local folder (csInstallerPath), and the flag files with the version numbers of the plug-ins are generated.  After successful receipt, we install all the plugins one by one - we run <b>java_installer.exe</b> for Java, <b>flashP_installer.exe</b> for Flash Player Plugin (Firefox, Mozilla, Netscape, Opera) and <b>flashA_installer.exe</b> for Flash Player ActiveX (IE). <br><br>  Native auto-update mechanisms should be disabled.  How to do this for Java can be viewed <a href="">on the official website</a> .  In the case of Flash, select "Never check for updates." <br><br>  Instead, in order to keep the reference computer and network repository up-to-date, we set up regular launch of the script with the <b>/ WEBModeSaveInstall</b> key <b>: 1</b> through the task scheduler or nncron. <br><br>  4) In the group policies of client computers, in the section Computer Configuration \ Windows Configuration \ Scripts (Startup \ End) \ Startup (Computer Configuration \ Windows Settings \ Scripts \ Startup), add the launch of the script with the <b>/ WEBMode</b> key <b>: 0</b> <br><br>  When the client computer is restarted, the versions of the installed plugins will be updated - Java, Flash Player Plugin, Flash Player ActiveX <br><img src="https://habrastorage.org/storage2/878/a98/a86/878a98a862cf66148bfae8a40105cc18.png" alt="image"><br><br>  Other command line options (available with standard /? Or / help switches) <br><br>  / mail: 1 = send e-mail in case of work errors or updates. <br><br>  / debug: 0 = do not output anything <br>  / debug: 1 = write only action messages (default) <br>  / debug: 2 = write detailed messages <br>  / debug: 3 = write detailed messages about called functions and their parameters <br><br>  / MailTest = checking the correctness of the mail sending setting (sends a test message) <br><br>  / ShowVersion [: comp] = displays the versions of Java &amp; Flash plug-ins installed on the computer.  When started without parameters - on the local computer, if there is a parameter - it is interpreted as the name \ address of the computer <br><br>  When run without parameters, the script simply updates the installed plugins via the Internet. <br><br>  Lives here: <a href="https://github.com/osterik/FJUpdater">github.com/osterik/FJUpdater</a> <br><br>  At the writing of this script inspired the idea, gleaned from <a href="http://sourceforge.net/users/ccccp">ccccp</a> workshop <a href="http://sourceforge.net/users/ccccp">colleague</a> , the author of the utility <a href="http://sourceforge.net/projects/netopmanager">NetOp Manager</a> .  But its mechanism required the use of a separate Perl-script for each plug-in, could not automatically scratch the link to download Java updates from the Sun website, and the client part was written in KiXtart, which created certain difficulties in setting up the entire farm. <br><br><h5>  How it works </h5><br>  The structure is quite simple - information about the program (it is also displayed when requesting help), configuration settings, general logic (Main), specific code for working with Adobe &amp; Sun sites, service procedures and functions (access to files, registry, http, sending mail and etc.) <br><br><h4>  Subtle moments </h4><br>  In the case of JAVA, the current version number can simply be found in the <a href="http://www.java.com/applet/JreCurrentVersion2.txt">www.java.com/applet/JreCurrentVersion2.txt</a> file, but in order to download the full (offline) installer, you need to look at the link on the <a href="http://java.com/en/download/windows_manual.jsp">java.com/en/download/windows_manual.jsp</a> page .  For version <a href="http://javadl.sun.com/webapps/download/AutoDL%3FBundleId%3D79063">1.7.25</a> , it is equal to <a href="http://javadl.sun.com/webapps/download/AutoDL%3FBundleId%3D79063">javadl.sun.com/webapps/download/AutoDL?BundleId=79063</a> , but for each version the numbers are different.  This task is solved in the sJavaGetLinkToDownload function. <br><br>  In the case of Flash, the opposite is true: parsing accounts for the current version number (on <a href="http://www.adobe.com/software/flash/about">www.adobe.com/software/flash/about</a> ).  The sFlashVersionWEBGet function searches for table cells with a sequence of 4 numbers separated by dots and, depending on the sFlashType parameter (type of Flash player (A = ActiveX, P = Plugin), returns the first or third line of the table. The full installation packages are loaded the links <a href="">download.macromedia.com/pub/flashplayer/current/support/install_flash_player.exe</a> and <br>  <a href="">download.macromedia.com/pub/flashplayer/current/support/install_flash_player_ax.exe</a> . <br><br>  Naturally, the references change from time to time, therefore, in order not to miss this moment, it is recommended on the computer from P3.  (which regularly runs the script with the <b>/ WEBModeSaveInstall</b> key <b>: 1</b> ) also include sending logs by mail, key <b>/ mail: 1</b> .  When detecting discrepancies between versions or errors of the functions for accessing manufacturers' websites, the script will be felt. <br><br>  I hope FJUpdater will be a great gift for system administrators, whose holiday we recently celebrated! </div><p>Source: <a href="https://habr.com/ru/post/188116/">https://habr.com/ru/post/188116/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../188104/index.html">Configuring WebSVN on Windows for integration into Jira with support for SVN authorization and Delphi source encoding</a></li>
<li><a href="../188106/index.html">Django development server and HTTPS testing</a></li>
<li><a href="../188108/index.html">Articles about a portable Linux server for newbies - are they needed?</a></li>
<li><a href="../188110/index.html">ExtJs as a maven dependency</a></li>
<li><a href="../188114/index.html">A real multi-threaded web server in assembler for Linux</a></li>
<li><a href="../188118/index.html">Generating the tree menu of the Nested Sets view model</a></li>
<li><a href="../188122/index.html">Printed weapon</a></li>
<li><a href="../188124/index.html">Metric # 16 - Podcast on technologies and design of interfaces and services</a></li>
<li><a href="../188128/index.html">Survey: How did you learn / learn to program?</a></li>
<li><a href="../188130/index.html">Details about Xamarin</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>