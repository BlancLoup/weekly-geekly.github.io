<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What are dangerous social networks on your PC?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Researchers at Trend Micro discovered a new cryptocurrency bot miner that spreads through Facebook Messenger. It was first spotted in South Korea and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What are dangerous social networks on your PC?</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/cloud4y/blog/345342/"><img src="https://habrastorage.org/webt/an/dg/ke/andgkemiow-c7cdew2u-hm5652q.png"></a> <br><br>  Researchers at Trend Micro discovered a new cryptocurrency bot miner that spreads through Facebook Messenger.  It was first spotted in South Korea and given the nickname Digmine.  Digmine was also spreading in other regions, such as Vietnam, Azerbaijan, Ukraine, Vietnam, the Philippines, Thailand and Venezuela. <a name="habracut"></a><br><br>  Facebook Messenger works on different platforms, but Digmine is dangerous only for the desktop / web browser version.  If you open the file on other platforms, such as mobile devices, the malware will not work properly. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To create Digmine, AutoIt is used ‚Äî a free language for automating task execution in Microsoft Windows.  The file is sent to potential victims in the form of a video file, but is actually an executable script on AutoIt.  If a Facebook user account is configured to automatically log in, Digmine will use the victim's Facebook Messenger to send a link to the file to the user's friends.  At the moment, the bot is only engaged in the spread of malware.  Later, the functionality can be updated by changing the code using the C &amp; C server (command-and-control). <br><br>  For successful operation of botnets for mining cryptocurrencies and, in particular, Digmine, which produces Monero, attackers need to stay in the victim's system as long as possible.  The virus also needs to infect as many machines as possible, as this leads to an increase in hashrate and potentially to a greater criminal income. <br><br><img src="https://habrastorage.org/webt/zu/vq/cs/zuvqcsh6ppifb_ucchsvcf84gxm.jpeg"><br>  <i>Figure 1: Digmine attack chain</i> <br><br><img src="https://habrastorage.org/webt/ng/bm/nv/ngbmnvncwib4rb74pqadnimnxuq.jpeg"><br>  <i>Figure 2: Digmine link sent via Facebook Messenger</i> <br><br><h3>  Chain of infection </h3><br>  Digmine is a bootloader that first connects to a C &amp; C server to get multiple components.  The initial configuration contains links from which components are downloaded.  Most of them are also hosted on the same C &amp; C server.  It saves the loaded components in the% appdata% \ username directory. <br><br><img src="https://habrastorage.org/webt/it/ju/nz/itjunz3bw1ao1svbydngxzfgius.png"><br><br><img src="https://habrastorage.org/webt/8g/_f/mm/8g_fmms5swbhck-vkiyn-mxisuq.png"><br>  <i>Figure 3: Configuration and loaded components</i> <br><br>  Digmine will perform other procedures, such as adding a startup to the registry, running Chrome, and installing a malicious browser extension, which will be received from the C &amp; C server.  If Chrome is already running, the malware will shut down and restart.  Although extensions can only be downloaded from the Chrome Web Store, attackers bypassed this limitation by running Chrome (with a malicious extension) via the command line. <br><br><img src="https://habrastorage.org/webt/mw/_w/sx/mw_wsxqnq_6wgieus5norxbo7qi.png"><br><br><img src="https://habrastorage.org/webt/fy/di/yx/fydiyxwubn8ucxedoe-wijd1p_g.png"><br>  <i>Figure 4: Digmine bootloader component in the autorun registry entry (top) and a marker indicating that the malware has infected the system (bottom)</i> <br><br><img src="https://habrastorage.org/webt/uj/eq/rz/ujeqrzemd8v1xpes_somwjzanzo.png"><br><br><img src="https://habrastorage.org/webt/vs/hl/39/vshl39rre5-pcasbdl7q-q_kvco.png"><br>  <i>Figure 5: Rebooting Chrome to load the extension (below)</i> <br><br>  The C &amp; C server can either instruct to extend the current configuration, or open the page where the video will play. <br><br>  The lure site that plays video also serves as part of the C &amp; C structure.  This site looks like a regular video streaming service, but also contains many configurations for malware components. <br><br><img src="https://habrastorage.org/webt/dg/uz/vk/dguzvkfvs7vvfqr63kqtfmwlbe0.png"><br>  <i>Figure 6: Screenshot of the site used to play the video as bait</i> <br><br><img src="https://habrastorage.org/webt/z6/wq/od/z6wqodt58iaj76eqxg671672sko.png"><br>  <i>Figure 7: Initial setup used by the browser extension</i> <br><br><h3>  Spread </h3><br>  The browser extension is responsible for distribution through interaction with Chrome, as well as through Facebook Messenger.  If the user has a Facebook account that is logged in by default, the browser extension can interact with that account.  Digmine's interaction with Facebook may become wider in the future, since attackers can add functionality remotely. <br><br><img src="https://habrastorage.org/webt/0s/wq/rq/0swqrqsmgvhhz2uqfoc43qorgyq.png"><br>  <i>Figure 8: Part of the additional code received from the C &amp; C server that allows you to manipulate your Facebook account</i> <br><br><h3>  Component for mining </h3><br>  The miner module is loaded using codec.exe.  It will connect to another C &amp; C server to receive the configuration file and the miner program. <br><br>  The miner.exe component is an open source version of Minero Miner, known as XMRig.  It was reconfigured for mining using the config.json file instead of getting parameters directly from the command line. <br><br><img src="https://habrastorage.org/webt/l4/0w/gj/l40wgj-k_fvyrvamjmznoxlrcm8.png"><br><br><img src="https://habrastorage.org/webt/gt/xj/qo/gtxjqobc3ukxt-819uposbitxiu.png"><br>  <i>Figure 9: Miner configuration (above) and codec.exe code that starts the Miner component (below)</i> <br><br><h3>  Communication and protocol </h3><br>  Certain HTTP headers are used to communicate with the C &amp; C server.  When loading the original configuration, the malware creates an HTTP GET request before sending it to the C &amp; C server: <br><br><img src="https://habrastorage.org/webt/ez/tb/yu/eztbyuyu6qvqmjv8kenqdg_hc6o.jpeg"><br><br>  It should be noted that malware uses a specific User-Agent - Miner.  Access to the original configuration file is denied if the HTTP request header is invalid. <br><br><h3>  Best practics </h3><br>  The increasing popularity of mining cryptocurrency attracts attackers to illegal mining botnet creation activities.  As with other cyber-crime schemes, numbers are crucial.  Large pools of victims mean potentially large profits.  Therefore, it is not surprising that infection spreads through popular platforms such as multi-million social networks and instant messengers.  Since users often use them to communicate during working hours, this can negatively affect the information security of the corporate IT infrastructure. <br><br>  Trend Micro revealed the results of Facebook research, which quickly removed many of the Digmine related links.  Facebook's official statement says <br><br><blockquote>  ‚ÄúWe use a number of automated systems that help stop the appearance of malicious links and files on Facebook and in Messenger.  If you suspect that your computer is infected with malware, we will give you a free anti-virus scan from our partners.  We talk about how to stay safe on facebook.com/help. " </blockquote><br>  <b>Below are the compromise indicators associated with this attack (IoCs):</b> <br><br>  TROJ_DIGMINEIN.A (SHA256); <br>  beb7274d78c63aa44515fe6bbfd324f49ec2cc0b8650aeb2d6c8ab61a0ae9f1d <br><br>  BREX_DIGMINEEX.A (SHA256): <br>  5a5b8551a82c57b683f9bd8ba49aefeab3d7c9d299a2d2cb446816cd15d3b3e9 <br><br>  TROJ_DIGMINE.A (SHA256): <br>  f7e0398ae1f5a2f48055cf712b08972a1b6eb14579333bf038d37ed862c55909 <br><br>  <b>C &amp; C servers related to Digmine (including subdomains):</b> <br>  vijus [.] bid <br>  ozivu [.] bid <br>  thisdayfunnyday [.] space <br>  thisaworkstation [.] space <br>  mybigthink [.] space <br>  mokuz [.] bid <br>  pabus [.] bid <br>  yezav [.] bid <br>  bigih [.] bid <br>  taraz [.] bid <br>  megu [.] info <br><br>  <b>Other articles of our blog:</b> <br>  ‚Üí <a href="https://habrahabr.ru/company/cloud4y/blog/342022/">Clouds from an unknown country.</a>  <a href="https://habrahabr.ru/company/cloud4y/blog/342022/">Cloud FAQ</a> <br>  ‚Üí <a href="https://habrahabr.ru/company/cloud4y/blog/343378/">PD operators errors related to personnel work</a> <br>  ‚Üí <a href="https://habrahabr.ru/company/cloud4y/blog/343300/">Compare what you can not: cheap hosting and cloud on the VMware stack</a> <br>  ‚Üí <a href="https://habrahabr.ru/company/cloud4y/blog/343126/">Children - ice cream, information system - backup</a> <br>  ‚Üí <a href="https://habrahabr.ru/company/cloud4y/blog/344964/">FAQ on integration with ESIA</a> </div><p>Source: <a href="https://habr.com/ru/post/345342/">https://habr.com/ru/post/345342/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345328/index.html">Simulation of the simplest statements</a></li>
<li><a href="../345330/index.html">Using Roslyn to edit game content</a></li>
<li><a href="../345332/index.html">Kubernetes Service Writing Guide</a></li>
<li><a href="../345336/index.html">We spread the application in the App Store. Even if you are not a developer</a></li>
<li><a href="../345340/index.html">A story about how to create a repository and understand Redux</a></li>
<li><a href="../345344/index.html">Sending a request to the specified MS SQL Server databases of all the specified servers using available tools</a></li>
<li><a href="../345346/index.html">Nebraska problem</a></li>
<li><a href="../345348/index.html">Adapting RoboVM for compiling for iOS from Windows / Linux</a></li>
<li><a href="../345350/index.html">Adding 3D objects to video</a></li>
<li><a href="../345356/index.html">Universal Dumper / Injector Unity3D (Mono, Android)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>