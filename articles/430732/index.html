<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>On the issue of division and TI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúDo not show off, Maria Ivanovna, and listen to your favorite song‚Äú Valenki ‚Äù 

 Despite the title, the order of presentation will be reversed - first...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>On the issue of division and TI</h1><div class="post__text post__text-html js-mediator-article"><h3>  ‚ÄúDo not show off, Maria Ivanovna, and listen to your favorite song‚Äú Valenki ‚Äù </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yg/uf/48/yguf48cbw4hjjo2lvzz4scvivao.jpeg"></div><br>  Despite the title, the order of presentation will be reversed - first about Texas Instruments (of course not about the company itself, I'm still an engineer, not a business analyst <s>trainer</s> , therefore about the products manufactured by the company), and only then about the division. <br><a name="habracut"></a><br>  The first part of Marlezonsky ballet. <br><br>  The subject of consideration will be a relatively new family CC13xx (CC1310 / CC1350 / CC1352), but it is only the starting point for discussing the situation in the field of programming embedded systems.  The considered MK is intended for use in the design of devices with different types of wireless interfaces (I don‚Äôt really like the newfangled IoT, especially since it does not exhaust the possibilities of using this family). <br><br>  The MC is built on the basis of the M3 core with quite acceptable, though not recordable parameters of the frequency and amount of program memory and data, has a sufficient set of interfaces, but it is not these parameters that are interesting.  The feature is that the microcircuit contains within itself three MK cores, one central and two peripheral - to work with external devices and to perform interaction through the ether.  What caused such a decision? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First of all, the desire to ensure minimum energy consumption.  The fact is that the traditional method of reducing consumption by performing resource-intensive calculations in a relatively short time and then going into standby mode with a decrease in clock frequency has natural limitations and a fast core will consume relatively much at a lower frequency, while not providing the required response time to external events.  To eliminate this contradiction, the second core of the sensor controller was introduced, which provides interaction with the outside world in the low-consumption mode, and when the need for resource-intensive calculations arises, it activates the main core. <br><br>  The third controller solves (albeit in a very complicated way) the same task of reducing consumption.  The fact is that maintaining radio protocols often requires maintaining very tight time constraints and trying to implement them on the central core (simultaneously with the execution of the target program) will require an increase in the core clock frequency and, accordingly, the power consumed from the power source.  The division of functions allows us to remove this contradiction (a typical solution in the style of TRIZ). <br><br>  I am not at all sure that such a division of functions was absolutely necessary and that the required parameters could not be achieved with simpler architectural solutions, but if the price is kept within reasonable limits and the necessary possibilities are realized, then why not.  Moreover, the post is still not about the hardware component of the MC, it is just to cover the situation.  We will consider the process of creating software for this class MK. <br><br>  For a start - the main core, everything is standard here - and the M3 core itself is well known, and the tulchan - gcc, the company itself recommends two IDEs - ccs and iar.  I worked with the last of them a lot, so I decided to try that for the product the <s>gloomy Teutonic genius</s> spawned TI collective intelligence.  Code Composer Studio is a development company and is absolutely free without any restrictions, based on (who would have thought) Eclipse and has all the advantages and disadvantages inherent in this environment. <br><br>  The only thing about which I would immediately like to express my bewilderment is that the company kindly offers additional utilities for working with this MK (for generating a boot firmware image over the air and for transmitting it to MK), but they were written, for some reason, not in Java, which is the basis for the programming environment and the executing system for which is included in the installation package, and on the Phyton.  Not that I strongly disliked the latter (although it is, I do not accept the task of the structure of the program using indents, but in the end ‚Äúthe taste and color of all colors are different‚Äù), but it is just not clear why to attract clearly unnecessary entities.  Moreover, the utilities themselves do not represent anything complicated, they do not use specific libraries and were transferred by the author to Java for a very limited time without the slightest difficulty with increasing the program length by 20%, and, which is a bit strange, without a noticeable change in performance (considering that the main the execution time is related to the reading of files, it is not so surprising - a <s>later</s> note Funtik F ...). <br><br>  The second part of the puzzle is that in itself Eclipse is also popular, thanks to the possibility of easy plug-in embedding.  Given this fact, the decision of the developers of the programming environment looks extremely mysterious to force the user to call these utilities with handles from the command line, first disconnecting the terminal with the handles in the development environment and running the program to receive data on the MC and then restoring the terminal again with handles.  Perhaps for Hindu programmers, this solution seems the only possible and completely justified, but a large company could afford to attract more qualified staff, I probably don‚Äôt know something. <br><br>  Further, the programming of the sensor controller (the name is not very good, but this is direct tracing) is carried out using the product Sensor Composer Studio.  Immediately, the next question is: why do we need to have a separate product, not that it was very difficult to switch the window, but still ..., especially since the generated code eventually becomes part of the code for the main MK (of course, it‚Äôs there is not executed, but is included in the total address space of the program memory). <br><br>  But then another feature is that we are told nothing about this core (about its architecture), except that it is 16-bit, low-consuming and its own.  In general, that's fine, it works and works well, but the sediment remains.  The following is a description of the commands of this kernel, it can be assumed from it that it is a modification of 430, albeit with features such as looping commands.  The location of the peripheral registers in the general and local address space is given, but then the oddities begin again - many registers, including the periphery registers, are accompanied by the phrase ‚Äúused only by the TI library‚Äù, and for some of the registers the assignment of bit fields is still given some are not.  It‚Äôs not that these descriptions of registers hurt me greatly, but why give them, if you don‚Äôt plan to use the user, I personally don‚Äôt understand too much. <br><br>  The periphery of this kernel can be accessed from the main kernel using special libraries, at the same time you can write code in the mentioned programming environment, again using certain plug-ins.  Everything is normal here, the documentation is quite sufficient, the settings are convenient, there is a graphical representation of the settings, built-in debugging in a special mode (in general mode, the debugger is occupied by the main core), in general, quite decent. <br><br>  The next part is the core for working with radio, built on the base of M0, executes the program from its own ROM (most likely it is part of the non-volatile memory, it is unlikely that there was a masked memory on the modern MC) that cannot be modified (at least about this in Documentation is not a word) by the user.  Information on the internal structure of the radio path is extremely scarce; in fact, it can be extracted only from the description of mode setting commands, but the usual ‚Äúintegrated‚Äù developer does not need it. <br><br>  The interaction between the main core and the radio part is based on the message flow, which is documented in sufficient detail.  And this documentation is quite enough to understand the simple thing - you won‚Äôt (well, I‚Äôm not exactly going) to build your interaction mechanisms between the cores, and even more so communication protocols, and you will use the library implemented by the company, since the interaction is rather difficult even with design should take into account a large number of various factors, so that the benefits of writing your own package does not compensate for the cost of its creation.  Therefore, we again use the library sublayer to organize the interaction of the main core with the radio core, and, most likely, we use ready-made solutions for organizing a standardized radio channel using ready-made modules using only the channel parametrization. <br><br>  I think it has become clear to the reader that writing a full-fledged program for this MC is not an easy task, it is quite accessible for an advanced professional, but what to do to an ‚Äúordinary‚Äù developer (as Oleg Artamonov recently wrote, ‚ÄùYou already realized that you were very wrong profession? ").  The company took care of such a case and, together with the development environment, provides a large package (set of examples) of programs for all occasions called SimpleLink.  Moreover, the solutions are given in two versions - both with the use of the real-time operating system TI-RTOS (in my opinion, this is a more convenient way) and in the super cycle (in case you so hate the built-in operating systems that you can‚Äôt eat ‚Äú).  I am calm about RTOS at MK, so I use the first option and advise you to do the same, especially if you understand the configuration of the OS build process and adapt it for your class of tasks, usability is preserved, and the cost of maintaining this convenience is drastically reduced. <br><br>  My personal attitude to this package is ambivalent - on the one hand, it‚Äôs a wonderful initiative, really drastically simplifying the use of MK (therefore I use it), but on the other hand, ‚Äúthrash, waste and sodomy‚Äù, is a great illustration of the phrase ‚ÄúIf the cost of good architecture seems You‚Äôre high, think about the cost of a bad architecture. ‚Äù(Therefore, I‚Äôm scolding him.) This is not only about the distribution of functions among the modules and the relationships between them (although not everything is smooth here), but also about the distribution of modules by file, file names, distribution  files on directories and their names and structure, etc. etc. But violation of the KISS and DRY principles is almost a rule for developers of a package, but if I don‚Äôt get into the package sources (I can‚Äôt get rid of this stupid habit), and use it "as is", then everything works fine, at least I haven‚Äôt found any problems in a particular project (apart from an offended aesthetic feeling and a lost faith in humanity). <br><br>  But now you can smoothly go to the main postulate of this post (better late than never).  I have always believed that it is extremely difficult to write a framework that combines true versatility and high efficiency.  The design examples proposed by the company represent just such a framework with an emphasis on versatility, the means of setting up applications are almost completely absent, all at the level of the correction of curds.  Take one of our many examples, change a small piece associated with measurements and analysis (well, with the transfer, of course), and everything is ready.  Of course, the resulting code will generally be quite bloated, but we will offer you various examples for different application conditions, and you will only need to choose the most suitable for your task.  In extreme cases, a sufficiently large amount of program memory is built into the MC so that you do not have to think about saving this resource.  Moreover, a significant part of the executing libraries is already hidden inside the ROM and you just have to call them carefully. <br><br>  Not that I was against such an approach, and categorically insisted on the invention of bicycles, the reuse of the code is a categorical imperative and a guarantee of high efficiency of the programmer‚Äôs work, but under the following condition - <br>  the subroutine library used should be: <br><br><ol><li>  carefully designed </li><li>  neatly programmed </li><li>  exhaustively documented </li><li>  universal, </li><li>  effective. </li></ol><br>  And if the last two points are only desirable (highly desirable, but nonetheless ...), then the first three are necessary. <br><br>  And what about the requirements of the package offered by the company SimpleLink?  Further, estimates are given on a five-point scale, obtained in the order of superficial familiarity with the package. <br><br>  1a) The links between the modules should be thought out, the boundaries of competence of each module should be clearly outlined, eliminating duplication of functions, interfaces developed - the solid four, the work as a whole will have been completed. <br><br>  1b) Distribution of modules according to files with a well-thought-out directory structure is rather three plus, which is worth only repeated repetitions of the text of program modules in different files. <br><br>  2. A package should not have hard-to-detect rarely-manifest errors (the fact that it should not have constantly-manifest errors is obvious).  It is difficult to give assessments here, I will note one unpleasant circumstance - most of the functions can be caused both from the usual program memory and from the permanent memory, and if the source code of the first variant is available and validated, then the second one is much worse - we are not given any instructions its source, not on the identity with the first option, so that verification is out of the question. <br><br>  3. Documentation for a solid four - already the fact that the authors did not use Doxygen's ‚Äúpower and expressiveness‚Äù in terms of documentation, gives at least 1 point, there is a system of contextual links, there are descriptions of the principles of operation - I don‚Äôt put the only one because in terms of documentation I never put it, even to myself. <br><br>  4. No more than four due to the lack of advanced configuration, but I already mentioned this. <br><br>  5. It is difficult to say, I usually look at the implementation of SPI - it is, on the one hand, simple enough to appreciate the lack of a standard rake, on the other hand, difficult enough to have where to cram them.  So, in this package there are reference inefficient procedures for writing / reading a byte, but if you plunge into the depths, you can find really used options using the PDP, so far I can‚Äôt say anything about them. <br><br>  A note about the depths - they are really deep (after 4-5 nested functions) and here I can not fail to mention one feature of the package - it is written in C. It was not me who forgot to add two pluses after the letter, it really is not there.  For those who are in the subject, much becomes clear, I recommend everyone else to undergo an exciting quest to determine the set of functions performed at the hardware level when implementing a non-trivial object.  Of course, when using classes, this task becomes trivial, but this is not the way the Ted Jedi.  I understand that this is forced care for those users who neglect the advantages, but why stop there, but what about the unfortunate users of the assembler, for which they were offended. <br><br>  And in conclusion - I want to emphasize, ‚Äúso that they understand me correctly at the top,‚Äù I don‚Äôt blame the MK family, the development environment, or the software package at all, but just want them to become even better, more convenient and more attractive to the user. .  I have my own scores with TI and I will never forgive them for taking over National or even earlier acquiring Luminary and then killing an interesting MK line (although in the latter case they punished themselves) and what they returned to me in 2014 money for the ordered crystals (although I certainly did not touch the Crimea), but this deep feeling does not prevent me from being objective - they did a good job.  The concept proposed by the company in the epigraph is not too close to me, but, probably, they are right, and there is no other way for complex crystals.  It is a trend and fight with it is pointless. <br><br>  And the fact that this is a trend confirms the situation with the new crystals of power management from Vicor.  The crystal itself is good (the opposite would be surprising for a reputable firm), the parameters are very good, and I mentioned it only in connection with the section on the choice of external components, specifically inductance.  In the documentation, this section is only one paragraph in which a specific model of inductance from a specific manufacturer is indicated and it is explicitly stated that other options are not considered, see the epigraph.  Fully understanding the crystal developer's reasons (the switching frequency is high, the currents are significant, designing inductances for such conditions is not trivial), nevertheless I should note that for now this design approach is unusual for me, ‚Äúbut the key here is‚Äú for now. ‚Äù  Maybe you should sell these two components in a set, then there would be no questions. <br><br>  The second part of Marlezonsky ballet. <br><br>  And now about division, the use of which was found in one of TI‚Äôs libraries, but is not directly related to this company, but is a feature of the gcc compiler.  So, we formulate the problem from the field of address arithmetic - we need to calculate the difference in indices (namely, indices, not bytes) between two array elements (or simply sequentially located data of the same type) specified by pointers to them.  As a rule, one of the elements is the first element of the array, but this is not important. <br><br>  The problem itself is simple and the solution in C is obvious and looks like <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mn>1</mn><mo>&amp;#x2212;</mo><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi>o</mi><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.597ex" height="2.66ex" viewBox="0 -832 15326.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-70" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-6F" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-69" x="1378" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-6E" x="1724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-74" x="2324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-65" x="2686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-72" x="3152" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-31" x="3604" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2212" x="4326" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-70" x="5327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-6F" x="5830" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-69" x="6316" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-6E" x="6661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-74" x="7262" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-65" x="7623" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-72" x="8090" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-30" x="8541" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-29" x="9042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="9431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-73" x="9932" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-69" x="10401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-7A" x="10747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-65" x="11215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-6F" x="11682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-66" x="12167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-28" x="12718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-74" x="13107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-79" x="13469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-70" x="13966" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-65" x="14470" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-29" x="14936" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mn>1</mn><mo>‚àí</mo><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mn>0</mn><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mi>o</mi><mi>f</mi><mo stretchy="false">(</mo><mi>t</mi><mi>y</mi><mi>p</mi><mi>e</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">(pointer1-pointer0)/sizeof(type)</script></p>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The devil is hiding in the implementation - the division team has not become standardly implemented in common architecture MK, so it is not fast. </font><font style="vertical-align: inherit;">If the divisor is a variable, then there is no good solution to the word at all, but for a constant value there are options based on multiplication. </font><font style="vertical-align: inherit;">Thanks to the wonderful multiplication property</font></font><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>c</mi><mo>+</mo><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>a</mi><mo>&amp;#x2217;</mo><mi>c</mi><mo>+</mo><mi>a</mi><mo>&amp;#x2217;</mo><mi>d</mi><mo>+</mo><mi>b</mi><mo>&amp;#x2217;</mo><mi>c</mi><mo>+</mo><mi>b</mi><mo>&amp;#x2217;</mo><mi>d</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.243ex" height="2.66ex" viewBox="0 -832 19479.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-61" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2B" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-62" x="2141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-29" x="2571" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="3183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-28" x="3905" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-63" x="4295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2B" x="4951" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-64" x="5951" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-29" x="6475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-3D" x="7142" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-61" x="8198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="8950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-63" x="9673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2B" x="10329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-61" x="11329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="12081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-64" x="12804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2B" x="13549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-62" x="14550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="15202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-63" x="15925" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2B" x="16580" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-62" x="17581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="18233" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-64" x="18956" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>‚àó</mo><mo stretchy="false">(</mo><mi>c</mi><mo>+</mo><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mo>‚àó</mo><mi>c</mi><mo>+</mo><mi>a</mi><mo>‚àó</mo><mi>d</mi><mo>+</mo><mi>b</mi><mo>‚àó</mo><mi>c</mi><mo>+</mo><mi>b</mi><mo>‚àó</mo><mi>d</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> (a+b)*(c+d)=a*c+a*d+b*c+b*d</script></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(additive addition, thank you, captain) The hardware implementation of multiplication is much more common in implementations and fairly fast (the hardware multipliers topic itself is interesting, but this is not about that now). </font><font style="vertical-align: inherit;">Unfortunately, there is no similar property for division, which is why it is a rare guest in terms of hardware implementation. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So instead of dividing (by a constant, this is important) we want to apply multiplication, watch your hands</font></font><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>c</mi><mo>=</mo><mi>a</mi><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>a</mi><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo>&amp;#x2217;</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>a</mi><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>N</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="49.487ex" height="2.66ex" viewBox="0 -832 21306.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-63" x="1030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-3D" x="1741" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-61" x="2797" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="3549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-28" x="4272" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-31" x="4661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="5162" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-63" x="5662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-29" x="6096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-3D" x="6763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-61" x="7819" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="8571" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-28" x="9294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-4E" x="9683" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="10572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-28" x="11072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-4E" x="11462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="12572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-63" x="13295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-29" x="13728" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-29" x="14118" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-3D" x="14785" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-61" x="15842" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="16593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-28" x="17316" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-4E" x="17705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="18594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-63" x="19094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-29" x="19528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="19917" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-4E" x="20418" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>c</mi><mo>=</mo><mi>a</mi><mo>‚àó</mo><mo stretchy="false">(</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mo>‚àó</mo><mo stretchy="false">(</mo><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mi>N</mi><mo>‚àó</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mo>‚àó</mo><mo stretchy="false">(</mo><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>c</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>N</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> a/c=a*(1/c)=a*(N/(N*c))=a*(N/c)/N</script></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where N is some additional constant. There is a logical question - what kind of garbage, because now we have two division operations instead of one, and even multiplication, due to which the gain. The answer is in the correctly chosen N, if it is a power of two, but the division turns into a shift of the number to the right, which is much cheaper, and if the exponent is a multiple of 8, then the division turns into a re-numbering of the number of bytes, which costs nothing. Since the factor N / c is constant, we calculate it in advance and everything seems to be good, if not for one detail - the accuracy of the representation of this factor.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consider a specific case of dividing by 10, which occurs when converting numbers from binary to decimal, then, taking H = 256, we calculate the constant for multiplication 256/10 = 25.6 and a rounding error occurs to a whole 25 (-2.3%) or 26 (+1.6 %). </font><font style="vertical-align: inherit;">Then, for example, 100 * 26 = 2600 = 256 * 10 + 40 and the highest part of the result is 10, which corresponds to the expected 100/10 = 10. </font><font style="vertical-align: inherit;">It is possible to calculate at what values ‚Äã‚Äãof the dividend the result deviates from the correct one by more than one, but for this we will have to solve equations of the form</font></font><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo stretchy=&quot;false&quot;>[</mo><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>10</mn><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mo stretchy=&quot;false&quot;>[</mo><mi>n</mi><mo>&amp;#x2217;</mo><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>N</mi><mo stretchy=&quot;false&quot;>]</mo><mo>+</mo><mn>1</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.598ex" height="2.66ex" viewBox="0 -832 9729.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-6E" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="879" y="0"></use><g transform="translate(1379,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-5D" x="2380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-3D" x="2936" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-5B" x="3993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-6E" x="4271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="5094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-6B" x="5817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="6338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMATHI-4E" x="6839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-5D" x="7727" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2B" x="8228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-31" x="9228" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">[</mo><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>10</mn><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mi>n</mi><mo>‚àó</mo><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>N</mi><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">[n/10]=[n*k/N]+1</script></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(where the brackets mean the integer part with rounding down), and this is not a very clear procedure, it is easier to fix the numerical simulation and make sure that the result is correct up to a certain n. </font><font style="vertical-align: inherit;">You can enter a corrective additive and compensate for the loss of accuracy by the formula</font></font><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43D;</mo></mrow><mo>&amp;#x2217;</mo><mn>26</mn><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x43D;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn><mo>+</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>256</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.316ex" height="2.66ex" viewBox="0 -832 9608.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2217" x="1078" y="0"></use><g transform="translate(1801,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-36" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2212" x="3024" y="0"></use><g transform="translate(4025,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)"></text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="4492" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-32" x="4992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2B" x="5715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-31" x="6716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-29" x="7216" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-2F" x="7606" y="0"></use><g transform="translate(8106,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/430732/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgSs9avEoERgOR9qid8YGDS35SgbA#MJMAIN-36" x="1001" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mo>‚àó</mo><mn>26</mn><mo>‚àí</mo><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>256</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5">(*26-/2+1)/256 </script></p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and significantly expand the allowable range of values ‚Äã‚Äãof the dividend (up to 256, that is, we never make a mistake on the 8-bit unsigned whole), but the fundamental drawback of the method cannot be eliminated - the presence of an error, in addition, we get only a partial calculation of the remainder (if necessary, but this is not our case) it is possible to do only a separate operation, which adversely affects the speed of work. In general, the method is quite working, but rather limited in scope.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Therefore, I was slightly surprised when in the compiled code (as always, thanks to the godbolt website for the opportunity presented) I saw in address arithmetic multiplication by some (large enough) constant instead of division by a constant (very small). Another question was that the constant was not at all like that calculated for the above method. And finally, as a result, not the senior half of the work is taken, but the younger part. In general, a slightly strange method, some kind of garbage, but calculations show that it works. A brief reflection reveals the secret and the method turns out to be absolutely correct, but ... (of course, the reader expected "but ...", since it is impossible to replace division with multiplication in the general case) it has limitations.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consider the magic number 143 and explore its funny properties 77 * 143 = 11011, its youngest part 011 = 1 = 77/7. It is easy to see that 784 * 143 = 112112, its younger part 112 = 784/7 and so on for all numbers not exceeding 999 * 7 = 6993. Here it is, the natural limitation of the method, but taking another magic number 7143, we will extend the range of possibilities to 9999 * 7 = 69993. It is easy to find other magic numbers with similar magic properties.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to get these numbers - we want to find a number, by multiplying by which dividend, we can get a result that contains in its younger part the result of division, in this case by 7. It sounds abstruse, but in fact everything is simple, for the input number 7 we want get xxx001, suppose xxx = 001 and here it is simple street magic 1001/7 = 143. Obviously, 143 * 7 = 1001, then for any number = n * 7 is true (n * 7) * 143 = n * (7 * 143) = n * 1001, and the younger part of the result is n, cht.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we see a fundamental flaw in this method - it works only for numbers that are divisible by a divisor and gives a completely unpredictable (in the sense of not at all matching the division) result of multiplication in all other cases. But for this particular application, when we subtract the addresses of the elements of the array, the result will be exactly a multiple of the size of the element of the array and we have every right to use this method. If we took the wrong numbers, then the result of the division should not interest us, ‚Äúthe machine is the mill, if you throw stones at it, the flour will not work‚Äù.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finding magic numbers for dividers other than 7, as well as proof of their existence, we leave to the share of an inquisitive reader. It is also interesting to build a graph of factors depending on the divisor and see the dips and peaks on it, probably, their presence is somehow related to the theory of numbers. For example, for composite 21 = 3 * 7, this number = 381 (of course, the minimum number, the rest are not interesting for us) is clearly less than the product 667 * 143 = 95381 and even to him is not a multiple, as I naively thought, although 381 = 381.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another interesting fact is that the magic numbers will be different in different number systems. For example, in the decimal system there is no constant to divide by 5, since none of the numbers of the form x ... 1 can have a five as its divisor and our method does not work. But at the same time, in the binary (hexadecimal) system, this problem is solved, since 1024 + 1 = 1025 = 0x401 by 5 is wonderfully divided with the result of 205 = 0xCD and our algorithm works again, for example 130 * 205 = 0x82 * 0xCD = 0xFAFA =&gt; FA = 26 = 130/5. Moreover, it is possible to prove (well, I think so) that now the task of finding a multiplier is solved for any odd divisor, and even even turns into an odd finite number of shifts (I can definitely prove it). As far as a convenient and useful thing is a binary representation, we are very lucky with it.</font></font><br><br>  Ps.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">My constant readers (flattering myself with the hope that there are such) are in obvious bewilderment - the post has come to an end, and where the "weeping is Yaroslavna". Do not worry, my dear, here he is. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The debug boards for the CC1350 and CC1352 use one crystal of the antenna switch (it is used differently, but it does not matter), namely XMSSJE3G0PA (do not try to read it in Russian transcription, I am sure that muRata had no such thing in mind). So, the switch with modest characteristics is the frequency band up to 2.7 GHz, the transmission attenuation is 0.28 dB, the insulation attenuation is 33 dB, the switching power is 20 dB. But all this is compensated by two parameters - the dimensions are 1.5 * 1.5 mm and the cost is $ 0.9, despite the applied technologies "Silicon On Insulator" and "gallium arsenide".</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HOW they do it - first of all, about the price, well, second, why we do not do that - a rhetorical question </font></font></div><p>Source: <a href="https://habr.com/ru/post/430732/">https://habr.com/ru/post/430732/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../430720/index.html">Intel RealSense D435i: a small update and a small historical excursion</a></li>
<li><a href="../430722/index.html">PHP performance: we plan, profile, optimize</a></li>
<li><a href="../430724/index.html">Conference DEFCON 21. DNS can be dangerous for your health. Part 1</a></li>
<li><a href="../430728/index.html">Teach me to give feedback</a></li>
<li><a href="../430730/index.html">What do they do in the R & D department of ABBYY: NLP Advanced Research Group</a></li>
<li><a href="../430734/index.html">Smart updates against smart contracts</a></li>
<li><a href="../430736/index.html">We develop your browser from scratch. Part One: HTML</a></li>
<li><a href="../430738/index.html">Be a security ninja: secret level</a></li>
<li><a href="../430740/index.html">How to milk cows with robots and make an industrial startup on this. R-sept history</a></li>
<li><a href="../430742/index.html">Student Olympiad "I am a professional": the direction of "Programming and Information Technology"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>