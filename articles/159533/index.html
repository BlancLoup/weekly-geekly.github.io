<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Stuxnet and Duqu - is there a connection?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The subject of cyber weapons is now on everyone's lips. Most of all love this topic exaggerate experts Kaspersky Lab. According to their statements, a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Stuxnet and Duqu - is there a connection?</h1><div class="post__text post__text-html js-mediator-article">  The subject of cyber weapons is now on everyone's lips.  Most of all love this topic exaggerate experts Kaspersky Lab.  According to their statements, all significant samples of malware for the last three years are interconnected.  For example, Stuxnet and Duqu.  But is it really?  It must be admitted that the <a href="http://habrahabr.ru/post/159053">material on Stuxnet is</a> far from complete.  For example, there is no description of the procedure for deploying Stuxnet to a computer.  Does Kaspersky Lab say it is similar to that in Duqu?  The answer is not quite.  But about everything in order. <br><a name="habracut"></a><br>  <strong>Stuxnet</strong> (information taken from Symantec's <a href="http://aroundcyber.files.wordpress.com/2012/11/w32_stuxnet_dossier.pdf">‚ÄúW32.Stuxnet Dossier‚Äù</a> analytical report, version 1.4, February 2011, pdf): <br><ul><li>  The main module is a dll; </li><li>  a dll contains several resources, including two signed files - the autoload driver and a rootkit to hide the fact of infection of USB Flash media; </li><li>  there is a configuration data block (the first half of it is encrypted using the XOR 0xFF operation, the second in another way); </li><li>  during installation, the main module and signed files were saved to disk under the names specified in the configuration data block; </li><li>  for autorun, a service was created that used a signed driver; </li><li>  in the registry at the address 'HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Services \ MrxCls' in the 'Data' key, the names of the target processes (services.exe, S7tgtopx.exe, CCProjectMgr.exe) were saved to the injection process. </li></ul><br>  <strong>Duqu</strong> (information taken from Symantec <a href="http://aroundcyber.files.wordpress.com/2012/11/w32_duqu_the_precursor_to_the_next_stuxnet_research.pdf">'s W32.Duqu</a> analysis report on the <a href="http://aroundcyber.files.wordpress.com/2012/11/w32_duqu_the_precursor_to_the_next_stuxnet_research.pdf">precursor to the next Stuxnet</a> , version 1.4, November 2011, pdf): <br><ul><li>  The installer is a dll; </li><li>  the dll contains three data blocks containing the signed driver, the main module and the installer configuration data; </li><li>  The installer configuration data block is encrypted using a 7-byte key (0x2b 0x72 0x73 0x34 0x99 0x71 0x98); </li><li>  during the installation, the main module and the signed drivers were saved to disk under the names specified in the configuration data block; </li><li>  for autorun, a service was created that used a signed driver; </li><li>  in the registry at the address 'HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Services \ JmiNET3', in the 'FILTER' key, the name of the target process (services.exe), which was injected, was saved in encrypted form. </li></ul><br>  In general, a general algorithm is viewed: <br><ul><li>  loading a signed driver; </li><li>  deciphering the data in the registry (containing the mapping 'target process - module'); </li><li>  Inject a module into the target process. </li></ul><br>  However, this does not mean that the same people implemented the code in the code. <br><br>  Stuxnet and Duqu use the same method to call dll library functions, aimed at bypassing monitoring with anti-virus protection using LoadLibrary.  For Ntdll.dll install interceptor (hook) functions: <br><ul><li>  ZwMapViewOfSection; </li><li>  ZwCreateSection; </li><li>  ZwOpenFile; </li><li>  ZwCloseFile; </li><li>  ZwQueryAttributesFile; </li><li>  ZwQuerySection. </li></ul><br>  Next, it calls LoadLibrary on a specially selected dll library name that does not exist in the system.  Under normal conditions (without interception) this would cause an error.  It is the interceptor that loads the real library into the address space. <br><br>  Also, according to the <a href="http://amatrosov.blogspot.com/2011/11/win32duqu-research-rpc.html">information</a> of Eset, and Stuxnet, and Duqu use the same interprocessor communication system (RPC), designed to update the components of malware on the local network. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Are these facts clear evidence of the connection between Stuxnet and Duqu?  Apparently not.  The above may well be the result of borrowing the method of implementation into the system or the RPC procedure code. <br><br>  Now for the drivers.  Stuxnet used the mrxcls.sys driver, signed with a Realtek certificate.  A little later, another driver was discovered, jmidebs.sys, signed by JMicron.  The latter was announced everywhere as a regular Stuxnet driver, but the main module with such a driver was never found.  There were also other discrepancies, the mrxcls.sys driver used a direct call of the API functions by name, the jmidebs.sys driver looked for functions by their hashes.  To implement the main module, mrxcls.sys created a stub file (exe) with a size of 6332 bytes, jmidebs.sys - with a size of 7061 bytes.  Unusually, mrxcls.sys and jmidebs.sys used the same key - 0xAE240682, which, however, in other versions of Duqu was different, to decrypt the lines in the registry.  One of the Duqu drivers had identical jmidebs.sys characteristics (stub file size and decryption key).  Thus, it can be argued that jmidebs.sys, previously associated with Stuxnet, is actually part of Duqu.  There is also an indirect sign - for the Duqu branch the name of the parameter in the registry is typed in capital letters - 'IDE' and 'FILTER', while the Stuxnet branch does not ('Data', 'Config' and 'Action').  Dell SecureWorks experts believe that the similarity of some elements of both malicious programs is an accident.  For example, similar techniques are used in other samples of malware.  The use of working file names starting with the '~' character is also not evidence of relationship.  It is also not necessary to dismiss such a thing as imitation.  Based on the time stamps of compilation of individual parts of Duqu, its development could refer to the beginning of 2007.  The earliest manifestation of it is associated with the detection of temporary files like ~ DO (probably created by one of the spyware modules), which was created on November 28, 2008 ( <a href="http://www.secureviewmag.com/downloads/article_pdf/4th_quarter_secureview_small_file.pdf">article</a> "Duqu &amp; Stuxnet: A Timeline of Interesting Events").  Stuxnet, thus, could be created later, using several Duqu technologies, or their developers scooped information (or source code) from a single source.  So the statement by Mikko Hipponen from F-Secure: ‚ÄúThe similarity of the Duqu and Stuxnet codes is obvious.  The Duqu kernel driver (jminet7.sys) is so similar to the Stuxnet driver (mrxcls.sys) that our systems decided that this is Stuxnet ‚Äù- not quite true (jminet7.sys and cmi4432.sys - Duqu drivers found in Hungary employees of the CrySyS laboratory). </div><p>Source: <a href="https://habr.com/ru/post/159533/">https://habr.com/ru/post/159533/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../159513/index.html">Convenient work with pictures in Django</a></li>
<li><a href="../159515/index.html">Release Firefox 17 and Firefox 17 ESR</a></li>
<li><a href="../159517/index.html">Collection and analysis of statistics in free-to-play games</a></li>
<li><a href="../159519/index.html">CTRL + console: tablet as a mounting controller</a></li>
<li><a href="../159531/index.html">How to withdraw WebMoney Z using ePayService card</a></li>
<li><a href="../159535/index.html">Content resource: fixed layout is better</a></li>
<li><a href="../159537/index.html">Free anonymizer from Google - always at hand</a></li>
<li><a href="../159539/index.html">Computer 1951 restored and put into operation</a></li>
<li><a href="../159541/index.html">Tips from Gary Hastvita</a></li>
<li><a href="../159543/index.html">Test drive of the new Internet Bank "St. Petersburg"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>