<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Gray, blow, cool ...", or the logic of climate control in a smart home</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, the subject of a smart home is gaining increasing popularity, there are more and more new articles, reviews, discussions, and almost any que...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Gray, blow, cool ...", or the logic of climate control in a smart home</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/8ef/d73/d62/8efd73d62a494e53ac420b6eae9a0ea5.jpg" alt="Smart house"></div><br>  Recently, the subject of a smart home is gaining increasing popularity, there are more and more new articles, reviews, discussions, and almost any question you can immediately find a few opinions and answers.  But in this entire world of information there is still one white area, namely the logic of work.  We were not afraid and decided to submit to the public our preparations on this issue. <br><br>  First, a few words about the object to be equipped with automation systems.  This is a small apartment building, each apartment of which is equipped with independent air conditioning systems, ventilation, heating and underfloor heating. <br><br>  As the main requirements, the customer noted: a single interface for managing all smart home systems, a limited budget and a minimum amount of additional wiring.  After a little research of the automation market, we settled on a solution from Fibaro, since the main advantages of this solution almost perfectly repeat our conditions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this article, we describe the process of creating a similarity to an apartment HVAC system based on the Z-Wave protocol.  We hope to receive a bunch of comments from the community in order to bring our decision to an edible state.  If the expected result is achieved, we will be happy to continue this cycle with other publications in which we will share our experience in using Z-Wave devices. <br><a name="habracut"></a><br>  So, we will describe the initial data and conditions of functioning of our system. <br><br>  First of all, we wondered what would manage all systems.  As the head unit, we stopped at the Home Center 2 controller. Initially, it was planned to create a network of five controllers and organize the system so that one controller controls all the apartments on the same floor of the building.  But it soon became clear that building the system this way would not work, since HC2 has a limit on the number of connected z-wave devices, and combining controllers into one network only expands the coverage of the z-wave network, but does not increase the maximum allowable number of connected devices .  At the same time, no more than 230 devices can be connected to one controller.  Accordingly, only five hundred devices can still be connected to five controllers integrated into a single network.  Therefore, we had to double the number of controllers in the project and refuse to merge them into a single network.  Now one HC2 will work on 4-5 apartments, which gives us the opportunity to use from 46 to 57 z-wave devices in each apartment. <br><br>  After we decided on the main controller, the question arose of what data should be collected, and how to do it.  To control the climate, it is necessary to know the current state of affairs in the apartment, namely: the temperature inside and outside the room, humidity, CO2 level, the position of the windows and doors, the presence of residents.  As the project budget is limited, we refused to monitor humidity and CO2 levels. <br><br>  To monitor indoor temperature, many z-wave devices contain built-in temperature sensors that complement the main functionality of the device.  And, of course, there are temperature sensors in a separate version.  According to our project, in each apartment there will be about 35 devices that will somehow show the temperature value.  These are three leakage sensors FIB_FGFS-101, three IR converters REM_ZXT120, thermostat RS 014G0160, motion sensors, and three temperature sensors DS 18B20 for each heated floor contour and the heating system circuit.  Monitoring the temperature of the warm floor contour is necessary first of all in order to prevent overheating of the parquet, since  The maximum permissible parquet temperature does not exceed 27 degrees. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c2d/11d/de2/c2d11dde20394307b939bdd81da99348.jpg" alt="Temperature control"></div><br><br clear="all">  Temperature control to protect the parquet from overheating <br><br>  Since all these temperature values ‚Äã‚Äãcan be quite different from each other, depending on where the device is installed - to determine the temperature in the room we will calculate the average value for all indicators from this room. <br><br>  To determine the temperature outside the room, there are two options.  In HC2, there is a function for receiving a weather forecast for a city, which is set when the controller was initially set up.  However, this method of determining the temperature does not differ with acceptable accuracy, therefore we will use several DS 18B20 sensors installed on the external facade of the building for these purposes.  It should be noted that the sensors should not be located directly on the facade and avoid direct sunlight. <br><br>  In any smart home, one of the main goals of its creation is to reduce the cost of heating and cooling the rooms, so understanding the current position of windows and doors becomes very important.  In order to turn off heating and air conditioning, if a window or door is open, we will use conventional magnetic-contact sensors, and for their integration into the z-wave network they will be connected to universal binary sensors FIB_FGBS-001. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/10c/13d/1ae/10c13d1aecc94deb92949e2b37ad2dd9.jpg" alt="Connection of temperature sensors DS18B20"></div><br>  Connection of temperature sensors DS18B20 <br><br>  To determine the presence of tenants, we created a virtual device, which is a button.  When you click on this button, the user informs the system that no one is at home. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dd4/862/9dc/dd48629dcb1d471ab16750d5c35b0174.jpg" alt="Virtual device - home / work mode enable buttons"></div><br><br clear="all">  Virtual device - home / work mode enable buttons <br><br>  When the system receives a signal that no one is home, the controller turns off all HVAC systems and goes into power saving mode until the user gets home.  Being in the energy saving mode, the system continues to monitor the temperature, and will not allow overcooling of the rooms and the temperature to drop below the 18 degree mark. <br><br>  Another important element of climate control in a residential area is the temperature setpoint.  In our solution, users can change it in two ways.  Using a wall thermostat or using a specially created virtual device using a smartphone or tablet. <br><br>  Having dealt with monitoring the current state of the microclimate in the apartment, we proceeded to study directly the devices that we were to manage. <br><br>  Each apartment will be equipped with 3 air conditioners manufactured by Mitsubishi Electric.  They are planned to be controlled using IR converters REM_ZXT120.  These devices have predefined settings for controlling the most common models of air conditioners from leading manufacturers, as well as the possibility of teaching IR to commands from the remote control. <br><br>  In addition to air conditioners, each apartment will be equipped with an independent system of supply and exhaust ventilation, and its management will be organized using two-channel relays FIB_FGS-222. <br><br>  Also, in all the apartments there will be installed seven contours of a heated floor and one central heating circuit.  Each circuit is equipped with a three-way valve with servo.  It is controlled by the RGBW module FIB_FGRGB-101. <br><br>  After selecting and studying all the necessary equipment, our next task was to develop the most efficient and self-sufficient climate control algorithm. <br><br>  Clickable: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c2a/642/b98/c2a642b98a954088a764d89ded78fd02.jpg" alt="Block diagram with the climate control"></div><br>  The flowchart shows the algorithm, which is the main logic of the entire HVAC control system. <br><br>  The resulting algorithm is implemented as a single main script and several supporting ones.  In NS2, these scripts are called scenes and are written in lua. <br>  In order not to heavily load the controller, the scenes are launched only when so-called triggers are triggered. <br><br>  For the main scene, the following events are triggers: <br><br><ul><li>  one of the temperature indicators will change by more than one degree </li><li>  user has changed the setpoint temperature </li><li>  user turned on / off mode at work </li><li>  window or door (on the loggia or entrance) were open / closed </li></ul><br><div class="spoiler">  <b class="spoiler_title">Main script code</b> <div class="spoiler_text"><pre><code class="lua hljs"><span class="hljs-comment"><span class="hljs-comment">--[[ %% properties 3 Temperature --   85 value --  1 86 value --  2 87 value --  3 %% events %% globals tempSet --]]</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> temp1 = <span class="hljs-built_in"><span class="hljs-built_in">tonumber</span></span>(fibaro:getValue(<span class="hljs-number"><span class="hljs-number">85</span></span>, <span class="hljs-string"><span class="hljs-string">"value"</span></span>)) <span class="hljs-comment"><span class="hljs-comment">--   1 local temp2 = tonumber(fibaro:getValue(86, "value"))--   2 local temp3 = tonumber(fibaro:getValue(87, "value"))--   3 local tempOUT = tonumber(fibaro:getValue(3, "Temperature"))--     local IDCooler = 99 --  local IDCond = 100 --  local IDCondHeat = 102 --   ( ) local IDFloor = 23 --   local IDHeat = 24 --  local tempset = fibaro:getGlobalValue("tempSet") local workmode = fibaro:getGlobalValue("Workmode") local tempInside = (temp1 + temp2 + temp3) / 3 local date = os.date("!*t", now) local currtime = date.hour*60 + date.min --    local d = tempset - tempInside local w = tempset - tempOUT --globals: -- Workmode -- TempSet -- WinStatus -- Isventnow -- CHeating local cHeating = "on" local winStatus = "closed" print("Starting Climate Control") print("t   = "..tempInside..", t  = "..tempset) print("Workmode: "..workmode..", Windows: "..winStatus,", Central Heating: "..cHeating) --    if (fibaro:getGlobalValue("Workmode1") == "At work") then --  if (tempInside &lt; 18) then --  if (cHeating == "on") then --   print(" ") fibaro:call(IDHeat, "turnOn") if(Isventnow == "no") then fibaro:call(IDCooler, "turnOff") end fibaro:call(IDCondHeat, "turnOff") fibaro:call(IDCond, "turnOff") fibaro:call(IDFloor, "turnOff") elseif (windows == "closed") then --    print("  ") fibaro:call(IDCondHeat, "turnOn") fibaro:call(IDCond, "turnOn") fibaro:call(IDFloor, "turnOff") if(Isventnow == "no") then fibaro:call(IDCooler, "turnOff") end fibaro:call(IDHeat, "turnOff") end --     elseif (tempInside &gt; 21) then --  if(fibaro:getValue(IDHeat, value) &gt;0) then print(" ") fibaro:call(IDHeat, "turnOff") else fibaro:call(IDCondHeat, "turnOn") fibaro:call(IDCond, "turnOn") fibaro:call(IDFloor, "turnOff") if(Isventnow == "no") then fibaro:call(IDCooler, "turnOff") end end end --     elseif d &lt; 1 and d &gt; -1 then print(" ") --  fibaro:call(IDCondHeat, "turnOff") fibaro:call(IDCond, "turnOff") --  if(Isventnow == "no") then fibaro:call(IDCooler, "turnOff") end --  fibaro:call(IDHeat, "turnOff") --   fibaro:call(IDFloor, "turnOff") --     elseif (cHeating == "on") then --   if (d &gt;= 1) then -- if (d &lt;= 3) then print("  ") --   fibaro:call(IDFloor, "turnOn") fibaro:call(IDCondHeat, "turnOff") fibaro:call(IDCond, "turnOff") fibaro:call(IDHeat, "turnOff") fibaro:call(IDCooler, "turnOff") elseif (d &gt; 3) then print("    ") --   fibaro:call(IDFloor, "turnOn") --  fibaro:call(IDHeat, "turnOn") fibaro:call(IDCondHeat, "turnOff") fibaro:call(IDCond, "turnOff") if(Isventnow == "no") then fibaro:call(IDCooler, "turnOff") end end elseif (d &lt;= -1) then -- print(" ") --   if(Isventnow == "no") then fibaro:call(IDCooler, "turnOn") end lastCondition = currTime end --    elseif (cHeating == "off") then -- if (d &gt;= 1) then if (w &lt;= 0) then print(" ") --   if(Isventnow == "no") then fibaro:call(IDCooler, "turnOn") end fibaro:call(IDCondHeat, "turnOff") lastCondition = currTime elseif (d &lt; 4) then print(" ") --   fibaro:call(IDCondHeat, "turnOff") if(Isventnow == "no") then fibaro:call(IDCooler, "turnOn") end lastCondition = currTime elseif (winStatus == "closed") then print("   ") --     fibaro:call(IDCondHeat, "turnOn") fibaro:call(IDCond, "turnOn") if(Isventnow == "no") then fibaro:call(IDCooler, "turnOff") end end elseif (d &lt;= -1) then -- if(w &gt;= 0) then if(d &gt; -4) then print(" ") --   if(Isventnow == "no") then fibaro:call(IDCooler, "turnOn") end fibaro:call(IDCondHeat, "turnOff") fibaro:call(IDCond, "turnOff") elseif (winStatus == "closed") then print(" ") --   fibaro:call(IDCond, "turnOn") fibaro:call(IDCondHeat, "turnOff") if(Isventnow == "no") then fibaro:call(IDCooler, "turnOff") end end elseif (winStatus == "closed") then print(" ") --   fibaro:call(IDCond, "turnOn") fibaro:call(IDCondHeat, "turnOff") if(Isventnow == "no") then fibaro:call(IDCooler, "turnOff") end end end end</span></span></code> </pre> <br></div></div><br>  As can be seen from the code of the main scene, she uses global variables in her work: <br><br><ul><li>  Workmode {"at work", "at home"} // mode at work </li><li>  TempSet // setpoint temperature </li><li>  WinStatus {'opened "," closed "} // whether windows and doors to the loggia are open (needed to limit the operation of air conditioners) </li><li>  CHeating {"on", "off"} // whether central heating is on </li></ul><br>  Monitoring of the current position of the windows and doors in the apartment will be carried out by an auxiliary stage.  The result of its work is stored in the global variable WinStatus.  Also, a separate scene controls the temperature change of the sensors near the central heating pumps in the basement of the building and determines whether the central heating is turned on.  The result of her work is stored in the global variable CHeating. <br><br>  Since it is very important for comfort that the air in the apartment is fresh, we decided that it would be correct to make a system of forced ventilation of the rooms through the supply and exhaust ventilation.  If the ventilation has not worked during the last three hours, the scenario of airing the room for 15 minutes will automatically start.  Forced ventilation is not carried out if the ‚Äúat work‚Äù mode is activated. <br><br><div class="spoiler">  <b class="spoiler_title">Forced Airing Script</b> <div class="spoiler_text"><pre> <code class="lua hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vent_forced</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> workmode = fibaro:getGlobal(<span class="hljs-string"><span class="hljs-string">'Workmode'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> isventnow = fibaro:getGlobal(<span class="hljs-string"><span class="hljs-string">'Isventnow'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> lastModified = fibaro:getGlobalModificationTime(<span class="hljs-string"><span class="hljs-string">'Isventnow'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>() - lastModified) &lt; <span class="hljs-number"><span class="hljs-number">10800</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"      "</span></span>..(<span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>() - lastModified)) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"     3- "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( workmode == <span class="hljs-string"><span class="hljs-string">'At home'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> isventnow == <span class="hljs-string"><span class="hljs-string">'no'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>() - lastModified) &gt; <span class="hljs-number"><span class="hljs-number">10800</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"      "</span></span>..(<span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>() - lastModified)) fibaro:call(<span class="hljs-number"><span class="hljs-number">99</span></span>, <span class="hljs-string"><span class="hljs-string">"turnOn"</span></span>) fibaro:setGlobal(<span class="hljs-string"><span class="hljs-string">'Isventnow'</span></span>, <span class="hljs-string"><span class="hljs-string">'yes'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"     3 "</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"   "</span></span>) fibaro:sleep(<span class="hljs-number"><span class="hljs-number">900000</span></span>) fibaro:call(<span class="hljs-number"><span class="hljs-number">99</span></span>, <span class="hljs-string"><span class="hljs-string">"turnOff"</span></span>) fibaro:setGlobal(<span class="hljs-string"><span class="hljs-string">'Isventnow'</span></span>, <span class="hljs-string"><span class="hljs-string">'no'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> (<span class="hljs-string"><span class="hljs-string">"   "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> sourceTrigger = fibaro:getSourceTrigger() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sourceTrigger[<span class="hljs-string"><span class="hljs-string">"type"</span></span>] == <span class="hljs-string"><span class="hljs-string">"autostart"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> fibaro:<span class="hljs-built_in"><span class="hljs-built_in">debug</span></span>(<span class="hljs-string"><span class="hljs-string">'  '</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> currentDate = <span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">date</span></span>(<span class="hljs-string"><span class="hljs-string">"*t"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentDate.<span class="hljs-built_in"><span class="hljs-built_in">min</span></span> &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> currentDate.<span class="hljs-built_in"><span class="hljs-built_in">min</span></span> &lt;= <span class="hljs-number"><span class="hljs-number">60</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> vent_forced() <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> fibaro:<span class="hljs-built_in"><span class="hljs-built_in">debug</span></span>(<span class="hljs-string"><span class="hljs-string">' ,    1 '</span></span>) fibaro:sleep(<span class="hljs-number"><span class="hljs-number">3600</span></span>*<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br></div></div><br>  That's how we plan to solve the problem.  There are still many issues on the agenda, many problems to be solved and many difficulties to overcome.  This is our first attempt at writing, we ask you to treat with kindness and understanding. </div><p>Source: <a href="https://habr.com/ru/post/398391/">https://habr.com/ru/post/398391/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../398379/index.html">Your unmanned taxi arrives</a></li>
<li><a href="../398381/index.html">Prototype robot for timelapse shooting running Arduino</a></li>
<li><a href="../398385/index.html">The illusions of the brain. The world's first universal hallucination</a></li>
<li><a href="../398387/index.html">Attack of the machines: a brutal fight</a></li>
<li><a href="../398389/index.html">KiQ anecdote or as a talking toy for adults did</a></li>
<li><a href="../398393/index.html">Cool Nikon D5500a takes stunning photos of the cosmos</a></li>
<li><a href="../398395/index.html">Wow: Nobel Prize instead of gravitational waves was given for topology</a></li>
<li><a href="../398397/index.html">Ultra-bright X-ray sources found in two old galaxies. New natural phenomenon?</a></li>
<li><a href="../398399/index.html">Auto Digest: Present and Future Technologies</a></li>
<li><a href="../398401/index.html">About fats from the point of view of a chemist</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>