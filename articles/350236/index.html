<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing the icecast2 server with SSL support for broadcasting over https protocol</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Formulation of the problem. Through the site with the free SSL certificate from Let`s Encrypt is installed, audio transmission is provided from the or...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing the icecast2 server with SSL support for broadcasting over https protocol</h1><div class="post__text post__text-html js-mediator-article">  Formulation of the problem.  Through the site with the free SSL certificate from Let`s Encrypt is installed, audio transmission is provided from the organization‚Äôs local network.  However, a warning about the presence of mixed content appears in the Internet browser when you visit the page of the site, since the broadcast is via the unprotected http protocol.  Required to eliminate mixed content.  To this end, it was decided to organize audio broadcasting over the https secure protocol using Icecast2 and IceS2. <br><br>  The result of a long search for a solution to this problem was the installation of the Icecast2 server with SSL support when using the free certificate from Let`s Encrypt.  Despite the fact that the developers of the server Icecast2 claimed SSL support, you must compile the server from the source code.  <a href="https://jksinton.com/articles/rpi-compiling-icecast-support-openssl">Here</a> is a procedure for compiling and installing an Icecast2 server using a certificate from OpenSSL.  However, at the moment browsers swear certificates generated by openssl.  Therefore, instead of an OpenSSL certificate, we use a free certificate from Let`s Encrypt, generated for a domain name tied to an external IP address from which we are broadcasting to the network. <br><br>  All the operations described below were performed on the Linux Mint distribution. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  So, first update the system and install Icecast2 in the most usual way so that you can immediately remove it.  This is necessary in order to facilitate the task of configuring the server Icecast2. <br><br>  Remove icecast2: <br><br><pre><code class="hljs cs">sudo apt <span class="hljs-keyword"><span class="hljs-keyword">remove</span></span> icecast2</code> </pre> <br>  We are convinced of the presence of icecast2 configuration files in the system (optional): <br><br><pre> <code class="hljs coffeescript">ls -l <span class="hljs-regexp"><span class="hljs-regexp">/etc/init.d/</span></span> <span class="hljs-regexp"><span class="hljs-regexp">/etc/</span></span> | grep icecast</code> </pre> <br>  Install tools to build icecast2 from sources: <br><br><pre> <code class="hljs sql">sudo apt <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> git gcc <span class="hljs-keyword"><span class="hljs-keyword">build</span></span>-essential automake autoconf libtool checkinstall</code> </pre> <br>  We satisfy dependencies for the subsequent compilation of the icecast2 server: <br><br><pre> <code class="hljs sql">sudo apt <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> libcurl4-openssl-dev libxslt1-dev libxml2-dev libogg-dev libvorbis-dev libflac-dev libtheora-dev libssl-dev libspeex-dev</code> </pre> <br>  Create a directory to host temporary source files: <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">mkdir</span></span> src <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> src</code> </pre> <br>  Clone the latest release of icecast2: <br><br><pre> <code class="hljs php">git <span class="hljs-keyword"><span class="hljs-keyword">clone</span></span> --recursive https:<span class="hljs-comment"><span class="hljs-comment">//git.xiph.org/icecast-server.git</span></span></code> </pre> <br>  Create a configuration script: <br><br><pre> <code class="hljs pgsql">cd icecast-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>; ./autogen.sh</code> </pre> <br>  Configure the source code to support SSL: <br><br><pre> <code class="hljs scala">./configure --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-curl --<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>-openssl</code> </pre> <br>  Make sure that SSL support is present in the configuration (presence of lssl): <br><br><pre> <code class="hljs lua">grep lssl <span class="hljs-built_in"><span class="hljs-built_in">config</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">status</span></span></code> </pre> <br>  Compile: <br><br><pre> <code class="hljs go"><span class="hljs-built_in"><span class="hljs-built_in">make</span></span></code> </pre> <br>  Install icecast2: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sudo</span></span> checkinstall</code> </pre> <br>  In the process of working out the command, the checkinstall utility will ask us to add a description of the package.  Also, we must indicate the version of the package, otherwise the command will issue an error ‚Äúthe package version does not begin with a number‚Äù <br><br>  Next, create the access.log and error.log files (if icecast2 has already been installed on the system, then you can use the existing ones): <br><br><pre> <code class="hljs pgsql">sudo mkdir /var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/icecast2 cd /var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/icecast2 sudo touch <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> sudo touch error.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span></code> </pre> <br>  We place the SSL certificate from Let`s Encrypt, renamed icecast.pem, in the same directory as the access.log and error.log files and set the permissions for the directory and the files in it: <br><br><pre> <code class="hljs perl">sudo <span class="hljs-keyword"><span class="hljs-keyword">chown</span></span> -R icecast2:icecast /var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/icecast2 cd /var/<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>/icecast2 sudo <span class="hljs-keyword"><span class="hljs-keyword">chmod</span></span> -R <span class="hljs-number"><span class="hljs-number">777</span></span> *</code> </pre> <br>  We edit the icecast.xml file from the / usr / local / etc / directory (you can probably use an existing file), correcting the path to the directories with the access.log and error.log files, as well as the icecast.pem certificate.  (To create the latter, copy the contents of the fullchain.pem and privkey.pem files from the / etc / letsencrypt / live / domain_name directory, opening them with a text editor, into one file and save it as icecast.pem.) Make sure that icecast.xml spelled two ports: one for the http connection (8000), the other for the secure https connection (8443).  The lines indicating the path to the SSL certificate and the https port must be uncommented.  Instead of ssl, tls can be written in the file - I did not see the difference. <br><br>  It should be clarified that via http-port 8000 there is a connection with IceS2 or a similar application that reads audio data and transfers it to Icecast2 server.  In the absence of it, this whole construction will not work.  This error is found on the Internet very often. <br><br>  We start the icecast2 server: <br><br><pre> <code class="hljs pgsql">/usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/bin/icecast -c /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/etc/icecast.xml</code> </pre> <br>  We look at the error.log file and make sure that icecast2 saw and ate our certificate.  Open the ports 8000 and 8443 in the Internet browser and again make sure that everything works. <br><br>  We configure the automatic launch of icecast2 when the operating system is loaded via the ‚ÄúParameters‚Äù - ‚ÄúStartup‚Äù service, setting the start command from the previous item there. <cut></cut><br><br>  <a href="http://forums.centova.com/index.php%3Ftopic%3D3965.0">Here is</a> stated the solution to this problem with an SSL certificate from Let`s Encrypt without compiling Icecast2 from sources.  However, it did not work for me. </div><p>Source: <a href="https://habr.com/ru/post/350236/">https://habr.com/ru/post/350236/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350224/index.html">Webpack 4 Legato released</a></li>
<li><a href="../350228/index.html">About threat modeling</a></li>
<li><a href="../350230/index.html">We summarize the animation tables in iOS applications</a></li>
<li><a href="../350232/index.html">Oh, those modal windows or why I loved the render functions in VueJs</a></li>
<li><a href="../350234/index.html">SAML authorization bypass</a></li>
<li><a href="../350238/index.html">If you don't have a dog ...</a></li>
<li><a href="../350240/index.html">Nine questions about working with memory in V8</a></li>
<li><a href="../350246/index.html">Mikrotik vs Old PC, the problem of choice in a small business</a></li>
<li><a href="../350248/index.html">Heatmap painter</a></li>
<li><a href="../350250/index.html">Rolling Scopes Conference 2018: Woodstock for a front-end developer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>