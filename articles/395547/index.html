<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Symantec / Norton Antivirus multiple security vulnerabilities</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Published a working exploit for all versions of antiviruses. Revealed the fact of borrowing code under the GPL 


 Yesterday, Tavis Ormandy, from the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Symantec / Norton Antivirus multiple security vulnerabilities</h1><div class="post__text post__text-html js-mediator-article"><h3>  Published a working exploit for all versions of antiviruses.  Revealed the fact of borrowing code under the GPL </h3><br><img src="https://habrastorage.org/files/bf8/e9c/a2b/bf8e9ca2bd75423b977548077c4710b8.png"><br><br>  Yesterday, Tavis Ormandy, from the Project Zero hacker division of Google <a href="https://googleprojectzero.blogspot.com.by/2016/06/how-to-compromise-enterprise-endpoint.html">, made publicly available</a> information about numerous vulnerabilities in Symantec antivirus programs, including those with remote code execution. <br><br>  Some experts say that an antivirus program installed on a computer, given its maximum privilege level in the system, may become an additional attack vector, that is, an additional gap in the overall system security.  The Symantec example demonstrates this as clearly as possible.  In some cases, under Windows, the malicious code is loaded directly into the kernel of the operating system, which leads to kernel memory corruption. <br><a name="habracut"></a><br>  Symantec programs use the same core, so the methods described work for all Symantec programs, including antivirus programs that are sold under the Norton brand.  Among them: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Norton Security, Norton 360 and other legacy Norton products (all platforms) </li><li>  Symantec Endpoint Protection (all versions, all platforms) </li><li>  Symantec Email Security (all platforms) </li><li>  Symantec Protection Engine (all platforms) </li><li>  Symantec Protection for SharePoint Servers </li><li>  Other </li></ul><br>  Project Zero's Tavis Ormandi made public some examples of some vulnerabilities so that everyone understands the essence of the problem. <br><br>  In the case of antivirus software, the problem is how they scan executable files packed with packers like <a href="http://upx.sourceforge.net/">UPX</a> .  To check such files, antiviruses use special file unpackers to return the file to its original form.  This helps with standard packers, and for the rest, you have to resort to emulation. <br><br>  Tavis Ormandy writes that all these methods create excessive complexity and are extremely vulnerable to vulnerabilities, because it is very difficult to make such code safe.  ‚ÄúWe recommend using the <a href="https://www.chromium.org/developers/design-documents/sandbox">sandbox</a> and the <a href="https://www.microsoft.com/en-us/sdl/">Security Development Lifecycle</a> , but vendors often cut corners here,‚Äù writes Tavis.  Because of this, unpackers become a huge source of vulnerabilities, as has been the case with <a href="https://bugs.chromium.org/p/project-zero/issues/detail%3Fid%3D769">Comodo</a> , <a href="https://googleprojectzero.blogspot.com/2015/06/analysis-and-exploitation-of-eset.html">ESET</a> , <a href="https://googleprojectzero.blogspot.com/2015/09/kaspersky-mo-unpackers-mo-problems.html">Kaspersky</a> , <a href="https://googleprojectzero.blogspot.com/2015/12/fireeye-exploitation-project-zeros.html">Fireeye</a> and <a href="https://bugs.chromium.org/p/project-zero/issues/list%3Fcan%3D1%26q%3D%26sort%3D-id">many others</a> . <br><br>  In the case of Symantec, the situation is even worse, because in its programs, <i>unpackers work in the kernel</i> ! <br><br>  For example, its unpacker for <a href="http://www.aspack.com/">ASPack</a> allows a trivial buffer overflow if the <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms680341(v%3Dvs.85).aspx">SizeOfRawData</a> value <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms680341(v%3Dvs.85).aspx">is</a> larger than the <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms680339(v%3Dvs.85).aspx">SizeOfImage</a> .  When this happens, Symantec transfers the ‚Äúextra‚Äù bytes to the buffer using <code>memcpy</code> .  Accordingly, we can easily run arbitrary code for execution at the kernel level using the following method: <br><br><pre> <code class="hljs cpp"> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *buf = <span class="hljs-built_in"><span class="hljs-built_in">malloc</span></span>(SizeOfImage); <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(&amp;buf[DataSection-&gt;VirtualAddress], DataSection-&gt;PointerToRawData, SectionSizeOnDisk);</code> </pre> <br>  Vulnerability CVE-2016-2208 is described in more detail in the <a href="https://bugs.chromium.org/p/project-zero/issues/detail%3Fid%3D820">bug tracker</a> .  On Linux, macOS and Unix operating systems, it causes a net root-level overflow in the Symantec or Norton process, and in the Windows operating system, kernel memory corruption. <br><br>  Since Symantec uses a special driver to intercept all system interrupts, it‚Äôs enough to exploit the vulnerability by simply sending a file to the victim via email or an exploit link.  The victim does not need to open the file or click on the link, the <b>antivirus will do everything on its own</b> .  This makes it possible even to automatically spread the worm across all systems with Symantec / Norton antivirus installed! <br><br>  Thus, it is possible to easily infect a large number of computers in the local network of an enterprise. <br><br>  It is curious that before publishing the information in open access, Tavis Ormandi sent the exploit to the security department by e-mail in a password-protected zip-archive, and indicated the password in the text of the letter.  But the mail server with the installed ‚Äúprotection‚Äù Symantec extracted the password from the text of the letter, applied it to the archive and in the process of studying the code of the exploit <a href="https://news.ycombinator.com/item%3Fid%3D11998983">brought down himself</a> . <br><br>  Tavis Ormandi also talks about vulnerabilities when parsing PowerPoint files and other Microsoft Office files, as well as vulnerabilities in the heuristic Bloodhound Heuristics engine (Advanced Heuristic Protection).  The source code of the exploit has been <a href="https://bugs.chromium.org/p/project-zero/issues/detail%3Fid%3D823">published</a> .  This is a 100% working exploit that works against the standard configurations of Norton Antivirus and Symantec Endpoint, and it <b>just</b> works <b>when you send a link by mail or publish a link on a web page</b> (you don‚Äôt need to open it). <br><br>  In this case, the following products are vulnerable (not all potentially vulnerable Symantec programs are listed here, it is quite possible that the exploit works in others): <br><br><ul><li>  Norton Antivirus (Mac, Windows) </li><li>  Symantec Endpoint (Mac, Windows, Linux, Unix) </li><li>  Symantec Scan Engine (all platforms) </li><li>  Symantec Cloud / NAS Protection Engine (all platforms) </li><li>  Symantec Email Security (all platforms) </li><li>  Symantec Protection for SharePoint / Exchange / Notes / etc (all platforms) </li><li>  All other Symantec / Norton Carrier, Enterprise, SMB, Home and other anti-virus programs </li><li>  Other </li></ul><br>  Under Windows, this leads to the execution of code at the SYSTEM level, in other operating systems with root rights. <br><br>  Some of the Symantec programs are not automatically updated, so system administrators need to take urgent steps to protect their networks.  Official Symantec information <a href="https://www.symantec.com/security_response/securityupdates/detail.jsp%3Ffid%3Dsecurity_advisory%26pvid%3Dsecurity_advisory%26year%3D%26suid%3D20160628_00">here</a> . <br><br>  UPD.  As <a href="https://geektimes.ru/post/277884/">it turned out</a> , Symantec borrowed code from the open-source libmspack and unrarsrc libraries ‚Äî and hasn't updated them for at least seven years! </div><p>Source: <a href="https://habr.com/ru/post/395547/">https://habr.com/ru/post/395547/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../395537/index.html">Label it</a></li>
<li><a href="../395539/index.html">Brew beer with MP8036multi module</a></li>
<li><a href="../395541/index.html">Spacesuit for landing on Europe and the Moon - what should it be? Interview with Lead Designer Final Frontier Design</a></li>
<li><a href="../395543/index.html">Russia creates an open base of near-Earth objects</a></li>
<li><a href="../395545/index.html">Novgorod archaeologists have discovered an unknown ancient Russian curse</a></li>
<li><a href="../395549/index.html">Is it true that humanity is becoming stupid?</a></li>
<li><a href="../395551/index.html">Blockchain - new google</a></li>
<li><a href="../395555/index.html">Viv is a new era of personal assistants. Interview with Doug Kittlaus, creator of Siri</a></li>
<li><a href="../395557/index.html"># 2 Video Slider Control Box</a></li>
<li><a href="../395559/index.html">Flight "Moscow - Sea of ‚Äã‚ÄãClarity" is delayed</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>