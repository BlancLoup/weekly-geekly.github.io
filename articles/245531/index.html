<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Code Review Process with Atlassian Stash</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! So our company decided to start a blog on Habr√© (after all, it‚Äôs not forever to read other people's articles). In the company profile you can s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Code Review Process with Atlassian Stash</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  Hello!  So our company decided to start a blog on Habr√© (after all, it‚Äôs not forever to read other people's articles).  In <a href="http://habrahabr.ru/company/arcadia/profile/">the company profile</a> you can see what we do.  In the near future, we will bring to your attention a series of articles on a wide range of topics: from distribution services and support for test builds of iOS applications to IIS software management.  And our first publication is devoted to Atlassian Stash. <br></blockquote><br><img src="https://habrastorage.org/files/429/a4d/751/429a4d75112947c69b75ef3309311ab1.png"><br><br>  For the current day, there is practically no information on the <a href="https://www.atlassian.com/software/stash">Atlassian Stash</a> (just one <a href="http://habrahabr.ru/post/145607/">announcement</a> and one <a href="http://habrahabr.ru/post/208732/">article</a> on the topic of installation).  Although the tool is, in fact, excellent, and definitely worth considering when using the entire Atlassian stack.  I want to tell what it is and how this thing can be added to the development process. <br><a name="habracut"></a><br>  A small background - we have a new customer and the opportunity to build the infrastructure for development from scratch.  I immediately wanted to do ‚Äúeverything is right‚Äù - git / CI / code-review, etc.  Everyone seems to agree that the code-review is important and necessary, meanwhile, not everyone uses it, and if they do, they mostly use a post-factum version - commit to a trunk, someone later looked.  Somewhere on the workflow it is forbidden to rezolvit task, until someone looked at the commit code, well, or other oral / written-agreed restrictions.  We wanted to make the process more controlled from a technical point of view. <br><br>  From solutions for / with support for code-review came to mind: <a href="http://habrahabr.ru/search/%3Fq%3Dtfs">TFS</a> , <a href="https://www.atlassian.com/software/stash">Atlassian Stash</a> , <a href="https://github.com/features">Github</a> , <a href="https://code.google.com/p/gerrit/">Gerrit</a> , the new <a href="https://www.jetbrains.com/upsource/">Upsource</a> from JetBrains. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Briefly for each: <br><ol><li>  We do not only have .NET and Windows, so TFS disappears (and in any case, the review does not work there when using git). </li><li>  Github - everything is clear, gives private repositories or standalone version of Github Enterprise.  An example of pull-request and review is <a href="https://github.com/jquery/jquery/pull/1241/files">github.com/jquery/jquery/pull/1241/files</a> .  The main argument against private repositories is private hosting. </li><li>  Gerrit - made specifically for code review, everything is cool, but we still have to host the repositories ourselves.  In addition, the use can be somewhat difficult for people who are used to SVN. </li><li>  Upsource is the same complaint as Gerrit is a tool exclusively for Code-Review, not for managing repositories.  Yes, and it did not exist at the time of choice. </li><li>  Stash is a relatively new product from Atlassian.  A sort of github in miniature - hosting / management repositories, integrates with Jira / Bamboo, allows you to do pull-requests, forks, and most importantly - not in the cloud.  Generally speaking, they also have Crucible (ex-Fisheye), but it is somewhat outdated and does not manage repositories by itself. </li></ol><br>  In the end, we decided to stop at Stash.  Installation / configuration / integration is typical for all Atlassian products, there is no particular point in dwelling on it.  Only git is supported, and the code-review requirement is implemented through pool-requests, and it is possible to configure the number of minimum apruv / successful builds so that you can restart the requester.  Builds are needed when integrating with Bamboo - for example, to ensure that nobody broke unit tests in this brunch.  Apparently, the number of successful builds makes sense only if there are separate performance runs (or others that take a relatively long time and therefore are not executed for each commit) tests in a separate build.  Well, I have not come up with another use. <br><br><img src="https://habrastorage.org/files/2fc/b24/f9c/2fcb24f9caee4843a07508738e7f9551.png"><br><br><h5>  Gitflow </h5><br>  How to organize branches correctly, so that later it would not be excruciatingly painful, has long been <a href="http://habrahabr.ru/post/106912/">invented</a> before us, so I won‚Äôt stop at the workflow itself - I‚Äôll just write an approximate algorithm: <br><br><ol><li>  All features / bugfixes must be in separate branches.  Well, everything is simple here - Stash manages the git repositories himself, the branches are, of course, supported, and the branches can be created directly from the issue window in Jira. </li><li>  The developer is pushing code in this brunch. </li><li>  If Bamboo has a customized build that automatically picks up new branches, Stash finds out that the build is ready. </li><li>  The developer creates a PR and assigns reviewers.  Appoints hands, randomly from the list, alas, is impossible. </li><li>  The reviewer receives a notification by mail, watches the changes (standard diff or two-pane comparison), can leave comments and so on.  In practice, it turns out that almost the entire team is placed on the revision controllers, and the people whose code has been touched by the edits, or those who are most familiar with the affected part of the project, click on the Approve button. </li><li>  The developer waits for the appruva and, if there is a green build, can pull a request and kill the task. </li></ol><br>  Video from Atlassian with a demonstration of this process: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/OMLh-5O6Ub8%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhj7tebMejzDbDi_YXGP5VKVWEIs1w" frameborder="0" allowfullscreen=""></iframe><br><br>  It shows how everything integrates coolly, but some of this (for example, the Start Review button) did not work for us.  Perhaps a problem with the version. <br><br><h5>  Finally, a slight squeeze of useful features / answers to possible questions </h5><br><ul><li>  Supported protocols: HTTP / HTTPS and SSH.  In the first case, password authentication, in the second - by key. </li><li>  Syntax highlighting. </li><li>  Ability to compare branches without creating pull-requests. </li><li>  Email notifications, of course.  About new pull-requests, new comments to created pull-requests, etc. </li><li>  There is a paid plugin Notifyr, which allows you to mark the repository as a favorite and receive notifications about all the buttons in it. </li><li>  It supports personal user repositories, the rights to which are controlled by the user. </li><li>  You can make forks.  Auto-sync branches are also supported.  A fly in the ointment - if you want to use the development model, where everyone works in their forks, and then they make a pull-request to the main repository, then you will not be able to add a dependency on the green builds in Bamboo - he simply does not know about the existence of forks. </li><li>  In the 3.x version there were likes for comments.  My personal opinion is that they have at least some practical value in the case of open-source (a very large and distributed team). </li><li>  It is impossible to prohibit (at least in version 2.x, there are already 3.x) direct commits (without pull-requests) in any branch.  In fact, the direct merge of branches, for example, to develop to bypass Stash, all the same, is forbidden in words, because merge is a feature of git.  You can, of course, give permissions to a branch only to the one responsible for the merge user, but this makes sense only in extremely rare cases. </li><li>  You can write hooks in Java and add them as plugins (for example, if you need to solve the problem from the previous paragraph). </li><li>  You can use the Jira / Crowd server as a user directory.  Each user individually can uncheck the Stash User checkbox - this can be useful if you have many users in Jira, and the Stash license is supported by, say, only 50 users. </li><li>  Enough voracious in terms of memory consumption. </li><li>  Despite the fact that both Stash and Bitbucket products are from the same company, the code-base is different, so the presence of a feature in one of them does not mean the same in the other. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/245531/">https://habr.com/ru/post/245531/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245521/index.html">Qt 5.4 and Qt Creator 3.3 Release</a></li>
<li><a href="../245523/index.html">Concurrent programming with CUDA. Part 2: GPU hardware and parallel communication patterns</a></li>
<li><a href="../245525/index.html">Peter Thiel: How to build a monopoly?</a></li>
<li><a href="../245527/index.html">Qt Creator 3.3 IDE Release</a></li>
<li><a href="../245529/index.html">Payments via WebMoney and other benefits of the Timeweb affiliate program</a></li>
<li><a href="../245533/index.html">Containers for Windows: 10 years before Microsoft</a></li>
<li><a href="../245535/index.html">Private library: information etiquette, preparation for large projects, lean manufacturing, space exploration</a></li>
<li><a href="../245537/index.html">Crowdsourcing translation of OWASP Testing Guide 4.0 has been launched into 30+ languages ‚Äã‚Äã(including Russian)</a></li>
<li><a href="../245539/index.html">Embedding into the Linux kernel: intercepting system calls</a></li>
<li><a href="../245545/index.html">Birch's hypothesis - Swinnerton-Dyer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>