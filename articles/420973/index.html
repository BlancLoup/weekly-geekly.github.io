<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>UFW configuration in Ubuntu Server 16.04 using the example of BigBlueButton</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="UFW (Uncomplicated Firewall) is an iptables interface designed to simplify the process of configuring a firewall. The iptables tool is reliable and fl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>UFW configuration in Ubuntu Server 16.04 using the example of BigBlueButton</h1><div class="post__text post__text-html js-mediator-article"> <b>UFW</b> (Uncomplicated Firewall) is an iptables interface designed to simplify the process of configuring a firewall.  The iptables tool is reliable and flexible, but it will not be easy for a beginner to configure it himself.  I'm just new to this business. <br><br>  By default, the ACCEPT policy is enabled in iptables and it looks like this: <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/wf/ie/xt/wfiextb29c6pm9uslq76-9cjdze.png"><br><br>  In our example, there are no restrictions.  The default policy is ACCEPT. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      INPUT - INCOMING CONNECTIONS. <br>  OUTPUT - OUTGOING CONNECTIONS. <br>  FORWARD - ROUTING (FOR EXAMPLE, IT IS NECESSARY TO PASS A ROUTE to the computer behind the gateway). <br><br>  You can enable ufw with <code>sudo ufw enable</code> <br>  And immediately after this command, the iptables policy will change. <br>  Here is how it looks on BigBlueButton after turning on ufw: <br><br><pre> <code class="hljs cmake">Chain INPUT (<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span> DROP) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ufw-before-logging-input all -- anywhere anywhere ufw-before-input all -- anywhere anywhere ufw-after-input all -- anywhere anywhere ufw-after-logging-input all -- anywhere anywhere ufw-reject-input all -- anywhere anywhere ufw-track-input all -- anywhere anywhere Chain FORWARD (<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span> DROP) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ufw-before-logging-forward all -- anywhere anywhere ufw-before-forward all -- anywhere anywhere ufw-after-forward all -- anywhere anywhere ufw-after-logging-forward all -- anywhere anywhere ufw-reject-forward all -- anywhere anywhere ufw-track-forward all -- anywhere anywhere Chain OUTPUT (<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span> ACCEPT) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ufw-before-logging-output all -- anywhere anywhere ufw-before-output all -- anywhere anywhere ufw-after-output all -- anywhere anywhere ufw-after-logging-output all -- anywhere anywhere ufw-reject-output all -- anywhere anywhere ufw-track-output all -- anywhere anywhere Chain ufw-after-forward (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-after-input (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-input udp -- anywhere anywhere udp dpt:netbios-ns ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-input udp -- anywhere anywhere udp dpt:netbios-dgm ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-input tcp -- anywhere anywhere tcp dpt:netbios-ssn ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-input tcp -- anywhere anywhere tcp dpt:microsoft-ds ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-input udp -- anywhere anywhere udp dpt:bootps ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-input udp -- anywhere anywhere udp dpt:bootpc ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-input all -- anywhere anywhere ADDRTYPE match dst-type BROADCAST Chain ufw-after-logging-forward (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination LOG all -- anywhere anywhere limit: avg <span class="hljs-number"><span class="hljs-number">3</span></span>/min burst <span class="hljs-number"><span class="hljs-number">10</span></span> LOG level warning prefix <span class="hljs-string"><span class="hljs-string">"[UFW BLOCK] "</span></span> Chain ufw-after-logging-input (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination LOG all -- anywhere anywhere limit: avg <span class="hljs-number"><span class="hljs-number">3</span></span>/min burst <span class="hljs-number"><span class="hljs-number">10</span></span> LOG level warning prefix <span class="hljs-string"><span class="hljs-string">"[UFW BLOCK] "</span></span> Chain ufw-after-logging-output (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-after-output (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-before-forward (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ACCEPT all -- anywhere anywhere ctstate RELATED,ESTABLISHED ACCEPT icmp -- anywhere anywhere icmp destination-unreachable ACCEPT icmp -- anywhere anywhere icmp source-quench ACCEPT icmp -- anywhere anywhere icmp time-exceeded ACCEPT icmp -- anywhere anywhere icmp parameter-problem ACCEPT icmp -- anywhere anywhere icmp echo-request ufw-user-forward all -- anywhere anywhere Chain ufw-before-input (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ACCEPT all -- anywhere anywhere ACCEPT all -- anywhere anywhere ctstate RELATED,ESTABLISHED ufw-logging-deny all -- anywhere anywhere ctstate INVALID DROP all -- anywhere anywhere ctstate INVALID ACCEPT icmp -- anywhere anywhere icmp destination-unreachable ACCEPT icmp -- anywhere anywhere icmp source-quench ACCEPT icmp -- anywhere anywhere icmp time-exceeded ACCEPT icmp -- anywhere anywhere icmp parameter-problem ACCEPT icmp -- anywhere anywhere icmp echo-request ACCEPT udp -- anywhere anywhere udp spt:bootps dpt:bootpc ufw-<span class="hljs-keyword"><span class="hljs-keyword">not</span></span>-local all -- anywhere anywhere ACCEPT udp -- anywhere <span class="hljs-number"><span class="hljs-number">224.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.251</span></span> udp dpt:mdns ACCEPT udp -- anywhere <span class="hljs-number"><span class="hljs-number">239.255</span></span>.<span class="hljs-number"><span class="hljs-number">255.250</span></span> udp dpt:<span class="hljs-number"><span class="hljs-number">1900</span></span> ufw-user-input all -- anywhere anywhere Chain ufw-before-logging-forward (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-before-logging-input (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-before-logging-output (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-before-output (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ACCEPT all -- anywhere anywhere ACCEPT all -- anywhere anywhere ctstate RELATED,ESTABLISHED ufw-user-output all -- anywhere anywhere Chain ufw-logging-allow (<span class="hljs-number"><span class="hljs-number">0</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination LOG all -- anywhere anywhere limit: avg <span class="hljs-number"><span class="hljs-number">3</span></span>/min burst <span class="hljs-number"><span class="hljs-number">10</span></span> LOG level warning prefix <span class="hljs-string"><span class="hljs-string">"[UFW ALLOW] "</span></span> Chain ufw-logging-deny (<span class="hljs-number"><span class="hljs-number">2</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> all -- anywhere anywhere ctstate INVALID limit: avg <span class="hljs-number"><span class="hljs-number">3</span></span>/min burst <span class="hljs-number"><span class="hljs-number">10</span></span> LOG all -- anywhere anywhere limit: avg <span class="hljs-number"><span class="hljs-number">3</span></span>/min burst <span class="hljs-number"><span class="hljs-number">10</span></span> LOG level warning prefix <span class="hljs-string"><span class="hljs-string">"[UFW BLOCK] "</span></span> Chain ufw-<span class="hljs-keyword"><span class="hljs-keyword">not</span></span>-local (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> all -- anywhere anywhere ADDRTYPE match dst-type LOCAL <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> all -- anywhere anywhere ADDRTYPE match dst-type MULTICAST <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> all -- anywhere anywhere ADDRTYPE match dst-type BROADCAST ufw-logging-deny all -- anywhere anywhere limit: avg <span class="hljs-number"><span class="hljs-number">3</span></span>/min burst <span class="hljs-number"><span class="hljs-number">10</span></span> DROP all -- anywhere anywhere Chain ufw-reject-forward (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-reject-input (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-reject-output (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-forward (<span class="hljs-number"><span class="hljs-number">0</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination DROP all -- anywhere anywhere Chain ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-input (<span class="hljs-number"><span class="hljs-number">7</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination DROP all -- anywhere anywhere Chain ufw-skip-to-<span class="hljs-keyword"><span class="hljs-keyword">policy</span></span>-output (<span class="hljs-number"><span class="hljs-number">0</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ACCEPT all -- anywhere anywhere Chain ufw-track-forward (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-track-input (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-track-output (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ACCEPT tcp -- anywhere anywhere ctstate NEW ACCEPT udp -- anywhere anywhere ctstate NEW Chain ufw-user-forward (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-user-input (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination &lt;b&gt;ACCEPT tcp -- anywhere anywhere tcp dpt:ssh ACCEPT udp -- anywhere anywhere udp dpt:ssh ACCEPT tcp -- anywhere anywhere tcp dpt:<span class="hljs-number"><span class="hljs-number">1935</span></span> ACCEPT udp -- anywhere anywhere udp dpt:<span class="hljs-number"><span class="hljs-number">1935</span></span> ACCEPT udp -- anywhere anywhere multiport dports <span class="hljs-number"><span class="hljs-number">16384</span></span>:<span class="hljs-number"><span class="hljs-number">32768</span></span> ACCEPT tcp -- anywhere anywhere tcp dpt:https ACCEPT udp -- anywhere anywhere udp dpt:https ACCEPT tcp -- anywhere anywhere tcp dpt:http ACCEPT udp -- anywhere anywhere udp dpt:http ACCEPT tcp -- anywhere anywhere tcp dpt:<span class="hljs-number"><span class="hljs-number">5090</span></span> ACCEPT udp -- anywhere anywhere udp dpt:<span class="hljs-number"><span class="hljs-number">5090</span></span> ACCEPT tcp -- anywhere anywhere tcp dpt:sip ACCEPT udp -- anywhere anywhere udp dpt:sip ACCEPT tcp -- anywhere anywhere tcp dpt:<span class="hljs-number"><span class="hljs-number">5066</span></span> ACCEPT udp -- anywhere anywhere udp dpt:<span class="hljs-number"><span class="hljs-number">5066</span></span> ACCEPT tcp -- anywhere anywhere tcp dpt:tproxy ACCEPT udp -- anywhere anywhere udp dpt:<span class="hljs-number"><span class="hljs-number">8081</span></span> ACCEPT tcp -- anywhere anywhere tcp dpt:<span class="hljs-number"><span class="hljs-number">8082</span></span> ACCEPT udp -- anywhere anywhere udp dpt:<span class="hljs-number"><span class="hljs-number">8082</span></span> ACCEPT tcp -- anywhere anywhere tcp dpt:<span class="hljs-number"><span class="hljs-number">3000</span></span> ACCEPT udp -- anywhere anywhere udp dpt:<span class="hljs-number"><span class="hljs-number">3000</span></span> ACCEPT tcp -- anywhere anywhere tcp dpt:<span class="hljs-number"><span class="hljs-number">2855</span></span> ACCEPT udp -- anywhere anywhere udp dpt:<span class="hljs-number"><span class="hljs-number">2855</span></span> ACCEPT tcp -- anywhere anywhere tcp dpt:<span class="hljs-number"><span class="hljs-number">2856</span></span> ACCEPT udp -- anywhere anywhere udp dpt:<span class="hljs-number"><span class="hljs-number">2856</span></span>&lt;/b&gt; Chain ufw-user-limit (<span class="hljs-number"><span class="hljs-number">0</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination LOG all -- anywhere anywhere limit: avg <span class="hljs-number"><span class="hljs-number">3</span></span>/min burst <span class="hljs-number"><span class="hljs-number">5</span></span> LOG level warning prefix <span class="hljs-string"><span class="hljs-string">"[UFW LIMIT BLOCK] "</span></span> REJECT all -- anywhere anywhere reject-with icmp-port-unreachable Chain ufw-user-limit-accept (<span class="hljs-number"><span class="hljs-number">0</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination ACCEPT all -- anywhere anywhere Chain ufw-user-logging-forward (<span class="hljs-number"><span class="hljs-number">0</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-user-logging-input (<span class="hljs-number"><span class="hljs-number">0</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-user-logging-output (<span class="hljs-number"><span class="hljs-number">0</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination Chain ufw-user-output (<span class="hljs-number"><span class="hljs-number">1</span></span> references) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> prot opt source destination</code> </pre> <br>  The selected area is a place for user rules, they are written with commands: <br><br>  For the port: <br><br>  <code>sudo ufw allow ssh</code> (by port name) <br>  <code>sudo ufw allow 22</code> (specify port number) <br>  <code>sudo ufw allow 80/udp</code> (specifically indicating the port number and tcp or udp protocol) <br><br>  For a range of ports: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sudo</span></span> ufw allow <span class="hljs-number"><span class="hljs-number">16384</span></span>:<span class="hljs-number"><span class="hljs-number">32768</span></span>/udp</code> </pre> <br>  Deleting rules: <br><br><pre> <code class="hljs sql">sudo ufw <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">allow</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span></code> </pre> <br>  <b>I post the procedure for setting up ufw using bbb as an example.</b> <br><br>  First, we look at which services which ports are listening: <br><br><pre> <code class="hljs pgsql">netstat -ntlp | grep <span class="hljs-keyword"><span class="hljs-keyword">LISTEN</span></span></code> </pre> <br> <code>tcp 0 0 xxx.xxx.xxx.x:5090 0.0.0.0:* LISTEN 1258/freeswitch <br> tcp 0 0 127.0.0.1:8100 0.0.0.0:* LISTEN 1720/soffice.bin <br> <b>tcp 0 0 xxx.xxx.xxx.x:5060 0.0.0.0:* LISTEN 1258/freeswitch</b> <br> tcp 0 0 127.0.0.1:8101 0.0.0.0:* LISTEN 1766/soffice.bin <br> tcp 0 0 127.0.0.1:8102 0.0.0.0:* LISTEN 1811/soffice.bin <br> tcp 0 0 127.0.0.1:8103 0.0.0.0:* LISTEN 1856/soffice.bin <br> <b>tcp 0 0 xxx.xxx.xxx.x:2855 0.0.0.0:* LISTEN 1258/freeswitch</b> <br> tcp 0 0 127.0.0.1:8104 0.0.0.0:* LISTEN 1902/soffice.bin <br> <b>tcp 0 0 xxx.xxx.xxx.x:2856 0.0.0.0:* LISTEN 1258/freeswitch</b> <br> tcp 0 0 127.0.0.1:27017 0.0.0.0:* LISTEN 1186/mongod <br> <b>tcp 0 0 xxx.xxx.xxx.x:5066 0.0.0.0:* LISTEN 1258/freeswitch</b> <br> tcp 0 0 127.0.0.1:6379 0.0.0.0:* LISTEN 1227/redis-server 1 <br> tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 1359/nginx -g daemo <br> <b>tcp 0 0 xxx.xxx.xxx.x:8081 0.0.0.0:* LISTEN 1258/freeswitch</b> <br> <b>tcp 0 0 xxx.xxx.xxx.x:8082 0.0.0.0:* LISTEN 1258/freeswitch</b> <br> <b>tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 1176/sshd</b> <br> <b>tcp 0 0 0.0.0.0:3000 0.0.0.0:* LISTEN 1195/node</b> <br> tcp6 0 0 ::1:5090 :::* LISTEN 1258/freeswitch <br> tcp6 0 0 ::1:5060 :::* LISTEN 1258/freeswitch <br> tcp6 0 0 127.0.0.1:8005 :::* LISTEN 1341/java <br> tcp6 0 0 :::5070 :::* LISTEN 1461/java <br> tcp6 0 0 :::9999 :::* LISTEN 1461/java <br> tcp6 0 0 :::1935 :::* LISTEN 1461/java <br> tcp6 0 0 :::8080 :::* LISTEN 1341/java <br> tcp6 0 0 :::80 :::* LISTEN 1359/nginx -g daemo <br> tcp6 0 0 ::1:8081 :::* LISTEN 1258/freeswitch <br> tcp6 0 0 ::1:8082 :::* LISTEN 1258/freeswitch <br> tcp6 0 0 :::8021 :::* LISTEN 1258/freeswitch <br> tcp6 0 0 :::22 :::* LISTEN 1176/sshd <br> tcp6 0 0 :::5080 :::* LISTEN 1461/java</code> <br> <br>  We are interested in lines with xxx.xxx.xxx.x (xxx.xxx.xxx.x is the ip-address of your server), as this indicates that the service listens to the network card for incoming requests from all networks (0.0.0.0:*) .  We are not interested in lines from 127.0.0.1 as it is an internal interface, as we are interested in lines from 0.0.0.0 in column 4 (bold), for example <br><br> <code>tcp 0 0 <b>0.0.0.0:80</b> 0.0.0.0:* LISTEN 1359/nginx -g daemo</code> <br> <br>  as it says that port 80 is open for all server interfaces and accepts requests from all networks. <br><br>  So, according to this we make the rules: <br><br>  <code>sudo ufw allow 22</code> for ssh <br>  <code>sudo ufw allow 80</code> for nginx or apache webserver <br><br>  A whole series of rules for freeswitch: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">sudo</span></span> ufw allow <span class="hljs-number"><span class="hljs-number">5060</span></span> sudo ufw allow <span class="hljs-number"><span class="hljs-number">5090</span></span> sudo ufw allow <span class="hljs-number"><span class="hljs-number">2855</span></span> sudo ufw allow <span class="hljs-number"><span class="hljs-number">2856</span></span> sudo ufw allow <span class="hljs-number"><span class="hljs-number">5066</span></span> sudo ufw allow <span class="hljs-number"><span class="hljs-number">8081</span></span> sudo ufw allow <span class="hljs-number"><span class="hljs-number">8082</span></span></code> </pre> <br>  for node service: <br><br> <code>sudo ufw allow 3000</code> <br>  Next you need to see all the same documentation, in which we will see that you need to open the following ports: <br><br>  <code>sudo ufw allow 16384:32768/udp</code> - for WebRTC to work <br> <code>sudo ufw allow 443</code> <br> <code>sudo ufw allow 1935</code> <br> <br>  This completes the basic ufw setting for the BigBlueButton 2.0 server. <br><br>  I will add only what is desirable to either disable ssh or change the port, or allow this port only for a specific network, for example, for the network of your enterprise. <br><br>  For example, your gateway has two network interfaces, one virtual (to users) 192.168.3.2, and another real 105.xxx.xxx.xxx (to the provider), but for the ufw rule, we take the real ip, or rather we specify the network that owns ip. <br><br>  First, we change the port in the SSH server configuration file, you can use any text editor: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">vim</span></span> /etc/ssh/sshd_config</code> </pre> <br>  Then we delete the rule allowing port 22: <br><br>  <code>Sudo ufw delete allow 22</code> - sometimes called openssh. <br><br>  Create a rule allowing the connection to the new port only from the enterprise network: <br><br><pre> <code class="hljs pgsql">sudo ufw allow <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">105.</span></span>../<span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> port <span class="hljs-number"><span class="hljs-number">4321</span></span></code> </pre> <br>  Then reboot the ssh service: <br><br><pre> <code class="hljs swift">/etc/<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>.d/ssh restart</code> </pre> <br>  And see the result <br><br><pre> <code class="hljs pgsql">netstat -ntlp | grep <span class="hljs-keyword"><span class="hljs-keyword">LISTEN</span></span></code> </pre> <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">tcp</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0.0.0.0:4321</span></span> <span class="hljs-number"><span class="hljs-number">0.0.0.0</span></span>:* listen <span class="hljs-number"><span class="hljs-number">5676</span></span>/sshd</code> </pre> <br>  and in the ufw rules, see who has access to the port: <br><br><pre> <code class="hljs lua">ufw <span class="hljs-built_in"><span class="hljs-built_in">status</span></span></code> </pre> <br><pre> <code class="hljs">4321 ALLOW 105.xxx.xxx.xxx/26</code> </pre> <br>  Dear readers, I ask you to write additions in the comments: Do you think everything is correctly described here, or is it necessary to add or remove something? </div><p>Source: <a href="https://habr.com/ru/post/420973/">https://habr.com/ru/post/420973/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420963/index.html">Business analytics: how to abandon Excel without abandoning it</a></li>
<li><a href="../420965/index.html">The six most useful reports from Frontend Conf 2018</a></li>
<li><a href="../420967/index.html">Helping to swim: how to introduce newcomers to a complex project</a></li>
<li><a href="../420969/index.html">Journal "News of Cosmonautics" ceases to exist</a></li>
<li><a href="../420971/index.html">Accident Response: Stretched Cluster vs. DR Site</a></li>
<li><a href="../420975/index.html">Do not do this in production.</a></li>
<li><a href="../420977/index.html">Tricks QComboBox + QTreeView</a></li>
<li><a href="../420979/index.html">Redux Basics (Text Tutorial, 2nd Edition)</a></li>
<li><a href="../420981/index.html">‚ÄúI can tell you about the common pain of all iOS developers‚Äù - 10 questions for a programmer, issue 2</a></li>
<li><a href="../420983/index.html">Researchers claim that it‚Äôs almost impossible to hide from Google.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>