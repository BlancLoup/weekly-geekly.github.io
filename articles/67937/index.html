<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In search of a UFO. Detection of objects in the image</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Breaking captcha is, of course, interesting and informative, but, by and large, it is useless. This is only a special case of a problem that arises in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In search of a UFO. Detection of objects in the image</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/blogs/artificial_intelligence/67194/">Breaking captcha</a> is, of course, interesting and informative, but, by and large, it is useless.  This is only a special case of a problem that arises in one of the interesting directions of development of IT - <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B8%25D1%258F_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D0%25BE%25D0%25B7%25D0%25BD%25D0%25B0%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B7%25D0%25BE%25D0%25B2">pattern recognition</a> ( <a href="http://en.wikipedia.org/wiki/Pattern_recognition">pattern recognition</a> ). <br><br><img src="http://www.geliosmi.com/images/stories/articles/haartraining/1.jpg"><br><br>  Today we will look at the algorithm (more precisely, more correctly, consider this a technique, because it combines many algorithms), which stands at the junction of such areas as Machine Learning and Computer Vision. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      With the help of this algorithm, we will look for UFOs (covetous on the holy) in the images. <br><br><a name="habracut"></a><br><h2>  Introduction </h2><br><br>  The presented technique was first described in the article ‚Äú <a href="http://research.microsoft.com/en-us/um/people/viola/pubs/detect/violajones_cvpr2001.pdf">Rapid Object Detection using a Boosted Cascade of Simple Features</a> ‚Äù, Paul Viola, Michael Jones, 2001. Since then, it has been widely recognized in its field.  And the scope, it is not difficult to guess, this is a search for objects in images or in a video stream. <br><br>  It turned out that initially the technique was developed and applied in the field of developing algorithms for detecting faces, but nothing prevents to train the algorithm to search for other objects: the machine;  prohibited objects on the x-ray at the airport;  swelling in medical images.  In general, as you understand, this is serious and can be of great benefit to humanity. <br><br><img src="http://www.geliosmi.com/images/stories/articles/haartraining/2.png"><br><br><h2>  Method Description </h2><br><br>  <strong>AdaBoost</strong> <br><br>  The methodology is based on the adaptive boosting algorithm (adaptive amplification) or abbreviated <a href="http://ru.wikipedia.org/wiki/AdaBoost">AdaBoost</a> .  The meaning of the algorithm is that if we have a set of reference objects, i.e.  there are values ‚Äã‚Äãand a class to which they belong (for example, -1 - no face, +1 - there is a face), besides there are a lot of simple classifiers, then we can make one more perfect and powerful classifier.  At the same time, in the process of drawing up or training the final classifier, emphasis is placed on standards that are recognized ‚Äúworse‚Äù, this is the adaptability of the algorithm, and in the process of training it adapts to the most ‚Äúcomplex‚Äù objects.  View the work of the algorithm <a href="http://cseweb.ucsd.edu/~yfreund/adaboost/index.html">here</a> . <br><br>  In general, AdaBoost is a very efficient and fast algorithm.  In my projects, I use it to detect weak anomalies against the background of strong interference in various data that are in no way connected with images and have a different nature.  Those.  The algorithm is universal and I advise you to pay attention to it.  It is distributed in data mining, which is now popular in the world, even entered the " <a href="http://www.cs.umd.edu/~samir/498/10Algorithms-08.pdf">Top 10 algorithms in data mining</a> ".  Very informative publication, I advise everyone. <br><br>  <strong>Haar-like features</strong> <br><br>  The question is how to describe the picture?  What to use as a sign for classification?  Taking into account the fact that it is necessary to do this quickly and our objects can be of different shapes, colors, slopes ... In this method, the so-called haar-like features are used (I will call them primitives in the following). <br><br><img src="http://www.geliosmi.com/images/stories/articles/haartraining/3.png"><br><br>  In the picture above, you see a set of such primitives.  To understand the essence, imagine that we take a reference image and impose on it any of the primitives, for example, 1a, then we consider the sum of the pixel values ‚Äã‚Äãin the white area of ‚Äã‚Äãthe primitive (left side) and black area (right side) and subtract the second .  As a result, we obtain a generalized anisotropy characteristic of a certain part of the image. <br><br>  But there is a problem.  Even for a small image, the number of superimposed primitives is very large, if you take an image with a size of 24x24, then the number of primitives is ~ 180,000. The task of the AdaBoost algorithm is to select those primitives that most effectively select this object. <br><br>  For example: <br><br><img src="http://www.geliosmi.com/images/stories/articles/haartraining/4.png"><br><br>  For the object on the left, the algorithm chose two primitives.  For obvious reasons, the eye area is darker compared to the middle area of ‚Äã‚Äãthe face and nose.  The primitives of this configuration and size best ‚Äúcharacterize‚Äù this image. <br>  On the basis of such classifiers, a cascade is constructed with the most efficient primitives selected.  Each subsequent element of the cascade has more stringent conditions for successful passage than the previous one (more primitives are used), thus reaching the end only the most ‚Äúcorrect‚Äù ones. <br><br>  <strong>Implementation of algorithms</strong> <br><br>  We are lazy guys, so we will use the <a href="http://opencv.willowgarage.com/wiki/FaceDetection">implementation of</a> this technique from the <a href="http://sourceforge.net/projects/opencv/">OpenCV library</a> .  There are already written modules for creating samples, learning the cascade and testing it.  I must say that the implementation is quite raw and therefore should be prepared for frequent departures, freezes in the learning process and other unpleasant things.  I had to dive into the sources several times and edit them for myself.  A very detailed and easy to understand tutorial describing the work with the implementation of this technique can be found <a href="http://note.sonots.com/SciSoftware/haartraining.html">here</a> . <br><br>  The learning algorithm is a very long-running thing.  With the right approach, the learning process can last 3-7 days.  Therefore, we will maximally simplify the task, since  I have neither time nor computational resources to spend a week on training.  On the training cascade for this article, I needed 1 day work Core 2 Duo. <br><br>  It should be noted that the implementation of OpenCV used a more advanced modification of the algorithm AdaBoost - Gentle AdaBoost. <br><br><h2>  Formulation of the problem </h2><br><br>  With theory everything.  We proceed to practice.  Our task is to find this (the artist of me is bad): <br><br><img src="http://www.geliosmi.com/images/stories/articles/haartraining/UFO.jpg"><br><br>  On such images (it is necessary to take into account that in the work all color images are translated into grayscale, otherwise the number of invariants is too large): <br><br><img src="http://www.geliosmi.com/images/stories/articles/haartraining/5.png"><br><br>  Provided that: <br><br>  1. The object may have a different color.  ¬± 50 values ‚Äã‚Äãfrom the original. <br>  2. The object may have a different size.  Size can be changed up to 3 times. <br>  3. The object has a different angle of inclination.  The angle ranges from 30 ¬∞. <br>  4. The object has a random location in the image. <br><br><h2>  Stage 1. Creating a training set. </h2><br><br>  The first and very important step is to create a training sample.  Here you can go two ways.  Submit a pre-compiled database of images (for example, individuals) for training, or generate a specified number of cases on the basis of a single reference object.  The last option is suitable for us, all the more so that to generate a sample based on a single object in OpenCV, there is an createsamples module.  As background images (i.e., images on which the required object is missing), a couple of hundreds of space images are used (example above). <br><br>  Depending on the specified parameters, the module takes the reference object, applies various deformations to it (rotation, color, noise is added), then selects a background image and places an object on it randomly.  It turns out the following: <br><br><img src="http://www.geliosmi.com/images/stories/articles/haartraining/6.png"><br><br>  In real-world tasks, you need to focus on the size of the training sample in the region of 5000. I generated 2,000 such objects. <br><br><h2>  Stage 2. Training </h2><br><br>  Now you need to create a cascade of classifiers for the existing database of objects.  For this we use the haartraining module.  Many parameters are transferred to it, the most important of which are the number of classifiers in a cascade, the minimum required classifier efficiency ratio (minimum hit rate), the maximum permissible false response rate (maximum false alarm).  The parameters are much more and the one who decides to repeat the experiment will be able to get to know them in more detail <a href="http://docs.google.com/View%3FdocID%3Ddrw35kw_6gr8r84fs">here</a> . <br><br><h2>  Stage 3. Testing the cascade </h2><br><br>  After a long wait, the program produces a trained cascade in the form of an xml file that can be used directly to detect objects.  To test it, we again generate 1000 objects according to the principle described in the first stage, thereby creating a test sample. <br><br>  To test the cascade, the performance module is used.  By feeding him a test sample and a cascade, after a few seconds we can see the following picture in the console: <br><br><blockquote><pre>  + ================================ + ====== + ====== + == ==== +
 |  File Name |  Hits | Missed |  False |
 + ================================ + ====== + ====== + == ==== +
 |  0001_0032_0126_0138_0066.jpg |  1 |  0 |  0 |
 + -------------------------------- + ------ + ------ + - ---- +
 |  0002_0088_0079_0188_0091.jpg |  1 |  0 |  1 |
 + -------------------------------- + ------ + ------ + - ---- +
 |  0003_0059_0170_0127_0061.jpg |  0 |  1 |  0 |
 + -------------------------------- + ------ + ------ + - ---- +
 |  0004_0035_0143_0134_0065.jpg |  1 |  0 |  0 |
 + -------------------------------- + ------ + ------ + - ---- +
 .......
 + -------------------------------- + ------ + ------ + - ---- +
 |  Total |  457 |  543 |  570 |
 + ================================ + ====== + ====== + == ==== +
 Number of stages: 7
 Number of weak classifiers: 34
 Total time: 14.114000 </pre></blockquote><br><br>  First of all, look at the time (the value of "Total time"), which took to process 1000 images.  Taking into account that they had to be read from the disk, the time spent on processing one image is a fraction of a second: 14/1000 = 14 ms.  Very fast. <br><br>  Now directly on the results of the classification.  ‚ÄúHits‚Äù is the number of objects found;  "Missed" is the number of missed;  ‚ÄúFalse‚Äù is the number of false positives (i.e., the cascade gave a positive response in the area where there is no object).  Overall, this is a bad result.  :) More precisely, as an example for this article, it is satisfactory, but for use in real-world tasks, you should be more careful in creating a training set and determining the optimal parameters for training, then it is possible to achieve an efficiency of 95% with a false response rate of 0.001. <br><br>  Some results of the algorithm: <br><br><img src="http://www.geliosmi.com/images/stories/articles/haartraining/7.png"><br><br>  And here are a couple of examples with false positives: <br><br><img src="http://www.geliosmi.com/images/stories/articles/haartraining/8.png"><br><br><h2>  Conclusion </h2><br><br>  The described method has rather wide application.  It can be successfully combined with other algorithms.  For example, the described method can be used to search for an object in an image, and a classical neural network or another method for recognition. <br><br>  Thank you for your attention, I hope it was interesting. <br><br>  What to read in addition to these sources: <br>  <a href="http://www.lienhart.de/Publications/DAGM2003.pdf">Expanded Sequence of Disturbances</a> . <br>  <a href="http://pages.cpsc.ucalgary.ca/~ehud/Publications/Final_Case_paper.pdf">Implementing Bubblegrams for Human-Robot Interaction</a> . <br><br>  This article shows that pattern recognition is not alive by the neural network.  Therefore, in continuation of the above thought and in the next article I would like to talk about object recognition using a statistical approach, namely the use of multidimensional statistical characteristics of the image and the Principal Component Analysis (PCA) Method. <br></div><p>Source: <a href="https://habr.com/ru/post/67937/">https://habr.com/ru/post/67937/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../67928/index.html">IE8 and InPrivate mode</a></li>
<li><a href="../67930/index.html">Anti-crisis marketing</a></li>
<li><a href="../67931/index.html">From Mr. Tompkins' Notebook</a></li>
<li><a href="../67932/index.html">USB 3.0 PDK available</a></li>
<li><a href="../67933/index.html">Belarusian language on Google Translate</a></li>
<li><a href="../67938/index.html">Evernote for iPhone 3.1: Focus on Speed</a></li>
<li><a href="../67941/index.html">Redesign, part 2</a></li>
<li><a href="../67942/index.html">Non-recursive sampling of the entire tree. Adjacency List</a></li>
<li><a href="../67943/index.html">55 thousand sites on the Internet were infected with the same iframe</a></li>
<li><a href="../67945/index.html">Meet - Opera 10 RC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>