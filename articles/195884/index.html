<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Radiadic floor lamp or another "2 pennies" in the piggy bank of the "smart home"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After a series of posts about the DIY-dimmer of the ‚Äúsmart home‚Äù I decided to tell about my implementation of such a project. 

  

 The purpose of my...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Radiadic floor lamp or another "2 pennies" in the piggy bank of the "smart home"</h1><div class="post__text post__text-html js-mediator-article">  After a <a href="http://habrahabr.ru/post/192926/">series of</a> <a href="http://habrahabr.ru/post/193510/">posts</a> about the <a href="http://habrahabr.ru/post/195240/">DIY-dimmer of the</a> ‚Äúsmart home‚Äù I decided to tell about my implementation of such a project. <br><br> <a href=""><img src="https://habrastorage.org/storage3/4c8/09c/f63/4c809cf63dc9911cabc024342fd65447.jpg"></a> <br><br>  The purpose of my post is to share experiences and suggest several directions for reflection. <br><a name="habracut"></a><br><blockquote>  For me, ‚Äúsmart home‚Äù is when there is some problem area in ordinary home life, some decision is made for it, which starts working without human participation and allows you to forget this problem area for at least a long time, and ideally forever. </blockquote><br>  On one of the evenings, a ‚Äúfloor lamp‚Äù that had been forgotten in a living room corner, which no one had turned on for a long time, ‚Äúdiscovered‚Äù was found. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is due to the fact that the light in the living room is controlled by a Logitech universal console and via the web.  To make it possible, a small piece of hardware was made on the Arduino, which received IR commands from the console and ‚Äúpressed the buttons‚Äù on the radio remote control from the ceiling light.  In addition, this piece of hardware is equipped with the nRF24L01 + module and can receive commands from other modules, in particular, my LAN and GSM gateways, and transmit data about its state.  But it is not about her in this post (wrote a little about it <a href="http://habrahabr.ru/post/171613/">here</a> ). <br><br>  So, a ‚Äúproblem area‚Äù was <b>discovered</b> - an <b>unradiated floor lamp</b> . <br><br>  After thinking about this topic, it was thought that a similar task (remote on-off) can even be very useful in at least two more places - the power of the router and the modem provider (implement a reboot "on power"). <br><br><blockquote>  Later, the idea appeared to make our own switches (yes, for installation in standard podrozetniki and also managed through a radio channel), but so far they have not reached the point of implementation due to lack of time. </blockquote><br>  Thus, it turns out that the project is at least not ‚Äúone-time‚Äù and can be replicated in the near and not so near future. <br><br>  Said and done, I look at what is in the ‚Äúbins of the motherland‚Äù (a box with radio parts) and discover: <br><ul><li>  prudently purchased relyushki with a voltage of 5V, which the ‚Äúadults‚Äù 250V with their current up to 7A can switch to themselves, </li><li>  I wanted to use atmega168 as an MK, but it turned out that I purchased a couple of atmega8 in DIP packages for some of my future needs, but my hands haven‚Äôt reached them yet - it‚Äôs their turn, </li><li>  a pack of transistors KT306G (still from Soviet times). </li></ul><br>  I decided to abandon the quartz resonator in the circuit in favor of simplifying the circuit and the board. <br>  MK will program via ISP using USBtinyISP programmer, which has also been waiting for its time. <br><br>  Immediately thought about the power of the developed module. <br><br>  To fence one more power supply unit to the power supply unit, which commutes the power of the floor lamp (or other device), somehow did not want to.  Make a complete circuit with power right away - too.  And then I came across charging for the iPhone (I found a place in Moscow where you can buy them for 100 rubles each and on that occasion I bought 5 pieces ‚Äúin reserve‚Äù). <br><br>  The right tool in hand and voila: <br><img src="https://habrastorage.org/storage3/7f1/cdc/1dd/7f1cdc1ddf945f19b5539b7688597879.jpg"><br><br>  Wonderful shawl pulse BP with 5V output and current up to 1A - I use it. <br><br>  The first prototype is implemented on a breadboard and proudly demonstrated to the wife at work. <br>  The first reaction: "But you will not leave this structure in this form and make a body for it?" <br><br>  The case was "made" of the usual soap dish. <br><br>  To the unit was "universal", equipped with a conventional electrical plug and the appropriate outlet.  The socket, unfortunately, at that time found only one similar to that I used to make a garden extension cord (purchased at a hardware store).  To put it mildly, both the plug and the socket are somewhat large. <br><br>  In general, as usual - "I blinded him from what was": <br><img src="https://habrastorage.org/storage3/70e/09e/8a0/70e09e8a0b6898eaa21cb38e532217de.jpg"><br><br>  It took a couple of hours to make a prototype. <br>  Somewhere it took an hour to write and test a sketch and small dances with a tambourine to fill it with MK (not a single MK with firmware was damaged by incorrectly set fusions). <br><br>  After several days of trial operation, the floor lamp has found a ‚Äúsecond life‚Äù. <br><br>  You can start replication. <br><br>  Only this time, the iteration began with a search for a suitable case in which the main board and the power supply board fit.  Additionally, I wanted to leave the charging function (USB-connector). <br><br>  A suitable case was found in the near "Chip and Dip" (yes, expensive, but right away).  The size of the case 63x44x31mm and its internal layout quite clearly gave the dimensions of the future mainboard. <br><br>  Scheme quickly threw in Eagle and spread the fee there. <br><blockquote>  If a scheme and fee is required - let us know in the comments - I will make an update to the article. </blockquote><br><br>  <b>upd</b> : scheme: <br><img src="https://habrastorage.org/storage3/9a2/1e8/e64/9a21e8e643fd7d162edfc1ae90ebeb2b.jpg"><br><br>  At first I wanted to dwell on a one-sided board, but after several attempts at optimizing the wiring, I abandoned this idea and decided to LOCK the double-sided board using <a href="http://easyelectronics.ru/izgotovlenie-dvustoronnej-platy-video-urok.html">this method</a> . <br><br>  For me it was the first experience (once 100% successful, although not without flaw). <br><br><div class="spoiler">  <b class="spoiler_title">The technology has been described many times, anyone can get acquainted with my personal ‚Äúrake‚Äù.</b> <div class="spoiler_text">  The board pattern was printed on a Samsung SCX-3200 laser multifunction printer.  I had to do it at a party and in a hurry, so I probably didn‚Äôt find all the right settings: maximum toner quantity and maximum quality - I found the first setting, but I didn‚Äôt get to the second one or the print quality of the device was insufficient for LUT.  As a result, the pattern turned out to be only ‚Äútolerable‚Äù - at the edges of the image of the tracks there was a ‚Äúfringe‚Äù, which was later also transferred to the resulting board. <br><br>  Since this is the ‚Äúfirst experience,‚Äù I decided to use this template and make a ‚Äútest‚Äù fee. <br><blockquote>  Much later, he printed his templates on the HP1320n with the ‚Äúcorrect‚Äù settings - the quality was incomparably higher and no unwanted artifacts were seen on the printout. </blockquote><br>  To transfer the toner to the foil-clad glass fiber laminate, I used the substrate from children's stickers (it turns out, now they sell whole ‚Äústicker books‚Äù instead of old-fashioned ‚Äúcoloring books‚Äù).  The material itself is a great fit, but due to the fact that the stickers are ‚Äúcut down‚Äù on the press, the base has suffered (in the photo below you can see the characteristic ‚Äúcuts‚Äù in the places of the former stickers): <br><img src="https://habrastorage.org/storage3/5d7/ce2/95c/5d7ce295c45053aadaefb68e201ca39c.jpg"><br><br>  After a thorough ‚Äúironing‚Äù and subsequent ‚Äúsoaking‚Äù, the toner almost completely switched to the future board (the paper just peeled off the board, and the toner remained on the copper).  But in the places of the ‚Äúcuts‚Äù copper oxidized (elevated temperature and access of air) - this is clearly seen in the photo: <br><img src="https://habrastorage.org/storage3/04f/255/e00/04f255e00a9039ef5bfa44c818f5139c.jpg"><br><br>  The board before etching was carefully examined under the lamp - the tracks did not have to be tinted. <br>  Travil in a solution of ferric chloride, constantly controlling the process (recalling his children's crafts, when the board drew a cap-varnish). <br><br>  The result turned out to be quite viable (on the tracks, in some places, the not completely washed out toner is visible): <br><img src="https://habrastorage.org/storage3/c00/a34/35c/c00a3435c443c07b129f6b257c663bc1.jpg"><br><br>  After a careful inspection of the boards on the light, it turned out another jamb pattern - insufficient toner density, which was particularly well noticeable on thick tracks.  This defect looked like a mesh of very, very small etched holes, arranged in a strict geometric order. <br><br>  The tracks were soldered with a soldering iron (325 degrees), I used ordinary glycerin as a flux - the resulting board completely satisfied me - no ‚Äústicky‚Äù and ‚Äúcracks‚Äù (the ‚Äúmesh‚Äù also dragged on). <br><br>  The board was spread out in such a way that there was not a single ‚Äúfree‚Äù vias (i.e., all the transitions only through the lead elements).  But a little miscalculated: several transitions were under the ISP connector and the connector under the radio module.  When installing, I thought about how to get around this, and found a fairly simple solution: dissolve the stranded wire into thin strands and carefully solder the pieces of this strand on both sides in the holes where a transition was needed, while minimally occupying the space inside the hole.  This made it possible to realize the transition and the holes were left free enough so that the corresponding connectors would normally fall into place and be unsoldered. <br><br>  Oddly enough, even the use of not the best template, gave quite a suitable result. <br></div></div><br><br>  Thus, we got all the components of the future module: <br><img src="https://habrastorage.org/storage3/e3a/3e0/614/e3a3e06144367e8f063ced35142fb4f3.jpg"><br><br>  The first "fitting" to the new building: <br><img src="https://habrastorage.org/storage3/04c/6e0/1ba/04c6e01ba6fbee39919475723042d72f.jpg"><br><br>  Later, between the boards, a rigid gasket was added, cut from an old plastic card to eliminate possible contact. <br>  Additionally, a hole for the USB connector was arranged in the case, so that you could also charge something from this unit (there is a table next to the floor lamp on which the phones / tablets regularly ‚Äúspend the night‚Äù). <br><br>  Actually, the resulting device next to the prototype: <br><img src="https://habrastorage.org/storage3/c9e/6d4/c59/c9e6d4c5940ae4f522c49f51d810affa.jpg"><br><br>  This time I took a more compact plug and socket (an extension cord from IKEA went to the ‚Äúexpense‚Äù).  Unfortunately, they are only white; the black version would suit me more: <br><img src="https://habrastorage.org/storage3/de9/f39/6d6/de9f396d6e83b27fb6be7adca8746f50.jpg"><br><br>  Everything is clear with the floor lamp, but when I began to ‚Äútry on‚Äù this module to the router and modem, I realized that I did not think of some things and the following functions were added to the sketch: <br><ul><li>  save to EEPROM current state (on / off) </li><li>  restore the current state after a reset (for example, when power is turned off). </li><li>  temporary operation (permanent switching or temporary).  For example, for a router and a modem, you do not need to give two commands - ‚Äúturn off‚Äù and then ‚Äúturn on‚Äù, and give one command ‚Äúturn off for XX seconds‚Äù </li><li>  the ability to remotely change all the parameters of a block through a radio channel and save these parameters in the EEPROM (not to make unique firmware for a specific device, but to be able to configure a specific block for a specific task) </li><li>  the ability to remotely read all the current parameters of the block (both state and "settings") </li><li>  ‚ÄúGuard dog‚Äù (it would be foolish to leave the router or modem without power due to the module ‚Äúhanging up‚Äù and denying access to home systems from the outside). </li></ul><br><br>  At the moment, both modules (the prototype and the first in the ‚Äúseries‚Äù) are successfully working and solving their problems.  A pair of boards and cases waiting in the wings ... <br><br>  In my head, thoughts of circuit breakers wander into standard plug-in boxes (and the idea to disassemble one of the <a href="http://devicter.blogspot.ru/2013/04/smart-touch.html">Chinese radio-controlled switches</a> , in order to produce a small reverse engineering, so as not to step on any other rake or even ‚Äúgut‚Äù it almost entirely and replace the insides with its own). <br><br>  Having a sufficient set of such "switches", you can safely implement any automatic scenarios based on data from any wired or wireless "sensors", but about this some time next ... </div><p>Source: <a href="https://habr.com/ru/post/195884/">https://habr.com/ru/post/195884/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../195874/index.html">Petrovich declines Russian names</a></li>
<li><a href="../195876/index.html">A tale of how the Dell PowerEdge server Hurricane Sandy survived</a></li>
<li><a href="../195878/index.html">New Brief: Samsung announces new pixel CMOS technology - ISOCELL</a></li>
<li><a href="../195880/index.html">Google has released an HTML5 editor for web design.</a></li>
<li><a href="../195882/index.html">The development of taxonomy of creative expression through the conceptual apparatus of mathematical game theory</a></li>
<li><a href="../195888/index.html">Again, pensions and surprises again</a></li>
<li><a href="../195890/index.html">The beta version of the new Yandex.Maps has opened: how and why we made them</a></li>
<li><a href="../195894/index.html">iPhone of all time: performance comparison</a></li>
<li><a href="../195896/index.html">3D printer helps blind children search for objects on the Internet.</a></li>
<li><a href="../195898/index.html">PostgreSQL 9.3 What's New?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>