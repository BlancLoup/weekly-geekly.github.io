<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Entertaining geodesy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 
 Today I will tell you,% USERNAME%, about shoes and sealing wax, cabbage, kings, coordinates, projections, geodesic systems, and just a little...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Entertaining geodesy</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br>  Today I will tell you,% USERNAME%, about <s>shoes and sealing wax, cabbage, kings,</s> coordinates, projections, geodesic systems, and just a little bit about web cartography.  Get comfortable. <br><br>  As Arthur Clark said, any sufficiently advanced technology is indistinguishable from magic.  So in web-cartography - I think everyone has long been used to using geographical maps, but not everyone imagines how this all works. <br><br>  Here, it would seem, a simple thing - geographical coordinates.  Latitude and longitude, what could be easier.  But imagine that you find yourself on a desert island.  The smartphone drowned, and you have no other means of communication.  It remains only to write a letter asking for help and throw it into the sea in a sealed bottle in the old-fashioned way. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      That's just bad luck - you absolutely do not know where your uninhabited island is, and without specifying the coordinates, no one will find you, even if they catch your letter.  What to do?  How to determine the coordinates without GPS? <br><br><a name="habracut"></a><br><br>  So, a little theory to begin with.  In order to compare coordinates to points on the surface of a sphere, it is necessary to specify a reference point ‚Äî the fundamental plane for counting latitudes and the zero meridian for counting longitudes.  For the Earth, the equatorial plane and the Greenwich meridian are usually used, respectively. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9fc/dd3/992/9fcdd39924e810b5a8c9d183457aec69.png"><br><br>  Width (usually denoted by œÜ) is the angle between the direction to a point from the center of the sphere and the fundamental plane.  Longitude (usually denoted by Œ∏ or Œª) is the angle between the plane of the meridian passing through a point and the plane of the zero meridian. <br><br>  How to determine its latitude, i.e.  the angle between the plane of the earth's equator and the point at which you are? <br><br>  Let's look at the same drawing from a different angle, projecting it onto the plane of our meridian.  Also add to the drawing the plane of the horizon (the tangent plane to our point): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e08/3e8/6c0/e083e86c05e1edd985f13e39e159736c.png"><br><br>  We see that the desired angle between the direction to a point and the equatorial plane is equal to the angle between the horizon plane and the axis of rotation of the Earth. <br><br>  So, how do we find this angle?  Recall the beautiful pictures of the starry sky with a long exposure: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/452/d6e/db5/452d6edb5f3ffda187926aabc40dde01.jpg"><br><br>  This point in the center of all circles described by stars is the pole of the world.  Measuring its height above the horizon, we obtain the latitude of the observation point. <br><br>  The question remains how to find the pole of the world in the starry sky.  If you're in the Northern Hemisphere, then everything is pretty simple: <br><br>  - Locate the dipper bucket; <br>  - mentally draw a straight through two extreme stars of the dipper - Dubhe and Merak; <br>  - This line will point you to the handle of the bucket Ursa Minor.  The extreme star of this pen, the Polar, almost coincides with the North Pole of the world. <br><br>  The polar star is always in the north, and its height above the horizon is equal to the latitude of the observation point.  If you get to the North Pole, the North Star will be right over your head. <br><br>  Things are not so simple in the southern hemisphere.  There are no major stars near the south pole of the world, and you will have to find the Southern Cross constellation, mentally extend its larger crossbar and count 4.5 of its length - somewhere in this area there will be the South Pole of the world. <br><br>  The constellation itself is easy to find - you have seen it many times on the flags of different countries - Australia, New Zealand and Brazil, for example. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cbf/9de/077/cbf9de07787899e59649a74f76de91fe.png"><br><br>  Determined with latitude.  Go to the longitude.  How to determine the longitude on a desert island? <br><br>  In fact, this is a very difficult problem, because, in contrast to latitude, the starting point of longitude (zero meridian) is chosen arbitrarily and is not tied to any observed landmarks.  The Spanish king Philip II in 1567 appointed a solid reward to those who propose a method for determining longitude;  in 1598, under Philip III, it grew to 6,000 ducats at a time and 2,000 rent ducats for life ‚Äî a very decent amount for those times.  The task of determining longitude for several decades was the idea of ‚Äã‚Äãfixing mathematicians, like Fermat's theorem in the 20th century. <br><br>  As a result, they began to determine the longitude with the help of this device: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a1e/63e/7d7/a1e63e7d73f87d5bf03a700543ca8dcb.jpg"><br><br>  In fact, this device remains the most reliable way to determine longitude (not counting GPS / Glonass) even today.  This device ... (drum roll) ... marine chronometer. <br><br>  In fact, when longitude changes, the time zone changes.  The difference in local time and Greenwich is easy to determine its own longitude, and very accurately.  Each minute of time difference corresponds to 15 angular minutes of longitude. <br><br>  Accordingly, if you have a clock set in Greenwich time (in fact, no matter for what - it is enough to know the time zone of the place in which your watch runs) - do not rush to transfer them.  Wait for the local half day, and the time difference will tell you the length of your island.  (It is very easy to determine the noon time - watch the shadows. In the first half of the day the shadows are shortened, in the second - they lengthen. The moment when the shadows began to lengthen - an astronomical afternoon in the area.) <br><br>  Both methods of determining the coordinates, by the way, are well described in Jules Verne‚Äôs novel The Mysterious Island. <br><br><h1>  Geoid coordinates </h1><br><br>  So, we were able to determine our latitude and longitude with an error of several degrees, i.e.  a couple of hundred kilometers.  For a note in a bottle, this accuracy may be enough, but for geographic maps there is no longer. <br><br>  In part, this error is due to the imperfection of the tools used, but there are other sources of error.  Earth can be considered a ball only as a first approximation - in general, the Earth is not a ball at all, but a geoid is a body most similar to a strongly uneven ellipsoid of rotation.  In order to accurately assign coordinates to each point on the earth's surface, we need rules ‚Äî how to project a specific point on the geoid onto a sphere. <br><br>  Such a set of rules should be universal for all geographical maps in the world - otherwise the same coordinates in different systems will denote different points of the earth's surface.  Currently, almost all geographic services use a unified system of assignment to a point of coordinates - WGS 84 (WGS = World Geodetic System, 84 is the year of adoption of the standard). <br><br>  WGS 84 defines a so-called.  reference ellipsoid - surface, to which coordinates are brought for convenience of calculations.  The parameters of this ellipsoid are as follows: <br><br>  - semi-major axis (equatorial radius): a = 6378137 meters; <br>  - compression: f = 1 / 298.257223563. <br><br>  From the equatorial radius and compression, the polar radius can be obtained, it is also a small semi-axis (b = a * (1 - f) ‚âà 6356752 meters). <br><br>  Any point on the earth's surface, therefore, is assigned three coordinates: longitude and latitude (on the reference ellipsoid) and height above its surface.  In 2004, the WGS 84 was complemented by the Earth Gravitational Model (EGM96) standard, which specifies the sea level from which heights are calculated. <br><br>  Interestingly, the zero meridian in WGS 84 is not at all Greenwich (passing through the axis of the transit instrument of the Greenwich Observatory), but the so-called.  IERS Reference Meridian, which runs at 5.31 angular seconds east of Greenwich. <br><br><h1>  Flat cards </h1><br><br>  Suppose we learned to determine their coordinates.  Now you need to learn how to display the accumulated geographical knowledge of the monitor screen.  Why, bad luck - there are somehow not very many spherical monitors in the world (not to mention geoid monitors).  We need to somehow map the map onto a plane ‚Äî project it. <br><br>  One of the easiest ways is to project a sphere onto a cylinder, and then turn this cylinder onto a plane.  Such projections are called cylindrical; their characteristic property is that all meridians are displayed on the map by vertical lines. <br><br>  Projections of the sphere on the cylinder can come up with a lot.  The most famous of the cylindrical projections is the Mercator projection (by the name of the Flemish cartographer and geographer Gerard Kremer who used it widely in her maps, better known by the Latinized name Mercator). <br><br>  Mathematically, it is expressed as follows (for a sphere): <br><br>  x = R ¬∑ Œª; <br>  y = R ¬∑ ln (tg (œÄ / 4 + œÜ / 2), where R is the radius of the sphere, Œª is the longitude in radians, œÜ is the latitude in radians. <br><br>  At the output we get the usual Cartesian coordinates in meters. <br><br>  A map in the Mercator projection looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/709/d9d/b1f/709d9db1f93a52fba2be8835e91939f0.png"><br><br>  It is easy to see that the Mercator projection distorts the shapes and areas of objects very significantly.  For example, Greenland on the map is twice as large as Australia - although in reality Australia is 3.5 times as large as Greenland. <br><br>  Why is this projection so good that it has become so popular despite significant distortions?  The fact is that the Mercator projection has an important characteristic property: it retains angles when projecting. <br><br>  Suppose we want to sail from the Canary Islands to the Bahamas.  Let's draw a straight line on the map connecting the points of departure and arrival. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d65/ca4/874/d65ca4874686e7f3b154212c7e3e4694.png"><br><br>  Since all the meridians in cylindrical projections are parallel, and the Mercator projection also preserves the angles, our line will cross all the meridians at the same angle.  And this means that it will be very simple to swim along this line: it is enough to keep the same angle between the ship‚Äôs course and the direction of the polar star (or the direction of magnetic north, which is less accurate) throughout the journey, and you can easily measure banal protractor. <br><br>  Similar lines crossing all the meridians and parallels at the same angle are called loxodromes.  All loxodromes in the Mercator projection are depicted as straight lines on the map, and it is this remarkable property, extremely convenient for marine navigation, that brought the Mercator projection to widespread popularity among sailors. <br><br>  It should be noted that what has been said is not quite true: if we project the sphere and move along the geoid, then the track angle will be determined not quite correctly and we will not quite sail there.  (The discrepancy can be quite noticeable - after all, the equatorial and polar radii of the Earth differ by more than 20 kilometers.) The ellipsoid can also be projected with the angles preserved, although the formulas for the elliptical Mercator projection are much more complicated than for the spherical (the inverse transformation is not expressed at all in elementary functions).  A complete and detailed description of the mathematics of the Mercator projection on the ellipsoid can be found <a href="http://mercator.myzen.co.uk/mercator.pdf">here</a> . <br><br>  <em>When we in Yandex started making our cards, it seemed logical to us to use an elliptical Mercator projection.</em>  <em>Unfortunately, many other web-mapping services didn‚Äôt seem that way, and they use a spherical projection.</em>  <em>Therefore, for a long time, it was impossible to show tiles on top of the Yandex map, say, OSM - they diverged along the y axis, the closer to the pole - the more noticeable.</em>  <em>In the version of API 2.0, we decided not to swim against the stream, and provided the opportunity to work with the map in any projection, and to show on the map several layers simultaneously in different projections - as convenient.</em> <br><br><h1>  Geodetic tasks </h1><br><br>  Traveling around the loxodrome is very simple, but you have to pay for this simplicity: the loxodrome will send you on a trip along a non-optimal route.  In particular, the path along the parallel (if it is not the equator) is not the shortest! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cbb/07c/7bb/cbb07c7bb06ef84194c7718e3eb2e110.png"><br><br>  In order to find the shortest path on a sphere, one must draw a circle with the center in the center of the sphere, passing through these two points (or, equivalently, to cross the sphere with the plane passing through two points and the center of the sphere). <br><br>  It is impossible to project a sphere onto a plane so that the shortest paths thus go into straight line segments;  The Mercator projection, of course, is no exception, and the orthodroms in it look like highly distorted arcs.  Some paths (through the pole) in the Mercator projection cannot be correctly depicted: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e00/a7e/ee6/e00a7eee6420be480950c878c78163d1.png"><br><br>  Approximately, the shortest path from Anadyr to Cardiff is projected: first, we fly away to infinity strictly to the north, and then return from infinity to the south. <br><br>  In the case of movement along a sphere, the shortest paths are constructed quite simply with the aid of a spherical trigonometry apparatus, but in the case of an ellipsoid, the task is significantly complicated - the shortest paths are not expressed in elementary functions. <br><br>  (I note that this problem, of course, is not solved by choosing a spherical Mercator projection - the construction of the shortest paths is carried out on the WGS 84 reference ellipsoid and does not depend on the projection parameters.) <br><br>  During the development of the Yandex.Map API version 2.0, we faced a difficult task - to parameterize the construction of the shortest paths so that: <br>  - it was easy to use the built-in functions for calculating the shortest paths on the WGS 84 ellipsoid; <br>  - it was easy to set your own coordinate system with your own methods for calculating the shortest paths. <br><br>  The Maps API can be used not only to display maps of the earth‚Äôs surface, but also, say, the surface of the moon or some game world. <br><br>  In order to build the shortest paths (geodesic lines) in the general case, the following simple and simple equation is used: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d9/839/f2d/4d9839f2dbf04b1b10990eaebdcbf164.png"><br><br>  Here <img src="https://habrastorage.org/getpro/habr/post_images/66a/1c8/044/66a1c8044e1c6f756f3a4ada40153df8.png">  - so-called  Christoffel symbols expressed in partial derivatives of the fundamental metric tensor. <br><br>  It seemed to us to be somewhat inhuman to force the user in such a way to parameterize his mapping area :). <br><br>  Therefore, we decided to go another way, more close to the Earth and the needs of our users.  In geodesy, the problems of constructing shortest paths are so-called.  the first (direct) and second (inverse) geodetic tasks. <br><br>  <strong>Direct geodesic task:</strong> the starting point is given, the direction of movement (usually the track angle, that is, the angle between the north direction and the direction of movement) and the distance traveled.  It is required to find the end point and the final direction of motion. <br><br>  <strong>Inverse geodetic problem:</strong> two points are given.  It is required to find the distance between them and the direction of motion. <br><br>  Note that the direction of travel (track angle) is a continuous function that changes throughout the journey. <br><br>  Having at our disposal the functions of solving these problems, we can solve the cases we need in the Maps API: calculating distances, displaying the shortest paths and constructing circles on the earth's surface. <br><br>  We have declared the following <a href="">interface</a> for user coordinate systems: <br><br>  solveDirectProblem (startPoint, direction, distance) - Solves the so-called first (direct) geodesic task: where we find ourselves, if we leave the specified point in the specified direction and pass, without turning, the specified distance. <br><br>  solveInverseProblem (startPoint, endPoint, reverseDirection) - Solves the so-called second (reverse) geodesic task: build the shortest route between two points on the mapped surface and determine the distance and direction of motion. <br><br>  getDistance (point1, point2) - returns the shortest (along the geodesic line) distance between two given points (in meters). <br><br>  <em>(The function getDistance is allocated separately for those cases where the calculation of distances can be performed much faster than the solution of the inverse problem.)</em> <br><br>  This interface seemed simple enough for us to implement in cases where the user mapped some nonstandard surface or uses nonstandard coordinates.  For our part, we wrote two standard implementations ‚Äî for the conventional Cartesian plane and for the reference ellipsoid WGS 84. For the second implementation, we used <a href="http://en.wikipedia.org/wiki/Vincenty%2527s_formulae">the Vincenti formulas</a> .  By the way, I directly implemented this logic of <a href="http://habrahabr.ru/users/runawayed/" class="user_link">runawayed</a> , we say hello to it :). <br><br>  All these geodesic features are available in the Yandex.Maps API, starting with version 2.0.13.  Welcome! </div><p>Source: <a href="https://habr.com/ru/post/143898/">https://habr.com/ru/post/143898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143892/index.html">Gamification diet</a></li>
<li><a href="../143893/index.html">Using a synthesizer as a computer keyboard</a></li>
<li><a href="../143894/index.html">What applications are you testing?</a></li>
<li><a href="../143895/index.html">The average identifier length in popular JavaScript libraries is 8.27 characters.</a></li>
<li><a href="../143896/index.html">We are waiting for everyone on the bright side of power!</a></li>
<li><a href="../143899/index.html">VLC Anniversary - One Billion Downloads</a></li>
<li><a href="../143900/index.html">Skevomorphism and narration</a></li>
<li><a href="../143904/index.html">Rusonix starts selling Jelastic platform</a></li>
<li><a href="../143907/index.html">Monitoring changes in working directories</a></li>
<li><a href="../143908/index.html">Nokia believes Apple is manipulating the results of Siri‚Äôs work</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>