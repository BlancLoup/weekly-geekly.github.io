<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>1Kb autocomplete</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All good time of day! In pursuit of my previous post , I want to show a simple example of a micro component of autocomplete on SvelteJS . Who has not ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>1Kb autocomplete</h1><div class="post__text post__text-html js-mediator-article">  All good time of day!  In pursuit of my <a href="https://habrahabr.ru/post/345028/">previous post</a> , I want to show a simple example of a micro component of autocomplete on <a href="https://svelte.technology/">SvelteJS</a> .  Who has not had time to get acquainted with this little framework - wellcome under the cat! <br><img src="https://habrastorage.org/webt/5o/3n/tx/5o3ntxwkyfdgwsnq5mfutaxdrs0.png" alt="image"><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Disclaimer (Attention &lt;sarcasm /&gt; detected!)</b> <div class="spoiler_text"><blockquote>  Immediately declare that none of the existing, as well as the frameworks of the future, and not close stands next to $ mol.  I am by no means arguing that any other framework is cooler than $ mol, because it is simply impossible to compete with $ mol in coolness.  This is the coolest framework ever created by mankind.  I‚Äôm sure $ mol will save the world! </blockquote></div></div><br>  Well, now you can talk about Svelte) Since this is a Friday post, I will try not to delay it too much. <br><br>  So, the task is to make a reusable micro component of autocompletion with support for asynchronous loading of the list of options.  In other words, we start entering the desired value - a list of options drops out, which can be set both statically (a certain array), and dynamically loaded from the server. <br><br>  Actually the svelte component itself may look like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="html hljs xml"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- Autocomplete.html --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">list</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"suggestions"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bind:value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Start typing..."</span></span></span><span class="hljs-tag"> /&gt;</span></span> {{#await suggestions}} {{then options}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">datalist</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"suggestions"</span></span></span><span class="hljs-tag">&gt;</span></span> {{#each options as option}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span>{{ option }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> {{/each}} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">datalist</span></span></span><span class="hljs-tag">&gt;</span></span> {{/await}} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">export</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">default</span></span></span><span class="javascript"> { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">data</span></span></span><span class="javascript">: </span><span class="hljs-function"><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span><span class="javascript"><span class="hljs-function"> =&gt;</span></span></span><span class="javascript"> ({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">search</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">''</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">suggestions</span></span></span><span class="javascript">: [] }) }; </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Remark</b> <div class="spoiler_text">  The attentive reader will immediately notice the kind of ‚Äúlife-hack‚Äù that is present here.  Namely, the use of the html5 &lt;datalist /&gt; tag, which was actually created for such things, but still has poor <a href="https://caniuse.com/">browser support</a> . <br><br>  I want to note that I use it here purely for demonstration purposes in order to visually simplify the code for better understanding, and also because the specific implementation of the drop-down list is not the purpose of the article.  Changing the list from &lt;datalist /&gt; to &lt;ul /&gt; with a couple of styles is not a difficult task. <br></div></div><br>  As a result, we have a simple template with an input field and a list of options attached to it.  The input field is bandaged to the ‚Äúsearch‚Äù variable in the component data, and the list of options is dynamically set using the ‚Äúsuggestions‚Äù array. <br><br>  Notice the {{#await /}} in the template.  It is this simple construction that allows us not to worry whether the ‚Äúsuggestions‚Äù variable is a real array or whether it is a promise that will be resolved into an array. <br><br>  Here, perhaps everything, now let's move on to using: <br><br><pre> <code class="html hljs xml"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- App.html --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Selected location: {{ location }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Autocomplete</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bind:search</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bind:suggestions</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"locations"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">import</span></span></span><span class="javascript"> Autocomplete </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">from</span></span></span><span class="javascript"> </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'./Autocomplete.html'</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">import</span></span></span><span class="javascript"> { fetchLocations } </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">from</span></span></span><span class="javascript"> </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'./api.js'</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">export</span></span></span><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">default</span></span></span><span class="javascript"> { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">data</span></span></span><span class="javascript">: </span><span class="hljs-function"><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span><span class="javascript"><span class="hljs-function"> =&gt;</span></span></span><span class="javascript"> ({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">location</span></span></span><span class="javascript">: </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">''</span></span></span><span class="javascript"> }), </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">computed</span></span></span><span class="javascript">: { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">locations</span></span></span><span class="javascript">: </span><span class="hljs-function"><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">location</span></span></span></span><span class="javascript"><span class="hljs-function"> =&gt;</span></span></span><span class="javascript"> { </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">return</span></span></span><span class="javascript"> location.length &gt;= </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">3</span></span></span><span class="javascript"> ? fetchLocations(location) : [] } }, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">components</span></span></span><span class="javascript">: { Autocomplete } }; </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  This is a parent component that implements the domain-logic of a particular case.  In this case, it is the choice of location (city). <br><br>  First, the auto-completion component is connected, as well as a module that implements interaction with the server API.  We also have a variable "location", where we actually save the selected value.  It binds to ‚Äúsearch‚Äù from the autocomplete component via props, and is also outputted by some resulting value a little higher. <br><br>  Next, an interesting point.  Since Svelte supports the output of asynchronous values ‚Äã‚Äãvia {{#await /}}, as well as computed props, which may depend on other data, we can write a super simple calculated property to get a list of options from the server and link it to change "Location".  Those.  when the user enters a value in the field, the reactive variable ‚Äúlocation‚Äù changes, resulting in a recalculation of the calculated ‚Äúlocations‚Äù property.  This property is also bound to "suggestions" from the autocomplete component via props.  And everything works like ‚Äúmagic‚Äù)))) <br><br>  I also note that in order for the example to work well, an implementation of the debounce method is necessary in order not to overwhelm the server with unnecessary requests.  In this case, it is assumed that debounce is already implemented inside the fetchLocations () function, because it has no direct relation to the example. <br><br>  This is how super easy it is to implement a reused micro-component of auto-completion on Svelte. <br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/011/d1f/a1c/011d1fa1cb405ddc40feccdb5408d06c.png"><br><br>  Further, since to the previous article about Svelte many questions were asked concerning the principle of Svelte, AoT compilation of svelte components and the likely duplication of code.  I present a free translation of <a href="https://github.com/ractivejs/ractive/issues/2949">this</a> comment by the creator of Svelte Rich Harris (Rich Harris): <br><br><blockquote>  This is a good question.  I would answer it in several ways: <br><br><ol><li>  Part of the code is reused between components (for example, such methods as detachNode, etc.) if we compile the code using the shared: true flag (which happens automatically when using integration with build-tools, such as svelte-loader or rollup-plugin-svelte ).  In that case, all these things are not duplicated, reducing overhead. </li><li>  The code is generated so that it is more or less readable, but at the same time is not quite large in size. </li><li>  However, in theory there is a transition point where the size of the generated code exceeds the size of the framework + templates.  However, by the time your application grows to that size, you will most likely need to use code-splitting techniques.  For example, load components asynchronously, based on the current URL.  Code separation methods work much better with Svelte than with traditional frameworks, because traditionally, even the smallest piece of code depends on the entire library. </li><li>  The size of the code is only one of their Svelte goals.  Other goals are high performance, providing good experience for developers (since the compiler is based on static code analysis, we can have useful error messages and other kinds of warnings, like in Elm).  Also a big plus of this approach is the absence of the need to say ‚Äúno‚Äù to good ideas of new features for the framework, because the emergence of new features does not affect people who do not use them.  Traditional frameworks are always forced to find a balance between the size of the framework and the needs of its users.  And so on. </li><li>  In any case, we can and will reduce the size of the generated code, for example, using smarter processing of spaces or using innerHTML in cases where there is a large piece of static markup that does not make sense to generate programmatically.  As a result, the size of the generated code will only decrease with the development of the compiler. </li></ol><br>  Of course there are tradeoffs, for example, with respect to Ractive - this is flexibility.  We cannot do this.observe ('some.nested.property', () =&gt; {}) or use adapters for complex variables, or have {{#with ...}} blocks in templates and other things.  All this makes sense in Ractive, which uses the ‚Äúdo what I mean‚Äù philosophy.  While Svelte is based on static analysis and more on the fact that ‚Äúdo what I say‚Äù, in the end it is a more rigorous version. <br></blockquote><br>  From myself I want to add that I have not tried Svelte on a more or less large project (although I am planning).  I also do not oppose such giants as Angular or even Vue.  Ractive is playing on that pitch rather than Svelte. <br><br>  However, I think that it perfectly occupies a niche of small (widgets, etc.) and medium projects (mobile and TV applications, etc.).  In such projects, Svelte certainly provides a smaller bundle size and greater speed.  If this is important for you, you should get to know him better. <br><br>  Great weekend to everyone!  And may the Power of Friday arrive with you! <br><br>  <b>UPDATE:</b> <br>  For those who are concerned about duplicating code in Svelte.  There is new information directly from Rich Harris.  My comment on this topic can be found <a href="https://habrahabr.ru/post/345028/">here</a> . <br><br><h4>  UPDATE 2: </h4><br>  Who is interested in Svelte and would like to follow its development - <i>welcome</i> to the Russian-language telegram channel <a href="https://t.me/sveltejs">SvelteJS</a> .  We will be glad to you! </div><p>Source: <a href="https://habr.com/ru/post/345208/">https://habr.com/ru/post/345208/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345198/index.html">Dynamic identification of control objects</a></li>
<li><a href="../345200/index.html">How to deal with miners cryptocurrency in the corporate network</a></li>
<li><a href="../345202/index.html">Typescript. Read Only Properties</a></li>
<li><a href="../345204/index.html">How to learn to think in images using visual analogies</a></li>
<li><a href="../345206/index.html">We tried to hire these two for five years. And every minute of our waiting paid off.</a></li>
<li><a href="../345210/index.html">Anonymous Father Frost 2017-2018: post boasting New Year's gifts</a></li>
<li><a href="../345212/index.html">Can you afford it? Real-world web performance budget</a></li>
<li><a href="../345214/index.html">How to quit graduate school and become a developer</a></li>
<li><a href="../345216/index.html">Expanding Ansible with plugins: part 2</a></li>
<li><a href="../345218/index.html">Not soon the fence is built, especially a beautiful data center. How we build the data center "Avantage". Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>