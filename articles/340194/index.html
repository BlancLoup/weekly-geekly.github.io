<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A tricky javascript question asked at Google and Amazon interviews</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habr! There is one question, in appearance - not so difficult, which is often asked to developers at interviews. 

 Today we will analyze it and ta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A tricky javascript question asked at Google and Amazon interviews</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/ruvds/blog/340194/"><img src="https://habrastorage.org/getpro/habr/post_images/80d/819/140/80d8191400d881d3f78a48f03084840b.jpg" align="left" width="250"></a>  Hi Habr!  There is one question, in appearance - not so difficult, which is often asked to developers at interviews. <br><br>  Today we will analyze it and talk about the approaches to finding an answer.  Asking the question in question, the interviewer suggests telling you about what the following code will produce: <br><br><pre><code class="hljs matlab">const arr = [<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (var <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> &lt; arr.<span class="hljs-built_in"><span class="hljs-built_in">length</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>++) {  setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> {    </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">console</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">log</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('Index: ' + i + ', element: ' + arr[i])</span></span></span><span class="hljs-function">;  }, 3000); }</span></span></code> </pre> <br>  Do you know what will appear in the console? <br><a name="habracut"></a><br>  Just want to say that this question is aimed at understanding such JS mechanisms as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">closures</a> , <a href="https://toddmotto.com/everything-you-wanted-to-know-about-javascript-scope/">scopes,</a> and the <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout">setTimeout</a> function.  The correct answer is: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, element: undefined <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, element: undefined <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, element: undefined <span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, element: undefined</code> </pre> <br>  If you were expecting something else, we hope, in this material we will be able to tell about why the output of this code fragment turned out to be exactly like this, and how to bring it into a more decent look. <br><br><h2>  <font color="#3AC1EF">Why is this question so popular?</font> </h2><br>  One Reddit user <a href="https://www.reddit.com/r/javascript/comments/7535tm/amazon_web_developer_loop_timeout_interview/">talked</a> about being asked such a question during an interview at Amazon.  I myself faced similar questions aimed at understanding the cycles and closures in JS, even at an interview at Google. <br><br>  This question allows you to check the ownership of some important JavaScript concepts.  Considering the peculiarities of the JS operation, the situation that is modeled in the presented code fragment can often arise in the course of the actual work.  In particular, this concerns the use of <code>setTimeout</code> or some other asynchronous function in a loop. <br><br>  A good understanding of the functional and block scopes in JavaScript, the features of the device anonymous functions, closures and <a href="https://stackoverflow.com/questions/8228281/what-is-the-function-construct-in-javascript">IIFE</a> , will help your professional growth and allow you to show yourself from the good side during interviews. <br><br><h2>  <font color="#3AC1EF">Approaches to answering a question and getting rid of undefined</font> </h2><br>  In fact, I already wrote about possible approaches to answering this question in some of my previous materials.  In particular, in <a href="https://coderbyte.com/algorithm/3-common-javascript-closure-questions">this</a> and <a href="https://medium.freecodecamp.org/3-questions-to-watch-out-for-in-a-javascript-interview-725012834ccb">this</a> .  Let me quote some of these publications: <br>  The reason for this is that the function <code>setTimeout</code> creates a function (closure), which has access to the external visibility area, represented in this case by a loop, in which the variable <code>i</code> declared and used.  After 3 seconds have passed, the function is executed and displays the value of <code>i</code> , which, after the end of the cycle operation, remains available and equals 4th.  The variable, during the cycle operation, successively takes the values ‚Äã‚Äã0, 1, 2, 3, 4, moreover, the last value is stored in it after it exits the cycle.  There are four elements in the array, with indices from 0 to 3, therefore, trying to refer to <code>arr[4]</code> , we get <code>undefined</code> .  How to get rid of <code>undefined</code> and make the code output what is expected of it, that is, the values ‚Äã‚Äãof the elements of the array? <br><br>  Here are a couple of common approaches to solving such a problem, and specifically to ensuring access to the desired value of the loop variable within the function called <code>setTimeout</code> . <br><br>  The first involves the transfer of the required parameter to the internal function, the second is based on using the capabilities of ES6. <br><br>  So, here is the first option: <br><br><pre> <code class="hljs lua">const arr = [<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (var i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; arr.length; i++) { //    i,   //          setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(i_local)</span></span></span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {     console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'The index of this number is: '</span></span> + i_local);   } }(i), <span class="hljs-number"><span class="hljs-number">3000</span></span>); }</code> </pre> <br>  Here is the second option: <br><br><pre> <code class="hljs lua">const arr = [<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (let i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; arr.length; i++) { //    let,    ES6, //         //   : http://exploringjs.com/es6/ch_variables.html#sec_let-const-loop-heads setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'The index of this number is: '</span></span> + i); }, <span class="hljs-number"><span class="hljs-number">3000</span></span>); }</code> </pre> <br>  On Reddit I managed to find a <a href="https://www.reddit.com/r/javascript/comments/7535tm/amazon_web_developer_loop_timeout_interview/do3db9n/">similar answer</a> to this question.  Here is a good <a href="https://stackoverflow.com/a/3572616">explanation of the</a> features of closures on StackOverflow. <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  It may be noted that the question with which we started this material often confuses people with little experience in JavaScript or in functional programming.  The reason is a misunderstanding of the essence of closures.  When forming a closure, it does not transfer the value of the variable or a reference to it.  The closure captures the variable itself. <br><br>  Dear readers!  Do you know any interesting questions that are asked during JavaScript interviews?  If yes, please share. </div><p>Source: <a href="https://habr.com/ru/post/340194/">https://habr.com/ru/post/340194/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340184/index.html">Introduction to Neural Network Architectures</a></li>
<li><a href="../340186/index.html">How to create a competitive advantage and value of a technological product</a></li>
<li><a href="../340188/index.html">Our cloud-based JS is now ES2017, and this reduces the code by several times.</a></li>
<li><a href="../340190/index.html">Russian-speaking chat bot Boltoon: create a virtual companion</a></li>
<li><a href="../340192/index.html">Key QA Process Indicators</a></li>
<li><a href="../340196/index.html">ScadaPy application modbus protocol</a></li>
<li><a href="../340198/index.html">Kali Linux: security test questions</a></li>
<li><a href="../340200/index.html">Steve Wozniak opened an online university Woz U</a></li>
<li><a href="../340202/index.html">Love static code analysis</a></li>
<li><a href="../340204/index.html">Cj - new programming language</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>