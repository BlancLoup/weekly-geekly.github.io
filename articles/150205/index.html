<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recoding video from Intel Quick Sync Video - do it quickly</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Four times faster than today's top NVidia and AMD solutions. What is it? Sandy Bridge's Secret Weapon: Quick Sync. That is the name of last year‚Äôs Tom...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recoding video from Intel Quick Sync Video - do it quickly</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/0ee/738/b7d/0ee738b7d8fa51fb1530ff6635f0b43a.jpg"><br><br>  Four times faster than today's top NVidia and AMD solutions.  What is it?  Sandy Bridge's Secret Weapon: Quick Sync.  That is the name of last year‚Äôs Tom‚Äôs hardware <a href="http://www.tomshardware.com/reviews/sandy-bridge-core-i7-2600k-core-i5-2500k,2833-4.html">article</a> .  "Why Quick Sync is Intel's secret weapon" - and this is already a techradar <a href="http://www.techradar.com/news/computing-components/processors/why-quicksync-is-intels-secret-weapon-1077916">publication</a> .  In fact, there is nothing secret about Intel Quick Sync Video technology (Intel QSV), but most unfortunately do not have complete clarity about what it is, where it is, and, most importantly, how to use it effectively.  Not only is a simple user, but even almost any employee of Intel finds it difficult to answer these questions, <s>especially if you wake him up at night.</s>  Let's try to fix it, and let's start with the basics. <br><br><a name="habracut"></a>  In the Russian spelling, the abbreviation Intel QSV looks like ‚ÄúICS‚Äù, which adds even more uncertainty - ‚ÄúX‚Äù, and also ‚Äúto‚Äù?  Therefore (and not only because of this) it is better to simply translate the name. <br>  Full translation - "Quick Video Sync."  What is a "video" - you probably know yourself.  "Synchronization" is the ability to convert video from the original "desktop", i.e.  high resolution of formats in formats supported by mobile devices and video hosting sites.  Although, this is not the only possible use of QSV. <br>  The adjective ‚Äúfast‚Äù here reflects the fact that in all independent transcoding tests video QSV significantly, at times, wins not only software coding on the CPU, but also the hi-end GPU! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Intel Quick Sync Video</b> is a marketing term for hardware decoding and encoding video content in H.264 / MPEG-4 AVC, VC-1 and MPEG-2 formats (currently only decoding), implemented in Intel's embedded GPUs from ultrabooks to servers starting from the second generation of Core microarchitecture (Sandy Bridge). <br><h6>  That is, you can transcode video from DVD or Blu-Ray. </h6><br>  In addition to general-purpose executive devices (Execution Units or simply EU), Intel's integrated GPUs have a special hardware module, the Multi-Format Codec Engine (MFX), which implements video decoding and encoding: <br><img src="https://habrastorage.org/storage2/6fe/e90/d7a/6fee90d7afc97de31bf2a7ff3666409d.jpg" alt="image"><br><br>  Such a fixed hardware solution not only speeds up video processing, but also unloads the CPU, and also reduces system power consumption. <br>  In this case, the decoding is carried out entirely in the above-mentioned hardware module, <br>  and coding occurs in two stages: one on the GPU actuators, the second - in hardware. <br><br>  On the above slide from the presentation at the Intel Developer Forum you can see where the coding stages are done.  Once again, everything happens on the GPU, i.e.  in hardware, and ‚ÄúHybrid HW / SW solution‚Äù means only the fact of using programmable EU GPU blocks. <br><img src="https://habrastorage.org/storage2/f3d/afd/f38/f3dafdf388a6c3eb2588ef2d2b1edc62.jpg"><br><br>  It should be noted that these two coding stages are well conveyed, i.e.  while MFX hardware processes one frame, <br>  The EU, who have completed their part of the work on this frame, are already processing the following to transfer it to the hardware, <br>  which naturally improves overall system performance. <br><br>  In Ivy Bridge processors, that is, in the second version of Quick Sync, Sandy Bridge hardware modules were improved - the speed and quality of coding was improved, support for ultra-high resolutions up to 4K Video was added.  The system is even capable of decoding multiple Quad HD video streams simultaneously. <br><h6>  To find another appropriate monitor .... </h6><br>  There were no tests for working with QuadHD-like resolution, but the usual tests showing the speed of Quick Sync are more than enough for statistics. <br>  For example, last year‚Äôs experience <a href="https://habrahabr.ru/users/vilianov/" class="user_link">vilianov</a> <a href="http://software.intel.com/ru-ru/blogs/2011/11/29/intel-quick-sync">Happy with Quick Sync</a> . <br>  But relatively recent information - Anandtech <a href="http://www.anandtech.com/show/5771/the-intel-ivy-bridge-core-i7-3770k-review/21">reviews the</a> Intel Ivy Bridge (Core i7 3770K with HD Graphics 4000, Quick Sync version 2) and compares the transcoding speed of the Blu-Ray source on the iPad: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cbb/92a/bae/cbb92abaeffad2d3007bb86f397bdfa2.png" alt="image"><br>  The measurement goes in frames per second, and the performance of the QSV Ivy Bridge is compared not only with external GPUs, but also with the Core i7 2000K (Sandy Bridge with the first generation QuickSync - Intel HD Graphics 3000 on board), as well as Handbrake - an open source software solution not using QuickSync. <br><br>  Also note that the advantage of QuickSync is especially noticeable when recoding to low resolutions: <br><img src="https://habrastorage.org/getpro/habr/post_images/825/05d/aac/82505daacdbda706ee886b6ff3525062.jpg" alt="image"><br><br>  At the same time, the anecdote ‚ÄúI <i>type at a speed of 1000 characters per minute, but such garbage turns out to be</i> ‚Äú inappropriate here - the coding quality, although slightly inferior to the purely soft one, but always wins, or, in the worst case, goes on par with any other GPU coding.  There are many pruflinks with a discussion of quality (here is a <a href="http://www.thg.ru/video/video_transcoding_amd_nvidia_intel/video_transcoding_amd_nvidia_intel-01.html">good example</a> in Russian), we note only that quality is almost always evaluated subjectively, ‚Äúby eye‚Äù, and, moreover, it essentially depends on the specific coding program. <br><br>  Access to hardware-based video processing QSV is through the Intel HD graphics driver, the interface to it is non-public, primarily because it is not constant ‚Äî it depends on the specific hardware and driver version.  Although a few individual software companies, if necessary, under a special agreement with Intel, get access to the coveted API. <br><br>  All other companies wishing to take advantage of Quick Sync Video can do this (and they do, of course) using the special SDK - <a href="http://software.intel.com/en-us/articles/intel-media-software-development-kit-intel-media-sdk/)">Intel Media SDK</a> , which provides a fixed interface for working with video.  At the same time, automatically, behind the scenes, MSDK uses all the features of Intel hardware acceleration for each given system: Quick Sync, if available, otherwise - software programs optimized for a specific CPU. <br><h6>  In general, a great thing.  Yes, and free ... </h6>  Therefore, in the list of companies using MSDK, you can find such famous companies as MainConcept, Nero, Corel, CyberLink ... <br><br>  But, not all applications are equally useful, i.e.  productive (you know, from the same bricks, you can build different houses).  Here is an interesting and useful performance comparison from the same <a href="https://habrahabr.ru/users/vilianov/" class="user_link">vilianov</a> - " <a href="http://software.intel.com/ru-ru/blogs/2012/04/16/intel-quick-sync-2">Faster is where</a> " <br><br>  So, if you want the video to be recoded just as quickly from yours, this requires: <br><br>  <b>1. Availability of an integrated GPU in the processor with Quick Sync support.</b> <br>  As already mentioned, the CPU must be no older than the second generation of the Core microarchitecture (Sandy Bridge). <br>  In addition, its integrated graphics should also be second generation - starting with <b>Intel HD Graphics 2000</b> .  This is important because the initial Sandy Bridge models sold under the Pentium brand have ‚Äúnon-dimensional‚Äù Intel HD Graphics, which does not support Quick Sync. <br>  To date, Quick Sync support for mobile and desktop computers is present in Intel HD Graphics 2000, 2500, 3000 and 4000, and for servers in the P3000 and P4000 models. <br><br>  <b>2. Support GPU chipset (motherboard)</b> . <br>  In order for the GPU to transfer data to the south bridge of the motherboard - that is, ultimately, to the display port (DisplayPort), the chipset must support the Flexible Display Interface (FDI) - the ‚Äúbridge‚Äù between the GPU and the display.  An up-to-date list of chipset and CPU models with FDI support is in the corresponding <a href="http://en.wikipedia.org/wiki/Flexible_Display_Interface">article on wikipedia</a> <br>  By the way, this requirement does not have a specific relationship to the support of Quick Sync Video, but is simply a necessary condition for the operation of Intel HD Graphics in the system. <br><br>  And of course, if the system uses an external graphic card that disables the integrated graphics of the CPU, it is generally impossible to use Quick Sync.  Solutions to this problem for some cases: <br><ul><li>  For laptops - use the ability to switch the graphics system from external to internal (switchable graphics) </li><li>  For desktop computers, connect a second monitor to the integrated graphics port, allowing it to be used in the BIOS and making it primary. </li><li>  Use <a href="http://www.lucidlogix.com/product-virtu-gpu.html">LucidLogix Virtu</a> graphics virtualization <a href="http://www.lucidlogix.com/product-virtu-gpu.html">solution</a> </li></ul><br><br>  <b>3. Video driver support.</b> <br>  Today, QSV is supported by Windows 7, Windows 8 and Mac OS Mountain Lion drivers. <br>  It is also possible to install the appropriate Windows 7 drivers on Windows Server 2008 (with the Desktop Experience component installed). <br>  The latest drivers for Intel HD Graphics (by the way, not only for the systems mentioned above) can be found <a href="http://downloadcenter.intel.com/SearchResult.aspx%3Flang%3Deng%26ProductFamily%3DGraphics%26ProductLine%3DProcessor%2Bgraphics%26ProductProduct%3D2nd%2BGeneration%2BIntel%25C2%25AE%2BCore%25E2%2584%25A2%2BProcessors%2Bwith%2BIntel%25C2%25AE%2BHD%2BGraphics%2B3000%252F2000">here</a> . <br><br>  To make sure that you have an up-to-date driver that correctly understands your hardware, check that the library has a library like <i>libmfxhw * .dll</i> .  If it was found, for example, <i>libmfxhw64-s1.dll</i> in the case of a 64-bit system with a Sandy Bridge processor, everything is OK. <br><br>  <b>4. Software support.</b> <br>  A current list of recommended Intel commercial Windows applications using Quick Sync via MSDK is <a href="http://www.intel.com/content/www/us/en/architecture-and-technology/quick-sync-video/quick-sync-video-general.html">here</a> . <br><br>  There is also an open source application - <a href="http://sourceforge.net/projects/qsdecoder/">Quick Sync Decoder</a> , which uses Quick Sync decoding of H.264, MPEG2 and VC-1 video through the ffdshow filter. <br><br>  OS X Mountain Lion QSV supports AirPlay Mirroring and QuickTime X. <br><br>  But, firstly, there are an order of magnitude more video processing applications in nature than in the above list.  And some of them may well use QSV, not reporting this out of modesty.  And secondly, the declared support for QSV and its actual engagement with your task are two big differences.  In many applications, to activate QSV you need to put a tick in a completely unexpected place or change some non-obvious setting, which you may need to look for if for some reason QSV does not work. <br>  All this leads us to the task - to check whether the hardware acceleration was actually used when processing your video. <br><br>  For applications from the list above, as well as those that you suspect of using the Intel Media SDK (evidence - the application uses the library libmfxsw * .dll), you can do it like this: <br><ol><li>  Download and install the <a href="http://software.intel.com/en-us/vcsource/tools/media-sdk">Intel Media SDK</a> </li><li>  In the folder ‚Äú&lt;install-folder&gt; \ tools \ mediasdk_tracer \‚Äù we find and run the MSDK profiler - tracer.exe <br><img src="https://habrastorage.org/storage2/ad4/4dd/7f0/ad44dd7f07b3ba239809ac598a7b17d3.png"></li><li>  We start logging with the Start button, we start video processing in your experimental application, after a few seconds we stop logging by pressing Stop. </li><li>  In the log file specified in the Output File field, look for the lines <br>  ‚Ä¢ MFXInit.impl = HARDWARE or MFXInit.impl = AUTO <br>  ‚Ä¢ MFXInit.status = MFX_ERR_NONE <br>  If they are found - everything is in order, QSV is used.  Otherwise, no, or you are mistaken, and the application does not use MSDK. </li></ol><br><br>  In the latter case, another check performed by the iron will help dispel doubts: <br><ol><li> Download and install <a href="http://software.intel.com/en-us/vcsource/tools/intel-gpa">Intel Graphics Performance Analyzer (GPA)</a> </li><li>  Launch GPA Monitor, then click the right mouse button on the GPA Monitor icon in the system tray to open the context menu and select Media Performance in it: <br><img src="https://habrastorage.org/storage2/edc/2e1/0e3/edc2e10e3d93b4ae602bdd86e705f829.png"><br>  The window that opens shows the load of the executive devices (EU) and the hardware video processor (MFX) of the Intel GPU. <br><img src="https://habrastorage.org/storage2/d9a/428/bf6/d9a428bf6b6aaba40e0204a52d5d7d96.png"></li><li>  We start video processing in your application, and in real time we look at the tables using the components of the Intel GPU.  Or - do not look, but save this data in the log by pressing Capture.  If the lines ‚Äúdecoding‚Äù (DECODING) and ‚Äúencoding‚Äù (ENCODE) flash in the tables or log file, as shown below, it means that QSV is used. <br><img src="https://habrastorage.org/storage2/fe9/704/113/fe9704113a5dc5af4ed77ef90a27e934.png"></li></ol><br><br>  How complicated it all is ... but it‚Äôs not easier  Can.  In all ultrabooks, Quick Sync Video works initially by definition, and using the free Intel MSDK you can easily write an application that uses QSV by default. </div><p>Source: <a href="https://habr.com/ru/post/150205/">https://habr.com/ru/post/150205/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150199/index.html">Implementing RESTful Web Service on Scala</a></li>
<li><a href="../150200/index.html">Be optimistic - depression leads to Alzheimer's disease</a></li>
<li><a href="../150201/index.html">Vulnerability in Kohana?</a></li>
<li><a href="../150203/index.html">My view on Scrum</a></li>
<li><a href="../150204/index.html">Solving the problem of installing Cloud9 ide on Ubuntu 12.04</a></li>
<li><a href="../150206/index.html">Bypassing the proactive protection of Kaspersky Lab products. Video demonstration</a></li>
<li><a href="../150207/index.html">Recommender systems: Bayes theorem and naive Bayes classifier</a></li>
<li><a href="../150208/index.html">Ghosts in ROM</a></li>
<li><a href="../150209/index.html">How to make friends with Truecrypt loader and Grub 2?</a></li>
<li><a href="../150210/index.html">Compiling packages</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>