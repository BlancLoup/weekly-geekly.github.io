<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Java instead of groovy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Suddenly it turns out that the project needs scripts and the question arises: what is better evolution or revolution? 
 But even an attempt to introdu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Java instead of groovy</h1><div class="post__text post__text-html js-mediator-article">  Suddenly it turns out that the project needs scripts and the question arises: what is better evolution or revolution? <br>  But even an attempt to introduce a brute can fail in a legacy project with a conservative team.  And management may find a dozen more reasons not to miss the gruv in the project.  Although groovy is much simpler and closer to a programmer who knows java than the same scala. <br><br><img src="https://habrastorage.org/files/869/d88/762/869d88762a294e60a72ad3942253e957.png"><br><br>  But even in this case, you can use dynamically compiled scripts in the project.  Let's learn how to compile java code dynamically in memory and run it in jvm, use dynamically loadable libraries from maven in it.  I would like to write as little code as possible for this and that the process of use is as simple as possible.  And I would also not like to hope for the availability of tools.jar in our program. <br><a name="habracut"></a><br>  Warning the indignation of Groovy specialists, I confess that I myself <a href="http://habrahabr.ru/post/272105/">love</a> and <a href="http://habrahabr.ru/post/269793/">use</a> this dynamic programming language and made my modest contribution to <a href="http://habrahabr.ru/post/270145/">Groovy Grape</a> .  Without detracting from the merits of Groovy, still try to apply java in the area where the jury on jvm is out of competition - dynamic compilation, interaction with existing java code and dynamic dependency import (what Grape does). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  About compiling in java.  JSR 199 </h2><br>  The JSR 199 standard is the java Compiler API, which has been around for a long time.  APIs are present in the java packages <b>javax.tools. *</b> .  But in order to compile java code from memory to memory and then run it, you need to pretty <a href="http://blog.nobel-joergensen.com/2008/07/16/using-eclipse-compiler-to-create-dynamic-java-objects-2/">write code and beat the tambourine</a> .  The compiler implementation does not go as part of the JRE and tools.jar is not in the maven repositories. <br><br><h2>  How to write less with JSR 199 </h2><br>  I would like something ready, not to ride every time, and my colleague suggested the <a href="http://unkrig.de/w/Janino">Janino</a> project.  Janino itself contains its own java subset compiler and is well suited only for evaluation by an expression.  There is org.codehaus.janino: commons-compiler-jdk which uses JSR 199, but it depends only heavily on oracle / openjdk tools.jar.  After the evening of the work, <a href="">janino-commons-compiler-ecj</a> (2.3 MB) appeared on file, which includes eclipse java compiler and commons-compiler-jdk modified for it.  It is self-sufficient and allows you to compile and download code, even in the JRE.  If you add <a href="">mvn-classloader</a> to it, then in scripts you can do the same magic with dynamic dependencies as in Groovy Grape. <br><br>  For comparison, the library for the dynamic language <a href="">mvel2</a> (989 KB) takes only a couple of times less space, but it does not allow doing such simple things as implementing an interface, defining an internal and instantiating an anonymous class, there is no similarity to the try / catch / finally construction and even debugging scripts on it may seem like hell. <br><br><h2>  Example </h2><br>  To compile a java script, only the com.github.igor-suhorukov dependency is needed: janino-commons-compiler-ecj: 1.0 and only 3 lines of code: <br><pre><code class="java hljs">SimpleClassPathCompiler simpleCompiler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleClassPathCompiler(dependenciesUrls); simpleCompiler.cook(SCRIPT_NAME+<span class="hljs-string"><span class="hljs-string">".java"</span></span>, scriptSourceText); Class&lt;?&gt; clazz = simpleCompiler.getClassLoader().loadClass(SCRIPT_NAME);</code> </pre> <br><br>  Not to be unfounded, there is an example of everything about what I tell on <a href="https://github.com/igor-suhorukov/janino-commons-compiler-ecj-example">github</a> .  To run it, we need a JVM that supports java8, as in the example script there will be a Stream API. <br><br>  So, let's begin: <br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/igor-suhorukov/janino-commons-compiler-ecj-example.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> janino-commons-compiler-ecj-example mvn <span class="hljs-built_in"><span class="hljs-built_in">test</span></span></code> </pre><br><br>  In order to import the class PhantomJsDowloader from the maven dependency com.github.igor-suhorukov: phantomjs-runner: 1.1 call MavenClassLoader and create a classpath compiler based on this maven artifact: <br><pre> <code class="java hljs">List&lt;URL&gt; urlsCollection = MavenClassLoader.usingCentralRepo().getArtifactUrlsCollection(<span class="hljs-string"><span class="hljs-string">"com.github.igor-suhorukov:phantomjs-runner:1.1"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleClassPathCompiler(urlsCollection);</code> </pre><br><br>  Next, I provide the text of the main java program that loads dependencies from the repository, compiles the script and executes it. <br>  <b>janino-commons-compiler-ecj-example / src / test / java / org.codehaus.commons.compiler.jdk / SimpleClassPathCompilerTest.java</b> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.codehaus.commons.compiler.jdk; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.github.igorsuhorukov.codehaus.plexus.util.IOUtil; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.github.igorsuhorukov.smreed.dropship.MavenClassLoader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.junit.Test; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.lang.reflect.Method; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.URL; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleClassPathCompilerTest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testClassloader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SCRIPT_NAME = <span class="hljs-string"><span class="hljs-string">"MyScript"</span></span>; List&lt;URL&gt; urlsCollection = MavenClassLoader.usingCentralRepo().getArtifactUrlsCollection(<span class="hljs-string"><span class="hljs-string">"com.github.igor-suhorukov:phantomjs-runner:1.1"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); SimpleClassPathCompiler simpleCompiler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleClassPathCompiler(urlsCollection); simpleCompiler.setCompilerOptions(<span class="hljs-string"><span class="hljs-string">"-8"</span></span>); simpleCompiler.setDebuggingInformation(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); String src = IOUtil.toString(getClass().getResourceAsStream(String.format(<span class="hljs-string"><span class="hljs-string">"/%s.java"</span></span>, SCRIPT_NAME))); simpleCompiler.cook(SCRIPT_NAME+<span class="hljs-string"><span class="hljs-string">".java"</span></span>, src); Class&lt;?&gt; clazz = simpleCompiler.getClassLoader().loadClass(SCRIPT_NAME); Method main = clazz.getMethod(<span class="hljs-string"><span class="hljs-string">"main"</span></span>, String[].class); main.invoke(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, (Object) <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runIt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"DONE!"</span></span>); } }</code> </pre><br><br>  And this is the script itself, which uses the external library from maven and also calls the runIt method of the class that compiled it. <br>  <b>janino-commons-compiler-ecj-example / src / test / resources / MyScript.java</b> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.github.igorsuhorukov.phantomjs.PhantomJsDowloader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.github.igorsuhorukov.smreed.dropship.MavenClassLoader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.codehaus.commons.compiler.jdk.SimpleClassPathCompilerTest; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.stream.Collectors; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyScript</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception</span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Wrapper</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Wrapper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value; } } SimpleClassPathCompilerTest.runIt(); List&lt;String&gt; res = Arrays.asList(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Wrapper(<span class="hljs-string"><span class="hljs-string">"do"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Wrapper(<span class="hljs-string"><span class="hljs-string">"something"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Wrapper(<span class="hljs-string"><span class="hljs-string">"wrong"</span></span>)).stream(). map(Wrapper::getValue).collect(Collectors.toList()); System.out.println(String.join(<span class="hljs-string"><span class="hljs-string">" "</span></span>,res)); System.out.println(<span class="hljs-string"><span class="hljs-string">"Classes from project classpath. For example "</span></span>+MavenClassLoader.class.getName()); System.out.println(PhantomJsDowloader.getPhantomJsPath()); } }</code> </pre><br><br>  For example operation, the following dependencies are needed. <br><ul><li>  <b>com.github.igor-suhorukov: janino-commons-compiler-ecj: 1.0</b> to compile java code and dynamically load it. </li><li>  <b>com.github.igor-suhorukov: mvn-classloader: 1.3</b> for dynamically loading libraries from maven and building a compiler classpath. </li><li>  <b>junit</b> for the test. </li></ul><br>  <b>pom.xml</b> <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.github.igor-suhorukov<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>janino-commons-compiler-ecj-example<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span>jar<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven.compiler.source</span></span></span><span class="hljs-tag">&gt;</span></span>1.8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven.compiler.source</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven.compiler.target</span></span></span><span class="hljs-tag">&gt;</span></span>1.8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven.compiler.target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.github.igor-suhorukov<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>janino-commons-compiler-ecj<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exclusions</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exclusion</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exclusion</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exclusions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.github.igor-suhorukov<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mvn-classloader<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>junit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>junit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>4.12<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span>test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><h2>  Java script debug </h2><br>  Debugging the script, as usual debugging java program.  We set breakpoints and do not forget to include debugging information when compiling the script: <br><pre> <code class="java hljs">simpleCompiler.setDebuggingInformation(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/JSQ8aX-eLXk%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi6rcKRJaULSJPM0mSJ0MnlENCBBQ" frameborder="0" allowfullscreen=""></iframe><br><br><h2>  findings </h2><br>  We learned how to compile java code from a java program by adding just a few lines.  We can also include dependencies from the maven repositories in this script and debug the code in the IDE. <br><br>  The approach from the article can replace groovy for scripts in the project, if the requirements do not allow using anything other than java or colleagues are hostile to the groove and nothing can be done with it.  You can argue about AST / metaprogramming, that groovy is ahead and you will be right, in java this is not all simple.  About working with the AST java program I told in the article " <a href="http://habrahabr.ru/post/269129/">Parsing Java programs using a java program.</a> ".  We will try to solve the situation with metro programming in the following publications. <br><br>  Despite the fact that the article describes the approach on ‚Äúpure‚Äù java and political motives could influence the choice of this approach in the project, I think <b>Java is</b> better <b>with Groovy</b> than ‚ÄúJava instead of Groovy‚Äù. </div><p>Source: <a href="https://habr.com/ru/post/273683/">https://habr.com/ru/post/273683/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273671/index.html">Seven things useful to know about programmers</a></li>
<li><a href="../273673/index.html">Relocation of IT-person to Germany: from A to Z</a></li>
<li><a href="../273677/index.html">Layout letters: 60 useful resources, guides and research</a></li>
<li><a href="../273679/index.html">Networks for the smallest. Part eleven. MPLS L3VPN</a></li>
<li><a href="../273681/index.html">HPE offers Composable Infrastructure</a></li>
<li><a href="../273685/index.html">40 books and educational resources for the study of the stock market and algorithmic trading</a></li>
<li><a href="../273687/index.html">Data structure 2-3-4 tree</a></li>
<li><a href="../273689/index.html">Forecast 2016: Android attacks and large-scale infections are among the main security threats.</a></li>
<li><a href="../273693/index.html">Develop a cloud conferencing service for small businesses</a></li>
<li><a href="../273695/index.html">How to save a million dollars with Tarantool</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>