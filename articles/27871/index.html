<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MS Access: The utility for issuing request data to the debug console</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Working with Acces every day, several times a day I encounter the problem that somewhere in the VBA code I need to see what one or another SQL query w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MS Access: The utility for issuing request data to the debug console</h1><div class="post__text post__text-html js-mediator-article">  Working with Acces every day, several times a day I encounter the problem that somewhere in the VBA code I need to see what one or another SQL query will return to me.  To do this, I have to switch from the VBA-editor to the main part of the program, and either create a temporary query (which is then left-willy-nilly), or quickly change the SQL in some temporary query.  Since a lot of time is always spent on this, I decided to write a simple function that returns the results of the query to the debug console. <br><br>  This utility is called q (so that it is convenient to call, and a hint of a Query query), it takes the query itself as parameters (either entirely as SQL, or just the name of the query or table, as long as it can be opened via CurrentDB.OpenRecordset ), the maximum width of the field when issuing (if the field is larger - it is cut off, the default is 10 characters) and the maximum number of records (the default is 100 records), and returns to the console the contents of the results of this query in text form, it looks like this: <br><br><pre> ? q ("qryStatBestVertriebler")
 Running qryStatBestVertriebler ...
 Query returned 9 entries.
 -------------------------------------------------- -----------------------------------
 |  Nr |  VMB |  FName |  Einkauf |  Verkauf |  Gewinn |  Num | 
 -------------------------------------------------- -----------------------------------
 |  1 |  757 |  S√∂nke Doba |  492661.52 |  718774.8 |  226113.28 |  231 | 
 |  2 |  877 |  Johannes W |  10464.99 |  59677.25 |  49212.26 |  39 | 
 |  3 |  1098 |  Marco M√ºll |  8233.18 |  12244.77 |  4011.59 |  36 | 
 |  4 |  5527 |  Torben Jas |  12974.64 |  24642,42 |  11667.78 |  16 | 
 |  5 |  6214 |  Thiemo Wol |  5932.17 |  12175.97 |  6243.8 |  23 | 
 |  6 |  7833 |  Florian Mi |  207384.93 |  293553.82 |  86168.8900 |  254 | 
 |  7 |  8310 |  Daniel Sch |  3525.56 |  4338.92 |  813.36 |  4 | 
 |  8 |  8917 |  Daniela He |  187881.29 |  638726.06 |  450844.77 |  559 | 
 |  9 |  9330 |  Konrad Cyw |  94142.67 |  133056,71 |  38914.04 |  139 | 
 -------------------------------------------------- -----------------------------------
 Falsch
</pre><br><a name="habracut"></a><br>  And here is its code: <br><blockquote><ol><li>  <font color="#0000ff">Public</font> <font color="#0000ff">Function</font> q ( <font color="#0000ff">Optional</font> strSQL <font color="#0000ff">As</font> <font color="#0000ff">String</font> = <font color="#A31515">""</font> , <font color="#0000ff">Optional</font> intWidth <font color="#0000ff">As</font> <font color="#0000ff">Integer</font> = 10, <font color="#0000ff">Optional</font> intMax <font color="#0000ff">As</font> <font color="#0000ff">Integer</font> = 100) <font color="#0000ff">As</font> <font color="#0000ff">Boolean</font> </li><li></li><li>  <font color="#0000ff">Dim</font> tmpRCDSet <font color="#0000ff">As</font> Recordset, tmpFeld <font color="#0000ff">As</font> Field, tmpString <font color="#0000ff">As</font> <font color="#0000ff">String</font> , I <font color="#0000ff">As</font> <font color="#0000ff">Integer</font> , intTemplen <font color="#0000ff">As</font> <font color="#0000ff">Integer</font> </li><li>  <font color="#0000ff">Dim</font> intNr <font color="#0000ff">As</font> <font color="#0000ff">Integer</font> </li><li></li><li>  <font color="#0000ff">On</font> <font color="#0000ff">Error</font> <font color="#0000ff">GoTo</font> Err_SQL </li><li>  Debug.Print <font color="#A31515">"Running‚Äû</font> &amp; strSQL &amp; <font color="#A31515">"..."</font> </li><li>  <font color="#0000ff">Set</font> tmpRCDSet = CurrentDb.OpenRecordset (strSQL) </li><li>  tmpRCDSet.MoveLast </li><li>  Debug.Print <font color="#A31515">"Query returned‚Äû</font> &amp; tmpRCDSet.RecordCount &amp; <font color="#A31515">‚Äúentries."</font> </li><li>  tmpRCDSet.MoveFirst </li><li>  tmpString = <font color="#A31515">"| Nr |"</font> </li><li>  <font color="#0000ff">For</font> <font color="#0000ff">Each</font> tmpFeld <font color="#0000ff">In</font> tmpRCDSet.Fields </li><li>  tmpString = tmpString &amp; padleft (tmpFeld.Name, intWidth) &amp; <font color="#A31515">"|"</font> </li><li>  <font color="#0000ff">Next</font> </li><li></li><li>  Debug.Print <font color="#0000ff">String</font> (Len (tmpString) - 1, <font color="#A31515">"-"</font> ) </li><li>  Debug.Print tmpString </li><li>  Debug.Print <font color="#0000ff">String</font> (Len (tmpString) - 1, <font color="#A31515">"-"</font> ) </li><li></li><li>  intNr = 1 </li><li>  <font color="#0000ff">While</font> ( <font color="#0000ff">Not</font> (tmpRCDSet.EOF)) <font color="#0000ff">And</font> (intNr &lt;= intMax) </li><li>  tmpString = <font color="#A31515">"|"</font> &amp; padleft (Str (intNr), 4) &amp; <font color="#A31515">"|"</font> </li><li>  <font color="#0000ff">For</font> <font color="#0000ff">Each</font> tmpFeld <font color="#0000ff">In</font> tmpRCDSet.Fields </li><li>  tmpString = tmpString &amp; padleft (Nz (tmpFeld.Value, <font color="#A31515">""</font> ), intWidth) &amp; <font color="#A31515">"|"</font> </li><li>  <font color="#0000ff">Next</font> </li><li>  Debug.Print tmpString </li><li>  intNr = intNr + 1 </li><li>  tmpRCDSet.MoveNext </li><li>  <font color="#0000ff">Wend</font> </li><li>  Debug.Print <font color="#0000ff">String</font> (Len (tmpString) - 1, <font color="#A31515">"-"</font> ) </li><li></li><li>  <font color="#0000ff">Exit</font> <font color="#0000ff">function</font> </li><li></li><li></li><li>  Err_SQL: </li><li>  Debug.Print Err.Number &amp; <font color="#A31515">""</font> &amp; Err.Description </li><li>  Debug.Print <font color="#A31515">"Bad SQL string"</font> </li><li></li><li></li><li>  <font color="#0000ff">End</font> <font color="#0000ff">function</font> </li><li></li><li>  <font color="#0000ff">Function</font> padleft (strLineIn <font color="#0000ff">As</font> <font color="#0000ff">String</font> , intWidth <font color="#0000ff">As</font> <font color="#0000ff">Integer</font> ) <font color="#0000ff">As</font> <font color="#0000ff">String</font> </li><li></li><li>  <font color="#0000ff">If</font> Len (strLineIn) = intWidth <font color="#0000ff">Then</font> </li><li>  padleft = strLineIn </li><li>  <font color="#0000ff">ElseIf</font> Len (strLineIn)&gt; intWidth <font color="#0000ff">Then</font> </li><li>  padleft = Mid (strLineIn, 1, intWidth) </li><li>  <font color="#0000ff">Else</font> </li><li>  padleft = <font color="#0000ff">String</font> (intWidth - Len (strLineIn), <font color="#A31515">""</font> ) &amp; strLineIn </li><li>  <font color="#0000ff">End</font> <font color="#0000ff">if</font> </li><li></li><li>  <font color="#0000ff">End</font> <font color="#0000ff">function</font> </li></ol>  <font color="gray">* This source code was highlighted with <a href="http://poison.qsh.ru/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/27871/">https://habr.com/ru/post/27871/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278699/index.html">QA: Conference. We tell about the reports</a></li>
<li><a href="../27870/index.html">The love of little cars ...</a></li>
<li><a href="../278701/index.html">Foreach - from the book PowerShell in depth</a></li>
<li><a href="../278705/index.html">AMD fixes microprocessor microcode vulnerability</a></li>
<li><a href="../278709/index.html">Conferences in 3CX Phone System</a></li>
<li><a href="../278711/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ201 (March 1 - 6, 2016)</a></li>
<li><a href="../278713/index.html">Everything you need to know about Unity 5, UWP applications and March 8</a></li>
<li><a href="../27872/index.html">Add favicons to bookmarklets</a></li>
<li><a href="../278725/index.html">First extortionist discovered for Apple OS X</a></li>
<li><a href="../278729/index.html">Kibana-mother or Why do you need logs at all?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>