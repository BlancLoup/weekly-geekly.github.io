<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Programming LibreOffice Base. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 2 will discuss the relationship between database tables and forms. In particular, how to define a relationship between two tables and use referen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Programming LibreOffice Base. Part 2</h1><div class="post__text post__text-html js-mediator-article">  Part 2 will discuss the relationship between database tables and forms.  In particular, how to define a relationship between two tables and use reference tables as a data source for drop-down lists. <br><a name="habracut"></a><br>  Versions of OpenOffice and LibreOffice for which this message is relevant from 3.0 to 6.2 (the current version of LibreOffice).  Starting from version 3.0, OpenOffice Base now has the ability to save scripts in a database file (with the .odb extension), which allows you to conveniently distribute macro OO Basic code <br><br>  There is some confusion with the forms in OpenOffice Base.  The fact is that in the process of software evolution from an office suite to a database environment, it turned out that Forms, Forms, Forms and Form are a little different.  And Form is not only Form.  I will explain in more detail. <br><br>  When you open the OpenOffice Base database in edit mode, you see four tabs on the left side of the screen.  In the Russified version it will sound like 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Tables </li><li>  Requests </li><li>  Forms </li><li>  Reports </li></ul><br>  In this sense, the Form is some independent application that runs in a separate window.  I also note that in fact this is the window in which the OpenOffice Writer instance is launched. <br><br>  <i>Note.</i>  <i>Because a form is actually an instance of OpenOffice Writer ‚Äî an application can be created without downloading the OpenOffice Base component ‚Äî right into OpenOffice Writer.</i> <br><br>  Each Form has a Forms collection of Form objects.  Initially, this collection is empty.  Despite this, you can open and close the Form.  And even display text information in it.  And only when adding a new control (for example, Button), the system will create a Form object with the default name Form, if you have not created such an object yourself before that time. <br><br>  It is most convenient to create new forms from the Form Navigator (shown on the palette as a compass), which can also be accessed from the View | Toolbar | Form Navigation menu.  Form objects are created either at the top level in the Forms collection, or subordinate to another Form object.  This does not affect the appearance of the Form, but can be useful when defining relationships between tables. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/ceb/e4b/db1/cebe4bdb1f339866597f8c0ba95736fb.png" alt="image"><br></div></div><br><br>  Here it is necessary to note one anomaly of the Form object.  This object is primarily an object associated with a database table or an SQL query.  You can think of a Form as a ResultSet object (it really is).  On the other hand, Form is a container for controls, like FORM in an HTML document (and this is also true). <br><br>  Open the newly created Form in edit mode (right mouse button | Edit).  Create a new Form object in it with the name Form, or with another name you like.  In this Form element, create a child Form element. <br><br>  Each Form must be linked to an existing database table, query or SQL query.  In the subordinate Form, you can set rules to reflect the data filtered by the value of the associated fields in the main Form of the Master / Slave type.  To do this, in the property editor of the subordinate Form, you need to fill in the properties link master fields and link slave fields. <br><br>  Now we will add a Table Control element to each Form by selecting the appropriate Form in the Form Navigator&gt;.  The Table Control element is missing from the available items panel.  To display an extended list of elements, you need to activate the More Controls button in the elements palette.  After adding the Table Control element, you need to enter the editing mode of this element and add the necessary to display the table column (right mouse button -&gt; Insert / Replace / Delete Column) <br><br>  The second type of frequently used in practice type of connection between tables (after Master / Slave), and which we will consider is the Directory type connection.  We store the key of the object GUID, autoincrement in the data table, and in the displayed table we display its full name taken from the associated table- ‚Äúdirectory‚Äù.  For this there is a convenient mechanism.  In the visual Table Designer, add a column of type List Box.  If you have already created a column of type Numeric / Text, in which the key is displayed (and not the name), it is possible to change its type to the List Box (right mouse button | Replace With | List Box).  Next, edit the list of column properties.  On the data tab, the Type of List Content Content property is assigned a SQL value.  The query in the List Content property should contain the displayed value in the first column, and the Bound Field property should contain the index of the column with the key field (assuming that the first column has the index 0).  That is, in the vast majority of requests it will be 1 for requests of the type <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> USERNAME, USERID <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USERS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> USERNAME</code> </pre> <br>  So far, work has been described in the configurator mode without programming.  Add functionality using macros OO Basic. <br><br>  Create a filter for the database table by the value entered in the text box.  To do this, we write in OO Basic the procedure that handles the event from the keyboard. <br><br><pre> <code class="vbscript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> TextBox_onKeyUp(oEvent) oDocument = ThisComponent oDocument.LockControllers sText = oEvent.Source.text <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Len</span></span>(sText) &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> oForm = ThisComponent.Drawpage.Forms.getByName(<span class="hljs-string"><span class="hljs-string">"MyForm"</span></span>) oForm.<span class="hljs-built_in"><span class="hljs-built_in">Filter</span></span> = <span class="hljs-string"><span class="hljs-string">"USERNAME LIKE '"</span></span> + sText + <span class="hljs-string"><span class="hljs-string">"%'"</span></span> oForm.reload() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> oDocument.UnlockControllers <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre><br>  We associate this procedure with the Key released event of the text field (on the event tab of the item property list).  Note that this text field must be located in another Form (not the one on which the filter is applied) so that the reload of oForm.reload () does not ‚Äúreset‚Äù its current value entered from the keyboard. <br><br>  To be continued. </div><p>Source: <a href="https://habr.com/ru/post/445304/">https://habr.com/ru/post/445304/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445292/index.html">What I have never been told about CSS</a></li>
<li><a href="../445294/index.html">And again about the second monitor from the tablet ...</a></li>
<li><a href="../445298/index.html">Security Week 13: Open Facebook Passwords</a></li>
<li><a href="../445300/index.html">Gaming industry news (March 11-25, 2019)</a></li>
<li><a href="../445302/index.html">"Game of Thrones, move over." What Apple showed today in its Show Time event</a></li>
<li><a href="../445308/index.html">Features of hypothesis testing for mobile applications</a></li>
<li><a href="../445310/index.html">Sovereign Runet went up to $ 30 billion</a></li>
<li><a href="../445312/index.html">JVM Memory Allocation</a></li>
<li><a href="../445314/index.html">Why is resource extraction on asteroids - is it difficult?</a></li>
<li><a href="../445316/index.html">DevDay Manage IT. Recording speeches</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>