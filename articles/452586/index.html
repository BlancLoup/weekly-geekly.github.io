<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to start programming in Adobe Illustrator. Part one</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I just want to warn you that this series of posts is not for experienced programmers and not even for programmers in general. I understand that this s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to start programming in Adobe Illustrator. Part one</h1><div class="post__text post__text-html js-mediator-article"><p>  I just want to warn you that this series of posts is not for experienced programmers and not even for programmers in general.  I understand that this sounds extremely defiant, given the IT theme of the resource, and yet let me explain ... As an audience, I see ordinary designers who would like to start programming in the Adobe environment, but for some reason (because of the fear of unknown, lack of confidence in their capabilities or lack of knowledge of the language) cannot take the first steps in this direction.  I see my modest task in helping them to understand that "not the gods are burning pots" and anyone who is sufficiently motivated can learn how to write working program code.  It is possible that some of them will be so enthusiastic about this game that they decide to become real developers.  What code is not joking? </p><br><p>  This post will show you how to create your own unique tool in Adobe Illustrator through writing a small program (JavaScript script), which will not only reduce your time, but also improve interaction with this wonderful graphical editor.  First, I will formulate the task, then I will show the code that solves it and, further, I will tell you in detail about how it was created.  Javascript basics, the features of <a href="https://illustrator-scripting-guide.readthedocs.io/objectmodel/objectModel/">the Illustrator object model,</a> or various editors for writing / debugging code will not be discussed here.  You can find this information yourself if you wish.  The main thing, in my opinion, is an understanding of the basic principles of writing programs, which is the main focus of this article.  If you are ready to jump a little above your head, welcome to the cut! </p><br><p><a name="habracut"></a>  Adobe Illustrator has a Clipping Mask tool that works with clipping masks.  Clipping Mask contains three commands: Make, Release and Edit Mask.  The first creates a mask, the second - parses, the third - allows editing.  We are interested in the second command, which breaks the Clipping Mask object into the contour and the contents of the mask.  Very often it is necessary not only to disassemble the mask, but also to get rid of the contour of the mask itself, leaving only the contents.  The regular Release Clipping Mask team does not do this, so after applying it, you need to perform three more steps: </p><br><ol><li>  Remove selection from objects </li><li>  Select only the outline of the mask </li><li>  Delete mask outline </li></ol><br><p>  If this sequential operation has to be performed quite often throughout the day, then the question arises: is it not possible to somehow reduce the number of these actions to get the same result?  And the point here is not at all in laziness, but in the absence of the necessary tool.  Now imagine for a second that you have such a tool. </p><br><blockquote>  Here you are briefly distracted from work and immersed in thoughts about how it would be great if in the arsenal of Adobe Illustrator there was such a team as Expand Clipping Mask, which performed all these actions for you.  Cool idea!  You need to write to Adobe technical support, you think.  Next thought: what if they have already written about it many times?  And if someday and maybe they add such a tool, then what do you need from this?  This team is needed here and now! <br><br>  And here comes the moment of truth - you can write the script yourself! </blockquote><p>  No sooner said than done! </p><br><pre><code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> #target illustrator <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (app.documents.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doc = app.activeDocument; <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sel = doc.selection; <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> clipPath; <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sel.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].typename == <span class="hljs-string"><span class="hljs-string">'GroupItem'</span></span> &amp;&amp; sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].clipped == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> clipGroup = sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].pageItems.length; <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; clipGroup; i++) { <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].pageItems[i].typename == <span class="hljs-string"><span class="hljs-string">'PathItem'</span></span> &amp;&amp; sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].pageItems[i].clipping == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-number"><span class="hljs-number">11</span></span> clipPath = sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].pageItems[i]; <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-number"><span class="hljs-number">13</span></span> }; <span class="hljs-number"><span class="hljs-number">14</span></span> }; <span class="hljs-number"><span class="hljs-number">15</span></span> app.executeMenuCommand(<span class="hljs-string"><span class="hljs-string">'releaseMask'</span></span>); <span class="hljs-number"><span class="hljs-number">16</span></span> clipPath.remove(); <span class="hljs-number"><span class="hljs-number">17</span></span> } <span class="hljs-number"><span class="hljs-number">18</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-number"><span class="hljs-number">19</span></span> alert (<span class="hljs-string"><span class="hljs-string">'   -!'</span></span>); <span class="hljs-number"><span class="hljs-number">20</span></span> }; <span class="hljs-number"><span class="hljs-number">21</span></span> } <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-number"><span class="hljs-number">23</span></span> alert (<span class="hljs-string"><span class="hljs-string">'  !'</span></span>); <span class="hljs-number"><span class="hljs-number">24</span></span> }; <span class="hljs-number"><span class="hljs-number">25</span></span> } <span class="hljs-number"><span class="hljs-number">26</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-number"><span class="hljs-number">27</span></span> alert (<span class="hljs-string"><span class="hljs-string">'  !'</span></span>); <span class="hljs-number"><span class="hljs-number">28</span></span> };</code> </pre> <br><p>  Such a small code will help solve this problem.  Instead of several, already rather annoying actions, you only need to do one thing ‚Äî run the Expand Clipping Mask script.  Now you have a handy tool for working with masks, also made with your own hands. </p><br><p>  Of course, here I am a little cunning.  First, the script was not written by you, and secondly - it is not as universal as we would like.  However, if you are interested in how it works, and most importantly, how to learn to write such programs yourself, then I will be happy to tell you about it in order and with detailed comments. </p><br><p>  To begin with, any script (script / program / JavaScript code) consists of several basic code blocks: declarations (initialization) of variables, basic checks (conditions) and, let's say, the ‚Äúprogram engine‚Äù - a code that implements the main working functionality the script.  Of course, this division is very conditional, as in the functional part there are also checks, but the structural principle is as follows.  Naturally, the larger the program, the more difficult it will be to divide it into similar blocks.  But in our case, it is possible.  Lines 8 through 16 are the script engine, the other lines are variable declarations and various basic checks with their processing.  If you calculate, it turns out that the number of rows of the block of checks is more than the number of rows of the function block.  Are these checks really important? </p><br><h2 id="zachem-nuzhny-proverki">  Why do we need checks? </h2><br><p>  Serious programmers will understand me, but it will be useful for novice developers to learn about it.  Checks are needed in order to ensure the normal operation of the functional part of the program.  If you do not write them, then any error when executing the script will lead to a software failure.  And this is not good. </p><br><p>  Of course, the serious comrades mentioned above use the try / catch construct for such purposes, but I decided that the usual if / else would be a concise and more understandable construct.  Especially for beginner script writers. </p><br><p>  Consider in detail what these lines do.  The first line is responsible for the fact that even if the script is not run from Adobe Illustrator, it will be executed exactly in it.  Accordingly, if you run the script from Illustrator, this line can be omitted. </p><br><pre> <code class="javascript hljs">#target illustrator</code> </pre> <br><p>  Next, it checks for open documents in Adobe Illustrator at the time of the script launch.  It is necessary to read these lines as follows: if ( <code>if</code> ) in an application ( <code>app</code> ) the number of documents ( <code>documents.length</code> ) is greater than zero (&gt; 0), then the code contained in {...} should be executed.  Otherwise ( <code>else</code> ), display the message ( <code>alert</code> ) 'No open documents!'  and complete the script. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (app.documents.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { ... ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert (<span class="hljs-string"><span class="hljs-string">'  !'</span></span>); };</code> </pre> <br><p>  The following code block checks for a selection in a document. </p><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sel.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { ... ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert (<span class="hljs-string"><span class="hljs-string">'  !'</span></span>); };</code> </pre> <br><p>  It should be noted that if in the previous examples we used reserved names (such as, <code>app</code> or <code>documents</code> ), here we use the variable sel, which we defined ourselves in lines 3 and 4, </p><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doc = app.activeDocument; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sel = doc.selection;</code> </pre> <br><p>  where <code>doc</code> is the link to the active Illustrator document, and <code>sel</code> is the link to the selected object / objects in the active document. </p><br><blockquote>  A link (or reference) is a pointer to a specific object.  Of course, I am well aware that the completely innocuous Russian word "pointer" is capable of introducing into a stupor any person who is not familiar with OOP (object-oriented programming).  But take my word for it, everything is not as difficult as it seems.  References are stored in variables and used to refer to objects.  In the <code>doc</code> variable, we save (assign it a value using the assignment operator <code>=</code> ) a pointer to the active document (activeDocument) of the application (app), and in the <code>sel</code> variable, we save a pointer to the selection (selection) in the active document (activeDocument) of the application (app).  Just to not write again the app. InactiveDocument, we use instead the variable <code>doc</code> , in which this code is already contained.  That's why the link will look like <code>sel = doc.selection</code> .  I hope I clearly explained. </blockquote><p>  Thus, in this condition <code>if (sel.length &gt; 0)</code> it is checked whether there are selected objects in the active document, and if not, the message is displayed: 'There are no selected objects!' </p><br><p>  The following lines check the veracity, sorry for the pun, just two conditions.  The first that the selected object is a group ( <code>GroupItem</code> ) and (&amp;&amp;) is the second that this group is really a clipping mask (the <code>clipped</code> property of this object is <code>true</code> ). </p><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].typename == <span class="hljs-string"><span class="hljs-string">'GroupItem'</span></span> &amp;&amp; sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].clipped == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { ... ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { alert (<span class="hljs-string"><span class="hljs-string">'   -!'</span></span>); };</code> </pre> <br><p>  Here we need a little explanation. </p><br><blockquote>  What is a mask object?  This is a group, but not normal.  A normal group is a collection of various objects that is subordinate to, say, the "main" or "parent" object.  As for the mask object, it is also a group, but unlike the usual one, it consists of two parts - the contour of the mask and its contents.  So, to determine from the script that in front of you is a regular group or mask group, its property is <code>clipped</code> .  If the value of the clipped property is <code>false</code> (false), then this is a normal group, if <code>true</code> (true), then this is a clipping group. </blockquote><p>  <em>Inquiring minds will notice that instead of the variable <code>sel</code> , which we defined earlier, the construct <code>sel[0]</code> .</em>  <em>This is explained by the fact that the selection, from the point of view of the script, is a collection (collection) of elements, and not a specific object (even if only one object is selected).</em>  <em>And to check the type ( <code>typename</code> ) of this object for compliance with the type of the selected collection element, the <code>sel[0]</code> construction is used, which refers to the first <code>[0]</code> element of the collection, that is, in our case, to the selected group.</em> </p><br><p>  As a result, if the selected object is both a group and a mask, then the following code is executed, otherwise the message is displayed: 'The selection is not a mask object!' </p><br><p>  With checks - everything.  Go ahead. </p><br><h2 id="kak-sozdavalsya-osnovnoy-kod">  How was the main code created? </h2><br><p>  In this part of the article I will try not just to comment on how the code works, but to describe the process of its creation.  If not the whole process, then at least some key points.  Let's start! </p><br><p>  Previously described three steps that must be performed to solve the problem of "sorting out" the Clipping Mask and then removing the mask outline.  One more action will be added to them (the Release command), from which our algorithm will begin.  I will repeat them here to refresh the context. </p><br><ol><li>  Run the command Release Clipping Mask </li><li>  Remove selection from objects </li><li>  Select only the outline of the mask </li><li>  Delete mask outline </li></ol><br><p>  If we implement this sequence of actions strictly according to the list, then the first two points can be easily solved by calling the <code>executeMenuCommand()</code> method.  But then, on the third point, we will face an unsolvable problem.  How to get a link to the mask outline, if after the first action (Release Clipping Mask) there is no longer any mask, but there is only a set of selected objects?  And he is already structurally not the same as before performing this operation. </p><br><p>  In general, the logic suggests that you first need to create a link (reference) to the object of the mask contour.  Thinking over what is so unique about the contour of the mask compared to the usual contour, we find the <code>clipping</code> property of the class <code>PathItem</code> .  Now we just have to loop through all the objects of the mask group and find the <code>PathItem</code> with the property <code>clipping = true</code> .  This will be the desired circuit.  As a result of executing this code, we will get a reference to the object of the mask's contour and save it in the variable <code>clipPath</code> . </p><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; clipGroup; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].pageItems[i].typename == <span class="hljs-string"><span class="hljs-string">'PathItem'</span></span> &amp;&amp; sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].pageItems[i].clipping == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { clipPath = sel[<span class="hljs-number"><span class="hljs-number">0</span></span>].pageItems[i]; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }; };</code> </pre> <br><p>  What's next?  Let‚Äôs go back to the algorithm and write the code for point 1. This line executes the Release Clipping Mask command, but not through the user interface, but from the script.  Yes, that simple! </p><br><pre> <code class="javascript hljs"> app.executeMenuCommand(<span class="hljs-string"><span class="hljs-string">'releaseMask'</span></span>);</code> </pre> <br><p>  We skip points 2 and 3 (because we already have the selection of the mask outline, or rather the link to the clipPath object) and immediately go to step 4. Here we call the <code>remove()</code> method of the <code>clipPath</code> object.  This method removes the mask outline. </p><br><pre> <code class="javascript hljs"> clipPath.remove();</code> </pre> <br><p>  On this, in fact, for now.  Thanks for attention! </p><br><p>  I hope you now understand that it is not as difficult to start programming in Adobe Illustrator as it seems at first glance. </p><br><p>  PS Of course, the resulting script is far from perfect.  It does not work with masks whose outlines are represented by <code>CompoundPath</code> , <code>CompoundShape</code> or <code>TextFrame</code> .  How to modify the script so that it becomes a truly valuable tool, read in the <a href="https://habr.com/ru/post/452614/">second part</a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/452586/">https://habr.com/ru/post/452586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452572/index.html">EFORTH for MK-161: Data Structures</a></li>
<li><a href="../452576/index.html">About introverts in IT</a></li>
<li><a href="../45258/index.html">methods of working with the template engine</a></li>
<li><a href="../452580/index.html">20 projects, 20 languages, deadline yesterday. Part 3</a></li>
<li><a href="../452584/index.html">Misconceptions of programmers about Unix-time</a></li>
<li><a href="../45259/index.html">Native template engine</a></li>
<li><a href="../452590/index.html">The American has created a mobile classroom for teaching children in low-budget 3D printing schools; the project has already collected more than 100,000</a></li>
<li><a href="../452592/index.html">Part 0. Requires an elf to work in the Matrix. Relocation possible</a></li>
<li><a href="../452596/index.html">735,000 IPv4 addresses were taken from the scammer and returned to the registry</a></li>
<li><a href="../452598/index.html">Managing a team of programmers: how and what motivates them correctly? Part one</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>