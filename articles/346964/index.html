<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learn OpenGL. Lesson 4.4 - Clipping of faces</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Face clipping 
 Try to imagine a cube and calculate the maximum number of its faces, which you can see from any direction. If your imagination is not ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learn OpenGL. Lesson 4.4 - Clipping of faces</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/c9e/9b2/a3b/c9e9b2a3baf749ab8e2b385c6d93d966.png" alt="Ogl3" align="left" width="300"><h1>  Face clipping </h1><br>  Try to imagine a cube and calculate the maximum number of its faces, which you can see from any direction.  If your imagination is not too vivid, then, most likely, you will come to the conclusion that this number is 3. From whatever point or direction you look at the cube, you can never see more than three faces.  So why spend the computing power on drawing the remaining three faces, if they are not visible?  If we could discard their processing in some way, we would save more than half of the fragment shader executions! <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Content</b> <div class="spoiler_text">  Part 1. Start <br><br><ol><li>  <a href="https://habrahabr.ru/post/310790/">Opengl</a> </li><li>  <a href="https://habrahabr.ru/post/311198/">Creating a window</a> </li><li>  <a href="https://habrahabr.ru/post/311234/">Hello window</a> </li><li>  <a href="https://habrahabr.ru/post/311808/">Hello triangle</a> </li><li>  <a href="https://habrahabr.ru/post/313380/">Shaders</a> </li><li>  <a href="https://habrahabr.ru/post/315294/">Textures</a> </li><li>  <a href="https://habrahabr.ru/post/319144/">Transformations</a> </li><li>  <a href="https://habrahabr.ru/post/324968/">Coordinate systems</a> </li><li>  <a href="https://habrahabr.ru/post/327604/">Camera</a> </li></ol><br>  Part 2. Basic lighting <br><br><ol><li>  <a href="https://habrahabr.ru/post/329592/">Colors</a> </li><li>  <a href="https://habrahabr.ru/post/333932/">Lighting Basics</a> </li><li>  <a href="https://habrahabr.ru/post/336166/">Materials</a> </li><li>  <a href="https://habrahabr.ru/post/337550/">Texture Cards</a> </li><li>  <a href="https://habrahabr.ru/post/337642/">Sources of light</a> </li><li>  <a href="https://habrahabr.ru/post/338254/">Multiple light sources</a> </li></ol><br>  Part 3. Loading 3D Models 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  <a href="https://habrahabr.ru/post/338436/">Assimp library</a> </li><li>  <a href="https://habrahabr.ru/post/338436/">Mesh mesh class</a> </li><li>  <a href="https://habrahabr.ru/post/338998/">Model class</a> </li></ol><br>  Part 4. OpenGL advanced features <br><br><ol><li>  <a href="https://habrahabr.ru/post/342610/">Depth test</a> </li><li>  <a href="https://habrahabr.ru/post/344238/">Stencil test</a> </li><li>  <a href="https://habrahabr.ru/post/343096/">Mixing colors</a> </li><li>  <a href="https://habrahabr.ru/post/346964/">Face clipping</a> </li><li>  <a href="https://habrahabr.ru/post/347354/">Cadre buffer</a> </li></ol></div></div><br><blockquote>  It says ‚Äúmore than half‚Äù because in certain situations only two, or even one facet of a cube are visible.  In such cases, <i>more</i> than 50% will be saved. </blockquote><br>  The idea is good, but a new task appears: it is necessary to determine which face is not visible from the position of the observer. <br><br>  Imagine any closed volumetric shape: each of its faces has two sides.  And one of these parties will be turned to the observer, and the other from him.  What if we draw only the faces facing the observer? <br><br>  It is in this process that the essence of the procedure for cutting faces lies.  OpenGL checks all facets for orientation, allowing only those facing the observer to be rendered, and at the same time cutting off those that are turned from him, which ultimately saves a lot of calls to the fragment shader (which is very expensive!).  We just need to somehow convey to OpenGL information about which facets are considered to be faces and which are not.  OpenGL uses a resourceful solution to determine the orientation of faces: analysis of the traversal order in the list of vertex data. <br><br><h4>  Bypass order </h4><br>  When we specify a set of vertices for a triangle, we define them in a specific traversal order: either clockwise (clockwise, CW) or counterclockwise (counter-clockwise, CCW).  Each triangle consists of three vertices and we set them in the order of detour, defined relative to the center of the triangle. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mi/p3/fo/mip3fo9pieur1pfxdblpjjty2ug.png"></div><br>  As can be seen from the diagram, we first set vertex 1, and then we have a choice: to set vertex 2 or 3, thereby determining the order of traversing a triangle.  We give the code for clarity: <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> vertices[] = { <span class="hljs-comment"><span class="hljs-comment">//    vertices[0], //  1 vertices[1], //  2 vertices[2], //  3 //    vertices[0], //  1 vertices[2], //  3 vertices[1] //  2 };</span></span></code> </pre> <br>  Each set of three vertices defining a triangle, as a result, contains data on the order of its traversal.  When rendering the primitives you have prepared, OpenGL uses this information to determine whether the next triangle is facial or not.  By default, triangles with counterclockwise order are considered frontal. <br><br>  When specifying a traversal in your set of vertices, you must represent the triangle as if you are looking directly at it, and you specify the vertices in counterclockwise order.  The most interesting thing in this imaginary process is that the direct processing of the traversal order occurs at the rasterization stage, i.e.  after running the vertex shader.  This means that the vertices are indeed transformed to the point of view of the observer. <br><br>  It turns out that all the vertices of the triangles, which the observer looks at, are really set in the same order as we walked around them.  But at the same time the vertices of the triangles on the other side of the cube are now displayed in such a way that their traversal order has become inverted.  As a result, the triangles in front of the observer are considered to be facial, and the far triangles are considered to be non-face.  Look at the image for better visibility: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/u8/ub/7k/u8ub7kgf5_mh58wfg-5h607utog.png"></div><br>  In the list of vertices, we defined both triangles in counterclockwise order (the near triangle is specified as 1-2-3, and the back one is also defined as 1-2-3 (if the observer looked at his front side)).  However, from this position, the order of the description of the far triangle 1-2-3 is observed given in a clockwise direction.  Despite the fact that the vertices of the far triangle were set with the counterclockwise order, when rendering it became clockwise.  And this behavior is just necessary for successful cutting off invisible faces. <br><br><h4>  Rejection of faces </h4><br>  At the beginning of the lesson, it was noted that OpenGL can cut off triangles if they are displayed as non-face.  And now, knowing about the method of specifying the traversal order, we can begin to use the clipping function, which is disabled by default in the library. <br>  The vertex data for the cube from past lessons was not formed with the counterclockwise order requirements, so you need a new array of vertices that lies <a href="https://learnopengl.com/code_viewer.php%3Fcode%3Dadvanced/faceculling_vertexdata">here</a> .  Practice - try to mentally check the order of traversal of each triangle. <br><br>  You can enable the clipping function as follows: <br><br><pre> <code class="cpp hljs">glEnable(GL_CULL_FACE);</code> </pre> <br>  From this point on, all non-face faces will be dropped (try looking inside the cube and make sure that the surfaces of the inner faces are dropped).  As a result, we save more than 50% of the passes of processing fragments, but only for such closed figures as a cube.  In the previous lesson, we would have to turn off the clipping of faces for objects depicting grass, since they must have both front and non-face faces drawn. <br><br>  OpenGL allows us to configure exactly which side of the face we would like to drop.  Suddenly we need to reject the face edge?  To do this, you can use the following call: <br><br><pre> <code class="cpp hljs">glCullFace(GL_FRONT);</code> </pre> <br>  The function has three possible parameters: <br><br>  ‚Ä¢ <b>GL_BACK</b> : Rejects only non-faces. <br>  ‚Ä¢ <b>GL_FRONT</b> : <b>Drops</b> only the front edges. <br>  ‚Ä¢ <b>GL_FRONT_AND_BACK</b> : <b>Rejects</b> both faces. <br><br>  The default is <b>GL_BACK</b> . <br><br>  In addition to choosing a face for dropping, it would be nice to be able to specify which order of traversal in a triangle will determine the front face.  To do this, use the following function: <br><br><pre> <code class="cpp hljs">glFrontFace(GL_CCW);</code> </pre> <br>  The default is <b>GL_CCW</b> , implying a counterclockwise crawl.  The second possible value is <b>GL_CW</b> , which sets the clockwise round. <br><br>  As a simple experiment, you can set the clipping of non-face faces and the clockwise traversal order as specifying the front faces, instead of the standard counterclockwise traversal: <br><br><pre> <code class="cpp hljs">glEnable(GL_CULL_FACE); glCullFace(GL_BACK); glFrontFace(GL_CW);</code> </pre> <br>  As a result, only the rear faces of the cube will remain visible: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jk/mv/mg/jkmvmgc_a0ndw0jyrywqj9yr6oa.png"></div><br>  Conversely, this effect can be achieved by cutting off the front faces, but using the counterclockwise bypass as a defining front edge: <br><br><pre> <code class="cpp hljs">glEnable(GL_CULL_FACE); glCullFace(GL_FRONT); glFrontFace(GL_CW);</code> </pre> <br>  Summing up, we can say that the mechanism for cutting off edges is an excellent tool for increasing productivity, which requires little effort to work.  In addition, you only need to keep track of to which objects in the scene it is beneficial to apply clipping, and for which clipping is unacceptable. <br><br><h4>  Exercises </h4><br>  Try to override the data in the list of vertices so that each triangle is now defined in clockwise order?  Display the scene when defining the face triangles as described clockwise. <br><br>  The solution is <a href="https://learnopengl.com/code_viewer.php%3Fcode%3Dadvanced/faceculling-exercise1">here</a> . <br><br>  <b>PPS</b> : We have a <a href="https://t.me/joinchat/Cpb05A46UPpMWdNVVCb4Vg">telegram-konf</a> to coordinate transfers.  If there is a desire to fit into the cycle, then you are welcome! </div><p>Source: <a href="https://habr.com/ru/post/346964/">https://habr.com/ru/post/346964/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346954/index.html">Inventory (business *) processes through updating job descriptions in the interests of information security</a></li>
<li><a href="../346956/index.html">How to speed up site loading: 7 optimization tips for beginners</a></li>
<li><a href="../346958/index.html">Using Intel Movidius for Neural Networks</a></li>
<li><a href="../346960/index.html">How to start developing universal applications with the Next.js library</a></li>
<li><a href="../346962/index.html">Available AI for any company: Cloud AutoML</a></li>
<li><a href="../346966/index.html">(Non) security monitoring systems: NagiosXI</a></li>
<li><a href="../346968/index.html">‚ÄúKnowledge Day‚Äù for AI: published by the TOP30 of the most impressive machine learning projects over the past year (v.2018)</a></li>
<li><a href="../346970/index.html">Automatic update and backup 1C using powershell</a></li>
<li><a href="../346972/index.html">Open class lesson on group work</a></li>
<li><a href="../346974/index.html">How to hack a switched off computer or execute code in Intel ME</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>