<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Myself DynDNS or Managed DNS implementation via PowerShell</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Outside are beautiful sunny days, so I spent most of my time outside my house with a wide channel, and somewhere in the park with a netbook and 4g mod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Myself DynDNS or Managed DNS implementation via PowerShell</h1><div class="post__text post__text-html js-mediator-article">  Outside are beautiful sunny days, so I spent most of my time outside my house with a wide channel, and somewhere in the park with a netbook and 4g modem.  This is undoubtedly better for my health, but, nevertheless, I still want to download large files, so I had to find options for ways to organize access to my home network from outside.  I will note right away that my provider gives out to its users <i>dynamic white</i> IPv4 addresses (fortunately, with the commissioning of IPv6, the need for such perversions will automatically disappear). <br><a name="habracut"></a><br>  The tasks before me are: <br><br><ol><li>  Access to all computers on the network </li><li>  Support all protocols </li><li>  Ease of use </li></ol><br>  A word about the structure of my home network: <br>  Computers (Win 7 + Win XP) -&gt; Router (ZyXEL Keenetic 4G (firmware v2.00)) -&gt; L2TP VPN -&gt; Internet. <br><br>  Several options are available for organizing access of this kind: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  VPN by type <a href="https://secure.logmein.com/RU/products/hamachi/">LogMeIn Hamachi</a> </li><li>  Services dynamic DNS + probros ports on the router </li><li>  Bicycle: transfer of external IP to the outside + port forwarding on the router </li></ol><br><br>  In the process of consideration, the first option was dropped almost immediately, since it is not free, and it also gives access only to devices in general to all those added to the network, which does not add convenience. <br><br>  The second option was no longer after a longer review, during which some flaws appeared: <br><br><ul><li>  Access to only one computer </li><li>  Access is provided not by an appeal to IP, but through a frame, which greatly reduces the possibilities of using </li><li>  It is possible to redirect only HTTP, which is not good </li></ul><br>  Only the third option remains, which means we will fence our solution for our tasks. <br><br>  To do this, you need to: first, find out the current external IP, secondly, transfer it somewhere outside, and finally - transfer the packets through home NAT.  If you can handle the last task with the tools that each router has, then it‚Äôs already more difficult to deal with the first two. <br><br>  So, after some hesitation, it was decided to use PowerShell, which is a built-in tool in Windows 7/8, to create the script, it can be installed in XP or Vista. <br><br>  To get the external address, the site <a href="http://myip.ru/">myip.ru was used</a> , the output of which was understood by regexp: <br><br> <code>$ipsite = (new-object net.webclient).DownloadString("http://myip.ru") <br>  <br> if ($ipsite -cmatch '(?s)([0-9]{1,3}?\.[0-9]{1,3}?\.[0-9]{1,3}?\.[0-9]{1,3}?)') { <br> $ip = $matches[1] <br> } else { <br> Write-Error "Cannot get ip!"; return <br> } <br></code> <br><br>  Now that we know our IP address, we need to transfer it to the outside.  For this, after some deliberation, I decided to use Dropbox.  But there is one problem with its use: I wanted to create an html file that contained links to the necessary resources of my home network, but Dropbox does not show html created from Russia (from Russian IP).  After some searching, it turned out that he gave himself quite xhtml files, so all that was left was to override the template and add it to the script. <br><br>  The final version of the script is presented by <a href="http://pastebin.com/Ea9U067j">reference</a> . <br><br>  To run the script automatically, the standard task scheduler is used, which runs the script every 10 minutes.  The file should be saved in the Public folder or its subfolders. <br><br>  In order to simplify access to this file, and not memorize a long link to it, I used bit.ly and created there a bitmark with a memorable address. </div><p>Source: <a href="https://habr.com/ru/post/146079/">https://habr.com/ru/post/146079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146071/index.html">The simplest WDM driver</a></li>
<li><a href="../146074/index.html">Basic principles of working with the Catalyst MVC Framework</a></li>
<li><a href="../146076/index.html">Inferno Part 0: namespaces</a></li>
<li><a href="../146077/index.html">Formation of high-level signs using a large-scale learning experiment without a teacher</a></li>
<li><a href="../146078/index.html">What are the most promising new gTLDs?</a></li>
<li><a href="../146080/index.html">ASM to Unix</a></li>
<li><a href="../146081/index.html">ABBYY Cup: Debriefing</a></li>
<li><a href="../146082/index.html">Russian audio card: my attempt at production and crowdfunding</a></li>
<li><a href="../146083/index.html">Novice developers: the history of one bug, or for what you can not like the new version of iOS</a></li>
<li><a href="../146086/index.html">The Android Energy Management API can cause increased consumption</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>