<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 19: Windows Defender launches someone else's code, a Trojan was in HandBrake, phishers attacked Gmail users</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Spring was generous with holes of an apocalyptic scale, and in the most unexpected places. This time it's not a smartphone, and not a router, but much...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 19: Windows Defender launches someone else's code, a Trojan was in HandBrake, phishers attacked Gmail users</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/5aa/47d/dc4/5aa47ddc495f459983b63c32d20a0758.jpg" width="300" align="right">  Spring was generous with holes of an apocalyptic scale, and in the most unexpected places.  This time it's not a smartphone, and not a router, but much worse - Microsoft Malware Protection Engine.  This component is used by Windows Defender and is enabled by default in Windows 8, 8.1, 10, as well as in Windows Server 2016. <br><br>  This time, Google has distinguished itself: researchers from Google Project Zero Tavis Ormandi and Natalie Silvanovich <a href="https://threatpost.com/wormable-windows-zero-day-reported-to-microsoft/125513/">found a</a> 'crazy bad' vulnerability.  Ormandy hurried to <a href="https://twitter.com/taviso/status/860679110728622080">tweet</a> about it, saying that this is the worst vulnerability of remote code execution in Windows lately - and, of course, generated a lot of sensational headers.  Developers from Microsoft rushed to close the hole, like sailors to storm the Winter, and three days later the patch was ready.  Ormandy, who courageously kept all the details with himself, burst <a href="https://bugs.chromium.org/p/project-zero/issues/detail%3Fid%3D1252%26desc%3D5">into</a> relief with a <a href="https://bugs.chromium.org/p/project-zero/issues/detail%3Fid%3D1252%26desc%3D5">bugreport</a> . <br><a name="habracut"></a><br>  What it turned out.  Malware Protection Engine (MsMpEng) with its, in general, limitless possibilities, was available remotely through several different Windows services, in particular, Exchange and IIS.  The bottom line is that MsMpEng rightfully controls all actions related to the file system, and if a service tries to write something similar to JavaScript to disk, the threat level with heuristic methods is determined by the NScript component, which is a surprise!  - does not run in a sandbox and with a high level of rights.  And, of course, in this component, there was an evil bug that allows the cunning script to force NScript to execute arbitrary code. <br><br>  The most fun, of course, is the attack scripts.  It turned out that it is enough to receive a letter (and you don‚Äôt even need to open it!), Click on the link, or, for example, get the file through some instant messenger, so that the malicious code can be executed on the computer.  It is as if the censor, stripping out his duty as anti-government sedition from a newspaper, after reading, believed in revolutionary ideas and joined the ranks of the Carbonari.  Such is the unexpected heuristics. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Then it would be possible to scare, but no longer want.  And so it is clear that this is bad.  The update from Microsoft, in theory, should already spread over all systems connected to the Internet, administrators who have fenced their networks with firewalls should take care of themselves.  Fortunately, there are enough security solutions on the market. <br><br>  <b>HandBrake was infected with Mac malware</b> <br><br>  <a href="https://threatpost.com/handbrake-for-mac-compromised-with-proton-spyware/125518/">News</a>  If you never, ever download programs from suspicious places, always check websites for authenticity and log in strictly on https, and finally, you are a Mac user - you are reliably protected from malware, no other precautions are needed. <br><br>  That's all wrong!  The guys from the dark side are not done with a finger, and they earn their living by this craft, so they will always find a way to ruin the life of an innocent user.  Yes, you only look at the incident with the HandBrake open source video encoder!  If you downloaded its Mac OS X version from the manufacturer‚Äôs site somewhere between May 2 and 6, and installed it without any chance, you <a href="https://forum.handbrake.fr/viewtopic.php%3Ff%3D33%26t%3D36364">infected</a> your Mac with these very hands.  But not 100%, the mirror turned out to be compromised, not the main file hosting. <br><br>  Inside the distribution was RAT, a Proton Trojan that tracks all activity in the victim‚Äôs system, including keystrokes, file downloads, and screen status.  Proton, by the way, like the recent OSX / Dok, turned out to be signed by the real signature of the Apple developer. <br>  How clever hackers cracked the file mirror of HandBrake - not reported, but in general this is not the focus, there are a lot of ways, starting with the banal phishing attack on the admin.  The main thing is that this can happen again with almost any site, no matter how authoritative the owner is. <br><br>  If you hit the number of those who downloaded the transcoder on specified days, participants of the HandBrake project advise checking the checksums of the SHA1 and SHA256 distribution file before launch, if you have already installed it, take a look at the activity_agent process - if it is in the system, then this is IT.  Demolish, treat, change passwords. <br><br>  <b>Millions of Google Docs users have experienced a phishing attack</b> <br><br>  <a href="https://threatpost.com/1-million-gmail-users-impacted-by-google-docs-phishing-attack/125436/">News</a>  Earlier this week, a massive phishing attack swept Google‚Äôs users.  It was organized very simply: letters were sent to the victims, which stated that someone, and in many cases this person from the victim‚Äôs contact list, wanted to share documents in the Google Account to the recipient.  If a curious recipient clicked on the 'Open in Docs' button, the Google OAUTH authorization service page opened.  The real, without cheating. <br><img src="https://habrastorage.org/web/3d7/4eb/439/3d74eb4393ec4c2ab23e06b5b5d2eea7.png"><br>  Here only this service serves to issue access to external services to your Google account.  The login and password, of course, is not given to the outside - if the user allows access, an authorization token is transmitted to the external service that is valid to perform certain actions on behalf of the user.  In this case, the external service was called 'Google Docs', and he demanded rights to manage contacts, read and send emails, and manage email. <br><br>  There are no complaints to OAUTH here - the service wrote in big letters what people want from Google Docs.  But who reads such warnings?  While thinking about why the Google service asks for access to Gmail, it would not hurt. <br><br>  In any case, the attack, according to Google, was stopped within an hour, during which malicious spam managed to get a measly 0.1% of Gmail users.  However, Google itself declares a billion active users, so it turns out that a million of them could potentially become victims of an attack.  How many people click without reading, we will not know - but there are definitely a lot of such. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right"><h3>  Antiquities </h3><br>  "VFSI" <br><br>  Nonresident dangerous virus.  Typically infects .COM files when an infected file is run.  Depending on the current time, it can decipher and display the phrase: ‚ÄúHELLO !!!  HAPPY DAY and success from virus 1.1VFSI-Svistov ‚Äù. <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 93.</i> <br><br>  <i><strong>Disclaimer:</strong> This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/328540/">https://habr.com/ru/post/328540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328530/index.html">Why don't you answer my question?</a></li>
<li><a href="../328532/index.html">Heisenbag 2017 Piter: Call for Testing</a></li>
<li><a href="../328534/index.html">Video shooting training with a mentor</a></li>
<li><a href="../328536/index.html">Voting started for YiiConf reports</a></li>
<li><a href="../328538/index.html">Ransomware day: Wana Decrypt0r mass infection</a></li>
<li><a href="../328542/index.html">About memory, tags and coherence</a></li>
<li><a href="../328544/index.html">Introducing 3CX V15.5 Beta</a></li>
<li><a href="../328546/index.html">Telegram of your business</a></li>
<li><a href="../328548/index.html">Get to know WannaCry</a></li>
<li><a href="../328550/index.html">Organizing a large project on the Zend Framework 2/3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>