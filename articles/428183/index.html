<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implementation of the Levenberg-Marquardt algorithm for optimizing neural networks on TensorFlow</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is a tensial for the TensorFlow library. Consider it a little deeper than in the articles about the recognition of handwritten numbers. This is a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implementation of the Levenberg-Marquardt algorithm for optimizing neural networks on TensorFlow</h1><div class="post__text post__text-html js-mediator-article"><p>  This is a tensial for the TensorFlow library.  Consider it a little deeper than in the articles about the recognition of handwritten numbers.  This is a tutorial on optimization techniques.  Quite without mathematics is not enough.  It's okay if you completely forget it.  Recall.  There will be no formal evidence and complex conclusions, only the necessary minimum for an intuitive understanding.  For a start, a little background on how this algorithm can be useful in optimizing a neural network. </p><br><img src="https://habrastorage.org/webt/ka/vv/kh/kavvkhi2wic8-bj1_-6i4zjvkpe.jpeg"><br><br><p>  Six months ago, a friend asked me to show how to make a neural network in Python.  His company produces instruments for geophysical measurements.  Several different probes measure the set of signals associated with the parameters of the surrounding environment during the drilling process.  In some difficult cases, the parameters of the medium can be accurately calculated from the signals for a long time even on a powerful computer, and it is necessary to interpret the results of measurements in the field.  There was an idea to count several hundred thousand cases on a cluster, and to train a neural network on them.  Since the neural network works very quickly, it can be used to determine parameters that are consistent with the measured signals, right during the drilling process.  Details are in the article: </p><br><p>  Kushnir, D., Velker, N., Bondarenko, A., Dyatlov, G., &amp; Dashevsky, Y. (2018, October 29).  Real-Time Simulation of the 2D Azimuthal Resistivity Resistance Tool for 2D Fault Model Using Neural Networks (Russian).  Society of Petroleum Engineers.  doi: 10.2118 / 192573-RU </p><br><p>  One evening I showed how keras implement a simple neural network, and a friend at work started training on counted data.  A couple of days discussed the result.  From my point of view, he looked promising, but a friend said that he needed calculations with the accuracy of the instrument.  And if the <em>mean square error</em> ( <em>mean squared error</em> ) turned out to be in area 1, then 1e-3 was needed.  3 orders less.  A thousand times. </p><a name="habracut"></a><br><p>  Experiments with the neural network architecture, data normalization, optimization approaches yielded almost nothing.  A couple of weeks a friend called and said that he installed MatLab and solved the problem using the <em>Levenberg-Marquardt</em> method (hereinafter we will call <em>LM</em> ).  It was optimized for a long time (several days), did not work on the GPU, but the result was correct.  It sounded like a challenge. </p><br><p>  A quick search for a ready-made LM optimizer for keras or TensorFlow did not work.  I came across only the pyrenn library, but its functionality seemed poor to me.  Decided to implement independently.  At first glance, everything looked simple, and two evenings should have been enough.  Carried longer.  There were two problems: </p><br><ol><li>  TensorFlow.  A lot of articles, but almost all of the level "but let's write <s>hello world</s> handwritten digits recognition." </li><li>  Maths.  I have forgotten a lot, but the authors of mathematical articles do not care at all about people like me: solid formulas without explanations, ‚Äúobvious!‚Äù And so on. </li></ol><br><p>  As a result, I wrote an article for those who have forgotten math and want to understand TensorFlow a little deeper, but without hardcore.  The article has a lot of text and little code.  The reverse option, when there is little text and a lot of code, is here <a href="https://github.com/empathy87/nn-samples/blob/master/tf/LevenbergMarquardt/%255BTutorial%255D%2520Levenberg-Marquardt.ipynb">Jupyter Notebook Levenberg-Marquardt</a> . </p><br><h4>  Get to know Rosenbrock's function </h4><br><p>  The training data will be generated <em>by the Rosenbrock function</em> , which is often used as a reference test of optimization algorithms: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-13"><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-15" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-23" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-24"><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-26" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.05ex" height="3.021ex" viewBox="0 -987.6 13368.8 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="1512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-79" x="1957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="2455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-3D" x="3122" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="4178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-61" x="4568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2212" x="5319" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="6320" y="0"></use><g transform="translate(6893,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2B" x="7958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-62" x="8959" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="9389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-79" x="9778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2212" x="10498" y="0"></use><g transform="translate(11498,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-32" x="809" y="583"></use></g><g transform="translate(12525,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> f (x, y) = (a-x) ^ 2 + b (y-x ^ 2) ^ 2 </script></p><br><img src="https://habrastorage.org/webt/cr/by/_v/crby_vv7ldxutqj5dxfaehtfnlk.jpeg"><br><br><p>  What is she good at? </p><br><ul><li>  Beautiful schedule.  Rosenbrock <i>'s banana function is</i> called Rosenbrock valley and untranslatable. </li><li>  The global minimum is inside a long, narrow, parabolic flat valley.  Finding a valley is trivial, and a global minimum is difficult. </li><li>  There is a multi-dimensional option.  To come up with a good function of many variables is not so simple. </li></ul><br><p>  We will start writing code with it by connecting the necessary libraries for further work: </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> math <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rosenbrock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, a, b)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a - x)**<span class="hljs-number"><span class="hljs-number">2</span></span> + b*(y - x**<span class="hljs-number"><span class="hljs-number">2</span></span>)**<span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br><h4>  We formulate the problem </h4><br><p>  Since we were talking about a measuring device, let's continue using the analogy.  Our device in the fictional world can measure coordinates <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.328ex" height="2.66ex" viewBox="0 -832 2294.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-79" x="1407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="1904" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> (x, y) </script>  and height <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> z </script>  .  Physicists studied the world and said: " <em>Yes, it's Rosenbrock! Knowing the coordinates, you can accurately calculate the height, you do not need to measure it.</em> "  In other words, scientists gave us a model. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.947ex" height="2.66ex" viewBox="0 -832 10741.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-7A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-3D" x="746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-72" x="1802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6F" x="2254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-73" x="2739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-65" x="3209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6E" x="3675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-62" x="4276" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-72" x="4705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6F" x="5157" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-63" x="5642" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6B" x="6076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="6597" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="6987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="7559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-79" x="8004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="8502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-61" x="8947" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="9476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-62" x="9922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="10351" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> z = rosenbrock (x, y, a, b) </script>  which depends on the parameters <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.071ex" height="2.66ex" viewBox="0 -832 2183.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-61" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="919" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-62" x="1364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="1793" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> (a, b) </script>  .  These parameters, though constant in the fictional world, are unknown.  They need to find. </p><br><p>  We conducted a series of experiments that gave <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.455ex" viewBox="0 -520.7 878.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> m </script>  points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-77" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-83" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-87" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-91" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-101" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-109" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.836ex" height="2.66ex" viewBox="0 -832 17151.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-31" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="1415" y="0"></use><g transform="translate(1861,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-31" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="2805" y="0"></use><g transform="translate(3250,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-31" x="658" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="4170" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="4559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="5004" y="0"></use><g transform="translate(5394,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-32" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="6420" y="0"></use><g transform="translate(6865,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-32" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="7810" y="0"></use><g transform="translate(8255,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-32" x="658" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="9174" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="9564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2E" x="10009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2E" x="10454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2E" x="10899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="11344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="11790" y="0"></use><g transform="translate(12179,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6D" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="13473" y="0"></use><g transform="translate(13918,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6D" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="15130" y="0"></use><g transform="translate(15575,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6D" x="658" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="16762" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> (x_1, y_1, z_1), (x_2, y_2, z_2), ..., (x_m, y_m, z_m) </script>  : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># (2.5, 2.5) -   ,  ,     data_points = np.array([[x, y, rosenbrock(x, y, 2.5, 2.5)] for x in np.arange(-2, 2.1, 2) for y in np.arange(-2, 2.1, 2)]) m = data_points.shape[0]</span></span></code> </pre> <br><p>  The first way to optimize is to try to guess the parameters.  Let's use the Numpy library: </p><br><pre> <code class="python hljs">x, y = data_points[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], data_points[:, <span class="hljs-number"><span class="hljs-number">1</span></span>] z = data_points[:, <span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-comment"><span class="hljs-comment">#   =5  b=5? a_guess, b_guess = 5., 5. #  -hat   ,   , #   ,   ,   .   #     ^   - # .    hat. z_hat = rosenbrock(x, y, a_guess, b_guess)</span></span></code> </pre> <br><p>  How to understand how wrong we are?  Calculate <em>residuals</em> - the size of the errors. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.455ex" viewBox="0 -520.7 878.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> m </script>  points give <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.04ex" height="1.455ex" viewBox="0 -520.7 878.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> m </script>  residuals - need an integral indicator.  Let us square each residual and calculate the average: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">E</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">a</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">b</span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-125">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">c</span><span class="MJXp-mrow" id="MJXp-Span-130"><span class="MJXp-mn" id="MJXp-Span-131">1</span></span><span class="MJXp-mrow" id="MJXp-Span-132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">m</span></span><span class="MJXp-mtext" id="MJXp-Span-134">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">u</span><span class="MJXp-msubsup" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">m</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">i</span><span class="MJXp-mo" id="MJXp-Span-141">=</span><span class="MJXp-mn" id="MJXp-Span-142">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-145" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-148" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">t</span><span class="MJXp-mrow" id="MJXp-Span-159"><span class="MJXp-msubsup" id="MJXp-Span-160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-162" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">i</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-164"><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-166" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="48.396ex" height="3.262ex" viewBox="0 -987.6 20836.9 1404.6" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-53" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-45" x="1697" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="2461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-61" x="2851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="3380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-62" x="3825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="4255" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-3D" x="4922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-66" x="6228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-72" x="6779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-61" x="7230" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-63" x="7760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-31" x="8193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6D" x="8694" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-73" x="9822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-75" x="10292" y="0"></use><g transform="translate(10864,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6D" x="1242" y="499"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="12991" y="0"></use><g transform="translate(13381,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-69" x="658" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2212" x="14413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-77" x="15664" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-69" x="16380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-64" x="16726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-65" x="17249" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-68" x="17716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-61" x="18292" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-74" x="18822" y="0"></use><g transform="translate(19183,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-69" x="658" y="-213"></use></g><g transform="translate(19993,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> MSE (a, b) = \ frac {1} {m} \ sum_ {i = 1} ^ {m} (z_ {i} - \ widehat {z_ {i}}) ^ 2 </script></p><br><p>  Such a measure of proximity is called the <em>mean square error</em> ( <em>mean squared error</em> , hereinafter referred to as <em>mse</em> ): </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># r - residuals () r = z - z_hat # mse loss = np.mean(r**2) print(loss)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: 3868.2291666666665</code> </pre> <br><p>  Minimizing <em>mse</em> , we solve the <em>problem of least squares</em> ( <em>nonlinear squares minimization</em> ): </p><br><img src="https://habrastorage.org/webt/lt/qk/su/ltqksu80eo7y4h91xedhj8w0djy.png"><br><p>  It is seen that the parameters did not guess at all. </p><br><h4>  We formulate the problem on TensorFlow </h4><br><p>  The model has the form <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">z</span><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">k</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">x</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">y</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">a</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">b</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.947ex" height="2.66ex" viewBox="0 -832 10741.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-7A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-3D" x="746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-72" x="1802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6F" x="2254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-73" x="2739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-65" x="3209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6E" x="3675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-62" x="4276" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-72" x="4705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6F" x="5157" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-63" x="5642" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-6B" x="6076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="6597" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="6987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="7559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-79" x="8004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="8502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-61" x="8947" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="9476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-62" x="9922" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="10351" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> z = rosenbrock (x, y, a, b) </script>  .  We bring it to mind <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">y</span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">f</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">x</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">p</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.875ex" height="2.66ex" viewBox="0 -832 4682.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-66" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-28" x="2382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-78" x="2771" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-2C" x="3344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMATHI-70" x="3789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/428183/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiUvwlGJ3WZcW5A1SsP8X32EUldZw#MJMAIN-29" x="4292" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> y = f (x, p) </script>  (usually mathematicians write <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-198"><span class="MJXp-mtext" id="MJXp-Span-199">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ beta </script>  instead <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> p </script>  , but programmers do not use beta).  Now the model has the form <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">y</span><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">k</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">x</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">p</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> y = rosenbrock (x, p) </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> y </script>  - height, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> x </script>  - the <em>vector of</em> coordinates of two elements (components), and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> p </script>  - <em>vector of</em> parameters. </p><br><p>  Programmers often think of vectors as one-dimensional arrays.  This is not entirely correct.  An array of numbers is a means of <em>representing a</em> vector.  You can represent a vector by an array of dimension <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> N </script>  two-dimensional array <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-232"><span class="MJXp-mn" id="MJXp-Span-233">1</span><span class="MJXp-mtext" id="MJXp-Span-234">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> 1 \ times N </script>  and even an array <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">N</span><span class="MJXp-mtext" id="MJXp-Span-243">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">s</span><span class="MJXp-mn" id="MJXp-Span-249">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> N \ times 1 </script>  in cases when the fact that the vector is a <em>column</em> vector is important (for example, to multiply the matrix by it): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-250"><span class="MJXp-mtext" id="MJXp-Span-251">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">n</span><span class="MJXp-mrow" id="MJXp-Span-257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-267" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mspace" id="MJXp-Span-268" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-269">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">s</span><span class="MJXp-mspace" id="MJXp-Span-275" style="width: 0em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-278" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mtext" id="MJXp-Span-279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">d</span><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">x</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> \ begin {bmatrix} x_1 \\\ vdots \\ x_N \ end {bmatrix} </script></p><br><p>  TensorFlow uses the notion of <em>tensor</em> .  <em>A tensor</em> , like an array, can be one-dimensional (to represent a <em>vector</em> ), two-dimensional (for a <em>matrix</em> or a <em>column vector</em> ), and any higher dimension. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ('placeholder' ,    #      ) x = tf.placeholder(tf.float64, shape=[m, 2]) y = tf.placeholder(tf.float64, shape=[m]) #   ('variable' ,    ) #     (5, 5) p = tf.Variable([5., 5.], dtype=tf.float64) #  y_hat = rosenbrock(x[:, 0], x[:, 1], p[0], p[1]) #  r = y - y_hat # mse (mean squared error) loss = tf.reduce_mean(r**2)</span></span></code> </pre> <br><p>  The code on TensorFlow does not differ in form from the code on Numpy.  The content is huge.  The Numpy code calculates <em>the</em> mse <em>value</em> .  The code on TensorFlow does not perform any calculations at all; it forms a <em>dataflow graph</em> ( <em>dataflow graph</em> ) that <em>can calculate</em> mse.  A very enduring brain is the work of the <em>rosenbrock</em> function.  We use it in both cases.  But when we pass Numpy arrays, it performs calculations using the formula and returns numbers.  And when we transfer tensors TensorFlow, it forms a <em>subgraph of the data stream</em> and returns its <em>edge</em> ( <em>edge</em> ) in the form of a tensor.  The wonders of polymorphism, but do not abuse them: </p><br><img src="https://habrastorage.org/webt/cw/6u/nz/cw6unzjtqsl_uvl3auasc-x46zq.jpeg"><br><p>  Due to the presence of such a data flow graph, TensorFlow, in particular, is able to calculate <em>derivatives</em> automatically (using <em>reverse mode automatic differentiation</em> ). </p><br><p>  Minute math.  Blocks "for those who have forgotten" will be hidden in the spoiler. </p><br><div class="spoiler">  <b class="spoiler_title">Derivative (number entered - number left)</b> <div class="spoiler_text"><p>  Most likely you remember the definition of the derivative of a scalar (number-returning) function of one variable: for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">f</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">b</span><span class="MJXp-mrow" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">R</span></span><span class="MJXp-mtext" id="MJXp-Span-303">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">w</span><span class="MJXp-mtext" id="MJXp-Span-314">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">b</span><span class="MJXp-mrow" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">R</span></span></span></span><script type="math/tex" id="MathJax-Element-23"> f: \ mathbb {R} \ rightarrow \ mathbb {R} </script>  , derivative <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">f</span></span></span><script type="math/tex" id="MathJax-Element-24"> f </script>  at the point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">x</span><span class="MJXp-mtext" id="MJXp-Span-327">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">n</span><span class="MJXp-mtext" id="MJXp-Span-330">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">b</span><span class="MJXp-mrow" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">R</span></span></span></span><script type="math/tex" id="MathJax-Element-25"> x \ in \ mathbb {R} </script>  is defined as: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-339"><span class="MJXp-msup" id="MJXp-Span-340"><span class="MJXp-mrow" id="MJXp-Span-341" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">f</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-343" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">x</span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-348">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">i</span><span class="MJXp-msubsup" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-353" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">h</span><span class="MJXp-mtext" id="MJXp-Span-355">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">o</span><span class="MJXp-mn" id="MJXp-Span-358">0</span></span></span><span class="MJXp-mtext" id="MJXp-Span-359">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">c</span><span class="MJXp-mrow" id="MJXp-Span-364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">f</span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">x</span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">h</span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">f</span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">x</span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">h</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-26"> {f} '(x) = \ lim_ {h \ to 0} \ frac {f (x + h) -f (x)} {h} </script></p><br><p>  Derivatives are a way to measure <i>change</i> .  In the scalar case, the derivative shows how much the function changes. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">f</span></span></span><script type="math/tex" id="MathJax-Element-27"> f </script>  , if a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">x</span></span></span><script type="math/tex" id="MathJax-Element-28"> x </script>  will change to a small value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-382"><span class="MJXp-mtext" id="MJXp-Span-383">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">n</span></span></span><script type="math/tex" id="MathJax-Element-29"> \ varepsilon </script>  : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">f</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">x</span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-399">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">n</span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-411">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">f</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">x</span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-422" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-423">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">n</span><span class="MJXp-msup" id="MJXp-Span-434"><span class="MJXp-mrow" id="MJXp-Span-435" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">f</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-437" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">x</span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-30"> f (x + \ varepsilon) \ approx f (x) + \ varepsilon {f} '(x) </script></p><br><p>  For convenience, we further denote <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">y</span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">f</span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">x</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-31"> y = f (x) </script>  and derivative <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">y</span></span></span><script type="math/tex" id="MathJax-Element-32"> y </script>  by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">x</span></span></span><script type="math/tex" id="MathJax-Element-33"> x </script>  we write as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-452"><span class="MJXp-mtext" id="MJXp-Span-453">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">c</span><span class="MJXp-mrow" id="MJXp-Span-458"><span class="MJXp-mtext" id="MJXp-Span-459">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">y</span></span><span class="MJXp-mrow" id="MJXp-Span-468"><span class="MJXp-mtext" id="MJXp-Span-469">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">x</span></span></span></span><script type="math/tex" id="MathJax-Element-34"> \ frac {\ partial y} {\ partial x} </script>  .  Such a record emphasizes that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-478"><span class="MJXp-mtext" id="MJXp-Span-479">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">c</span><span class="MJXp-mrow" id="MJXp-Span-484"><span class="MJXp-mtext" id="MJXp-Span-485">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">y</span></span><span class="MJXp-mrow" id="MJXp-Span-494"><span class="MJXp-mtext" id="MJXp-Span-495">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">x</span></span></span></span><script type="math/tex" id="MathJax-Element-35"> \ frac {\ partial y} {\ partial x} </script>  - the <i>rate of change</i> between variables <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">x</span></span></span><script type="math/tex" id="MathJax-Element-36"> x </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">y</span></span></span><script type="math/tex" id="MathJax-Element-37"> y </script>  .  More specifically, if <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">x</span></span></span><script type="math/tex" id="MathJax-Element-38"> x </script>  will change to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-510"><span class="MJXp-mtext" id="MJXp-Span-511">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">n</span></span></span><script type="math/tex" id="MathJax-Element-39"> \ varepsilon </script>  then <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">y</span></span></span><script type="math/tex" id="MathJax-Element-40"> y </script>  will change by about <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-524"><span class="MJXp-mtext" id="MJXp-Span-525">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">n</span><span class="MJXp-mtext" id="MJXp-Span-536">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">c</span><span class="MJXp-mrow" id="MJXp-Span-541"><span class="MJXp-mtext" id="MJXp-Span-542">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">y</span></span><span class="MJXp-mrow" id="MJXp-Span-551"><span class="MJXp-mtext" id="MJXp-Span-552">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">x</span></span></span></span><script type="math/tex" id="MathJax-Element-41"> \ varepsilon \ frac {\ partial y} {\ partial x} </script>  .  You can also write it like this: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-561"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">x</span><span class="MJXp-mtext" id="MJXp-Span-563">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">x</span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-576">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">x</span><span class="MJXp-mtext" id="MJXp-Span-583">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">y</span><span class="MJXp-mtext" id="MJXp-Span-595">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">w</span><span class="MJXp-mtext" id="MJXp-Span-606">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">y</span><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-615">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">c</span><span class="MJXp-mrow" id="MJXp-Span-620"><span class="MJXp-mtext" id="MJXp-Span-621">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">y</span></span><span class="MJXp-mrow" id="MJXp-Span-630"><span class="MJXp-mtext" id="MJXp-Span-631">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">x</span></span><span class="MJXp-mtext" id="MJXp-Span-640">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-42"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \ approx y + \ frac {\ partial y} {\ partial x} \ Delta x </script></p><br><p>  Reads like: "changing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">x</span></span></span><script type="math/tex" id="MathJax-Element-43"> x </script>  on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">x</span><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-652">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">x</span></span></span><script type="math/tex" id="MathJax-Element-44"> x + \ Delta x </script>  we change <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">y</span></span></span><script type="math/tex" id="MathJax-Element-45"> y </script>  at about <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">y</span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-664">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">x</span><span class="MJXp-mtext" id="MJXp-Span-671">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">c</span><span class="MJXp-mrow" id="MJXp-Span-676"><span class="MJXp-mtext" id="MJXp-Span-677">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">y</span></span><span class="MJXp-mrow" id="MJXp-Span-686"><span class="MJXp-mtext" id="MJXp-Span-687">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">x</span></span></span></span><script type="math/tex" id="MathJax-Element-46"> y + \ Delta x \ frac {\ partial y} {\ partial x} </script>  ". Such a record clearly emphasizes the connection between the change <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">x</span></span></span><script type="math/tex" id="MathJax-Element-47"> x </script>  and change <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">y</span></span></span><script type="math/tex" id="MathJax-Element-48"> y </script>  . </p></div></div><br><p>  We built the data flow graph, let's run the mse calculation: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        #      placeholder (  ) feed_dict = {x: data_points[:,0:2], y: data_points[:,2]} #       TensorFlow session = tf.Session() #     session.run(tf.global_variables_initializer()) #   ()  loss (mse) current_loss = session.run(loss, feed_dict) print(current_loss)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: 3868.2291666666665</code> </pre> <br><p>  It turned out the same result as with the Numpy.  So they were not mistaken. </p><br><h4 id="nachnyom-optimizirovat">  Let's start optimizing </h4><br><p>  Unfortunately, the parameters could not be guessed.  But then we: </p><br><ol><li>  Set the optimality criterion - the minimum value of mse. </li><li>  Identified variable parameters: vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> p </script>  with components <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> a </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> b </script>  Rosenbrock functions. </li><li>  While not thinking about the restrictions, but they are not. </li></ol><br><p>  At the last step, we constructed a data flow graph with a finite <em>loss</em> tensor ( <em>loss</em> <em>function</em> ).  The goal of optimization is to find the value of the parameter vector. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> p </script>  at which the value of the loss function is minimal.  We were lucky, the graph of this function is very simple (concave and without local minima): </p><br><img src="https://habrastorage.org/webt/vf/do/hr/vfdohrpseaocd_vpe6e7sp_6f0u.png"><br><p>  Getting to the optimization.  First, let's write a generic loop: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># :   mse,   ,  #   mse,        placeholder def train(target_loss, max_steps, loss_tensor, train_step_op, inputs): step = 0 current_loss = session.run(loss_tensor, inputs) #           while current_loss &gt; target_loss and step &lt; max_steps: step += 1 #    1, 2, 4, 8, 16...  if math.log(step, 2).is_integer(): print(f'step: {step}, current loss: {current_loss}') #    session.run(train_step_op, inputs) current_loss = session.run(loss_tensor, inputs) print(f'ENDED ON STEP: {step}, FINAL LOSS: {current_loss}')</span></span></code> </pre> <br><h4 id="optimiziruem-metodom-naiskoreyshego-gradientnogo-spuska-sgd">  Optimize with the fastest gradient descent method (SGD) </h4><br><p>  The actions of this method can be compared with the ride of a daring skier who always puts skis along the line of a falling slope (in the steepest direction down).  This takes into account only the slope at the point of location.  And if the slope is strong, then the skier flies a long distance until the next conversion.  With a weak bias, it moves in small steps.  Maybe how to fly away <del>  into a tree </del>  (the <em>algorithm diverges</em> ), and get stuck in the pit ( <em>local minimum</em> ). </p><br><img src="https://habrastorage.org/webt/oe/et/ij/oeetijkwervilr42jsjl9wsgsey.jpeg"><br><p>  You can record this way (we change <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-708"><span class="MJXp-mtext" id="MJXp-Span-709">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">l</span><span class="MJXp-mrow" id="MJXp-Span-720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> \ boldsymbol {p} </script>  on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-722"><span class="MJXp-mtext" id="MJXp-Span-723">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">l</span><span class="MJXp-mrow" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">p</span></span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> \ boldsymbol {p} - ... </script>  ): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-740"><span class="MJXp-mtext" id="MJXp-Span-741">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">l</span><span class="MJXp-mrow" id="MJXp-Span-752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">p</span></span><span class="MJXp-mtext" id="MJXp-Span-754">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">w</span><span class="MJXp-mtext" id="MJXp-Span-765">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">l</span><span class="MJXp-mrow" id="MJXp-Span-776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">p</span></span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-779">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">a</span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-786">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">l</span><span class="MJXp-msubsup" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-793" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">s</span><span class="MJXp-mo" id="MJXp-Span-799" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-800">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">l</span><span class="MJXp-mrow" id="MJXp-Span-811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">p</span></span><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-55"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p} - \ alpha [\ nabla_ {p} loss (\ boldsymbol {p})] </script></p><br><p>  Fatty <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-815"><span class="MJXp-mtext" id="MJXp-Span-816">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">l</span><span class="MJXp-mrow" id="MJXp-Span-827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> \ boldsymbol {p} </script>  emphasizes that this is the point of the actual location - the value of the vector of parameters in the current step.  In the first step, this is our guess (5, 5).  There are two interesting points in the formula: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-829"><span class="MJXp-mtext" id="MJXp-Span-830">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ alpha </script>  - <em>learning rate</em> ( <em>learning rate</em> ), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-836"><span class="MJXp-mtext" id="MJXp-Span-837">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">l</span><span class="MJXp-msubsup" id="MJXp-Span-842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-844" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> \ nabla_ {p} loss </script>  - <em>gradient of the</em> loss function for the vector of parameters. </p><br><img src="https://habrastorage.org/webt/qx/1h/em/qx1hem1cns_udmg0gucq1h9vs9k.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Gradient (vector in - number out)</b> <div class="spoiler_text"><p>  Consider a function that accepts a vector as input and gives a scalar: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">f</span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-853">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">b</span><span class="MJXp-msubsup" id="MJXp-Span-860"><span class="MJXp-mrow" id="MJXp-Span-861" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-863" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">N</span></span></span><span class="MJXp-mtext" id="MJXp-Span-865">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">w</span><span class="MJXp-mtext" id="MJXp-Span-876">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">b</span><span class="MJXp-mrow" id="MJXp-Span-883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">R</span></span></span></span><script type="math/tex" id="MathJax-Element-59"> f: \ mathbb {R} ^ {N} \ rightarrow \ mathbb {R} </script>  .  Derivative <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">f</span></span></span><script type="math/tex" id="MathJax-Element-60"> f </script>  at the point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">x</span><span class="MJXp-mtext" id="MJXp-Span-889">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">n</span><span class="MJXp-mtext" id="MJXp-Span-892">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">b</span><span class="MJXp-msubsup" id="MJXp-Span-899"><span class="MJXp-mrow" id="MJXp-Span-900" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-902" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-61"> x \ in \ mathbb {R} ^ {N} </script>  now called <i>gradient</i> and is a vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-906">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">l</span><span class="MJXp-msubsup" id="MJXp-Span-911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-913" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">f</span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">x</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-920">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">n</span><span class="MJXp-mtext" id="MJXp-Span-923">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">b</span><span class="MJXp-msubsup" id="MJXp-Span-930"><span class="MJXp-mrow" id="MJXp-Span-931" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-933" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-62"> [\ nabla_ {x} f (x)] \ in \ mathbb {R} ^ {N} </script>  (reads "nabla"), composed of <em>partial derivatives</em> ( <em>partial derivatives</em> ): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-935"><span class="MJXp-mtext" id="MJXp-Span-936">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">l</span><span class="MJXp-msubsup" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-943" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">y</span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-948">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">c</span><span class="MJXp-mrow" id="MJXp-Span-953"><span class="MJXp-mtext" id="MJXp-Span-954">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">y</span></span><span class="MJXp-mrow" id="MJXp-Span-963"><span class="MJXp-mtext" id="MJXp-Span-964">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">l</span><span class="MJXp-msubsup" id="MJXp-Span-972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-974" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-975">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-976" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-977">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">c</span><span class="MJXp-mrow" id="MJXp-Span-982"><span class="MJXp-mtext" id="MJXp-Span-983">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">y</span></span><span class="MJXp-mrow" id="MJXp-Span-992"><span class="MJXp-mtext" id="MJXp-Span-993">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">l</span><span class="MJXp-msubsup" id="MJXp-Span-1001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1003" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1004">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1005" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1007" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1009" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1010">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">c</span><span class="MJXp-mrow" id="MJXp-Span-1015"><span class="MJXp-mtext" id="MJXp-Span-1016">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1025"><span class="MJXp-mtext" id="MJXp-Span-1026">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">l</span><span class="MJXp-msubsup" id="MJXp-Span-1034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1036" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">N</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1038" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-63"> \ nabla_ {x} y = (\ frac {\ partial y} {\ partial x_ {1}}, \ frac {\ partial y} {\ partial x_ {2}}, ..., \ frac {\ partial y} {\ partial x_ {N}}) </script></p><br><p>  For this case, the record of the dependence of the change of the function on the change of the argument is as follows: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">x</span><span class="MJXp-mtext" id="MJXp-Span-1041">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">x</span><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1054">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">x</span><span class="MJXp-mtext" id="MJXp-Span-1061">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">y</span><span class="MJXp-mtext" id="MJXp-Span-1073">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">w</span><span class="MJXp-mtext" id="MJXp-Span-1084">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">y</span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1093">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">l</span><span class="MJXp-msubsup" id="MJXp-Span-1098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1100" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">y</span><span class="MJXp-mtext" id="MJXp-Span-1103">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">t</span><span class="MJXp-mtext" id="MJXp-Span-1108">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-64"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \ approx y + \ nabla_ {x} y \ cdot \ Delta x </script></p><br><p>  The record has changed quite a bit to accommodate that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">x</span></span></span><script type="math/tex" id="MathJax-Element-65"> x </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1117"><span class="MJXp-mtext" id="MJXp-Span-1118">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">x</span></span></span><script type="math/tex" id="MathJax-Element-66"> \ Delta x </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1125"><span class="MJXp-mtext" id="MJXp-Span-1126">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">l</span><span class="MJXp-msubsup" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1133" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">y</span></span></span><script type="math/tex" id="MathJax-Element-67"> \ nabla_ {x} y </script>  - vectors in <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1136"><span class="MJXp-mtext" id="MJXp-Span-1137">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">b</span><span class="MJXp-msubsup" id="MJXp-Span-1144"><span class="MJXp-mrow" id="MJXp-Span-1145" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1147" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-68"> \ mathbb {R} ^ {N} </script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">y</span></span></span><script type="math/tex" id="MathJax-Element-69"> y </script>  - scalar.  When multiplying vectors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1151"><span class="MJXp-mtext" id="MJXp-Span-1152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">l</span><span class="MJXp-msubsup" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1159" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">y</span></span></span><script type="math/tex" id="MathJax-Element-70"> \ nabla_ {x} y </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1162"><span class="MJXp-mtext" id="MJXp-Span-1163">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">x</span></span></span><script type="math/tex" id="MathJax-Element-71"> \ Delta x </script>  <i>scalar product is used</i> (the sum of the products of the components). </p></div></div><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        grad = tf.gradients(loss, p)[0] #   learning_rate = 0.0005 #   ,     apply_gradients - #         opt = tf.train.GradientDescentOptimizer(learning_rate=1) #           sgd = opt.apply_gradients([(learning_rate*grad, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, sgd, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 1381.5379689135807 [...] ENDED ON STEP: 582, FINAL LOSS: 9.698531012270816e-11 PARAMETERS: [2.50000205 2.49999959]</code> </pre> <br><p>  It took 582 steps: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b2/j3/jb/b2j3jbxzfk6_ll66vpr83vklwjs.jpeg"></div><br><div class="spoiler">  <b class="spoiler_title">Movement towards antigradient</b> <div class="spoiler_text"><p>  Why move in the opposite direction of the gradient?  Recall the scalar product entry: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">x</span><span class="MJXp-mtext" id="MJXp-Span-1172">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">x</span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1185">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">x</span><span class="MJXp-mtext" id="MJXp-Span-1192">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">y</span><span class="MJXp-mtext" id="MJXp-Span-1204">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">w</span><span class="MJXp-mtext" id="MJXp-Span-1215">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">y</span><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">l</span><span class="MJXp-msubsup" id="MJXp-Span-1229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1231" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">y</span><span class="MJXp-mtext" id="MJXp-Span-1234">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">t</span><span class="MJXp-mtext" id="MJXp-Span-1239">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">x</span></span></span><script type="math/tex" id="MathJax-Element-72"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \ approx y + \ nabla_ {x} y \ cdot \ Delta x </script>  .  Minimizing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">y</span></span></span><script type="math/tex" id="MathJax-Element-73"> y </script>  .  Since the behavior of the function is known only in a small neighborhood through the derivative, it is necessary to move in small but optimal steps, minimizing the product <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1248"><span class="MJXp-mtext" id="MJXp-Span-1249">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">l</span><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1256" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">y</span><span class="MJXp-mtext" id="MJXp-Span-1259">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">t</span><span class="MJXp-mtext" id="MJXp-Span-1264">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">x</span></span></span><script type="math/tex" id="MathJax-Element-74"> \ nabla_ {x} y \ cdot \ Delta x </script>  .  According to the school definition, the <i>scalar product of two vectors is a number equal to the product of the lengths of these vectors and the cosine of the angle between them</i> : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">a</span><span class="MJXp-mtext" id="MJXp-Span-1273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">b</span><span class="MJXp-mo" id="MJXp-Span-1279" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1280">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">t</span><span class="MJXp-mrow" id="MJXp-Span-1285"><span class="MJXp-mo" id="MJXp-Span-1286" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">a</span><span class="MJXp-mtext" id="MJXp-Span-1288">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">t</span><span class="MJXp-mrow" id="MJXp-Span-1294"><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1296">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">t</span><span class="MJXp-mrow" id="MJXp-Span-1301"><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">b</span><span class="MJXp-mtext" id="MJXp-Span-1304">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">t</span><span class="MJXp-mrow" id="MJXp-Span-1310"><span class="MJXp-mo" id="MJXp-Span-1311" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">s</span><span class="MJXp-mtext" id="MJXp-Span-1315">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">e</span><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">a</span><span class="MJXp-mo" id="MJXp-Span-1323" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">b</span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-75"> a \ cdot b = \ left | a \ right | \ left | b \ right | cos \ angle (a, b) </script>  .  For a fixed length of the vectors, this product reaches a minimum with a cosine of -1, i.e.  at an angle of 180 degrees, when the vectors are directed in opposite directions.  Accordingly, the minimum scalar product <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1326"><span class="MJXp-mtext" id="MJXp-Span-1327">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">l</span><span class="MJXp-msubsup" id="MJXp-Span-1332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1334" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">y</span><span class="MJXp-mtext" id="MJXp-Span-1337">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">t</span><span class="MJXp-mtext" id="MJXp-Span-1342">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">x</span></span></span><script type="math/tex" id="MathJax-Element-76"> \ nabla_ {x} y \ cdot \ Delta x </script>  achieved at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1349"><span class="MJXp-mtext" id="MJXp-Span-1350">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">x</span></span></span><script type="math/tex" id="MathJax-Element-77"> \ Delta x </script>  towards <i>antigradient</i> . </p></div></div><br><h4 id="optimiziruem-metodom-adam">  Optimize Adam Method </h4><br><p>  We will not further delve into the gradient methods, but there are lots of variations.  You can read about them in the article <a href="https://habr.com/post/318970/">Methods of optimization of neural networks</a> .  In TensorFlow, many optimizers are already implemented.  For example, Adam: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       , #      adm = tf.train.AdamOptimizer(15).minimize(loss) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, adm, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 34205.72916492336 [...] ENDED ON STEP: 317, FINAL LOSS: 2.424142714263483e-12 PARAMETERS: [2.49999969 2.50000008]</code> </pre> <br><p>  Coped in 317 steps.  Much faster. </p><br><h4 id="optimiziruem-metodom-nyutona">  We optimize by Newton's method </h4><br><p>  The actions of the second-order methods can be compared with the drive of a reasonable free-rider snowboarder, who thinks over the next point of his route for a long time and takes into account not only the bias at the point of location, but also the curvature. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p_/iu/kf/p_iukfzoa0idjm_cbycfmlye4mw.jpeg"></div><br><p>  In fact, both gradient descent methods and second-order methods try to guess ( <em>approximate</em> ) a function by the current point.  Gradient methods are oriented only on the <em>slope of the</em> function graph at a point ‚Äî the first derivative.  The methods of the second order except for the slope take into account the <em>curvature</em> ( <em>curvature</em> ) - the second derivative: "if the curvature remains, where will be the minimum?".  We calculate and go there: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xb/sn/nb/xbsnnb1o5cui4x10wspkrgjinaw.jpeg"></div><br><p>  To build such an approximation and calculate the estimated minimum point, you can use the <em>Taylor series</em> ( <em>Taylor series</em> ).  For the one-dimensional case, the approximation by a second-order polynomial at the point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> a </script>  looks like that: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">f</span><span class="MJXp-mo" id="MJXp-Span-1408" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">x</span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1411">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">f</span><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">a</span><span class="MJXp-mo" id="MJXp-Span-1421" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1423">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">c</span><span class="MJXp-mrow" id="MJXp-Span-1428"><span class="MJXp-msup" id="MJXp-Span-1429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1431" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">a</span><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1435" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">x</span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">a</span><span class="MJXp-mo" id="MJXp-Span-1439" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1440"><span class="MJXp-mn" id="MJXp-Span-1441">1</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0.111em; margin-right: 0em;">!</span></span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1444">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448">c</span><span class="MJXp-mrow" id="MJXp-Span-1449"><span class="MJXp-msup" id="MJXp-Span-1450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1452" style="vertical-align: 0.5em;">‚Ä≥</span></span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">a</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">x</span><span class="MJXp-mo" id="MJXp-Span-1458" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">a</span><span class="MJXp-msubsup" id="MJXp-Span-1460"><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1462" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1463"><span class="MJXp-mn" id="MJXp-Span-1464">2</span><span class="MJXp-mo" id="MJXp-Span-1465" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-79"> f (x) \ approx f (a) + \ frac {f '(a) (x-a)} {1!} + \ frac {f' '(a) (x-a) ^ 2} {2!} </script></p><br><p>  The minimum is reached at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">x</span><span class="MJXp-mo" id="MJXp-Span-1468" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">a</span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1471">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">c</span><span class="MJXp-mrow" id="MJXp-Span-1476"><span class="MJXp-msup" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1479" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1480" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">a</span><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1483"><span class="MJXp-msup" id="MJXp-Span-1484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1486" style="vertical-align: 0.5em;">‚Ä≥</span></span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">a</span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> x = a - \ frac {f '(a)} {f' '(a)} </script>  .  The multidimensional case looks more serious: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/pd/31/dvpd31r1vt2cbts_a5oamiiwgoc.jpeg"></div><br><div class="spoiler">  <b class="spoiler_title">Hesse matrix (vector entered - the number is out)</b> <div class="spoiler_text"><p>  <em>The</em> <em>Hessian matrix</em> ( <em>Hessian matrix</em> ) is a square matrix made up of second derivatives: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1490"><span class="noError" id="MJXp-Span-1491" style="display: inline-block;">\&nbsp;boldsymbol&nbsp;{H}&nbsp;y_&nbsp;{x}&nbsp;=&nbsp;\&nbsp;begin&nbsp;{bmatrix}&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_1&nbsp;^&nbsp;2}&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_1&nbsp;\&nbsp;partial&nbsp;x_2}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_1&nbsp;\&nbsp;partial&nbsp;x_N}&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_2&nbsp;\&nbsp;partial&nbsp;x_1}&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_2&nbsp;^&nbsp;2}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_2&nbsp;\&nbsp;partial&nbsp;x_N}&nbsp;\\&nbsp;\&nbsp;vdots&nbsp;&amp;&nbsp;\&nbsp;vdots&nbsp;&amp;&nbsp;\&nbsp;ddots&nbsp;&amp;&nbsp;\&nbsp;vdots&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_N&nbsp;\&nbsp;partial&nbsp;x_1}&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_N&nbsp;\&nbsp;partial&nbsp;x_2}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_N&nbsp;^&nbsp;2}&nbsp;\&nbsp;end&nbsp;{bmatrix}</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-81"> \ boldsymbol {H} y_ {x} = \ begin {bmatrix} \ frac {\ partial ^ 2y} {\ partial x_1 ^ 2} & \ frac {\ partial ^ 2y} {\ partial x_1 \ partial x_2} & \ cdots & \ frac {\ partial ^ 2y} {\ partial x_1 \ partial x_N} \\ \ frac {\ partial ^ 2y} {\ partial x_2 \ partial x_1} & \ frac {\ partial ^ 2y} {\ partial x_2 ^ 2} & \ cdots & \ frac {\ partial ^ 2y} {\ partial x_2 \ partial x_N} \\ \ vdots & \ vdots & \ ddots & \ vdots \\ \ frac {\ partial ^ 2y} {\ partial x_N \ partial x_1} & \ frac {\ partial ^ 2y} {\ partial x_N \ partial x_2} & \ cdots & \ frac {\ partial ^ 2y} {\ partial x_N ^ 2} \ end {bmatrix} </script></p></div></div><br><p>  Approximation by a second-order polynomial for a function of a vector through the gradient and the Hesse matrix at the point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> a </script>  looks like that: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">f</span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">x</span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1499">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">f</span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">a</span><span class="MJXp-mo" id="MJXp-Span-1509" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">a</span><span class="MJXp-msubsup" id="MJXp-Span-1514"><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1516" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1520">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">l</span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1526">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">l</span><span class="MJXp-msubsup" id="MJXp-Span-1531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1533" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">f</span><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">a</span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1541">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">c</span><span class="MJXp-mrow" id="MJXp-Span-1546"><span class="MJXp-mn" id="MJXp-Span-1547">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1548"><span class="MJXp-mn" id="MJXp-Span-1549">2</span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0.111em; margin-right: 0em;">!</span></span><span class="MJXp-mo" id="MJXp-Span-1551" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">a</span><span class="MJXp-msubsup" id="MJXp-Span-1554"><span class="MJXp-mo" id="MJXp-Span-1555" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1556" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">l</span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1566">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">l</span><span class="MJXp-mrow" id="MJXp-Span-1577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">H</span></span><span class="MJXp-msubsup" id="MJXp-Span-1579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1581" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1583" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">a</span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1586" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">a</span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-83"> f (x) \ approx f (a) + (xa) ^ \ intercal [\ nabla_ {x} f (a)] + \ frac {1} {2!} (xa) ^ \ intercal [\ boldsymbol {H } f_ {x} (a)] (xa) </script></p><br><p>  The minimum is reached at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">x</span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">a</span><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1597">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">l</span><span class="MJXp-mrow" id="MJXp-Span-1608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">H</span></span><span class="MJXp-msubsup" id="MJXp-Span-1610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1612" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">a</span><span class="MJXp-mo" id="MJXp-Span-1616" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1617"><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1619" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1620">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1621">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1622" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1623">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">l</span><span class="MJXp-msubsup" id="MJXp-Span-1628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1630" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">f</span><span class="MJXp-mo" id="MJXp-Span-1633" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">a</span><span class="MJXp-mo" id="MJXp-Span-1635" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1636" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> x = a - [\ boldsymbol {H} f_ {x} (a)] ^ {- 1} [\ nabla_ {x} f (a)] </script>  .  The form practically coincides with the one-dimensional case: we replaced the first derivative with a gradient, the second with the Hessian matrix, and made an amendment to work with vectors.  It is impossible to divide a vector by a matrix, therefore multiplication by an <em>inverse</em> matrix is ‚Äã‚Äãused.  <em>T</em> means <em>transpose</em> .  The formula implies that the default vector is a column.  Transposing turns <em>a column</em> <em>vector</em> into <em>a row vector</em> .  When implemented on TensorFlow, this should be taken into account, but in the opposite direction: the default vector is a string (one-dimensional tensor).  Just in case: transposition is not a 90 degree rotation, it is the transformation of rows into columns in the same order. </p><br><p>  So, the step of Newton's method is as follows: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1637"><span class="MJXp-mtext" id="MJXp-Span-1638">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">l</span><span class="MJXp-mrow" id="MJXp-Span-1649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">p</span></span><span class="MJXp-mtext" id="MJXp-Span-1651">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">w</span><span class="MJXp-mtext" id="MJXp-Span-1662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">l</span><span class="MJXp-mrow" id="MJXp-Span-1673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">p</span></span><span class="MJXp-mo" id="MJXp-Span-1675" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1677">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">l</span><span class="MJXp-mrow" id="MJXp-Span-1688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">H</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">s</span><span class="MJXp-msubsup" id="MJXp-Span-1693"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1695" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1698">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1704">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">l</span><span class="MJXp-mrow" id="MJXp-Span-1709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">p</span></span><span class="MJXp-mo" id="MJXp-Span-1711" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1712"><span class="MJXp-mo" id="MJXp-Span-1713" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1714" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1715">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1716">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1717" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1718">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">l</span><span class="MJXp-msubsup" id="MJXp-Span-1723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1725" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">s</span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1732">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">l</span><span class="MJXp-mrow" id="MJXp-Span-1743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">p</span></span><span class="MJXp-mo" id="MJXp-Span-1745" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-85"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p} - [\ boldsymbol {H} loss_ {p} (\ boldsymbol {p})] ^ {- 1} [\ nabla_ {p} loss (\ boldsymbol {p} )] </script></p><br><p>  TensorFlow has everything to implement this method: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        hess = tf.hessians(loss, p)[0] #    - grad_col = tf.expand_dims(grad, -1) # ,      dp = tf.matmul(tf.linalg.inv(hess), grad_col) #  -  - dp = tf.squeeze(dp) #  p  dp    newton = opt.apply_gradients([(dp, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, newton, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 105.04357496954218 step: 4, current loss: 9.96663526704236 ENDED ON STEP: 6, FINAL LOSS: 5.882202372519996e-20 PARAMETERS: [2.5 2.5]</code> </pre> <br><p>  Enough 6 steps: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/to/4-/eo/to4-eorewt5uoh_sdhokzqx0kuq.jpeg"></div><br><h4 id="optimiziruem-algoritmom-gaussa-nyutona">  We optimize the Gauss-Newton algorithm </h4><br><p>  In Newton's method there is one drawback - the Hesse matrix.  Thanks to TensorFlow, we can calculate it in one line of code.  According to the wiki, <em>Johann Karl Friedrich Gauss</em> made the first mention of his method in 1809.  Calculating the Hessian matrix for several parameters for the least squares method could then take a lot of time.  Now we can assume that the Gauss-Newton algorithm uses the approximation of <em>the Hessian</em> <em>matrix</em> through <em>the Jacobi matrix</em> to simplify the calculations.  But from the point of view of history, this is not so: <em>Ludwig Otto Hesse</em> (who developed the matrix named after him) was born in 1811 - 2 years after the first mention of the algorithm.  And <em>Carl Gustav Jacobi</em> was 5 years old. </p><br><p>  The Gauss-Newton algorithm does not work with the loss function.  It works with the <em>residual function.</em> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">r</span><span class="MJXp-mo" id="MJXp-Span-1749" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">p</span><span class="MJXp-mo" id="MJXp-Span-1751" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> r (p) </script>  .  This function accepts a parameter vector as input. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87"> p </script>  and returns <em>the residuals vector</em> .  In our case, the vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> p </script>  consists of 2 components (parameters <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89"> a </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90"> b </script>  Rosenbrock functions), and the vector of residuals from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91"> m </script>  component (by the number of experiments).  It turns out the vector function of the vector argument.  Its derivative is: </p><br><div class="spoiler">  <b class="spoiler_title">Jacobi Matrix (vector entered - vector left)</b> <div class="spoiler_text"><p>  Consider a function that accepts a vector as input and also produces a vector: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">f</span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-1765">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771">b</span><span class="MJXp-msubsup" id="MJXp-Span-1772"><span class="MJXp-mrow" id="MJXp-Span-1773" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1775" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">N</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1777">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">w</span><span class="MJXp-mtext" id="MJXp-Span-1788">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">b</span><span class="MJXp-msubsup" id="MJXp-Span-1795"><span class="MJXp-mrow" id="MJXp-Span-1796" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1798" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">M</span></span></span></span></span><script type="math/tex" id="MathJax-Element-92"> f: \ mathbb {R} ^ {N} \ rightarrow \ mathbb {R} ^ {M} </script>  .  Derivative <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">f</span></span></span><script type="math/tex" id="MathJax-Element-93"> f </script>  at the point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1803">x</span></span></span><script type="math/tex" id="MathJax-Element-94"> x </script>  now has size <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">N</span><span class="MJXp-mtext" id="MJXp-Span-1806">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">M</span></span></span><script type="math/tex" id="MathJax-Element-95"> N \ times M </script>  , is called <i>the Jacobi matrix</i> , and consists of all combinations of partial derivatives: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1813"><span class="noError" id="MJXp-Span-1814" style="display: inline-block;">\&nbsp;boldsymbol&nbsp;{J}&nbsp;y_&nbsp;{x}&nbsp;=&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;y_&nbsp;{1}}&nbsp;{\&nbsp;partial&nbsp;x_&nbsp;{1}}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;y_&nbsp;{1}}&nbsp;{\&nbsp;partial&nbsp;x_&nbsp;{N}}&nbsp;\\&nbsp;\&nbsp;vdots&nbsp;&amp;&nbsp;\&nbsp;ddots&nbsp;&amp;&nbsp;\&nbsp;vdots&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;y_&nbsp;{M}}&nbsp;{\&nbsp;partial&nbsp;x_&nbsp;{1}}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;y_&nbsp;{M}}&nbsp;{\&nbsp;partial&nbsp;x_&nbsp;{N}}&nbsp;\&nbsp;end&nbsp;{pmatrix}</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-96"> \ boldsymbol {J} y_ {x} = \ begin {pmatrix} \ frac {\ partial y_ {1}} {\ partial x_ {1}} & \ cdots & \ frac {\ partial y_ {1}} {\ partial x_ {N}} \\ \ vdots & \ ddots & \ vdots \\ \ frac {\ partial y_ {M}} {\ partial x_ {1}} & \ cdots & \ frac {\ partial y_ {M}} {\ partial x_ {N}} \ end {pmatrix} </script></p><br><p>  You may notice that the rows of <i>the Jacobi matrix</i> are the <i>gradients of the</i> components <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">y</span></span></span><script type="math/tex" id="MathJax-Element-97"> y </script>  .  Element <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1817"><span class="MJXp-mo" id="MJXp-Span-1818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">i</span><span class="MJXp-mo" id="MJXp-Span-1820" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">j</span><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-98"> (i, j) </script>  matrices <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1823"><span class="MJXp-mtext" id="MJXp-Span-1824">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">c</span><span class="MJXp-mrow" id="MJXp-Span-1829"><span class="MJXp-mtext" id="MJXp-Span-1830">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1833">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1839"><span class="MJXp-mtext" id="MJXp-Span-1840">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">x</span></span></span></span><script type="math/tex" id="MathJax-Element-99"> \ frac {\ partial y} {\ partial x} </script>  equals <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1849"><span class="MJXp-mtext" id="MJXp-Span-1850">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">c</span><span class="MJXp-mrow" id="MJXp-Span-1855"><span class="MJXp-mtext" id="MJXp-Span-1856">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863">l</span><span class="MJXp-msubsup" id="MJXp-Span-1864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1866" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867">i</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1868"><span class="MJXp-mtext" id="MJXp-Span-1869">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1874">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">l</span><span class="MJXp-msubsup" id="MJXp-Span-1877"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1879" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">j</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-100"> \ frac {\ partial y_ {i}} {\ partial x_ {j}} </script>  and tells us how much to change <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1881"><span class="MJXp-msubsup" id="MJXp-Span-1882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1884" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-101"> y_ {i} </script>  , when it changes <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1886"><span class="MJXp-msubsup" id="MJXp-Span-1887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1888" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1889" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-102"> x_ {j} </script>  by a small value.  As in the previous cases, you can write: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">x</span><span class="MJXp-mtext" id="MJXp-Span-1893">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1900">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">x</span><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1906">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">x</span><span class="MJXp-mtext" id="MJXp-Span-1913">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">y</span><span class="MJXp-mtext" id="MJXp-Span-1925">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1929">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935">w</span><span class="MJXp-mtext" id="MJXp-Span-1936">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1939">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">y</span><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1945">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1947">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1952">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">l</span><span class="MJXp-mrow" id="MJXp-Span-1956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-1958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1960" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961">x</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1962">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-103"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \ approx y + \ boldsymbol {J} y_ {x} \ Delta x </script></p><br><p>  Here <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1969"><span class="MJXp-mtext" id="MJXp-Span-1970">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1975">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1976">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1979">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">l</span><span class="MJXp-mrow" id="MJXp-Span-1981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-1983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1985" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986">x</span></span></span></span></span><script type="math/tex" id="MathJax-Element-104"> \ boldsymbol {J} y_ {x} </script>  matrix <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">N</span><span class="MJXp-mtext" id="MJXp-Span-1989">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1990">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995">M</span></span></span><script type="math/tex" id="MathJax-Element-105"> N \ times M </script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1996"><span class="MJXp-mtext" id="MJXp-Span-1997">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003">x</span></span></span><script type="math/tex" id="MathJax-Element-106"> \ Delta x </script>  size vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">N</span></span></span><script type="math/tex" id="MathJax-Element-107"> N </script>  so the product <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2006"><span class="MJXp-mtext" id="MJXp-Span-2007">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2012">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017">l</span><span class="MJXp-mrow" id="MJXp-Span-2018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-2020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2021" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2022" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2023">x</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2024">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2026">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">x</span></span></span><script type="math/tex" id="MathJax-Element-108"> \ boldsymbol {J} y_ {x} \ Delta x </script>  Is the product of a matrix and a vector, which results in a size vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2032">M</span></span></span><script type="math/tex" id="MathJax-Element-109"> M </script>  . </p></div></div><br><p>  In order not to be confused in the abundance of symbols, we will assume that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2033"><span class="MJXp-mtext" id="MJXp-Span-2034">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2035">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2038">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2039">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2041">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2044">l</span><span class="MJXp-msubsup" id="MJXp-Span-2045"><span class="MJXp-mrow" id="MJXp-Span-2046" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2048" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2049">r</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110"> \ boldsymbol {J} _ {r} </script>  - Jacobi matrix of the function of residuals at the current point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2050"><span class="MJXp-mtext" id="MJXp-Span-2051">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2052">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2058">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2061">l</span><span class="MJXp-mrow" id="MJXp-Span-2062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111"> \ boldsymbol {p} </script>  .  Then the Gauss-Newton algorithm can be written as: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2064"><span class="MJXp-mtext" id="MJXp-Span-2065">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2071">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2074">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075">l</span><span class="MJXp-mrow" id="MJXp-Span-2076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">p</span></span><span class="MJXp-mtext" id="MJXp-Span-2078">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2079">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2083">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2085">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2087">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088">w</span><span class="MJXp-mtext" id="MJXp-Span-2089">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2091">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2093">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2094">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2096">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2097">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2099">l</span><span class="MJXp-mrow" id="MJXp-Span-2100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">p</span></span><span class="MJXp-mo" id="MJXp-Span-2102" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-2103" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-2104">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2108">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2112">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2113">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114">l</span><span class="MJXp-msubsup" id="MJXp-Span-2115"><span class="MJXp-mrow" id="MJXp-Span-2116" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2117">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2120">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2122">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2123">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2125">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2128">l</span><span class="MJXp-mtext" id="MJXp-Span-2129">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2133">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2135">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2136">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2138">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">l</span><span class="MJXp-msubsup" id="MJXp-Span-2140"><span class="MJXp-mrow" id="MJXp-Span-2141" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2143" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2145"><span class="MJXp-mo" id="MJXp-Span-2146" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2147" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2148">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2149">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2150">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2154">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2155">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2158">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160">l</span><span class="MJXp-msubsup" id="MJXp-Span-2161"><span class="MJXp-mrow" id="MJXp-Span-2162" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2163">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2166">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2165">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2167">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2169">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2173">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2175">r</span><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2178">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2179">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2182">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2184">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2185">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187">l</span><span class="MJXp-mrow" id="MJXp-Span-2188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189">p</span></span><span class="MJXp-mo" id="MJXp-Span-2190" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-112"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p} - [\ boldsymbol {J} _ {r} ^ \ intercal \ boldsymbol {J} _ {r}] ^ {- 1} \ boldsymbol {J} _ {r } ^ \ intercal r (\ boldsymbol {p}) </script></p><br><p>  Record on the form completely coincides with the record of Newton's method.  Only instead of the matrix Hesse is used <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2191"><span class="MJXp-mtext" id="MJXp-Span-2192">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2193">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2196">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2197">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2199">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2201">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">l</span><span class="MJXp-msubsup" id="MJXp-Span-2203"><span class="MJXp-mrow" id="MJXp-Span-2204" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2205">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2208">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2209">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2211">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2213">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2214">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2216">l</span><span class="MJXp-mtext" id="MJXp-Span-2217">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2219">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2221">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2222">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2225">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227">l</span><span class="MJXp-msubsup" id="MJXp-Span-2228"><span class="MJXp-mrow" id="MJXp-Span-2229" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2231" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2232">r</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113"> \ boldsymbol {J} _ {r} ^ \ intercal \ boldsymbol {J} _ {r} </script>  instead of gradient <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2233"><span class="MJXp-mtext" id="MJXp-Span-2234">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2241">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">l</span><span class="MJXp-msubsup" id="MJXp-Span-2245"><span class="MJXp-mrow" id="MJXp-Span-2246" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2250">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2251">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2254">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2258">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">r</span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2261">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2265">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2266">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2268">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271">l</span><span class="MJXp-mrow" id="MJXp-Span-2272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">p</span></span><span class="MJXp-mo" id="MJXp-Span-2274" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114"> \ boldsymbol {J} _ {r} ^ \ intercal r (\ boldsymbol {p}) </script>  .  Next, let's see why you can use such an approximation.  In the meantime, let's start implementing on TensorFlow: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  ,  TensorFlow     , #   ,        #  .  ,   : # 1)       tf.unstack(r) # 2)      tf.gradients(r_i, p) # 3)       tf.stack #      ,     #       j = tf.stack([tf.gradients(r_i, p)[0] for r_i in tf.unstack(r)]) jT = tf.transpose(j) #     - r_col = tf.expand_dims(r, -1) #      hess_approx = tf.matmul(jT, j) grad_approx = tf.matmul(jT, r_col) # ,      dp = tf.matmul(tf.linalg.inv(hess_approx), grad_approx) #  -  - dp = tf.squeeze(dp) #  p  dp    ng = opt.apply_gradients([(dp, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, ng, feed_dict)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 14.653025157673625 step: 4, current loss: 4.3918079172783016e-07 ENDED ON STEP: 4, FINAL LOSS: 3.374364957618591e-17 PARAMETERS: [2.5 2.5]</code> </pre> <br><p>  Enough 4 steps.  Less than for Newton's method. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iq/ns/5l/iqns5lhcfqamjgy_f6isppnaxo4.jpeg"></div><br><p>  As can be seen from the code, the loss function is not used during optimization, only for the stopping and logging criteria.  How does the optimization algorithm know which function to minimize?  The answer is amazing: no way!  Gauss-Newton minimizes only <em>mean squared error</em> . </p><br><h4 id="zakrepim-matematicheskuyu-chast-stati">  We fix the mathematical part of the article </h4><br><p>  We repeated all the math we needed.  Let's fix it up a bit to concentrate on programming and TensorFlow only.  You may need a pencil to trace the sequence of mathematical operations. </p><br><p>  There is a model <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">y</span><span class="MJXp-mo" id="MJXp-Span-2277" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278">f</span><span class="MJXp-mo" id="MJXp-Span-2279" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">x</span><span class="MJXp-mo" id="MJXp-Span-2281" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2282">p</span><span class="MJXp-mo" id="MJXp-Span-2283" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115"> y = f (x, p) </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116"> x </script>  - vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117"> p </script>  - vector of dimension parameters <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118"> n </script>  , but <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2291">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119"> y </script>  - scalar.  From the experiments received <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120"> m </script>  points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2294"><span class="MJXp-mo" id="MJXp-Span-2295" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2297" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2298" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2299">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2300" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2302" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2303" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2304">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2305" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2306" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2307" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2308" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2309" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2311" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2314" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2315">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2316" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2319" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2320">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2321" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121"> (x_ {1}, y_ {1}), ..., (x_ {m}, y_ {m}) </script>  ( <em>data pairs</em> ).  The vector function of residuals depends only on the vector of parameters: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323">r</span><span class="MJXp-mo" id="MJXp-Span-2324" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2325">p</span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2327" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2330" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2331" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2332">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2333" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334">p</span><span class="MJXp-mo" id="MJXp-Span-2335" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2336" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2337" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2338" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2339" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2342" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2344" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">p</span><span class="MJXp-mo" id="MJXp-Span-2346" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2347" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122"> r (p) = (r_ {1} (p), ... r_ {m} (p)) </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2348"><span class="MJXp-msubsup" id="MJXp-Span-2349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2350" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2351" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2352">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2353" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354">p</span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2356" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2358" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2359" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2361" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-2362">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2363">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2368">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2369">t</span><span class="MJXp-mrow" id="MJXp-Span-2370"><span class="MJXp-msubsup" id="MJXp-Span-2371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2373" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2375" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2378" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2380" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">f</span><span class="MJXp-mo" id="MJXp-Span-2382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2385" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2386">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2387" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388">p</span><span class="MJXp-mo" id="MJXp-Span-2389" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-123-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-123"> r_ {k} (p) = y_ {k} - \ widehat {y_ {k}} = y_ {k} - f (x_ {k}, p) </script>  .   ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2391">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-124-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-124">p</script> ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2392"><span class="MJXp-msubsup" id="MJXp-Span-2393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2395" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2397" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2400" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-125-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-125">x_{k}, y_{k}</script>  ?   ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2402"><span class="MJXp-msubsup" id="MJXp-Span-2403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2405" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2407" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2409" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2410" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2411">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-126-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-126">x_{k}, y_{k}</script>      ,      . </p><br><p>       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-127-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-127">p</script> ,  <em>  </em> ( <em>sum of squared error</em> ‚Äî <em>sse</em>  <em>residual sum-of-squares</em> ‚Äî <em>rss</em> )  .    <em>mse</em>    <em>sse</em> ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-128-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-128"> m </script>  .             .     : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2417">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2418">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2420">s</span><span class="MJXp-mo" id="MJXp-Span-2421" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2422">p</span><span class="MJXp-mo" id="MJXp-Span-2423" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2424" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2429">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2427"><span class="MJXp-mn" id="MJXp-Span-2428">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2430" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2431">p</span><span class="MJXp-mo" id="MJXp-Span-2432" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2433" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2434" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span><span class="MJXp-mo" id="MJXp-Span-2435" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2437" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2440">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2439">m</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2441" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2442">p</span><span class="MJXp-mo" id="MJXp-Span-2443" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2444" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2445"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2451" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2446" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2447" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2448">k</span><span class="MJXp-mo" id="MJXp-Span-2449">=</span><span class="MJXp-mn" id="MJXp-Span-2450">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2454" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2457">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2456">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2458" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2459">p</span><span class="MJXp-mo" id="MJXp-Span-2460" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-129-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-129">loss(p) = r_{1}^2(p) + \cdots + r_{m}^2(p) = \sum_{k=1}^{m} r_{k}^2(p)</script></p><br><p>        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-130-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-130">p</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2463"><span class="MJXp-mo" id="MJXp-Span-2464" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2465">p</span><span class="MJXp-mo" id="MJXp-Span-2466" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131">(p)</script>  . </p><br><p>    ,        .  ‚Äî    .   ‚Äî   ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2467"><span class="MJXp-msubsup" id="MJXp-Span-2468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2469" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2470" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132">r^2</script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2471"><span class="MJXp-mn" id="MJXp-Span-2472">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2473">r</span><span class="MJXp-mfrac" id="MJXp-Span-2474" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2475">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">r</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2477">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">p</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-133-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-133">2r \frac{\partial r}{\partial p}</script>  .   : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2479"><span class="MJXp-msubsup" id="MJXp-Span-2480"><span class="MJXp-mi" id="MJXp-Span-2481" style="margin-right: 0.05em;">‚àá</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2482" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2484">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2485">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2486">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2487">s</span><span class="MJXp-mo" id="MJXp-Span-2488" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2489" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-munderover" id="MJXp-Span-2490"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2496" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2497">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2491" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2492" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493">k</span><span class="MJXp-mo" id="MJXp-Span-2494">=</span><span class="MJXp-mn" id="MJXp-Span-2495">1</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-2498">2</span><span class="MJXp-msubsup" id="MJXp-Span-2499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2500" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2501" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2503" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2504">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2506" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2507" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2508">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2509">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2511" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2512" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2513">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2514" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2515" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span><span class="MJXp-mo" id="MJXp-Span-2516" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-munderover" id="MJXp-Span-2517"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2523" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2524">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2518" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2519" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520">k</span><span class="MJXp-mo" id="MJXp-Span-2521">=</span><span class="MJXp-mn" id="MJXp-Span-2522">1</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-2525">2</span><span class="MJXp-msubsup" id="MJXp-Span-2526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2527" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2528" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2529">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2530" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2531">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2533" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2534" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2536">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2538" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2539" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2540">n</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2541" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-134-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-134">\nabla_{p}loss = (\sum_{k=1}^{m}2r_{k}\frac{\partial r_{k}}{\partial p_{1}}, \cdots, \sum_{k=1}^{m}2r_{k}\frac{\partial r_{k}}{\partial p_{n}}) </script></p><br><p>        .      : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2542"><span class="MJXp-mo" id="MJXp-Span-2543" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2544">H</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2545">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2546">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547">s</span><span class="MJXp-msubsup" id="MJXp-Span-2548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2550" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2551">p</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2552"><span class="MJXp-mo" id="MJXp-Span-2553" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2554" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2558" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2559"><span class="MJXp-mi" id="MJXp-Span-2560" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2561" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2562">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2564">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2565">s</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2566">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2568" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2569" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2571">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2573" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2574" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2575">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2576" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2577"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2583" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2584">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2578" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2579" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580">k</span><span class="MJXp-mo" id="MJXp-Span-2581">=</span><span class="MJXp-mn" id="MJXp-Span-2582">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2585" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2586">2</span><span class="MJXp-mfrac" id="MJXp-Span-2587" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2588">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2591" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2592">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2593">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2595" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2596" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2597">i</span></span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2598" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2599">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2602" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2603">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2604">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2606" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2607" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2608">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2609" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2610">2</span><span class="MJXp-msubsup" id="MJXp-Span-2611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2612" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2613" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2614">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2615" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2616"><span class="MJXp-mi" id="MJXp-Span-2617" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2618" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2620" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2621" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2622">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2623">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2626" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2627">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2628">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2630" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2631" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2632">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2633" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-135-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-135">[\boldsymbol{H}loss_{p}]_{ij} = \frac{\partial^2 loss}{\partial p_{i} \partial p_{j}} = \sum_{k=1}^{m}(2\frac{\partial r_{k}}{\partial p_{i}}\frac{\partial r_{k}}{\partial p_{j}} + 2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}})</script></p><br><p>    .        ,     ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2634"><span class="MJXp-msup" id="MJXp-Span-2635"><span class="MJXp-mrow" id="MJXp-Span-2636" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2637" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2639">v</span><span class="MJXp-mo" id="MJXp-Span-2640" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2641" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-2642" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msup" id="MJXp-Span-2643"><span class="MJXp-mrow" id="MJXp-Span-2644" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2645">u</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2646" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2647">v</span><span class="MJXp-mo" id="MJXp-Span-2648" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2649">u</span><span class="MJXp-msup" id="MJXp-Span-2650"><span class="MJXp-mrow" id="MJXp-Span-2651" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2652">v</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2653" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-136-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-136">{(uv)}'={u}'v+u{v}'</script>  . <br>  Fine!     . </p><br><p> ,        ,       , ‚Äî  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2654"><span class="MJXp-mn" id="MJXp-Span-2655">2</span><span class="MJXp-msubsup" id="MJXp-Span-2656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2657" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2658" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2659">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2660" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2661"><span class="MJXp-mi" id="MJXp-Span-2662" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2663" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2666" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2667">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2668">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2670" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2671" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2672">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2673">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2675" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2676" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2677">j</span></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-137-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-137">2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}}</script>  .    ,   ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2678"><span class="MJXp-msubsup" id="MJXp-Span-2679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2680" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2681" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2682">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-138-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-138">r_{k}</script> ,     .          ‚Äî     .   ,    ?    -. </p><br><p>     : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2683"><span class="MJXp-msubsup" id="MJXp-Span-2684"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2685" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2686" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-2688" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2689"><span class="MJXp-mo" id="MJXp-Span-2690" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.183em;"><span class="MJXp-right MJXp-scale2" style="font-size: 9.733em; margin-left: -0.25em;">(</span></span><span class="MJXp-mtable" id="MJXp-Span-2691"><span><span class="MJXp-mtr" id="MJXp-Span-2692" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2693" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2694" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2695">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2697" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2698" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2699">1</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2700">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2702" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2703" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2704">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2705" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2706" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2707" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2708" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2709">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2711" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2712" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2713">1</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2714">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2716" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2717" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718">n</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-2719" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2720" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2721" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span><span class="MJXp-mtd" id="MJXp-Span-2722" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2723" style="margin-left: 0.333em; margin-right: 0.333em;">‚ã±</span></span><span class="MJXp-mtd" id="MJXp-Span-2724" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2725" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2726" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2727" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2728" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2729">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2731" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2732" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2733">m</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2734">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2736" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2737" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2738">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2739" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2740" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2741" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2742" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2743">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2745" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2746" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2747">m</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2748">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2750" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2751" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2752">n</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2753" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.183em;"><span class="MJXp-right MJXp-scale2" style="font-size: 9.733em; margin-left: -0.25em;">)</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-139-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-139">\boldsymbol{J}_{r} = \begin{pmatrix} \frac{\partial r_{1}}{\partial p_{1}} & \cdots & \frac{\partial r_{1}}{\partial p_{n}}\\ \vdots & \ddots & \vdots \\ \frac{\partial r_{m}}{\partial p_{1}} & \cdots & \frac{\partial p_{m}}{\partial p_{n}} \end{pmatrix}</script></p><br><p> ,    ,     . , : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2761"><span class="MJXp-mn" id="MJXp-Span-2762">2</span><span class="MJXp-msubsup" id="MJXp-Span-2763"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2764" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-2767">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2766">r</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2768"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2769" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2770" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2771">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-2772" style="margin-left: 0.333em; margin-right: 0.333em;">‚âà</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2773">H</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2774">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2775">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2776">s</span><span class="MJXp-msubsup" id="MJXp-Span-2777"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2778" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2779" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2780">p</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-140-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-140">2\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r} \approx \boldsymbol{H}loss_{p}</script></p><br><p>   ""     .         (   ).    ,   ‚Äî        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2781"><span class="MJXp-mn" id="MJXp-Span-2782">2</span><span class="MJXp-msubsup" id="MJXp-Span-2783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2784" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2785" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2786">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2787" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2788"><span class="MJXp-mi" id="MJXp-Span-2789" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2790" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2793" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2794">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2795">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2798" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2799">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2800">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2802" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2803" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2804">j</span></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-141-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-141">2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}}</script> ,     . <br>     (    ): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2805"><span class="MJXp-mn" id="MJXp-Span-2806">2</span><span class="MJXp-msubsup" id="MJXp-Span-2807"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2808" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-2811">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2810">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2812">r</span><span class="MJXp-mo" id="MJXp-Span-2813" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2814"><span class="MJXp-mi" id="MJXp-Span-2815" style="margin-right: 0.05em;">‚àá</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2816" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2817">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2818">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2819">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2820">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821">s</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-142-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-142">2\boldsymbol{J}_{r}^\intercal r = \nabla_{p}loss</script></p><br><p>  ,    ,   - ‚Äî          ,       <em>mse</em> . </p><br><h4 id="pereformuliruem-i-uslozhnim-zadachu">     </h4><br><p>      .    ,   ,   .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2823">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-143-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-143"> m </script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2824"><span class="MJXp-mo" id="MJXp-Span-2825" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2827" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2828" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2829">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2830" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2832" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2833" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2834">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2835" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2836" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2837" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2838" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2840" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2841" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2843" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2844" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2845">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2846" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2848" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2849" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2850">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2851" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-144-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-144">(x_{1}, y_{1}), ..., (x_{m}, y_{m})</script> ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853">y</span><span class="MJXp-mo" id="MJXp-Span-2854" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2855">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2856">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2858">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2860">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2861">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2862">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2863">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2864">k</span><span class="MJXp-mo" id="MJXp-Span-2865" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2866">x</span><span class="MJXp-mo" id="MJXp-Span-2867" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868">p</span><span class="MJXp-mo" id="MJXp-Span-2869" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-145-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-145">y = rosenbrock(x, p)</script>  .          <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2871">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-146-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-146">p</script> ,      . </p><br><p>   ,     : " <em>       .  - !</em> ".  ,      ,     ,        ( <em>supervised learning</em> ). ,    .     :  ( <em>training set</em> ) ‚Äî   ;   ‚Äî      ( <em>prediction model</em> )    ;   ‚Äî          ,    . </p><br><p>     <em> </em> ( <em>multi-layer perceptron neural network</em>  <em>mlp</em> ).  ,      ,       : </p><br><ul><li> <em> </em> ( <em>starting values</em> ) .     Xavier'a,       . </li><li> <em></em> ( <em>overfitting</em> ).   ‚Äî  .     ,    .    ‚Äî   . </li><li> <em>  </em> ( <em>scaling of the input</em> ).   ,      . </li></ul><br><p>     9 .     500: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    def get_random_rosenbrock_data_points(m): result = np.zeros((m, 3)) result[:, 0] = np.random.uniform(-2, 2, m) result[:, 1] = np.random.uniform(-2, 2, m) result[:, 2] = rosenbrock(result[:, 0], result[:, 1], 2.5, 2.5) return result m = 500 data_points = get_random_rosenbrock_data_points(m) # overfitting   ,      validation_data_points = get_random_rosenbrock_data_points(m)</span></span></code> </pre> <br><p>    500 .   ‚Äî         ( <em>learner</em> ),     ( <em>outcome measurement</em> )   ( <em>features</em> )     . </p><br><h4 id="realizuem-odnosloynyy-perceptron">    </h4><br><p>          ( <em>network diagram</em> ).        MatLab: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/np/nt/xk/npntxk7brhnpkk7p5v1p4bjur-a.png"></div><br><p>        ( <em>input</em> ).      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2873">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-147-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-147">W</script> ( <em>weights</em> )  2x10,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2875">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-148-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-148">b</script> ( <em>bias</em> )  10,       ( <em>activation</em> ).    ()   ( <em>hidden layer</em> )  10 .         ,   ,         ( <em>output</em> ). </p><br><p>   ,   ,  (  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2877">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2878">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2879">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2880">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-149-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-149">tanh</script> ): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2881"><span class="MJXp-mtable" id="MJXp-Span-2882"><span><span class="MJXp-mtr" id="MJXp-Span-2883" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2884" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2886" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2887" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2888">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2889" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2890">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2891">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2892">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2893">h</span><span class="MJXp-mo" id="MJXp-Span-2894" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2895">x</span><span class="MJXp-msubsup" id="MJXp-Span-2896"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2897" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2898" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2899">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2900" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2903" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2904">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2905" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2906" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2907" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-2908"><span class="MJXp-munderover" id="MJXp-Span-2909"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2911" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2910">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2912" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2914" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2915" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2916">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2918" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2919" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2920">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2921" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2923" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2924" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2925">2</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-150-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-150">\begin{matrix} h_{1} = tanh(xW_{1} + b_{1})\\ \widehat{y} = h_{1}W_{2} + b_{2} \end{matrix} </script></p><br><p>  : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2926"><span class="MJXp-msubsup" id="MJXp-Span-2927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2928" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2929" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2931">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2932">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2933">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2934">h</span><span class="MJXp-mo" id="MJXp-Span-2935" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2936"><span class="MJXp-mo" id="MJXp-Span-2937" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-2938"><span><span class="MJXp-mtr" id="MJXp-Span-2939" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2940" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2942" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2943" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-mtd" id="MJXp-Span-2944" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2946" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2947" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2948" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">]</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2949"><span class="MJXp-mo" id="MJXp-Span-2950" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-2951"><span><span class="MJXp-mtr" id="MJXp-Span-2952" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2953" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2955" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2960"><span class="MJXp-mo" id="MJXp-Span-2961">(</span><span class="MJXp-mn" id="MJXp-Span-2962">1</span><span class="MJXp-mo" id="MJXp-Span-2963">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2956"><span class="MJXp-mn" id="MJXp-Span-2957">1</span><span class="MJXp-mo" id="MJXp-Span-2958">,</span><span class="MJXp-mn" id="MJXp-Span-2959">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2964" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2965" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2966" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2968" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2973"><span class="MJXp-mo" id="MJXp-Span-2974">(</span><span class="MJXp-mn" id="MJXp-Span-2975">1</span><span class="MJXp-mo" id="MJXp-Span-2976">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2969"><span class="MJXp-mn" id="MJXp-Span-2970">1</span><span class="MJXp-mo" id="MJXp-Span-2971">,</span><span class="MJXp-mn" id="MJXp-Span-2972">10</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-2977" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2978" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2985"><span class="MJXp-mo" id="MJXp-Span-2986">(</span><span class="MJXp-mn" id="MJXp-Span-2987">1</span><span class="MJXp-mo" id="MJXp-Span-2988">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2981"><span class="MJXp-mn" id="MJXp-Span-2982">2</span><span class="MJXp-mo" id="MJXp-Span-2983">,</span><span class="MJXp-mn" id="MJXp-Span-2984">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2989" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2990" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2991" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2993" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2998"><span class="MJXp-mo" id="MJXp-Span-2999">(</span><span class="MJXp-mn" id="MJXp-Span-3000">1</span><span class="MJXp-mo" id="MJXp-Span-3001">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2994"><span class="MJXp-mn" id="MJXp-Span-2995">2</span><span class="MJXp-mo" id="MJXp-Span-2996">,</span><span class="MJXp-mn" id="MJXp-Span-2997">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3002" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3003" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-3004"><span class="MJXp-mo" id="MJXp-Span-3005" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3006"><span><span class="MJXp-mtr" id="MJXp-Span-3007" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3008" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3010" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3012"><span class="MJXp-mo" id="MJXp-Span-3013">(</span><span class="MJXp-mn" id="MJXp-Span-3014">1</span><span class="MJXp-mo" id="MJXp-Span-3015">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3011">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3016" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3017" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3018" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3020" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3023"><span class="MJXp-mo" id="MJXp-Span-3024">(</span><span class="MJXp-mn" id="MJXp-Span-3025">1</span><span class="MJXp-mo" id="MJXp-Span-3026">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3021"><span class="MJXp-mn" id="MJXp-Span-3022">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3027" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3028" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-3029" style="width: 0em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3030"><span class="MJXp-munderover" id="MJXp-Span-3031"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3033" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3032">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3034" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3035"><span class="MJXp-mo" id="MJXp-Span-3036" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3037"><span><span class="MJXp-mtr" id="MJXp-Span-3038" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3039" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3041" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3043"><span class="MJXp-mo" id="MJXp-Span-3044">(</span><span class="MJXp-mn" id="MJXp-Span-3045">1</span><span class="MJXp-mo" id="MJXp-Span-3046">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3042">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3047" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3048" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3049" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3051" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3054"><span class="MJXp-mo" id="MJXp-Span-3055">(</span><span class="MJXp-mn" id="MJXp-Span-3056">1</span><span class="MJXp-mo" id="MJXp-Span-3057">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3052"><span class="MJXp-mn" id="MJXp-Span-3053">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3058" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3059"><span class="MJXp-mo" id="MJXp-Span-3060" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3061"><span><span class="MJXp-mtr" id="MJXp-Span-3062" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3063" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3065" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3070"><span class="MJXp-mo" id="MJXp-Span-3071">(</span><span class="MJXp-mn" id="MJXp-Span-3072">2</span><span class="MJXp-mo" id="MJXp-Span-3073">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3066"><span class="MJXp-mn" id="MJXp-Span-3067">1</span><span class="MJXp-mo" id="MJXp-Span-3068">,</span><span class="MJXp-mn" id="MJXp-Span-3069">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3074" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3075" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3076" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3077" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3078" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3079"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3080" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3085"><span class="MJXp-mo" id="MJXp-Span-3086">(</span><span class="MJXp-mn" id="MJXp-Span-3087">2</span><span class="MJXp-mo" id="MJXp-Span-3088">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3081"><span class="MJXp-mn" id="MJXp-Span-3082">1</span><span class="MJXp-mo" id="MJXp-Span-3083">,</span><span class="MJXp-mn" id="MJXp-Span-3084">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3089" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3090" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3092" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3093" style="vertical-align: -0.4em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-151-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-151">h_1 = tanh(\begin{bmatrix} x_1 & x_2 \end{bmatrix}\begin{bmatrix} w^{(1)}_{1,1} & \cdots& w^{(1)}_{1,10} \\ w^{(1)}_{2,1} &\cdots& w^{(1)}_{2,10} \end{bmatrix} + \begin{bmatrix} b^{(1)}_1 & \cdots & b^{(1)}_{10} \end{bmatrix}) \\ \widehat{y} = \begin{bmatrix}h^{(1)}_1 & \cdots & h^{(1)}_{10}\end{bmatrix} \begin{bmatrix} w^{(2)}_{1,1} \\ \vdots \\ w^{(2)}_{1,10} \\ \end{bmatrix} + b_2 </script></p><br><p>    .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3094"><span class="MJXp-msubsup" id="MJXp-Span-3095"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3096" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3097" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3098">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-152-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-152">W_{1}</script>        ""   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3099"><span class="MJXp-msubsup" id="MJXp-Span-3100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3101" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3102" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3103">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-153-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-153">h_{1}</script> ,       - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3104"><span class="MJXp-msubsup" id="MJXp-Span-3105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3106" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3107" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3108">2</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-154-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-154">W_{2}</script>  .  41 .       ,    . </p><br><p>       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3110">m</span><span class="MJXp-mo" id="MJXp-Span-3111" style="margin-left: 0.267em; margin-right: 0.267em;">√ó</span><span class="MJXp-mn" id="MJXp-Span-3112">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-155-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-155">m \times 2</script> ,          .   - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3113"><span class="MJXp-mrow" id="MJXp-Span-3114"><span class="MJXp-munderover" id="MJXp-Span-3115"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3117" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3116">y</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-156-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-156">\widehat{y}</script>  of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3119">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-157-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-157"> m </script> : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     10 "" n_hidden = 10 #      Xavier'a initializer = tf.contrib.layers.xavier_initializer() #    x = tf.placeholder(tf.float64, shape=[m, 2]) y = tf.placeholder(tf.float64, shape=[m, 1]) #         W1 = tf.Variable(initializer([2, n_hidden], dtype=tf.float64)) b1 = tf.Variable(initializer([1, n_hidden], dtype=tf.float64)) #   ,  tanh   h1 = tf.nn.tanh(tf.matmul(x, W1) + b1) #        W2 = tf.Variable(initializer([n_hidden, 1], dtype=tf.float64)) b2 = tf.Variable(initializer([1], dtype=tf.float64)) #   y_hat = tf.matmul(h1, W2) + b2 #  r = y - y_hat #   mse     loss = tf.reduce_mean(tf.square(r)) #      placeholder feed_dict = {x: data_points[:,0:2], y: data_points[:,2:3]} validation_feed_dict = {x: validation_data_points[:,0:2], y: validation_data_points[:,2:3]}</span></span></code> </pre> <br><h4 id="obuchim-neyroset-metodom-adam">    Adam </h4><br><p>     Adam         <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3121">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3122">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3123">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3124">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3125">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3126">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3128">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3129">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3130">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-158-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-158">rosenbrock</script>  .   mse     : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    adm = tf.train.AdamOptimizer(1e-2).minimize(loss) session.run(tf.global_variables_initializer()) #   ,    40000  train(1e-10, 40000, loss, adm, feed_dict) print('VALIDATION LOSS: '+str(session.run(loss, validation_feed_dict)))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 671.4242576535694 [...] ENDED ON STEP: 40000, FINAL LOSS: 0.22862158574440725 VALIDATION LOSS: 0.29000289644978866</code> </pre> <br><p>       .      :   ,  ,   . </p><br><h4 id="vychislim-matricu-yakobi-dlya-neyronnoy-seti">       </h4><br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3132">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3133">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3134">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3135">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3136">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3137">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3138">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3139">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3140">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3141">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-159-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-159">rosenbrock</script>     2  .    : </p><br><ul><li> .   9 ,  500.        . </li><li> .   -  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3143">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-160-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-160">p</script> ,        . </li></ul><br><p>    : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      y   x def jacobian(y, x): loop_vars = [ tf.constant(0, tf.int32), tf.TensorArray(tf.float64, size=m), ] #  -   #      _, jacobian = tf.while_loop( lambda i, _: i &lt; m, #           #   (-),   x     lambda i, res: (i+1, res.write(i, tf.reshape(tf.gradients(y[i], x), (-1,)))), loop_vars) #       return jacobian.stack() #       r_flat = tf.squeeze(r) #        #       parms = [W1, b1, W2, b2] parms_sizes = [tf.size(p) for p in parms] j = tf.concat([jacobian(r_flat, p) for p in parms], 1) jT = tf.transpose(j) #           hess_approx = tf.matmul(jT, j) grad_approx = tf.matmul(jT, r)</span></span></code> </pre> <br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3144"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3145">J</span><span class="MJXp-msubsup" id="MJXp-Span-3146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3147" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3148" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3149">p</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-161-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-161">\boldsymbol{J}r_{p}</script>       .       ,   4  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3150"><span class="MJXp-msubsup" id="MJXp-Span-3151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3152" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3153" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3154" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3156" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3157" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3158" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3160" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3161" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3162" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3164" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3165" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-162-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-162">W_1, b_1, W_2, b_2</script>  .  4  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3166"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3167">J</span><span class="MJXp-msubsup" id="MJXp-Span-3168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3169" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3170" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3172" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3173" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3174" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3175">J</span><span class="MJXp-msubsup" id="MJXp-Span-3176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3177" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3178" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3180" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3181" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3182" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3183">J</span><span class="MJXp-msubsup" id="MJXp-Span-3184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3185" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3186" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3188" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3189" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3190" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3191">J</span><span class="MJXp-msubsup" id="MJXp-Span-3192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3193" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3194" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3196" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3197" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-163-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-163">\boldsymbol{J}r_{W_1}, \boldsymbol{J}r_{b_1}, \boldsymbol{J}r_{W_2}, \boldsymbol{J}r_{b_2}</script>      <em>tf.concat</em> . </p><br><p>         . <em>tf.while_loop</em>    ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3198"><span class="MJXp-msubsup" id="MJXp-Span-3199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3200" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3201" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-164-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-164">r_i</script> ,        ,       <em>stack</em> . </p><br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3202"><span class="MJXp-msubsup" id="MJXp-Span-3203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3204" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3205" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-165-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-165">r_i</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3206"><span class="MJXp-msubsup" id="MJXp-Span-3207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3208" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3209" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-166-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-166">W_1</script>  : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3210"><span class="MJXp-mrow" id="MJXp-Span-3211"><span class="MJXp-mo" id="MJXp-Span-3212" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.917em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.667em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3213"><span><span class="MJXp-mtr" id="MJXp-Span-3214" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3215" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3216" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3217">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3219" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3220" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3221">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3223" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3228"><span class="MJXp-mo" id="MJXp-Span-3229">(</span><span class="MJXp-mn" id="MJXp-Span-3230">1</span><span class="MJXp-mo" id="MJXp-Span-3231">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3224"><span class="MJXp-mn" id="MJXp-Span-3225">1</span><span class="MJXp-mo" id="MJXp-Span-3226">,</span><span class="MJXp-mn" id="MJXp-Span-3227">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3232" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3233" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3234" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3235" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3236">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3238" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3239" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3240">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3242" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3247"><span class="MJXp-mo" id="MJXp-Span-3248">(</span><span class="MJXp-mn" id="MJXp-Span-3249">1</span><span class="MJXp-mo" id="MJXp-Span-3250">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3243"><span class="MJXp-mn" id="MJXp-Span-3244">1</span><span class="MJXp-mo" id="MJXp-Span-3245">,</span><span class="MJXp-mn" id="MJXp-Span-3246">10</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3251" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3252" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3253" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3254">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3256" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3257" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3258">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3260" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3265"><span class="MJXp-mo" id="MJXp-Span-3266">(</span><span class="MJXp-mn" id="MJXp-Span-3267">1</span><span class="MJXp-mo" id="MJXp-Span-3268">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3261"><span class="MJXp-mn" id="MJXp-Span-3262">2</span><span class="MJXp-mo" id="MJXp-Span-3263">,</span><span class="MJXp-mn" id="MJXp-Span-3264">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3269" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3270" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3271" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3272" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3273">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3275" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3276" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3277">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3279" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3284"><span class="MJXp-mo" id="MJXp-Span-3285">(</span><span class="MJXp-mn" id="MJXp-Span-3286">1</span><span class="MJXp-mo" id="MJXp-Span-3287">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3280"><span class="MJXp-mn" id="MJXp-Span-3281">2</span><span class="MJXp-mo" id="MJXp-Span-3282">,</span><span class="MJXp-mn" id="MJXp-Span-3283">10</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3288" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.917em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.667em; margin-left: -0.25em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-167-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-167">\begin{bmatrix} \frac{\partial r_i}{\partial w^{(1)}_{1,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{1,10}} \\ \frac{\partial r_i}{\partial w^{(1)}_{2,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{2,10}} \end{bmatrix}</script>  .  <em>tf.reshape</em>   <em>(-1,)</em>     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3289"><span class="MJXp-mrow" id="MJXp-Span-3290"><span class="MJXp-mo" id="MJXp-Span-3291" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.778em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.111em; margin-left: -0.17em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3292"><span><span class="MJXp-mtr" id="MJXp-Span-3293" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3294" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3295" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3296">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3298" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3299" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3300">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3302" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3307"><span class="MJXp-mo" id="MJXp-Span-3308">(</span><span class="MJXp-mn" id="MJXp-Span-3309">1</span><span class="MJXp-mo" id="MJXp-Span-3310">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3303"><span class="MJXp-mn" id="MJXp-Span-3304">1</span><span class="MJXp-mo" id="MJXp-Span-3305">,</span><span class="MJXp-mn" id="MJXp-Span-3306">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3311" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3312" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3313" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3314" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3315">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3317" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3318" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3319">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3321" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3326"><span class="MJXp-mo" id="MJXp-Span-3327">(</span><span class="MJXp-mn" id="MJXp-Span-3328">1</span><span class="MJXp-mo" id="MJXp-Span-3329">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3322"><span class="MJXp-mn" id="MJXp-Span-3323">1</span><span class="MJXp-mo" id="MJXp-Span-3324">,</span><span class="MJXp-mn" id="MJXp-Span-3325">10</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3330" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3331" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3332">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3334" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3335" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3336">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3338" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3343"><span class="MJXp-mo" id="MJXp-Span-3344">(</span><span class="MJXp-mn" id="MJXp-Span-3345">1</span><span class="MJXp-mo" id="MJXp-Span-3346">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3339"><span class="MJXp-mn" id="MJXp-Span-3340">2</span><span class="MJXp-mo" id="MJXp-Span-3341">,</span><span class="MJXp-mn" id="MJXp-Span-3342">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3347" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3348" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3349" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3350" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3351">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3353" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3354" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3355">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3357" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3362"><span class="MJXp-mo" id="MJXp-Span-3363">(</span><span class="MJXp-mn" id="MJXp-Span-3364">1</span><span class="MJXp-mo" id="MJXp-Span-3365">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3358"><span class="MJXp-mn" id="MJXp-Span-3359">2</span><span class="MJXp-mo" id="MJXp-Span-3360">,</span><span class="MJXp-mn" id="MJXp-Span-3361">10</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3366" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.778em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.111em; margin-left: -0.17em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-168-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-168">\begin{bmatrix} \frac{\partial r_i}{\partial w^{(1)}_{1,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{1,10}} & \frac{\partial r_i}{\partial w^{(1)}_{2,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{2,10}} \end{bmatrix}</script>  . </p><br><p>        .           -     .    ‚Äî TensorFlow             .   ‚Äî  -    -     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3367"><span class="MJXp-msubsup" id="MJXp-Span-3368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3369" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3370" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3371" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3373" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3374" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3375" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3377" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3378" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3379" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3381" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3382" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-169-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-169">W_1, b_1, W_2, b_2</script>  .        -.     <a href="https://github.com/empathy87/nn-samples/blob/master/tf/LevenbergMarquardt/%255BTutorial%255D%2520Levenberg-Marquardt.ipynb">Levenberg-Marquardt Jupyter Notebook</a>   <a href="https://github.com/empathy87/nn-samples/blob/master/tf/LevenbergMarquardt/rosenbrock_train.py">rosenbrock_train.py</a> .       ,   TensorFlow       .  - ,      ( ) , , . </p><br><h4 id="obuchim-neyroset-metodom-gaussa-nyutona">    - </h4><br><p>  <em>hess_approx</em>  <em>grad_approx</em>       -.      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3384">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3385">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3386">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3387">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3388">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3389">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3390">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3391">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3392">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3393">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-170-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-170">rosenbrock</script>   ,               .   : </p><br><ol><li>    : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3394"><span class="MJXp-mi" id="MJXp-Span-3395">Œî</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3396">p</span><span class="MJXp-mo" id="MJXp-Span-3397" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3398"><span class="MJXp-mo" id="MJXp-Span-3399" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3400"><span><span class="MJXp-mtr" id="MJXp-Span-3401" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3402" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3403">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3404"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3405" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3410"><span class="MJXp-mo" id="MJXp-Span-3411">(</span><span class="MJXp-mn" id="MJXp-Span-3412">1</span><span class="MJXp-mo" id="MJXp-Span-3413">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3406"><span class="MJXp-mn" id="MJXp-Span-3407">1</span><span class="MJXp-mo" id="MJXp-Span-3408">,</span><span class="MJXp-mn" id="MJXp-Span-3409">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3414" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3415" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3416" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3417">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3419" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3424"><span class="MJXp-mo" id="MJXp-Span-3425">(</span><span class="MJXp-mn" id="MJXp-Span-3426">1</span><span class="MJXp-mo" id="MJXp-Span-3427">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3420"><span class="MJXp-mn" id="MJXp-Span-3421">2</span><span class="MJXp-mo" id="MJXp-Span-3422">,</span><span class="MJXp-mn" id="MJXp-Span-3423">10</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3428" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3429">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3431" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3433"><span class="MJXp-mo" id="MJXp-Span-3434">(</span><span class="MJXp-mn" id="MJXp-Span-3435">1</span><span class="MJXp-mo" id="MJXp-Span-3436">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3432">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3437" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3438" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3439" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3440">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3442" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3445"><span class="MJXp-mo" id="MJXp-Span-3446">(</span><span class="MJXp-mn" id="MJXp-Span-3447">1</span><span class="MJXp-mo" id="MJXp-Span-3448">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3443"><span class="MJXp-mn" id="MJXp-Span-3444">10</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3449" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3450">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3452" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3457"><span class="MJXp-mo" id="MJXp-Span-3458">(</span><span class="MJXp-mn" id="MJXp-Span-3459">2</span><span class="MJXp-mo" id="MJXp-Span-3460">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3453"><span class="MJXp-mn" id="MJXp-Span-3454">1</span><span class="MJXp-mo" id="MJXp-Span-3455">,</span><span class="MJXp-mn" id="MJXp-Span-3456">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3461" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3462" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3463" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3464">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3466" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3471"><span class="MJXp-mo" id="MJXp-Span-3472">(</span><span class="MJXp-mn" id="MJXp-Span-3473">2</span><span class="MJXp-mo" id="MJXp-Span-3474">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3467"><span class="MJXp-mn" id="MJXp-Span-3468">1</span><span class="MJXp-mo" id="MJXp-Span-3469">,</span><span class="MJXp-mn" id="MJXp-Span-3470">10</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3475" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3476">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3478" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3479" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3480" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-171-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-171">\Delta \boldsymbol{p} = \begin{bmatrix}\Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{2,10} & \Delta b^{(1)}_1 & \cdots & \Delta b^{(1)}_{10} & \Delta w^{(2)}_{1,1} & \cdots & \Delta w^{(2)}_{1,10} & \Delta b_2\end{bmatrix}</script></li><li>        : <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3481"><span class="MJXp-mi" id="MJXp-Span-3482">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3484" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3485" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3486">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3487" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3488"><span class="MJXp-mo" id="MJXp-Span-3489" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3490"><span><span class="MJXp-mtr" id="MJXp-Span-3491" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3492" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3493">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3495" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3500"><span class="MJXp-mo" id="MJXp-Span-3501">(</span><span class="MJXp-mn" id="MJXp-Span-3502">1</span><span class="MJXp-mo" id="MJXp-Span-3503">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3496"><span class="MJXp-mn" id="MJXp-Span-3497">1</span><span class="MJXp-mo" id="MJXp-Span-3498">,</span><span class="MJXp-mn" id="MJXp-Span-3499">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3504" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3505" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3506" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3507">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3509" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3514"><span class="MJXp-mo" id="MJXp-Span-3515">(</span><span class="MJXp-mn" id="MJXp-Span-3516">1</span><span class="MJXp-mo" id="MJXp-Span-3517">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3510"><span class="MJXp-mn" id="MJXp-Span-3511">2</span><span class="MJXp-mo" id="MJXp-Span-3512">,</span><span class="MJXp-mn" id="MJXp-Span-3513">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3518" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-172-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-172">\Delta W_{1} = \begin{bmatrix}\Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{2,10} \end{bmatrix}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3519"><span class="MJXp-mi" id="MJXp-Span-3520">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3522" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3523" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3524">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3525" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3526"><span class="MJXp-mo" id="MJXp-Span-3527" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3528"><span><span class="MJXp-mtr" id="MJXp-Span-3529" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3530" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3531">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3533" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3535"><span class="MJXp-mo" id="MJXp-Span-3536">(</span><span class="MJXp-mn" id="MJXp-Span-3537">1</span><span class="MJXp-mo" id="MJXp-Span-3538">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3534">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3539" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3540" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3541" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3542">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3544" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3547"><span class="MJXp-mo" id="MJXp-Span-3548">(</span><span class="MJXp-mn" id="MJXp-Span-3549">1</span><span class="MJXp-mo" id="MJXp-Span-3550">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3545"><span class="MJXp-mn" id="MJXp-Span-3546">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3551" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-173-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-173">\Delta b_{1} = \begin{bmatrix} \Delta b^{(1)}_1 & \cdots & \Delta b^{(1)}_{10} \end{bmatrix}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3552"><span class="MJXp-mi" id="MJXp-Span-3553">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3555" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3556" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3557">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-3558" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3559"><span class="MJXp-mo" id="MJXp-Span-3560" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3561"><span><span class="MJXp-mtr" id="MJXp-Span-3562" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3563" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3564">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3566" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3571"><span class="MJXp-mo" id="MJXp-Span-3572">(</span><span class="MJXp-mn" id="MJXp-Span-3573">2</span><span class="MJXp-mo" id="MJXp-Span-3574">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3567"><span class="MJXp-mn" id="MJXp-Span-3568">1</span><span class="MJXp-mo" id="MJXp-Span-3569">,</span><span class="MJXp-mn" id="MJXp-Span-3570">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3575" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3576" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3577" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3578">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3580" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3585"><span class="MJXp-mo" id="MJXp-Span-3586">(</span><span class="MJXp-mn" id="MJXp-Span-3587">2</span><span class="MJXp-mo" id="MJXp-Span-3588">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3581"><span class="MJXp-mn" id="MJXp-Span-3582">1</span><span class="MJXp-mo" id="MJXp-Span-3583">,</span><span class="MJXp-mn" id="MJXp-Span-3584">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3589" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-174-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-174">\Delta W_{2} = \begin{bmatrix} \Delta w^{(2)}_{1,1} & \cdots & \Delta w^{(2)}_{1,10} \end{bmatrix}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3590"><span class="MJXp-mi" id="MJXp-Span-3591">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3593" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3594" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3595">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-3596" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3597"><span class="MJXp-mo" id="MJXp-Span-3598" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3599"><span><span class="MJXp-mtr" id="MJXp-Span-3600" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3601" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3602">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3604" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3605" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3606" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-175-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-175">\Delta b_{2} = \begin{bmatrix} \Delta b_2\end{bmatrix}</script>  . </li><li>   ,      : <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3607"><span class="MJXp-mi" id="MJXp-Span-3608">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3610" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3611" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3612">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3613" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3614"><span class="MJXp-mo" id="MJXp-Span-3615" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3616"><span><span class="MJXp-mtr" id="MJXp-Span-3617" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3618" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3619">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3621" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3626"><span class="MJXp-mo" id="MJXp-Span-3627">(</span><span class="MJXp-mn" id="MJXp-Span-3628">1</span><span class="MJXp-mo" id="MJXp-Span-3629">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3622"><span class="MJXp-mn" id="MJXp-Span-3623">1</span><span class="MJXp-mo" id="MJXp-Span-3624">,</span><span class="MJXp-mn" id="MJXp-Span-3625">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3630" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3631" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3632" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3633">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3635" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3640"><span class="MJXp-mo" id="MJXp-Span-3641">(</span><span class="MJXp-mn" id="MJXp-Span-3642">1</span><span class="MJXp-mo" id="MJXp-Span-3643">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3636"><span class="MJXp-mn" id="MJXp-Span-3637">1</span><span class="MJXp-mo" id="MJXp-Span-3638">,</span><span class="MJXp-mn" id="MJXp-Span-3639">10</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3644" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3645" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3646">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3648" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3653"><span class="MJXp-mo" id="MJXp-Span-3654">(</span><span class="MJXp-mn" id="MJXp-Span-3655">1</span><span class="MJXp-mo" id="MJXp-Span-3656">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3649"><span class="MJXp-mn" id="MJXp-Span-3650">2</span><span class="MJXp-mo" id="MJXp-Span-3651">,</span><span class="MJXp-mn" id="MJXp-Span-3652">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3657" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3658" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3659" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3660">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3662" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3667"><span class="MJXp-mo" id="MJXp-Span-3668">(</span><span class="MJXp-mn" id="MJXp-Span-3669">1</span><span class="MJXp-mo" id="MJXp-Span-3670">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3663"><span class="MJXp-mn" id="MJXp-Span-3664">2</span><span class="MJXp-mo" id="MJXp-Span-3665">,</span><span class="MJXp-mn" id="MJXp-Span-3666">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3671" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-176-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-176">\Delta W_{1} = \begin{bmatrix} \Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{1,10} \\ \Delta w^{(1)}_{2,1} &\cdots & \Delta w^{(1)}_{2,10} \end{bmatrix}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3672"><span class="MJXp-mi" id="MJXp-Span-3673">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3675" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3676" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3677">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-3678" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3679"><span class="MJXp-mo" id="MJXp-Span-3680" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3681"><span><span class="MJXp-mtr" id="MJXp-Span-3682" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3683" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3684">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3686" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3691"><span class="MJXp-mo" id="MJXp-Span-3692">(</span><span class="MJXp-mn" id="MJXp-Span-3693">2</span><span class="MJXp-mo" id="MJXp-Span-3694">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3687"><span class="MJXp-mn" id="MJXp-Span-3688">1</span><span class="MJXp-mo" id="MJXp-Span-3689">,</span><span class="MJXp-mn" id="MJXp-Span-3690">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3695" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3696" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3697" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3698" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3699" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3700">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3702" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3707"><span class="MJXp-mo" id="MJXp-Span-3708">(</span><span class="MJXp-mn" id="MJXp-Span-3709">2</span><span class="MJXp-mo" id="MJXp-Span-3710">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3703"><span class="MJXp-mn" id="MJXp-Span-3704">1</span><span class="MJXp-mo" id="MJXp-Span-3705">,</span><span class="MJXp-mn" id="MJXp-Span-3706">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3711" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-177-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-177">\Delta W_{2} = \begin{bmatrix} \Delta w^{(2)}_{1,1} \\ \vdots \\ \Delta w^{(2)}_{1,10} \\ \end{bmatrix}</script></li><li>  . </li></ol><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># 1.     dp_flat = tf.matmul(tf.linalg.inv(hess_approx), grad_approx) # 2.     dps = tf.split(dp_flat, parms_sizes, 0) # 3.     for i in range(len(dps)): dps[i] = tf.reshape(dps[i], parms[i].shape) # 4.  :       gn = opt.apply_gradients(zip(dps, parms)) #   session.run(tf.global_variables_initializer()) train(1e-10, 100, loss, gn, feed_dict)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 548.8468777701685 step: 2, current loss: 49648941.340197295 InvalidArgumentError: Input is not invertible.</code> </pre> <br><p>  Something went wrong.      ,       .  -  ,      . </p><br><p>      ,        . </p><br><h4 id="obuchim-neyroset-metodom-levenberga-markvadta">    - </h4><br><p>     .          Matlab <a href="https://ch.mathworks.com/help/deeplearning/ref/trainlm.html">   trainlm</a> .       .     MathWorks. </p><br><p>    - : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3712"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3713">p</span><span class="MJXp-mo" id="MJXp-Span-3714" style="margin-left: 0.333em; margin-right: 0.333em;">‚Üí</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3715">p</span><span class="MJXp-mo" id="MJXp-Span-3716" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-3717" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3718"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3719" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3722">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3721">r</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3723"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3724" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3725" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3726">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3727"><span class="MJXp-mo" id="MJXp-Span-3728" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3729" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3730">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3731">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3732"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3733" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3736">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3735">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3737">r</span><span class="MJXp-mo" id="MJXp-Span-3738" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3739">p</span><span class="MJXp-mo" id="MJXp-Span-3740" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-178-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-178">\boldsymbol{p} \rightarrow \boldsymbol{p}-[\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r}]^{-1}\boldsymbol{J}_{r}^\intercal r(\boldsymbol{p})</script>  .  -    : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3741"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3742">p</span><span class="MJXp-mo" id="MJXp-Span-3743" style="margin-left: 0.333em; margin-right: 0.333em;">‚Üí</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3744">p</span><span class="MJXp-mo" id="MJXp-Span-3745" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-3746" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3747"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3748" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3751">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3750">r</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3752"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3753" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3754" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3755">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-3756" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3757">Œº</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3758">I</span><span class="MJXp-msubsup" id="MJXp-Span-3759"><span class="MJXp-mo" id="MJXp-Span-3760" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3761" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3762">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3763">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3764"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3765" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3768">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3767">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3769">r</span><span class="MJXp-mo" id="MJXp-Span-3770" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3771">p</span><span class="MJXp-mo" id="MJXp-Span-3772" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-179-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-179">\boldsymbol{p} \rightarrow \boldsymbol{p}-[\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r}+\mu \boldsymbol{I}]^{-1}\boldsymbol{J}_{r}^\intercal r(\boldsymbol{p})</script></p><br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3773"><span class="MJXp-mtext" id="MJXp-Span-3774">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3775">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3776">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-180-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-180"> \ mu </script>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3777"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3778">I</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-181-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-181"> I </script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3780">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-182-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-182"> n </script> (  ).   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3781"><span class="MJXp-mtext" id="MJXp-Span-3782">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3783">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3784">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-183-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-183"> \ mu </script>  ,       -.   ,    .  ,  LM       -. </p><br><p>        : </p><br><pre> <code class="python hljs">mu = tf.placeholder(tf.float64, shape=[<span class="hljs-number"><span class="hljs-number">1</span></span>]) n = tf.add_n(parms_sizes) I = tf.eye(n, dtype=tf.float64) <span class="hljs-comment"><span class="hljs-comment"># 1.     dp_flat = tf.matmul(tf.linalg.inv(hess_approx + tf.multiply(mu, I)), grad_approx) # 2.     dps = tf.split(dp_flat, parms_sizes, 0) # 3.     for i in range(len(dps)): dps[i] = tf.reshape(dps[i], parms[i].shape) # 4.  :       lm = opt.apply_gradients(zip(dps, parms))</span></span></code> </pre> <br><p>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3785"><span class="MJXp-mtext" id="MJXp-Span-3786">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3787">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3788">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-184-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-184"> \ mu </script>  ?  LM     -   .   ,     . ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3789"><span class="MJXp-mtext" id="MJXp-Span-3790">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3791">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3792">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-185-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-185"> \ mu </script> ,     .     ‚Äî   ,     <em>mse</em> .       ,   : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       store = [tf.Variable(tf.zeros(p.shape, dtype=tf.float64)) for p in parms] #  TensorFlow       save_parms = [tf.assign(s, p) for s, p in zip(store, parms)] restore_parms = [tf.assign(p, s) for s, p in zip(store, parms)] #   mu    3. feed_dict[mu] = np.array([3.]) step = 0 session.run(tf.global_variables_initializer()) #    mse current_loss = session.run(loss, feed_dict) #    100   while current_loss &gt; 1e-10 and step &lt; 100: step += 1 #  1, 2, 4...   if math.log(step, 2).is_integer(): print(f'step: {step}, mu: {feed_dict[mu][0]} current loss: {current_loss}') #    session.run(save_parms) # ,     mse while True: #    session.run(lm, feed_dict) new_loss = session.run(loss, feed_dict) if new_loss &gt; current_loss: #  -  mu  10     feed_dict[mu] *= 10 session.run(restore_parms) else: #  -  mu  10     feed_dict[mu] /= 10 current_loss = new_loss break print(f'ENDED ON STEP: {step}, FINAL LOSS: {current_loss}') print('VALIDATION LOSS: '+str(session.run(loss, validation_feed_dict)))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, mu: 3.0 current loss: 692.6211687622557 [...] ENDED ON STEP: 100, FINAL LOSS: 0.012346989371823602 VALIDATION LOSS: 0.01859463694102034</code> </pre> <br><p>  100  LM  mse    10  ,   40  . </p><br><p>       .   ,         .  ,        <a href="https://github.com/empathy87/nn-samples/blob/master/tf/LevenbergMarquardt/rosenbrock_train.py">rosenbrock_train.py</a> . </p><br><h4 id="poznakomimsya-s-mnogomernym-variantom-funkcii-rozenbroka">       </h4><br><p>    2D   .         .      .          ,     " " ( <em>curse of dimentionality</em> , Bellman, 1961).     <a href="https://habr.com/post/416551/"> .      </a> . </p><br><p>      : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3794">f</span><span class="MJXp-mo" id="MJXp-Span-3795" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3796">x</span><span class="MJXp-mo" id="MJXp-Span-3797" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3798" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3799"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3805" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3806">N</span><span class="MJXp-mo" id="MJXp-Span-3807">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3808">1</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-3800" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3801" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3802">i</span><span class="MJXp-mo" id="MJXp-Span-3803">=</span><span class="MJXp-mn" id="MJXp-Span-3804">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3809"><span class="MJXp-mo" id="MJXp-Span-3810" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">[</span></span><span class="MJXp-mn" id="MJXp-Span-3811">100</span><span class="MJXp-mo" id="MJXp-Span-3812" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3814" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3815" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3816">i</span><span class="MJXp-mo" id="MJXp-Span-3817">+</span><span class="MJXp-mn" id="MJXp-Span-3818">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3819" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-3820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3821" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-3824">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3823">i</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3825"><span class="MJXp-mo" id="MJXp-Span-3826" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3827" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3828" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3829" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3830">1</span><span class="MJXp-mo" id="MJXp-Span-3831" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-3832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3833" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3834" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3835">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3836"><span class="MJXp-mo" id="MJXp-Span-3837" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3838" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3839" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3840" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3841">x</span><span class="MJXp-mo" id="MJXp-Span-3842" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3843" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3845" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3846" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3847" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span><span class="MJXp-msubsup" id="MJXp-Span-3848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3849" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3850" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3851">N</span></span></span><span class="MJXp-mo" id="MJXp-Span-3852" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3853" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-3854"><span class="MJXp-mrow" id="MJXp-Span-3855" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3856">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3857" style="vertical-align: 0.5em;">N</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-186-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-186">f(\boldsymbol{x}) = \sum_{i=1}^{N-1}\left [ 100(x_{i+1} - x_{i}^2)^2 + (1-x_{i})^2 \right ], \boldsymbol{x}=[x_1 \cdots x_{N}]\in \mathbb{R}^N</script></p><br><p>    <a href="https://github.com/empathy87/nn-samples/blob/master/tf/LevenbergMarquardt/rosenbrock_train.py">rosenbrock_train.py</a>   <em>get_rand_rosenbrock_points</em> . </p><br><h4 id="polnocenno-proverim-algoritm-levenberga-markvadta">    - </h4><br><p>     - : " <em>!    4 ,     300!</em> ".   ,   ( <em></em> )    -. , ,  .  -   .  .  :       ?  ,          .   .          ,      - : </p><br><ol><li> 10 000  6D  . </li><li>    3   12, 10, 8 (311 ). </li><li>   . </li><li> 3.5    . </li></ol><br><p>              .     -   2 .      LM       .      20 . </p><br><img src="https://habrastorage.org/webt/nl/b1/-u/nlb1-ut2rftvgoleqzsl4o1e2ze.jpeg"><br><p>    <a href="https://github.com/empathy87/nn-samples/blob/master/tf/LevenbergMarquardt/rosenbrock_train.py">rosenbrock_train.py</a> .   .         ,      . </p><br><h4 id="zaklyuchenie">  Conclusion </h4><br><p>  ,        .  " ",    ,     .      ,      .   ,    273 .  - ,        . </p><br><p>   ,   : </p><br><ol><li>    . </li><li>    (   )  -: <br> [1] Petros Drineas, Ravi Kannan, and Michael W. Mahoney. 2006. Fast Monte Carlo Algorithms for Matrices I: Approximating Matrix Multiplication. SIAM J. Comput. 36, 1 (July 2006), 132-157. DOI= <a href="http://dx.doi.org/10.1137/S0097539704442684">http://dx.doi.org/10.1137/S0097539704442684</a> <br> [2] Adelman, M., &amp; Silberstein, M. (2018). Faster Neural Network Training with Approximate Tensor Operations. CoRR, abs/1805.08079. </li></ol><br><p> ,  -     .      ,      .      "". </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/428183/">https://habr.com/ru/post/428183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../428173/index.html">Prettier, ESLint, Husky, Lint-Staged and EditorConfig: neat code writing tools</a></li>
<li><a href="../428175/index.html">Sly prefix C tree implementation</a></li>
<li><a href="../428177/index.html">So what is wrong with finding a job / IT worker?</a></li>
<li><a href="../428179/index.html">At the Japanese auction, a prototype Wii controller appeared, which was developed for the GameCube</a></li>
<li><a href="../428181/index.html">Moral Machine: merciless or meaningless?</a></li>
<li><a href="../428187/index.html">How to write an extension for GNOME Shell: ‚ÄúDo Not Disturb‚Äù mode</a></li>
<li><a href="../428189/index.html">Who is a Paladin?</a></li>
<li><a href="../428191/index.html">What should we arrange a hackathon, or How do we conduct an internal hackathon</a></li>
<li><a href="../428193/index.html">Pro departure tours</a></li>
<li><a href="../428197/index.html">Effective personal finance. Level 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>