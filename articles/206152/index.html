<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tuning mooedit, work on the bugs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first part, syntax check and formatting of Perl sources in mooedit were added . If there were no problems with the first one, then when formatt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tuning mooedit, work on the bugs</h1><div class="post__text post__text-html js-mediator-article">  In the <a href="http://habrahabr.ru/post/205328/">first part,</a> syntax check and formatting of Perl sources in <a href="https://sourceforge.net/projects/mooedit/">mooedit were added</a> .  If there were no problems with the first one, then when formatting I had to refuse to display errors in the notification area.  But since then a new version has appeared in the <a href="https://sourceforge.net/projects/mooedit/files/medit/unstable-1.1.9x/">unstable-1.1.9x branch</a> .  Nothing particularly unstable in version <i>1.1.97-devel</i> did not notice, except that the workpiece for the long-awaited code folding.  But at least one nice change appeared in the internal API. <br><br><a name="habracut"></a><br>  Previously, it was impossible to choose where to display the result of the utilities: in the editor window (formatted source code) or in the notification area (error messages).  Now you can get an object for output, the code for Lua and Python scripts is exactly the same: <br><br><pre><code class="lua hljs">obj = window.get_output() obj.clear() obj.set_filter_by_id(<span class="hljs-string"><span class="hljs-string">"default"</span></span>) obj.write_with_filter(<span class="hljs-string"><span class="hljs-string">"-,   "</span></span>) window.present_output()</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First of all, we change the <b>~ / bin / perlsyntax</b> script a <b>bit</b> , add the return of the <b>exit</b> code to it: <br><br><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/perl use strict; die "Usage: $0 file\n" unless $ARGV[0]; my $out = `/usr/bin/perl -c $ARGV[0] 2&gt;&amp;1`; my $rc = ($out =~ s|^(.*) at (($ARGV[0]) line (\d+))(.*)$|$3:$4 $1$5|gm); print $out; exit $rc; # 0 -  </span></span></code> </pre> <br><br>  And modify the script to format the source: <br><br><pre> <code class="lua hljs">filename = doc.get_filename() codefile = <span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">tmpname</span></span>() rc = <span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">execute</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">"/home/klopp/bin/perlsyntax \"%s\" &gt; \"%s\" 2&gt;&amp;1"</span></span>,filename,codefile)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> rc == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> tidyfile = <span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">tmpname</span></span>() <span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">execute</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">"/usr/bin/perltidy -nsak=\"if elsif unless for while\" -pt=0 -i=4 -bl -vt=2 -vtc=2 -boc -st \"%s\" &gt; \"%s\""</span></span>,filename,tidyfile)) out = <span class="hljs-built_in"><span class="hljs-built_in">io</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">open</span></span>(tidyfile,<span class="hljs-string"><span class="hljs-string">"r"</span></span>) doc.select_all() doc.replace_selected_text(out:<span class="hljs-built_in"><span class="hljs-built_in">read</span></span>(<span class="hljs-string"><span class="hljs-string">"*a"</span></span>)) doc.save() <span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">remove</span></span>(tidyfile) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> out = <span class="hljs-built_in"><span class="hljs-built_in">io</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">open</span></span>(codefile,<span class="hljs-string"><span class="hljs-string">"r"</span></span>) err = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">format</span></span>(<span class="hljs-string"><span class="hljs-string">"Run syntax check!\n\n%s"</span></span>,out:<span class="hljs-built_in"><span class="hljs-built_in">read</span></span>(<span class="hljs-string"><span class="hljs-string">"*a"</span></span>)) o = window.get_output() o.clear() o.set_filter_by_id(<span class="hljs-string"><span class="hljs-string">"default"</span></span>) o.write_with_filter(err) window.present_output() <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-built_in"><span class="hljs-built_in">os</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">remove</span></span>(codefile)</code> </pre> <br><br>  Now, in case of errors, the source in the editor window will not change, and the output of these errors will appear in the notification area.  And clicking on the line with the error will move us to the same line in the editor window. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/147/d0b/aac/147d0baac8fc949203c23f309c220797.png" width="797" height="373"><br><br>  The utility settings are: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/de9/288/c0e/de9288c0ed422b78e253366c1a955bce.png" width="760" height="524"><br><br>  Additionally, create a utility to run the script directly from the editor.  You can, of course, as before - just run <b>/ usr / bin / perl "$ DOC_PATH"</b> .  But in case of errors we will not get clickable output in the notification area.  Therefore, we will first check the source, if everything is good, run the script, and output the modified messages in case of errors.  To do this, create <b>~ / bin / perlrun</b> with the following contents: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh rc=`/home/klopp/bin/perlsyntax $1` if [ "$?" -eq 0 ] ; then /usr/bin/perl $1 else echo $rc fi</span></span></code> </pre> <br><br>  And we will register its launch in the utility with such settings: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5d/fb4/8c2/a5dfb48c259c659043ae255b4120d5da.png" width="758" height="526"><br><br>  We are waiting for the next version of the editor, maybe something else interesting will appear :) </div><p>Source: <a href="https://habr.com/ru/post/206152/">https://habr.com/ru/post/206152/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../206142/index.html">Arcanum and Fallout 2 with touch screen and stylus in Windows 8</a></li>
<li><a href="../206144/index.html">The power of a word. How a simple explanation saved user relationships.</a></li>
<li><a href="../206146/index.html">We buy train tickets in the New Year</a></li>
<li><a href="../206148/index.html">Creating your own drivers for Linux</a></li>
<li><a href="../206150/index.html">The second life of old dial gauges</a></li>
<li><a href="../206154/index.html">rusEfi: ignition and other buns</a></li>
<li><a href="../206160/index.html">Basics of developing a client network I2P. Part 2</a></li>
<li><a href="../206164/index.html">Startups from Silicon Valley with Russian-speaking founders. Jacob Diener and Igor Katsman - the founders of Driveway Software</a></li>
<li><a href="../206166/index.html">Private space - Per aspera ad astra</a></li>
<li><a href="../206168/index.html">Overview of switches with 24 10Gb optical ports</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>