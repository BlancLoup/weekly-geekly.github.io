<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 40: vulnerabilities in CMS Drupal and not only</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last week, the developers of CMS Drupal closed ( news , more on their site ) just two critical vulnerabilities. Both issues affect Drupal versions 7.x...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 40: vulnerabilities in CMS Drupal and not only</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ld/y3/3l/ldy33lcutdaiynrjiffy11ike_0.png" align="right">  Last week, the developers of CMS Drupal closed ( <a href="https://threatpost.ru/remote-code-execution-flaws-patched-in-drupal-7-and-8/28816/">news</a> , more <a href="https://www.drupal.org/sa-core-2018-006">on their site</a> ) just two critical vulnerabilities.  Both issues affect Drupal versions 7.x and 8.x.  The most serious vulnerability was found in the built-in e-mail sending system (DefaultMailSystem :: mail ()).  You can use it in such a way that when processing a message it becomes possible to execute arbitrary code.  The reason is, as usual, the lack of proper verification of a number of variables. <br><br>  The second vulnerability is found in the Contextual Links module - it allows modifying elements of web pages without switching to the control panel.  Failure to verify the parameters passed during the execution of such a request may also lead to the execution of the code.  However, unlike the first vulnerability, this one is exploited only if the attacker already has the rights to edit the site. <br><br>  Such news usually does not get into the digest: well, found, well, closed, well done!  But at least once a year you should look at the most popular content management systems and understand in perspective how things are going with security.  Is there a fragmentation of CMS versions, similar, for example, to the fragmentation of the Android platform?  Is everything so bad with security, as, for example, in the industry of those IoT devices, which are not even IoT devices, but routers and cameras?  Let's get a look. <br><a name="habracut"></a><br>  First you need to understand where to look.  Enough detailed information about the use of a CMS gives <a href="https://w3techs.com/">Web Technology Surveys</a> .  The authors of the resource regularly scan the 10 million most visited sites on the Internet (according to the Alexa rating of the service) and analyze the content management systems used.  The general results of the study can be viewed <a href="https://w3techs.com/technologies/overview/content_management/all/">on this page</a> , here is the graph from there: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/af/1v/ic/af1vic83ge4mzfinzen7o1n-uf8.png"></div><br>  Well, firstly, it was not possible to get information about CMS for 46.1% of sites; more precisely, none of the systems that this service can reliably identify are used there.  Among those sites where CMS has been identified, the undisputed leader is Wordpress, a sort of Android CMS market.  Joomla and Drupal occupy the second and third places with a significant lag, and then in Top10 there are mainly services offering the creation of a ready-made website on their own platform, for those who need to be simpler and faster.  In aggregate, Joomla, Drupal and Wordpress are installed on 68.8% of sites with well-known CMS, or 37.2% of all sites out of the 10 million studied. <br><br>  There is already a fragmentation at the level of the choice of CMS: Wordpress is the clear leader, but even it is installed on only a third of online resources, and half of the sites generally work incomprehensibly on what.  Perhaps, there is a gloomy admin that is still old-school uploading static HTML via FTP.  It is difficult to draw conclusions from this diversity: on the one hand, fragmentation complicates the life of an attacker, on the other - no one really knows how the security situation is in about half of the Internet.  In cryptography, self-written encryption algorithms have long been equated to a sharply sharpened rake.  Should web management be different? <br><br>  Let's look at the distribution of versions for the three most popular CMS.  Here is the distribution for wordpress.  w3techs update their reports daily, so the information is expected to be the latest. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ob/fj/oy/obfjoyxekapl-sg0jj_drsruahw.png"></div><br>  Somehow boring even.  Let's look at the details of the current version 4.x: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mt/zk/vw/mtzkvwmblitebjhfid36dba-z6s.png"></div><br>  Slightly more than 70% of Wordpress websites use (as of the publication date) the most up-to-date version (excluding regular updates of the main release).  This, of course, is a more pleasant distribution than Android, where the current version 8.x <a href="https://developer.android.com/about/dashboards/">uses</a> 19.2% of devices, but not as much as we would like. <br><br>  And there is something to fear?  Let's look at the <a href="https://codex.wordpress.org/Current_events">history of versions of</a> Wordpress.  Version 4.9 was released on November 15, 2017, that is, WordPress 4.8 and earlier versions have been outdated for almost a year.  Since the release of version 4.9, at least four CMS updates have been sent to fix vulnerabilities.  How serious the risk of each of them is is a subject for a more detailed study, although absolutely no critical bugs have been observed over the past year.  However, the July <a href="https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/">release of</a> 4.9.7 closes the vulnerability, which, under certain conditions, allows deleting files outside the Uploads folder. <br><br>  Let's see how the hero of last week is doing - CMS Drupal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rr/ss/um/rrssumaermhv2nutv1uh9btl5fk.png"></div><br>  So it goes.  The latest version of Drupal 8.x is used by 11.8% of the sites that generally use Drupal.  The most popular is the previous (note for the sake of justice - supported) release 7.x.  Specification on specific releases within the framework of the main branch of w3techs does not, so suppose that everyone has already been updated (this, of course, is a bold assumption).  In any case, almost 10% of Drupal sites use unsupported versions 4.x ‚Äì 6.x. <br><br>  The situation for CMS Joomla is as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y5/v1/rd/y5v1rdx7e7w0kexsnhypnrinf_e.png"></div><br>  The current version of Joomla 3.8.13 was released recently - October 9th.  You can see what proportion of sites updated to the latest version in such a short time. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/f4/8h/f0/f48hf0tqenpboberlskcxr-qsoe.png"></div><br>  14.1% of all users of the branch 3.8.  Or 5.8% of all Joomla users are those who managed to update the site to the latest version in 13 days.  What are the consequences if you do not update the CMS on time?  Switch back to Wordpress examples, as this is the most popular and most cracked web content management system.  So (all of a sudden), reports on practical hijacking of sites for malicious activity are mostly not related to the core Wordpress code, but to its plugins. <br><br>  Here, for example, last year's <a href="https://threatpost.ru/ujazvimost_0-day_v_plaginah_wordpress_pod_atakoj/22596/">news</a> about plugins actually attacked, including, for example, the Flickr Gallery plugin.  In December 2017, Wordpress <a href="https://threatpost.ru/wordpress-closes-three-more-backdoored-plugins/23961/">blocked</a> three more plugins - all of them were sold by the creators, and the new owners introduced backdoors into them.  Here is another <a href="https://threatpost.ru/backdoored-plugins-on-abandoned-wordpress-sites-a-major-problem/23955/">analysis of the</a> use of plug-ins that have long been abandoned by developers, have critical vulnerabilities and are still used on hundreds of sites. <br><br>  And it's not just plugins.  Repeatedly, a brute force password is mentioned as a working method for attacking Wordpress sites (for example, <a href="https://threatpost.ru/tikhij_brutfors_wordpress_s_usileniem/12656/">here</a> and <a href="https://threatpost.ru/massive-brute-force-wordpress-to-mine-monero/23870/">here</a> ).  And this problem is also beyond the capabilities of Wordpress developers.  Making it difficult for bruteforce and not to use simple passwords is the task of the administrator and site users, not the developers. <br><br>  What happens when a site is successfully hacked?  Above, I refer to the news about the installation of miners, although most often on sites appear classic malicious scripts.  An indicative case occurred in the summer of this year: in July, the CoinDash marketplace was <a href="https://threatpost.ru/coindash-hacked-during-its-ico/21968/">hacked</a> , and moreover during the fund-raising campaign of the ICO.  How exactly hacked the site - not reported, it could not necessarily be a vulnerability in Wordpress.  But the result is obvious: in the first phase of collecting funds from privileged participants on the site, they simply changed the wallet number to transfer funds, as a result of which $ 7.7 million in cryptocurrency equivalent went to the intruders.  There is an interesting <a href="https://www.reddit.com/r/ethereum/comments/6nsy6x/coindash_website_hacked_55_mil_gone/dkc0zv9/">discussion</a> on Reddit about this: would it not be safer to make a static page in critical cases?  Oh, not sure what is safer. <br><br>  According to the results of this mini-study, a clear question arises: is it necessary to update the CMS code, if critical vulnerabilities are not always, hacking sites are often done through plug-ins, or even brute-force passwords?  As in the case of <a href="https://habr.com/company/kaspersky/blog/425701/">routers</a> , a set of measures brings real benefits: updating the CMS, revising the list of installed plug-ins and regularly updating the really needed ones, changing the admin URL, strong passwords, multi-factor authentication, and just user auditing.  Website security (and anything else) is a process, not a result. <br><br>  To add to the list of cases a regular check of the CMS version is not that difficult.  If your site is managed by a third-party organization, it will not be superfluous to separately discuss the issue of regularly installing updates.  If you have once ‚Äúset up a site‚Äù, and since then it ‚Äújust works‚Äù without any support, you have problems.  As we have seen today, even such a simple measure for enhancing the security of a web site, like updating a code, is used by no means all. <br><br>  <i>Disclaimer: The opinions expressed in this digest may not always coincide with the official position of Kaspersky Lab.</i>  <i>Dear editors generally recommend to treat any opinions with healthy skepticism.</i> </div><p>Source: <a href="https://habr.com/ru/post/427351/">https://habr.com/ru/post/427351/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../427341/index.html">Learn to give thanks: this is the best you can give to others and the best way to develop ‚Äúuseful social connections‚Äù</a></li>
<li><a href="../427343/index.html">VK Mobile Challenge 2018</a></li>
<li><a href="../427345/index.html">Problems of modern writing of mathematical texts</a></li>
<li><a href="../427347/index.html">Transition to Google Cloud Platform (Google Cloud Platform - GCP)</a></li>
<li><a href="../427349/index.html">Programmer for the new tinyAVR family based on the cheap Chinese CH340 converter</a></li>
<li><a href="../427353/index.html">Drones show: how we coordinated a swarm of dancing kopter</a></li>
<li><a href="../427355/index.html">CJM compilation, key art director skills and user understanding</a></li>
<li><a href="../427357/index.html">Writing Shaders in Unity. GrabPass, PerRendererData</a></li>
<li><a href="../427359/index.html">How ECS, C # Job System and SRP change the approach to architecture</a></li>
<li><a href="../427361/index.html">Features of window filtering on FPGA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>