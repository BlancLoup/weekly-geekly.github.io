<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing applications with .EXE installers using GPO</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is no secret to anyone that in organizations the installation of applications on client computers should be (or, frankly, it is recommended that it...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing applications with .EXE installers using GPO</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/7d8/c79/378/7d8c793783f34a2a1e18a4321d65c932.png" align="right">  It is no secret to anyone that in organizations the installation of applications on client computers should be (or, frankly, it is recommended that it be) automated.  Naturally, complex products, such as Microsoft System Center Configuration Manager, can perfectly cope with such a task, however, there have always been, are and will be organizations that, for one reason or another, have not acquired such a product.  Therefore, it is necessary to install software products using the same standard tools of Windows operating systems, and for such a task, Group Policy functionality becomes preferable. <br>  Also, everyone is well aware that with the expansion of the client side of the <b>Group Policy Software Installation</b> - <b>GPSI</b> , applications can be deployed to client machines in two ways: either by publishing only to users, or by assigning to users or computers. <a name="habracut"></a><br><h2>  What are ZAP files for? </h2><br>  By and large, both MSI installers and * .zap files can be used to publish applications, and both installation packages are handled differently.  For example, the MSI software installation package file contains a database with all the necessary instructions for installing or uninstalling the application, and the <b>Windows Installer</b> service, which uses the Msi.dll library to read the * .msi files, is responsible for installing the program on the client computer.  Accordingly, on the basis of the information declared in the installation package, this service copies the program files to the hard disk, and also makes changes to the registry and performs other tasks specified in the installer.  Most often, all the information specified in the installation msi file is specified by the developer of the software being installed. <br>  However, since not all software vendors use Windows Installer installation files, in some cases it may be necessary to create low-level application packages based on a zero administration initiative (in the original it sounds like ZAW - Zero Administration for Windows), that is, * .zap files which are text files with the necessary instructions for installing the application.  After creating such a file, it must be placed in the folder with the installation package so that the client side extension can follow the installation instructions, after publishing which the application will appear in the <b>‚ÄúPrograms and Features‚Äù</b> control panel <b>component</b> and users can install it.  But, unlike the MSI-installer, zap-files have such significant limitations as, for example, the fact that you cannot configure the installation process of the application, if the installer does not contain installation parameters. <br>  Immediately I would like to note that this method is not as flexible as installing software using MSI installation packages, however, if you are unable to convert the installation file and the application must be centrally deployed, this method can be never by the way.  Since the text file contains instructions for installing an existing exe file for both 32-bit and 64-bit applications, the possibilities to install software products using this method do not include the following features: <br><ul><li>  Run applications with elevated privileges; </li><li>  Roll back changes in case of unsuccessful software installation process; </li><li>  Detection of damage to the installation process and the subsequent restoration of this process; </li><li>  Installing software components when first accessed; </li><li>  Use and embed transformation files. </li></ul><br>  And this is only the main part of those things that you cannot perform during software deployment using ZAP files.  By the way, deploying applications in this way can only be accomplished by publishing applications.  So users, as I mentioned several lines above, will be able to install such products directly from the ‚Äú <b>Install a program from the network</b> ‚Äù page of the <b>‚ÄúPrograms and Features‚Äù</b> control panel <b>component</b> . <br>  Before we begin to create such a file and try using it, solely for test purposes, to deploy such a software product as Irfan View, I think it would be right if I tell you a little about the structure of such files.  In such a file, only the first two lines are required, where such parameters as: <br><ul><li>  <b>FriendlyName</b> - that is, this is the name that will be displayed in the <b>"Programs and Features"</b> control panel <b>component</b> ; </li><li>  <b>SetupCommand</b> - this is where the path to the application installation file is defined.  Naturally, if necessary, you can specify either the UNC path or use the mapped drive.  Also, if the application can be installed with additional parameters, these parameters should be specified after the installation path. </li></ul><br>  In other words, when using this method, you should first examine all the additional parameters of the installation files for each product. <br>  In addition to these two parameters, in order to see the application version and other information in the <b>‚ÄúProgram</b> <b>Installation‚Äù</b> extension CSE or in the <b>Programs and Features</b> control panel component, you can add several additional parameters while writing such a file.  For example, the following optional parameters are considered the most common: <br><ul><li>  <b>DisplayVersion = 2.13.1.5</b> .  As you understand, this parameter is responsible for the displayed version of the software; </li><li>  <b>Publisher</b> is the name of the company that produces the application.  This name will be displayed in the <b>‚ÄúPrograms and Features‚Äù</b> control panel <b>component,</b> as well as in the <b>‚ÄúProgram Installation‚Äù</b> client side extension itself; </li><li>  <b>URL</b> - naturally, this is an Internet address intended for obtaining additional information about the application. </li></ul><br><h2>  Limitations of ZAP Files </h2><br><img src="https://habrastorage.org/storage2/a80/513/26e/a8051326e96356d3e5950509b4bb7ce2.jpg" align="left">  As I have already mentioned, unlike the msi installation packages, applications deployed by means of zap files cannot be assigned to computers or users.  It is also worth noting that when installing the application using the current method, the standard installation program is launched.  In other words, besides the added parameters, with the help of any additional parameters of this file you cannot customize the software installation process.  Another limitation is the fact that the application cannot be installed as an administrator account, which can be extremely inconvenient in some cases.  That is, applications are always installed by the local administrator. <br>  When creating ZAP files, you should definitely take note of the following points (I already spoke about some of them a few lines above): <br><br><ul><li>  Firstly, due to the fact that by running the ZAP file, the installation program is simply launched, as I said before, this tool does not allow the installation process to be performed with elevated permissions, which can be implemented using MSI packages.  Therefore, if an application requests elevation during its installation, only those users for whom such permission is explicitly stated will be able to install it; </li><li>  Secondly, due to the fact that ZAP files are text documents, when saving such a file, you can accidentally create a file with the extension .zap.txt, which, for obvious reasons, will not be able to work correctly.  In other words, make sure the file is saved with the correct extension; </li><li>  Thirdly, if you have computers with 64-bit operating systems on your network, you should definitely test the installation and operation of 32-bit applications on such operating systems.  This is a very important step, as many 32-bit applications that are deployed using ZAP files can fail during their installation; </li><li>  And fourth, if you do not change its behavior when creating a ZAP file with 32-bit software, it will not be displayed in the <b>‚ÄúPrograms and Features‚Äù</b> control panel <b>component</b> under 64-bit operating systems. </li></ul><br>  I think about the purpose and application of these files intended for publishing software, you have already learned some information, and it is time to try to create and distribute the application by this method. <br>  The deployment process is as follows: first of all, information about the installation process of the software product is recorded in detail in the ZAP file.  The installer, of course, must be in a public location, otherwise it will not work.  After that you need to place the generated file in a public distribution point of the software.  This is done so that the GPO you created can localize this file.  And in the end, the GPO itself is created, it is associated with the necessary department, and with the help of the client side extension <b>‚ÄúSoftware Installation‚Äù, the</b> distributed software product is published for users. <br>  Consider these processes, starting with creating the ZAP file itself. <br><h2>  Creating a ZAP file </h2><br><img src="https://habrastorage.org/storage2/075/d97/d2e/075d97d2e8a4379db56cd3f1dd83f442.jpg" align="right">  We will now publish, as I wrote above, a software product such as Irfan View, so it is advisable to download the pre-installation file from somewhere and place it in a public folder. <br>  Now, as I have already said, having simply registered the path to the executable file, during the deployment of the software, its installer will be launched for the user.  and the latter will have to go through all the steps of the wizard before the program is installed.  For many users, this will be a big problem, and for this reason, along with the path to the installation file, you need to specify the parameters intended for a silent installation.  Fortunately, this software product provides the possibility of such an installation. <br>  The Irfan View installer has a whole list of various options that can help you during a silent installation of this product.  Let's consider them: <br><ul><li>  <b>Silent</b> - performing silent installation, that is, without user intervention; </li><li>  <b>Folder</b> - destination folder.  If it is not specified with this parameter, then the old folder IrfanView will be used.  If there is none, then the ‚ÄúProgram Files \ IrfanView‚Äù folder is used; </li><li>  <b>Desktop</b> - creates a shortcut on the desktop;  0 = no, 1 = yes (default: 0); </li><li>  <b>Thumbs</b> - creates a shortcut for thumbnails;  0 = no, 1 = yes (default: 0); </li><li>  <b>Group</b> - creates a group in the Start menu;  0 = no, 1 = yes (default: 0); </li><li>  <b>Allusers</b> - desktop / start menu shortcuts for users;  0 = for the current user, 1 = for all; </li><li>  <b>Assoc</b> - allows you to set file associations;  0 = do not install, 1 = images only, 2 = select all (default: 0); </li><li>  <b>Assocallusers</b> - if this parameter is used, file associations are set for all users (works only in Windows XP); </li><li>  <b>Ini</b> - if used, sets the user folder for the INI file (system variables are valid). </li></ul><br>  Therefore, to install this software, we will use approximately the following command: <br>  <b><i>iview435_setup.exe / silent / desktop = 1 / thumbs = 1 / allusers = 1 / assoc = 1</i></b> <br>  Now that we know for sure which command will be used to install this software, we can start writing the zap file itself.  Therefore, to compile such a file, perform the following actions: <br><ol><li>  Open any text editor, for example, the same <b>Notepad</b> ; </li><li>  In the very first line of the file being created, the Application section is specified, enclosed in square brackets.  That is, we write in this line as follows: <b>[Application]</b> ; </li><li>  As I have already written above, here two lines are mandatory, namely: the string <b>FriendlyName</b> and the string <b>SetupCommand</b> .  Both in the first and in the second line the values ‚Äã‚Äãare indicated after the equal in quotes.  The sign is equally framed by spaces.  That is, we get the following lines: <br>  <b><i>FriendlyName = ‚ÄúIrfan View‚Äù</i></b> <br>  <b><i>SetupCommand = ‚Äú\\ nameserver \ Install \ ...</i></b> , and then comes the name of our installation file with all the parameters <b><i>‚Äú iview435_setup.exe ‚Äù/ silent / desktop = 1 / thumbs = 1 / allusers = 1 / assoc = 1</i></b> <br>  If necessary, you can also add comments by putting a semicolon at the beginning of the line.  For example, on a new line, add a comment where we will write how our program will be installed: <br>  <b><i>;</i></b>  <b><i>The program is installed in a quiet mode, with the creation of shortcuts on the desktop, a shortcut for thumbnails, and for all users with the association of graphic images only</i></b> </li><li>  Now we can deal with additional parameters, with the help of which we will determine the version of the program, its publisher and the URL address for support.  In other words, the <b>DisplayVersion, Publisher,</b> and <b>URL</b> parameters will be applied: <br>  <b><i>DisplayVersion = 4.35</i></b> <br>  <b><i>Publisher = IrfanView</i></b> <br>  <b><i>URL = <a href="http://www.irfanview.com/">www.irfanview.com</a></i></b> </li><li>  Save the resulting file with the zap extension.  For example, let this file be called <b>‚ÄúIrfanView.zap‚Äù</b> . <br>  In other words, you should get something like this: <br><br><img src="https://habrastorage.org/storage2/ca6/aa0/10d/ca6aa010d785b08aaf8026ff9a64ea21.png"><br>  <b>Fig.</b>  <b>1. Ready ZAP file</b> </li></ol><br>  The file is almost ready for further deployment.  We only need to place it in the public distribution point of the software.  For example, if our SDP is the Install folder, we will create the <b>ZAP Files</b> folder there and place this file there.  Is done.  Now you can go directly to the distribution of software. <br><h2>  Deploying Irfan View with a previously generated ZAP file </h2><br>  Now, at the final stage, you should go to the <b>‚ÄúGroup Policy Management‚Äù</b> snap- <b>in</b> and perform the following actions: <br><ol><li>  A new GPO is created (of course, if you wish, you can also use any of the existing GPOs), even if it is called <b>‚ÄúZAP Files Publication‚Äù</b> .  It communicates either with a specific department, which includes user accounts, or with the level of the entire domain, and from the context menu of this object, select the appropriate command to open the Group Policy Management Editor; </li><li>  After that, already being in the <b>Group Policy Management Editor</b> , we need to expand the <b>User Configuration \ Policies \ Software Settings</b> node, then go to the <b>Software Installation</b> node.  In order for the application to be published normally, you should go to the settings of this site.  In other words, select the ‚Äú <b>Properties</b> ‚Äù command from the context menu of this node; </li><li>  Here, as I have already said, so that we can publish our application without any problems, we should indicate the path to the distribution point, that is, <b>‚Äú\\ OURSERVER \ Install‚Äù</b> in the properties of this client side extension.  In addition, on the tab ‚Äú <b>Advanced</b> ‚Äù it is necessary to check the box ‚Äú <b>Make 32-bit X86 down-level (ZAP) applications available to Win64 machines</b> ‚Äù.  These settings are enough for us, we save all the changes made; 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/7e2/1f4/852/7e21f4852ff4573564c3bc576d3129de.png"><br>  <b>Fig.</b>  <b>2. Customize the CSE GPSI extension</b> </li><li>  Now you can create a software distribution policy.  In other words, from the context menu of this node, select the command intended for creating a new package.  Now in the displayed dialog box, select from the drop-down list of file types the type ‚Äú <b>ZAW Down-level applications package (* .zap)</b> ‚Äù, and then go to the folder with the previously created ZAP file.  Naturally, at this stage you should select this file, as shown in the following illustration: <br><br><img src="https://habrastorage.org/storage2/914/011/c29/914011c2949d1154a89ab298c677dadf.png"><br>  <b>Fig.</b>  <b>3. Adding a ZAP file for software deployment</b> </li><li>  Due to the fact that we don‚Äôt need to add any additional options for this package, in the <b>Deploy Software</b> dialog box that appears, among all the available options, we‚Äôll stop at ‚Äú <b>Published</b> ‚Äù and create an installation package. </li></ol><br>  Ultimately, the <b>‚ÄúSoftware Installation‚Äù</b> node of this snap-in should look like this: <br><br><img src="https://habrastorage.org/storage2/151/961/c21/151961c21f15f727657a3cc7fda4b20a.png"><br>  <b>Fig.</b>  <b>4. Snap Group Policy Management Editor after creating the package</b> <br>  Done, it remains only to check all the changes.  Now you can even update the policy settings on the current machine.  We do this by force, that is, along with the <b>Gpupdate</b> command <b>,</b> we specify the parameters <b>/ force / boor / logoff</b> . <br>  It remains only to install the published package.  To do this, we go to the control panel and go to the <b>‚ÄúPrograms and Features‚Äù</b> component.  Then, in order to get to the location where the published product will be installed, you should follow the link <b>‚ÄúInstall a program from the network‚Äù</b> . <br>  As you can see in the following illustration, here you can find our Irfan View. <br><br><img src="https://habrastorage.org/storage2/266/e9e/0f8/266e9e0f831e65efc7620325ec01aa72.png"><br>  <b>Fig.</b>  <b>5. Application available for installation</b> <br><h2>  Conclusion </h2><br>  Actually, no matter how sad it may be, on this note the process of software deployment by means of Group Policy functionality together with ZAP-files comes to an end.  From this article, you learned about what ZAP files are, in which scenarios they should be used, and when it will be necessary to dwell on other solutions.  You learned about the very syntax of such files, as well as, naturally, how you can create such a file, and then how to distribute the software using such a file.  Write in the comments, did you have to deploy software products in this way in your practice and, if it's not a secret, what applications did you deploy that way, and did you encounter any pitfalls when using this method? </div><p>Source: <a href="https://habr.com/ru/post/174743/">https://habr.com/ru/post/174743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../174733/index.html">How to count on fingers up to 3600</a></li>
<li><a href="../174735/index.html">Automated integration testing of an ASP.NET application</a></li>
<li><a href="../174737/index.html">Ultra-high-speed optical communications set a new energy efficiency record</a></li>
<li><a href="../174739/index.html">Update KB2670838 causes problems in Firefox</a></li>
<li><a href="../174741/index.html">Rusmode - a solution to the problem with the Russian layout</a></li>
<li><a href="../174745/index.html">You can not just take and look at the background page</a></li>
<li><a href="../174749/index.html">BOINC distributed computing is now available for Android devices.</a></li>
<li><a href="../174751/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ50 (March 23 - 29, 2013)</a></li>
<li><a href="../174765/index.html">Digital lenses from Intel & Mail.Ru Group - look at the world in a new way!</a></li>
<li><a href="../174769/index.html">Server on NetWare 3.12 with uptime of 16.5 years</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>