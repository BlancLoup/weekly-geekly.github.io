<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>3D engine inside SQL query</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Several years ago, at the SQL.ru forum, we decided to compare the implementations of ray tracers in different programming languages. Unfortunately, my...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>3D engine inside SQL query</h1><div class="post__text post__text-html js-mediator-article">  Several years ago, at the SQL.ru forum, we <a href="https://www.sql.ru/forum/1173809-1/tyapnichnyy-benchmark-cpu-part-1">decided to compare the</a> implementations of ray tracers in different programming languages.  Unfortunately, my application can not participate because  it does not display the words "PIXAR", so I publish it here. <br><br>  For the purity of the experiment, I used SQLite with no extensions.  It turned out that there is not even a function SQRT. <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RECURSIVE</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> n+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> n&lt;<span class="hljs-number"><span class="hljs-number">89</span></span>), pixels <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> rows.n <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, cols.n <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">col</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CROSS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> cols <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> rows.n &gt; <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> rows.n &lt; <span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> cols.n &gt; <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> cols.n &lt; <span class="hljs-number"><span class="hljs-number">89</span></span>), rawRays <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, <span class="hljs-number"><span class="hljs-number">-0.9049</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">col</span></span> * <span class="hljs-number"><span class="hljs-number">0.0065</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * <span class="hljs-number"><span class="hljs-number">0.0057</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> x, <span class="hljs-number"><span class="hljs-number">-0.1487</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * <span class="hljs-number"><span class="hljs-number">-0.0171</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> y, <span class="hljs-number"><span class="hljs-number">0.6713</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">col</span></span> * <span class="hljs-number"><span class="hljs-number">0.0045</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * <span class="hljs-number"><span class="hljs-number">-0.0081</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> z <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pixels), norms <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, x, y, z, (<span class="hljs-number"><span class="hljs-number">1</span></span> + x * x + y * y + z * z) / <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> rawRays), rays <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, x / n <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> x, y / n <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> y, z / n <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> z <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> norms), iters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> it, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> rays <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> rays.row, rays.col, it + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> it, v + <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*x) - <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*y) - <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-number"><span class="hljs-number">-1.1</span></span>+v*z) - <span class="hljs-number"><span class="hljs-number">0.3</span></span>, -((<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*x) * (<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*x) + (<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*y) * (<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*y) + (<span class="hljs-number"><span class="hljs-number">-1.1</span></span>+v*z) * (<span class="hljs-number"><span class="hljs-number">-1.1</span></span>+v*z)) * <span class="hljs-number"><span class="hljs-number">1.78</span></span> + <span class="hljs-number"><span class="hljs-number">0.28</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> rays <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> rays.row = iters.row <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> rays.col = iters.col <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> it &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>), lastIters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> it0.row, it0.col, it0.v <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v0, it1.v <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v1, it2.v <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v2 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> it0 <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> it1 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> it0.col = it1.col <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it0.row = it1.row <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> it2 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> it0.col = it2.col <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it0.row = it2.row <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> it0.it = <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it1.it = <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it2.it = <span class="hljs-number"><span class="hljs-number">13</span></span>), res <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, (v0 - v1) / (v1 - v2) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> lastIters) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_concat</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">substr</span></span>(<span class="hljs-string"><span class="hljs-string">'$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/|()1{}[]?-_+~&lt;&gt;i!lI;:,"^. '</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(<span class="hljs-number"><span class="hljs-number">66</span></span>, v * <span class="hljs-number"><span class="hljs-number">67</span></span>))), <span class="hljs-number"><span class="hljs-number">1</span></span>) || <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>=<span class="hljs-number"><span class="hljs-number">88</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> X<span class="hljs-string"><span class="hljs-string">'0A'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> res;</code> </pre> <br><img src="https://habrastorage.org/webt/rc/ij/id/rcijidm6diaowteac5ub1e1fnaa.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://beta.observablehq.com/%40pallada-92/sql-3d-engine">Here you can spin the cube</a> <br><br>  Under the cut line analysis of the request.  As usual, knowledge of the basics of SQL and school math is enough. <br><a name="habracut"></a><br><br>  <i>Disclaimer: I am far from the world of the database, so I will be remarks in lichku.</i> <br><br><div class="spoiler">  <b class="spoiler_title">Postgres version (UPD: thanks to the flags it began to work an order of magnitude faster, UPD2: a number of improvements, now the runtime is 150ms)</b> <div class="spoiler_text">  Thank you <a href="https://habr.com/users/xareh/" class="user_link">XareH</a> for query optimization. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> ENABLE_NESTLOOP <span class="hljs-keyword"><span class="hljs-keyword">TO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OFF</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RECURSIVE</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">89</span></span>) gs(n) ), pixels <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> rows.n <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, cols.n <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">col</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CROSS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> cols <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> rows.n &gt; <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> rows.n &lt; <span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> cols.n &gt; <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> cols.n &lt; <span class="hljs-number"><span class="hljs-number">89</span></span>), rawRays <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, <span class="hljs-number"><span class="hljs-number">-0.9049</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">col</span></span> * <span class="hljs-number"><span class="hljs-number">0.0065</span></span> ::<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * <span class="hljs-number"><span class="hljs-number">0.0057</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> x, <span class="hljs-number"><span class="hljs-number">-0.1487</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * <span class="hljs-number"><span class="hljs-number">-0.0171</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> y, <span class="hljs-number"><span class="hljs-number">0.6713</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">col</span></span> * <span class="hljs-number"><span class="hljs-number">0.0045</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * <span class="hljs-number"><span class="hljs-number">-0.0081</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> z <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pixels), norms <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, x, y, z, (<span class="hljs-number"><span class="hljs-number">1</span></span> + x * x + y * y + z * z) / <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> rawRays), rays <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, x / n <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> x, y / n <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> y, z / n <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> z <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> norms), iters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> it, <span class="hljs-number"><span class="hljs-number">0.0</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">precision</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> rays <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> rays.row, rays.col, it + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> it, v + <span class="hljs-keyword"><span class="hljs-keyword">GREATEST</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-number"><span class="hljs-number">0.7</span></span> +v*x) - <span class="hljs-number"><span class="hljs-number">0.3</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-number"><span class="hljs-number">0.7</span></span> +v*y) - <span class="hljs-number"><span class="hljs-number">0.3</span></span> , <span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-number"><span class="hljs-number">-1.1</span></span> +v*z) - <span class="hljs-number"><span class="hljs-number">0.3</span></span> , -(<span class="hljs-number"><span class="hljs-number">0.28</span></span> + ((<span class="hljs-number"><span class="hljs-number">0.7</span></span> +v*x) * (<span class="hljs-number"><span class="hljs-number">0.7</span></span> +v*x) + (<span class="hljs-number"><span class="hljs-number">0.7</span></span> +v*y) * (<span class="hljs-number"><span class="hljs-number">0.7</span></span> +v*y) + (<span class="hljs-number"><span class="hljs-number">-1.1</span></span> +v*z) * (<span class="hljs-number"><span class="hljs-number">-1.1</span></span> +v*z)) / <span class="hljs-number"><span class="hljs-number">0.28</span></span> ) / <span class="hljs-number"><span class="hljs-number">2.0</span></span> + <span class="hljs-number"><span class="hljs-number">0.42</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> rays <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> rays.row = iters.row <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> rays.col = iters.col <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> it &lt; <span class="hljs-number"><span class="hljs-number">15</span></span>), lastIters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> it0.row, it0.col, it0.v <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v0, it1.v <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v1, it2.v <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v2 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> it0 <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> it1 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> it0.col = it1.col <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it0.row = it1.row <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> it2 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> it0.col = it2.col <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it0.row = it2.row <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> it0.it = <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it1.it = <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it2.it = <span class="hljs-number"><span class="hljs-number">13</span></span>), res <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, (v0 - v1) / (v1 - v2) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> lastIters) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> string_agg(<span class="hljs-keyword"><span class="hljs-keyword">substring</span></span>(<span class="hljs-string"><span class="hljs-string">'$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/|()1{}[]?-_+~&lt;&gt;i!lI;:,"^. '</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">GREATEST</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">LEAST</span></span>(<span class="hljs-number"><span class="hljs-number">66</span></span>, v * <span class="hljs-number"><span class="hljs-number">67</span></span>)))::<span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>) || <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>=<span class="hljs-number"><span class="hljs-number">88</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> E<span class="hljs-string"><span class="hljs-string">'\n'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">text</span></span> <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">col</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> res; <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> ENABLE_NESTLOOP <span class="hljs-keyword"><span class="hljs-keyword">TO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>;</code> </pre><br></div></div><br>  To understand the terminology and the principle of the algorithm, it is recommended to read the <a href="https://habr.com/post/353422/">article about ray marching for Excel</a> . <br><br><h1>  General structure </h1><br>  List of intermediate tables: <br><br><ul><li>  <code>numbers (n)</code> - contains numbers from 0 to 89. </li><li>  <code>pixels (row, col)</code> - contains the number of the row and column for each "pixel". </li><li>  <code>rawRays (row, col, x, y, z)</code> - contains unnormalized rays from camera to <i>screen</i> . </li><li>  <code>norms (row, col, x, y, z, n)</code> - contains the lengths of the rays. </li><li>  <code>rays (row, col, x, y, z)</code> - contains normalized rays from camera to <i>screen</i> . </li><li>  <code>iters (row, col, it, v)</code> - contains ray marching iterations. </li><li>  <code>lastIters (row, col, v0, v1, v2)</code> - contains the last three iterations from the previous table for each "pixel". </li><li>  <code>res (col, v)</code> - contains the "brightness" of pixels. </li></ul><br><br>  Regarding how they depend on each other, everything is simple: each following table uses only the previous one, and the final query uses only the <code>res</code> table. <br><br>  All tables (except for <code>numbers</code> and <code>iters</code> ) contain 81 x 29 lines (one for each "pixel"), the columns <code>row</code> and <code>col</code> index their coordinates.  The <code>iters</code> table contains 81 x 29 x 15 rows (one for each iteration of ray marching for each ‚Äúpixel‚Äù).  The iteration number is in the <code>it</code> column. <br><br>  The final query produces a table from a single row and a column with text, all other tables contain only real numbers (the <code>row</code> , <code>col</code> and <code>it</code> columns are non-negative integers). <br><br>  It turns out, if you omit the auxiliary tables, a very simple query structure: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RECURSIVE</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ...), pixels <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ...), rawRays <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ...), normsSq <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ...), norms <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ...), rays <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ...), iters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ...), lastIters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ...), res <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ...) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_concat</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">substr</span></span>(<span class="hljs-string"><span class="hljs-string">'$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/|()1{}[]?-_+~&lt;&gt;i!lI;:,"^. '</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(<span class="hljs-number"><span class="hljs-number">66</span></span>, v * <span class="hljs-number"><span class="hljs-number">67</span></span>))), <span class="hljs-number"><span class="hljs-number">1</span></span>) || <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>=<span class="hljs-number"><span class="hljs-number">88</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> X<span class="hljs-string"><span class="hljs-string">'0A'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> res;</code> </pre><br><h1>  Recursive queries </h1><br>  Here is the standard way to get a table containing numbers from 0 to 89: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RECURSIVE</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> n+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> n&lt;<span class="hljs-number"><span class="hljs-number">89</span></span> ) ...</code> </pre><br><ul><li>  Recursive queries work only in the <code>WITH</code> construct.  Note that the name given to the table is used in its definition. </li><li>  <code>SELECT 0 as n</code> is the string from which the recursive query begins. </li><li>  <code>UNION ALL</code> means that all the resulting rows are concatenated into one table without additional checks.  If you write just <code>UNION</code> , all duplicates will be deleted. </li><li>  <code>SELECT n+1 FROM numbers WHERE n&lt;80</code> .  The important caveat here is that the <code>numbers</code> table always contains one row with the previous number.  At some point, the condition in <code>WHERE</code> cut and it and the query will stop.  Only after this, all previous table states will be joined by the <code>UNION ALL</code> operation. </li></ul><br><h1>  Extract the square root </h1><br>  We will use the <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D1%2582%25D0%25B5%25D1%2580%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D1%2583%25D0%25BB%25D0%25B0_%25D0%2593%25D0%25B5%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B0">method of Heron</a> (Babylonian method) to calculate the root.  Let's say we want to compute <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">t</span><span class="MJXp-mrow" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">S</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.128ex" height="2.419ex" viewBox="0 -780.1 2638.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-71" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="1631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-53" x="1993" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ sqrt {S} </script>  .  We are building a row <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-12" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-16" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-18">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.383ex" height="2.419ex" viewBox="0 -780.1 5331.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2C" x="1026" y="0"></use><g transform="translate(1471,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-31" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2C" x="2497" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6C" x="3193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-64" x="3491" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6F" x="4015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="4500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-73" x="4862" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> x_0, x_1, \ ldots </script>  according to the following formula: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-24"><span class="MJXp-msubsup" id="MJXp-Span-25"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-27" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">n</span><span class="MJXp-mo" id="MJXp-Span-29">+</span><span class="MJXp-mn" id="MJXp-Span-30">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-32">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">c</span><span class="MJXp-mrow" id="MJXp-Span-37"><span class="MJXp-msubsup" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-40" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-42">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">c</span><span class="MJXp-mrow" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">S</span></span><span class="MJXp-mrow" id="MJXp-Span-49"><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-53"><span class="MJXp-mn" id="MJXp-Span-54">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.635ex" height="2.539ex" viewBox="0 -780.1 12328.7 1093.4" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2B" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-31" x="1379" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-3D" x="2279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-66" x="3585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="4136" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="4587" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-63" x="5117" y="0"></use><g transform="translate(5550,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6E" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2B" x="1319" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-66" x="2570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="3120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="3572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-63" x="4101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-53" x="4535" y="0"></use><g transform="translate(5180,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6E" x="809" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="11828" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> x_ {n + 1} = \ frac {x_n + \ frac {S} {x_n}} {2} </script></p><br><br>  The logic of the method is very simple: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-55"><span class="MJXp-mtext" id="MJXp-Span-56">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">t</span><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">S</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.128ex" height="2.419ex" viewBox="0 -780.1 2638.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-71" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="1631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-53" x="1993" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> \ sqrt {S} </script>  always lies between <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> x </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mtext" id="MJXp-Span-66">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">c</span><span class="MJXp-mrow" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">S</span></span><span class="MJXp-mrow" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.973ex" height="2.419ex" viewBox="0 -780.1 3433 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-53" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="2860" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> \ frac {S} {x} </script>  for any number <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> x </script>  .  Therefore, it is natural to take the middle of the segment between these numbers as an approximation. <br><br>  Geometrically, this can be represented as: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5e/0q/io/5e0qiod9v8uvfixv88dvwtnxhec.png" width="350"></div><br><br>  Each following value brings the root closer and better, in one step the error decreases at least twice. <br><br>  Initial value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-msubsup" id="MJXp-Span-78"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-80" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.384ex" height="1.817ex" viewBox="0 -520.7 1026.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30" x="809" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> x_0 </script>  can be any positive number, for example 1. In the Quake game, the <a href="https://habr.com/company/infopulse/blog/336110/">magic constant 0x5f3759df was</a> used for this (more precisely, it was used for the inverted square root, however a similar method <a href="http://www.lomont.org/Math/Papers/2003/InvSqrt.pdf">can be invented</a> for a normal root), but, unfortunately, there is no SQL access to the binary representation of floating-point numbers. <br><br>  In this article, the root is needed in two places: <br><br><ul><li>  when normalizing vectors leaving the camera: ray marching strongly depends on distances, and in order to postpone them, a vector of length 1 is needed. </li><li>  when calculating the distance to the border of the sphere, which is cut from the square. </li></ul><br><br>  In the first case, the values ‚Äã‚Äãare in a narrow range. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-83">0.7</span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-85">1.5</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.271ex" height="2.66ex" viewBox="0 -832 3561.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-37" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2C" x="1558" y="0"></use><g transform="translate(2003,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-35" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-5D" x="3282" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> [0.7, 1.5] </script>  and the initial approximation 1 is perfect.  In the second case, collecting statistics on calls, got the average value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-87"><span class="MJXp-mn" id="MJXp-Span-88">0.28</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.134ex" height="1.937ex" viewBox="0 -728.2 1780 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-38" x="1279" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> 0.28 </script>  which was taken as initial. <br><br>  It turned out that with the correct initial value <b>, one iteration is enough</b> !  That is, in our case, the root is approximated by a linear function: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">r</span><span class="MJXp-msubsup" id="MJXp-Span-93"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-95" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">x</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-99" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-100">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">c</span><span class="MJXp-mrow" id="MJXp-Span-105"><span class="MJXp-mn" id="MJXp-Span-106">1</span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">x</span></span><span class="MJXp-mrow" id="MJXp-Span-109"><span class="MJXp-mn" id="MJXp-Span-110">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.979ex" height="2.66ex" viewBox="0 -832 9893.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-71" x="469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="930" y="0"></use><g transform="translate(1381,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-31" x="511" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-28" x="2196" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="2586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-29" x="3158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-3D" x="3826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-66" x="5132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="5682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="6134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-63" x="6663" y="0"></use><g transform="translate(7097,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2B" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="1723" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="9393" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> sqrt_1 (x) = \ frac {1 + x} {2} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">r</span><span class="MJXp-msubsup" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-117" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">x</span><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-122">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">c</span><span class="MJXp-mrow" id="MJXp-Span-127"><span class="MJXp-mn" id="MJXp-Span-128">0.28</span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-130">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">c</span><span class="MJXp-mrow" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">x</span></span><span class="MJXp-mrow" id="MJXp-Span-137"><span class="MJXp-mn" id="MJXp-Span-138">0.28</span></span></span><span class="MJXp-mrow" id="MJXp-Span-139"><span class="MJXp-mn" id="MJXp-Span-140">2</span></span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-142">0.14</span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-144">1.78</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">x</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.767ex" height="2.66ex" viewBox="0 -832 21857.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-71" x="469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="930" y="0"></use><g transform="translate(1381,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="511" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-28" x="2196" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="2586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-29" x="3158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-3D" x="3826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-66" x="5132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="5682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="6134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-63" x="6663" y="0"></use><g transform="translate(7097,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-38" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2B" x="2002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-66" x="3252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="3803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="4254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-63" x="4784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="5217" y="0"></use><g transform="translate(5790,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-38" x="1279" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="14667" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-3D" x="15446" y="0"></use><g transform="translate(16502,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-31" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-34" x="1279" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2B" x="18504" y="0"></use><g transform="translate(19505,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-37" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-38" x="1279" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="21285" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> sqrt_2 (x) = \ frac {0.28 + \ frac {x} {0.28}} {2} = 0.14 + 1.78 x </script></p><br><br><h1>  We calculate the rays from the camera </h1><br>  The task of the first four tables is to associate each ‚Äúpixel‚Äù with a three-dimensional vector of length 1 that leaves the camera and passes through the corresponding point on the <i>screen</i> . <br><br>  First you need to get a table with the desired structure, that is, with cells for which the row number and column number are indicated.  For this, the Cartesian product of a set of numbers from 0 to 89 is taken and empty lines and columns are cut from it: <br><br><pre> <code class="sql hljs">... pixels AS ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> rows.n <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, cols.n <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">col</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CROSS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> numbers <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> cols <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> rows.n &gt;= <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> rows.n &lt; <span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> cols.n &gt;= <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> cols.n &lt; <span class="hljs-number"><span class="hljs-number">89</span></span> ), ...</code> </pre><br>  Next we find unnormalized vectors.  In general, they have a long formula of trigonometric functions.  In order not to complicate the request, I fixed the camera and predicted the coefficients: <br><br><pre> <code class="sql hljs">... rawRays AS ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, <span class="hljs-number"><span class="hljs-number">-0.9049</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">col</span></span> * <span class="hljs-number"><span class="hljs-number">0.0065</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * <span class="hljs-number"><span class="hljs-number">0.0057</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> x, <span class="hljs-number"><span class="hljs-number">-0.1487</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * <span class="hljs-number"><span class="hljs-number">-0.0171</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> y, <span class="hljs-number"><span class="hljs-number">0.6713</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">col</span></span> * <span class="hljs-number"><span class="hljs-number">0.0045</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> * <span class="hljs-number"><span class="hljs-number">-0.0081</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> z <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pixels ), ...</code> </pre><br>  After that we must calculate the (approximate) lengths of these vectors by the formula <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">r</span><span class="MJXp-msubsup" id="MJXp-Span-150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-152" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.103ex" height="2.298ex" viewBox="0 -728.2 2196.9 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-71" x="469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="930" y="0"></use><g transform="translate(1381,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-31" x="511" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-13"> sqrt_1 </script>  : <br><br><pre> <code class="sql hljs">... norms AS ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, x, y, z, (<span class="hljs-number"><span class="hljs-number">1</span></span> + x * x + y * y + z * z) / <span class="hljs-number"><span class="hljs-number">2.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> rawRays ), ...</code> </pre><br>  It remains to divide the coordinates of the vectors by their length to obtain vectors of length 1: <br><br><pre> <code class="sql hljs">... rays AS (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, x / n <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> x, y / n <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> y, z / n <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> z <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> norms), ...</code> </pre><br><h1>  Ray marching iterations </h1><br>  It uses a slightly more complex construct with recursive queries, containing a <code>JOIN</code> .  We want to perform 15 iterations of the ray marching algorithm for each pixel.  If the recursive calculation of the <code>numbers</code> table each time the table contained one row, which were then combined, here the intermediate tables contain 81 x 29 rows and are calculated 15 times. <br><br>  All three-dimensional geometry is contained in the formula <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-153"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">F</span><span class="MJXp-mtext" id="MJXp-Span-157">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">n</span><span class="MJXp-mrow" id="MJXp-Span-163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">x</span><span class="MJXp-mspace" id="MJXp-Span-172" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">y</span><span class="MJXp-mspace" id="MJXp-Span-174" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">z</span><span class="MJXp-mtext" id="MJXp-Span-176">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">d</span><span class="MJXp-mrow" id="MJXp-Span-180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">x</span></span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-189">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">x</span><span class="MJXp-mtext" id="MJXp-Span-193">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">t</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-199"><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">x</span><span class="MJXp-mrow" id="MJXp-Span-202"><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-205">0.3</span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-207"><span class="MJXp-mo" id="MJXp-Span-208" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">y</span><span class="MJXp-mrow" id="MJXp-Span-210"><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-213">0.3</span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-215"><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">z</span><span class="MJXp-mrow" id="MJXp-Span-218"><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-221">0.3</span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">t</span><span class="MJXp-mo" id="MJXp-Span-229" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">r</span><span class="MJXp-msubsup" id="MJXp-Span-233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-235" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-239" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-243" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-247" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-250">0.42</span><span class="MJXp-mtext" id="MJXp-Span-251">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">t</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-258">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">t</span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="102.236ex" height="8.925ex" viewBox="0 -780.1 44017.9 3842.7" role="img" focusable="false" style="vertical-align: -7.113ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(15673,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-44" x="645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-46" x="1474" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-62" x="2473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-65" x="2903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-67" x="3369" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-69" x="3850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6E" x="4195" y="0"></use><g transform="translate(4796,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="3070" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="8438" y="0"></use></g><g transform="translate(19930,-1200)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-79" x="0" y="0"></use></g><g transform="translate(0,-2722)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-7A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-65" x="718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6E" x="1185" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-64" x="1785" y="0"></use><g transform="translate(2309,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6D" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="1382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="1911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="2273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-69" x="2724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="3070" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-3D" x="6229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6D" x="7535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="8414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="8943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6C" x="9766" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-65" x="10064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-66" x="10531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="11081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-28" x="11443" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-7C" x="11832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="12111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-7C" x="12683" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2212" x="13184" y="0"></use><g transform="translate(14185,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-33" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2C" x="15464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-7C" x="15909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-79" x="16188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-7C" x="16685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2212" x="17186" y="0"></use><g transform="translate(18187,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-33" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2C" x="19466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-7C" x="19911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-7A" x="20190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-7C" x="20658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2212" x="21159" y="0"></use><g transform="translate(22160,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-33" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2C" x="23439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2212" x="23884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6C" x="24913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-65" x="25211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-66" x="25678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="26228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-28" x="26590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-73" x="26979" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-71" x="27449" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="27909" y="0"></use><g transform="translate(28361,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="511" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-28" x="29176" y="0"></use><g transform="translate(29566,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2B" x="30814" y="0"></use><g transform="translate(31815,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="706" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2B" x="32991" y="0"></use><g transform="translate(33992,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="663" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-29" x="34915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2212" x="35527" y="0"></use><g transform="translate(36527,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-34" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-32" x="1279" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="38557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-69" x="39009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-67" x="39354" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-68" x="39835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="40411" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-29" x="40773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-72" x="41412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-69" x="41864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-67" x="42209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-68" x="42690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-74" x="43266" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMAIN-29" x="43628" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-14"> SDF \ begin {pmatrix} x \\ y \\ z \ end {pmatrix} = \ max \ left (| x | - 0.3, | y | - 0.3, | z | - 0.3, - \ left (sqrt_2 (x ^ 2 + y ^ 2 + z ^ 2) - 0.42 \ right) \ right) </script></p><br><ul><li>  function <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-265"><span class="MJXp-mtext" id="MJXp-Span-266">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.181ex" height="1.455ex" viewBox="0 -520.7 2230.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/435390/&amp;xid=25657,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhj3gxFo8qJS7AJQEc98n9WK9cZ4bg#MJMATHI-78" x="1658" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> \ max </script>  means intersection </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mrow" id="MJXp-Span-271"><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">x</span><span class="MJXp-mrow" id="MJXp-Span-274"><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-277">0.3</span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-279"><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">y</span><span class="MJXp-mrow" id="MJXp-Span-282"><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-285">0.3</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-287"><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">z</span><span class="MJXp-mrow" id="MJXp-Span-290"><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mrow" id="MJXp-Span-293"><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0em; margin-right: 0em;">$</span></span><span class="MJXp-mn" id="MJXp-Span-295">0.</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> | x | - 0.3, | y | - 0.3, | z | - $ 0.</script>  three pairs of half-planes are defined, forming a cube with a side <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-296"><span class="MJXp-mn" id="MJXp-Span-297">0.3</span><span class="MJXp-mtext" id="MJXp-Span-298">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">t</span><span class="MJXp-mn" id="MJXp-Span-303">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> 0.3 \ cdot 2 </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-304"><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0.111em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-306">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">t</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">r</span><span class="MJXp-msubsup" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-317" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-321" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-325" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-329" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-332">0.42</span><span class="MJXp-mtext" id="MJXp-Span-333">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">t</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> - \ left (sqrt_2 (x ^ 2 + y ^ 2 + z ^ 2) - 0.42 \ right) </script>  - the outer part of the sphere radius <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-340"><span class="MJXp-mn" id="MJXp-Span-341">0.42</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> 0.42 </script>  .  The radius is larger than the visible to compensate for the inaccuracy of the square root approximation. </li></ul><br><br>  Next we just need to calculate the sequence. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-342"><span class="MJXp-mn" id="MJXp-Span-343">0</span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;">v</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-347" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350" style="margin-right: 0.05em;">v</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-351" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354" style="margin-right: 0.05em;">v</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-355" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-356">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">s</span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-365" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-366">15</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> 0 = v_0, v_1, v_2 \ ldots, v_ {15} </script>  for each pixel by the formula: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-367"><span class="MJXp-msubsup" id="MJXp-Span-368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-370" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">n</span><span class="MJXp-mo" id="MJXp-Span-372">+</span><span class="MJXp-mn" id="MJXp-Span-373">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-377" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">F</span><span class="MJXp-mtext" id="MJXp-Span-382">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">t</span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-388">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">n</span><span class="MJXp-mrow" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">X</span><span class="MJXp-mspace" id="MJXp-Span-406" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">Y</span><span class="MJXp-mspace" id="MJXp-Span-411" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">Z</span><span class="MJXp-mtext" id="MJXp-Span-416">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">d</span><span class="MJXp-mrow" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">x</span></span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-431" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mtext" id="MJXp-Span-432">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">n</span><span class="MJXp-mrow" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">x</span><span class="MJXp-mspace" id="MJXp-Span-447" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">y</span><span class="MJXp-mspace" id="MJXp-Span-449" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">z</span><span class="MJXp-mtext" id="MJXp-Span-451">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">d</span><span class="MJXp-mrow" id="MJXp-Span-455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">x</span></span><span class="MJXp-mtext" id="MJXp-Span-463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">t</span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-21"> v_ {n + 1} = v_n + SDF \ left (\ begin {pmatrix} camX \\ camY \\ camZ \ end {pmatrix} + v_n \ begin {pmatrix} x \\ y \\ z \ end {pmatrix} \ right) </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">x</span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">y</span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">z</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> x, y, z </script>  - coordinates of the normalized vector.  Since the camera coordinates are repeated several times, I rounded them to one decimal place. <br><br><pre> <code class="sql hljs">... iters AS ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> it, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> rays <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> rays.row, rays.col, it + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> it, v + <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*x) - <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*y) - <span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ABS</span></span>(<span class="hljs-number"><span class="hljs-number">-1.1</span></span>+v*z) - <span class="hljs-number"><span class="hljs-number">0.3</span></span>, -( (<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*x) * (<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*x) + (<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*y) * (<span class="hljs-number"><span class="hljs-number">0.7</span></span>+v*y) + (<span class="hljs-number"><span class="hljs-number">-1.1</span></span>+v*z) * (<span class="hljs-number"><span class="hljs-number">-1.1</span></span>+v*z) ) * <span class="hljs-number"><span class="hljs-number">1.78</span></span> + <span class="hljs-number"><span class="hljs-number">0.28</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> rays <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> rays.row = iters.row <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> rays.col = iters.col <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> it &lt; <span class="hljs-number"><span class="hljs-number">15</span></span> ), ...</code> </pre><br><h1>  We get the intensity of "pixels" </h1><br>  It uses the same formula as Excel, which approximates the diffuse component from Phong shading: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">y</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-487">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">x</span><span class="MJXp-mtext" id="MJXp-Span-491">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">t</span><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-497">0</span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-499">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">n</span><span class="MJXp-mtext" id="MJXp-Span-503">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">t</span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-509">1</span><span class="MJXp-mo" id="MJXp-Span-510" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-511">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">c</span><span class="MJXp-mrow" id="MJXp-Span-516"><span class="MJXp-msubsup" id="MJXp-Span-517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-519" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-520">15</span></span></span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-524" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-525">14</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-526"><span class="MJXp-msubsup" id="MJXp-Span-527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-529" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-530">14</span></span></span><span class="MJXp-mo" id="MJXp-Span-531" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-534" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-535">13</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-536">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">t</span><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-543">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">t</span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-23"> intensity = \ max \ left (0, \ min \ left (1, \ frac {v_ {15} - v_ {14}} {v_ {14} - v_ {13}} \ right) \ right) </script></p><br><br>  To calculate it, you must first make a table with the last three iterations of ray marching: <br><br><pre> <code class="sql hljs">... lastIters AS ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> it0.row, it0.col, it0.v <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v0, it1.v <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v1, it2.v <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> v2 <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> it0 <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> it1 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> it0.col = it1.col <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it0.row = it1.row <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> iters <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> it2 <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> it0.col = it2.col <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it0.row = it2.row <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> it0.it = <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it1.it = <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> it2.it = <span class="hljs-number"><span class="hljs-number">13</span></span> ), ...</code> </pre><br>  And, actually, the formula itself (operations <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-550"><span class="MJXp-mtext" id="MJXp-Span-551">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> \ max </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-555"><span class="MJXp-mtext" id="MJXp-Span-556">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> \ min </script>  will be applied in the final request): <br><br><pre> <code class="sql hljs">... res AS (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>, (v0 - v1) / (v1 - v2) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> lastIters) ...</code> </pre><br><h1>  We generate "ascii-art" </h1><br><pre> <code class="sql hljs">... <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group_concat</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">substr</span></span>( <span class="hljs-string"><span class="hljs-string">'$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/|()1{}[]?-_+~&lt;&gt;i!lI;:,"^. '</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">round</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>(<span class="hljs-number"><span class="hljs-number">66</span></span>, v * <span class="hljs-number"><span class="hljs-number">67</span></span>))), <span class="hljs-number"><span class="hljs-number">1</span></span> ) || <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">col</span></span>=<span class="hljs-number"><span class="hljs-number">88</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> X<span class="hljs-string"><span class="hljs-string">'0A'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> res;</code> </pre><br>  The task of the final query is to convert the table with the intensities of pixels into one ascii line.  At the input, it receives only the <code>res</code> table, which contains the columns <code>col</code> and <code>v</code> . <br><br><ul><li>  <code>group_concat(s, delim)</code> is an aggregation function that concatenates the expression <code>s</code> for all rows, using the <code>delim</code> string as a separator. </li><li>  <code>CASE WHEN cond1 THEN val1 WHEN cond2 THEN val2 ... ELSE valN END</code> - conventional design, an analogue of the ternary operator. </li><li>  <code>X'0A'</code> is a newline character that is inserted before the first character of each line. </li><li> <code>||</code>  - string concatenation operator. </li><li>  <code>substr(s, start, count)</code> is a function that returns the <code>count</code> characters of the string <code>s</code> , starting with the character number <code>start</code> .  The indexing of characters comes from one. </li><li>  <code>'$@B%8&amp;WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/|()1{}[]?-_+~&lt;&gt;i!lI;:,"^. '</code> Is a string containing a‚Äú gradient ‚Äùfrom‚Äú black ‚Äù( <code>$</code> ) to "White" (space) in ascii-symbols. Taken from the site <a href="http://paulbourke.net/dataformats/asciiart/">http://paulbourke.net/dataformats/asciiart/</a> . </li><li>  <code>round(1 + max(0, min(66, v * 67)))</code> - convert real numbers from the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-560"><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-562">0</span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-564">1</span><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> [0, 1] </script>  to an integer in the interval <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-566"><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-568">1</span><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-570">67</span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> [1, 67] </script>  to take the character with the corresponding number. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/435390/">https://habr.com/ru/post/435390/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435376/index.html">Space 2019: manned spacecraft, new missiles and lunar probes</a></li>
<li><a href="../435380/index.html">Free GitHub accounts can [almost] work with private repositories without restrictions</a></li>
<li><a href="../435384/index.html">How I created my online game. Part 1: Networking</a></li>
<li><a href="../435386/index.html">How to divide the architecture and implementation and do not quarrel</a></li>
<li><a href="../435388/index.html">Internet in Cuba. From revolution to revolution</a></li>
<li><a href="../435394/index.html">Physical results of the year</a></li>
<li><a href="../435398/index.html">Meta-games: My experience in creating contests for sales managers</a></li>
<li><a href="../435400/index.html">For information about the hacking of WhatsApp and iMessage, a reward of $ 1 million has been announced</a></li>
<li><a href="../435402/index.html">Amazon has become the most expensive public company in the world.</a></li>
<li><a href="../435406/index.html">Learning English: a geeky way</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>