<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How development with operation fell out - and how they made it up</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is the beginning of any project on IT infrastructure? If you thought about something like: the admins got together, discussed and someone suggest...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How development with operation fell out - and how they made it up</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/425/d63/35f/425d6335f82243599f55b80012cef805.png" alt="image alt text"></p><br><p>  What is the beginning of any project on IT infrastructure?  If you thought about something like: the admins got together, discussed and someone suggested a solution, then you most likely hit the mark.  This is exactly the situation with exploitation in Russian companies, and we have, until recently, too. </p><br><p>  In the article I will talk about how we spent 5 million and almost half a year to make sure: excellent specialists and enthusiasm are not enough to implement something large-scale. <a name="habracut"></a></p><br><p>  It all started with the realization that a couple of huge monolithic applications at the heart of the payment service is cumbersome and inconvenient.  <strong>Layout</strong> , <strong>Portal</strong> and Yandex.Money <strong>Billing were</strong> serviced separately by several operating teams that rolled up updates and monitored the operation of the systems.  The process, which has been working steadily for years, began to fail, when project teams began to form in the company and the frequency of releases increased exponentially. </p><br><p>  The number of conflicts when working with the same parts of the code has increased, not to mention the acceptance testing, which sometimes lasted more than a month.  What do modern companies do in such cases?  They divide their monoliths into many small (micro) services. </p><br><h1 id="ok-perehodim-na-mikroservisy">  OK, go to microservices </h1><br><p>  More services - more support load.  After all, now 5-10 releases are released every day.  According to the old process, after testing, each of them must be manually rolled onto several nodes - up to 100 manual updates were released per day.  Taking into account the need to update test stands, the number of which is equal to the number of teams, the figure was calculated in thousands of manual operations. </p><br><p>  Even the team of the best engineers of operation with intravenous caffeine supply will not master the daily update of thousands of systems - all this needs to be automated.  No sooner said than done: the DevOps group was assigned from operation, which was entrusted with automation.  Well, as allocated - for some time they, together with the administrators, were engaged in routine work and project work, and then separated themselves for specific tasks. </p><br><p>  Programmers and testers patiently waited for the magic solution, and inspired by a big ambitious task, the guys from DevOps worked from morning to evening on the infrastructure of automatic installation of releases and the deployment of test stands "on the button". </p><br><p>  In order to better understand what is happening, let's look at how the DevOps team presented the build and test system at the first stage: </p><br><ol><li><p>  We create a universal script to build each application for any environment. </p><br></li><li><p>  We create settings for building applications for combat and various test environments. </p><br></li><li><p>  We develop a virtualization environment that allows you to create test environments with customizations using a template. </p><br></li><li><p>  With each release, we assemble and install the updated application on the combat environment, as well as on each of the existing test environments. </p><br></li><li>  The tweaks and changes that are carried out during the release process on the combat environment are repeated manually on each of the test ones. </li></ol><br><p><img src="https://habrastorage.org/files/612/f1b/b74/612f1bb74c88444db54c4b95c6bb1cee.png" alt="image alt text"></p><br><p>  Over time, we planned to customize the GUI to manage all processes and gradually get rid of manual operations on all types of environments. </p><br><h1 id="proshlo-neskolko-mesyacev">  Several months have passed </h1><br><p>  <strong>Ansible-Jenkins, a</strong> system of virtual stands and release assemblies assembled in the laboratory, is confronted with the real world.  And here the very first production testing revealed several fundamental problems: </p><br><ul><li><p>  One more or less working stand was assembled by hand in a few <strong>weeks</strong> , not hours.  During the waiting period, the needs grew from tens to several hundred booths, which delays the completion of work somewhere in the next century. </p><br></li><li><p>  Along the way, it turned out that each stand uses about 200 GB of disk space.  If you multiply this volume by the number of required stands, this gives some indecent figures of daily ‚Äúturnover‚Äù of disk space; </p><br></li><li>  Different teams had slightly different methods for developing, testing, configuring, and deploying services.  Therefore, the proposed option did not completely suit any of the development teams. </li></ul><br><p>  You do remember that administrators are used to working without a project manager?  When a bunch of problems are found, they usually put them all in backlog and solve them in turn.  When the situation escalates, they continue to do the same, but faster or more. </p><br><blockquote>  In general, there is little that can demoralize a specialist as much as a low assessment of his hard work and frequent changes of priorities.  Unfortunately, we stepped on this rake, since the efforts of exploitation were directed in the wrong direction.  The result is logical: the new process did not work on time, but the old one finally broke down, throwing a bunch of problems to developers and testers. </blockquote><p>  At the same time, the agonizing period of attempts to use the arriving new stands began.  Since each such stand added manual work to update it, the queue of tasks for administrators began to grow rapidly, and the attitude of developers to this project - just as rapidly deteriorate. </p><br><h1 id="razvedka-vsemu-golova">  Intelligence around the head </h1><br><p>  Even the most inconvenient problem is important to recognize in time and start working on its elimination.  Our key error was not related to technology, it was not enough attention to project management, defining requirements and assessing the expectations of interested parties: </p><br><ul><li><p>  DevOps, in principle, could not do this project alone.  Until development and testing was involved in it, all work was largely done on the table. </p><br></li><li><p>  Developers and testers generally asked little about what they needed.  The sysadmins focused on deployment tasks, and the developers and testers really needed a tool to automatically raise the stands and run test scenarios. </p><br></li><li><p>  The business customer had resource constraints.  The development of new processes and the maintenance of old ones simply did not fit into it.  It was discovered too late. </p><br></li><li>  And the most banal: without a project manager, the whole story was reduced to promises to complete the work tomorrow or the day after tomorrow, but the results did not appear even after six months. </li></ul><br><p>  When the first emotional reaction took place and all the key people met together to discuss their desires, it became obvious that the problem had to be solved first.  Only this time we treated this as a project in development: with the goal, requirements, deadline, resources, customers, responsible, work plan, technical solution, etc. </p><br><p>  The reassembled requirements included details that we missed at the first iteration.  Details that proved fatal. </p><br><p>  In the second approach, we took into account: </p><br><ul><li><p>  how many and what test benches will be needed in a couple of years, not right now; </p><br></li><li><p>  how much data should be in each test bench; </p><br></li><li><p>  how the stands will be isolated from each other and from the military environment; </p><br></li><li><p>  what are the requirements for development teams to update them; </p><br></li><li><p>  how testers will work on the stands; </p><br></li><li>  How will the test environment connections with external services be checked? </li></ul><br><p>  Understanding the details divided the seemingly solid project into subprojects related to the provision of virtual space, network isolation, update delivery, the ability to configure applications, etc. </p><br><p>  As a result, the most efficient option was that in which there are exactly two environments: combat and reference test.  And the whole multitude of team test environments is created by cloning a reference bench with customized components.  In this scenario, development teams will need to make a minimum of changes in their components and stubs of external services.  A decrease in the volume of test data 20 times will allow to transfer the database inside the stands.  Stand isolation will be provided by network engineers at the level of subnets and DNS server settings. </p><br><p>  The modified scheme looks like this: </p><br><p><img src="https://habrastorage.org/files/0d7/9a8/b66/0d79a8b66aef4078b036ce99a2f59720.png" alt="image alt text"></p><br><p>  A small visual difference on the diagram (fewer manual operations) in work changes a lot, since the transfer of changes to all test environments occurs automatically and no longer requires close attention of engineers. </p><br><h1 id="vyvody-posle-prohozhdeniya-sada-grabley">  Conclusions after the passage of the "garden rake" </h1><br><p>  You might think that all of the above is obvious.  However, things that are obvious in one area are not always obvious in another.  There are a huge number of examples where large-scale infrastructure projects in operation change ‚Äúon the knee‚Äù.  You can successfully change the DC, launch new offices, move from DBMS to DBMS, leaving for the competence of engineers who have already done such projects before. </p><br><p>  But when you come across a project in which the operation needs to work together with the development, support and much more, the probability of failure without project management increases many times.  Have you seen a lot of dedicated infrastructure project managers in software companies? </p><br><p>  Instead of concluding in the spirit of "they got married, they lived happily ever after," I would like to draw conclusions that we made for the future: </p><br><ol><li><p>  Project work is necessary for system administrators in the same way as developers.  Without a project manager, each participant will have their own vision, which ultimately will not allow the entire team to come to a given point. </p><br></li><li><p>  There is nothing worse for the motivation of a specialist than the awareness of the futility of time spent on the task.  So that time is not wasted, there must be a clear understanding of what goals the project participants need to achieve and why.  Regular meetings of developers, testers and admins helped us a lot. </p><br></li><li><p>  It is necessary to find a way to check and try to use the interim results of the work of system administrators so that later they do not have to cross out all their many months of work. </p><br></li><li>  Even a team of top engineers with perfect motivation in a vacuum does not compensate for the inconsistency of the actions of the head and legs. </li></ol><br><p>  <strong>I wonder how you work on large-scale IT projects in your company - have you encountered similar problems of project management?</strong> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/322302/">https://habr.com/ru/post/322302/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322286/index.html">Advantages of the Interval Memory Method</a></li>
<li><a href="../322288/index.html">Organization of control over the observance of response time to customer calls in the service department</a></li>
<li><a href="../322292/index.html">An open letter to IT recruiters</a></li>
<li><a href="../322294/index.html">"The threshold of entry is reduced to the knowledge of the basics of computer graphics": the developer Alexander Korshak about mobile VR</a></li>
<li><a href="../322298/index.html">Technologies for working with clients in social networks and instant messengers</a></li>
<li><a href="../322304/index.html">SAP has prepared a major update for its product S / 4Hana Cloud</a></li>
<li><a href="../322306/index.html">‚ÄúCloud for beginners‚Äù: How to protect IaaS infrastructure</a></li>
<li><a href="../322308/index.html">‚ÄúOne pair at a time‚Äù: release of XenServer 7.1 and ESXi 6.0 Update 3 hypervisors</a></li>
<li><a href="../322312/index.html">Routine work with the database of the 24x7 information system in MS SQL Server</a></li>
<li><a href="../322316/index.html">What is SAML authentication and who needs it?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>