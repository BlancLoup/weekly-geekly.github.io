<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to the OCR tessnet2 library (C # language)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Just the other day, I had the need to recognize the plain text in the picture and there was no desire at all to implement my algorithm, since familiar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to the OCR tessnet2 library (C # language)</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/habraeffect/0d/62/0d627ab8696fb14226b0baa8ecd0f738.png" alt="example"><br>  Just the other day, I had the need to recognize the plain text in the picture and there was no desire at all to implement my algorithm, since  familiar with the theory and I know that this is not such a simple matter, so I immediately decided to study the market of ready-made libraries first.  Just a few requests to Google and I realized that nothing more suitable for me as a library tessnet2 can not be found.  I constantly read Habr and I know that there are a lot of articles on OCR theory and I was very surprised that there is nothing about the tessnet2 library. <br><a name="habracut"></a><br><h4>  tessnet2 based on tesseract ocr </h4><br>  The Tesseract OCR engine was one of the 3 best engines presented in 1995 at the UNLV Accuracy test.  Between 1995 and 2006, it was slightly refined, but it is probably one of the most accurate OCR engines available in open source.  Code that is available will read binary, gray or color image and display text.  TIFF reading is designed so that uncompressed TIFF images will be read or Libtiff can be added to read compressed images. <br><br>  How to use <b>Tessnet2</b> : <br>  1. Load the <a href="">library</a> , add a reference (reference) to the <b>Tessnet2.dll</b> in the .NET project. <br>  2. Download the language we need (I personally need English) ( <a href="http://code.google.com/p/tesseract-ocr/downloads/detail%3Fname%3Dtesseract-2.00.eng.tar.gz%26can%3D2%26q%3D">tesseract-2.00.eng.tar.gz</a> ) and add it to the tessdata folder.  The tessdata folder must be next to the executable file of our application. <br><br>  In order to read the text from the image such text is enough: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#2B91AF">Bitmap</font> image = <font color="#0000ff">new</font> <font color="#2B91AF">Bitmap</font> ( <font color="#A31515">"eurotext.tif"</font> ); <br> tessnet2.Tesseract ocr = <font color="#0000ff">new</font> tessnet2.Tesseract(); <br> ocr.SetVariable( <font color="#A31515">"tessedit_char_whitelist"</font> , <font color="#A31515">"0123456789"</font> ); <font color="#008000">// If digit only</font> <br> ocr.Init( <font color="#A31515">@"c:\temp"</font> , <font color="#A31515">" eng "</font> , <font color="#0000ff">false</font> ); <font color="#008000">// To use correct tessdata</font> <br> <font color="#2B91AF">List</font> &lt;tessnet2.Word&gt; result = ocr.DoOCR(image, Rectangle.Empty); <br> <font color="#0000ff">foreach</font> (tessnet2.Word word <font color="#0000ff">in</font> result) <br> <font color="#2B91AF">Console</font> .WriteLine( <font color="#A31515">"{0} : {1}"</font> , word.Confidence, word.Text);</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  I was very pleased with the result, so I immediately remembered that a few months ago I had fastened the service for solving a captch for one project, I‚Äôll say right away that nothing good came of it, there was a need for speed, but it was not possible to get there, t. to.  such services are not able to provide it, and the result is usually deplorable, it is understandable, because  pay there from $ 1 for 1000 correctly entered captchas, which is terrible to say the least.  Therefore, for the sake of experiment, I decided to play with this library on that example. <br>  The baseline data for us will be captcha, on which you need to perform the simplest actions on two numbers and get an answer.  It sounds quite simple, but the problem is that all the characters are of different colors and there is a dynamic background, sometimes it is even difficult for me (the person) to understand what is written there. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Immediately bring the results of the program, after which I will tell you how it all works: <br><br><img src="https://habrastorage.org/storage/habraeffect/61/88/6188d62f74fcdd3392b317415c03bd2e.png" alt="screenshot1"><br><br><img src="https://habrastorage.org/storage/habraeffect/d6/6e/d66e83f8c12249537f3dd446dd804f07.png" alt="screenshot2"><br><br><img src="https://habrastorage.org/storage/habraeffect/7a/d3/7ad39988173b4e038e8967802fe442ef.png" alt="screenshot3"><br><br><img src="https://habrastorage.org/storage/habraeffect/42/4b/424b0608284f3e24e38bbaff7d1e3e5f.png" alt="screenshot4"><br><br><img src="https://habrastorage.org/storage/habraeffect/60/75/607598242697e6f78dc85cc7980f6b04.png" alt="screenshot5"><br><br>  The screenshots clearly show that the library can not solve anything because of the heap of lines, sometimes interferes with the background, which was not completely removed.  Therefore, I developed my own small algorithm for cleaning the picture, there is nothing grandiose in it, I just step back a few pixels from the edge and run around the rectangle and collect colors there, also collect colors after the first digit and before the equal sign (the latter is more hack, but t . article is devoted to another, then left so).  All I need to do next is to paint over all the colors that came into my collection and are not white. <br><br>  Of all the algorithms, only the algorithm for painting the region on Bitmap can be most useful: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">void</font> FloodFill( <font color="#2B91AF">Bitmap</font> bitmap, <font color="#0000ff">int</font> x, <font color="#0000ff">int</font> y, Color color) <br> { <br> BitmapData data = bitmap.LockBits( <br> <font color="#0000ff">new</font> Rectangle(0, 0, bitmap.Width, bitmap.Height), <br> ImageLockMode.ReadWrite, PixelFormat.Format32bppArgb); <br> <font color="#0000ff">int</font> [] bits = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [data.Stride / 4 * data.Height]; <br> Marshal.Copy(data.Scan0, bits, 0, bits.Length); <br> <br> LinkedList&lt;Point&gt; check = <font color="#0000ff">new</font> LinkedList&lt;Point&gt;(); <br> <font color="#0000ff">int</font> floodTo = color.ToArgb(); <br> <font color="#0000ff">int</font> floodFrom = bits[x + y * data.Stride / 4]; <br> bits[x + y * data.Stride / 4] = floodTo; <br> <br> <font color="#0000ff">if</font> (floodFrom != floodTo) <br> { <br> check.AddLast( <font color="#0000ff">new</font> Point(x, y)); <br> <font color="#0000ff">while</font> (check.Count &gt; 0) <br> { <br> Point cur = check.First.Value; <br> check.RemoveFirst(); <br> <br> <font color="#0000ff">foreach</font> (Point off <font color="#0000ff">in</font> <font color="#0000ff">new</font> Point[] { <br> <font color="#0000ff">new</font> Point(0, -1), <font color="#0000ff">new</font> Point(0, 1), <br> <font color="#0000ff">new</font> Point(-1, 0), <font color="#0000ff">new</font> Point(1, 0)}) <br> { <br> Point next = <font color="#0000ff">new</font> Point(cur.X + off.X, cur.Y + off.Y); <br> <font color="#0000ff">if</font> (next.X &gt;= 0 &amp;&amp; next.Y &gt;= 0 &amp;&amp; <br> next.X &lt; data.Width &amp;&amp; <br> next.Y &lt; data.Height) <br> { <br> <font color="#0000ff">if</font> (bits[next.X + next.Y * data.Stride / 4] == floodFrom) <br> { <br> check.AddLast(next); <br> bits[next.X + next.Y * data.Stride / 4] = floodTo; <br> } <br> } <br> } <br> } <br> } <br> <br> Marshal.Copy(bits, 0, data.Scan0, bits.Length); <br> bitmap.UnlockBits(data); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  For those who are interested in experimenting, I attach the <a href="">source code</a> . <br><br><h4>  Total </h4><br>  We met a rather interesting library tessnet2, checked its work in real conditions, achieved quite good results of solving for complex pictures (captchas), of course there are errors, but their number is negligible, especially for this type of captch you can add a check using a regular expression and you will know for sure that the solved text corresponds to the required format. <br></div><p>Source: <a href="https://habr.com/ru/post/112599/">https://habr.com/ru/post/112599/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../112586/index.html">Substitution node alias</a></li>
<li><a href="../112587/index.html">Moderation of phototrucks via a personal account is now available.</a></li>
<li><a href="../112592/index.html">Algorithm to identify communities in large networks</a></li>
<li><a href="../112595/index.html">Twitter is blocked in Egypt</a></li>
<li><a href="../112597/index.html">The first and important post</a></li>
<li><a href="../112600/index.html">Writing software for financial accounting: Open API</a></li>
<li><a href="../112601/index.html">The future of web standards</a></li>
<li><a href="../112602/index.html">Internet Product keyword: a new form of online fraud is spreading in Russia</a></li>
<li><a href="../112603/index.html">Google AdWords API Example</a></li>
<li><a href="../112604/index.html">Some thoughts on the future of the Java platform</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>