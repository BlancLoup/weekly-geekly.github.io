<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Web Injection Evolution Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Web inject configuration files are sold by various individuals in underground hacker forums. Many of these individuals are members of cybercrime group...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Web Injection Evolution Part 2</h1><div class="post__text post__text-html js-mediator-article"> Web inject configuration files are sold by various individuals in underground hacker forums.  Many of these individuals are members of cybercrime groups or have close ties with them.  Most web injectors rely on the same fixed configuration file format ( <a href="http://habrahabr.ru/company/eset/blog/254267/">Figure 2</a> ).  At the same time, some authors of banker Trojans supply their products with special converters of various web inject file formats.  For example, the Gataka banking Trojan contains a similar converter for converting a standard-type configuration file (SpyEye) into its internal format. <br><br><img src="https://habrastorage.org/files/08f/51c/32e/08f51c32e4fc45c29afe94d570ee2321.jpeg"><br><br>  As the demand for quality web injects grows, their supply from the authors also increases.  Web injectors themselves need tools to facilitate the development and testing of web injects.  An example of such a tool is the well-known ‚Äúbuilder‚Äù or Config Builder, which was part of the leaked Carberp source code.  It allowed setting the initial parameters of the web-inject on the input and getting the configuration file on the output. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/files/b56/24d/048/b5624d04845a4def855bd0fb44123713.png"><br>  Fig.  10. Advertising the sale of cheap web inject on an underground hacker forum. <br><br>  In general, those web injections that are offered for sale can be divided into two large types.  Web injects of the first type have the ability to automatically steal money and adjust the available balance in your account.  The second type of web injecting is simpler and offers only a scheme for compromising web pages based on a phishing fake form of collecting confidential information.  Some web injecting developers offer so-called.  ‚ÄúCustomization‚Äù, in which the client is offered the necessary set of services.  We observed cases of using different types of web injections in one and the same campaign to spread a banking Trojan program.  In this campaign, attackers managed to compromise computers in several countries around the world. <br><br><img src="https://habrastorage.org/files/014/867/94e/01486794ea5245b6b1e93bb9a8f0f3c6.png"><br>  Fig.  11. The seller of a web inject of banker Trojan Perkele offers his product. <br><br>  We observed various offers of web injects in underground forums, some of them were more expensive, some were cheaper.  In Fig.  10 shows an offer to sell a cheap web injection.  Despite the low price of this web injection offer, it covers a wide range of financial institutions. <br><br>  The author indicated in the screenshot was selling web injections that specialized in compromising banks in different countries of the world.  Web injections offered to them can be bought for $ 100 each.  They have the same functionality and are designed to steal the user's personal and confidential information using phishing web forms. <br><br>  We have discovered a wider range of offers for the sale of web injections, which contain an ATS mechanism, a two-factor authentication bypass, and a mobile component for compromising users of mobile devices.  In Fig.  Figure 11 shows the offer of the Perkele mobile bot, which comes bundled with a web-inject.  Perkele allows you to bypass the already mentioned mTAN security mechanism.  Most advanced web injects come with a control panel that can be used to track the status of compromised computer malware. <br><br>  Some web injecting developers offer special affiliate programs.  On the basis of affiliate programs distributed so-called.  private web injecting, buying which the customer enters into a special affiliate program.  This implies that a web injection buyer may resell it and, besides, the seller will not offer this web injection to other cybercriminals.  Of course, private web injections are more expensive than their public counterparts.  This increases the cost of maintenance and assistance in the use of web injects (tech support). <br><br>  There are also authors of web injections who are interested in partnership with cybercriminals involved in distributing Trojan programs.  They ask for a certain percentage of the profits that the banking Trojan brings to their owners.  One of the announcements that we observed at the underground forum invited botnet owners in the UK and Sweden to cooperate.  In this case, the condition for them was that part of the profits from the business of cybercriminals should have been transferred to the authors of the web-injection. <br><br>  <b>Web Injection Control Panels</b> <br><br>  As we have already written, over time, the complexity of web injections has only grown.  For more convenient management and control of bots that use web injections, attackers began to use special control panels.  Control panels are sold complete with web injections and provide botnet operators with a single interface for managing bots, they allow you to collect and organize confidential and other information stolen from web injects.  In addition, the control panel allows cybercriminals to instruct bots to conduct fraudulent operations. <br><br>  The control panel records the status of each bot, as well as information about the current state of the compromised bank account of the user.  The botnet operator can perform an automatic transaction of funds from the user‚Äôs account to one of the fake bank accounts, the so-called.  account "mule".  To perform such an operation, malicious JavaScript web injection must have a communication channel with the control panel.  When analyzing cases of fraud with the use of banking malware, antivirus company researchers have to interact with the control panel to obtain statistics on the operation of the bot.  Sometimes, by accessing the control panel, you can get information about the mule account and the mobile component downloaded by the user. <br><br>  The control panel monitors the status of each bot and regulates some rules when working remotely with its components.  For example, it will not allow the visitor to download mobile components of bots in the event that the compromised user has not yet used them (the bot has not changed to a certain state).  The control panel may contain one more check before the delivery of the mobile bot.  In the case of a mobile bot, the user browser of the mobile device browser is checked before its immediate loading. <br><br>  One example of a cybercrime group that specializes in selling both simple sets of web injections and web injects with a control panel is the so-called.  "Yummba".  Yummba specializes in the sale of complex sets of web injects that allow you to bypass 2FA authentication.  In Fig.  12 and 13 show the interface of this control panel. <br><br><img src="https://habrastorage.org/files/efc/03f/b20/efc03fb205e5450db6213fffacd8d9b5.png"><br>  Fig.  12. The login interface to the botnet control panel. <br><br><img src="https://habrastorage.org/files/e42/e95/007/e42e95007f6f479dbfa82f45ce1ecd7e.png"><br>  Fig.  13. Botnet control panel interface. <br><br>  This group offers both public and private sets of web injections.  Public web inject kits contain extensive opportunities for compromising various banks and financial institutions in Europe, North America and Australia.  The kit includes a special module that can inject malicious content into the browser to steal user personal information from various banks.  It is called Full Information Grabber (FIGrabber).  In Fig.  14 shows a list of banks targeted by a set of Yummba group web injects. <br><br>  As mentioned above, Yummba offers a special mobile component along with a web inject.  It is used to bypass two-factor authentication and intercept mTAN codes.  The mobile component is the iBanking malware and offers more extensive options for cybercriminals than Perkele.  This group also specialized in the sale of other various banking Trojans, including, Qadars, ZeusVM, Neverquest. <br><br><img src="https://habrastorage.org/files/74c/0df/703/74c0df7039504512b20970b54de36b89.png"><br>  Fig.  14. The list of websites of banking institutions, to compromise which is aimed at the module FIGrabber. <br><br>  Another popular set of web injects is Injeria.  It also includes the bots control panel and is easily recognizable, as it uses the same set of parameters when loading external scripts from the C &amp; C server.  In the configuration file, the list of URLs is encrypted.  Table 3 below provides a description of the tags used in the configuration file. <br><br><img src="https://habrastorage.org/files/de5/e46/639/de5e46639c9542609f923ef6d7f19bec.png"><br>  Table 3. Injeria configuration file tags. <br><br>  As you can see from the table, besides the mobile component, Injeria can use other methods to bypass the security mechanisms of banks.  The fact that the script is retrieved from a remote server, as in the case of other advanced web injections, indicates that the author or botnet operator can quickly update the web inject configuration to adapt it to the changing environment.  This set of web injects is used by a number of banking trojans, including, Qadars, Tilon, Torpig, Citadel. <br><br>  There are other offers web injects, other than those mentioned above.  One of these kits was offered on a clandestine forum by a user under the pseudonym "rgklink".  This forum user also specializes in the sale of various web injections, which are used to compromise financial institutions in many countries around the world.  Together with web injections of the ATS type, they were offered a control panel called Scarlett (Fig. 15). <br><br><img src="https://habrastorage.org/files/897/d07/1b0/897d071b032440db9f7ccc953af68dfc.png"><br>  Fig.  15. Scarlett control panel. <br><br><img src="https://habrastorage.org/files/179/862/6bc/1798626bcdac47c892280bba95009344.png"><br>  Fig.  16. Sample web injection Injeria. <br><br>  The table below shows the rgklink web injecting rates that were relevant as of 2013. As you can see, the cost of a web inject varies depending on the capabilities it can implement. <br><br><img src="https://habrastorage.org/files/1c3/755/fff/1c3755fffa894599b11e04baeda152ba.png"><br>  Table 4. Cost of various functions of web injects. <br><br>  In most cases, web injections are loaded by the bot from its remote C &amp; C server.  However, the attackers began to use another level in the chain of delivery of the web-inject bot.  The point is that from a C &amp; C server the bot downloads not a web-injection itself, but a link to it.  In Fig.  15 presents this type of web inject. <br><br>  As we mentioned above, downloading web injects from an external server has its distinct advantages for intruders.  The main advantage is that it is enough for them to update the configuration file on the remote server once and be sure that all bots will receive it.  Another implicit advantage is that remote file storage complicates forensic analysis for antivirus analysts.  Attackers can simply temporarily disable the remote server, making it impossible to extract the configuration file from there. <br><br><img src="https://habrastorage.org/files/26d/701/31c/26d70131c1764016a58a544c8a782d42.png"><br>  Fig.  17. An example of the interaction of client and server parts of a web inject. <br><br>  There are web-injecting packages that rely on interaction with a remote C &amp; C server much more.  In this case, the remote server itself decides what content should be embedded in the web page.  In one of these packages, web injection is in constant contact with the server, which constantly sends it new fragments of malicious JavaScript code.  It uses a unique, obfuscated function name and cookie to store and synchronize service data between web pages.  In fig.  17 shows the interaction between such a web injection and the managing server.  It can be seen that one of the URL parameters ‚Äúfunc =‚Äù contains the name of the function, which will then be sent back to the server, after which its contents will be added to the original web page and automatically executed.  In fig.  18 shows the function that is responsible for requesting new fragments of JavaScript from the server and their subsequent insertion into the body of the web page. <br><br><img src="https://habrastorage.org/files/58e/efa/465/58eefa4650b34c39a91900c57f908f17.png"><br>  Fig.  18. A webinject function that is responsible for executing instructions sent from a remote server. <br><br>  In the case we are observing, the javascript code snippets that were loaded from the C &amp; C server perform the installation of various variables and can change the current ‚Äústate‚Äù of the compromised system.  Such states can be as follows: waiting (wait), blocked (block), tan, az.  The last az is an abbreviation for the Russian web injecting system (ATS) called avtozalivov.  Interestingly, account information for transferring money amounts (DropId) is also sent to attackers using the method described above.  In fig.  19 shows an example of this information. <br><br><img src="https://habrastorage.org/files/fee/a08/ce0/feea08ce0e214d78aa9421f4ce549767.png"><br>  Fig.  19. The DropID information that was sent by the remote web injection server. <br><br>  Of course, the method described above is not unique to a particular set of web injects.  It can be noted that this is a rather rare case when information about the account of the intruders, to which the sum of money (the mule account) will be transferred, is directly transmitted to the web injection.  Typically, this operation occurs at the end of the process of interaction of a web inject with a remote C &amp; C server.  This is due to purely practical considerations, since the attackers are the last and foremost interested in replicating their bank details.  Obviously, such information can immediately fall into the hands of law enforcement. </div><p>Source: <a href="https://habr.com/ru/post/254775/">https://habr.com/ru/post/254775/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254765/index.html">Comparative analysis of scanners RSL</a></li>
<li><a href="../254767/index.html">Qooxdoo. Developing a TODO List</a></li>
<li><a href="../254769/index.html">Unfunny April Fool's joke from the developers of Magic Lantern</a></li>
<li><a href="../254771/index.html">New Vapor IO data center concept: versatility and space saving</a></li>
<li><a href="../254773/index.html">Normalization of relationships. Six normal forms</a></li>
<li><a href="../254777/index.html">Audit of TrueCrypt code completed</a></li>
<li><a href="../254781/index.html">Introduction to the capabilities of the Realtek RTL 8332M switch processor</a></li>
<li><a href="../254785/index.html">We need instant messengers. More messengers</a></li>
<li><a href="../254787/index.html">Perl 6: nextsame and its relatives</a></li>
<li><a href="../254789/index.html">Translation of hours in Russia, again ... and php5-intl</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>