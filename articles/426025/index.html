<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Use offensive techniques to enrich Threat Intelligence</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, Threat Intelligence, or the active collection of information on information security threats, is a tool of prime necessity in the process of id...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Use offensive techniques to enrich Threat Intelligence</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/440/45a/1d4/44045a1d4cbaec976766cd6206eee205.jpg" width="500"></div><br>  Today, Threat Intelligence, or the active collection of information on information security threats, is a tool of prime necessity in the process of identifying information security incidents.  Typical TI sources include free subscriptions with malicious indicators, bulletins from manufacturers of equipment and software with descriptions of vulnerabilities, reports of security researchers with detailed descriptions of threats, as well as commercial subscriptions from TI vendors.  At the same time, information obtained from the above sources is often not sufficiently complete and relevant.  Improving the efficiency and improving the quality of TI can be facilitated by the use of OSINT (open source intelligence) and offensive methods (that is, methods that are characteristic not for the defender, but for the attacker) in information security, which will be discussed in this article. <br><a name="habracut"></a><br><h2>  DISCLAIMER </h2><br>  This article is for informational purposes only.  The author is not responsible for the possible harm and / or disruption of the networks and / or services of third parties related to the implementation of certain actions described in the article.  The author also encourages readers to comply with the law. <br><br><h2>  Not instead, but together </h2><br>  Just want to make a reservation that it will not be about refusing or replacing Threat Intelligence information obtained from traditional paid and free sources, but about its addition and enrichment. <br><br>  Thus, the use of additional TI methods can increase its efficiency and help in solving a number of problems.  For example, with another IoT epidemic affecting certain vulnerable versions of firmware, how soon can you get a feed with IP addresses of potentially vulnerable devices in order to quickly detect their activity on the perimeter?  Or, if the monitoring system rules are triggered by an indicator (IP address or domain name) that has been flagged malicious a year or more ago, how to determine whether it still remains malicious, provided that it initiate any additional verification of the indicator as "For now" is usually impossible. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      That is, addition and enrichment will be especially useful for David Bianco‚Äôs ‚Äúpyramid of pain‚Äù medium indicators (IP addresses, domain names, network artifacts), but in some circumstances it is possible to get new long-lived indicators (up through the pyramid) by applying the corresponding analysts. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/946/868/d57/946868d575b064e8f552c06fa0b8c363.png"><br><br><h2>  Internet scanning </h2><br>  One method useful for obtaining Threat Intelligence is network scanning. <br><br><div class="spoiler">  <b class="spoiler_title">What is usually collected when scanning</b> <div class="spoiler_text">  Most often during the scan, the most interesting results are obtained by collecting the so-called ‚Äúbanners‚Äù - the responses of the application software of the scanned system to scanner requests.  The ‚Äúbanners‚Äù contain quite a lot of data identifying the application software and its various parameters on the ‚Äúother side‚Äù, and such a check is done fairly quickly. </div></div><br>  When solving the problem of expanding the scope of Threat Intelligence, the entire Internet will be the scan target.  When scanning a public address space (~ 3.7 billion IPv4 addresses, excluding reserved addresses), you can extract the following useful information: <br><br><ul><li>  Which nodes are exposed to vulnerabilities that are widely exploited within the framework of actual malicious campaigns and, in view of this fact, constitute potential sources of harmful effects. </li><li>  Which nodes are the managing servers of the botnet networks <a href="https://malware-hunter.shodan.io/">[1]</a> , which can be identified by the compromised node in the protected perimeter. </li><li>  Which nodes belong to the non-public part of distributed anonymous networks that can be used for invisible, uncontrolled exit beyond the protected perimeter. </li><li>  More information about the nodes, "lit up" in the response of the monitoring system. </li></ul><br><h2>  Tool selection </h2><br>  Over the years, the development of information networks has created a large number of tools for network scanning.  Among the current software are the following scanners: <br><br><ul><li>  Nmap <a href="https://nmap.org/">[2]</a> </li><li>  Zmap <a href="https://zmap.io/">[3]</a> </li><li>  Masscan <a href="https://github.com/robertdavidgraham/masscan">[4]</a> </li></ul><br>  Briefly consider the main advantages and disadvantages of these tools for the enrichment of TI in the Internet space. <br><br><h4>  Nmap </h4><br>  Perhaps the most famous network scanner, created 20 years ago.  Due to the possibility of using custom scripts (via the Nmap Scripting Engine), this is an extremely flexible tool, not limited to just collecting application banners.  At the moment, quite a lot of NSE scripts have been written, many of which are available for free.  Since Nmap tracks every connection, in other words, has a synchronous nature, it is not worth using it for large networks such as the Internet because of the low speed of the scanner.  At the same time, it is advisable to use this tool on small samples of addresses obtained by faster tools, due to the power of the NSE. <br><br><div class="spoiler">  <b class="spoiler_title">About Nmap speed</b> <div class="spoiler_text">  Despite the initially low performance, since the release of this scanner, its developers have added a lot of functionality that improves the scanning speed.  Among them are parallel modes of operation and setting the rate in packets per second.  However, even with the ‚Äútwisted‚Äù settings, Nmap lags behind its asynchronous competitors in speed.  Using the example of scanning / 15 subnets on the 443 / tcp port from a virtual machine with 1 CPU Xeon Gold 6140 and a gigabit channel, we get: <br><br><ul><li> 71.08 seconds for Nmap with <code>-T5 -n -Pn -p 443 --open --min-rate 1000000 --randomize-hosts --defeat-rst-ratelimit ‚ÄìoG nmap.txt</code> </li><li>  9.15 seconds for Zmap with <code>-p 443 ‚Äìo zmap.txt</code> </li></ul><br></div></div><br><h4>  Zmap </h4><br>  Well-known, though not the first of its kind asynchronous network scanner, which appeared in 2013.  According to the report of the developers, published at the 22nd USENIX Security Simposium conference <a href="https://zmap.io/paper.pdf">[5]</a> , the tool is able to scan the entire public address range running on an average computer with a gigabit Internet connection in less than 45 minutes (one port each).  The advantages of Zmap include: <br><br><ul><li>  High speed;  using the PF_RING framework and 10-gigabit connectivity, the theoretical scan time for the public IPv4 address space is 5 minutes (one port each). </li><li>  Support random scans of network addresses. </li><li>  Module support for TCP SYN scans, ICMP, DNS queries, UPnP, BACNET <a href="https://en.wikipedia.org/wiki/BACnet">[6]</a> , UDP probes. </li><li>  Presence in the repositories of common distributions of GNU / Linux (in addition, there is support for Mac OS and BSD). </li><li>  In addition to Zmap, a series of related utility projects have been developed that extend the functionality of the scanner. </li></ul><br>  If we talk about the disadvantages of Zmap, here we can note the possibility of scanning addresses only on one port as at the moment. <br><br>  Among the Zmap-related projects that extend its functionality for tasks of interest, the following can be distinguished: <br><br><ul><li>  ZGrab is an application protocol scanner with support for TTP, HTTPS, SSH, Telnet, FTP, SMTP, POP3, IMAP, Modbus, BACNET, Siemens S7 and Tridium Fox protocols (advanced banner grabber). </li><li>  ZDNS is a utility for quick DNS queries. </li><li>  ZTag is a utility for tagging scan results issued by ZGrab. </li><li>  ZBrowse is a Chrome headless distribution utility for tracking website content changes. </li></ul><br><div class="spoiler">  <b class="spoiler_title">About the possibilities of ZGrab</b> <div class="spoiler_text">  The advanced scanner of ZGrab application protocols, for which version 2.0 has already been released (there is no full functional parity with version 1.X yet, but it will be reached soon, after which we can talk about the complete replacement of the old version of the new one), allows you to flexibly filter the results scanning thanks to support for a structured output format (JSON).  For example, to collect only the Distinguished Name of the Issuer and Subject from HTTPS certificates, a fairly simple command is: <br><br><pre> <code class="hljs 1c">zmap --target-port=<span class="hljs-number"><span class="hljs-number">443</span></span> --output-fields=saddr <span class="hljs-string"><span class="hljs-string">| ./zgrab2 tls -o - | jq '.ip + "</span></span><span class="hljs-string"><span class="hljs-string">|"</span></span> + .data.tls.result.handshake_log.server_certificates.certificate.parsed.issuer_dn + <span class="hljs-string"><span class="hljs-string">"|"</span></span> + .data.tls.result.handshake_log.server_certificates.certificate.parsed.subject_dn' &gt; zmap-dn-443.txt</code> </pre> <br></div></div><br><h4>  Masscan </h4><br>  An asynchronous scanner created in the same year as Zmap, according to the command syntax, is similar to Nmap. <br><br>  The creator (Robert David Graham) declared greater productivity than all asynchronous scanners that existed at that time, including Zmap, achieved through the use of a custom TCP / IP stack. <br><br>  Advantages of the scanner: <br><br><ul><li>  High performance with a theoretical performance of up to 10 million packets per second, which allows you to scan all IPv4 public space in a few minutes (one port) on a 10-gigabit connection - the same as in Zmap using the PF_RING framework. </li><li>  TCP, SCTP and UDP protocol support (via sending UDP payloads from Nmap). </li><li>  Support random scans of network addresses. </li><li>  Supports selection of both IP range and port range when scanning. </li><li>  Support for various formats of output scan results (XML, grepable, JSON, binary, as a list). </li></ul><br>  At the same time, the scanner has several disadvantages: <br><br><ul><li>  In connection with the use of a custom TCP / IP stack, it is recommended to run a scan on a dedicated IP to avoid conflicts with the OS stack. </li><li>  Compared with ZGrab, banner grabber‚Äôs options are quite limited. </li></ul><br><h4>  Scanner Comparison Chart </h4><br>  The summary table below presents a comparison of the functionality of the scanners considered. <br><br><div class="spoiler">  <b class="spoiler_title">Values ‚Äã‚Äãin table rows</b> <div class="spoiler_text">  "++" - very well implemented <br>  "+" - implemented <br>  "¬±" - implemented with restrictions <br>  "-" - not implemented </div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/253/a0d/74e/253a0d74ef6cf82937472729a65f1cd0.png"><br><br><h2>  Selection of targets and scanning method </h2><br>  After choosing the tools to use, you need to decide on the object and purpose of the scan, that is, understand what and why to scan.  If with the first, as a rule, there are no questions (this is a public IPv4 address space with a number of exceptions), then with the second, everything depends on the desired end result.  For example: <br><br><ul><li>  To identify nodes affected by a particular vulnerability, it is wise to first go over the scanned range with a fast tool (Zmap, Masscan) to identify nodes with open ports of vulnerable services;  after finalizing the list of addresses, use Nmap with the appropriate NSE script, if one exists, or create a custom script based on the available information about the vulnerability in security researchers publications.  Sometimes simple enough grep'a on the collected application banners, because many services display information about their version in it. </li><li>  To identify the nodes of the hidden infrastructure - both anonymous networks and C2 nodes (that is, the managing servers of the botnet networks) - you will need to create custom payloads / probes. </li><li>  For solving a wide range of tasks on identifying compromised nodes, parts of the infrastructure of anonymous networks and others, quite a lot can be obtained by collecting and parsing certificates during a TLS handshake. </li></ul><br><h2>  Selection of infrastructure </h2><br>  The fact that modern fast scanners can show impressive results on fairly modest resources of an average processor does not mean that the load on the network infrastructure will be insignificant.  Due to the specifics of the traffic generated during scanning, a rather significant packet rate per second is obtained.  According to experience, one core of an average processor (on a CPU manufactured in recent years, in a virtual environment, under any OS, without any tuning of the TCP / IP stack) is able to generate a stream of about 100-150 thousand packets per second per ~ 50 Mbps band that is a serious load for software routers.  Hardware networking equipment may also have problems reaching the ASIC performance limit.  At the same time, with a scanning speed of 100-150 Kpps (thousands of packets per second), the crawling of the public IPv4 range may take more than 10 hours, i.e.  quite a significant amount of time.  For a really fast scan, you should use a distributed network of scanning nodes that divide the scanned pool into parts.  It is also necessary to have a random scan order so that the utilization of Internet channels and batch loading of the providers' equipment on the ‚Äúlast mile‚Äù is not significant. <br><br><h2>  Difficulties and "thin" moments </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/a07/061/a45/a07061a458b372bd5bddbec15b9fb7a5.jpg"><br><br>  In practice, when conducting mass network scans, one may encounter a number of difficulties of both technological and organizational nature. <br><br><h4>  Performance and Availability Issues </h4><br>  As mentioned earlier, a massive network scan creates a stream of traffic with a high PPS value, causing a heavy load on both the local infrastructure and the network of the provider to which the scan nodes are connected.  Before carrying out any scans for research purposes, it is imperative to coordinate all actions with local administrators and representatives of the provider.  On the other hand, performance problems may occur on the end scanning nodes when renting virtual servers on Internet hosting. <br><br><div class="spoiler">  <b class="spoiler_title">Not all VPS are equally useful.</b> <div class="spoiler_text">  On a VPS that is not rented from mainstream hosters, you may encounter a situation where, on productive VMs (several vCPUs and a couple of gigabytes of memory), Zmap and Masscan packet rates do not rise above a couple of dozen Kpps.  Most often, the combination of obsolete hardware and a suboptimal combination of virtual environment software plays a negative role.  Anyway, according to the author‚Äôs experience, more or less substantial guarantees of productivity can be obtained only from companies that are market leaders. </div></div><br>  Also, when identifying vulnerable nodes, it should be borne in mind that certain NSE checks can lead to a denial of service on scanned nodes.  Such a development of the situation is not just not ethical, but is quite definitely outside the legal field and entails the onset of consequences in the form of responsibility, including criminal liability. <br><br><h4>  What are we looking for and how? </h4><br>  In order to find something, you need to know how to look for it.  Threats are constantly evolving, and new analytical work is constantly needed to identify them.  Sometimes analytics published in research documents become obsolete, prompting them to conduct their own research. <br><br><div class="spoiler">  <b class="spoiler_title">One famous example</b> <div class="spoiler_text">  As an example, we can take the study <a href="https://zmap.io/paper.pdf">[5] of</a> 2013 by the authors of Zmap, dedicated to identifying nodes of the TOR network.  At the time of publication of the document by analyzing the chain of certificates and identifying the specially generated subject name in self-signed certificates, it was possible to find ~ 67 thousand TOR nodes operating on the tcp / 443 port and ~ 2.9 thousand nodes working on tcp / 9001.  Currently, the list of TOR nodes detected by this method is much smaller (a greater variety of ports are used, obfs transports are used, we are migrating to Let's Encrypt Certificates), which forces us to use other analytical methods to solve this problem. </div></div><br><h4>  Abuse complaints </h4><br>  When scanning the Internet, there is almost a 100% risk of receiving a stream of abuse complaints.  Especially annoying automatically generated abuse on a couple of dozen SYN-packages.  And if scans are repeated on a regular basis, a stream of manually created complaints may also go. <br><br><div class="spoiler">  <b class="spoiler_title">Who complains most often</b> <div class="spoiler_text">  The main sources of abuse (mostly automatic) are educational institutions in the domain zone * .edu.  By experience, one should especially avoid scanning addresses from ASNs belonging to Indiana University (USA).  Also in the presentations of the authors Zmap <a href="https://zmap.io/paper.pdf">[5]</a> and Masscan <a href="https://www.defcon.org/images/defcon-22/dc-22-presentations/Graham-McMillan-Tentler/DEFCON-22-Graham-McMillan-Tentler-Masscaning-the-Internet.pdf">[7]</a> you can find several interesting examples of inadequate response to network scanning. </div></div><br>  You should not be frivolous about this abuse, because: <br><br><ul><li>  In case of complaints, the hoster most often blocks traffic to or from rented virtual machines or even suspends their operation. </li><li>  The ISP may disable uplink in order to eliminate the risks of autonomous system blocking. </li></ul><br>  Best practice for minimizing complaints is to do the following: <br><br><ol><li>  Familiarize yourself with the terms of service of your internet / hosting provider. </li><li>  Creating a scan of the information page on the source addresses, which tells about the purpose of scanning;  Making the appropriate explanations in the DNS TXT-records. </li><li>  Clarification of scans when receiving abuse complaints. </li><li>  Maintain a list of exclusions from scanning, add requests to the subnets on request, provide clarifications on the procedure for entering exceptions on the information page. </li><li>  Scanning is no longer and no more frequently than is required to solve the problem. </li><li>  Distribution of scanning traffic by source, destination-addresses, and time when it is possible. </li></ol><br><h2>  Network Scan Outsourcing </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0ad/0fe/7bd/0ad0fe7bdfc413fb9e6326362bed1d9d.jpg" width="500"></div><br>  Conducting independent mass scans requires a weighted approach (the risks are described above), and you need to be aware that if the analytical processing of the scan results is not deep enough, then the final result may be unsatisfactory.  At a minimum, the technical part can be facilitated by using existing commercial tools, such as: <br><br><ul><li>  Shodan <a href="https://shodan.io/">[8]</a> </li><li>  Censys <a href="https://censys.io/">[9]</a> </li><li>  ZoomEye <a href="https://www.zoomeye.org/">[10]</a> </li></ul><br><div class="spoiler">  <b class="spoiler_title">More services</b> <div class="spoiler_text">  In addition to the mentioned services, there is a fairly large number of projects, one way or another connected with global network scanning.  For example: <br><br><ul><li>  Punk.sh (former web search engine PunkSPIDER) </li><li>  Project Sonar (dataset with the results of network scans from Rapid7) </li><li>  Thingful (another search engine for IoT) </li></ul></div></div><br><h2>  Shodan </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/ce6/877/d6b/ce6877d6b6b39cb0639d148a7992e46e.jpg"><br><br>  The first and most well-known search engine for published services on the Internet, which was originally created as a search engine for IoT and was launched in 2009 by John Materley <a href="https://twitter.com/achillean">[11]</a> .  At the moment, the search engine offers several levels of access to information within itself.  Without registration, the possibilities are very basic. When registering and purchasing a membership, the following functionality becomes available: <br><br><ul><li>  Search by basic filters. </li><li>  Issue of detailed information about the nodes ("raw data"). </li><li>  "Basic" API with the ability to integrate with common utilities, such as Maltego, Metasploit, Nmap and others. </li><li>  The ability to export search results (for a fee, for "Credits" - the internal currency of the service). </li><li>  Ability to scan on request individual addresses and ranges (for a fee, for "Credits"). </li></ul><br>  The mentioned possibilities are already enough for the basic OSINT <a href="https://en.wikipedia.org/wiki/Open-source_intelligence">[12]</a> , however, the search engine fully discloses its capabilities with an Enterprise subscription, namely: <br><br><ul><li>  On-demand scanning of the entire public IPv4 range of the Internet, including checking the specified range of ports and specifying protocol-specific banner collectors. </li><li>  Real-time notifications on the results of triggered scans. </li><li>  The ability to upload raw scan results for further analysis (no limitations, the entire database is available). </li><li>  The possibility of developing custom collectors for specific tasks (non-standard protocols, etc.). </li><li>  Access to historical scan results (until October 2015). </li></ul><br>  As part of the Shodan project, a number of related projects were created, such as a malware-hunter, honeypot scan, exploits, which enrich the scan results. <br><br><h2>  Censys </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/29b/24e/4ef/29b24e4efeb65eb7c9d22fee64baa3e8.jpg"><br><br>  Search engine for IoT and more, created by Zmap author Zakir Durumerik and publicly presented in 2015.  The search engine uses Zmap technology and a number of related projects (ZGrab and ZTag).  Without registration, unlike Shodan, the search engine is limited to 5 requests per day from one IP.  After registration, the use possibilities are expanded: the API appears, search results are increased by queries (up to 1000 results), but the most complete access, including uploading historical data, becomes available only on the Enterprise plan. <br><br>  The advantages of the search engine over Shodan include the following features: <br><br><ul><li>  There are no restrictions on search filters on basic tariff plans. </li><li>  The high speed of updating the results of automatic scanning (daily, according to the authors; the speed of Shodan is significantly lower). </li></ul><br>  The disadvantages include: <br><br><ul><li>  Fewer ports scanned compared to Shodan. </li><li>  The inability to scan "on demand" (both by IP-ranges and ports). </li><li>  The smaller depth of enrichment of the results out of the box (which is obvious, given the greater number of Shodan tools implemented through related projects). </li></ul><br>  If there are enough results collected on the Censys-supported port range to achieve this goal, the lack of on-demand scanning should not be a serious obstacle due to the high speed of updating scan results. <br><br><h2>  ZoomEye </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/b0a/9c4/46b/b0a9c446b5585b1256f1f707c2bdd40a.jpg"><br><br>  IoT search engine created by the Chinese IB-company Knowsec Inc in 2013.  To date, the search engine works using its own development - Xmap (host scanner) and Wmap (web scanner).  The search engine collects information on a fairly wide range of ports, while searching it is possible to categorize according to a large number of criteria (ports, services, operating systems, applications) with details on each host (the contents of the application banners).  The search results display a list of possible vulnerabilities for the identified application software from the related project SeeBug (without testing for applicability).  For registered accounts, API and web search are also available with a full set of filters, but with a limit on the number of displayed results.  To remove the restrictions proposed acquisition of Enterprise-plan.  Of the advantages of the search engine can be noted: <br><br><ul><li>  A large number of scanned ports (roughly similar to Shodan). </li><li>  Extended web support. </li><li>  The identifier of the application software and OS. </li></ul><br>  The disadvantages include: <br><br><ul><li>  Slow update interval for scan results. </li><li>  Lack of scanning capability on request. </li><li>  Enrichment of scan results is limited to the identification of services, application software, operating systems and potential vulnerabilities. </li></ul><br><h4>  Comparative table of services </h4><br>  The summary table below provides a comparison of the functionality of the services considered. <br><br><div class="spoiler">  <b class="spoiler_title">Values ‚Äã‚Äãin table rows</b> <div class="spoiler_text">  "++" - very well implemented <br>  "+" - implemented <br>  "¬±" - implemented with restrictions <br>  "-" - not implemented </div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/1fd/028/d58/1fd028d5843b449c8820b81d3f5d620f.png"><br><br><h2>  We scan ourselves </h2><br>  Own infrastructure can also be a useful source of TI so that you can understand which new hosts and services are on the network, are they vulnerable or even malicious?  If it is possible to use external services for perimeter scanning (for example, this usage scenario is officially supported by Shodan), then all actions inside the perimeter can only be performed independently.  The range of tools for network analysis in this case can be quite extensive: these are both passive analyzers, such as Bro <a href="https://www.bro.org/">[13]</a> , Argus <a href="http://qosient.com/argus/">[14]</a> , Nfdump <a href="http://nfdump.sourceforge.net/">[15]</a> , p0f <a href="http://lcamtuf.coredump.cx/p0f/">[16]</a> , and active scanners ‚Äî Nmap, Zmap, Masscan and their commercial competitors.  And the IVRE framework <a href="https://github.com/cea-sec/ivre">[17]</a> can help in interpreting the collected results, allowing you to get your own Shodan / Censys-like tool. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f32/ab2/cc3/f32ab2cc38acf9802402815b460574d0.jpg"><br><br>  The framework was developed by a group of IB researchers, one of the authors is the active developer of the scapy utility <a href="https://scapy.net/">[18]</a> Pierre Lalette <a href="https://github.com/p-l-">[19]</a> .  The framework features include: <br><br><ul><li>  The use of visual analytics to identify patterns and abnormal deviations. </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Advanced search engine with detailed parsing of scan results. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Integration with third-party utilities through an API with Python support. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> IVRE is also well suited for analyzing large scans of the Internet. </font></font><br><br><h2>  findings </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scanning and active network intelligence are excellent tools that have long been used by various researchers in the field of information security. </font><font style="vertical-align: inherit;">However, for the "classic" bezopasnik such methods of work is still new. </font><font style="vertical-align: inherit;">The use of OSINT and offensive-methods in combination with classical defensive-means will significantly enhance protection and ensure its pro-activity.</font></font><br><br><div class="spoiler">  <b class="spoiler_title">Links</b> <div class="spoiler_text"> [0] <a href="https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html">https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html</a> <br> [1] <a href="https://malware-hunter.shodan.io/">https://malware-hunter.shodan.io/</a> <br> [2] <a href="https://nmap.org/">https://nmap.org</a> <br> [3] <a href="https://zmap.io/">https://zmap.io</a> <br> [4] <a href="https://github.com/robertdavidgraham/masscan">https://github.com/robertdavidgraham/masscan</a> <br> [5] <a href="https://zmap.io/paper.pdf">https://zmap.io/paper.pdf</a> <br> [6] <a href="https://en.wikipedia.org/wiki/BACnet">https://en.wikipedia.org/wiki/BACnet</a> <br> [7] <a href="https://www.defcon.org/images/defcon-22/dc-22-presentations/Graham-McMillan-Tentler/DEFCON-22-Graham-McMillan-Tentler-Masscaning-the-Internet.pdf">https://www.defcon.org/images/defcon-22/dc-22-presentations/Graham-McMillan-Tentler/DEFCON-22-Graham-McMillan-Tentler-Masscaning-the-Internet.pdf</a> <br> [8] <a href="https://shodan.io/">https://shodan.io</a> <br> [9] <a href="https://censys.io/">https://censys.io</a> <br> [10] <a href="https://www.zoomeye.org/">https://www.zoomeye.org</a> <br> [11] <a href="https://twitter.com/achillean">https://twitter.com/achillean</a> <br> [12] <a href="https://en.wikipedia.org/wiki/Open-source_intelligence">https://en.wikipedia.org/wiki/Open-source_intelligence</a> <br> [13] <a href="https://www.bro.org/">https://www.bro.org/</a> <br> [14] <a href="http://qosient.com/argus/">http://qosient.com/argus/</a> <br> [15] <a href="http://nfdump.sourceforge.net/">http://nfdump.sourceforge.net/</a> <br> [16] <a href="http://lcamtuf.coredump.cx/p0f/">http://lcamtuf.coredump.cx/p0f/</a> <br> [17] <a href="https://github.com/cea-sec/ivre">https://github.com/cea-sec/ivre</a> <br> [18] <a href="https://scapy.net/">https://scapy.net/</a> <br> [19] <a href="https://github.com/p-l-">https://github.com/pl-</a> </div></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mikhail Larin, expert at the Jet CSIRT Information Security and Response Center, Jet Infosystems.</font></font></i> </div><p>Source: <a href="https://habr.com/ru/post/426025/">https://habr.com/ru/post/426025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../426015/index.html">The use of sawn civilian drones for professional geodetic aerial photography of the area</a></li>
<li><a href="../426017/index.html">How to reduce the number of experiments on animals</a></li>
<li><a href="../426019/index.html">Weather Station on Arduino from A to Z. Part 5</a></li>
<li><a href="../426021/index.html">libGDX and feelings</a></li>
<li><a href="../426023/index.html">Open lesson "Virtual Lab on Vagrant"</a></li>
<li><a href="../426027/index.html">Amazon Cloud Services and Investment Portfolio Analysis</a></li>
<li><a href="../426029/index.html">Hands down and want to quit the task? This is effective developer training.</a></li>
<li><a href="../426031/index.html">Anxiety about the capture of the world by artificial intelligence, perhaps based on unscientific assumptions</a></li>
<li><a href="../426033/index.html">Titans from mathematics have clashed over the epic evidence of the abc hypothesis</a></li>
<li><a href="../426039/index.html">Emergency launch of Soyuz MS-10 (crew rescued, broadcast over)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>