<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Symbols, generators, async / await, and asynchronous iterators in JavaScript: their essence, interconnection, and use cases</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The essence and purpose of the many features of JavaScript are quite obvious. But some, like generators, may, at first glance, seem strange. The same ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Symbols, generators, async / await, and asynchronous iterators in JavaScript: their essence, interconnection, and use cases</h1><div class="post__text post__text-html js-mediator-article">  The essence and purpose of the many features of JavaScript are quite obvious.  But some, like generators, may, at first glance, seem strange.  The same impression can also be caused by, say, symbols that are similar to the values ‚Äã‚Äãof primitive types and objects.  However, a programming language is a complete system, some of which rely on others.  Therefore, it is usually impossible to fully understand one thing without understanding all that is connected with it, on which it depends, and on what it affects. <br><br> <a href="https://habr.com/company/ruvds/blog/359004/"><img src="https://habrastorage.org/getpro/habr/post_images/c90/391/c6f/c90391c6fb1276646df6c12fa0e075fb.jpg" alt="image"></a> <br><br>  The material, the translation of which we are publishing today, is aimed at explaining such JavaScript mechanisms and constructions as symbols, well-known symbols, iterators, iterable objects, generators, the async / await mechanism, and asynchronous iterators.  In particular, it‚Äôs about why they appeared in the language and how to use them.  It should be noted that the topics that will be raised here are designed for those who already have some idea of ‚Äã‚ÄãJavaScript. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Symbols and famous symbols</font> </h2><br>  In ES2015, a new sixth data type, <code>symbol</code> .  What for?  There are three main reasons for the appearance of this data type. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  <font color="#3AC1EF">‚ñçReason # 1.</font>  <font color="#3AC1EF">Expansion of basic features, taking into account backward compatibility</font> </h3><br>  JavaScript developers and the ECMAScript committee (TC39) needed the ability to add new object properties without disrupting existing mechanisms, such as <code>for-in</code> loops and methods like <code>Object.keys</code> . <br><br>  Suppose we have such an object: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myObject = {firstName:<span class="hljs-string"><span class="hljs-string">'raja'</span></span>, lastName:<span class="hljs-string"><span class="hljs-string">'rao'</span></span>}</code> </pre> <br>  If you execute the <code>Object.keys(myObject)</code> command, it returns the array <code>[firstName, lastName]</code> . <br><br>  Now let's add another property to the <code>myObject</code> object, for example, <code>newProperty</code> .  In doing so, we need the <code>Object.keys(myObject)</code> command to return the same values ‚Äã‚Äãas before (in other words, something should make this function ignore the new property <code>newProperty</code> ), that is, <code>[firstName, lastName]</code> , and not [ <code>firstName, lastName, newProperty]</code> .  How to do it? <br><br>  In fact, before the appearance of the <code>symbol</code> data type, this could not be done.  Now, if you add <code>newProperty</code> as a symbol, the <code>Object.keys(myObject)</code> command <code>Object.keys(myObject)</code> ignore this property (since it simply does not know about it) and returns what is needed - <code>[firstName, lastName]</code> . <br><br><h3>  <font color="#3AC1EF">‚ñçReason # 2.</font>  <font color="#3AC1EF">Name collision prevention</font> </h3><br>  Those who are engaged in the development of JavaScript, would like to see the new properties of objects would be unique.  This would allow them to continue to add new properties to global objects (the same could be done by developers using JS for solving practical problems), without worrying about name collisions. <br><br>  For example, suppose that while working on a certain project, you decided to add your own <code>toUpperCase</code> method in <code>Array.prototype</code> . <br><br>  Now imagine that you have connected to a project a certain library (or released ES2019), where you have your own version of the <code>Array.prototype.toUpperCase</code> method.  This may well cause your code to stop working correctly. <br><br>  Consider an example. <br><br><pre> <code class="hljs kotlin">Array.prototype.toUpperCase = function(){   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i;   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.length; i++){       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[i] = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[i].toUpperCase();   }   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myArray = [<span class="hljs-string"><span class="hljs-string">'raja'</span></span>, <span class="hljs-string"><span class="hljs-string">'rao'</span></span>]; myArray.toUpperCase(); <span class="hljs-comment"><span class="hljs-comment">//['RAJA', 'RAO']</span></span></code> </pre> <br>  How to resolve such a collision, provided that the developer may not even be aware of its existence?  This is where symbols come to our aid.  Inside them, unique identifiers are created that allow you to add new properties and methods to objects without worrying about possible name collisions. <br><br><h3>  <font color="#3AC1EF">‚ñçReason number 3.</font>  <font color="#3AC1EF">The organization of a call by standard mechanisms of the language of methods developed by the programmer independently</font> </h3><br>  Suppose you want some standard function, say, <code>String.prototype.search</code> , to call your own function that implements your logic to search for something in the string.  That is, for example, it is necessary that the construction <code>'somestring'.search(myObject);</code>  would call the <code>search</code> function of the <code>myObject</code> object and pass it, as an argument, <code>'somestring'</code> .  How to do it? <br><br>  In such situations, we can use the capabilities of ES2015, in which there are many global symbols, called ‚Äúwell-known symbols‚Äù.  And if in your object there is a property represented by one of these characters, you can organize a call to your function with standard functions.  Below we will look at this mechanism in more detail, but before we do this, we will talk about how to work with symbols. <br><br><h3>  <font color="#3AC1EF">‚ñçCreate characters</font> </h3><br>  You can create a new symbol by calling the global function <code>Symbol</code> .  This function will return a value of type <code>symbol</code> . <br><br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">// mySymbol   symbol var mySymbol = Symbol();</span></span></code> </pre> <br>  Please note that the characters can be taken for objects, as they have methods, but they are not objects.  These are primitive values.  They can be considered as certain ‚Äúspecial‚Äù objects that are somewhat similar to ordinary objects, but behave differently from them. <br><br>  For example, symbols have methods that make them related to objects, but, unlike objects, symbols are immutable and unique. <br><br><h3>  <font color="#3AC1EF">‚ñçCreate characters and keyword new</font> </h3><br>  Since symbols are not objects, and when using the keyword <code>new</code> , a new object is expected to return, you cannot use the keyword <code>new</code> to create entities of type <code>symbol</code> . <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mySymbol = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(); <span class="hljs-comment"><span class="hljs-comment">// ,    </span></span></code> </pre> <br><h3>  <font color="#3AC1EF"> "Description" characters</font> </h3><br>  What is called a ‚Äúdescription‚Äù of a character is represented as a string and is used for logging. <br><br><pre> <code class="hljs vhdl">// mySymbol    , //   -  <span class="hljs-string"><span class="hljs-string">"some text"</span></span> const mySymbol = Symbol(<span class="hljs-symbol"><span class="hljs-symbol">'some</span></span> <span class="hljs-literal"><span class="hljs-literal">text</span></span>');</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñçOn the uniqueness of characters</font> </h3><br>  Symbols are unique - even if the same description is used when creating them.  This statement can be illustrated by the following example: <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mySymbol1 = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">'some text'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mySymbol2 = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">'some text'</span></span>); mySymbol1 == mySymbol2 <span class="hljs-comment"><span class="hljs-comment">// false</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">Create characters using the Symbol.for method</font> </h3><br>  Instead of creating <code>symbol</code> type variables using the <code>Symbol()</code> function, you can create them using the <code>Symbol.for(&lt;key&gt;)</code> method <code>Symbol.for(&lt;key&gt;)</code> .  This method takes a key (string <code>&lt;key&gt;</code> ) and creates new characters.  In this case, if this key is given a key already assigned to an existing symbol, it will simply return that existing symbol.  Therefore, we can say that the behavior of <code>Symbol.for</code> resembles a singleton design pattern. <br><br><pre> <code class="hljs ruby">var mySymbol1 = Symbol.<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-string"><span class="hljs-string">'some key'</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   var mySymbol2 = Symbol.<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-string"><span class="hljs-string">'some key'</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     mySymbol1 == mySymbol2 /<span class="hljs-regexp"><span class="hljs-regexp">/true</span></span></code> </pre> <br>  The <code>Symbol.for</code> method exists so that you can create characters in one place and work with them in another. <br><br>  Please note that the features of the <code>.for()</code> method <code>.for()</code> transfer of a key that has already been used, it does not create a new character with such a key, but returns an existing one.  Therefore, use it with caution. <br><br><h3>  <font color="#3AC1EF"> Keys and character descriptions</font> </h3><br>  It is worth noting that if you do not use the <code>Symbol.for</code> construction, the symbols, even when using the same keys, will be unique.  However, if you use <code>Symbol.for</code> , then specifying non-unique keys and symbols returned by <code>Symbols.for</code> will be non-unique.  Consider an example. <br><br><pre> <code class="hljs ruby">var mySymbol1 = Symbol(<span class="hljs-string"><span class="hljs-string">'some text'</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-string"><span class="hljs-string">"some text"</span></span> var mySymbol2 = Symbol(<span class="hljs-string"><span class="hljs-string">'some text'</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-string"><span class="hljs-string">"some text"</span></span> var mySymbol3 = Symbol.<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-string"><span class="hljs-string">'some text'</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-string"><span class="hljs-string">"some text"</span></span> var mySymbol4 = Symbol.<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-string"><span class="hljs-string">'some text'</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   ,    mySymbol3 /<span class="hljs-regexp"><span class="hljs-regexp">/    true, /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/        .for /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/       mySymbol3 == mySymbol4 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/true /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    mySymbol1 == mySymbol2 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/false mySymbol1 == mySymbol3 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/false mySymbol1 == mySymbol4 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/false</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç Using characters as object property identifiers</font> </h3><br>  Although symbols are like objects, they are primitive values.  Perhaps this unique feature of them is most confusing.  In particular, symbols can be used as identifiers of object properties ‚Äî just as strings are used for this. <br><br>  In fact, object property identifiers are one of the main uses for symbols. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mySymbol = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">"Some car description"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> myObject = {<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'bmw'</span></span>}; myObject[mySymbol] = <span class="hljs-string"><span class="hljs-string">'This is a car'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      //    console.log(myObject[mySymbol]); //'This is a car'</span></span></code> </pre> <br>  Please note that the properties of the objects, which are symbols, are known as ‚ÄúSymbol-keyed properties‚Äù, or ‚Äúproperties with the keys of the Symbol‚Äù. <br><br><h3>  <font color="#3AC1EF">‚ñç Point and square brackets</font> </h3><br>  When working with properties of objects that are characters, you cannot use a period, since this operator is only suitable for working with properties specified by strings.  Instead, in such situations, use square brackets. <br><br><pre> <code class="hljs markdown">let myCar = {name: 'BMW'}; let type = Symbol('store car type'); myCar[<span class="hljs-string"><span class="hljs-string">type</span></span>] = 'A<span class="hljs-emphasis"><span class="hljs-emphasis">_1uxury_</span></span>Sedan'; let honk = Symbol('store honk function'); myCar[<span class="hljs-string"><span class="hljs-string">honk</span></span>] = () =&gt; 'honk'; // myCar.type; //  myCar[<span class="hljs-string"><span class="hljs-string">type</span></span>]; // 'store car type' myCar.honk(); //  myCar[<span class="hljs-string"><span class="hljs-string">honk</span></span>](<span class="hljs-link"></span><span class="hljs-link"></span>); // 'honk'</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñçWhy use symbols?</font> </h3><br>  Now, after we have learned how symbols work, we will repeat and rethink three main reasons for using them. <br><br><h3>  <font color="#3AC1EF">‚ñç <b>Reason</b> number <b>1.</b></font>  <font color="#3AC1EF">Symbols used as identifiers of object properties are invisible to loops and other methods.</font> </h3><br>  In the following example, the <code>for-in</code> loop loops over the properties of the <code>obj</code> object, but it does not know about the <code>prop3</code> and <code>prop4</code> (or ignores these properties), since their identifiers are represented by characters. <br><br><pre> <code class="hljs ruby">var obj = {}; obj[<span class="hljs-string"><span class="hljs-string">'prop1'</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span>; obj[<span class="hljs-string"><span class="hljs-string">'prop2'</span></span>] = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     -, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   (    /<span class="hljs-regexp"><span class="hljs-regexp">/   ) var prop3 = Symbol('prop3'); var prop4 = Symbol('prop4'); obj[prop3] = 3; obj[prop4] = 4; for(var key in obj){   console.log(key, '=', obj[key]); } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   ,     /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   prop3  prop4 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/prop1 = 1 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/prop2 = 2 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   prop3  prop4  , /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   console.log(obj[prop3]); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/3 console.log(obj[prop4]); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/4</span></span></code> </pre> <br>  Below is another example in which the <code>Object.keys</code> and <code>Object.getOwnPropertyNames</code> ignore property names represented by characters. <br><br><pre> <code class="hljs pgsql">const obj = {   <span class="hljs-type"><span class="hljs-type">name</span></span>: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> }; //     - obj[Symbol(<span class="hljs-string"><span class="hljs-string">'store string'</span></span>)] = <span class="hljs-string"><span class="hljs-string">'some string'</span></span>; obj[Symbol(<span class="hljs-string"><span class="hljs-string">'store func'</span></span>)] = () =&gt; console.log(<span class="hljs-string"><span class="hljs-string">'function'</span></span>); //  -   //  console.log(<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.keys(obj)); //[<span class="hljs-type"><span class="hljs-type">name</span></span>] console.log(<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>.getOwnPropertyNames(obj)); //[<span class="hljs-type"><span class="hljs-type">name</span></span>]</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç <b>Reason # 2.</b></font>  <font color="#3AC1EF">The characters are unique</font> </h3><br>  Suppose we need to expand the global <code>Array</code> object by adding our own <code>Array.prototype.includes</code> method to its prototype.  This method will conflict with the standard <code>includes</code> method that is present in ES2018 JavaScript.  How to equip a prototype with this method and avoid collisions? <br><br>  First you need to create a variable with the name <code>includes</code> and assign a symbol to it.  Then you need to use this variable to add a new property to the global <code>Array</code> object using the bracket notation.  After that, it remains only to assign the necessary function to the new property. <br><br>  To call a new function, you must use square brackets.  Moreover, pay attention to the fact that in brackets you need to use the name of the corresponding variable, that is, something like <code>arr[includes]()</code> , and not a regular string. <br><br><pre> <code class="hljs markdown">var includes = Symbol('will store custom includes method'); //    Array.prototype Array.prototype[<span class="hljs-string"><span class="hljs-string">includes</span></span>] = () =&gt; console.log('inside includes func'); // var arr = [<span class="hljs-string"><span class="hljs-string">1,2,3</span></span>]; //       // includes console.log(arr.includes(1)); //true console.log(arr[<span class="hljs-string"><span class="hljs-string">'includes'</span></span>](<span class="hljs-link"><span class="hljs-link">1</span></span>)); //true //       includes arr[<span class="hljs-string"><span class="hljs-string">includes</span></span>](<span class="hljs-link"></span><span class="hljs-link"></span>); // 'inside includes func',   includes -  </code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç <b>Reason number 3.</b></font>  <font color="#3AC1EF">Known Symbols (Global Symbols)</font> </h3><br>  By default, JavaScript automatically creates many character variables and writes them to the global <code>Symbol</code> object (this is the same object that we used to create new characters). <br><br>  In ECMAScript 2015, these symbols are then used to work with basic methods, such as <code>String.prototype.search</code> and <code>String.prototype.replace</code> standard objects like <code>String</code> or <code>Array</code> . <br><br>  Here are some examples of such symbols: <code>Symbol.match</code> , <code>Symbol.replace</code> , <code>Symbol.search</code> , <code>Symbol.iterator</code> and <code>Symbol.split</code> . <br><br>  Since these symbols are global and publicly available, it is possible to make the methods of standard objects call our own functions instead of internal ones. <br><br><h3>  <font color="#3AC1EF">‚ñç <b>Example number 1.</b></font>  <font color="#3AC1EF">Using Symbol.search</font> </h3><br>  The publicly accessible <code>String.prototype.search</code> method of the <code>String.prototype.search</code> object searches the string using a regular expression or a sample string, and if it managed to find what it needs, it returns the index of the search term in the analyzed string. <br><br><pre> <code class="hljs pgsql"><span class="hljs-string"><span class="hljs-string">'rajarao'</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>(/rao/); <span class="hljs-string"><span class="hljs-string">'rajarao'</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>(<span class="hljs-string"><span class="hljs-string">'rao'</span></span>);</code> </pre> <br>  In ES2015, this method first checks whether the <code>Symbol.search</code> method is <code>Symbol.search</code> in a <code>RegExp</code> object.  If this is the case, then it is the method of the <code>RegExp</code> object that is being searched for.  Thus, the basic objects, like <code>RegExp</code> , implement methods corresponding to <code>Symbol.search</code> , which solve search problems. <br><br><h3>  <font color="#3AC1EF">Symbol Symbol.search internal mechanisms (standard behavior)</font> </h3><br>  The process of searching for a substring in a string consists of the following steps. <br><br><ol><li>  <code>'rajarao'.search('rao');</code> command <code>'rajarao'.search('rao');</code> <br></li><li>  The string <code>"rajarao"</code> converted to a <code>String (new String("rajarao"))</code> object <code>String (new String("rajarao"))</code> <br></li><li>  The <code>"rao"</code> character sequence is converted to a <code>RegExp (new Regexp("rao"))</code> object <code>RegExp (new Regexp("rao"))</code> <br></li><li>  The <code>search</code> method of a <code>String</code> object based on the string <code>"rajarao"</code> <br></li><li>  Inside the <code>search</code> method of the <code>"rajarao"</code> object <code>"rajarao"</code> method of the <code>"rao"</code> object is called (that is, the search operation is delegated to the <code>"rao"</code> object).  The string <code>"rajarao"</code> passed to this method.  If you schematically present this call, it can look something like this: <code>"rao"[Symbol.search]("rajarao")</code> </li><li>  The <code>"rao"[Symbol.search]("rajarao")</code> returns, as a search result, the number 4 representing the index of the <code>search</code> substring in the string of the <code>search</code> function of the object <code>"rajarao"</code> , and this function, in turn, returns 4 to our code . </li></ol><br>  Below is a fragment written in pseudocode, demonstrating the structure of the internal mechanisms of standard JavaScript objects described above. <br><br><pre> <code class="hljs markdown">//  String class String {   constructor(value){       this.value = value;   }   search(obj){       //  Symbol.search  obj          // value       obj[<span class="hljs-string"><span class="hljs-string">Symbol.search</span></span>](<span class="hljs-link"><span class="hljs-link">this.value</span></span>);   } } //  RegExp class RegExp {   constructor(value){       this.value = value;   }   //     [<span class="hljs-string"><span class="hljs-string">Symbol.search</span></span>](<span class="hljs-link"><span class="hljs-link">string</span></span>){       return string.indexOf(this.value);   } }</code> </pre> <br>  The most interesting thing here is that in such a situation it is no longer necessary to use the <code>RegExp</code> object.  The standard function <code>String.prototype.search</code> can now correctly perceive any object that implements the <code>Symbol.search</code> method, which returns what the developer needs, and this will not break the code.  Let us dwell on this in more detail. <br><br><h3>  <font color="#3AC1EF">‚ñç <b>Example number 2.</b></font>  <font color="#3AC1EF">Using Symbol.search to organize a call to a self-developed function from standard functions</font> </h3><br>  The following example shows how we can make the function <code>String.prototype.search</code> the search function of our own class <code>Product</code> .  This is possible thanks to the global symbol <code>Symbol.search</code> . <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Product {   constructor(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>){       this.<span class="hljs-keyword"><span class="hljs-keyword">type</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>;   }   //     [Symbol.<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>](string){       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> string.indexOf(this.<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>) &gt;=<span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-string"><span class="hljs-string">'FOUND'</span></span> : "NOT_FOUND";   } } var soapObj = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Product(<span class="hljs-string"><span class="hljs-string">'soap'</span></span>); <span class="hljs-string"><span class="hljs-string">'barsoap'</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>(soapObj); //<span class="hljs-built_in"><span class="hljs-built_in">FOUND</span></span> <span class="hljs-string"><span class="hljs-string">'shampoo'</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>(soapObj); //NOT_FOUND</code> </pre> <br><h3>  <font color="#3AC1EF">Symbol Symbol.search internal mechanisms (custom behavior)</font> </h3><br>  When ‚Äúsearching‚Äù our object in the string, the following actions are performed. <br><br><ol><li>  <code>'barsoap'.search(soapObj);</code> command <code>'barsoap'.search(soapObj);</code> <br>  The string <code>"barsoap"</code> converted to a <code>String</code> object ( <code>new String("barsoap")</code> ) </li><li>  Since <code>soapObj</code> already an object, it is not converted. </li><li>  Call the <code>search</code> method of a <code>String</code> object based on the string <code>"barsoap"</code> </li><li>  Inside this method, the <code>Symbol.search</code> method of the <code>Symbol.search</code> object is <code>soapObj</code> (the search operation is delegated to this object), and the string <code>"barsoap"</code> .  In fact, we are talking about this command: <code>soapObj[Symbol.search]("barsoap") <br></code> <code>soapObj[Symbol.search]("barsoap") <br></code> <br>  The <code>soapObj[Symbol.search]("barsoap")</code> returns to the <code>search</code> function a result that, in accordance with the internal logic of the <code>soapObj</code> object, can be <code>FOUND</code> and <code>NOT_FOUND</code> .  The <code>search</code> function returns this result to our code. </li></ol><br>  Now that we‚Äôve dealt with the characters, let's do some iterators. <br><br><h2>  <font color="#3AC1EF">Iterators and iterated objects</font> </h2><br>  To begin, let us ask ourselves why this is necessary.  Here the fact is that in almost all applications it is necessary to work with lists of data.  For example, these lists should be displayed on ordinary web pages or in mobile applications.  Usually, developers write their own methods to store and retrieve data from such lists. <br><br>  However, we already have standard language mechanisms, like a <code>for-of</code> loop and an extension operator ( <code>‚Ä¶</code> ), designed to extract data sets from standard objects like arrays, strings, objects of type <code>Map</code> .  Why don't we use these standard methods to work with our own objects that store data sets? <br><br>  The following example shows that the <code>for-of</code> loop and the extension operator cannot be used to extract data from the <code>User</code> class, which we have created ourselves.  Here, to work with it, you have to use the <code>get</code> method, which we also created ourselves. <br><br><pre> <code class="hljs lua">//    //      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-of  //       //   Users,    //  class Users {   constructor(users){       this.users = users;   }   //     get() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> this.users;   } } const allUsers = new Users([   { name: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'john'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'matt'</span></span> }, ]); // allUsers.get() ,     <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (const user of allUsers){   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(user); } //    TypeError: allUsers is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> iterable //    const users = [...allUsers]; //    TypeError: allUsers is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> iterable</code> </pre> <br>  It would be nice if we could use, for working with our own objects, standard language mechanisms.  In order to achieve this, you need to have rules that developers can follow when creating such objects with which standard JS tools can work. <br><br>  In fact, such rules exist.  They describe the features of extracting data from objects.  Objects built according to these rules are called <code>iterables</code> . <br><br>  Here are the rules: <br><br><ol><li>  The main object / class must store some data. </li><li>  It must have a property that is the well-known <code>Symbol.iterator</code> symbol, which implements the method described in clauses 3-6. <br></li><li>  The <code>Symbol.iterator</code> method should return another object - an iterator. <br></li><li>  The iterator must have a <code>next</code> method. </li><li>  The <code>next</code> method should have access to the data described in clause 1. <br></li><li>  When the <code>next</code> method is called, the data from point 1 should be returned, either in the format <code>{value:&lt;stored data&gt;, done: false}</code> , if the iterator can return something else, or in the form <code>{done: true}</code> , if The iterator has nothing more to return. </li></ol><br>  If all these requirements are met, then the main object is called iterable, and the object it returns is called an iterator. <br><br>  Let's talk now about how to make the <code>Users</code> object iterable. <br><br><pre> <code class="hljs lua">//   // Users   ,     // Symbol.iterator,      <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>, //       class Users{   constructor(users){       this.users = users;   }   // Symbol.iterator -  ,     //    [Symbol.iterator](){       let i = <span class="hljs-number"><span class="hljs-number">0</span></span>;       let users = this.users;       //           <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {           <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(){               <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i&lt;users.length) {                   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: users[i++] };               }               <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { done: <span class="hljs-literal"><span class="hljs-literal">true</span></span> };           },       };   } } //allUsers    const allUsers = new Users([   { name: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'john'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'matt'</span></span> }, ]); //allUsersIterator   const allUsersIterator = allUsers[Symbol.iterator](); // <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>      , //    console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsersIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsersIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsersIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); //     : //{ done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: { name: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> } } //{ done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: { name: <span class="hljs-string"><span class="hljs-string">'john'</span></span> } } //{ done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: { name: <span class="hljs-string"><span class="hljs-string">'matt'</span></span> } } //  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-of <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(const u of allUsers){   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(u.name); } //   : raja, john, matt //   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>([...allUsers]); //    </code> </pre> <br>    ,       ( <code>allUsers</code> )  <code>for-of</code>   ,       <code>&lt;iterable&gt;[Symbol.iterator]()</code>  ,    ( <code>allUsersIterator</code> ),        . <br><br>             . <br><br><h2>  <font color="#3AC1EF">Generators</font> </h2><br>      : <br><br><ol><li>         . </li><li>         ,    ,      . </li></ol><br>      . <br><br><h3> <font color="#3AC1EF">‚ñç <b> ‚Ññ1.</b>       </font> </h3><br>  ,       ,   ,    - (generator),        . <br><br>     . <br><br><ol><li>  -   ,       <code>*&lt;myGenerator&gt;</code> .  -   <code>function * myGenerator(){}</code> </li><li>   <code>myGenerator()</code>   <code>generator</code> ,    () ,  ,   ,       <code>iterator</code> . </li><li>     <code>yield</code>   . </li><li>  <code>yield</code>         ,      . </li><li>   <code>yield</code>   ,        ,     <code>next</code> . </li></ol><br><h3> <font color="#3AC1EF">‚ñç <b> ‚Ññ1.</b> -  Symbol.iterator</font> </h3><br>       - ( <code>*getIterator()</code> )    <code>Symbol.iterator</code>     <code>next()</code> ,     . <br><br><pre> <code class="hljs lua">//     ,  //  - (*getIterator()) //      class Users{   constructor(users) {       this.users = users;       this.<span class="hljs-built_in"><span class="hljs-built_in">len</span></span> = users.length;   }   // ,      *getIterator(){       <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (let i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> this.users){           <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> this.users[i];           //     ,           //<span class="hljs-built_in"><span class="hljs-built_in">yield</span></span>             }   } } const allUsers = new Users([   { name: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'john'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'matt'</span></span> }, ]); //allUsersIterator   const allUsersIterator = allUsers.getIterator(); // <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>      , //    console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsersIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsersIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsersIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsersIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); //     : //{ done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: { name: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> } } //{ done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: { name: <span class="hljs-string"><span class="hljs-string">'john'</span></span> } } //{ done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: { name: <span class="hljs-string"><span class="hljs-string">'matt'</span></span> } } //{ done: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, value: undefined } //  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-of <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(const u of allUsers.getIterator()){   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(u.name); } //   : raja, john, matt //   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>([...allUsers.getIterator()]); //    </code> </pre> <br><h3> <font color="#3AC1EF">‚ñç <b> ‚Ññ2.</b>   -</font> </h3><br>         -.  ,  ,   ,  .    - (     <code>*</code> )     <code>yield</code>     . <br><br><pre> <code class="hljs lua">// Users -  ,    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Users</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(users)</span></span></span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (let i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> users){       <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> users[i++];       //     ,       //<span class="hljs-built_in"><span class="hljs-built_in">yield</span></span>         } } const allUsers = Users([   { name: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'john'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'matt'</span></span> }, ]); // <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>      , //    console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsers.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsers.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsers.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(allUsers.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); //     : //{ done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: { name: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> } } //{ done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: { name: <span class="hljs-string"><span class="hljs-string">'john'</span></span> } } //{ done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, value: { name: <span class="hljs-string"><span class="hljs-string">'matt'</span></span> } } //{ done: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, value: undefined } const allUsers1 = Users([   { name: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'john'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'matt'</span></span> }, ]); //  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-of <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(const u of allUsers1){   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(u.name); } //   : raja, john, matt const allUsers2 = Users([   { name: <span class="hljs-string"><span class="hljs-string">'raja'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'john'</span></span> },   { name: <span class="hljs-string"><span class="hljs-string">'matt'</span></span> }, ]); //   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>([...allUsers2]); //    </code> </pre> <br>    ,        ¬´iterator¬ª   <code>allUsers</code> , ,   ,  <code>Generator</code> . <br><br>   <code>Generator</code>    <code>throw</code>  <code>return</code> ,     <code>next</code> . ,   ,        . <br><br><h3> <font color="#3AC1EF">‚ñç ‚Ññ2.      </font> </h3><br>        ,   , ,   . <br><br>    , ,     ,      <code>yield</code> ( ,      ) ,  ,         ,     <code>yield</code> . <br><br>    ,   ,   -    <code>yield</code> ,    .  ,    <code>generator.next("some new value")</code>       ,         <code>yield</code> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea1/9f4/44e/ea19f444ef03853d6c09fd6c6bc0d157.png"><br> <i><font color="#999999">    -</font></i> <br><br>    ,     ,   . <br><br><pre> <code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a, b)</span></span></span></span>{   //  a + b   // ,   k   ,     //  a + b   let k = <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> a + b;   //      m   let m = <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> a + b + k;   <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> a + b + k + m; } var gen = generator(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>); //   a + b //   ,  done   <span class="hljs-literal"><span class="hljs-literal">false</span></span>,   //      <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(gen.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); //{value: <span class="hljs-number"><span class="hljs-number">30</span></span>, done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>} //      ,     //a  b,    .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>() ,    - //,      ,    // //  k <span class="hljs-number"><span class="hljs-number">50</span></span>      a + b + k console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(gen.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(<span class="hljs-number"><span class="hljs-number">50</span></span>)); //{value: <span class="hljs-number"><span class="hljs-number">80</span></span>, done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>} //     ,     a, b  k. //  .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()      ,  //     ,     //  m <span class="hljs-number"><span class="hljs-number">100</span></span>      a + b + k + m console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(gen.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>)); //{value: <span class="hljs-number"><span class="hljs-number">180</span></span>, done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>} //   .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(),   undefined,     //    <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(gen.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); //{value: undefined, done: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}</code> </pre> <br><h3> <font color="#3AC1EF">‚ñç    </font> </h3><br>         . <br><br><pre> <code class="hljs lua">// //  - <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myGenerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {} // <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myGenerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {} // <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myGenerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {} //  const myGenerator = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">*</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {} //   ,  //      let generator = *() =&gt; {} //      //SyntaxError: Unexpected token * //   ES2015 class MyClass {   *myGenerator() {} } //    const myObject = {   *myGenerator() {} }</code> </pre> <br><h3> <font color="#3AC1EF">‚ñç yield  return</font> </h3><br>   <code>yield</code>     ,       <code>return</code> . , ,    <code>return</code> ,   .  ,    <code>yield</code> ,  . <br><br><pre> <code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myGenerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {   let name = <span class="hljs-string"><span class="hljs-string">'raja'</span></span>;   <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> name;   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'you can do more stuff after yield'</span></span>); } //   const myIterator = myGenerator(); // .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()    console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(myIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); //{value: <span class="hljs-string"><span class="hljs-string">"raja"</span></span>, done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>} // .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()   //      // <span class="hljs-string"><span class="hljs-string">'you can do more stuff after yield'</span></span>    //{value: undefined, done: <span class="hljs-literal"><span class="hljs-literal">true</span></span>} console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(myIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>());</code> </pre> <br><h3> <font color="#3AC1EF">‚ñç   yield  </font> </h3><br>        <code>yield</code> , ,           <code>return</code> ,     ,         <code>yield</code>           . <br><br><pre> <code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myGenerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {   let name = <span class="hljs-string"><span class="hljs-string">'raja'</span></span>;   <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> name;    let lastName = <span class="hljs-string"><span class="hljs-string">'rao'</span></span>;   <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> lastName; } //   const myIterator = myGenerator(); // .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()    console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(myIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); //{value: <span class="hljs-string"><span class="hljs-string">"raja"</span></span>, done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>} // .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(myIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); //{value: <span class="hljs-string"><span class="hljs-string">"rao"</span></span>, done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}</code> </pre> <br><h3> <font color="#3AC1EF">‚ñç      next</font> </h3><br>    <code>.next()</code>     . <br><br>   ,    ,   ,    (    ).  ,  ,        <a href="https://redux-saga.js.org/">redux-saga</a> . <br><br>        <code>.next()</code>    ,     (   ).        ( <code>23</code> ),    <code>.next(23)</code> . <br><br><pre> <code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">profileGenerator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {   //  .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()   ,     //,    <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span>,   .   //     ,  ,     //  .<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(),     answer   let answer = <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> <span class="hljs-string"><span class="hljs-string">'How old are you?'</span></span>;   // <span class="hljs-string"><span class="hljs-string">'adult'</span></span>  <span class="hljs-string"><span class="hljs-string">'child'</span></span>       // answer   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (answer &gt; <span class="hljs-number"><span class="hljs-number">18</span></span>){       <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> <span class="hljs-string"><span class="hljs-string">'adult'</span></span>;   } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {       <span class="hljs-built_in"><span class="hljs-built_in">yield</span></span> <span class="hljs-string"><span class="hljs-string">'child'</span></span>;   } } //   const myIterator = profileGenerator(); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(myIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>()); //{value: <span class="hljs-string"><span class="hljs-string">"How old are you?"</span></span>, done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>} console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(myIterator.<span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(<span class="hljs-number"><span class="hljs-number">23</span></span>)); //{value: <span class="hljs-string"><span class="hljs-string">"adult"</span></span>, done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}</code> </pre> <br><h3> <font color="#3AC1EF">‚ñç   </font> </h3><br> <a href="http://callbackhell.com/"> </a>     ,     . <br><br>     ,  ,  <a href="https://github.com/tj/co">co</a> ,  ,      ,   <code>.next()</code> .     ,    . <br><br>    ,   <code>co</code>          <code>.next(result)</code>   ‚Ññ5  10,    . <br><br><pre> <code class="hljs javascript">co(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> *(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> post = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> Post.findByID(<span class="hljs-number"><span class="hljs-number">10</span></span>);   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> comments = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> post.getComments();   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(post, comments); }).catch(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function">)</span></span>{   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err); });</code> </pre> <br>      <br><br><ol><li>  <code>co</code> ,   ,  </li><li>     <code>Post.findByID(10)</code> </li><li>  <code>Post.findByID(10)</code>   </li><li>     </li><li>  ,    ,  <code>.next(result)</code> </li><li>     <code>post</code> </li><li>    <code>post.getComments()</code> </li><li>  <code>post.getComments()</code>   </li><li>     </li><li>  ,    ,  <code>.next(result)</code> </li><li>     <code>comments</code> </li><li>   <code>console.log(post, comments);</code> </li></ol><br>     async/await. <br><br><h2> <font color="#3AC1EF"> async/await</font> </h2><br>    ,     ,   ,        ,    ,  <code>co</code> . ,   ‚Äî   ,   ECMAScript    ,       .       <code>async</code>  <code>await</code> . <br>     async/await. <br><br><ol><li>   async/await    <code>await</code>  <code>yield</code> . </li><li>   <code>await</code>     . </li><li>       <code>async function</code> ,   <code>function*</code> . <br></li></ol><br>  ,  <code>async/await</code> ‚Äî   ,   ¬´ ¬ª. <br><br>   <code>async</code> ,    ,  JavaScript-  ,      -.   ,  ,    <code>await</code> . ,    <code>await</code>  ,       ,      . <br><br>     <code>getAmount</code>     ‚Äî <code>getUser</code>  <code>getBankBalance</code> .      ,   async/await      . <br><br><pre> <code class="hljs lua">//  ES2015... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAmount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(userId)</span></span></span></span>{   getUser(userId)       .<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(getBankBalance)       .<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(amount =&gt; {           console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(amount);       }); } //  async/await ES2017 async <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAmount2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(userId)</span></span></span></span>{   var user = await getUser(userId);   var amount = await getBankBalance(user);   console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(amount); } getAmount(<span class="hljs-string"><span class="hljs-string">'1'</span></span>); //$<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">000</span></span> getAmount2(<span class="hljs-string"><span class="hljs-string">'1'</span></span>); //$<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">000</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(userId)</span></span></span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new Promise(resolve =&gt; {       setTimeout(() =&gt; {           resolve(<span class="hljs-string"><span class="hljs-string">'john'</span></span>);       }, <span class="hljs-number"><span class="hljs-number">1000</span></span>);   }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getBankBalance</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(user)</span></span></span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new Promise((resolve, reject) =&gt; {       setTimeout(() =&gt; {           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (user == <span class="hljs-string"><span class="hljs-string">'john'</span></span>){               resolve(<span class="hljs-string"><span class="hljs-string">'$1,000'</span></span>);           } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {               reject(<span class="hljs-string"><span class="hljs-string">'unknown user'</span></span>);           }       }, <span class="hljs-number"><span class="hljs-number">1000</span></span>);   }); }</code> </pre> <br><h2> <font color="#3AC1EF"> </font> </h2><br>       .   ES2018 (   ) TC39     <code>Symbol.asyncIterator</code> ,    ‚Äî <code>for-await-of</code>  ,        . <br><br>     . <br><br><h3> <font color="#3AC1EF">‚ñç </font> </h3><br><ol><li>    <code>.next()</code>    <code>{value: 'some val', done: false}</code> <br></li><li>     <code>: iterator.next() //{value: 'some val', done: false}</code> </li></ol><br><h3> <font color="#3AC1EF">‚ñç </font> </h3><br>  <code>.next()</code>     , ,   ,     <code>{value: 'some val', done: false}</code> . <br><br>    : <br><br><pre> <code class="hljs coffeescript">iterator.next().<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">({ value, done })</span></span></span><span class="hljs-function">=&gt;</span></span> {<span class="hljs-regexp"><span class="hljs-regexp">//</span></span>{value: <span class="hljs-string"><span class="hljs-string">'some val'</span></span>, done: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}}</code> </pre> <br>         <code>for-await-of</code> . <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> promises = [   <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> resolve(<span class="hljs-number"><span class="hljs-number">1</span></span>)),   <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> resolve(<span class="hljs-number"><span class="hljs-number">2</span></span>)),   <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> resolve(<span class="hljs-number"><span class="hljs-number">3</span></span>)), ]; <span class="hljs-comment"><span class="hljs-comment">//       , //           async function test(){   for await (const p of promises){       console.log(p);   } } test(); //1, 2, 3</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">Results</font> </h2><br>         JavaScript,     ,     ,     .  . <br><br><ul><li>       ,     .  ,  ,   ,      ,         <code>Object.keys</code>   <code>for-in</code> . <br></li><li>   ‚Äî    JavaScript,           . <br></li><li>   ‚Äî  ,       .     ,   <code>for-of</code>           . <br></li><li>  ‚Äî  ,   ,    <code>.next()</code> .         . <br></li><li>  ‚Äî  ,        .  ,           ,     ,          ,  ‚Äî   async/await. <br></li><li>  async/await       ,       . <br></li><li>   ‚Äî    ES2018,           .  ,     ,       ,        . <br></li></ul><br>  <b>Dear readers!</b>  ,    ,    ? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/359004/">https://habr.com/ru/post/359004/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358992/index.html">11 best fonts for programming</a></li>
<li><a href="../358994/index.html">Automatic accrual of fines according to the Unified State Automated Information System: fiction or reality?</a></li>
<li><a href="../358996/index.html">As I did programming tests, my little TIOBE and a few dollars</a></li>
<li><a href="../358998/index.html">Digital events in Moscow from 21 to 27 May</a></li>
<li><a href="../359002/index.html">Online education trends: TED, LinguaLeo, Knewton and other experiences</a></li>
<li><a href="../359006/index.html">.NET Core 2.1 Global Tools</a></li>
<li><a href="../359008/index.html">As we swung at the mobile fast paced shooter: technology and approaches</a></li>
<li><a href="../359010/index.html">Chrome tests Picture-in-Picture API for pop-up videos outside the browser</a></li>
<li><a href="../359012/index.html">Webinar: Planning Apache Ignite Cluster Capacity with Live Examples</a></li>
<li><a href="../359014/index.html">Hysteria around GDPR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>