<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Spyware quietly turns headphones into a microphone</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Schematic diagram of the microphone, headphones and speakers 

 Information security specialists from the Computer Security Research Center at Ben-Gur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Spyware quietly turns headphones into a microphone</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/531/65a/568/53165a568b574b56bc3f74f010560d9f.jpg"><br>  <i>Schematic diagram of the microphone, headphones and speakers</i> <br><br>  Information security specialists from the Computer Security Research Center at Ben-Gurion University have developed the spyware program <a href="https://arxiv.org/ftp/arxiv/papers/1606/1606.05915.pdf">SPEAKE (a) R</a> , which turns the headset into a microphone, unnoticed by the user. <br><br>  At the hardware level, the microphone and speakers / headphones work on a similar principle.  A microphone converts sound into electrical signals, and passive speakers or headphones perform the reverse operation.  In both devices, there is a small diaphragm that oscillates in a magnetic field to generate / detect sound waves.  A similar hardware device allows you to use a microphone instead of headphones or headphones instead of a microphone.  This is a well-known fact, <a href="http://www.zyra.org.uk/sp-mic.htm">long described in professional literature</a> .  <b>High-quality speakers record sound even better than cheap Chinese microphones!</b> <br><a name="habracut"></a><br>  To use speakers or headphones as a microphone, simply change the audio jack ‚Äî insert the headphones into the microphone jack, and vice versa. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The peculiarity of the program SPEAKE (a) R is that it <i>imperceptibly changes the assignment of the audio connector</i> to which the headphones are connected.  Instead of audio output (line out), the connector starts working on data reception (line in). <br><br>  The option to change the functionality of the connector is maintained at the level of the sound card chipset, and it can be activated programmatically.  The corresponding option is usually called <i>jack retasking</i> or <i>jack remapping</i> .  For example, such a function exists in Realtek Semiconductor Corp. chipsets, which are integrated into a large number of modern motherboards.  Here is a list of Realtek chipsets with support for this feature: ALC892, ALC889, ALC885, ALC888, ALC663, ALC662, ALC268, ALC262, ALC267, ALC272, ALC269, ALC3220.  In these chipsets, both audio connectors are connected simultaneously to the ADC and DAC, so that they can work in both modes. <br><br>  Moreover, a software change in audio assignment is part of the official <a href="http://www.intel.com/content/www/us/en/standards/high-definition-audio-specification.html">Intel High Definition Audio specifications</a> . <br><br>  The option is little known, until today only a small number of developers and specialists knew about it.  For example, several years ago, David Henningson (David Henningsson), one of the developers of the Linux kernel, <a href="http://voices.canonical.com/david.henningsson/2011/11/29/turn-your-mic-jack-into-a-headphone-jack/">mentioned</a> this feature in his blog. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/2ca/9cd/a8d/2ca9cda8d1a7acf950cbe18dc51ff3e4.png"><br><br>  Such a change in functionality was probably made for the convenience of computer assemblers, as well as for the users themselves.  Indeed, it is very convenient: you insert a microphone or headphones into any jack without bothering to read the inscriptions or study the color of the connectors (usually the green connector is for speakers, and the pink one is for microphone).  If it doesn't work, you just change the connector assignment in the settings, as shown in the screenshot from Ubuntu 11.10. <br><br>  Five years ago, David Henningson remarked that most of the current integrated cards support plug-in software replacement, but almost no one uses this function and does not even know about it. <br><br>  There is also a paranoid version that the programmatic change in the functionality of audio connectors was done in secret at the request of the special services.  At least, the document of the NSA from 1995 (!) Indicates that the secret services knew and used this method of remote wiretapping ( <a href="http://cryptome.info/0001/tempest-2-95.htm">RED / BLACK INSTALLATION GUIDANCE</a> , technical document of the NSA from 1995). <br><br><h1>  Threat </h1><br>  The threat is that headphones or speakers are installed on a large number of computers.  Many are accustomed to using them, not even knowing about the possibility of interception of conversations in the room.  But the enemy does not necessarily install listening equipment for espionage, if the victim voluntarily uses headphones or speakers on his computer. <br><br>  Microphones and webcams are not commonly found on every PC, but headphones and speakers are much more common. <br><br>  In a published <a href="https://arxiv.org/ftp/arxiv/papers/1606/1606.05915.pdf">scientific paper, the</a> authors published a technical description of the spying program SPEAKE (a) R and showed how it can be used in various situations.  They also appreciated the quality of the sound being recorded by the microphone and passive speakers operating in microphone mode. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ez3o8aIZCDM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Chipset manufacturers provide drivers through which the assignment of the audio jack is changed.  For example, in the case of the Realtek driver for Windows, this is done by <a href="https://www.reaper-x.com/2012/02/13/how-to-remap-retasking-realtek-onboard-jacks-ports/">changing the value in the Windows registry</a> . <br><br>  Here is the corresponding registry value: <br><br> <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Class\{4D36E96C-E325-11CE-BFC1-08002BE10318}\00XX\Settings\DrvYYYY_DevType_YYYY_SSYYYYYYYY</code> <br> <br><img src="https://habrastorage.org/getpro/geektimes/post_images/1ca/72f/903/1ca72f9037601739e55c6818fdd9e3e1.png"><br><br>  In Linux, access to the Advanced Linux Sound Architecture (ALSA) is done through the <code>hda-jack-retask</code> , which also changes the assignment of audio jacks. <br><br>  Thus, a spyware program after installation in the system can listen to the user through headphones using the standard tools of the Windows and Linux operating systems. <br><br>  Testing has shown that headphones record sound worse than a microphone, but still provide fairly good quality in the midrange at which human speech is heard.  In particular, the SAR index for headphones when recording at a distance of 3-5 meters corresponds approximately to the SAR index for a microphone when recording from 9 meters.  This is important because the meaning of SAR usually correlates with the ability to distinguish between human speech. <br><br><img src="https://habrastorage.org/files/437/a9d/eb1/437a9deb1b004c6b955f13bec68d7b47.png"><br><br>  Sound quality values ‚Äã‚Äãfor audio files are obtained using SNReval tools using a <a href="http://labrosa.ee.columbia.edu/projects/snreval/">standard technique</a> . <br><br>  To protect against this kind of wiretapping, experts recommend not using microphones, headphones and speakers in workplaces where high security is required, or only allowing active speakers that cannot work in reverse mode to be used.  Passive speakers and headphones should be considered as analog microphones with the use of appropriate safety rules.  At the program level, you can disable the sound card in the UEFI / BIOS settings. </div><p>Source: <a href="https://habr.com/ru/post/399363/">https://habr.com/ru/post/399363/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../399353/index.html">FAS conducts verification in the Moscow office of Lenovo</a></li>
<li><a href="../399355/index.html">Common Application Vulnerability with Touch ID</a></li>
<li><a href="../399357/index.html">Scalar chastotnik for single-phase asynchronous motor</a></li>
<li><a href="../399359/index.html">Tesla and SolarCity provided the whole island with energy</a></li>
<li><a href="../399361/index.html">The story of Black Friday. Why do Americans love her so much?</a></li>
<li><a href="../399365/index.html">Adapter for gamepad Sega ‚Üí AppleII do it yourself</a></li>
<li><a href="../399367/index.html">No one cares about the security of unlocked Android phones</a></li>
<li><a href="../399369/index.html">FAS suspects six computer equipment companies to create a cartel</a></li>
<li><a href="../399371/index.html">Another traffic light in the office</a></li>
<li><a href="../399373/index.html">Pain in the hands when working at the computer. Part 1: Tunnel Syndromes - Review and Diagnose Problems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>