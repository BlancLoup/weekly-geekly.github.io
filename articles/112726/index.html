<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Watch the video on the barcode scanner</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúOf all the arts, cinema and circus are the most important for us‚Äù 
 - IN AND. Lenin 

 Watching video is one of the favorite entertainment in the mod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Watch the video on the barcode scanner</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/235cc8e9/dadc363e/746ffbc0/9561e6dc.jpg" align="right"><br>  <i>‚ÄúOf all the arts, cinema and circus are the most important for us‚Äù</i> <i><br></i>  <i>- IN AND.</i>  <i>Lenin</i> <br><br>  Watching video is one of the favorite entertainment in the modern world, films are now watched on almost all devices, even on refrigerators.  Unfortunately, there was no suitable refrigerator nearby, and I decided to watch the movie on a barcode scanner.  The Cipher Lab 8001 scanner was on hand. The scanner player‚Äôs technical specifications: <ul><li>  16-bit CMOS processor </li><li>  1 MB of program memory </li><li>  1 MB SRAM for data </li><li>  FSTN display with LED backlight resolution of 100 √ó 64 </li></ul><br><a name="habracut"></a><br>  1 MB of memory should have been enough to store the video, but it would deprive the player of interactivity, and complicate the development process.  Therefore, we will display data that comes directly from the infrared port.  Also, for simplicity, the last 4 columns of the screen are not used.  The final resolution of the image is 96 √ó 64 (the number of points in the line is a multiple of the size of the byte). <br><br><h4>  Scanner firmware </h4><br>  There is nothing complicated in the firmware: <br><ol><li>  We read data from the infrared port; </li><li>  display on the screen; </li><li>  send the computer a request for the next frame. </li></ol><br>  The only thing you should pay attention to is that the size of the incoming buffer is limited to 256 bytes.  And since the size of the whole frame is 96 √ó 64/8 = 768 bytes, we will have to split the frame into 4 blocks of 16 lines each.  Yes, the data would fit into 3 blocks of 256 bytes, but I wanted the block number to be transmitted as the first byte of the input buffer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote><code><font color="black"><font color="#80000"><b>int</b></font> PlaceFromCom <font color="#808030">(</font> <font color="#80000"><b>void</b></font> <font color="#808030">)</font> <font color="#800080">{</font> <br> <font color="#80000"><b>long</b></font> timer <font color="#800080">;</font> <br> <font color="#80000"><b>int</b></font> position <font color="#808080">;</font> <br> <font color="#80000"><b>char</b></font> c <font color="#808030">,</font> picture <font color="#808030">[</font> BLOCK_SIZE <font color="#808030">]</font> <font color="#808080">;</font> <br> <font color="#80000"><b>unsigned char</b></font> blockId <font color="#808030">,</font> loaded <font color="#808080">;</font> <br> <br> SendRequest <font color="#808030">()</font> <font color="#808080">;</font> <br> <br> timer <font color="#808030">=</font> sys_msec <font color="#808080">;</font> <br> loaded <font color="#808030">=</font> <font color="#008c00">0</font> <font color="#808080">;</font> <br> position <font color="#808030">=</font> <font color="#008c00">0</font> <font color="#808080">;</font> <br> <font color="#80000"><b>while</b></font> <font color="#808030">(</font> sys_msec <font color="#808030">&lt;</font> <font color="#808030">=</font> timer <font color="#808030">+</font> TIMEOUT_MSEC <font color="#808030">)</font> <font color="#808080">{</font> <br> <font color="#80000"><b>if</b></font> <font color="#808030">(</font> read_com <font color="#808030">(</font> COM_PORT_NUM <font color="#808030">,</font> <font color="#808030">&amp;</font> c <font color="#808030">)</font> <font color="#808030">)</font> <font color="#808080">{</font> <br> picture <font color="#808030">[</font> position <font color="#808030">]</font> <font color="#808030">=</font> c <font color="#808080">;</font> <br> position <font color="#808030">+</font> <font color="#808030">+</font> <font color="#808080">;</font> <br> <font color="#80000"><b>if</b></font> <font color="#808030">(</font> position <font color="#808030">=</font> <font color="#808030">=</font> BLOCK_SIZE <font color="#808030">)</font> <font color="#808080">{</font> <br> loaded <font color="#808030">=</font> <font color="#008c00">1</font> <font color="#808080">;</font> <br> <font color="#80000"><b>break</b></font> <font color="#808080">;</font> <br> <font color="#808080">}</font> <br> <font color="#808080">}</font> <br> <font color="#808080">}</font> <br> <font color="#80000"><b>if</b></font> <font color="#808030">(</font> <font color="#808030">!</font> loaded <font color="#808030">)</font> <font color="#808080">{</font> <br> printf <font color="#808030">(</font> "Comm error\r\n" <font color="#808030">)</font> <font color="#808080">;</font> <br> <font color="#80000"><b>return</b></font> <font color="#008c00">1</font> <font color="#808080">;</font> <br> <font color="#808080">}</font> <br> blockId <font color="#808030">=</font> <font color="#808030">(</font> picture <font color="#808030">[</font> <font color="#008c00">0</font> <font color="#808030">]</font> <font color="#808030">%</font> <font color="#008c00">4</font> <font color="#808030">)</font> <font color="#808080">;</font> <br> show_image <font color="#808030">(</font> <font color="#008c00">0</font> <font color="#808030">,</font> blockId <font color="#808030">*</font> BLOCK_H <font color="#808030">,</font> IMAGE_WIDTH <font color="#808030">,</font> BLOCK_H <font color="#808030">,</font> <font color="#808030">&amp;</font> <font color="#808030">(</font> picture <font color="#808030">[</font> <font color="#008c00">1</font> <font color="#808030">]</font> <font color="#808030">)</font> <font color="#808030">)</font> <font color="#808080">;</font> <br> <font color="#80000"><b>return</b></font> <font color="#008c00">0</font> <font color="#808080">;</font> <br> <font color="#808080">}</font> <br></font></code> </blockquote><br><h4>  Output program </h4><br>  The program for outputting video to COM looks even simpler than the firmware: <br><ol><li>  Make a screenshot of the screen; </li><li>  change its size and convert to a two-color image; </li><li>  break into blocks and convert to a stream of bytes; </li><li>  waiting for a request from the scanner, return the buffer. </li></ol><br>  For some reason, taking screenshots in Python takes a lot of time, so this program is in a separate thread in the program.  The rest of the code is trivial.  For example, the output loop: <br><blockquote> <code><font color="black"><font color="#80000"><b>while</b></font> <font color="#e34adc">True</font> <font color="#808030">:</font> <br> data <font color="#808030">=</font> ser <font color="#808030">.</font> read <font color="#808030">(</font> <font color="#008c00">9999</font> <font color="#808030">)</font> <br> <font color="#80000"><b>if</b></font> <font color="#e34adc">len</font> <font color="#808030">(</font> data <font color="#808030">)</font> <font color="#808030">&gt;</font> <font color="#008c00">0</font> <font color="#808030">:</font> <br> <font color="#80000"><b>if</b></font> data <font color="#808030">[</font> <font color="#008c00">0</font> <font color="#808030">]</font> <font color="#808030">=</font> <font color="#808030">=</font> <font color="#0000e6">"V"</font> <font color="#808030">:</font> <br> ser <font color="#808030">.</font> write <font color="#808030">(</font> <font color="#e34adc">chr</font> <font color="#808030">(</font> currentBlock <font color="#808030">)</font> <font color="#808030">)</font> <br> ser <font color="#808030">.</font> write <font color="#808030">(</font> desktop <font color="#808030">.</font> strings <font color="#808030">[</font> currentBlock <font color="#808030">]</font> <font color="#808030">)</font> <br> currentBlock <font color="#808030">=</font> <font color="#808030">(</font> currentBlock <font color="#808030">+</font> <font color="#008c00">1</font> <font color="#808030">)</font> <font color="#808030">%</font> blockCount <br></font></code> </blockquote><br><h4>  Work result </h4><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/_sXnplHT7JU%3Ffeature%3Doembed&amp;xid=25657,15700021,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhi_2n2m2ORNjbOo1PBfNBsdovk4mg" frameborder="0" allowfullscreen=""></iframe><br><br>  Source codes of programs can be downloaded <a href="">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/112726/">https://habr.com/ru/post/112726/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../112715/index.html">Nokia does not give me my contacts</a></li>
<li><a href="../112717/index.html">Press conference and open testing SurroundBAR 6000 IHT</a></li>
<li><a href="../112718/index.html">Canobuvosti, 76th edition</a></li>
<li><a href="../112720/index.html">10 tips to optimize the speed of your site</a></li>
<li><a href="../112721/index.html">Just do not be silent ...</a></li>
<li><a href="../112727/index.html">BlogEngine.NET 2.0 blogging engine</a></li>
<li><a href="../112728/index.html">HideMyAss Proxifier</a></li>
<li><a href="../112731/index.html">So how many golf balls really fit on a school bus?</a></li>
<li><a href="../112733/index.html">How AES works</a></li>
<li><a href="../112736/index.html">Top 20 Web Fonts</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>