<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Code optimization with RequireJS: how it is done and why it is needed</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my previous post, I talked about how to connect RequireJS to my project. In addition, he promised to talk about optimization. Optimizing projects b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Code optimization with RequireJS: how it is done and why it is needed</h1><div class="post__text post__text-html js-mediator-article">  In my previous post, I talked about how to connect RequireJS to my project.  In addition, he promised to talk about optimization.  Optimizing projects built on RequireJS is very fast and easy.  Moreover, the code itself (scripts, libraries, plug-ins) and style files are optimized. <br><a name="habracut"></a><br>  To demonstrate the requirements for RequireJS code optimization, I created a simple one-page project.  The main page displays a list of users.  Clicking on the user gets to the page with information about him.  Users are divided into two types - regular and administrators, and their pages differ in both content and design. <br><br>  To accomplish this task, I, as always, used the Backbone library and, of course, RequireJS.  At what I ended up with, you can see <a href="http://my-files.ru/rehuzg">here</a> . <br><br><h4>  How it's done </h4><br>  Connection RequireJS problems should arise.  The main thing is to describe the configuration correctly (application.js file): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="javascript hljs">requirejs.config({ <span class="hljs-attr"><span class="hljs-attr">baseUrl</span></span>: <span class="hljs-string"><span class="hljs-string">"js/library"</span></span>, <span class="hljs-attr"><span class="hljs-attr">paths</span></span>: { <span class="hljs-attr"><span class="hljs-attr">jquery</span></span>: <span class="hljs-string"><span class="hljs-string">'jquery.min'</span></span>, <span class="hljs-attr"><span class="hljs-attr">backbone</span></span>: <span class="hljs-string"><span class="hljs-string">'backbone.min'</span></span>, <span class="hljs-attr"><span class="hljs-attr">underscore</span></span>: <span class="hljs-string"><span class="hljs-string">'underscore.min'</span></span>, <span class="hljs-attr"><span class="hljs-attr">domready</span></span>: <span class="hljs-string"><span class="hljs-string">'domReady'</span></span>, <span class="hljs-attr"><span class="hljs-attr">appControllers</span></span>: <span class="hljs-string"><span class="hljs-string">'../Controllers'</span></span>, <span class="hljs-attr"><span class="hljs-attr">appModels</span></span>: <span class="hljs-string"><span class="hljs-string">'../Models'</span></span>, <span class="hljs-attr"><span class="hljs-attr">appViews</span></span>: <span class="hljs-string"><span class="hljs-string">'../Views'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">shim</span></span>: { <span class="hljs-string"><span class="hljs-string">'underscore'</span></span>: { <span class="hljs-attr"><span class="hljs-attr">exports</span></span>: <span class="hljs-string"><span class="hljs-string">'_'</span></span> }, <span class="hljs-string"><span class="hljs-string">'backbone'</span></span>: { <span class="hljs-attr"><span class="hljs-attr">deps</span></span>: [<span class="hljs-string"><span class="hljs-string">'underscore'</span></span>, <span class="hljs-string"><span class="hljs-string">'jquery'</span></span>], <span class="hljs-attr"><span class="hljs-attr">exports</span></span>: <span class="hljs-string"><span class="hljs-string">'Backbone'</span></span> } } });</code> </pre> <br>  Immediately I want to answer the question: why connect Backbone in the shim block?  The answer is very simple.  The version of the Backbone and underscore libraries that I use does not support <a href="https://github.com/amdjs/amdjs-api/wiki/AMD">AMD</a> .  Therefore, they must be added to the shim block.  But you can download versions with AMD support and quietly use Backbone without additional settings RequireJS. <br><br>  The project is ready and we can begin to optimize it.  To do this, you must perform several steps. <br><br><ol><li>  On the <a href="https://nodejs.org/">official website</a> download and install Node.  It is required to run the optimization script. </li><li>  Download the <a href="http://requirejs.org/docs/download.html">r.js</a> optimization <a href="http://requirejs.org/docs/download.html">script</a> .  Create a separate folder optimization in the root of our project and put this script there. </li><li>  In the optimization folder, we create files with optimization settings for scripts (file build_scripts.js) and styles (build_css.js).  There are a lot of settings.  Full list of them is <a href="">here</a> .  These settings can also be set as command line parameters directly when the optimization script is run.  But I decided to save them in files.  First, it is more convenient when editing.  Secondly, the command line parameters have limitations in syntax.  Namely - the point is interpreted as a separator for the properties of objects.  Therefore, the record type <br><br><pre> <code class="javascript hljs">paths.core/jquery.tabs=empty:</code> </pre><br>  will match the configuration <br><br><pre> <code class="javascript hljs">paths: { <span class="hljs-string"><span class="hljs-string">'core/jquery'</span></span>: { <span class="hljs-attr"><span class="hljs-attr">tabs</span></span>: <span class="hljs-string"><span class="hljs-string">'empty:'</span></span> } }</code> </pre><br>  but not <br><br><pre> <code class="javascript hljs">paths: { <span class="hljs-string"><span class="hljs-string">'core/jquery.tabs'</span></span>: <span class="hljs-string"><span class="hljs-string">'empty:'</span></span> } }</code> </pre><br></li></ol><br>  All is ready.  Now just run the optimization script.  Go to the console and execute the command: <br><br><pre> <code class="bash hljs">node r.js -o build_scripts.js</code> </pre><br>  Got an optimized script file <b>application-build.js</b> . <br><br>  Now let's optimize our style files.  It is not so easy as with scripts.  The project uses four style files: <br><br><ul><li>  application.css </li><li>  adminpage.css </li><li>  userpage.css </li><li>  bootstrap.min.css </li></ul><br>  In order to merge them into one, let's do this: import the other three files into the application.css file: <br><br><pre> <code class="javascript hljs">@<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> url(<span class="hljs-string"><span class="hljs-string">"bootstrap.min.css"</span></span>); @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> url(<span class="hljs-string"><span class="hljs-string">"userpage.css"</span></span>); @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> url(<span class="hljs-string"><span class="hljs-string">"adminpage.css"</span></span>);</code> </pre><br>  Perform optimization: <br><br><pre> <code class="bash hljs">node r.js -o build_css.js</code> </pre><br>  Received the file <b>application-built.css</b> .  And now let's check the result by connecting our optimized files to the project. <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"css/application-built.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">media</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"screen"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"application-built.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  As you can see everything works.  By the way, this is the line in the configuration file <br><br><pre> <code class="javascript hljs">include: [<span class="hljs-string"><span class="hljs-string">"requireLib"</span></span>],</code> </pre><br>  allows us to use an optimized script file separately, without RequireJS.  Otherwise, the optimized script would connect like this: <br><br><pre> <code class="javascript hljs">&lt;script data-main=<span class="hljs-string"><span class="hljs-string">"js/application-built"</span></span> src=<span class="hljs-string"><span class="hljs-string">"js/library/require.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br><h4>  What is it for </h4><br>  Optimization helps speed up the loading of scripts, which in turn improves the speed of the site as a whole.  But how do you know if a project really needs optimization?  Maybe everything is already working fast enough, and nothing can be improved?  The answer to this question will give you <a href="http://yslow.org/">YSlow</a> . <br><br>  YSlow is a Mozilla Firefox browser extension developed by Yahoo.  It can measure the speed of loading pages, and also conducts a fairly detailed analysis of their individual components.  One of the points in the analysis is the need to optimize the code.  YSlow does not work independently, but as part of the Firebug extension. </div><p>Source: <a href="https://habr.com/ru/post/254675/">https://habr.com/ru/post/254675/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254659/index.html">Using Xen functionality</a></li>
<li><a href="../254665/index.html">Simple game by means of PTK "Quint 7"</a></li>
<li><a href="../254667/index.html">Theory and practice of migration of web systems to PostgreSQL</a></li>
<li><a href="../254671/index.html">Hard Drive Killers. Coercive headshot</a></li>
<li><a href="../254673/index.html">Softbank is going to connect talking robot Pepper to IBM Watson</a></li>
<li><a href="../254677/index.html">Unity 3d 4.6 (5) project Survival shooter game in Russian</a></li>
<li><a href="../254679/index.html">Unity support at Consulo for 2015 in one post</a></li>
<li><a href="../254681/index.html">Ionic framework. Ecosystem overview</a></li>
<li><a href="../254683/index.html">Antifraud (part 4): an analytical system for recognizing fraudulent payments</a></li>
<li><a href="../254685/index.html">Hacking drones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>