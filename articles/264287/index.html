<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Two-factor authentication. New challenges</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instead of a prologue: this article deals with the theft of money from accounts of users of payment systems, various client-banks, etc. 



 It is not...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Two-factor authentication. New challenges</h1><div class="post__text post__text-html js-mediator-article">  Instead of a prologue: this article deals with the theft of money from accounts of users of payment systems, various client-banks, etc. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1b1/73c/d1e/1b173cd1e5d6017ad8ed0fbf53da6316.jpg" alt="image"></div><br><a name="habracut"></a><br>  It is not a secret that payment and other financial services place high demands on security.  In this regard, comprehensive measures are being taken to protect both the system and user accounts.  In order to prevent the possibility of hacking and disabling the system, various means are used such as: <br><br><ul><li>  all kinds of firewalls, now WAF (Web Application Firewall) is very popular, </li><li>  duplication of key elements of the system, </li><li>  data replication;  tokenization of various stages of the system, </li><li>  hardware encryption using HSM (Hardware Security Modules). </li></ul><br>  From the point of view of protecting the user's account and its operations, both ordinary password protection and other means are used: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  restriction of access by IP address </li><li>  code cards, payment passwords, PINs, </li><li>  biometrics, </li><li>  check the user's environment. </li></ul><br>  And of course, two-factor authentication tools, EDS (Electronic Digital Signature) and contactless tokens - OTP (One-Time Password) generators. <br><br>  I have always believed that two-factor authentication is a panacea, almost from all possible vulnerabilities in the process of user authentication.  Following the latest security trends, as we thought at that time, we recommended our users to authenticate with our payment system using hardware tokens (TOTP, it is called a ‚Äútime-token‚Äù) of leading global suppliers or software Authenticator from Google.  To confirm the payment transactions (transactions), the tokens mentioned above were used, and for those who did not have them, we required to enter a one-time password from the SMS.  Such protection seemed to us absolutely reliable, but if it were really so, then this article would not be ... <br><br>  I will not be around for about a long time, get down to business.  One day, a request came from a furious user to the caliper that his account was ‚Äúreset‚Äù, in other words, all the funds were withdrawn.  After the initial investigation, we saw from the history of operations that all funds in a regular mode for several transactions were withdrawn to different accounts by the user.  Prior to this, there was no connection (operation) between the user and these accounts.  After a more detailed review and analysis of all data, it turned out that this user was the victim of ‚ÄúAvtozaliv‚Äù and ‚ÄúReplacer‚Äù. <br><br>  A bit of theory gathered on the Internet: <br><br>  <i>Avtozaliv</i> - an inject with an administrative panel that performs automated and coordinated actions in the victim's account based on the position / situation in the account.  This malware collects account data, looks at what accounts are in the account and sends data to the administrative panel.  In the panel there is a table of drops and their status, notes, account data where to transfer funds, and to what extent, to bypass the limits and not cause suspicion.  The panel on the basis of automatic rules or through manual coordination selects the drop and produces an injection.  Further a few alternative options: <br><br>  <i>option 1) the</i> injection displays the user a window with a text like ‚ÄúWait for data checking‚Äù, and he secretly performs actions leading to the flooding of money by clicking on the necessary links inside the account and filling out the forms requested by the system.  In case the TAN / OTP / PIN code and so on is requested to complete the transfer, avtozaliv issues a fake page to the holder requesting that code, but under its pretext (divorce).  The holder enters the data in the fake, avtozaliv uses this data to continue / end the gulf. <br><br>  <i>option 2)</i> inject waits for the user to want to perform a legal transaction for which the TAN / OTP / PIN code will be requested, but with this code an illegal transaction will be confirmed - a deposit of money for a drop. <br><br>  After that, the holder is allowed into the account on which the replayer is already activated. <br><br>  <i>Replacer</i> - software code aimed at hiding the translation data made avtozalivom.  In other words, balance substitution is the concealment of a transfer from the transfer history and other manipulations aimed at preventing the holder from noticing the transfer.  In our case, the holder sees the fake balance and fake legal transaction. <br><br>  Our system has various means of multi-level checks, for example, reconciliation of the balance and the amount of user transactions, as well as reconciliation of balances in our system and external ones, and a number of others.  All this did not help in this case, because  the transaction did not come ‚Äúout of thin air‚Äù and looked like quite ordinary. <br><br>  Of course, we heard about various types of attacks and in practice we often encounter various kinds of frauds, but we were surprised to say the least.  Although the funds were ‚Äúdrained‚Äù from the user's account, in order to avoid reputational consequences, the company‚Äôs management compensated part of the losses to the victim.  This was also due to the fact that he was a bona fide client with good turnover, and most importantly, he had all the means of protection available at that time from our arsenal installed. <br><br>  After some searches, we found that this two-factor authentication bypass is already well known, and many advanced providers offer similar solutions to deal with this vulnerability, they are called differently (data signature, <a href="https://www.protectimus.com/blog/ru-recommendations-for-using-cwys-data-signing/">CWYS</a> (Confirm What You See), but have a similar implementation.) the point is that a one-time password is generated not only on the basis of a secret key, time, or counter, but using all the key transaction data, such as amount, currency, recipient, even if the attacker is  Amum password to use for their malicious needs him he can not. <a href="https://www.protectimus.com/blog/ru-detailed-information-on-data-signing/">Here</a> everything is described in detail. In order to implement these features, we contacted several providers, and have made their choice. <br><br>  So, while we sighed with relief ... We are waiting for new challenges. </div><p>Source: <a href="https://habr.com/ru/post/264287/">https://habr.com/ru/post/264287/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264277/index.html">HP is the leader of the Gartner Magic Quadrant for modular servers</a></li>
<li><a href="../264279/index.html">API interface for free PBX and telephony</a></li>
<li><a href="../264281/index.html">PostgreSQL 9.5: what's new? Part 1. INSERT ... ON CONFLICT DO NOTHING / UPDATE and ROW LEVEL SECURITY</a></li>
<li><a href="../264283/index.html">Welcome to Windows Camp - September 10, Moscow</a></li>
<li><a href="../264285/index.html">Data Science: the path to professionalism</a></li>
<li><a href="../264289/index.html">Making the code cleaner: Refactoring the PCI driver for a NAND Denali controller</a></li>
<li><a href="../264291/index.html">Creating The Blacksmith: animation, camera effects, audio / video</a></li>
<li><a href="../264293/index.html">How we overcame USB data transfer</a></li>
<li><a href="../264295/index.html">Secrets of testing Ethernet channels</a></li>
<li><a href="../264297/index.html">Vim in full: Testing with xUnit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>