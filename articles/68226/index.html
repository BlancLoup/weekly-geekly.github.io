<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create a visual search in IE8 to search for friends on Twitter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With the release of IE8 we got one of the most convenient features in the browser - Visual Search Suggestions. 

 This article will show how to implem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create a visual search in IE8 to search for friends on Twitter</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/d2e/2df/b6f/d2e2dfb6f9b44b66778ae89e4f86e0e8.png" align="right"><br>  With the release of IE8 we got one of the most convenient features in the browser - Visual Search Suggestions. <br><br>  This article will show how to implement a friend search on Twitter, through a special Visual Search string in IE8.  As you type the name, we will see the avatar, the name that the friend has filled out and the current status. <br>  The guide is based on the article <a href="http://msdn.microsoft.com/en-us/library/cc848862(VS.85).aspx">Search Provider Extensibility in Internet Explorer</a> from MSDN. <br><br><a name="habracut"></a><br><h3>  <strong>We build WCF REST service.</strong> </h3><br>  Create a new Empty Web Site, call it TwitterFriendsSearch <br><img src="https://habrastorage.org/getpro/habr/post_images/c15/c59/1f6/c15c591f6106de3f74f8ed26680377e2.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Add a new item to the project, WCF Service and call it SuggestService.svc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6a7/64b/1d7/6a764b1d7267dea96f1c3e9b82110718.png"><br><br>  This will create the following files: <ul><li>  <strong>ISuggestService.cs</strong> - Service Contract.  Defines the signature of the service actions. </li><li>  <strong>SuggestService.cs</strong> - Service implementation </li><li>  <strong>SuggestService.svc</strong> - service location. </li><li>  <strong>Web.config -</strong> WCF service settings. </li></ul><br>  We change the definition of a service contract (ISuggestService.cs) as follows: <br><blockquote><code><font color="black">[ServiceContract] <br> <font color="#0000ff">public</font> <font color="#0000ff">interface</font> ISuggestService <br> { <br> [OperationContract] <br> <font color="#0000ff">string</font> Search( <font color="#0000ff">string</font> friend); <br> } <br></font></code> </blockquote><br>  Open the service implementation (SuggestService.cs).  To begin with we will make simple implementation, we will change it a bit later. <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> SuggestService : ISuggestService <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Search( <font color="#0000ff">string</font> friend) <br> { <br> <font color="#0000ff">return</font> <font color="#A31515">"Hello, "</font> + friend; <br> } <br> } <br></font></code> </blockquote><br>  To ensure REST support, we add a required <strong>WebGet</strong> attribute over the service action. <br><blockquote> <code><font color="black">[OperationContract] <br> [WebGet(UriTemplate = <font color="#A31515">"/Search?q={friend}"</font> , <br> BodyStyle = WebMessageBodyStyle.Bare)] <br> <font color="#0000ff">string</font> Search( <font color="#0000ff">string</font> friend); <br></font></code> </blockquote><br>  Change WCF service settings (web.config) to support REST.  Position the <strong>behaviors</strong> node and add a new behavior target, under the System.serviceModel section: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">system.serviceModel</font> <font color="#0000ff">&gt;</font> <br> ... <br> <font color="#0000ff">&lt;</font> <font color="#800000">behaviors</font> <font color="#0000ff">&gt;</font> <br> ... <br> <font color="#0000ff">&lt;</font> <font color="#800000">endpointBehaviors</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">behavior</font> <font color="#ff0000">name</font> <font color="#0000ff">="REST"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">webHttp</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">behavior</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">endpointBehaviors</font> <font color="#0000ff">&gt;</font> <br> ... <br> <font color="#0000ff">&lt;/</font> <font color="#800000">behaviors</font> <font color="#0000ff">&gt;</font> <br> ... <br> <font color="#0000ff">&lt;/</font> <font color="#800000">system.serviceModel</font> <font color="#0000ff">&gt;</font> <br></font></code> </blockquote><br>  In the same section, we place the ad service and location.  Replace the wsHttpBinding binding with the <strong>webHttpBinding</strong> and add the location behavior: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">services</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">service</font> <font color="#ff0000">behaviorConfiguration</font> <font color="#0000ff">="SuggestServiceBehavior"</font> <br> <font color="#ff0000">name</font> <font color="#0000ff">="SuggestService"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">endpoint</font> <font color="#ff0000">address</font> <font color="#0000ff">=""</font> <br> <font color="#ff0000">binding</font> <font color="#0000ff">="webHttpBinding"</font> <br> <font color="#ff0000">contract</font> <font color="#0000ff">="ISuggestService"</font> <br> <font color="#ff0000">behaviorConfiguration</font> <font color="#0000ff">="REST"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">service</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">services</font> <font color="#0000ff">&gt;</font> <br></font></code> </blockquote><br>  Run the project and go to the .svc file.  Next, add the UriTemplate, which we announced in the service, with the name of a friend to search: <br><br>  <a href="http://localhost/">localhost</a> : 50434 / TwitterFriendsSearch / SuggestService.svc / search? q = guy <br><br>  The answer should look like ‚Äúhello, guy‚Äù. <br><br><h3>  <strong>We return the search result.</strong> </h3><br>  According to the MSDN page, the link to which I cited earlier, the final answer for a visual search should look like this (this answer corresponds to the image I attached at the beginning of the article): <br><blockquote> <code><a href="http://tinyurl.com/6m9e4g"></a> <a href="http://twitter.com/home"></a> <a href="http://twitter.com/home"></a> <a href="http://twitter.com/home"></a> <a href="http://twitter.com/home"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SearchSuggestion</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Query</font> <font color="#0000ff">&gt;</font> guy <font color="#0000ff">&lt;/</font> <font color="#800000">Query</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Section</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> guyhaim <font color="#0000ff">&lt;/</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> @rohitbhargava tinyurl.com/6m9e4g <font color="#0000ff">&lt;/</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> twitter.com/home <font color="#0000ff">&lt;/</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Image</font> <font color="#ff0000">source</font> <font color="#0000ff">="http://...normal.jpg"</font> <br> <font color="#ff0000">height</font> <font color="#0000ff">="48"</font> <font color="#ff0000">width</font> <font color="#0000ff">="48"</font> <font color="#ff0000">alt</font> <font color="#0000ff">="guyhaim"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> Guy Malachi <font color="#0000ff">&lt;/</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> Yahoo toolbar looks kinda weird. <font color="#0000ff">&lt;/</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> twitter.com/home <font color="#0000ff">&lt;/</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Image</font> <font color="#ff0000">source</font> <font color="#0000ff">="http://...normal.jpg"</font> <br> <font color="#ff0000">height</font> <font color="#0000ff">="48"</font> <font color="#ff0000">width</font> <font color="#0000ff">="48"</font> <font color="#ff0000">alt</font> <font color="#0000ff">="guym"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> guy zohar <font color="#0000ff">&lt;/</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> switch screen <font color="#0000ff">&lt;/</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> twitter.com/home <font color="#0000ff">&lt;/</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Image</font> <font color="#ff0000">source</font> <font color="#0000ff">="http://...normal.jpg"</font> <br> <font color="#ff0000">height</font> <font color="#0000ff">="48"</font> <font color="#ff0000">width</font> <font color="#0000ff">="48"</font> <font color="#ff0000">alt</font> <font color="#0000ff">="guyzo"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> guyzarz <font color="#0000ff">&lt;/</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> @ekampf May it rest in peace, in one piece. <font color="#0000ff">&lt;/</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> twitter.com/home <font color="#0000ff">&lt;/</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Image</font> <font color="#ff0000">source</font> <font color="#0000ff">="http://...normal.jpg"</font> <br> <font color="#ff0000">height</font> <font color="#0000ff">="48"</font> <font color="#ff0000">width</font> <font color="#0000ff">="48"</font> <font color="#ff0000">alt</font> <font color="#0000ff">="guyzarz"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Section</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SearchSuggestion</font> <font color="#0000ff">&gt;</font> <br></font></code> </blockquote><br>  Create the following classes to represent the elements of the response, use the attributes of Xml serialization, to further serialize them to the desired result. <br><blockquote> <code><font color="black"><font color="#008000">// Image.cs</font> <br> [XmlType] <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Image <br> { <br> [ <font color="#2B91AF">XmlAttribute</font> (AttributeName= <font color="#A31515">"source"</font> )] <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Source { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> [ <font color="#2B91AF">XmlAttribute</font> (AttributeName = <font color="#A31515">"height"</font> )] <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> Height { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> [ <font color="#2B91AF">XmlAttribute</font> (AttributeName = <font color="#A31515">"width"</font> )] <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> Width { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> [ <font color="#2B91AF">XmlAttribute</font> (AttributeName = <font color="#A31515">"alt"</font> )] <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Alt { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> } <br> <font color="#008000">// Item.cs</font> <br> [XmlType] <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Item <br> { <br> [XmlElement] <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Text { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> [XmlElement(IsNullable= <font color="#0000ff">false</font> )] <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Description { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> [XmlElement(IsNullable = <font color="#0000ff">false</font> )] <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Url { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> [XmlElement(IsNullable = <font color="#0000ff">false</font> )] <br> <font color="#0000ff">public</font> Image Image { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> } <br> <br> <font color="#008000">// SearchSuggestion.cs</font> <br> [XmlRoot(Namespace= <font color="#A31515">""</font> )] <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> SearchSuggestion <br> { <br> <font color="#0000ff">public</font> SearchSuggestion() <br> { <br> <font color="#0000ff">this</font> .Section = <font color="#0000ff">new</font> <font color="#2B91AF">List</font> &lt;Item&gt;(); <br> } <br> <br> [XmlElement] <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Query { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> [XmlArray] <br> <font color="#0000ff">public</font> <font color="#2B91AF">List</font> &lt;Item&gt; Section { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> }</font></code> </blockquote> <br>  Change the service contract to return a <strong>SearchSuggestion</strong> response instead of a string.  Also add the <strong>XmlSerializerFormat</strong> attribute to make sure that the response will be serialized to XML. <br><blockquote> <code><font color="black">[ServiceContract] <br> <font color="#0000ff">public</font> <font color="#0000ff">interface</font> ISuggestService <br> { <br> [OperationContract] <br> [WebGet(UriTemplate = <font color="#A31515">"/Search?q={friend}"</font> , <br> BodyStyle = WebMessageBodyStyle.Bare)] <br> [XmlSerializerFormat] <br> SearchSuggestion Search( <font color="#0000ff">string</font> friend); <br> } <br></font></code> </blockquote><br>  Now we return in the Search <strong>SearchSuggestion</strong> method with default values ‚Äã‚Äãinstead of a string. <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> SearchSuggestion Search( <font color="#0000ff">string</font> friend) <br> { <br> SearchSuggestion suggestion = <font color="#0000ff">new</font> SearchSuggestion <br> { <br> Query = friend <br> }; <br> <br> suggestion.Section.Add( <font color="#0000ff">new</font> Item <br> { <br> Text = friend, <br> Description = <font color="#A31515">"Hello, "</font> + friend, <br> Url = <font color="#A31515">"http://blogs.microsoft.co.il/blogs/bursteg"</font> , <br> Image = <font color="#0000ff">new</font> Image <br> { <br> Source = <font color="#A31515">"http://tinyurl.com/burstegprofileimage"</font> , <br> Alt = <font color="#A31515">"Guy Burstein"</font> , <br> Width = 48, <br> Height = 48 <br> } <br> }); <br> <br> <font color="#0000ff">return</font> suggestion; <br> } <br></font></code> </blockquote><br>  If we now start the project and go back to the link that we used earlier, we should get the following result: <br><blockquote> <code><a href="http://blogs.microsoft.co.il/blogs/bursteg"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SearchSuggestion</font> <font color="#ff0000">xmlns:xsi</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema-instance"</font> <br> <font color="#ff0000">xmlns:xsd</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Query</font> <font color="#0000ff">&gt;</font> omer <font color="#0000ff">&lt;/</font> <font color="#800000">Query</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Section</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> omer <font color="#0000ff">&lt;/</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> Hello, omer <font color="#0000ff">&lt;/</font> <font color="#800000">Description</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> blogs.microsoft.co.il/blogs/bursteg <font color="#0000ff">&lt;/</font> <font color="#800000">Url</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Image</font> <font color="#ff0000">source</font> <font color="#0000ff">="http://tinyurl.com/burstegprofileimage"</font> <br> <font color="#ff0000">height</font> <font color="#0000ff">="48"</font> <br> <font color="#ff0000">width</font> <font color="#0000ff">="48"</font> <br> <font color="#ff0000">alt</font> <font color="#0000ff">="Guy Burstein"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Item</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Section</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">SearchSuggestion</font> <font color="#0000ff">&gt;</font> <br></font></code> </blockquote><br><br><h3>  <strong>Adding a visual search in Internet Explorer</strong> </h3><br>  Add a new Xml file to the project and call it FriendsSuggestion.xml.  This file contains detailed information about the browser search plugin and should look like this: <br><blockquote> <code><a href=""></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">OpenSearchDescription</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://a9.com/-/spec/opensearch/1.1/"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ShortName</font> <font color="#0000ff">&gt;</font> Friends Search <font color="#0000ff">&lt;/</font> <font color="#800000">ShortName</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#ff0000">type</font> <font color="#0000ff">="text/html"</font> <br> <font color="#ff0000">template</font> <font color="#0000ff">="http://localhost:50434/TwitterFriendsSearch/ <br> SuggestService.svc/search?q={searchTerms}"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Url</font> <font color="#ff0000">type</font> <font color="#0000ff">="application/x-suggestions+xml"</font> <br> <font color="#ff0000">template</font> <font color="#0000ff">="http://localhost:50434/TwitterFriendsSearch/ <br> SuggestService.svc/search?q={searchTerms}"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Image</font> <font color="#ff0000">height</font> <font color="#0000ff">="16"</font> <br> <font color="#ff0000">width</font> <font color="#0000ff">="16"</font> <br> <font color="#ff0000">type</font> <font color="#0000ff">="image/icon"</font> <font color="#0000ff">&gt;</font> twitter.com/favicon.ico <font color="#0000ff">&lt;/</font> <font color="#800000">Image</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">OpenSearchDescription</font> <font color="#0000ff">&gt;</font> <br></font></code> </blockquote><br>  Add the Default.aspx page.  Create a JavaScript function in it that registers the plugin in the browser: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">type</font> <font color="#0000ff">="text/javascript"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">function</font> Register() { <br> window.external.AddSearchProvider( <font color="#A31515">'FriendsSuggestion.xml'</font> ); <br> } <br> <font color="#0000ff">&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <br></font></code> </blockquote><br>  Create an HTML button that will register the search plugin. <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">form</font> <font color="#ff0000">id</font> <font color="#0000ff">="form1"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">button</font> <font color="#ff0000">onclick</font> <font color="#0000ff">='Register();'</font> <font color="#0000ff">&gt;</font> Click Here <font color="#0000ff">&lt;/</font> <font color="#800000">button</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">form</font> <font color="#0000ff">&gt;</font> <br></font></code> </blockquote><br>  Run the project again, go to Default.aspx.  Click on the button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/51a/142/0ec/51a1420ec8989ad7bed42b1c476789c2.png"><br><br>  Now we go to the search field, try to write there the name of a friend.  At this stage, we will see only the default value, since we did not implement the search support on Twitter. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/012/80e/f51/01280ef513834851c69bebea950d2de7.png"><br><br><h3>  <strong>Find friends on Twitter</strong> </h3><br>  Finally, we got to implement the search for friends on Twitter, but this part of the code can be changed to suit your needs. <br>  In the implementation of the service, delete the default values ‚Äã‚Äãand make an HTTP request to Twitter to get a list of friends (replace ‚Äúbursteg‚Äù with your login) <br><blockquote> <code><font color="black"><font color="#0000ff">string</font> url = <font color="#0000ff">string</font> .Format( <br> <font color="#A31515">"http://twitter.com/statuses/friends/{0}.xml"</font> , <font color="#A31515">"bursteg"</font> ); <br> HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(url); <br> WebResponse response = request.GetResponse(); <br> StreamReader reader = <font color="#0000ff">new</font> StreamReader(response.GetResponseStream()); <br> <font color="#0000ff">string</font> responseString = reader.ReadToEnd(); <br> reader.Close(); <br></font></code> </blockquote><br>  Next, use Linq2Xml to parse the answer and get a list of friends, according to the search criteria: <br><blockquote> <code><font color="black"><font color="#2B91AF">XDocument</font> document = <font color="#2B91AF">XDocument</font> .Parse(response, LoadOptions.None); <br> <font color="#0000ff">var</font> query = <font color="#0000ff">from</font> e <font color="#0000ff">in</font> document.Root.Descendants( <font color="#A31515">"user"</font> ) <br> <font color="#0000ff">where</font> e.Element( <font color="#A31515">"name"</font> ).Value.Contains(friend) || <br> e.Element( <font color="#A31515">"screen_name"</font> ).Value.Contains(friend) <br> <font color="#0000ff">select</font> <font color="#0000ff">new</font> Item <br> { <br> <br> Text = e.Element( <font color="#A31515">"name"</font> ).Value, <br> Image = <font color="#0000ff">new</font> Image <br> { <br> Source = e.Element( <font color="#A31515">"profile_image_url"</font> ).Value, <br> Alt = e.Element( <font color="#A31515">"screen_name"</font> ).Value, <br> Width = 48, <br> Height = 48 <br> }, <br> Description = (e.Element( <font color="#A31515">"status"</font> ) == <font color="#0000ff">null</font> ? <font color="#A31515">""</font> : <br> HttpUtility.HtmlDecode(e.Element( <font color="#A31515">"status"</font> ).Element( <font color="#A31515">"text"</font> ).Value)), <br> Url = ( <font color="#2B91AF">String</font> .IsNullOrEmpty(e.Element( <font color="#A31515">"url"</font> ).Value) ? <br> <font color="#A31515">"http://twitter.com/home"</font> : <br> e.Element( <font color="#A31515">"url"</font> ).Value) <br> }; <br></font></code> </blockquote><br>  Finally, add these items to the search tip. <br><blockquote> <code><font color="black">suggestion.Section.AddRange(query);</font></code> </blockquote> <br>  The full version of the Search method should look like this: <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> SearchSuggestion Search( <font color="#0000ff">string</font> friend) <br> { <br> SearchSuggestion suggestion = <font color="#0000ff">new</font> SearchSuggestion(); <br> suggestion.Query = friend; <br> <br> <font color="#0000ff">string</font> url = <font color="#0000ff">string</font> .Format( <font color="#A31515">"http://twitter.com/statuses/friends/{0}.xml"</font> , <font color="#A31515">"bursteg"</font> ); <br> HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(url); <br> WebResponse response = request.GetResponse(); <br> StreamReader reader = <font color="#0000ff">new</font> StreamReader(response.GetResponseStream()); <br> <font color="#0000ff">string</font> responseString = reader.ReadToEnd(); <br> reader.Close(); <br> <br> <font color="#2B91AF">XDocument</font> document = <font color="#2B91AF">XDocument</font> .Parse(responseString, LoadOptions.None); <br> <font color="#0000ff">var</font> query = <font color="#0000ff">from</font> e <font color="#0000ff">in</font> document.Root.Descendants( <font color="#A31515">"user"</font> ) <br> <font color="#0000ff">where</font> e.Element( <font color="#A31515">"name"</font> ).Value.Contains(friend) || <br> e.Element( <font color="#A31515">"screen_name"</font> ).Value.Contains(friend) <br> <font color="#0000ff">select</font> <font color="#0000ff">new</font> Item <br> { <br> <br> Text = e.Element( <font color="#A31515">"name"</font> ).Value, <br> Image = <font color="#0000ff">new</font> Image <br> { <br> Source = e.Element( <font color="#A31515">"profile_image_url"</font> ).Value, <br> Alt = e.Element( <font color="#A31515">"screen_name"</font> ).Value, <br> Width = 48, <br> Height = 48 <br> }, <br> Description = (e.Element( <font color="#A31515">"status"</font> ) == <font color="#0000ff">null</font> ? <font color="#A31515">""</font> : <br> HttpUtility.HtmlDecode(e.Element( <font color="#A31515">"status"</font> ).Element( <font color="#A31515">"text"</font> ).Value)), <br> Url = ( <font color="#2B91AF">String</font> .IsNullOrEmpty(e.Element( <font color="#A31515">"url"</font> ).Value) ? <br> <font color="#A31515">"http://twitter.com/home"</font> : <br> e.Element( <font color="#A31515">"url"</font> ).Value) <br> }; <br> <br> suggestion.Section.AddRange(query); <br> <font color="#0000ff">return</font> suggestion; <br> }</font></code> </blockquote> <br>  Now when we are looking for a friend, we will see his name, avatar and current status in the search suggestions. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d2e/2df/b6f/d2e2dfb6f9b44b66778ae89e4f86e0e8.png"><br>  <a href="http://blogs.microsoft.co.il/files/folders/194097/download.aspx">Source code of the project.</a> <br></div><p>Source: <a href="https://habr.com/ru/post/68226/">https://habr.com/ru/post/68226/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../68219/index.html">Google Docs: Machine Text Translation</a></li>
<li><a href="../68220/index.html">drivovo - catalog of driving schools and driving instructors in Ukraine</a></li>
<li><a href="../68222/index.html">Medion Akoya Mini E1311 - German netbook on AMD Sempron</a></li>
<li><a href="../68224/index.html">‚ÄúPLAINtext podcast!‚Äù - BOT will help! (ubot.ru)</a></li>
<li><a href="../68225/index.html">Friday mix%)</a></li>
<li><a href="../68227/index.html">Sandcastle Help File Builder - generate documentation for .Net</a></li>
<li><a href="../68228/index.html">About God of War - ASUS Ares</a></li>
<li><a href="../68229/index.html">C ++ - like Latin</a></li>
<li><a href="../68230/index.html">Repair yourself</a></li>
<li><a href="../68231/index.html">Improving performance: how do I do the work that I do not want to do</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>