<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Route Me is an alternative to the integrated Google Maps control from iPhone SDK 3.0+</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I'm already tired of the limitations of the built-in card control, or rather, of fastening the crutches. Wait an example: Google Maps app knows how to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Route Me is an alternative to the integrated Google Maps control from iPhone SDK 3.0+</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/894/167/d30/894167d301b0618e175f878e1b5c3258.png" alt="image"><br><br>  I'm already tired of the limitations of the built-in card control, or rather, of fastening the crutches.  Wait an example: Google Maps app knows how to show a route, a control doesn't know how.  You have to draw on your own over the map. <br><br>  Now I have a specific task: I need to add a display of the route traveled and its export (share) to my modest <a href="http://itunes.apple.com/us/app/gps-speed/id344223674%3Fmt%3D8">GPS Speed</a> application, which, by the way, has been hanging in the Top 30 of the <a href="http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewTop%3FgenreId%3D6010%26id%3D25220%26popId%3D27">American App Store in the Navigation section for some time now</a> .  The reason for me remains a mystery, because the application is average and unique does not shine. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Returning to the problem.  <s>The necessary functionality has already been implemented</s> Almost working crutches for Google Maps have already been made, but this is a good chance to shed light on the Google Maps alternatives for the iPhone SDK. <br><a name="habracut"></a><br><h4>  Mat part </h4><br>  Even when there was no official card control, I worked with such ‚Äúsubstitutes‚Äù: <br><br><h5>  <a href="http://code.google.com/p/route-me/">Route Me:</a> </h5><ol><li>  BSD license (decide whether it is good or bad) </li><li>  support for many map sources: OpenStreetMap, Microsoft Virtual Earth, Cloud Made, Yahoo Maps and other less popular </li><li>  formed active developer community - <a href="http://groups.google.com/group/route-me-map">Google Group</a> </li></ol><br><h5>  <a href="http://developers.cloudmade.com/projects/show/iphone-api">Cloud Made:</a> </h5><ol><li>  part of a large project and has an official development team (I will take this opportunity and say hello to Dima;), because it potentially has greater integration with <a href="http://maps.cloudmade.com/">Cloud Made cards</a> </li><li>  has many themes (color sets) for cards </li><li>  used in the spring, it was still raw </li></ol><br>  I want to start a series of articles with something simple, for example, embed maps into an application and give the user the opportunity to choose the source of maps.  I prefer Route Me, because, apart from everything else, it can also show Cloud Made. <br><br><h4>  Training </h4><ol><li>  Open xCode and create a new project.  I chose the View-Based Application and called it RouteMeSourceSelection </li><li>  Download the latest <a href="http://code.google.com/p/route-me/downloads/list">version of Route Me</a> </li><li>  Install control step by step <a href="http://code.google.com/p/route-me/wiki/EmbeddingGuide">on this guide.</a> </li></ol><br>  After that you should have a compiled project.  If you have any problems, you can <a href="http://github.com/slatvick/Alterplay-iPhone-dev-tips/tree/gh-pages/RouteMeSourceSelection/">download the source code of this example</a> and compare. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/143/b62/eb5/143b62eb5ad791e0684964b3bc47dd76.png" alt="image"><br><br><h4>  Add control (code) </h4><br>  Open the UIViewController header (mine is called ‚ÄúRouteMeSourceSelectionViewController.h‚Äù) and: <br><ol><li>  #import "RMMapView.h" </li><li>  we add the RMMapViewDelegate protocol </li><li>  create an IBOutlet RMMapView * mapView; </li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/91e/9eb/d42/91e9ebd42623d09df690a287dc0a4529.png" alt="image"><br><br>  Override the "- (void) viewDidLoad" method: <br> <code>- (void)viewDidLoad { <br> [super viewDidLoad]; <br> <br> [RMMapView class]; // !     . . <br> [mapView setDelegate:self]; <br> }</code> <br> <br><h4>  Add control (design) </h4><br><ol><li>  Open the .xib file in Interface Builder (IB) </li><li>  Add a UIView (subview) to an existing one and define it as RMMapView </li><li>  We connect IBOutlet from our UIViewController with the newly created RMMapView </li></ol><br>  I understand that it is difficult to perceive such a text.  In short, it should look like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/af0/acf/731/af0acf731e1686961f5cce5687d41950.png" alt="image"><br><br>  Now, running the application, you should see a map with the default source - Open Street Maps.  I see this, I hope you too: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/851/8d5/84d/8518d584d4e0f044343406e6a16390e3.png" alt="image"></div><br>  It was all very easy.  Let's give the user the opportunity to choose the source of the map.  To do this, place the UIPickerView control and link it to our UIViewController. <br><br><h4>  UIPickerView to select the map source (code) </h4><br>  We open the controller's header and add two UIPickerViewDelegate and UIPickerViewDataSource protocols, and several IBOutlet: <br> <code>@interface RouteMeSourceSelectionViewController : UIViewController <br> &lt;RMMapViewDelegate, <br> UIPickerViewDelegate, UIPickerViewDataSource&gt; <br> { <br> IBOutlet RMMapView *mapView; <br> IBOutlet UIPickerView *mapSourcePicker; <br> IBOutlet UIBarButtonItem *mapSettingsBarButton; <br> } <br> <br> - (IBAction) showMapsSettings; <br> <br> @end</code> <br> <br>  Now we implement several required methods for UIPickerView.  This is simple, but will be useful for those who have not done it yet: <br><br> <code>static NSArray *titles = nil; <br> <br> - (NSString *)pickerView:(UIPickerView *)pickerView <br> titleForRow:(NSInteger)row <br> forComponent:(NSInteger)component <br> { <br> return [titles objectAtIndex:row]; <br> } <br> <br> - (NSInteger)pickerView:(UIPickerView *)pickerView <br> numberOfRowsInComponent:(NSInteger)component <br> { <br> if (!titles) <br> { <br> titles = [[NSArray alloc] initWithObjects: <br> @"Open Street Maps", <br> @"Yahoo Map", <br> @"Virtual Earth Aerial", <br> @"Virtual Earth Hybrid", <br> @"Virtual Earth Road", <br> @"Cloud Made Map", <br> nil]; <br> } <br> <br> return [titles count]; <br> } <br> <br> - (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView <br> { <br> return 1; <br> }</code> <br> <br>  Create a showMapsSettings method to show and hide UIPickerView, and also for a couple of UI tricks: <br><br> <code>- (IBAction) showMapsSettings <br> { <br> BOOL toShow = [mapSourcePicker isHidden]; <br> <br> if (toShow) <br> { <br> [mapSettingsBarButton setStyle:UIBarButtonItemStyleDone]; <br> } <br> else // hidding <br> { <br> [mapSettingsBarButton setStyle:UIBarButtonItemStyleBordered]; <br> [self setMapSourceWithNumber:[mapSourcePicker selectedRowInComponent:0]]; <br> } <br> <br> [mapSourcePicker setHidden:![mapSourcePicker isHidden]]; <br> [mapView setUserInteractionEnabled:[mapSourcePicker isHidden]]; <br> }</code> <br> <br>  And now the most important thing is the method for changing the source of the map.  If they were attentive, they saw that it was called in ‚ÄúshowMapsSettings‚Äù.  There is a small trick: the map is not updated automatically when you change the source, so you have to shift and return to the previous position.  It is invisible to the user.  At the very end, we save the selected source number to the general settings of the application. <br><br> <code>#import "RMVirtualEarthSource.h" <br> #import "RMYahooMapSource.h" <br> #import "RMCloudMadeMapSource.h" <br> #import "RMOpenStreetMapsSource.h" <br> <br> #define CONST_MAP_KEY_bing @"" <br> #define CONST_MAP_KEY_cloud @"" <br> <br> - (void) setMapSourceWithNumber:(int)number <br> { <br> if (mapSourceNumber == number) <br> return; <br> <br> switch (number) { <br> case 0: <br> mapView.contents.tileSource = [[RMOpenStreetMapsSource alloc] init]; <br> break; <br> case 1: <br> mapView.contents.tileSource = [[RMYahooMapSource alloc] init]; <br> break; <br> <br> case 2: <br> mapView.contents.tileSource = [[RMVirtualEarthSource alloc] initWithAerialThemeUsingAccessKey:CONST_MAP_KEY_bing]; <br> break; <br> case 3: <br> mapView.contents.tileSource = [[RMVirtualEarthSource alloc] initWithHybridThemeUsingAccessKey:CONST_MAP_KEY_bing]; <br> break; <br> case 4: <br> mapView.contents.tileSource = [[RMVirtualEarthSource alloc] initWithRoadThemeUsingAccessKey:CONST_MAP_KEY_bing]; <br> break; <br> <br> case 5: <br> mapView.contents.tileSource = [[RMCloudMadeMapSource alloc] initWithAccessKey:CONST_MAP_KEY_cloud styleNumber:1]; <br> break; <br> <br> default: <br> return; <br> break; <br> } <br> <br> // this trick refreshs maps with new source <br> [mapView moveBy:CGSizeMake(640,960)]; <br> [mapView moveBy:CGSizeMake(-640,-960)]; <br> <br> mapSourceNumber = number; <br> // remember user choice between runnings <br> [[NSUserDefaults standardUserDefaults] setInteger:mapSourceNumber forKey:@"mapSourceNumber"]; <br> }</code> <br> <br>  In order to make the Cloud Made and Virtual Earth (Bing) cards work, you need to get the ‚Äúdeveloper API key‚Äù: <br><ul><li>  <a href="http://cloudmade.com/user/show">http://cloudmade.com/user/show</a> </li><li>  <a href="http://www.bing.com/developers/appids.aspx">http://www.bing.com/developers/appids.aspx</a> </li></ul><br><br>  The last thing I would like to add is remembering the user's choice between the launches of our program.  Modify the "viewDidLoad" method: <br><br> <code>- (void)viewDidLoad { <br> [super viewDidLoad]; <br> <br> [RMMapView class]; <br> [mapView setDelegate:self]; <br> <br> int number = [[NSUserDefaults standardUserDefaults] integerForKey:@"mapSourceNumber"]; <br> [self setMapSourceWithNumber:number]; <br> [mapSourcePicker selectRow:mapSourceNumber inComponent:0 animated:NO]; <br> }</code> <br> <br><h4>  UIPickerView to select the source of the map (design) </h4><br>  Opening IB and: <ol><li>  add a UIToolbar with a single UIBarButtonItem button connected to its IBOutlet from the controller </li><li>  we connect event of clicking on UIBarButtonItem with showMapsSettings IBAction </li><li>  add a UIPickerView over the map and make it hidden (hidden) </li><li>  connect the UIPickerView with its IBOutlet and set its delegate and dataSource as ‚Äúfile's owner‚Äù </li></ol><br>  Again, the picture will replace a thousand words: <br><img src="https://habrastorage.org/getpro/habr/post_images/a14/389/9ea/a143899ea20cd11374c920be6204b407.png" alt="image"><br><br>  If everything is done correctly and neither I, nor you have forgotten anything, then you will see the working application: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Nj8DIgz4BgM%3Ffeature%3Doembed&amp;xid=25657,15700021,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhgXeMX-utZRdBg65O1TO4R1gw3D7Q" frameborder="0" allowfullscreen=""></iframe><br><br>  All that has been shown is used in a real application - <a href="http://itunes.apple.com/us/app/meeting-point/id315768974%3Fmt%3D8">Meeting Point, it is free, try it</a> . <br><br>  <a href="http://github.com/slatvick/Alterplay-iPhone-dev-tips/tree/gh-pages/RouteMeSourceSelection/">You can download the source here.</a> <br>  <a href="http://iphone-dev-tips.alterplay.com/2009/12/routeme-is-alternative-map-control-to.html">English version of the article from my tech blog</a> <br><br>  In the comments, suggest what to add and I will expand this detailed guide: <ul><li>  Determine the location of the user on the map and display on the map.  I will do it for sure, too simple. </li><li>  Geo search.  Don't know what it is yet, but it sounds cool </li><li>  Offer yours </li></ul></div><p>Source: <a href="https://habr.com/ru/post/79397/">https://habr.com/ru/post/79397/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79392/index.html">Intel announced another price cut</a></li>
<li><a href="../79393/index.html">I ask for help</a></li>
<li><a href="../79394/index.html">Extension cord in the socket</a></li>
<li><a href="../79395/index.html">Yota Egg: Vulnerability or feature?</a></li>
<li><a href="../79396/index.html">Additional characteristics of Tesla 20 video cards</a></li>
<li><a href="../79398/index.html">TinyMCE and Opera 10.50</a></li>
<li><a href="../79399/index.html">Embedding semantic data in HTML</a></li>
<li><a href="../79400/index.html">How to achieve a professional look with color</a></li>
<li><a href="../79405/index.html">Several events in the Delphi-blogosphere</a></li>
<li><a href="../79406/index.html">PastryKit: Apple‚Äôs iPhone Website Development Tool</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>