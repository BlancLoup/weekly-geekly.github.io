<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Object to iterate, iterator and generator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear readers Habrahabra. In this article we will try to figure out what an iterable object is, an iterator and a generator. Consider how they a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Object to iterate, iterator and generator</h1><div class="post__text post__text-html js-mediator-article">  Hello, dear readers Habrahabra.  In this article we will try to figure out what an iterable object is, an iterator and a generator.  Consider how they are implemented and used.  The examples are written in Python, but the iterators and generators, in my opinion, are fundamental concepts that were relevant 20 years ago and are even more relevant now, while at the same time they have not actually changed. <br><br><img src="https://habrastorage.org/web/d44/fdc/2b7/d44fdc2b7d1b4ac99c2ca757c97eddb5.gif"><br><a name="habracut"></a><br><h2>  Iterators </h2><br>  To begin, recall what the Iterator pattern is. <br>  Purpose: <br><br><ul><li>  to access the contents of the aggregated objects without disclosing their internal representation; </li><li>  to support multiple active traversals of the same aggregated object (preferably, but not necessarily); </li><li>  to provide a uniform interface to bypass various aggregated structures. </li></ul><br>  As a result, we get a division of responsibility: customers get the opportunity to work with different collections in a unified way, and the collections become easier due to the fact that they delegate the enumeration of their elements to another entity. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are two types of iterators, <i>external</i> and <i>internal</i> . <br>  <i>An external iterator</i> is a classic (pull-based) iterator, when the crawl process is explicitly controlled by the client by calling the Next method. <br>  <i>The internal iterator</i> is the push-based iterator to which the callback function is passed, and it itself notifies the client of the receipt of the next element. <br><br>  The classic diagram of the ‚ÄúIterator‚Äù pattern, as described in a not-so-well-known book of the ‚Äúgang of four‚Äù: <br><img src="https://habrastorage.org/getpro/habr/post_images/7a1/e92/c3d/7a1e92c3d6fbd859de3d9e967d4f8a74.gif" alt="image"><br><br>  <i>Aggregate</i> is a compound object that an iterator can navigate; <br>  <i>Iterator</i> - defines an iterator interface; <br>  <i>ConcreteAggregate</i> - specific implementation of the unit; <br>  <i>ConcreteIterator</i> - a specific implementation of an iterator for a specific aggregate; <br>  <i>Client</i> - uses an Aggregate object and an iterator to bypass it. <br><br><h3>  We try to implement a classic iterator in Python </h3><br>  Abstract classes: <br><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Aggregate</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(abc.ABC)</span></span></span><span class="hljs-class">:</span></span> @abc.abstractmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">iterator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""   """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Iterator</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(abc.ABC)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, collection, cursor)</span></span></span><span class="hljs-function">:</span></span> self._collection = collection self._cursor = cursor @abc.abstractmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">first</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""     .    reset """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> @abc.abstractmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""     .   StopIteration,    . """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> @abc.abstractmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">current</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre> <br>  Specific iterator implementation for the list: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListIterator</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Iterator)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, collection, cursor)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" :param collection:  :param cursor:      .      -1 &gt;= cursor &lt; len(collection) """</span></span> super().__init__(collection, cursor) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">first</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    -1.         next     1. """</span></span> self._cursor = <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      ,   StopIteration,     1 """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self._cursor + <span class="hljs-number"><span class="hljs-number">1</span></span> &gt;= len(self._collection): <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> StopIteration() self._cursor += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">current</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._collection[self._cursor]</code> </pre><br>  Concrete implementation of the unit: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListCollection</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Aggregate)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, collection)</span></span></span><span class="hljs-function">:</span></span> self._collection = list(collection) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">iterator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ListIterator(self._collection, <span class="hljs-number"><span class="hljs-number">-1</span></span>)</code> </pre><br>  Now we can create a collection object and bypass all its elements using an iterator: <br><br><pre> <code class="python hljs">collection = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>) aggregate = ListCollection(collection) itr = aggregate.iterator() <span class="hljs-comment"><span class="hljs-comment">#   while True: try: itr.next() except StopIteration: break print(itr.current())</span></span></code> </pre><br>  And since we implemented the first method, which resets the iterator to the initial state, we can use the same iterator again: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      itr.first() while True: try: itr.next() except StopIteration: break print(itr.current())</span></span></code> </pre><br>  Implementations can be different, but the basic idea is that an iterator can bypass various structures, vectors, trees, hash tables, and much more, while having the same interface from the outside. <br><br><h3>  Python iteration protocol </h3><br>  In the book of the "gang of four" about the implementation of the iterator is written: <br><br>  <i>The iterator class minimum interface consists of the First, Next, IsDone, and CurrentItem operations.</i>  <s>But if you really want, then</s> <i>this interface can be simplified by combining operations Next, IsDone and CurrentItem into one, which will go to the next object and return it.</i>  <i>If the traversal is completed, then this operation will return a special value (for example, 0) indicating the end of the iteration.</i> <br><br>  This is exactly how it is implemented in Python, but instead of a special meaning, StopIteration tells about the end of the iteration.  <i>It's easier to ask for forgiveness than permission.</i> <br><br>  First, it is important to define the terms. <br><br>  Consider the <i>object to be iterated</i> .  In the standard library, it is declared as an abstract class collections.abc.Iterable: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Iterable</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(metaclass=ABCMeta)</span></span></span><span class="hljs-class">:</span></span> __slots__ = () @abstractmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__iter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> @classmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__subclasshook__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, C)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cls <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Iterable: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _check_methods(C, <span class="hljs-string"><span class="hljs-string">"__iter__"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NotImplemented</span></span></code> </pre><br>  It has an abstract __iter__ method that should return an iterator object.  And the __subclasshook__ method that checks if the class has a __iter__ method.  Thus, it turns out that the <i>object</i> being <i>iterated</i> is any object that implements the __iter__ method. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeIterable1</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(collections.abc.Iterable)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__iter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeIterable2</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__iter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> print(isinstance(SomeIterable1(), collections.abc.Iterable)) <span class="hljs-comment"><span class="hljs-comment"># True print(isinstance(SomeIterable2(), collections.abc.Iterable)) # True</span></span></code> </pre><br>  But there is one thing, this is the iter () function.  This function uses, for example, a for loop to get an iterator.  The iter () function, primarily to get an iterator from an object, calls its __iter__ method.  If the method is not implemented, it checks the presence of the __getitem__ method, and if it is implemented, an iterator is created based on it.  __getitem__ should take an index from scratch.  If none of these methods are implemented, then a TypeError exception will be thrown. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> string <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ascii_letters <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeIterable3</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__getitem__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, key)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ascii_letters[key] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> SomeIterable3(): print(item)</code> </pre><br>  Total, an <b>iterated object</b> is any object from which the built-in function iter () can get an iterator.  Sequences (abc.Sequence) are always iterable, because they implement the __getitem__ method <br><br>  Now let's see what happens with the iterators in Python.  They are represented by the abstract collections.abc.Iterator class: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Iterator</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Iterable)</span></span></span><span class="hljs-class">:</span></span> __slots__ = () @abstractmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__next__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">'Return the next item from the iterator. When exhausted, raise StopIteration'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> StopIteration <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__iter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self @classmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__subclasshook__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, C)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cls <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Iterator: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _check_methods(C, <span class="hljs-string"><span class="hljs-string">'__iter__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__next__'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NotImplemented</span></span></code> </pre><br>  <i>__next__</i> Returns the next available element and causes a StopIteration exception when there are no elements left. <br>  <i>__iter__</i> Returns self.  This allows you to use an iterator where an iterative object is expected, for example, for. <br>  <i>__subclasshook__</i> Checks if the class has a __iter__ and __next__ method <br><br>  So, an <b>iterator in python</b> is any object that implements the __next__ method with no arguments, which should return the next element or StopIteration error.  It also implements the __iter__ method and therefore is itself an <i>iterable object</i> . <br><br>  Thus, it is possible to implement an iterable object based on a list and its iterator: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListIterator</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(collections.abc.Iterator)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, collection, cursor)</span></span></span><span class="hljs-function">:</span></span> self._collection = collection self._cursor = cursor <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__next__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self._cursor + <span class="hljs-number"><span class="hljs-number">1</span></span> &gt;= len(self._collection): <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> StopIteration() self._cursor += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._collection[self._cursor] <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListCollection</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(collections.abc.Iterable)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, collection)</span></span></span><span class="hljs-function">:</span></span> self._collection = collection <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__iter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ListIterator(self._collection, <span class="hljs-number"><span class="hljs-number">-1</span></span>)</code> </pre><br>  Variants of work: <br><br><pre> <code class="python hljs">collection = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>] aggregate = ListCollection(collection) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> aggregate: print(item) print(<span class="hljs-string"><span class="hljs-string">"*"</span></span> * <span class="hljs-number"><span class="hljs-number">50</span></span>) itr = iter(aggregate) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: print(next(itr)) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> StopIteration: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre><br>  The next () function calls the __next__ method.  It can pass the second argument that it will return at the end of the iteration instead of the StopIteration error. <br><br><pre> <code class="python hljs">itr = iter(aggregate) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: item = next(itr, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> print(item)</code> </pre><br>  Before proceeding to the generators, consider another feature of the built-in function <i>iter ()</i> .  You can call it with two arguments, which allows you to create an iterator from the <i>called object</i> (a function or class with the implemented __call__ method).  The first argument must be a callable object, and the second is a kind of delimiter.  The called object is called at each iteration and the iteration is completed when StopIteration exception is raised or the limiter value is returned. <br><br>  For example, from a function that randomly returns 1-6, an iterator can be made that will return values ‚Äã‚Äãuntil it ‚Äúdrops out‚Äù 6: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> randint <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d6</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> randint(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> roll <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> iter(d6, <span class="hljs-number"><span class="hljs-number">6</span></span>): print(roll)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Other examples</b> <div class="spoiler_text">  The small class ProgrammingLanguages, which has a tuple with programming languages, the constructor takes the initial values ‚Äã‚Äãof the index by the name of the language and the function __call__ which iterates over the tuple. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProgrammingLanguages</span></span></span><span class="hljs-class">:</span></span> _name = (<span class="hljs-string"><span class="hljs-string">"Python"</span></span>, <span class="hljs-string"><span class="hljs-string">"Golang"</span></span>, <span class="hljs-string"><span class="hljs-string">"C#"</span></span>, <span class="hljs-string"><span class="hljs-string">"C"</span></span>, <span class="hljs-string"><span class="hljs-string">"C++"</span></span>, <span class="hljs-string"><span class="hljs-string">"Java"</span></span>, <span class="hljs-string"><span class="hljs-string">"SQL"</span></span>, <span class="hljs-string"><span class="hljs-string">"JS"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, first=None)</span></span></span><span class="hljs-function">:</span></span> self.index = (<span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> first <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> ProgrammingLanguages._name.index(first) - <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.index += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.index &lt; len(ProgrammingLanguages._name): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ProgrammingLanguages._name[self.index] <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> StopIteration</code> </pre><br>  We can iterate through all languages ‚Äã‚Äãstarting with C # and to the last: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> lang <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> iter(ProgrammingLanguages(<span class="hljs-string"><span class="hljs-string">"C#"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): print(lang)</code> </pre><br>  C first to C: <br><br><pre> <code class="python hljs">pl = ProgrammingLanguages() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> lang <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> iter(pl, <span class="hljs-string"><span class="hljs-string">"C"</span></span>): print(lang)</code> </pre><br>  One more example: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      with open('mydata.txt') as fp: for line in iter(fp.readline, ''): print(line)</span></span></code> </pre><br></div></div><br><h2>  Generators </h2><br>  From the point of view of implementation, a generator in Python is a language construct that can be implemented in two ways: as a function with the <i>yield</i> keyword or as a generator expression.  As a result of calling a function or evaluating an expression, we get the generator object of the types type.  <i>GeneratorType</i> . <br><br>  In the generator object, the methods __next__ and __iter__ are defined, that is, the iterator protocol is implemented, from this point of view, in Python any generator is an iterator. <br>  Conceptually, an iterator is a mechanism for crawling data by element, and the generator allows you to postpone creating a result during iteration.  A generator can create a result based on an algorithm or take elements from a data source (collection, files, network connections, etc.) and modify them. <br><br>  A vivid example is the range and enumerate functions: <br><br>  <i>range</i> generates a limited arithmetic progression of integers without using any data source. <br>  <i>enumerate</i> generates two-element tuples with an index and one element from the object being iterated. <br><br><h3>  Yield </h3><br>  To begin with, we will write a simple generator without using a generator object.  This is the Fibonacci number generator: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FibonacciGenerator</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.prev = <span class="hljs-number"><span class="hljs-number">0</span></span> self.cur = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__next__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> result = self.prev self.prev, self.cur = self.cur, self.prev + self.cur <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__iter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> FibonacciGenerator(): print(i) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre><br>  But using the <i>yield</i> keyword, you can greatly simplify the implementation: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fibonacci</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> prev, cur = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> prev prev, cur = cur, prev + cur <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> fibonacci(): print(i) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre><br>  Any function in Python that has the <i>yield</i> keyword in its body is called a <i>generator function</i> ‚Äî it returns <i>a generator object</i> when called. <br>  <i>The generator object</i> implements the iterator interface; accordingly, this object can be operated as with any other <i>iterated object</i> . <br><br><pre> <code class="python hljs">fib = fibonacci() print(next(fib)) <span class="hljs-comment"><span class="hljs-comment"># 0 print(next(fib)) # 1 for num, fib in enumerate(fibonacci()): print('{0}: {1}'.format(num, fib)) if num &gt; 9: break # 0: 0 # 1: 1 # 2: 1 ...</span></span></code> </pre><br>  Consider the work yield: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gen_fun</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">'block 1'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> print(<span class="hljs-string"><span class="hljs-string">'block 2'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> print(<span class="hljs-string"><span class="hljs-string">'end'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> gen_fun(): print(i) <span class="hljs-comment"><span class="hljs-comment"># block 1 # 1 # block 2 # 2 # end</span></span></code> </pre><br><ol><li>  when the gen_fun function is called, <i>a generator object</i> is created </li><li>  for calls iter () with this object and gets an iterator of this generator. </li><li>  in the loop, it calls the next () function with this iterator until a StopIteration exception is received </li><li>  at each next call, the execution in the function starts from the place where it was completed the last time and continues until the next <i>yield</i> </li></ol><br>  <u>Approximately the</u> following occurs.  The generator function is divided into parts: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gen_fun_1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">'block 1'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gen_fun_2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">'block 2'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gen_fun_3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">'end'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gen_fun_end</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> StopIteration</code> </pre><br>  A state machine is created in which every time you call __next__, the state changes and, depending on it, this or that piece of code is called.  If, in a function, yield in a cycle, then the state machine state accordingly loops until the condition is met. <br><br>  Own option range: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cool_range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(start, stop, inc)</span></span></span><span class="hljs-function">:</span></span> x = start <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> x &lt; stop: <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> x x += inc <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cool_range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>): print(n) <span class="hljs-comment"><span class="hljs-comment"># 1 # 1.5 # ... # 4.5 print(list(cool_range(0, 2, 0.5))) # [0, 0.5, 1.0, 1.5]</span></span></code> </pre><br><h3>  Generator expression </h3><br>  In short, a syntactically shorter way to create a generator without defining or calling a function.  And since this expression, then it has a number of limitations.  Basically, it is convenient to use for generating collections, their simple transformations and applying conditions to them. <br><br>  In programming languages, there are such things as <i>lazy / lazy evaluation</i> and <i>eager / greedy evaluation</i> .  Generators can be considered a deferred calculation, in this sense, the list inclusion (list comprehension) is very similar to the generator expression, but they are different approaches. <br><br><pre> <code class="python hljs">(i <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10000000</span></span>)) [i <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10000000</span></span>)]</code> </pre><br>  The first option works in a manner similar to our cool_range function and can generate any range without problems.  But the second option will create a whole list at once, with all the problems arising from it. <br><br><h3>  Yield from </h3><br>  To circumvent restricted nested structures, the traditional approach is to use nested loops.  The same approach can be used when the generator function must give values ‚Äã‚Äãgenerated by another generator. <br><br>  Function similar to itertools.chain: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*iterables)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> it <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> iterables: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> it: <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> i g = chain([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>], {<span class="hljs-string"><span class="hljs-string">'A'</span></span>, <span class="hljs-string"><span class="hljs-string">'B'</span></span>, <span class="hljs-string"><span class="hljs-string">'C'</span></span>}, <span class="hljs-string"><span class="hljs-string">'...'</span></span>) print(list(g)) <span class="hljs-comment"><span class="hljs-comment"># [1, 2, 3, 'A', 'B', 'C', '.', '.', '.']</span></span></code> </pre><br>  But nested loops can be removed by adding the yield from construct: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*iterables)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> it <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> iterables: <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> it g = chain([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>], {<span class="hljs-string"><span class="hljs-string">'A'</span></span>, <span class="hljs-string"><span class="hljs-string">'B'</span></span>, <span class="hljs-string"><span class="hljs-string">'C'</span></span>}, <span class="hljs-string"><span class="hljs-string">'...'</span></span>) print(list(g)) <span class="hljs-comment"><span class="hljs-comment"># [1, 2, 3, 'A', 'B', 'C', '.', '.', '.']</span></span></code> </pre><br>  The main benefit is the yield from creating a direct channel between the internal generator and the customer of the external generator.  But this is more about <i>coroutines</i> , which deserve a separate article.  You can also discuss generator methods here: close (), throw () and send (). <br><br>  And finally, another example.  The function accepts an object to be iterated, with any level of nesting by other objects to be iterated, and forming a flat sequence: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Iterable <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">flatten</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(items, ignore_types=</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(str, bytes)</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" str, bytes -   ,      """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> items: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> isinstance(x, Iterable) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> isinstance(x, ignore_types): <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flatten(x) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> x items = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, [<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>], <span class="hljs-number"><span class="hljs-number">7</span></span>], <span class="hljs-number"><span class="hljs-number">8</span></span>, (<span class="hljs-string"><span class="hljs-string">'A'</span></span>, {<span class="hljs-string"><span class="hljs-string">'B'</span></span>, <span class="hljs-string"><span class="hljs-string">'C'</span></span>})] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> flatten(items): print(x) <span class="hljs-comment"><span class="hljs-comment"># 1 # 2 # 3 # 4 # 5 # 6 # 7 # 8 # A # C # B</span></span></code> </pre><br>  That's all for today.  Thank! </div><p>Source: <a href="https://habr.com/ru/post/337314/">https://habr.com/ru/post/337314/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337304/index.html">Ransomware hackers hacked more than 26,000 MongoDB servers</a></li>
<li><a href="../337306/index.html">Docker Basics in X hours and Y days</a></li>
<li><a href="../337308/index.html">Lannisters always pay their debts! (and technical too)</a></li>
<li><a href="../337310/index.html">Mathematical modeling of traffic flows</a></li>
<li><a href="../337312/index.html">11 free cyrillic fonts</a></li>
<li><a href="../337316/index.html">Accidental deletion of root files</a></li>
<li><a href="../337318/index.html">Our way to the green cart</a></li>
<li><a href="../337320/index.html">Dagger2 and architectural component "ViewModel"</a></li>
<li><a href="../337324/index.html">FullStack 2017 in London: details</a></li>
<li><a href="../337328/index.html">How we taught the Yandex.Taxi application to predict a destination</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>