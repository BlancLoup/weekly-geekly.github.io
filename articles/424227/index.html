<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Evenly distribute points over a sphere in pytorch and tensorflow</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This text is written for those who are interested in deep learning, who want to use the different methods of the pytorch and tensorflow libraries to m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Evenly distribute points over a sphere in pytorch and tensorflow</h1><div class="post__text post__text-html js-mediator-article"><p>  This text is written for those who are interested in deep learning, who want to use the different methods of the pytorch and tensorflow libraries to minimize the function of many variables, who are interested in learning how to turn a sequentially running program into numpy vectorized matrix calculations.  And you can also learn how to make a cartoon of the data rendered using PovRay and vapory. </p><br><p><img src="https://habrastorage.org/webt/kz/fa/h2/kzfah2g6zgoehvsimumi8hy9nie.jpeg"></p><a name="habracut"></a><br><h3 id="otkuda-zadacha">  Whence the task </h3><br><blockquote>  Everyone minimizes their functionality (c) Anonymous data scientist </blockquote><p>  In <a href="https://habr.com/company/hh/blog/415437/">one of the previous publications of our blog</a> , namely in the item "Rake No. 6", it was told about the DSSM technology, which allows you to convert text into vectors.  To find such a mapping, we need to find the coefficients of linear transformations that minimize the rather complicated loss function.  Understanding what happens when learning such a model is difficult because of the large dimension of the vectors.  To develop an intuition that allows you to choose the right optimization method and set the parameters of this method, you can consider a simplified version of this task.  Now let the vectors be in our usual three-dimensional space, then they are easy to draw.  And the loss function will be the potential for repulsing points from each other and attraction to the unit sphere.  In this case, the solution of the problem will be the uniform distribution of points on the sphere.  The quality of the current solution is easy to assess by eye. </p><br><p>  So, we will look for a <a href="http://mathworld.wolfram.com/SpherePointPicking.html" title="Definition at mathworld">uniform distribution over a sphere of a</a> given amount. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> n </script>  points.  <a href="https://en.wikibooks.org/wiki/Mathematica/Uniform_Spherical_Distribution" title="Wikibooks">Such a distribution</a> is necessary acoustics in order to understand in which direction to launch a wave in a crystal.  To the communications operator - to learn how to place satellites in orbit to achieve the best quality of communication.  Meteorologist - to accommodate weather monitoring stations. </p><br><p>  For some <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> n </script>  The problem <a href="https://stackoverflow.com/questions/14805583/dispersing-n-points-uniformly-on-a-sphere" title="The answer to the glass flow with platonic bodies">is solved easily</a> .  For example, if <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>=</mo><mn>8</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.656ex" height="1.937ex" viewBox="0 -728.2 2435.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-38" x="1934" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mn>8</mn></math></span></span><script type="math/tex" id="MathJax-Element-3"> n = 8 </script>  , we can take a cube and its vertices will be the answer to the problem.  Also we are lucky if <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> n </script>  will be equal to the number of vertices of the icosahedron, dodecahedron, or other Plato body.  Otherwise, the task is not so simple. </p><br><p>  For a sufficiently large number of points there is a <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3079956/" title="discrete spiral math">formula with empirically selected coefficients</a> , a few more options - <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3079956/" title="Once again about the spiral">here</a> , <a href="http://corysimon.github.io/articles/uniformdistn-on-sphere/" title="irregularity correction">here</a> , <a href="https://en.wikibooks.org/wiki/Mathematica/Uniform_Spherical_Distribution" title="On the website of the mathematics program">here</a> , and <a href="https://www.fundamental-research.ru/ru/article/view%3Fid%3D31243" title="basic research">here</a> .  But there is a more universal, albeit a more complex <a href="https://ru.stackoverflow.com/questions/205487/%25D0%25A0%25D0%25B0%25D0%25B2%25D0%25BD%25D0%25BE%25D0%25BC%25D0%25B5%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B5-%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5-%25D1%2582%25D0%25BE%25D1%2587%25D0%25B5%25D0%25BA-%25D0%25BD%25D0%25B0-%25D1%2581%25D1%2584%25D0%25B5%25D1%2580%25D0%25B5" title="Russian stakerflow">solution</a> , to which this article is devoted. </p><br><p>  We solve a problem that is very similar to <a href="http://www.etudes.ru/ru/etudes/thomson-problem/" title="Thomson's task on the etudes">the Thomson problem</a> ( <a href="https://en.wikipedia.org/wiki/Thomson_problem" title="Thomson's task on wikipedia">wiki</a> ).  Scatter <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> n </script>  points by chance, and then force them to attract some kind of surface, for example, to a sphere, and repel each other.  Attraction and repulsion are determined by the function - potential.  At the minimum value of the potential function, the points will lie on the sphere most evenly. </p><br><p>  This task is very similar to the learning process of machine learning (ML) models, in which the loss function is minimized.  But a data scientist usually looks at how a single number decreases, and we can watch the change in the picture.  If everything works out for us, we will see how the points randomly placed inside the cube with side 1 will disperse over the surface of the sphere: </p><br><p><img src="https://habrastorage.org/webt/52/sl/vj/52slvj5tsk6xdd-d1ymry_lty1i.png"></p><br><p>  Schematically, the algorithm for solving the problem can be represented as follows.  Each point located in three-dimensional space corresponds to a row of matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-58" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> X </script>  .  The loss function is calculated using this matrix. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-4C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> L </script> whose minimum value corresponds to a uniform distribution of points on the sphere.  The minimum value is found using the <code>pytorch</code> and <code>tensorflow</code> , which allow to calculate the loss function gradient over the matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-58" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> X </script>  and go down to the minimum using one of the methods implemented in the library: SGD, ADAM, ADAGRAD, etc. </p><br><p><img src="https://habrastorage.org/webt/aq/ol/q_/aqolq_qbiybgyykwurj9dzap1nw.png"></p><br><h3 id="schitaem-potencial">  We consider the potential </h3><br><p>  Due to its simplicity, expressiveness and ability to serve as an interface to libraries written in other languages, Python is widely used to solve machine learning problems.  Therefore, the code examples in this article are written in Python.  To perform fast matrix calculations, we will use the numpy library.  To minimize the function of many variables - pytorch and tensorflow. </p><br><p>  Randomly scatter points in a cube with side 1. Let us have 500 points, and elastic interaction is 1000 times more significant than electrostatic: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np n = <span class="hljs-number"><span class="hljs-number">500</span></span> k = <span class="hljs-number"><span class="hljs-number">1000</span></span> X = np.random.rand(n, <span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br><p>  This code generated a matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-58" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> X </script>  by size <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>3</mn><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>s</mi><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.994ex" height="1.937ex" viewBox="0 -728.2 3872.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-33" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6D" x="1457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="2336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-73" x="2802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="3272" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn><mtext>&nbsp;</mtext><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>s</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> 3 \ times n </script>  filled with random numbers from 0 to 1: </p><br><p><img src="https://habrastorage.org/webt/vn/vf/s-/vnvfs-cf0qee5vhmzn3vwidsn64.png"></p><br><p>  We assume that each row of this matrix corresponds to one point.  And in three columns recorded coordinates <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.641ex" height="1.817ex" viewBox="0 -520.7 2428.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2C" x="572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-79" x="1017" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2C" x="1515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-7A" x="1960" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> x, y, z </script>  all our points. </p><br><p>  Potential of elastic interaction of a point with the surface of a single sphere <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>u</mi><mn>1</mn></msub><mo>=</mo><mi>k</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>r</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.704ex" height="2.901ex" viewBox="0 -935.7 9344.8 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="1304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6B" x="2360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="3131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-64" x="3565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6F" x="4088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="4574" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-28" x="4935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="5325" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2212" x="6048" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="7048" y="0"></use><g transform="translate(7500,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-32" x="550" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2F" x="8343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-32" x="8844" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mn>1</mn></msub><mo>=</mo><mi>k</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><mi>r</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-12"> u_1 = k \ cdot (1 - r) ^ 2/2 </script>  .  Potential electrostatic interaction points <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.817ex" viewBox="-38.5 -520.7 542 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> p </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.07ex" height="1.817ex" viewBox="0 -520.7 460.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> q </script>  - <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>u</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>r</mi><mi>p</mi></msub><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>q</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.086ex" height="2.78ex" viewBox="0 -832 6926.1 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-32" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="1304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="2360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2F" x="2860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-7C" x="3361" y="0"></use><g transform="translate(3639,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2212" x="4769" y="0"></use><g transform="translate(5770,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-7C" x="6647" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>u</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>r</mi><mi>p</mi></msub><mo>‚àí</mo><msub><mi>r</mi><mi>q</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-15"> u_2 = 1 / | r_p - r_q | </script>  .  The full potential consists of the electrostatic interaction of all pairs of points and the elastic interaction of each point with the surface of the sphere: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>U</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><msubsup><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msubsup><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><msubsup><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>q</mi><mo>=</mo><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msubsup><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>p</mi></msub></mrow><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>q</mi></msub></mrow><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow><mo>+</mo><mi>k</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><msubsup><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>p</mi></msub></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>i</mi><mi>n</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="147.119ex" height="3.503ex" viewBox="0 -987.6 63342.8 1508.3" role="img" focusable="false" style="vertical-align: -1.209ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-55" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-28" x="767" y="0"></use><g transform="translate(1157,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2C" x="2183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2E" x="2628" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2E" x="3073" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2E" x="3518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2C" x="3964" y="0"></use><g transform="translate(4409,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-29" x="5506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="6173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-73" x="7479" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-75" x="7949" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6D" x="8521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6C" x="9650" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="9948" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6D" x="10294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="11172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="11518" y="0"></use><g transform="translate(11879,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="1379" y="0"></use></g><g transform="translate(469,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="503" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="1282" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-73" x="14028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-75" x="14497" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6D" x="15070" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6C" x="16198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="16497" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6D" x="16842" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="17721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="18066" y="0"></use><g transform="translate(18428,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="663" y="499"></use><g transform="translate(469,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="460" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="1239" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2B" x="1742" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="2521" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-66" x="21384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="21934" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-61" x="22386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="22915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="23349" y="0"></use><g transform="translate(23849,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-66" x="1015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="1565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-7C" x="1927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="2455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="2941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="3407" y="0"></use><g transform="translate(3841,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2212" x="5091" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="6342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="6827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="7294" y="0"></use><g transform="translate(7727,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="8976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="9427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-67" x="9773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-68" x="10253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="10830" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-7C" x="11191" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2B" x="35542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6B" x="36542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="37314" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-64" x="37747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6F" x="38271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="38756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-73" x="39368" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-75" x="39837" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6D" x="40410" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6C" x="41538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="41837" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6D" x="42182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="43061" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="43406" y="0"></use><g transform="translate(43768,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="663" y="499"></use><g transform="translate(469,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="503" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="1282" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6C" x="45848" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="46146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-66" x="46613" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="47163" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-28" x="47525" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="47914" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2212" x="48637" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-7C" x="49638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="50166" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="50652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="51118" y="0"></use><g transform="translate(51552,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-7C" x="52580" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="53109" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="53560" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-67" x="53906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-68" x="54386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="54963" y="0"></use><g transform="translate(55324,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="56418" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="56869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-67" x="57215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-68" x="57695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="58272" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-61" x="58633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="59163" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="59614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6F" x="60066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-77" x="60551" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6D" x="61518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="62396" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="62742" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>U</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mtext>&nbsp;</mtext><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><msubsup><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mtext>&nbsp;</mtext><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><msubsup><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>q</mi><mo>=</mo><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msubsup><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>p</mi></msub></mrow><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>q</mi></msub></mrow><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mo>+</mo><mi>k</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><mi>m</mi><mtext>&nbsp;</mtext><mi>l</mi><mi>i</mi><mi>m</mi><mi>i</mi><mi>t</mi><msubsup><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mtext>&nbsp;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>x</mi><mi>p</mi></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>w</mi><mtext>&nbsp;</mtext><mi>m</mi><mi>i</mi><mi>n</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> U (x_1, ..., x_n) = \ sum \ limits _ {p = 1} ^ {n - 1} \ sum \ limits _ {q = p + 1} ^ {n} \ frac 1 {\ left | \ vec {x_p} - \ vec {x_q} \ right | } + k \ cdot \ sum \ limits _ {p = 1} ^ n \ left (1 - | \ vec {x_p} | \ right) ^ 2 \ rightarrow \ min </script></p><br><p>  In principle, one can calculate the value of the potential using this formula: </p><br><pre> <code class="python hljs">L_for = <span class="hljs-number"><span class="hljs-number">0</span></span> L_for_inv = <span class="hljs-number"><span class="hljs-number">0</span></span> L_for_sq = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(n): p_distance = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">3</span></span>): p_distance += x[p, i]**<span class="hljs-number"><span class="hljs-number">2</span></span> p_distance = math.sqrt(p_distance) L_for_sq += k * (<span class="hljs-number"><span class="hljs-number">1</span></span> - p_distance)**<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-comment"><span class="hljs-comment">#     ,     for q in range(p + 1, n): if q != p: pq_distance = 0 for i in range(3): pq_distance += (x[p, i] - x[q, i]) ** 2 pq_distance = math.sqrt(pq_distance) L_for_inv += 1 / pq_distance #      L_for = (L_for_inv + L_for_sq) / n print('loss =', L_for)</span></span></code> </pre> <br><p>  But there is a little trouble.  For a measly 2000 points, this program will run for 2 seconds.  It will be much faster if we calculate this value using vectorized matrix calculations.  Acceleration is achieved both through the implementation of matrix operations using the ‚Äúfast‚Äù languages ‚Äã‚Äãof fortran and C, and through the use of vectorized processor operations, which allow performing an action on a large amount of input data in one clock cycle. </p><br><p>  Look at the matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mo>=</mo><mi>X</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><msup><mi>X</mi><mi>T</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.734ex" height="2.419ex" viewBox="0 -935.7 6344 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-58" x="1979" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="3082" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-64" x="3515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6F" x="4039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="4524" y="0"></use><g transform="translate(4886,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-54" x="1215" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo>=</mo><mi>X</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><msup><mi>X</mi><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-17"> S = X \ cdot X ^ T </script>  .  It has many interesting properties and is often found in calculations related to the theory of linear classifiers in ML.  So, if we assume that in the row of the matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>X</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.057ex" viewBox="0 -780.1 852.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-58" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-18"> X </script>  with indexes <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="1.817ex" viewBox="-38.5 -520.7 542 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-19"> p </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.07ex" height="1.817ex" viewBox="0 -520.7 460.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-20"> q </script>  three-dimensional space vectors are written <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>p</mi></msub></mrow><mo>,</mo><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>q</mi></msub></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.776ex" height="2.057ex" viewBox="0 -520.7 5500.8 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2C" x="2543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="3238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="3723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="4190" y="0"></use><g transform="translate(4623,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="638" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>r</mi><mi>p</mi></msub></mrow><mo>,</mo><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>r</mi><mi>q</mi></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-21"> \ vec {r _ p}, \ vec {r_q} </script>  , the matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-22"> S </script>  will consist of the scalar products of these vectors.  Such vectors <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-23"> n </script>  pieces, then the dimension of the matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-24"> S </script>  equals <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mtext>&amp;#xA0;</mtext><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>s</mi><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.226ex" height="1.937ex" viewBox="0 -728.2 3972.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-69" x="1212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6D" x="1557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="2436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-73" x="2902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6E" x="3372" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mtext>&nbsp;</mtext><mi>t</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>s</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-25"> n \ times n </script>  . </p><br><p><img src="https://habrastorage.org/webt/kh/bw/ct/khbwctgydbzj51g5qwybvxtr9wo.png"></p><br><p>  On the diagonal of the matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-26"> S </script>  are squares of lengths of vectors <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>p</mi></msub></mrow><mo>:</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>p</mi></mrow></msub><mo>=</mo><msubsup><mi>r</mi><mi>p</mi><mn>2</mn></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.026ex" height="2.901ex" viewBox="0 -883.9 6900.2 1249" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3A" x="2820" y="0"></use><g transform="translate(3377,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="503" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="4936" y="0"></use><g transform="translate(5992,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-32" x="638" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="638" y="-212"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>r</mi><mi>p</mi></msub></mrow><mo>:</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>p</mi></mrow></msub><mo>=</mo><msubsup><mi>r</mi><mi>p</mi><mn>2</mn></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-27"> \ vec {r_p}: s_ {p p} = r_p ^ 2 </script>  .  Knowing this, let's consider the full potential of interaction.  Let's start with the calculation of two auxiliary matrices.  In one diagonal of the matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-28"> S </script>  will be repeated in rows, in the other - in columns. </p><br><p><img src="https://habrastorage.org/webt/ms/np/ps/msnppskk5fbczwgqvelu3jgeo80.png"></p><br><p>  Now let's look at the value of the expression <code>p_roll + q_roll - 2 * S</code> </p><br><p><img src="https://habrastorage.org/webt/cc/py/ii/ccpyiidioj3yrxqnpxxbuyt8ht0.png"></p><br><p>  Element with indexes <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.082ex" height="2.66ex" viewBox="0 -832 2188.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2C" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="1338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-29" x="1798" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>p</mi><mo>,</mo><mi>q</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-29"> (p, q) </script>  <code>sq_dist</code> matrix equals <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>r</mi><mi>p</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>r</mi><mi>q</mi><mn>2</mn></msubsup><mo>&amp;#x2212;</mo><mn>2</mn><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>p</mi></msub></mrow><mo>,</mo><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>q</mi></msub></mrow><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>p</mi></msub></mrow><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>r</mi><mi>q</mi></msub></mrow><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.955ex" height="3.021ex" viewBox="0 -935.7 21938.7 1300.8" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-32" x="638" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="638" y="-212"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2B" x="1129" y="0"></use><g transform="translate(2130,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-32" x="638" y="488"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="638" y="-211"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2212" x="3258" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-32" x="4258" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="5009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-64" x="5442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6F" x="5966" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-74" x="6451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-28" x="6813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="7452" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="7938" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="8404" y="0"></use><g transform="translate(8838,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2C" x="9745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="10441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="10926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="11393" y="0"></use><g transform="translate(11826,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-29" x="12703" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-3D" x="13370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-28" x="14427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="15066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="15552" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="16018" y="0"></use><g transform="translate(16452,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-70" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2212" x="17581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-76" x="18832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-65" x="19318" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-63" x="19784" y="0"></use><g transform="translate(20218,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-71" x="638" y="-213"></use></g><g transform="translate(21095,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-32" x="550" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>r</mi><mi>p</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>r</mi><mi>q</mi><mn>2</mn></msubsup><mo>‚àí</mo><mn>2</mn><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>r</mi><mi>p</mi></msub></mrow><mo>,</mo><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>r</mi><mi>q</mi></msub></mrow><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>r</mi><mi>p</mi></msub></mrow><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>r</mi><mi>q</mi></msub></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-30"> r_p ^ 2 + r_q ^ 2 - 2 \ cdot (\ vec {r_p}, \ vec {r_q}) = (\ vec {r_p} - \ vec {r_q}) ^ 2 </script>  .  That is, we have a matrix of squares of distances between points. </p><br><h3 id="elektrostaticheskoe-ottalkivanie-na-sfere">  Electrostatic repulsion on a sphere </h3><br><p>  <code>dist = np.sqrt(sq_dist)</code> - matrix of distances between points.  We need to calculate the potential, taking into account the repulsion of points between themselves and the attraction to the sphere.  Let's put on the diagonal of the unit and replace each element with the opposite one (just don‚Äôt think that we drew the matrix!): <code>rec_dist_one = 1 / (dist + np.eye(n))</code> .  It turned out the matrix, on the diagonal of which there are units, the other elements - the potentials of electrostatic interaction between the points. </p><br><p>  We now add the quadratic potential of attraction to the surface of the unit sphere.  Distance from the surface of the sphere <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>r</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.861ex" height="2.66ex" viewBox="0 -832 2953.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-2212" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-72" x="2112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMAIN-29" x="2564" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>‚àí</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-31"> (1 - r) </script>  .  Square it up and multiply by <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/hh/blog/424227/&amp;xid=17259,1500000,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg4Hkru9gg-4xse3HMujK0TlWyiaQ#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-32"> k </script>  which defines the relation between the role of electrostatic repulsion of particles and the attraction of a sphere.  Total <code>k = 1000</code> , <code>all_interactions = rec_dist_one - torch.eye(n) + (d.sqrt() - torch.ones(n))**2</code> .  The long-awaited loss function, which we will minimize: <code>t = all_interactions.sum()</code> </p><br><p>  A program that calculates potential using the numpy library: </p><br><pre> <code class="python hljs">S = X.dot(XT) <span class="hljs-comment"><span class="hljs-comment">#    pp_sq_dist = np.diag(S) #  p_roll = pp_sq_dist.reshape(1, -1).repeat(n, axis=0) #     q_roll = pp_sq_dist.reshape(-1, 1).repeat(n, axis=1) #     pq_sq_dist = p_roll + q_roll - 2 * S #      pq_dist = np.sqrt(pq_sq_dist) #    pp_dist = np.sqrt(pp_sq_dist) #      surface_dist_sq = (pp_dist - np.ones(n)) ** 2 #       rec_pq_dist = 1 / (pq_dist + np.eye(n)) - np.eye(n) #      L_np_rec = rec_pq_dist.sum() / 2 #     L_np_surf = k * surface_dist_sq.sum() #       L_np = (L_np_rec + L_np_surf) / n #   ,     print('loss =', L_np)</span></span></code> </pre> <br><p>  Here things are a little better - 200 ms for 2000 points. </p><br><p>  Use pytorch: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch pt_x = torch.from_numpy(X) <span class="hljs-comment"><span class="hljs-comment"># pt_x -   tensor   pytorch pt_S = pt_x.mm(pt_x.transpose(0, 1)) # mm - matrix multiplication pt_pp_sq_dist = pt_S.diag() pt_p_roll = pt_pp_sq_dist.repeat(n, 1) pt_q_roll = pt_pp_sq_dist.reshape(-1, 1).repeat(1, n) pt_pq_sq_dist = pt_p_roll + pt_q_roll - 2 * pt_S pt_pq_dist = pt_pq_sq_dist.sqrt() pt_pp_dist = pt_pp_sq_dist.sqrt() pt_surface_dist_sq = (pt_pp_dist - torch.ones(n, dtype=torch.float64)) ** 2 pt_rec_pq_dist = 1/ (pt_pq_dist + torch.eye(n, dtype=torch.float64)) - torch.eye(n, dtype=torch.float64) L_pt = (pt_rec_pq_dist.sum() / 2 + k * pt_surface_dist_sq.sum()) / n print('loss =', float(L_pt))</span></span></code> </pre> <br><p>  And finally, tensorflow: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf tf_x = tf.placeholder(name=<span class="hljs-string"><span class="hljs-string">'x'</span></span>, dtype=tf.float64) tf_S = tf.matmul(tf_x, tf.transpose(tf_x)) tf_pp_sq_dist = tf.diag_part(tf_S) tf_p_roll = tf.tile(tf.reshape(tf_pp_sq_dist, (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>)), (n, <span class="hljs-number"><span class="hljs-number">1</span></span>)) tf_q_roll = tf.tile(tf.reshape(tf_pp_sq_dist, (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)), (<span class="hljs-number"><span class="hljs-number">1</span></span>, n)) tf_pq_sq_dist = tf_p_roll + tf_q_roll - <span class="hljs-number"><span class="hljs-number">2</span></span> * tf_S tf_pq_dist = tf.sqrt(tf_pq_sq_dist) tf_pp_dist = tf.sqrt(tf_pp_sq_dist) tf_surface_dist_sq = (tf_pp_dist - tf.ones(n, dtype=tf.float64)) ** <span class="hljs-number"><span class="hljs-number">2</span></span> tf_rec_pq_dist = <span class="hljs-number"><span class="hljs-number">1</span></span> / (tf_pq_dist + tf.eye(n, dtype=tf.float64)) - tf.eye(n, dtype=tf.float64) L_tf = (tf.reduce_sum(tf_rec_pq_dist) / <span class="hljs-number"><span class="hljs-number">2</span></span> + k * tf.reduce_sum(tf_surface_dist_sq)) / n glob_init = tf.local_variables_initializer() <span class="hljs-comment"><span class="hljs-comment">#     with tf.Session() as tf_s: #     glob_init.run() #   res, = tf_s.run([L_tf], feed_dict={tf_x: x}) #   print(res)</span></span></code> </pre> <br><p>  Compare the performance of these three approaches: </p><br><table><tbody><tr><td>  N </td><td>  python </td><td>  numpy </td><td>  pytorch </td><td>  tensorflow </td></tr><tr><td>  2000 </td><td>  4.03 </td><td>  0.083 </td><td>  1.11 </td><td>  0.205 </td></tr><tr><td>  10,000 </td><td>  99 </td><td>  2.82 </td><td>  2.18 </td><td>  7.9 </td></tr></tbody></table><br><p>  Vectorized calculations give a gain of more than one and a half decimal orders relative to the code in pure python.  The pytorch boiler plate is visible: it takes a lot of time to compute a small volume, but it almost doesn‚Äôt change as the computation increases. </p><br><h3 id="vizualizaciya">  Visualization </h3><br><p>  Nowadays, data can be visualized by means of a huge number of packages, such as Matlab, Wolfram Mathematica, Maple, Matplotlib, etc., etc. There are a lot of complex functions in these packages that do complex things.  Unfortunately, if you are faced with a simple, but non-standard task, you find yourself unarmed.  My favorite solution in this situation is povray.  This is a very powerful program that is usually used to create photorealistic images, but it can be used as a "visualization assembler".  Usually, no matter how complex the surface that you want to display, it is enough to ask povray to draw spheres with centers lying on this surface. </p><br><p>  Using the vapory library, you can create a povray scene right in python, render it and look at the result.  Now it looks like this: </p><br><p><img src="https://habrastorage.org/webt/fh/1j/6x/fh1j6xkcdedx1m4s0x9clmsgjse.gif"></p><br><p>  The picture was obtained as follows: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> vapory <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PIL <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Image <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_scene</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(moment)</span></span></span><span class="hljs-function">:</span></span> angle = <span class="hljs-number"><span class="hljs-number">2</span></span> * math.pi * moment / <span class="hljs-number"><span class="hljs-number">360</span></span> r_camera = <span class="hljs-number"><span class="hljs-number">7</span></span> camera = vapory.Camera(<span class="hljs-string"><span class="hljs-string">'location'</span></span>, [r_camera * math.cos(angle), <span class="hljs-number"><span class="hljs-number">1.5</span></span>, r_camera * math.sin(angle)], <span class="hljs-string"><span class="hljs-string">'look_at'</span></span>, [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-string"><span class="hljs-string">'angle'</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>) light1 = vapory.LightSource([<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">-3</span></span>], <span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) light2 = vapory.LightSource([<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>], <span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]) plane = vapory.Plane([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-number"><span class="hljs-number">-1</span></span>, vapory.Pigment(<span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>])) box = vapory.Box([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>], vapory.Pigment(<span class="hljs-string"><span class="hljs-string">'Col_Glass_Clear'</span></span>), vapory.Finish(<span class="hljs-string"><span class="hljs-string">'F_Glass9'</span></span>), vapory.Interior(<span class="hljs-string"><span class="hljs-string">'I_Glass1'</span></span>)) spheres = [vapory.Sphere( [float(r[<span class="hljs-number"><span class="hljs-number">0</span></span>]), float(r[<span class="hljs-number"><span class="hljs-number">1</span></span>]), float(r[<span class="hljs-number"><span class="hljs-number">2</span></span>])], <span class="hljs-number"><span class="hljs-number">0.05</span></span>, vapory.Texture(vapory.Pigment(<span class="hljs-string"><span class="hljs-string">'color'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]))) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> x] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vapory.Scene(camera, objects=[light1, light2, plane, box] + spheres, included=[<span class="hljs-string"><span class="hljs-string">'glass.inc'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">360</span></span>): flnm = <span class="hljs-string"><span class="hljs-string">'out/sphere_{:03}.png'</span></span>.format(t) scene = create_scene(t) scene.render(flnm, width=<span class="hljs-number"><span class="hljs-number">800</span></span>, height=<span class="hljs-number"><span class="hljs-number">600</span></span>, remove_temp=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) clear_output() display(Image.open(flnm))</code> </pre> <br><p>  From the heap of files, animated gif is collected using ImageMagic: </p><br><pre> <code class="bash hljs">convert -delay 10 -loop 0 sphere_*.png sphere_all.gif</code> </pre> <br><p>  <a href="https://github.com/tarstars/torch_demo/blob/master/uniform_distribution.ipynb">On github,</a> you can see the working code, fragments of which are shown here.  In the second article I will talk about how to run the minimization of the functional, so that the points come out of the cube and evenly spread over the sphere. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/424227/">https://habr.com/ru/post/424227/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../424209/index.html">Wireless Finesse: Snom A170 Headset Overview</a></li>
<li><a href="../424211/index.html">Understand the Container Storage Interface (in Kubernetes and not only)</a></li>
<li><a href="../424215/index.html">Elm. Comfortable and awkward</a></li>
<li><a href="../424217/index.html">Discourse on holy wars, and prayer for peace</a></li>
<li><a href="../424223/index.html">Disposable customers. Segmentation for repeat purchases</a></li>
<li><a href="../424229/index.html">Kubernetes in production: services</a></li>
<li><a href="../424231/index.html">How to make money on hosters</a></li>
<li><a href="../424233/index.html">Computer taught to determine dementia with an accuracy of 93%</a></li>
<li><a href="../424235/index.html">How to use STATSPACK instead of AWR in Oracle Standard Edition</a></li>
<li><a href="../424237/index.html">Charge your brains directly! Rantime, compilers and performance on Joker 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>