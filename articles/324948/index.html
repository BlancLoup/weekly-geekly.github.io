<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Thunderbird and Kontact instead of MS Outlook</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When you work in a large company, where Windows OS is mainly on workstations, and you are one of the few Linux users, then you spend a certain amount ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Thunderbird and Kontact instead of MS Outlook</h1><div class="post__text post__text-html js-mediator-article"><p>  When you work in a large company, where Windows OS is mainly on workstations, and you are one of the few Linux users, then you spend a certain amount of your efforts to overcome the resistance of an unfriendly IT environment.  Over the years, some problems remain in the past, but new ones appear.  So, for example, sites that only sharpened under IE almost disappeared as a class.  All the less scary <em>.docx,</em> .xlsx files come in the mail.  Somewhere the programs that are necessary for all wonder-yudo, which are written only for Windows, have disappeared.  Now almost everything can be opened and edited from a web browser.  Much has changed, but not all. </p><br><p>  <em>Guess the picture and get</em> <del>  baseball cap as a gift </del>  prize of the connoisseur of the mail  In 2000, it was the PC Magazine mailer of the year, and I myself used it for a couple of years.  Only honestly, without searching for pictures. </p><br><img src="https://habrastorage.org/files/2a0/ee4/8f2/2a0ee48f2cc94c76b4e45313209c93bf.png"><br><p><br>  Speaking of mail, what's wrong with her?  In those organizations where Exchange Server is used, events constantly come to the calendar and somehow it is inconvenient to justify that your mailer does not interact with the calendar, and you don‚Äôt use Outlook because you don‚Äôt have it on Linux.  How to set up mail correctly so that everything works on Exchange Server: mail, calendar, address book, work with folders?  I write this article about this. </p><a name="habracut"></a><br><h3 id="kontact-sostoyalsya">  Kontact took place </h3><br><p>  For a decade, I had the opportunity to check Linux mail programs as an Exchange Server client.  At various times I used <em>KMail / Kontact</em> and <em>Thunerbird</em> for this purpose.  I have to say that the first option almost completely replaced MS Outlook.  The second provides no more than half of the required functionality, but it is much simpler in terms of installation and further operation. </p><br><p> So let's get started.  Let's start with the difficult: setting up your work email with <code>kdepim / kontact / kmail</code> to fully replace MS Outlook. </p><br><p>  <em>KDEPIM structure.</em>  <em>A yellowish fill color indicates Kontact components that interact with the mail server.</em> </p><br><img src="https://habrastorage.org/files/482/f2e/69d/482f2e69d67b47d39f59b326ecea5ed2.png"><br><p><br></p><br><p>  As is already clear, this method implies KDE, as a graphical environment, together with the KDEPIM package.  In addition, we will need the DavMail mail gateway, which unfortunately is not in the standard Gentoo Linux repositories.  Exit the situation using the <code>dpkg</code> utility and deb package for Debian.  It is noteworthy that the development is conducted on SourceForge, and a few days ago a new version of DavMail 4.8 was released. </p><br><pre> <code class="hljs ruby">(<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">15</span></span>)$ wget <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/goo.gl/vx</span></span>EncG -O davmail_4.<span class="hljs-number"><span class="hljs-number">8.0</span></span>-<span class="hljs-number"><span class="hljs-number">2479</span></span>-<span class="hljs-number"><span class="hljs-number">1_</span></span>all.deb (<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">16</span></span>)$ sudo dpkg -i davmail_4.<span class="hljs-number"><span class="hljs-number">8.0</span></span>-<span class="hljs-number"><span class="hljs-number">2479</span></span>-<span class="hljs-number"><span class="hljs-number">1_</span></span>all.deb</code> </pre> <br><p>  <strong>DavMail</strong> is a program that converts <em>Exchange Web Services</em> to open POP, IMAP, SMTP, Caldav, Carddav, and LDAP. </p><br><p>  <em>DavMail architecture, from the project‚Äôs home page.</em> </p><br><img src="https://habrastorage.org/files/ca4/e7d/d42/ca4e7dd429e3465ca20f6e65fd850c2f.png"><br><p><br></p><br><p>  The program pulls all the dependencies to nothing: any open or ajar hypostasis <code>jdk/jre</code> is fine.  Users of the cloud Outlook 365 do not need to configure anything on DavMail, the Exchange Web Services URL is specified in the program initially.  If you use a normal internal Exchange Server, then the URL must be specified.  And this is almost everything, yet put the daws on the options and DavMail is configured. </p><br><img src="https://habrastorage.org/files/eaf/2bc/d48/eaf2bcd4859d4f2cac4ec293b3979d1e.png"><br><p><br></p><br><p>  For more fine-tuning, you can use the configuration file <code>~/.davmail.properties</code> . </p><br><p>  Configure ports in the config file. </p><br><pre> <code class="bash hljs">(5:10)$ grep Port .davmail.properties davmail.caldavPort=1080 davmail.imapPort= davmail.ldapPort= davmail.popPort= davmail.proxyPort= davmail.smtpPort=</code> </pre> <br><p>  Put DavMail into background process mode (X11 is not required). </p><br><pre> <code class="hljs pgsql">davmail.<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre> <br><p>  Next, configure <em>KMail</em> and <em>KOrganizer</em> .  Since DavMail is difficult to flexibly configure to receive mail, it is preferable to pick up mail directly, and the calendar from the gateway.  The difficulty lies in setting up well-known ports, which may require rooting rights, in fussing with SSL certificates when setting up a secure connection. </p><br><p>  Hardly Habr's readers need to talk about how to set up an email client to receive and send mail.  Just in case <a href="https://userbase.kde.org/Working_with_GMail">there is a link</a> for those who are confused by the <em>KMail</em> interface.  I‚Äôll only give you implicit settings, for example, where you should specify the path to the sent folders, templates and drafts, for this you need to open <code>Settings ‚Üí Identity ‚Üí Advanced</code> . </p><br><img src="https://habrastorage.org/files/ace/603/eac/ace603eaccf44c84a0d9e4df630f5387.png"><br><p><br></p><br><p>  It is noteworthy that you select the folder for the remote from another window: <code>Settings ‚Üí Configure KMail ‚Üí Accounts ‚Üí Receiving tab ‚Üí (Choose an account) ‚Üí Modify ‚Üí Advanced ‚Üí Trash folder</code> . </p><br><p>  I wrote a <a href="https://habrahabr.ru/post/256305/">separate post</a> about how to glue DavMail and <code>KOrganizer</code> , so I will not repeat, but instead I will again mention the pitfalls, that is, one rather large reef.  Most often, the domain password coincides with the user's password on the Exchange server and at the moment when the domain user changes his domain password, you need <strong>to remember to change it</strong> to <code>KOrganizer</code> .  If this is not done on time, the account <em>may be blocked</em> , due to persistent calendar attempts to establish a connection with the old password. </p><br><p>  It remains to configure LDAP / AD on the address book: <code>Settings ‚Üí Configure KAddressbook ‚Üí LDAP Server Settings ‚Üí Add host</code> . </p><br><img src="https://habrastorage.org/files/70b/0b8/b31/70b0b8b31f0a45d3a51201f523069f30.png"><br><p><br></p><br><p>  The most difficult thing is to set up the DN correctly, for self-checking here you can use the <code>ldapsearch</code> command.  If the command finds a user, then the value of the <code>-b</code> parameter should be entered in the DN field, in this case, <code>ou=people,o=somehost.com</code> . </p><br><pre> <code class="hljs vbscript">ldapsearch -h ldap.somehost.com -x -b ou=people,o=somehost.com -s <span class="hljs-keyword"><span class="hljs-keyword">sub</span></span> cn=<span class="hljs-string"><span class="hljs-string">"Ivan Petrov"</span></span></code> </pre> <br><p>  What works flawlessly: </p><br><ul><li>  receiving and sending messages, </li><li>  search for contacts in Active Directory, </li><li>  calendar view, </li><li>  all kinds of message filters, </li><li>  alerts, including in the background. </li></ul><br><p>  Works, but with complaints: </p><br><ul><li>  list, rename and delete IMAP folders on the Exchange mail server, </li><li>  accept, reject, or change the calendar event, </li><li>  indexing, search. </li></ul><br><p>  Does not work: </p><br><ul><li>  Some Outlook-specific gadgets, such as voting yes / no, or <code>Action Items</code> in the message header. </li><li>  settings on the mail server, for example, automatic replies. </li></ul><br><p>  In addition, a number of both positive and negative properties of <em>Kontact</em> does not depend on the Exchange Server.  After <em>KMail,</em> I cannot use email clients that do not have the opportunity to send the sent email again or send an exact copy of it, an elegant and lightweight message editor.  On the other hand, the confused S / MIME infrastructure, confusing settings, GHs, due to the interaction with the MS Outlook html parser, get on your nerves. </p><br><p>  <em>Akonadi Architecture</em> </p><br><img src="https://habrastorage.org/files/a74/5f9/ec8/a745f9ec8caa44fbb58813d5bbab376e.png"><br><p><br></p><br><p>  In general, this set is rather cumbersome, fragile and requires some attention so that everything continues to work as it should.  The weak link here is the Akonadi server, which serves as a repository for all PIM data.  Often, Akonadi‚Äôs storage data deteriorates and then nothing starts.  We have to <a href="https://plus.google.com/u/0/b/117579792227981962396/collection/cTyHVB">delete the database and run everything on a new one</a> .  After each KDE upgrade, you try to launch KDEPIM applications with bated breath. </p><br><h3 id="thunderbird-zolotaya-seredina">  Thunderbird: the golden mean </h3><br><p>  With <em>Thunderbird, the</em> situation is different.  Such a bulky infrastructure and so much effort are not required, the whole process from the beginning to the end can take no more than 15 minutes, but the end result is more modest.  From time to time, you will have to open the Exchange server's web interface in order to accept, reject or change an event in the calendar, delete a message, work with folders.  Thunderbird does not know how to do all this when working with Exchange Server through the IMAP protocol. </p><br><p>  As in the previous case, I suggest taking mail directly, the calendar through the gateway, and taking contacts from LDAP / AD.  I skip the mail setup in Thunderbird, everything is clear.  For Office 365, the mail server for incoming and outgoing mail is <code>outlook.office365.com</code> .  I remind you how to configure CalDav: </p><br><p>  The procedure will be as follows: </p><br><ol><li>  Install <a href="https://www.mozilla.org/en-US/projects/calendar/">the Lightning extension</a> . </li><li>  Customize CalDav - calendar DavMail. </li><li>  Create a new calendar, and register <code>http://localhost:1080/users/username@somehost.com/calendar</code> . </li></ol><br><p>  <em>Setting up a calendar in Thunderbird, through the Lightning extension and the DavMail gateway</em> </p><br><img src="https://habrastorage.org/files/87d/eef/cd4/87deefcd4e094a3dae2dd84c86ddc3ea.png"><br><p><br></p><br><ul><li>  the default port is 1080, </li><li>  <code>outlook.office365.com/EWS/Exchange.asmx</code> is the path to Office 365 web services. For traditional Exchange servers, only the FQDN will be different. </li></ul><br><p>  Creating a new calendar is also easy after you find how to do it.  Do not look in vain in the Thunderbird menu, I give a picture to help.  Only the context menu of the right mouse click and only in the specified place highlighted in color will provide an opportunity to create a new calendar. </p><br><p>  <em>Lightning extension</em> . </p><br><img src="https://habrastorage.org/files/ead/9fe/9f1/ead9fe9f1bf44e7d9836c7486e368015.png"><br><p><br></p><br><p>  After that, you just need to add the local address from the gateway settings, specifying the path as shown in step 3 above. Again, as a precautionary measure, <em>do not synchronize too often</em> , so that after changing the domain password you do not block the account until the calendar is knocked on the server old password. </p><br><p>  The address book remains, no extensions and gateways are required for it.  The only thing is that Gentoo Linux users should build a package with the <code>USE</code> <code>ldap</code> flag. </p><br><pre> <code class="hljs sql">[ebuild R ] mail-client/thunderbird-45.8.0::gentoo <span class="hljs-keyword"><span class="hljs-keyword">USE</span></span>=<span class="hljs-string"><span class="hljs-string">"crypt dbus hardened jemalloc3 ldap minimal pulseaudio -bindist -custom-cflags -custom-optimization -debug -ffmpeg -gstreamer -jit -lightning -mozdom (-neon) (-selinux) -startup-notification (-system-cairo) -system-harfbuzz -system-icu -system-jpeg -system-libevent -system-libvpx -system-sqlite"</span></span> L10N=<span class="hljs-string"><span class="hljs-string">"ru -ar -ast -be -bg -bn-BD -br -ca -cs -cy -da -de -el -en-GB -es-AR -es-ES -et -eu -fi -fr -fy -ga -gd -gl -he -hr -hsb -hu -hy -id -is -it -ja -ko -lt -nb -nl -nn -pa -pl -pt-BR -pt-PT -rm -ro -si -sk -sl -sq -sr -sv -ta-LK -tr -uk -vi -zh-CN -zh-TW"</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> KiB</code> </pre> <br><p>  From the address book, we call the LDAP server connection settings window: <code> -&gt;  -&gt;  LDAP</code> . </p><br><img src="https://habrastorage.org/files/6fe/68c/198/6fe68c1987cc4974b52ae34caef5a73d.png"><br><p><br></p><br><p>  In the <code></code> tab, you can add search filters to your taste, for example: <code>(objectcategory=person)</code> or <code>(objectclass=*)</code> .  The entire list is <a href="http://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx">attached</a> . </p><br><h3 id="itogo">  Total </h3><br><p>  If to compare <em>Kontact / KMail and Thunderbird</em> , then the first one wins out on suitability in an office environment.  <code>Thunberdird</code> does not have the best <a href="https://wiki.mozilla.org/MailNews:Supported_IMAP_extensions">IMAP support</a> , but problems arise precisely with viewing and changing Office 365 folders. Microsoft, in turn, cannot boast of adherence to IT standards, so it‚Äôs possible that the whole thing is in the IMAP implementation curve on the server side.  Organizer also has more features than the Lightning extension.  Thanks to Akonadi, KDEPIM has a very convenient background process for receiving mail, registering events and alerts. </p><br><p>  On the other hand, all this should be monitored so that the KDEPIM house of cards does not break after each significant upgrade.  2 years ago <a href="https://www.opennet.ru/opennews/art.shtml%3Fnum%3D42715">it was transferred</a> to KDE Frameworks 5 and Qt 5, but it is still far from being present on all Linux distributions.  When will appear on Gentoo I will put it first of all and at the same time I will check the account on <a href="https://bugs.kde.org/">BugZilla</a> . </p><br><p>  Thunderbird impresses with the fact that it is easy to install, configure and maintain, and all that is not enough, you can do on the web client.  S / MIME just works, and in KMail, this is something with something.  Think for yourself, decide for yourself.  As machine translator says, Linux is all about choice. </p><br><p>  If it is interesting, next time I will tell you about the young and early Trojita email client, the heavyweight Evolution, and even little things. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/324948/">https://habr.com/ru/post/324948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324936/index.html">SQL or NoSQL - that is the question</a></li>
<li><a href="../324940/index.html">A selection of useful tools with Product Hunt for March</a></li>
<li><a href="../324942/index.html">Solving problems with the memory occupied by the IntelliMemory module in Diskeeper and SSDkeeper</a></li>
<li><a href="../324944/index.html">Web typography</a></li>
<li><a href="../324946/index.html">Omegicus Digest: Antialiasing Fonts and Encryption and Compression Library</a></li>
<li><a href="../324950/index.html">Startup of the day, start (February 2017)</a></li>
<li><a href="../324952/index.html">Is FLIF the ideal format for images?</a></li>
<li><a href="../324956/index.html">Preview portal with early access to new Azure functionality</a></li>
<li><a href="../324958/index.html">Instructions for publishing iOS applications on the App Store</a></li>
<li><a href="../324960/index.html">In-depth training on the features of the title and content of the article to overcome clickbate</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>