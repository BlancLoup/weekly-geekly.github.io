<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>FireHOL - a firewall for ignoramuses in five minutes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is not even an article or a full-fledged guide, but a small snippet that will help you in the shortest time possible to raise a well-protected an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>FireHOL - a firewall for ignoramuses in five minutes</h1><div class="post__text post__text-html js-mediator-article">  This is not even an article or a full-fledged guide, but a small snippet that will help you in the shortest time possible to raise a well-protected and properly configured router to any GNU / Linux machine.  And this is in the absence of the necessary knowledge of iptables. <br><br>  Firehol, unlike <a href="http://habrahabr.ru/blogs/linux/80271/">shorewall</a> , is not even a set of scripts, but just one bash script.  Therefore, to use it, the need for perl and other interpreters is eliminated. <br><br>  Firehol is closer to the good old <a href="http://www.knowplace.org/pages/howtos/firewalling_with_netfilter_iptables/netfilter_automatic_rule_configurator.php">narc</a> (netfilter automatic rule configurator), but the latter has not been updated for 6 years and is a fairly simple script that is not compatible with the latest versions of iptables.  Closer he is that allows you to write the rules almost in <s>their native</s> human language. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  emerge or not apt-get? </h5><br><br>  For gentoo, this is always <i>emerge -av net-firewall / firehol</i> (do not forget to add ~ arch to /etc/portage/package.keywords or use ACCEPT_KEYWORDS = "~ arch") <br><br>  After installation, get the file <i>get-iana.sh</i> from the firehol-1.273.tar.bz2 <i>archive</i> and run it.  Perhaps in other distributions this file is copied to the system.  In gentoo ebuild does not touch it to the <s>left</s> .  The essence of the work of this script is to download reserved IP's directly from IANA. <br><br>  The most common configuration. <br><br>  Configuration example for a router in a small company.  All outgoing connections are allowed, one incoming ssh on a non-standard port, in addition all http traffic will be wrapped on squid.  To save space, I‚Äôll leave out some comment blocks. <br><br><h5>  cat /etc/firehol/firehol.conf </h5><br><br> <code># ---------------------------------------------------------------------------- <br> #   <br> # ---------------------------------------------------------------------------- <br> <br> server_ssh_ports="tcp/2202" #  SSH    2202 <br> <br> # ---------------------------------------------------------------------------- <br> #   <br> # ---------------------------------------------------------------------------- <br> <br> # ---   --- <br> <br> HOME_MYIP="192.168.1.1" #  IP     <br> HOME_MYIF="eth1" #    <br> HOME_BCAST="192.168.1.255" #  <br> HOME_LAN="192.168.1.0/24" #  <br> HOME_SERVICES="all" # ,    <br> <br> HOME_DHCP=1 #   1,       DHCP <br> FIREHOL_LOG_MODE="LOG" #   <br> FIREHOL_LOG_LEVEL="error" #       :) <br> <br> # ---   --- <br> <br> PUBLIC_MYIP="87.250.251.11" #  ,  IP   <br> PUBLIC_MYIF="eth0" #     <br> PUBLIC_SERVICES="ssh" # ,     . <br> <br> DIAL_ON_DEMAND=0 #   1,       <br> <br> # ---   --- <br> <br> TRUSTED_PCS="209.85.135.104" #  IP     <br> TRUSTED_SERVICES="ssh http" # ssh  http . <br> # ,  http    IP  TRUSTED_PCS. <br> <br> # ---   --- <br> <br> SQUID_PORT="3128" #  ,     <br> SQUID_USERS="squid" # ,    <br> SQUID_EXCLUDE="192.168.1.1" # IP ,    <br> <br> # ---   --- <br> <br> blacklist="" #  IP  <br> <br> # ---------------------------------------------------------------------------- <br> #  (       firehol) <br> # ---------------------------------------------------------------------------- <br> <br> if [ ! -z "${blacklist}" ] <br> then <br> blacklist full "${blacklist}" <br> fi <br> <br> if [ ! -z "${SQUID_PORT}" ] <br> then <br> transparent_squid "${SQUID_PORT}" "${SQUID_USERS}" \ <br> inface "${HOME_MYIF}" src "${HOME_LAN}" \ <br> `test ! -z "${SQUID_EXCLUDE}" &amp;&amp; echo "dst not ${SQUID_EXCLUDE}"` <br> fi <br> <br> if [ ! -z "${PUBLIC_MYIP}" ] <br> then <br> snat to "${PUBLIC_MYIP}" \ <br> outface "${PUBLIC_MYIF}" \ <br> src "${HOME_LAN}" dst not "${UNROUTABLE_IPS}" <br> else <br> masquerade "${PUBLIC_MYIF}" <br> fi <br> <br> interface "${HOME_MYIF}" home src "${HOME_LAN}" dst "${HOME_MYIP} ${HOME_BCAST}" <br> policy reject <br> server "${HOME_SERVICES}" accept <br> <br> client all accept <br> <br> if [ ${HOME_DHCP} -eq 1 ] <br> then <br> interface "${HOME_MYIF}" dhcp <br> server dhcp accept <br> fi <br> <br> interface "${PUBLIC_MYIF}" internet \ <br> src not "${UNROUTABLE_IPS}" \ <br> `test ! -z "${PUBLIC_MYIP}" &amp;&amp; echo "dst ${PUBLIC_MYIP}"` <br> protection strong <br> policy drop <br> if [ ! -z "${TRUSTED_PCS}" -a ! -z "${TRUSTED_SERVICES}" ] <br> then <br> server "${TRUSTED_SERVICES}" accept src "${TRUSTED_PCS}" <br> fi <br> server "${PUBLIC_SERVICES}" accept <br> <br> client all accept <br> <br> if [ ${DIAL_ON_DEMAND} -eq 1 ] <br> then <br> interface "${PUBLIC_MYIF}" dialup <br> client all accept <br> fi <br> <br> router internet2lan inface "${PUBLIC_MYIF}" outface "${HOME_MYIF}" \ <br> src not "${UNROUTABLE_IPS}" dst "${HOME_LAN}" <br> <br> client all accept <br></code> <br><br><h5>  Forgot something to close / ban? </h5><br><br>  Firehol rule policy: ban everything, only allow explicitly specified. <br><br>  The example above creates about 400 (!) Rules, including rules against flood or xmas attacks. <br><br><h5>  Yeah, this is the rule ... No-no-no! </h5><br><br>  With Firehol, you can also not be afraid to make any changes to the config, turning the remote server into a pile of non-responsive hardware.  It will always leave your current ssh session open, even if you screwed up the rules with ssh settings!  Secondly, the rc script has several useful parameters.  Perhaps the most used of them is <b>try</b> . <br><br>  Before the final application of the parameters you have the opportunity to test their performance.  To do this, just call the script with the try parameter: <i>/etc/init.d/firehol try</i> <br><br>  Firehol will download the newly updated configuration files and will wait for the <i>commit</i> word from you.  If it does not arrive within thirty seconds, the previous operational parameters will be restored. <br><br>  In addition to the standard start, stop, restart and just described try there are three more: <br>  <b>status</b> - displays the current iptables rules <br>  <b>save</b> - saves current iptables rules <br>  <b>panic</b> - used for intrusion detection, ALL contacts with the outside world, including the internal network, overlap. <br><br><h5>  Himmemoa </h5><br><br>  If you are interested, you are welcome to <a href="http://firehol.sourceforge.net/">the program's website</a> , where you will find comprehensive documentation on this excellent product, as well as many examples of configurations from home NAT to an interoffice router with a DMZ, internal groups and other niceties. </div><p>Source: <a href="https://habr.com/ru/post/80284/">https://habr.com/ru/post/80284/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../80276/index.html">Core 2010</a></li>
<li><a href="../80277/index.html">How to beat piracy (part 1)</a></li>
<li><a href="../80278/index.html">How to beat piracy (part 2)</a></li>
<li><a href="../80279/index.html">Linux: Sending mail from the console</a></li>
<li><a href="../80282/index.html">A passion for programming. Part 1 (Choosing a market). Start</a></li>
<li><a href="../80285/index.html">High temperature physics</a></li>
<li><a href="../80288/index.html">GMail Offline Database. Export</a></li>
<li><a href="../80291/index.html">Rose petals on bash</a></li>
<li><a href="../80293/index.html">VitaminWater‚Äôs own taste - Connect for Facebook</a></li>
<li><a href="../80294/index.html">Development extensions for Envos.Blogs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>