<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CTB-Locker. We decided to pay</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="CTB Locker is a very well thought out and dangerous virus. I will not write about it - there is a lot of information about this virus on the Internet....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CTB-Locker. We decided to pay</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/2d8/150/fb0/2d8150fb0f434966858f9f6499911401.jpg"><br><br>  CTB Locker is a very well thought out and dangerous virus.  I will not write about it - there is a lot of information about this virus on the Internet. <br><br>  Over the past 3 months, some of our customers have caught this beast, despite warnings, updated corporate antiviruses and other protection solutions.  Some suffered from a separate working machine, while others had a terminal server.  But the backup tools saved everyone. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The last infection of one of the clients led to the loss of a large amount of data, as well as some backup copies.  The responsibility for this lay on the client - funding for the expansion of the backup server could not allocate half a year.  But that's not the point.  We were given the task of paying the creators of the virus (and then funding was sharply found). <br><br>  I do not agitate users of the community to pay intruders (I am opposed to this), but perhaps this small manual will help someone. <br><br>  Next, I will describe step by step how I paid bad people for decoding customer data. <br><a name="habracut"></a><br>  1. So we hit.  I got infected with the user's computer (as I got infected - we are still figuring out; there is antispam, there is an antivirus, user rights are curtailed).  Over the network, the virus encrypted the file server, the disk of which was connected to the user as a network one.  The virus encrypted those folders on the server that had write access to this user.  Local disks on the user's computer were also encrypted. <br><br>  2. When the virus has finished encryption - issued a banner to the user.  We were asked to decrypt data for 3.5 Bitcoin, which is approximately $ 805.  We were given 90 hours to make a decision. <br><br><img src="https://habrastorage.org/files/f26/208/14b/f2620814bbb94f3fb195ff1ed050c40a.png"><br><br>  3. On the local disk, in the Documents folder, instructions were found on how to proceed. <br><br><img src="https://habrastorage.org/files/797/64e/465/79764e46528f4228b4123f2ceb254e05.png"><br><br>  We were asked to go to the Tor-network and enter the public key on this website from this text file.  Alas, I did not take a screenshot of the site, the site opens very rarely and I did not see anything new there.  The site duplicates information from the banner on the user's desktop: information about the amount of the ransom, links to the site where you can buy bitcoins, wallet number where to transfer, etc., as well as a proposal to decrypt two files up to 1 megabyte each in proof of the possibility of decryption . <br><br>  4. Before starting all work, the infected user's computer and file server were isolated into a separate network with separate access to the Internet.  I checked the availability of a network drive.  All OK.  Getting started. <br><br>  5. Search for bitcoins.  I did not buy bitcoins before.  Sites proposed by attackers to buy Bitcoins did not suit us.  We need to buy the crypto-currency with a payment card of a Ukrainian bank (created a virtual card).  I went to look for ways to buy cryptocurrency.  On the Internet, a Ukrainian Bitcoin buying and selling site was found. <br><br>  a) register on the site (specify your mobile when registering - confirmation of transactions will be sent to it), we enter UAH to the account. <br><br><img src="https://habrastorage.org/files/fef/f14/049/feff14049ced471ba01668afee339fb4.png"><br><br>  b) Buy bitcoins for the hryvnia. <br><br><img src="https://habrastorage.org/files/f7f/b17/98f/f7fb1798fae54ddea141b44a6c0a31ed.png"><br><br>  c) We transfer Bitcoins to the wallet specified by the attackers.  Pay attention to the commission bitcoin network. <br><br><img src="https://habrastorage.org/files/bf1/d39/f64/bf1d39f645784602aa57f87a166d9f2a.png"><br><br>  We confirm the transaction via SMS from the phone specified during registration on the site.  The transaction took about 10-15 minutes. <br><br>  6. Waiting.  So, we have fulfilled all the conditions of the intruders.  What to do next?  A site on the Tor network is still not available.  As it turned out, we were not deceived.  The banner on the user's computer has changed from the money requirement to the information and the fact that our information is now decrypted.  Everything happened automatically. <br><br><img src="https://habrastorage.org/files/8a2/168/d72/8a2168d729fc4789b1c4c7f0e483b467.png"><br><br>  7. Decoding lasted about 2 hours.  We check the file server - everything is in place, everything is perfectly decrypted.  Banner suggests that we make Rescan in case we forgot to connect a network drive or insert a USB Flash / HDD, which was also previously encrypted, before starting decryption.  Or click Close and he will delete himself from the computer. <br><br><img src="https://habrastorage.org/files/55a/bc7/364/55abc7364dd2491f8af7b116636aa739.png"><br><br>  8. Make a backup copy of the file server (again, funding was quickly found on the expansion of the space for backup copies). <br><br>  9. We connect the file server back to the network users.  We format the user's computer, install Windows, etc. <br><br>  10. We are thinking about changing antivirus. <br><br>  I hope this publication has helped someone.  Or, at least, reminded about the importance of backup and fresh anti-virus databases. </div><p>Source: <a href="https://habr.com/ru/post/256573/">https://habr.com/ru/post/256573/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../256561/index.html">IBM Research Center sets a new record for recording data on tape</a></li>
<li><a href="../256563/index.html">Weekly build Vivaldi 1.0.161.2</a></li>
<li><a href="../256565/index.html">Light streams in Embox</a></li>
<li><a href="../256567/index.html">DataTalks # 2: Data Visualization</a></li>
<li><a href="../256571/index.html">Programmer == creativity || programmer! = creativity</a></li>
<li><a href="../256575/index.html">Seven principles of the effectiveness of a data center from Microsoft</a></li>
<li><a href="../256577/index.html">We are switching from STM32 to the Russian K1986BE92QI microcontroller. Practical application: Generate and reproduce sound. Part three: generate a sine wave. A simple look at DMA + first acquaintance with timers</a></li>
<li><a href="../256579/index.html">Two-step browser authentication with a U2F USB token</a></li>
<li><a href="../256581/index.html">Krovi: Big Data - as dream. 7th series. Big Jobs for Big Data</a></li>
<li><a href="../256585/index.html">10 useful frameworks that a developer needs to know</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>