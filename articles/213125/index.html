<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vacation request management service for SharePoint 2013 integrated with BOSS-Kadrovik</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Six months ago, we talked about how we implemented a service for booking meeting rooms with a large customer with geographically dispersed offices and...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vacation request management service for SharePoint 2013 integrated with BOSS-Kadrovik</h1><div class="post__text post__text-html js-mediator-article">  Six months ago, we talked about how <a href="http://habrahabr.ru/company/eastbanctech/blog/195110/">we implemented a service for booking meeting rooms</a> with a large customer with geographically dispersed offices and a staff of several thousand people.  We continue to work with the SharePoint portal of this company, as part of its development, EastBanc Technologies specialists have created another module - the leave application management service in integration with the automated <a href="http://www.bosshr.ru/tes/functional.php">BOSS-Kadrovik</a> personnel management system. <br><br>  The purpose of this service, it seems to us, does not need a lengthy explanation: to put it simply, the service automates the recording of holidays in the company.  It is much more interesting what practical tasks we faced in this particular company, more on that. <br><br><a name="habracut"></a><h5>  Analysis </h5><br>  In accordance with the Labor Code of the Russian Federation, the annual basic paid leave is granted to the employee after 6 months from the first day of work in the company, and then every year on the basis of the order for granting leave, executed in accordance with the vacation schedule.  Each month of work ‚Äúon the account‚Äù of an employee, 2.33 days of paid vacation is accumulated.  Paid vacation <a href="http://kzotrf.ru/head_19.html">is</a> : the main annual, additional, basic paid vacation in advance, additional vacation in advance.  And a separate type is <a href="http://123-job.ru/articles.php%3Fid%3D524">administrative leave</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Applications for these types of holidays we had to automate.  Our tasks included: <br><br><ol><li>  Provide employees with a convenient interface on the corporate portal for processing and coordinating vacation requests.  The employee must see how many free days he has, be able to send a request for approval to the head. </li><li>  To enable the employee‚Äôs manager to coordinate holiday requests automatically. </li><li>  Synchronize actual data with planning data that the personnel department has (stored in the BOSS-Personnel system). </li><li>  Minimize paper workflow. </li></ol><br>  From a technical point of view, it was necessary to consider the following: <br><br><ol><li>  The service had to be integrated into a personal account, retaining the style and logic of the already familiar <a href="http://habrahabr.ru/company/eastbanctech/blog/195110/">reservations booking service</a> . </li><li>  The solution was implemented on MS SharePoint 2010, but all participants in the development process already understood the need to move to 2013, which was later <a href="http://habrahabr.ru/company/eastbanctech/blog/212841/">conducted by EastBanc Technologies</a> . </li></ol><br><h5>  Ui </h5><br>  Everything was simple here: to act in the same spirit as with the negotiations (pictures are clickable, open in a new window). <br><br> <a href="http://http:"><img src="https://habrastorage.org/getpro/habr/post_images/b58/22c/806/b5822c806e608302d70ff3f4de8955e0.png"></a> <br>  ‚ÄúMy office‚Äù: we see the number of vacation days available to us for a given period, our own applications and their statuses, and in the ‚ÄúArchive‚Äù section - applications of subordinates, also with statuses.  Stand apart is the button "Add request". <br><br> <a href="http://http:"><img src="https://habrastorage.org/getpro/habr/post_images/7c2/d53/8c1/7c2d538c10d5d76d673036de44ba98b1.png"></a> <br>  ‚ÄúMy office‚Äù of the personnel officer: here everything is the same, only the section ‚ÄúRequests for approval‚Äù is added, which arrive from the entire company. <br><br> <a href="http://http:"><img src="https://habrastorage.org/getpro/habr/post_images/ae2/045/5e7/ae20455e7b18b4d2a90bba273f54e824.png"></a> <br>  Application for vacation - from the point of view of the employee.  He fills out this form and sends it to the head of his department for approval, after which it flies to personnel officers. <br><br> <a href="http://http:"><img src="https://habrastorage.org/getpro/habr/post_images/bc4/166/3f9/bc41663f9260070e1056b059ac759e53.png"></a> <br>  Application for leave from an employee - in this form, it comes to the immediate head of the employee (head of department). <br><br> <a href="http://http:"><img src="https://habrastorage.org/getpro/habr/post_images/fa8/a88/318/fa8a88318866b3d70317dbe1062a7f32.png"></a> <br>  Application for vacation from the employee - in this form, it comes to the personnel officer after agreement with the immediate head of the employee. <br><br> <a href="http://http:"><img src="https://habrastorage.org/getpro/habr/post_images/16f/96f/0a5/16f96f0a5b47cc95455092a161911d04.png"></a> <br>  The annual vacation schedule for a specific department - as the personnel officer sees. <br><br> <a href="http://http:"><img src="https://habrastorage.org/getpro/habr/post_images/4f9/9d5/773/4f99d5773d551ec0988a436cf70dbd57.png"></a> <br>  Vacation schedule for the department for the month - as the personnel officer sees it. <br><br><h5>  Storage of applications on the portal </h5><br>  To store information on actual and scheduled vacations, we created a list in SharePoint: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ecb/c6e/1c5/ecbc6e1c5f6e9a4f13e5953783deb933.png"><br><br><h5>  Integration with BOSS-Kadrovik </h5><br>  Information in SharePoint comes from the BOSS-Kadrovik system through file sharing using SharePoint Job.  We also send the information about the agreed requests back to BOSS-Kadrovik. <br><br>  To associate an employee's employee number with an account in ActiveDirectory, the employeeID field was added and ‚Äúprokinato‚Äù in SharePoint using the User Profile Service: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/10c/7f5/fa6/10c7f5fa60461e31c63474fed406140a.png"><br><br>  A separate problem was the vacation schedule, because  in the list of actual and planned vacations of the order of 100 thousand lines, and it was labor-intensive to determine the employee through the User Profile Service.  Therefore, we configured the Search Service Application, and using the KeywordQuery mechanism modified in SharePoint 2013, we obtain all the necessary information about users: <br><br><pre><code class="cs hljs">ResultTableCollection rtc = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> kwq = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KeywordQuery(site) { QueryText = String.Format(querySchema, employeeIdField, nameField, departmentField, department, officeField, office), ResultTypes = ResultType.RelevantResults, KeywordInclusion = KeywordInclusion.AllKeywords, HiddenConstraints = <span class="hljs-string"><span class="hljs-string">"scope:"</span></span> + <span class="hljs-string"><span class="hljs-string">"\"People\""</span></span> }; SearchExecutor se = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SearchExecutor(); rtc = se.ExecuteQuery(kwq);</code> </pre> <br><br>  In order to comply with the Labor Code of the Russian Federation, we made a check on the user's application: the duration of the main paid leave is a multiple of 7 days, and one of the holidays should last at least two weeks.  In addition to this check, an additional check for ‚Äúdays off‚Äù has been added: information about planned trips or days off comes from BOSS-Kadrovik - it is forbidden to apply for leave on these days. <br>  Also, holidays can be ‚Äúadded up‚Äù: for example, for the main paid leave of 14 days, you can ‚Äúattach‚Äù administrative leave of 7 days. <br><br>  <b>The data formats used for the exchange are:</b> <br><br>  1. Actual and planned vacation (from BOSS-Kadrovik and to BOSS-Kadrovik - the format is identical) <br><br>  imployeeId; fromDate; toDate; type <br>  59; 2010-08-09 00: 00: 00; 2010-08-22 00: 00: 00; 0 <br>  59; 2007-06-01 00: 00: 00; 2007-06-15 00: 00: 00; 0 <br>  59; 2007-08-15 00: 00: 00; 2007-09-04 00: 00: 00; 0 <br>  59; 2012-06-25 00: 00: 00; 2012-07-15 00: 00: 00; 0 <br>  59; 2012-09-01 00: 00: 00; 2012-09-07 00: 00: 00; 0 <br>  59; 2013-04-29 00: 00: 00; 2013-05-06 00: 00: 00; 0 <br>  59; 2013-07-01 00: 00: 00; 2013-07-21 00: 00: 00; 0 <br><br>  2. Available days for vacation (from BOSS-Kadrovik) <br><br>  imployeeId; fromDate; toDate; mainVacationDays; additionalVacationDays <br>  59; 2013-06-20 00: 00: 00; 2014-06-19 00: 00: 00; 14.0000; 3.0000 <br>  59; 2012-06-20 00: 00: 00; 2013-06-19 00: 00: 00;, 0000; 3,0000 <br>  59; 2011-06-20 00: 00: 00; 2012-06-19 00: 00: 00;, 0000; 3,0000 <br>  59; 2008-06-20 00: 00: 00; 2009-06-19 00: 00: 00; 1,0000;, 0000 <br>  59; 2007-06-20 00: 00: 00; 2008-06-19 00: 00: 00; 3,0000;, 0000 <br><br>  3. Information about truancy, time off, business trips (from BOSS-Kadrovik) <br><br>  imployeeId; fromDate; toDate; type <br>  5236; 2007-03-12 00: 00: 00; 2007-03-16 00:00:00;  Business trip <br>  5249; 2007-03-09 00: 00: 00; 2007-03-18 00:00:00;  Business trip <br>  209; 2007-03-19 00: 00: 00; 2007-03-19 00:00:00;  Weekend parents of children with disabilities <br><br><h5>  Implementation </h5><br>  To implement the forms for creating / editing / viewing applications, we redefined the standard dialogs for editing SharePoint elements in the corresponding list schema.xml using the UseLegacyForm attribute: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Forms</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DisplayForm"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DisplayForm.aspx"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">WebPartZoneID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">UseLegacyForm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TRUE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"EditForm"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"EditForm.aspx"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">WebPartZoneID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">UseLegacyForm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TRUE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NewForm"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NewForm.aspx"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">WebPartZoneID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">UseLegacyForm</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TRUE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Forms</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  As can be seen from the definition, these are essentially ordinary aspx pages, but with unique content placeholders. <br>  For example for the title tag: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asp:Content</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ContentPlaceHolderID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PlaceHolderPageTitle"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">runat</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asp:Content</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  <a href="http://office.microsoft.com/en-us/sharepoint-designer-help/working-with-content-placeholder-controls-HA102265026.aspx">Office.microsoft.com/en-us/sharepoint-designer-help/working-with-content-placeholder-controls-HA102265026.aspx is</a> described here in more detail <a href="http://office.microsoft.com/en-us/sharepoint-designer-help/working-with-content-placeholder-controls-HA102265026.aspx">.</a> <br><br>  For UI, we used jQuery UI. <br><br>  Also in the pop-up window to view the application we needed to display the approval history of this application.  To do this, we have created a list of "history of the approval of the application" with a lookup-field on the list of applications.  And defined the view using a CAML request: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Query</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Where</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Eq</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FieldRef</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Request"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">LookupId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TRUE"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Value</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Lookup"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">GetVar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Scope</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Request"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Id"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Eq</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Where</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OrderBy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FieldRef</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ID"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FieldRef</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OrderBy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Query</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  The Id parameter (this is the Id from the list of requests) comes from the request parameters, which is generally understandable, since  The link formed by SharePoint to open the form for viewing an element looks as follows: <br><br><pre> <code class="xml hljs">{$HttpVDir}/_layouts/15/listform.aspx?PageType=6&amp;ListId={$List}&amp;ID={$ID}</code> </pre><br><br>  Next, for our list of reconciliation history, its submission for a specific application and an aspx page for displaying an application, an xls representation was announced: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">File</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"RequestList/DisplayForm.aspx"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Lists/RequestList/DisplayForm.aspx"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">View</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">WebPartOrder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">WebPartZoneID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">BaseViewID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">List</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$Resources:core,lists_Folder;/RequestHistoryList"</span></span></span><span class="hljs-tag"> &gt;</span></span> &lt;![CDATA[ &lt;webParts&gt; &lt;webPart xmlns="http://schemas.microsoft.com/WebPart/v3"&gt; &lt;data&gt; &lt;properties&gt; .... &lt;property name="XslLink" type="string"&gt;/_layouts/15/ETR.VacationRequest/xsl/history.xsl&lt;/property&gt; .... &lt;/properties&gt; &lt;/data&gt; &lt;/webPart&gt; &lt;/webParts&gt; ]]&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">View</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">File</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  From the code it is obvious that the presentation will be located on the Lists / RequestList / DisplayForm.aspx page in the WebPartZoneID = ‚ÄúMain‚Äù web-site zone.  It remains only to make sure that we have such a zone on the page: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WebPartPages:WebPartZone</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">runat</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"server"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">FrameType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"None"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"loc:Main"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br><br>  With the vacation schedule, we went further, because  the standard list view in the form of a calendar did not suit us or the customer.  Therefore, we gave the task to our designers, and they drew this beautiful calendar: <br><br> <a href="http://http:"><img src="https://habrastorage.org/getpro/habr/post_images/16f/96f/0a5/16f96f0a5b47cc95455092a161911d04.png"></a> <br><br>  Having received the approval of the customer, we set to work: first of all, following the example of our reservations booking service, we wrote a WCF service that returns json and still works in the context of SharePoint. <br><br>  Defined DataContract: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DataContract(Name = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Vacation"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Vacation</span></span> { [DataMember(Name = <span class="hljs-string"><span class="hljs-string">"fromDate"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime FromDate { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [DataMember(Name = <span class="hljs-string"><span class="hljs-string">"toDate"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime ToDate { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [DataMember(Name = <span class="hljs-string"><span class="hljs-string">"type"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Type { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } [DataContract(Name = <span class="hljs-string"><span class="hljs-string">"employeeData"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EmployeeData</span></span> { [DataMember(Name = <span class="hljs-string"><span class="hljs-string">"id"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [DataMember(Name = <span class="hljs-string"><span class="hljs-string">"name"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [DataMember(Name = <span class="hljs-string"><span class="hljs-string">"vacations"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;Vacation&gt; Vacations { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } [DataContract(Name = <span class="hljs-string"><span class="hljs-string">"departmentData"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DepartmentData</span></span> { [DataMember(Name = <span class="hljs-string"><span class="hljs-string">"name"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [DataMember(Name = <span class="hljs-string"><span class="hljs-string">"office"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Office { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [DataMember(Name = <span class="hljs-string"><span class="hljs-string">"employees"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;EmployeeData&gt; Employees { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br>  Collected data about the user using KeywordQuery, and data about the holidays using a simple CAML request.  Made a custom layout and bundled jQuery with KnockOut implemented the required interface. <br><br><h5>  Result </h5><br>  As a result, we were able to fully satisfy the customer‚Äôs needs in automating the vacation accounting business process.  Now, for the employees of the customer company, vacation fees start with an easy, pleasant process of filling out the application, and not running around with pieces of paper.  They also always have free access to information on the number of vacation days and information on the status of applications submitted. <br><br>  Managers of employees have complete, documented information about the schedule of vacations of their subordinates, can more effectively plan the activities of the unit and, not least, their own vacations. <br><br>  But of course, the human resources department won the most: firstly, the application service for leave is a protection against random errors in numbers, secondly, it significantly reduces paper workflow, which usually inevitably grows around each vacationer, thirdly, integration with BOSS-Kadrovik allows the personnel department to efficiently conduct analytical accounting of personnel and labor costs. </div><p>Source: <a href="https://habr.com/ru/post/213125/">https://habr.com/ru/post/213125/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213107/index.html">[Recommend] Note to Wi-Fi engineer - radio intelligence (podcast and PDF)</a></li>
<li><a href="../213111/index.html">HITACHI Corporate Flash Solution Review</a></li>
<li><a href="../213115/index.html">JPoint 2014 Java Conference FAQ</a></li>
<li><a href="../213119/index.html">Cheating ratings Dungeon Keeper, 500 million installations Temple Run and update iTunes Connect - the main thing for the week for a mobile developer</a></li>
<li><a href="../213123/index.html">Vasya says</a></li>
<li><a href="../213127/index.html">How to get a free professional Wunderlist account for 12 months</a></li>
<li><a href="../213131/index.html">ASUS Zenbook UX301LA Review</a></li>
<li><a href="../213133/index.html">Online conference for .NET developers. March 1</a></li>
<li><a href="../213137/index.html">Yandex announced its own Android firmware</a></li>
<li><a href="../213143/index.html">Escene ES292 IP Phone Review</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>