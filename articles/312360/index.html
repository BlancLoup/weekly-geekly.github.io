<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Duma about the web-API. Part one</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At one point, in the process of creating the next web service, I decided to gather all my knowledge and thoughts on the design of a web API to serve t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Duma about the web-API. Part one</h1><div class="post__text post__text-html js-mediator-article">  At one point, in the process of creating the next web service, I decided to gather all my knowledge and thoughts on the design of a web API to serve the needs of client applications and arrange them as an article or a series of articles.  Of course, my experience does not claim to be absolute, and constructive criticism and additions are more than welcome. <br><br>  Fiction turned out more philosophical than technical, but for fans of the technical part there will be something to think about.  I doubt that I will say something fundamentally new in this article, something that you have never heard, did not read, and did not think about.  Just try to put everything in a single system, first of all in my own head, and this is already worth a lot.  Nevertheless, I will be glad if my fabrications will be useful to you in your practice.  So let's go. <br><a name="habracut"></a><br><h2>  Approaching first: protagonists </h2><br><h3>  Client and server </h3><br>  In this case, we consider the server to be an abstract machine on the network that can receive an HTTP request, process it and return the correct response.  In the context of this article, its physical essence and internal architecture are absolutely not important, whether it be a student laptop or a huge cluster of industrial servers scattered around the world.  It is equally unimportant to us that under his hood, who meets a request at the door, Apache or Nginx, which unknown beast, PHP, Python or Ruby performs its processing and forms the answer, which data repository is used: Postgresql, MySQL or MongoDB .  The main thing is that the server responds to the main rule - to hear, understand and <s>forgive the</s> answer. <br><br>  The client can also be anything that is able to form and send an HTTP request.  Up to a certain point in this article, we also will not be particularly interested in the goals that the client sets himself by sending this request, as well as what he will do with the answer.  The client may be a JavaScript script running in a browser, a mobile application, an evil (or not) demon running on the server, or a too-smart refrigerator (there are already such). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>For the most part, we will talk about the method of communication between the two listed above, such a way that they understand each other, and no one has any questions left.</i> <br><br><h3>  REST philosophy </h3><br>  <b>REST (Representational state transfer)</b> was originally conceived as a simple and unambiguous interface for managing data, which involved only a few basic operations with direct network storage (server): data extraction <b>(GET)</b> , saving <b>(POST)</b> , changing <b>(PUT / PATCH)</b> and deleting <b>(DELETE)</b> .  Of course, this list was always accompanied by such options as error handling in the request (whether the request was made correctly), access control to the data (all of a sudden you should not know this) and validation of incoming data (all of a sudden you wrote nonsense), in general, with all possible checks which the server executes before fulfilling the desire of the client. <br><br>  In addition, REST has a number of architectural principles, a list of which can be found in any other article on REST.  Let's go over them briefly so that they are at hand, and do not have to go anywhere: <br><br>  <b>Server independence from the client</b> - servers and clients can be instantly replaced by others independently of each other, since the interface between them does not change.  The server does not store client states. <br><br>  <b>Uniqueness of resource addresses</b> - each data unit (of any degree of nesting) has its own unique URL, which, in fact, is a unique identifier of the resource. <br><br>  <b>Example:</b> <i>GET / api / v1 / users / 25 / name</i> <br><br>  <b>The independence of the data storage format on the transmission format</b> ‚Äî the server can support several different formats for transmitting the same data (JSON, XML etc), but stores data in its internal format, regardless of which data is supported. <br><br>  <b>Presence in the response of all the necessary metadata</b> - in addition to the data itself, the server must return details of the request processing, for example, error messages, various properties of the resource necessary for further work with it, for example, the total number of records in the collection for the correct display of page-by-page navigation.  We will go through the varieties of resources. <br><br><h3>  What we lack </h3><br>  Classic REST implies that the client works with the server as a flat data storage, while nothing is said about the connectivity and interdependence of the data among themselves.  All of this, by default, falls entirely on the shoulders of the client application.  However, modern subject areas for which data management systems are being developed, be it social services or Internet marketing systems, imply a complex relationship between entities stored in a database.  Support for these links, i.e.  data integrity is the responsibility of the server side, while the client is only an interface to access this data.  So what are we missing from REST? <br><br><h4>  Function calls </h4><br>  The necessity of separating functions as a separate data management method is dictated by the fact that the principles of encapsulation of methods, transaction atomicity and maintenance of data integrity come into force.  In order not to change the data and the connections between them manually, we simply call the function (single object, or collection) function and ‚Äúfeed‚Äù the necessary parameters as an argument.  This operation does not fit the standards of REST, for it there is no special verb, as well as a way to specify the name of the function, which causes us, the developers, to get out who is in that much. <br><br>  <b>The simplest example</b> is user authorization.  We call the <i>POST / api / v1 / auth / login</i> function, pass an object containing the credentials as an argument to it, and in return receive an access key.  What is happening with the data on the server side - we do not care. <br><br>  <b>Another option</b> is to create and break links between entities.  For example, adding a user to a group.  We call the entity function <i>POST / api / v1 / groups / 1 / addUser</i> , we pass the user object as a parameter, we get the result.  An example, of course, is far-fetched, but often when creating connections, additional operations with data on the server side are possible. <br><br>  <b>And there</b> are operations that are generally not directly related to the preservation of data as such, for example, sending notifications, confirming or rejecting any operations (completion of the reporting period, etc). <br><br>  <i>In one of the following articles, I will try to classify these operations and suggest options for possible requests and responses, based on which ones I encountered in practice.</i> <br><br><h4>  Multiple operations </h4><br>  It often happens that the client developers will understand what I mean, that it is more convenient for the client application to create / modify / delete / several homogeneous objects at once in one request, and for each object a server-side verdict is possible.  There are at least a few options: either all changes are made, or they are partially implemented (for part of the objects), or an error has occurred.  Well, there are also several strategies: to apply changes only in case of success for everyone, or to apply partially, or to roll back in case of any error, and this already draws on a full-fledged transaction mechanism. <br><br>  <i>For web-api, striving for the ideal, I would also like to somehow bring such operations into the system.</i>  <i>I will try to do it in one of the sequels.</i> <br><br><h4>  Statistical queries, aggregators, data formatting </h4><br>  It often happens that, on the basis of the data stored on the server, we need to obtain a statistical squeeze or data formatted in a special way: for example, for plotting on the client side.  In fact, this data is generated on demand, to some extent on the fly, and is read-only, so it makes sense to put them in a separate category.  One of the distinguishing features of statistics, in my opinion, is that they do not have a unique ID. <br><br>  <i>I am sure that this is not all that can be encountered in the development of real-world applications, and I will be glad for your additions and corrections.</i> <br><br><h3>  Varieties of data </h3><br><h4>  Objects </h4><br>  The key data type in communication between the client and the server is the object.  In essence, an object is a list of properties and their corresponding values.  We can send an object to the server in a request and get the result of the query as an object.  At the same time, the object will not necessarily be a real entity stored in the database, at least in the form in which it was sent or received.  For example, the credentials for authorization are transmitted as an object, but are not an independent entity.  Even objects stored in the database tend to be clouded with additional intra-system properties, for example, creation and editing dates, various system labels and flags.  Properties of objects can be either their own scalar values, or contain related objects and collections of objects that are not part of the object.  Some properties of objects can be editable, part of the system, read-only, and some can be statistical in nature and be calculated on the fly (for example, the number of likes).  Some properties of the object may be hidden, depending on the rights of the user. <br><br><h4>  Object Collections </h4><br>  Speaking of collections, we mean a kind of server resource that allows you to work with a list of similar objects, i.e.  add, delete, modify objects and select from them.  In addition, the collection can theoretically have its own properties (for example, the maximum number of elements per page) and functions (here I am confused, but this also happened). <br><br><h4>  Scalar values </h4><br>  In their pure form, scalar values ‚Äã‚Äãas a separate entity in my memory were extremely rare.  Usually they appeared as properties of objects or collections, and as such they can be available both for reading and for writing.  For example, a username can be obtained and changed individually by the <i>GET / api / v1 / users / 1 / name</i> .  In practice, this opportunity rarely comes in handy, but if necessary, I would like it to be at hand.  This is especially true of collection properties, for example, the number of records (with or without filtering): <i>GET / api / v1 / news / count</i> . <br><br><h4>  Files </h4><br>  Files are files - they should be considered as a single, unseparated unit.  Another issue is that in most cases when saving a file in a database, a service entity can be created containing the metadata of this file: size, real name, status, etc. <br><br>  <b>To be continued...</b> </div><p>Source: <a href="https://habr.com/ru/post/312360/">https://habr.com/ru/post/312360/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312348/index.html">OpenShift xPaaS version 3. "Hello, world"</a></li>
<li><a href="../312352/index.html">TailSampler - parallel GET requests sent to Apache.JMeter</a></li>
<li><a href="../312354/index.html">For lovers of FPGAs, ASICs, architecture and micro-architecture - more about seminars and conveyors</a></li>
<li><a href="../312356/index.html">Building a mental map for learning</a></li>
<li><a href="../312358/index.html">Study. As an increase in the clickable area of ‚Äã‚Äãa button changes the number of clicks on it.</a></li>
<li><a href="../312362/index.html">How technologies change the quality of life: the development of smart prostheses based on ITMO University</a></li>
<li><a href="../312366/index.html">Small architecture</a></li>
<li><a href="../312368/index.html">How will pay in RuNet in 2020?</a></li>
<li><a href="../312370/index.html">8 enormous changes that in 2017 will cause insomnia of top managers in the field of finance, retail and payments</a></li>
<li><a href="../312372/index.html">Payments in correspondence: chat bots as separate services and fintech solutions inside instant messengers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>