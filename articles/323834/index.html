<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>eMule on Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="eMule on Android 


 This is a story about how it became possible to download files from the eDonkey network to mobile devices running Android. There ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>eMule on Android</h1><div class="post__text post__text-html js-mediator-article"><h2>  eMule on Android </h2><br><img src="https://raw.githubusercontent.com/a-pavlov/jed2k/master/android/docs/mule_common.png" alt="image" align="left"><br><br>  This is a story about how it became possible to download files from the eDonkey network to mobile devices running Android.  There is an opinion that the development of clients for the eDonkey (ED2K) protocol has long been discontinued, but this is not entirely true. <br><br>  Immediately make a reservation - this is not about changes in the eMule program and not even about the mode of this program, but about an independent project.  Why eMule - because this well-known client name has become a household name and is usually mentioned when talking about file sharing using the ED2K protocol. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Details below. <br><a name="habracut"></a><br><h3>  Foreword </h3><br>  A few years ago, I participated in the development of a client for ED2K networks (eDonkey2000).  This network almost forgotten on the territory of Russia is still quite popular in Europe.  The best-known customers are eMule and its cross-platform aMule mod. <br><br>  The eDonkey protocol and the modified eMule client are used on the local Internet provider‚Äôs network to exchange files within the network.  The requirements were the following: adding support for torrents, cross-platform Linux, Windows and Mac, and improved performance.  After researching the code of eMule, aMule and some other clients, it became clear that writing everything from scratch is easier than inserting torrents into existing programs.  It was decided to divide the code into the core, providing interaction with the network and interface.  For the library, the well-known libtorrent-rasterbar served as a prototype, for qBittorrent for gui, especially since he already used the libtorrent-rasterbar.  Thus, the project was implemented using C ++, boost and Qt.  As a transport libtorrent-rasterbar and libed2k, gui are a recycled qBittorrent. <br><br>  For quite a long time, I was considering options for a mobile application.  This could be a QtQuick application, a Java application with a library call via JNI, or simply a native application.  Since I didn‚Äôt have any development experience for mobile platforms at all, but I had Qt experience, the first option was chosen.  I was not going to port the application itself, but its light version does not contain torrents.  Looking ahead, I will say that in the end everything was rewritten in Java and the native application was made. <br><br><h3>  Cross compilation library </h3><br>  For the original project, a separate libed2k library was created, which provides work in ED2K networks. <br><br>  To build libed2k you need a compiled boost, from which I started. <br><br>  In the process of finding a suitable solution, the options were enumerated using the original NDK and using CrystaxNDK.  Crystax possessed the presence of an already assembled boost - the assembly of the boost seemed to me one of the most difficult tasks.  The test application was assembled pretty quickly, but upon launching it fell.  It turned out that the guys who had not yet implemented the system functions were replaced by the developers with a kind of stub, when called, the application receives a signal and drops.  From my point of view, not the best option - the application is going, but does not work.  I could not defeat the reassembly of the Crystax, so I had to turn to the original NDK. <br><br><h3>  Build boost </h3><br>  It turned out to be much simpler than I could have imagined.  In general, it comes down to running the script.  First, checkout the project <a href="https://github.com/moritz-wundke/Boost-for-Android">Boost-for-Android</a> .  You will need compatible versions of boost and NDK.  Download the old version of NDK one more quest - below is a link to the description of how to do it. <br><br>  Actually, this is almost all - it remains to follow the instructions from Boost-for-Android. <br><br><h3>  Build a library </h3><br>  The library uses CMake and that was the problem.  In general, CMake is available in the android studio, but I knew nothing about it and always ran the build from the console.  Here the <a href="https://github.com/taka-no-me/android-cmake/">android-cmake</a> project helped me. <br><br>  For support, it was necessary to add the Android.cmake file, which is almost identical to the Linux configuration and use find_host_package instead of find_package, adding the following stub: <br><br><pre><code class="cmake hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMAND</span></span> find_host_package) <span class="hljs-keyword"><span class="hljs-keyword">macro</span></span>(find_host_package) <span class="hljs-keyword"><span class="hljs-keyword">find_package</span></span>(<span class="hljs-variable"><span class="hljs-variable">${ARGN}</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">endmacro</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>()</code> </pre> <br>  The build process is described in more detail here <a href="https://github.com/a-pavlov/libed2k">libed2k</a> . <br><br><h3>  GUI build </h3><br>  This part had to be done practically from scratch.  To reuse some models and work with the kernel.  Looking at code examples in QML, etc.  I came to the conclusion that writing from scratch is not an option, we must look for ways to simplify development.  I had this method using <a href="https://github.com/papyros/qml-material">qml-material</a> .  Immediately there are the main elements of the mobile application interface made at a high artistic level.  It is all set up simply - either you can use the one recommended by the authors, or simply download and decompose everything into folders in your Qt installation with your hands. <br>  Then everything goes along a more or less standard path - specify the path to the pre-assembled libraries and run the build.  Build did static to simplify deployment. <br><br><h3>  Advertising </h3><br>  Advertising bringing even a small profit motivates to continue development and make improvements.  I will not dwell in detail - a simple Google search according to Qt AdMob provides links to articles that I used when embedding advertising in an application. <br><br>  I will describe the account verification process.  AdMob has a convenient withdrawal;  The threshold from which you can withdraw funds starts at $ 100.  But there is one obstacle - the account must be verified.  Verification occurs by sending a real paper card with a code in the mail.  There are three attempts with an interval of about a month.  I waited longer, afraid to spend all attempts in vain, but so did not wait.  However, everything ended well, which is why I decided to mention the advertisement.  You do not have to wait for postcards more than the interval offered by the admob - after all the attempts have been exhausted and the deadline has come out, you will be able to verify simply by sending a scan of the document to them by mail.  In the scan, you can add watermark - it will still be accepted. <br><br><h3>  Publication </h3><br>  A few words about publishing on Google Play.  I describe on the example of Google Play, because now it is an unconditional monopolist.  The closest competitors such as Amazon unfortunately did not stand close by. <br><br>  So, the application is ready, the account is paid, the package is assembled - you can publish.  For me, the publication was presented as a kind of simple, automatic stage, which would end as if by itself.  Fortunately, this is basically true, especially when publishing updates - you just need to prepare a description and screenshots.  However, before clicking the ‚Äúpublish‚Äù button, it is important to read the publication rules from Google, otherwise there is a considerable likelihood to read them after receiving the letter about blocking the application.  Read the documentation was lazy and I studied it after the lock.  Google does not send an exact description of the violation - just a section or sections of the rules that were violated, you are asked to determine for yourself what exactly the publication did not pass the test, but this is not so simple. <br><br>  And finally - use alpha and beta versions, it is very convenient.  Everything is the same as with the release, but you can configure accessibility and users will not be able to publicly evaluate the application.  It helps to avoid negative assessments at the very beginning. <br><br>  Almost my only PR campaign is an announcement on the official eMule forum.  I did not make any further promotion attempts.  Nevertheless, the number of installations gradually grew.  After the first update, the program was banned by Google Play.  Yes, it happens the same way - you release an update and get an email about blocking the application.  The reason for blocking is impersonation of another person, or copyright infringement.  Attempt to appeal did not bring results.  The screenshots of the program with Roxette download and the program icon itself, assembled from pieces of the Android logo, came under suspicion.  I was not very upset, moreover, this ban encouraged me to add ads, draw icons and some other improvements.  Re-publishing the application with a new icon and edited screenshots, as well as a new name solved the problem.  Looking ahead, I will say that maybe the problem was in the title with the mention ‚Äúdonkey‚Äù, because the following application with the name jDonkey was also banned.  During the year, updates were released, support for Kademlia was added. <br><br>  The number of installations has grown over the course of a year, but is now beginning to fall gradually.  Perhaps this is due to the transition of users to the Java version or to the general outflow of users from the ED2K network.  In parallel, published a paid version without ads - quite unexpectedly, but it was sold. <br><br>  In general, the application has shown itself to be quite stable. <br><br><h3>  Conclusion </h3><br>  Actually, this is all about the C ++ application on Android.  A bunch of Qt / C ++ works pretty well on Android.  Using the components of the qml-material, you can quickly build beautiful interfaces.  Among the shortcomings is the long loading of the application and more complex integration with the system.  As I mentioned above, the application was rewritten in Java and only this option is being developed.  If the article is interesting, I will write more about the internal structure of the eDonkey protocol, what is Kademlia (DHT) and how it works. <br><br><h3>  Links </h3><br><ul><li>  <a href="http://www.libtorrent.org/">libtorrent</a> </li><li>  <a href="https://github.com/qbittorrent/qBittorrent">qBittorrent</a> </li><li>  <a href="https://github.com/qmule/libed2k">libed2k</a> </li><li>  <a href="https://github.com/papyros/qml-material">qml-material</a> </li><li>  <a href="http://stackoverflow.com/questions/6849981/where-do-i-find-old-versions-of-android-ndk">How to download old NDK</a> </li><li>  <a href="https://github.com/moritz-wundke/Boost-for-Android">Boost-for-Android</a> </li><li>  <a href="https://github.com/taka-no-me/android-cmake/">android-cmake</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/323834/">https://habr.com/ru/post/323834/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323824/index.html">Accelerate Home ESXi 6.5 with SSD Caching</a></li>
<li><a href="../323826/index.html">Data centers as art: data centers at the bottom of the ocean</a></li>
<li><a href="../323828/index.html">findNclean: find and clean</a></li>
<li><a href="../323830/index.html">[NeoQuest2017] "MULTIPSPORT!" And pink spacesuit</a></li>
<li><a href="../323832/index.html">From monoids to de Morgan algebras. We build abstractions on Haskell</a></li>
<li><a href="../323836/index.html">Banal AB-test</a></li>
<li><a href="../323838/index.html">Pink spacesuit, cryptocurrency and genetically modified iOS: tasks of the online-stage NeoQUEST-2017 and some statistics</a></li>
<li><a href="../323840/index.html">Webinar: Julia - A fresh approach to numerical computing and data science</a></li>
<li><a href="../323842/index.html">Prime investor Runet and its packages</a></li>
<li><a href="../323846/index.html">Create React App (aka React Scripts) and server rendering with Redux and Router</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>