<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Descriptive Programming in QuickTest Pro</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="QuickTest Professional is a popular tool for automating functional testing. To a large extent, its popularity is due to the presence of a user activit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Descriptive Programming in QuickTest Pro</h1><div class="post__text post__text-html js-mediator-article">  QuickTest Professional is a popular tool for automating functional testing.  To a large extent, its popularity is due to the presence of a user activity recorder in it, which allows you to record user actions and convert them into a script. <br>  Objects with which the user interacts are automatically identified by QTP and stored in a special repository - repository.  When saved to the repository, QTP automatically saves the identification properties of the object, but does not always do this correctly.  For example, if there are several tables on a web page (even if each of them has its own ID), QTP identifies them by sequence number.  This method of identifying objects causes problems when playing AutoTests.  Moreover, many objects do not get into the repository at all when writing.  This is due to many reasons, the most frequent of which is complex layout or layout with the use of DIV-s.  However, there is a way to access the objects of the application under test at the stage of script execution, bypassing the access to the repository. <br>  This method is called Descriptive Programming (DP). <br><br><a name="habracut"></a><br>  The main idea of ‚Äã‚ÄãDP is the search and circulation of objects by their identification properties.  For DOM elements, this can be ID, Name, Tag, Inner Text, etc.  For example, to access the button with Id equal to SubmitBtn, use the following construction: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">WebButton( <font color="#A31515">"html tag:=button"</font> , <font color="#A31515">"html id:=SubmitBtn"</font> )</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Calls to QTP objects are hierarchical.  You can combine access to the repository and DP, but with one limitation - if DP was used at some level of the hierarchy, then you cannot access the repository at the next levels of the hierarchy.  For example: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Browser( <font color="#A31515">"Browser"</font> ).Page( <font color="#A31515">"Page"</font> ).WebElement( <font color="#A31515">"table1"</font> ).WebElement( <font color="#A31515">"html tag:=table"</font> , <font color="#A31515">"html id:=tbl_grid"</font> ) <font color="#008000">'</font> <br> <br> Browser( <font color="#A31515">"Browser"</font> ).Page( <font color="#A31515">"Page"</font> ).WebElement( <font color="#A31515">"html id:=table1"</font> ).WebElement( <font color="#A31515">"tbl_grid"</font> ) <font color="#008000">'</font> <br> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  All search constructions in DP are regular expressions. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Browser( <font color="#A31515">"Browser"</font> ).Page( <font color="#A31515">"Page"</font> ).Link( <font color="#A31515">"inner text:=Subject[\d]{1,2}"</font> ) <font color="#008000">' , inner text   Subject,      .</font> <br></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now let's play;). <br>  We need QTP, a 14-day trial version can be obtained <a href="https://h10078.www1.hp.com/cda/hpdc/navigation.do%3Faction%3DdownloadBinStart%26caid%3D42829%26cp%3D54_4000_18%26zn%3Dbto%26filename%3DT6512EAET">here</a> (HP Passport is required, registration is free). <br><br>  As the object of automation, select Calculator again. <br>  1. Run QTP. <br>  2. Create a new test <br>  3. Press the "Record" button. <br>  4. In the window that appears, go to the Windows Application tab, click the "+" in it and enter calc.exe in the Application input field <br><img src="http://yennifer.ru/cat/habr/record_run_settings.PNG"><br><br>  5. Click OK. <br>  6. In the automatically launched calculator, press the buttons 1,2, *, 5, = <br>  7. In the result window we see 60 <br>  8. Press Ctrl + F12 to create the Test Output Value. <br>  9. In the window that appears, put a tick in front of the text property; by default, the value is saved in a cell of the data table.  Click OK <br><img src="http://yennifer.ru/cat/habr/outval_props.PNG"><br><br>  10. Close the Calculator. <br>  11. Click Stop record in QTP <br><br>  What did we get as a result?  On the Expert View tab - our script <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Window( <font color="#A31515">"Calculator"</font> ).WinButton( <font color="#A31515">"1"</font> ).Click <br> Window( <font color="#A31515">"Calculator"</font> ).WinButton( <font color="#A31515">"2"</font> ).Click <br> Window( <font color="#A31515">"Calculator"</font> ).WinButton( <font color="#A31515">"*"</font> ).Click <br> Window( <font color="#A31515">"Calculator"</font> ).WinButton( <font color="#A31515">"5"</font> ).Click <br> Window( <font color="#A31515">"Calculator"</font> ).WinButton( <font color="#A31515">"="</font> ).Click <br> Window( <font color="#A31515">"Calculator"</font> ).WinEdit( <font color="#A31515">"Edit"</font> ).Output CheckPoint( <font color="#A31515">"Edit"</font> ) <br> Window( <font color="#A31515">"Calculator"</font> ).Close <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  For one test script - great.  But if we need to check not only multiplication, but also division, addition.  And there are also negative numbers ... The head-on option - to write down your Action for each case, has a significant drawback - it is difficult to maintain.  A better option is to add all the buttons of the calculator to the repository and click on them programmatically. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">A = <font color="#A31515">"1"</font> <br> <br> Window( <font color="#A31515">"Calculator"</font> ).WinButton(A).Click <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The option is not bad, but it is very difficult to maintain it - if you add or remove buttons, you need to change the repository of objects. <br><br>  And here DP comes to help us - each button has an inscription, which means it is possible to identify a button by it. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Window( <font color="#A31515">"Calculator"</font> ).WinButton( <font color="#A31515">"text:=2"</font> ).Click</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  And in this case, we can write a universal procedure for pressing a button.  Moreover, we can make a unified action to check the calculations of the calculator. <br><br>  Create a new Action - Insert-&gt; Call to new Action.  Give her the name Calc_Tests and uncheck Reusable Action.  Move the Calc_Tests in the Test Flow window above Action1. <br>  Next, we need to add parameters to the Action that we originally had, by default Action1.  In the TestFlow window, click on it with the right button-&gt; Action properties-&gt; Parameters.  Add the input string parameters OperList and Expected and the output string parameter ActualResult. <br>  We modify the source code for Action1 as follows: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">operList = Parameter( <font color="#A31515">"OperList"</font> ) <font color="#008000">'    OperList</font> &lt;br&gt;expectedRes = Parameter( <font color="#A31515">"Expected"</font> ) <font color="#008000">'    Expected</font> &lt;br&gt;&lt;br&gt;operArr = split(operList, <font color="#A31515">";"</font> ) <font color="#008000">'       ;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">For</font> <font color="#0000ff">each</font> oper <font color="#0000ff">in</font> operArr <font color="#008000">'    </font> &lt;br&gt;  Button_Click Window( <font color="#A31515">"Calculator"</font> ), oper <font color="#008000">'    </font> &lt;br&gt; <font color="#0000ff">Next</font> &lt;br&gt;&lt;br&gt;actual = rtrim(Window( <font color="#A31515">"Calculator"</font> ).WinEdit( <font color="#A31515">"Edit"</font> ).GetROProperty( <font color="#A31515">"text"</font> )) <font color="#008000">'   </font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">If</font> actual &lt;&gt; expectedRes <font color="#0000ff">Then</font> &lt;br&gt;  reporter.ReportEvent micFail, <font color="#A31515">"Calc Test"</font> , <font color="#A31515">"Expected: "</font> &amp; expectedRes &amp; <font color="#A31515">" &lt;&gt; Actual: "</font> &amp; actual <font color="#008000">'  </font> &lt;br&gt; <font color="#0000ff">else</font> &lt;br&gt;  reporter.ReportEvent micPass, <font color="#A31515">"Calc Test"</font> , <font color="#A31515">"Expected: "</font> &amp; expectedRes &amp; <font color="#A31515">" = Actual: "</font> &amp; actual&lt;br&gt; <font color="#0000ff">End</font> <font color="#0000ff">If</font> &lt;br&gt;&lt;br&gt;&lt;br&gt;Button_click Window( <font color="#A31515">"Calculator"</font> ), <font color="#A31515">"C"</font> <font color="#008000">'  </font> &lt;br&gt;Button_click Window( <font color="#A31515">"Calculator"</font> ), <font color="#A31515">"MC"</font> <font color="#008000">'  </font> &lt;br&gt;&lt;br&gt;Parameter( <font color="#A31515">"ActualResult"</font> ) = actual <font color="#008000">'    </font> &lt;br&gt;&lt;br&gt; <font color="#008000">'    ,      text</font> &lt;br&gt; <font color="#0000ff">Sub</font> Button_click(Obj,btn_label) &lt;br&gt; <font color="#0000ff">If</font> Obj.WinButton( <font color="#A31515">"text:="</font> &amp; btn_label).Exist <font color="#0000ff">then</font> <font color="#008000">'   </font> &lt;br&gt;    Obj.WinButton( <font color="#A31515">"text:="</font> &amp; btn_label).Click <font color="#008000">'  </font> &lt;br&gt; <font color="#0000ff">end</font> <font color="#0000ff">if</font> &lt;br&gt; <font color="#0000ff">End</font> <font color="#0000ff">Sub</font> &lt;br&gt;&lt;br&gt;</font> &lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Go to Calc_Tests and insert the call to Action1: Insert-&gt; Call to Existing Action‚Äì&gt; Action1 <br>  Change the Action1 call string to <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">RunAction <font color="#A31515">"Action1"</font> , oneIteration, <font color="#A31515">"1;2;\*;5;="</font> , <font color="#A31515">"60,"</font> ,actual</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The * character is escaped because it is a special regular expression symbol, and as written above: all DP expressions are regular expressions. <br><br>  You can add another case to check.  Calc_tests code might look like this: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">Dim</font> actual&lt;br&gt;RunAction <font color="#A31515">"Action1"</font> , oneIteration, <font color="#A31515">"1;2;\*;5;="</font> , <font color="#A31515">"60,"</font> ,actual&lt;br&gt; <font color="#008000">'  *  ,</font> &lt;br&gt; <font color="#008000">' *      .</font> &lt;br&gt;RunAction <font color="#A31515">"Action1"</font> , oneIteration, <font color="#A31515">"2;2;\+;5;="</font> , <font color="#A31515">"27,"</font> ,actual <font color="#008000">'     +</font> &lt;br&gt;Window( <font color="#A31515">"text:=Calculator"</font> ).Close&lt;br&gt;ExitTest&lt;br&gt;</font> &lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  If you run the test, the calculator will perform two calculations and the autotest compares the expected and obtained results.  As a result of the execution, we should receive a performance report with green check marks;) <br><img src="http://yennifer.ru/cat/habr/positive_result.PNG"><br>  Descriptive programming helps to solve problems that in the traditional approach are either unsolvable, or very laborious. <br><br>  <strong>PS</strong> all involved in the holiday - Testers Day. <br><br>  <strong>PPS</strong> thanks for the karma, transferred to "Testing". <br><br></div><p>Source: <a href="https://habr.com/ru/post/69138/">https://habr.com/ru/post/69138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../69130/index.html">Can a MacBook cost 700 dollars?</a></li>
<li><a href="../69131/index.html">Croco? - draw, guess</a></li>
<li><a href="../69133/index.html">By post: ‚ÄúConsumer protection in Russia: We are not the last‚Äù The flip side of the coin</a></li>
<li><a href="../69136/index.html">HTTP server in 15 minutes</a></li>
<li><a href="../69137/index.html">The announcement of the development of a new generation of fonts Georgia and Verdana</a></li>
<li><a href="../69139/index.html">Truckers 3: Russian Adventure in California (interview)</a></li>
<li><a href="../69141/index.html">It glows in the dark</a></li>
<li><a href="../69142/index.html">Little masterpiece</a></li>
<li><a href="../69143/index.html">IBM Rational AppScan will give hackers a rebuff</a></li>
<li><a href="../69145/index.html">Oxygen phone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>