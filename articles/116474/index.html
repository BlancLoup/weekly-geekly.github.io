<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing the OCI8 and PDO_OCI Extensions for PHP5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Currently I work for a company that loves to use Oracle projects in PHP projects, sometimes with version 11g. 

 Most of the developers of this compan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing the OCI8 and PDO_OCI Extensions for PHP5</h1><div class="post__text post__text-html js-mediator-article">  Currently I work for a company that loves to use Oracle projects in PHP projects, sometimes with version 11g. <br><br>  Most of the developers of this company running under Windows.  Over the past month, several of them have decided to join Linux and have set themselves Ubuntu.  After a few days after installing the OS itself, the guys were faced with the task of installing PHP drivers for working with Oracle DBMS - OCI8 and PDO_OCI based on Oracle instant client 11.2, which they could not solve on their own. <br><br>  I did not find a detailed, fully working manual in Russian, by which a newbie in Linux could perform all the manipulations himself.  As a result, I had to do a series of the same actions on their machines several times and write a manual, which I present to you. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The manual is written for users of Ubuntu Linux, but with some changes suitable for users of most Linux'ov. <br><br><a name="habracut"></a><br><h4>  Preparing to install </h4><br><ol><li>  You should be able to execute commands under the administrator; </li><li> You must have php5 installed with the following packages (installation command with list): <br> <code>sudo apt-get install php5 php5-dev php-pear php5-cli <br> sudo pecl install pdo</code> </li> <li>  You must have the libaio1 library installed: <br> <code>sudo apt-get install libaio1</code> </li> </ol><br><h4>  Installing Oracle instant client </h4><br>  Download Oracle's Oracle client from the official site <a href="http://www.oracle.com/technetwork/database/features/instant-client/index-097480.html">http://oracle.com</a> for its processor architecture and OS. <br>  For Linux instant client comes in two versions: <br><ul><li>  RPM package - Linux, CentOS, Fedora, Red Hat Enterprise Linux, Mandriva Linux, SUSE Linux, etc.  who has RPM support; </li><li>  ZIP archive for everyone else. </li></ul><br>  You need to download 2 files: <br><ul><li>  instantclient-basic - Oracle instant client itself </li><li>  instantclient-sdk - a set of libraries for developing applications for Oracle instant client </li></ul><br>  You can also download: <br><ul><li>  instantclient-sqlplus - <a href="http://ru.wikipedia.org/wiki/SQL*Plus">SQL * Plus</a> </li></ul><br>  Create a directory in which the Oracle instant client files will be located (the / opt directory reserved for additional software packages is good for this): <br> <code>sudo mkdir -p /opt/oracle/</code> <br> <br>  Move the downloaded files to / opt / oracle and go to the destination folder (let's say that you downloaded the ‚Äúzip archives‚Äù to the ‚Äúdownloads‚Äù folder of your user): <br> <code>sudo mv ~/downloads/instantclient-*.zip /opt/oracle/ <br> cd /opt/oracle/</code> <br> <br>  Unzip all downloaded archives: <br> <code>sudo unzip instantclient-basic-*-*.zip <br> sudo unzip instantclient-sdk-*-*.zip</code> <br>  If you downloaded <a href="http://ru.wikipedia.org/wiki/SQL*Plus">SQL * Plus</a> : <br> <code>sudo unzip instantclient-sqlplus-*-*.zip</code> <br> <br>  As a result, in the / opt / oracle directory was created, for the Oracle instant client 11.2.0.2.0, the instantclient_11_2 directory.  Rename this directory to instantclient (if you have another version / directory, change the command) and go to it: <br> <code>sudo mv instantclient_11_2 instantclient <br> cd instantclient</code> <br> <br>  Next, you need to create several additional directories and symbolic links for the normal operation of the client (pay attention to the version and if you have another change commands): <br> <code>sudo ln -s /opt/oracle/instantclient/libclntsh.so.* /opt/oracle/instantclient/libclntsh.so <br> sudo ln -s /opt/oracle/instantclient/libocci.so.* /opt/oracle/instantclient/libocci.so <br> sudo ln -s /opt/oracle/instantclient/ /opt/oracle/instantclient/lib <br> <br> sudo mkdir -p include/oracle/11.2/ <br> cd include/oracle/11.2/ <br> sudo ln -s ../../../sdk/include client <br> cd - <br> <br> sudo mkdir -p lib/oracle/11.2/client <br> cd lib/oracle/11.2/client <br> sudo ln -s ../../../ lib <br> cd -</code> <br> <br>  Create a configuration file in which the directory will be specified to search for the Oracle instant client libraries, and include it: <br> <code>echo /opt/oracle/instantclient/ | sudo tee -a /etc/ld.so.conf.d/oracle.conf <br> sudo ldconfig</code> <br> <br>  Since there is no / usr / include / php directory in Ubuntu, and the client is still looking for it, we will create a symbolic link to its php5 equivalent: <br> <code>sudo ln -s /usr/include/php5 /usr/include/php</code> <br> <br><h4>  Install OCI8 </h4><br>  After all our manipulations, the oci8 extension is remarkably installed using the <a href="http://www.php.net/manual/ru/install.pecl.php">pecl command</a> : <br> <code>sudo pecl install oci8</code> <br>  we are asked to enter the path to the Oracle instant client, to which we must respond: <br> <code>instantclient,/opt/oracle/instantclient</code> <br> <br>  Create an extension connection file: <br> <code>echo "; configuration for php oci8 module" | sudo tee /etc/php5/conf.d/oci8.ini <br> echo extension=oci8.so | sudo tee -a /etc/php5/conf.d/oci8.ini</code> <br> <br><h4>  Set PDO_OCI </h4><br>  To install PDO_OCI, we first need to download it from <a href="http://pear.php.net/">the pear repository</a> . <br>  Update the pear package list: <br> <code>sudo pecl channel-update pear.php.net</code> <br> <br>  Download and place the archive in the temporary directory: <br> <code>sudo mkdir -p /tmp/pear/download/ <br> cd /tmp/pear/download/ <br> sudo pecl download pdo_oci</code> <br> <br>  Extract the contents of the archive and go to it: <br> <code>sudo tar xvf PDO_OCI*.tgz <br> cd PDO_OCI*</code> <br> <br>  Here we need to adjust the file config.m4, since it does not contain data about our version of Oracle instant client, the latest changes are dated 2005.  Run your favorite editor and make changes marked with "+" (note the version and if you have another one, change the lines): <br> <code>sudo vim config.m4</code> <br> <br>  The following is a diff of two files: <br> <code>*************** <br> *** 7,12 **** <br> --- 7,14 ---- <br> if test -s "$PDO_OCI_DIR/orainst/unix.rgs"; then <br> PDO_OCI_VERSION=`grep '"ocommon"' $PDO_OCI_DIR/orainst/unix.rgs | sed 's/[ ][ ]*/:/g' | cut -d: -f 6 | cut -c 2-4` <br> test -z "$PDO_OCI_VERSION" &amp;&amp; PDO_OCI_VERSION=7.3 <br> + elif test -f $PDO_OCI_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.11.2; then <br> + PDO_OCI_VERSION=11.2 <br> elif test -f $PDO_OCI_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.10.1; then <br> PDO_OCI_VERSION=10.1 <br> elif test -f $PDO_OCI_DIR/lib/libclntsh.$SHLIB_SUFFIX_NAME.9.0; then <br> *************** <br> *** 119,124 **** <br> --- 121,129 ---- <br> 10.2) <br> PHP_ADD_LIBRARY(clntsh, 1, PDO_OCI_SHARED_LIBADD) <br> ;; <br> + 11.2) <br> + PHP_ADD_LIBRARY(clntsh, 1, PDO_OCI_SHARED_LIBADD) <br> + ;; <br> *) <br> AC_MSG_ERROR(Unsupported Oracle version! $PDO_OCI_VERSION) <br> ;; <br> *************** <br></code> <br>  Preparing the environment for php extension using the <a href="http://php.net/manual/ru/install.pecl.phpize.php">phpize command</a> (pay attention to the version, if you change it for another): <br> <code>sudo phpize</code> <br> <br>  Configure the package installer and install the package (note the version, if you have another change): <br> <code>sudo ./configure --with-pdo-oci=instantclient,/opt/oracle/instantclient/,11.2 <br> sudo make <br> sudo make install <br></code> <br><br>  Create a connection file for it: <br> <code>echo "; configuration for php PDO_OCI module" | sudo tee /etc/php5/conf.d/pdo_oci.ini <br> echo extension=pdo_oci.so | sudo tee -a /etc/php5/conf.d/pdo_oci.ini</code> <br> <br><h4>  Summing up </h4><br>  Restart apache and check for installed extensions: <br> <code>sudo /etc/init.d/apache2 restart <br> php -m</code> <br> <br><h4>  Conclusion </h4><br>  The manual is based on this <a href="http://ubuntuforums.org/showthread.php%3Ft%3D1207665">post</a> , which has been slightly reworked - bugs fixed and additions made. <br><br>  I hope the article will be useful not only to my colleagues. </div><p>Source: <a href="https://habr.com/ru/post/116474/">https://habr.com/ru/post/116474/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116462/index.html">Gitimmersion - Git Fundamentals Course</a></li>
<li><a href="../116464/index.html">DLP module in the Internet gateway: how, why and why?</a></li>
<li><a href="../116465/index.html">User research and involvement (Dmitry Satin's lecture at the Higher School of Economics)</a></li>
<li><a href="../116467/index.html">50% of Twitter content is created by less than 1% of service users.</a></li>
<li><a href="../116472/index.html">Google launches Talk Guru chat bot</a></li>
<li><a href="../116477/index.html">DDoS attacks will enter the Criminal Code (Articles 272-274)</a></li>
<li><a href="../116479/index.html">Yandex Search API for .Net</a></li>
<li><a href="../116480/index.html">‚ÄúWhole life‚Äù: is this your coaching again?</a></li>
<li><a href="../116481/index.html">The FBI asks for help in deciphering a 1999 message</a></li>
<li><a href="../116482/index.html">The Large Hadron Collider is 20 years old</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>