<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lexical scope of functions in JavaScript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After reading recent posts for newbies to JavaScript, I decided to write a small topic about one interesting question that none of the authors have ye...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lexical scope of functions in JavaScript</h1><div class="post__text post__text-html js-mediator-article">  After reading recent posts for newbies to JavaScript, I decided to write a small topic about one interesting question that none of the authors have yet touched, namely, the question about the scope of functions in JavaScript. <br><a name="habracut"></a><br>  As Wikipedia says: ECMAScript functions have lexical scope.  This means that the scope is determined at the time the function is defined (as opposed to the dynamic scope, in which the scope is determined at the time the function is called). <br>  Actually, everything is written quite briefly and clearly, but let's analyze in practice such an example: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> y; }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> z = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t(); }; z(x);</code> </pre> <br>  I will not try your patience, as a result we will get the number 5, although it is possible for some readers this result will be unexpected.  Let's see what is the matter, but first a small lyrical digression. <br><br>  In JavaScript, all functions are closures (lexical closures).  This means that the function is not just a fragment of executable code, but also the context in which this fragment will be executed.  In JavaScript, this context is a kind of chain.  The first link in the chain is the function call object, which includes all local variables, and the object reference in the context of which the function was <b>declared</b> , in turn, this object can refer to the parent object (if the higher function is declared inside another function), and so Further.  To make it easier to understand what it is about, I will give an excellent illustration (taken <a href="http://odetocode.com/Blogs/scott/archive/2007/07/10/closure-on-javascript-closures.aspx">from here</a> ) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/d29/353/e74/d29353e749f70323eb9aa14d86052e8c.png"><br><br>  In the picture you can see how the variables will be searched.  It looks like this: z is a local variable of the function, it will be found directly in the call object, x is not in the call object, so the search will be done higher up the chain.  The search for variables is performed up to the global object, if the variable in it is not found, the result will be the value undefined. <br><br>  So, now we are ready to analyze the first example in detail. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    "y" = 5 var y = 5; //     , //      "" , //       . var x = function(){ //    "y". // ..   "y" , //       //    (  ) return y; }; //       , //       var z = function(t){ //      "y"=10, //     "y"=5 var y = 10; //    , //    . // ,        //      ! return t(); }; //   , //      "x"  . //      "x"! z(x);</span></span></code> </pre><br><br>  I read the example again and realized that I still did not understand anything.  What is going on here?  As mentioned above, functions in JavaScript are closures, that is, they store the context in which they were declared.  Thus, keeping the function in a variable, we involuntarily save the context in which it was declared, and it in turn is a chain of a call object containing local variables and from a global object standing in the chain to a higher level. <br><br>  There is one subtlety.  The context (chain of scopes) in which the function was declared is roughly a chain of <b>objects</b> .  This is very important to understand, since objects in JavaScript are stored as links, that is, each element of the chain refers to a specific object (it refers to and does not contain its copy), which may change during the execution of the program.  That is, an object from the scope chain can be changed by some external functions, while all changes will be available and, as part of the function, the changeable object is included in whose chain of scope.  In other words, the chain of scopes is fixed at the moment of defining the function, but the list of properties defined in this chain is not fixed.  The scope chain is subject to change, and the function can access all elements that exist at the time of execution.  This is a very important paragraph, if you are not sure that you understood it exactly, read it again.  Once you realize everything written in it, you will open the door to creating powerful effects, which are usually called <b>closures</b> . <br><br>  Thus, at the moment when we try to execute the function x (), the following will happen - the JavaScript interpreter will try to find a variable with the name y in the call object, does not find it, and switches to searching in the global object.  In the global object, a variable with the name y exists, since  we declared it right before the function declaration. <br><br>  Since the chain of scopes of the function x is already fixed, the values ‚Äã‚Äãof the local variables of the function z, inside which x () eventually starts, are still not used, since when executing the function x (), the variables will be searched within the scope of the fixed at the time of the announcement functions. <br><br>  Instead of conclusions: I hope the example described above clearly demonstrates what a lexical scope is and how it differs from a dynamic one. <br><br>  In order to make sure that you realize the beauty of closures and understand what the lexical scope of functions is, consider another small example: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> y; }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> z = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> t(); }; y = <span class="hljs-number"><span class="hljs-number">15</span></span>; z(x);</code> </pre><br><br>  PS In the comments, the respected haje-user <a href="https://habrahabr.ru/users/jeje/" class="user_link">jeje</a> gives an interesting example, which is also worth considering: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> y; }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> z = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function">)</span></span>{ y = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   ,      return t(); }; z(x);</span></span></code> </pre><br><br>  This example differs from the original one in that inside the z () function the variable <i>y is</i> used without the keyword var.  As a result of this example, we get the output number 10. Why is this happening?  In fact, we have already answered this question, this happens because inside the function z () we no longer declare a local variable <i>y</i> , but refer to the global one. <br><br>  This example raises a very important question - the question of implicitly declaring variables in JavaScript.  When inside a function we use a variable without the var keyword, the interpreter performs the following operations: A search is performed on the call object (local variable search), if the variable is not found, the search is performed on the object located higher in the chain of visibility and so on up to the global object.  If a variable is found in any object, its value will be changed, so access to global variables is provided.  There is only one BUT: if the variable is not found in any object in the chain of scopes, the JavaScript interpreter will automatically declare the variable being used and assign it to the variable, and the variable will be created in the <b>global</b> scope.  Given this, special attention should be paid to the function variables used without the var keyword.  There are other interesting features to the explicit and implicit declaration of variables, but this is a topic for another micro-topic. </div><p>Source: <a href="https://habr.com/ru/post/149526/">https://habr.com/ru/post/149526/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149518/index.html">HTML5 Audio is a state of affairs. Part 2</a></li>
<li><a href="../149519/index.html">Once a plank, two plank - there will be a ladder ...</a></li>
<li><a href="../149520/index.html">We use Google Cloud Print without Google Chrome</a></li>
<li><a href="../149521/index.html">Wikileaks encrypted file insurance (64 GB)</a></li>
<li><a href="../149525/index.html">Kim Dotcom returns, hints at the resurgence of MegaUpload</a></li>
<li><a href="../149531/index.html">RuTracker hacked</a></li>
<li><a href="../149533/index.html">Horoshist: Sony Xperia Sola review</a></li>
<li><a href="../149534/index.html">Opinion MTS on the abolition of domestic roaming</a></li>
<li><a href="../149537/index.html">Spy glasses do it yourself</a></li>
<li><a href="../149539/index.html">Hard prioritization, or the first 5 steps to an excellent application for Windows 8. Navigation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>