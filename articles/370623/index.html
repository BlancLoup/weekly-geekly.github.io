<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic room lighting based on Arduino controller</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, dear readers, continuing the topic of the introduction of Arduino controllers, I would like to share with you my version of the automa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic room lighting based on Arduino controller</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, dear readers, continuing the topic of the introduction of Arduino controllers, I would like to share with you my version of the automatic room lighting project.  The article is provided more for newcomers like me than for experienced radio amateurs.  Perhaps for someone this article will become the basis for their own projects, well, I will be pleased to read the strict criticism, your options for performance or just support in the comments. <br><a name="habracut"></a><br>  The goal of the project: to mount two circuits for lighting the room on the second floor of the house, provided that it is controlled manually and automatically, at minimal cost. <br><br><h4>  <font color="blue">Planning</font> </h4><br>  As a motion sensor, the choice fell on the HC-SR50 pyroelectric infrared sensor, primarily due to the large detection angle, of the order of 120 degrees.  We will not dwell on it in more detail, the only thing to say is that the jumper on the sensor is set to <b>H.</b>  In this mode, each time the sensor triggers, a logical unit remains at the output.  By the number of sensors, it all depends on the room itself, in my case two is quite enough. <br><br>  The signal from the sensors will come to <b>one</b> of two relays in one module, which will include the central lighting circuit, but in manual mode we will manage two relays.  One is responsible for the central, the second for the peripheral circuit. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      One of the conditions of automatic control will be to check the level of illumination outdoors.  We will do this with the help of a sensor based on the LM393 chip. <br><br>  To control in manual mode, we will assemble a small board with two clock buttons for easy installation. <br><br><img src="https://habrastorage.org/web/83a/102/1b7/83a1021b7b584e5081ce518511ace1bd.png"><br><br>  The jumper <b>JD-VCC - VCC</b> is removed, if a separate power supply is applied to the relay coil, as I understand it, this is done for galvanic isolation.  To switch the relay, inputs <b>IN1</b> or <b>IN2</b> must be pulled to the ground. <br><br><img src="https://habrastorage.org/web/8d1/a32/57b/8d1a3257b9784bd3b4b25df21f27d942.png"><br><br><h4>  <font color="blue">Preparation for installation</font> </h4><br>  The power supply at my disposal was only the voltage of 220 AC and 12 DC.  Therefore, to power the controller itself, relays and sensors using a simple scheme to reduce the voltage to five volts. <br><br><img src="https://habrastorage.org/web/23d/85d/eb7/23d85deb7dea49b1ae60c549b2fd9b43.jpg"><br><br>  The boards are drawn in the Sprint-Layout program, quite simple and in fact the controller board is needed in order to conveniently connect signals. <br><br><img src="https://habrastorage.org/web/ff8/b22/433/ff8b224332dc468ca7adcd4e50cdf75d.JPG"><br><br><img src="https://habrastorage.org/web/8e4/989/039/8e49890399cf41128093a9fc7ca1ed1d.JPG"><br><br>  The boards are made by everyone's favorite <abbr title="Laser-iron technology">LUT</abbr> technology. <br><br><img src="https://habrastorage.org/web/3f4/793/acc/3f4793acc6924dc0b7f6f27ac551dc26.jpg"><br><br>  To protect the illumination sensor from light from the room side, in order to prevent the sketch algorithm from working incorrectly, it was decided to hide it in a piece of polypropylene tube.  Hole in the end for the possibility of adjusting the sensor. <br><br><img src="https://habrastorage.org/web/a1e/014/700/a1e01470026148fd8fcb2784dde3889d.jpg"><br><br><h4>  <font color="blue">Drawing a sketch</font> </h4><br><div class="spoiler">  <b class="spoiler_title">Sketch</b> <div class="spoiler_text"><code>//   . <br> //  . <br> #define Sensor_1 10 //    -SR501. <br> #define Sensor_2 11 //    -SR501. <br> #define D0 3 //   . <br> int Relay[2] = {8, 9}; //  . <br> int Button[2] = {5, 6}; //  . <br> // . <br> boolean Start_Sensor = false; //     . <br> boolean relayEnabled[2] = {true, true}; //  . <br> boolean buttonWasUp[2] = {true, true}; //  . <br> unsigned long previousMillis = 0; /*    <br>    . */ <br> unsigned long activateTime; //      . <br> int value = 0; //    . <br> // . <br> const int T_hold = 10000; //      . <br> const int T_motion = 200; //        . <br> <br> void setup() <br> { <br> //      . <br> pinMode(D0, INPUT); //   - . <br> for (int i = 0; i &lt; 2; ++i) <br> { <br> pinMode(Relay[i], OUTPUT); //  - . <br> pinMode(Button[i], INPUT_PULLUP); //  -    . <br> digitalWrite(Relay[i], relayEnabled[i]); /*    , <br>         . */ <br> } <br> } <br> <br> void loop() <br> { <br> if(digitalRead(D0)) //      "    ?" <br> { <br> Sensor_Work(); <br> if (relayEnabled[0] == true &amp;&amp; Start_Sensor == true) <br> //   1   ()     . <br> { <br> relayEnabled[0] = false; //      (). <br> digitalWrite(Relay[0], relayEnabled[0]); //   . <br> activateTime = millis(); //    . <br> while((millis() - activateTime) &lt; T_hold) <br> { <br> // . <br> } <br> relayEnabled[0] = true; //      (). <br> digitalWrite(Relay[0], relayEnabled[0]); //  . <br> } <br> } <br> //     ,     . <br> for (int i = 0; i &lt; 2; ++i) <br> { <br> boolean buttonIsUp = digitalRead(Button[i]); <br> //      (&amp;&amp;)  ... <br> if (buttonWasUp[i] &amp;&amp; !buttonIsUp) <br> { <br> /*   ,      (),   <br>     ,     <br>  */ <br> delay(10); <br> //    . <br> buttonIsUp = digitalRead(Button[i]); <br> if (!buttonIsUp) <br> { <br> //     ... <br> relayEnabled[i] = !relayEnabled[i]; //     . <br> digitalWrite(Relay[i], relayEnabled[i]); //     . <br> } <br> } <br> //       . <br> buttonWasUp[i] = buttonIsUp; <br> } <br> } <br> <br> void Sensor_Work() //   . <br> { <br> if (digitalRead(Sensor_1) == HIGH || digitalRead(Sensor_2) == HIGH) /*    <br>   . */ <br> { <br> //  . <br> if (millis() - previousMillis &gt; T_motion) <br> { <br> previousMillis = millis(); <br> value++; <br> } <br> } <br> else <br> { <br> Start_Sensor = false; //      . <br> value = 0; <br> } <br> if(value &gt;= 10) <br> { <br> Start_Sensor = true; //   . <br> value = 0; <br> } <br> } <br></code> </div></div><br><h4>  <font color="blue">Installation</font> </h4><br>  Sensors are hidden in a small plastic box. <br><br><img src="https://habrastorage.org/web/395/ba0/20c/395ba020c72d413eb09b40bc41cba2c2.jpg"><br><br>  All cables, with the exception of the branches to the sensors, are hidden in plastic boxes. <br><br><img src="https://habrastorage.org/web/389/953/b8a/389953b8af984641ac99ce8cd3ba4281.jpg"><br><br>  View mounted central shield. <br><br><img src="https://habrastorage.org/web/baf/717/6a2/baf7176a20b841e2bcc6a6f5b6a0472f.jpg"><br><br><img src="https://habrastorage.org/web/f1f/690/fa7/f1f690fa74b3424eb35d457966238985.jpg"><br><br><h4>  <font color="blue">Total</font> </h4><br>  The resulting project has satisfied the goal, as when working in automatic mode, for example, during a short stay in the room, and in manual mode while always in the room when there is no movement. <br><br>  During the operation of the automation, no failures or remarks were noticed. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8gJMYGfuqEY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  <font color="blue">Equipment</font> </h4><br><table><tbody><tr><td>  Arduino Pro Mini Atmega 328 5 V 16 MHz Controller </td><td>  one </td></tr><tr><td>  Pyroelectric infrared sensor HC-SR501 </td><td>  2 </td></tr><tr><td>  Light sensor on the LM393 chip </td><td>  one </td></tr><tr><td>  Voltage stabilizer L7805CV </td><td>  one </td></tr><tr><td>  0.33 uF ceramic capacitor </td><td>  one </td></tr><tr><td>  Ceramic condenser 0.1 microfarad </td><td>  one </td></tr><tr><td>  PBS 1 √ó 40 2.54 socket </td><td>  one </td></tr><tr><td>  SWD1-1 switch </td><td>  2 </td></tr><tr><td>  Two-pin screw terminal </td><td>  9 </td></tr><tr><td>  Glass fiber 61 √ó 46 mm </td><td>  one </td></tr><tr><td>  Glass fiber 40 √ó 20 mm </td><td>  one </td></tr><tr><td>  Clock Button </td><td>  2 </td></tr><tr><td>  Textolite </td><td>  one </td></tr><tr><td>  Fluorescent lamp Camelion WL-4002, 16 W </td><td>  12 </td></tr><tr><td>  Ceiling lamp with two incandescent lamps </td><td>  one </td></tr><tr><td>  Junction box </td><td>  eight </td></tr><tr><td>  <abbr title="Universal flat wire">PUNP</abbr> cable 2 √ó 2.5 </td><td></td></tr><tr><td>  Cable telephone <abbr title="Linear telephone cord flat">ShTLP</abbr> -4 0.12 √ó 7 </td><td></td></tr><tr><td>  Cable channel (various sizes) </td><td></td></tr><tr><td>  Consumables (glue, glue Moment Crystal, solder, rosin, TAGS flux, tips) </td><td></td></tr><tr><td>  Fasteners (bolts, nuts, screws, dowels, clamps) </td><td></td></tr></tbody></table>  Thanks for paying attention. <br><br>  References: <br><br>  <a href="https://geektimes.ru/post/280276/">Automatic staircase lighting</a> <br><cut></cut></div><p>Source: <a href="https://habr.com/ru/post/370623/">https://habr.com/ru/post/370623/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../370613/index.html">6 unusual offices of the world</a></li>
<li><a href="../370615/index.html">Translate One2One: a portable synchronous translator based on IBM Watson</a></li>
<li><a href="../370617/index.html">UMmall is coming: Russian online store with AliExpress prices distributes smart watches</a></li>
<li><a href="../370619/index.html">Future cities under construction: energy, recycling, waste-free environment</a></li>
<li><a href="../370621/index.html">Neural networks diagnose heart problems more accurately than doctors</a></li>
<li><a href="../370625/index.html">Reflections on the air: a bitcoin investor skeptical look</a></li>
<li><a href="../370629/index.html">W3C finally approved the DRM standard for HTML5</a></li>
<li><a href="../370631/index.html">Peak population: who will colonize the solar system?</a></li>
<li><a href="../370633/index.html">Challenges, breakpoints, sets and wins - processing information at Wimbledon using IBM Watson</a></li>
<li><a href="../370635/index.html">LePlant Levitating Plant Pot: Details</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>