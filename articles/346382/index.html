<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Suddenly: a new version of ONLYOFFICE with macros</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have important news: a new version of desktops with macros has been released. You can download it on the official website and try everything yourse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Suddenly: a new version of ONLYOFFICE with macros</h1><div class="post__text post__text-html js-mediator-article">  We have important news: a new version of desktops with macros has been released.  You can <a href="http://www.onlyoffice.com/ru/download-desktop.aspx%3Futm_source%3Dhabr%26utm_medium%3Dmedium%26utm_campaign%3Dmacros">download it</a> on the official website and try everything yourself. <br><br>  In this article we will tell you what macros we have, how they differ from Microsoft macros and how to work with them. <br><br><img src="https://habrastorage.org/webt/sv/k0/el/svk0el4vhoohdmu3s9bi6gl8a6c.png"><br><a name="habracut"></a><br><h1>  How are we made macros? </h1><br>  A macro is a script with which you can automate routine operations and save a whole lot of time.  The concept came up with the company Microsoft, so these scripts are designed for Microsoft Office and run on Windows. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ‚ÄúWhen will you make macros?‚Äù Is a very popular question.  At first we answered: ‚ÄúNever.  But we can do the same with plugins ‚Äù(and did). <br><br>  So, over the year, our plugin system has become much cooler (and more <a href="https://api.onlyoffice.com/plugin/basic">documented</a> ).  Now we add new functionality using plugins.  For example, Symbol Table: special characters are needed in document editors, and adding them through plug-ins is much faster.  In addition, we already had a ready SDK for generating and processing documents, spreadsheets and presentations - ONLYOFFICE Document Builder. <br><br>  In general, when we once again talked about macros, we realized that everything worked out for us.  And it turned out pretty nice.  We take the Document Builder, wrap it in a plugin and forward it to the interface.  Now we have the ability to create and run macros! <br><br><img src="https://habrastorage.org/webt/te/hf/fa/tehffaleeggporsycdqa1qxjvpq.png"><br><br>  Now macros can do everything that Builder can do.  Documentation for it can be found <a href="https://api.onlyoffice.com/docbuilder/basic">here</a> .  Separate macros documentation is already writing. <br><br><h1>  Our macros are not like Microsoft. </h1><br>  If you saw our plugins, you should guess what it is, right away.  That you will write not on Visual Basic, but on JavaScript. <br><br>  ‚ÄúWhy not Visual Basic, but what about compatibility ?!‚Äù <br><br>  We anticipate this question and answer it in advance.  Firstly, VBA is only for Windows, and we have all the platforms here.  If Microsoft had a scripting language, we would be happy to support it.  But for a million years to write a very old language compiler, and as a result, getting macros (the same as MS) is not a dream task.  We will prefer the time to perfect the editors.  Besides, everything is ready with js. <br><br>  This is great because: <br><br>  - Will work with all platforms; <br>  - It is really very simple; <br>  - Having written an intelligent script, you can use it both as a plugin and as a macro.  Well, of course, as a script for the Document Builder, of course. <br><br>  About the last point: the macro is, in fact, a special case of the plugin.  Simply installed plug-ins work for all documents (that is, are attached to editors), and macros only for a specific document (that is, are attached to a file). <br><br><h1>  So what's up with compatibility? </h1><br>  Yes, macros from Microsoft are not so easy to open with us.  At the same time, we understand that many already have entire libraries of macros that we would like to run in an alternative office. <br><br>  For now, we can offer the simplest option: rewrite the macros written in VBA a bit.  We understand, perhaps it will sound like a headache, but in fact it is not difficult at all. <br><br>  Here is an example of filling several cells with data (summation of a range).  The first is an MS version with Visual Basic, the second is ours. <br><br>  First example: <br><br><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Example() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> myRange <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> result <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> Run As Long  <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> Run = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Run <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> result = <span class="hljs-string"><span class="hljs-string">"=SUM(A1:A100)"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> result = <span class="hljs-string"><span class="hljs-string">"=SUM(A1:A300)"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> result = <span class="hljs-string"><span class="hljs-string">"=SUM(A1:A25)"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> ActiveSheet.range(<span class="hljs-string"><span class="hljs-string">"B"</span></span> &amp; Run) = result <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> Run <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span></code> </pre> <br><br>  Second: <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> run = <span class="hljs-number"><span class="hljs-number">1</span></span>; run &lt;= <span class="hljs-number"><span class="hljs-number">3</span></span>; run++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (run) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: result = <span class="hljs-string"><span class="hljs-string">"=SUM(A1:A100)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: result = <span class="hljs-string"><span class="hljs-string">"=SUM(A1:A300)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: result = <span class="hljs-string"><span class="hljs-string">"=SUM(A1:A25)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } Api.GetActiveSheet().GetRange(<span class="hljs-string"><span class="hljs-string">"B"</span></span> + run).Value = result; } })();</code> </pre> <br><br>  As you can see, it's pretty simple. <br><br>  And now a cool example: <br><br><div class="spoiler">  <b class="spoiler_title">Here we have a long script</b> <div class="spoiler_text"><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oSheet = Api.GetActiveSheet(); oSheet.SetName(<span class="hljs-string"><span class="hljs-string">'Medal Number'</span></span>); oSheet.SetColumnWidth(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">7.57</span></span>); oSheet.SetColumnWidth(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12.43</span></span>); oSheet.SetColumnWidth(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">32.50</span></span>); oSheet.SetColumnWidth(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13.86</span></span>); oSheet.SetColumnWidth(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">13.86</span></span>); oSheet.SetColumnWidth(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">13.86</span></span>); oSheet.SetColumnWidth(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">13.86</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C1'</span></span>); range.SetFontSize(<span class="hljs-number"><span class="hljs-number">56</span></span>); range = oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'B2:G29'</span></span>); range.SetFontName(<span class="hljs-string"><span class="hljs-string">'Calibri'</span></span>); range.SetFontSize(<span class="hljs-number"><span class="hljs-number">13</span></span>); range.SetFontColor(Api.CreateColorFromRGB(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)); range.SetAlignHorizontal(<span class="hljs-string"><span class="hljs-string">'center'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'B2'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Rank'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C2'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Country'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D2'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Gold'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E2'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Silver'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F2'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Bronze'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'G2'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Total'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nCell = <span class="hljs-number"><span class="hljs-number">0</span></span>; nCell &lt; <span class="hljs-number"><span class="hljs-number">25</span></span>; ++nCell) { oValue = nCell + <span class="hljs-number"><span class="hljs-number">1</span></span>; oCellNumber = nCell + <span class="hljs-number"><span class="hljs-number">3</span></span>; oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'B'</span></span> + oCellNumber.toString()).SetValue(oValue.toString()); } oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C3:C27'</span></span>).SetAlignHorizontal(<span class="hljs-string"><span class="hljs-string">'left'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C3'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'USA'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C4'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'China'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C5'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Great Britain'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C6'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Russia'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C7'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Germany'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C8'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Japan'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C9'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'France'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C10'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'South Korea'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C11'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Italy'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C12'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Australia'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C13'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Netherlands'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C14'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Hungary'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C15'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Brazil'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C16'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Spain'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C17'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Kenya'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C18'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Jamaica'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C19'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Croatia'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C20'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Cuba'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C21'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'New Zealand'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C22'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Canada'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C23'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Uzbekistan'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C24'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Kazakhstan'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C25'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Colombia'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C26'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Switzerland'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C27'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Iran'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D3'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'46'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D4'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'27'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D5'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'26'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D6'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'19'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D7'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'17'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D8'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'12'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D9'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'10'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D10'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'9'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D11'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'8'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D12'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'8'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D13'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'8'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D14'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'8'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D15'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'7'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D16'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'7'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D17'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'6'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D18'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'6'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D19'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'5'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D20'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'5'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D21'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'4'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D22'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'4'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D23'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'4'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D24'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D25'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D26'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D27'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E3'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'37'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E4'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'23'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E5'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'18'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E6'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'18'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E7'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'10'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E8'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'8'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E9'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'18'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E10'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E11'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'12'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E12'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'11'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E13'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'7'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E14'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E15'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'6'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E16'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'4'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E17'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'6'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E18'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E19'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E20'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'2'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E21'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'9'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E22'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E23'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'2'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E24'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'5'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E25'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'2'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E26'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'2'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E27'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'1'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F3'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'38'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F4'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'17'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F5'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'26'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F6'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'19'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F7'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'15'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F8'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'21'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F9'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'14'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F10'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'9'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F11'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'8'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F12'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'10'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F13'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'4'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F14'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'4'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F15'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'6'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F16'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'6'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F17'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'1'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F18'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'2'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F19'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'2'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F20'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'4'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F21'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'5'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F22'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'15'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F23'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'7'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F24'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'9'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F25'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'3'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F26'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'2'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F27'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'4'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nCell = <span class="hljs-number"><span class="hljs-number">0</span></span>; nCell &lt; <span class="hljs-number"><span class="hljs-number">25</span></span>; ++nCell) { oCellNumber = nCell + <span class="hljs-number"><span class="hljs-number">3</span></span>; oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'G'</span></span> + oCellNumber.toString()).SetValue(<span class="hljs-string"><span class="hljs-string">'=SUM(D'</span></span> + oCellNumber.toString() + <span class="hljs-string"><span class="hljs-string">':F'</span></span> + oCellNumber.toString() + <span class="hljs-string"><span class="hljs-string">')'</span></span>); } oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C29'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'Total:'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C29'</span></span>).SetAlignHorizontal(<span class="hljs-string"><span class="hljs-string">'right'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D29'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'=SUM(D3:D27)'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'E29'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'=SUM(E3:E27)'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'F29'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'=SUM(F3:F27)'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'G29'</span></span>).SetValue(<span class="hljs-string"><span class="hljs-string">'=SUM(G3:G27)'</span></span>); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'D29:F29'</span></span>).SetFontColor(Api.CreateColorFromRGB(<span class="hljs-number"><span class="hljs-number">67</span></span>, <span class="hljs-number"><span class="hljs-number">67</span></span>, <span class="hljs-number"><span class="hljs-number">67</span></span>)); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'G29'</span></span>).SetFontColor(Api.CreateColorFromRGB(<span class="hljs-number"><span class="hljs-number">49</span></span>, <span class="hljs-number"><span class="hljs-number">133</span></span>, <span class="hljs-number"><span class="hljs-number">154</span></span>)); oSheet.GetRange(<span class="hljs-string"><span class="hljs-string">'C29:G29'</span></span>).SetFontSize(<span class="hljs-number"><span class="hljs-number">14</span></span>); oSheet.FormatAsTable(<span class="hljs-string"><span class="hljs-string">'B2:G29'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oChart = oSheet.AddChart(<span class="hljs-string"><span class="hljs-string">"'Medal Number'!$C$2:$F$27"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">'barStacked3D'</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>); oChart.SetVerAxisTitle(<span class="hljs-string"><span class="hljs-string">"Medals"</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); oChart.SetHorAxisTitle(<span class="hljs-string"><span class="hljs-string">"Countries"</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); oChart.SetLegendPos(<span class="hljs-string"><span class="hljs-string">"right"</span></span>); oChart.SetShowDataLabels(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); oChart.SetTitle(<span class="hljs-string"><span class="hljs-string">"Total Medal Count"</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oChart2 = oSheet.AddChart(<span class="hljs-string"><span class="hljs-string">"'Medal Number'!$C$2:$E$12"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">'lineStacked'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">27</span></span>); oChart2.SetVerAxisTitle(<span class="hljs-string"><span class="hljs-string">"Medals"</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); oChart2.SetHorAxisTitle(<span class="hljs-string"><span class="hljs-string">"Top 10 Countries"</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); oChart2.SetLegendPos(<span class="hljs-string"><span class="hljs-string">"right"</span></span>); oChart2.SetShowDataLabels(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); oChart2.SetTitle(<span class="hljs-string"><span class="hljs-string">"Gold&amp;Silver Medals Count"</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>); })();</code> </pre> </div></div><br><br>  As a result, you should have this beauty: <br><br><img src="https://habrastorage.org/webt/l9/hz/dk/l9hzdkzfi_r-hc8ay6mqf-imy74.png" alt="image"><br><br>  You can download the <a href="http://www.onlyoffice.com/ru/download-desktop.aspx%3Futm_source%3Dhabr%26utm_medium%3Dmedium%26utm_campaign%3Dmacros">ONLYOFFICE desktop application</a> and try everything.  By the way, macros are not the only innovation of the released version.  We have fixed a lot of things, added support for SSO, new interface languages ‚Äã‚Äã(Czech and Slovak).  Detailed information about the new version on <a href="">GitHub</a> . <br><br>  It's all.  We are waiting for your questions, suggestions, suggestions and thoughts.  If you have interesting files with macros that you can share, send to <a href="">files@onlyoffice.com</a> .  If you have files without macros, but with interesting problems and errors, we are waiting for them too. </div><p>Source: <a href="https://habr.com/ru/post/346382/">https://habr.com/ru/post/346382/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346370/index.html">How to create an in-game menu in Unity</a></li>
<li><a href="../346372/index.html">Crime and punishment for owners of critical information infrastructure of the Russian Federation</a></li>
<li><a href="../346374/index.html">Why we didn‚Äôt do it perfectly: how the infrastructure of the War Robots servers was changing</a></li>
<li><a href="../346378/index.html">News from the world of OpenStreetMap ‚Ññ 389 (26.12.2017-01.01.2018)</a></li>
<li><a href="../346380/index.html">Just about microservices</a></li>
<li><a href="../346384/index.html">Event digest for HR specialists in IT-area for January 2018</a></li>
<li><a href="../346386/index.html">About the peculiarities of using VPN Zaborona on routers for bypassing locks in Ukraine</a></li>
<li><a href="../346388/index.html">Lindenmeyer systems</a></li>
<li><a href="../346390/index.html">We invite speakers at PHDays: tell us how you see the digital state</a></li>
<li><a href="../346394/index.html">How it works: monitoring of power supply of data center Selectel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>