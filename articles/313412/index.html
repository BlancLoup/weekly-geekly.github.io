<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Architecture and programming Philips Videopac (Magnavox Odyssey 2)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Hardware is just software crystallized early" 
 - Alan Kay 

 Computer Magnavox Odyssey 2 (Videopac) appeared in 1978 and was positioned as a game, b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Architecture and programming Philips Videopac (Magnavox Odyssey 2)</h1><div class="post__text post__text-html js-mediator-article">  <i>"Hardware is just software crystallized early"</i> <i><br></i>  <i>- Alan Kay</i> <br><br><img align="right" src="https://habrastorage.org/files/8fc/f78/439/8fcf78439f754c5bb86c169784102a3e.jpg" title="Philips Videopac">  Computer <a href="https://en.wikipedia.org/wiki/Magnavox_Odyssey%25C2%25B2">Magnavox Odyssey 2 (Videopac)</a> appeared in 1978 and was positioned as a game, but with the possibility of a more serious use (for which he had a built-in membrane keyboard).  Serious applications, given the designative amount of memory, were very few, so, in fact, it is more correct to assume that Videopac is a game console. <br><br>  As for the titles, Magnavox Odyssey 2 was sold in the USA and provided an NTSC video signal (via RF output).  Philips Videopac G7000 (aka C52) was sold in Europe, respectively, with a PAL video.  In addition to this difference (which, of course, influenced the performance of some games) computers are exactly the same. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Videopac was one of the first game consoles, for which games were released in the form of cartridges with programs.  Therefore, it is not surprising that, technically, this device is very austere. <br><a name="habracut"></a><br><h2>  CPU and memory </h2><br>  The processor is an <a href="https://en.wikipedia.org/wiki/Intel_MCS-48">Intel 8048</a> microcontroller.  At one time he was quite famous, because he was put (in different versions) in all PC XT and AT keyboards. <br><br>  The 8048 has a fairly simple set of instructions and few addressing modes.  <a href="https://en.wikipedia.org/wiki/Modified_Harvard_architecture">Harvard</a> architecture (as opposed to the more familiar to all - von Neumann). <br><br>  All memory is divided into three types - software ROM (1kb BIOS on a chip and up to 8kb ROM in cartridges), internal RAM (64 bytes in the micro-controller itself, 32 bytes of which are reserved for registers and stack) and external RAM (128 bytes of static RAM, partially located at the same addresses as the video controller). <br><br>  The total amount of RAM available to the programmer in the end is less than 160 bytes, and even then use it as a whole is very difficult. <br><br>  For access to each of the types of memory there are separate instructions (MOVP, MOV, MOVX).  The clock frequency of 8048 in Videopac is often indicated as 5.37 MHz, but in fact (in terms of executing instructions) it is only 0.358 MHz.  At the same time, however, most instructions are executed in 1-2 clocks.  There are nine general-purpose registers - A, R0-R7. <br><br>  Also on the 8048 chip there is a timer, two I / O ports and an interrupt control circuit.  Through the ports are polling two joysticks and a keyboard. <br><br>  The unpleasant feature of the 8048 is the division of memory into pages of 256 bytes (you cannot access the memory location on another page) and 2kb banks (to access the adjacent bank, you need to switch using SEL RB commands), which has to be constantly taken into account. <br><br>  There is a domestic analogue 8048 - 1816BE48. <br><br><h2>  Video and sound </h2><br>  Another important component of the system is the Intel 8245 chip (aka 8244 for NTSC).  This is a video audio controller with a masked ROM, which was produced specifically for Videopac (i.e., there are apparently no other versions or firmware). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/122/0f8/40e/1220f840ea2542af97fbf480852bafb7.jpg" title="One of the games on Videopac"></div><br>  The video controller is rather strange even by the standards of 1980s home computers.  For example, it does not, as such, neither graphic nor text modes.  All the entities that it supports (sprites, chars, quads, grids) are sprites with certain restrictions.  In this regard, such ‚Äúordinary‚Äù operations like drawing points in a certain place on the screen or filling the screen with text are impossible.  Because of this, it is even impossible to say for certain about the resolution of the screen (it‚Äôs very conditional to talk about numbers like 228 x 262). <br><br>  In fact, this video controller is not universal and is designed for typical (very simple) games.  It can form: <br><br>  <b>Sprites</b> - traditional hardware sprites of 8x8 pixels.  At the same time on the screen can be 4 sprites.  Their contents, coordinates, color can be changed by writing to the video controller registers.  Each sprite can be any of eight (bright) colors. <br><br>  There is also a rather strange (albeit useful) feature that allows you to move the sprite by half (!) Pixels, or odd lines of the sprite by half pixels relative to even ones. <br><br>  <b>Chars</b> are symbols.  Letters, numbers and some characters (63 in total) whose images are stored in ROM BIOS and cannot be changed.  Up to 12 characters can be displayed on the screen at the same time.  Like the sprites, they are displayed in any place on the screen (up to a pixel), but, unlike them, they cannot overlap each other.  Each character can be any of 8 (bright) colors. <br><br>  The address from which the image of the character is taken depends on the Y coordinate to which the character is output and the code of the character itself (!).  Therefore, to output characters, either you need to calculate this address using a clever formula (especially if you want to get parts of characters), or use the BIOS subroutine. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/298/f98/d4d/298f98d4d69c47c2957b36715fd77314.jpg" title="Character table in ROM"></div><br>  <b>Quads</b> - groups of characters combined in 4 pieces. <br><br>  <b>Grid</b> - grid 9 x 8 segments.  Used to display labyrinths, floors, stairs, etc.  There is a mode that allows you to display solid blocks instead of a grid, for example, to simulate a chessboard.  The whole grid is the same color.  Those.  for the whole grid, one of eight (dark) colors is given. <br><br>  The Grid is in the background (over the background, which can be any of 8 colors), over the grid the characters are displayed and, in the foreground, sprites. <br><br>  It is possible to track the fact of collision of objects between themselves (one bit-flag for each type of object - without specifying a specific one). <br><br>  In addition, the video controller allows, with a number of restrictions, to track the position of the beam, not only by frame, but also by rows.  In the simplest case, this is used to draw horizontal stripes (earth and sky, for example) by changing the background color at the right moments. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a26/173/b7b/a26173b7b5d8449ba8bd80278e1e6b32.jpg" title="Raster effects"></div><br>  In addition to video, 8245 also allows you to generate primitive sounds.  For this, there is a 24-bit cyclic shift register, which can be clocked in one of two frequencies to choose from and switch to the noise generation mode.  Thus, the generation of an arbitrary note is virtually impossible, although with some tricks you can get a reasonable approximation. <br><br>  Total output volume, one of 16 levels can be set.  BIOS routines allow you to make several sounds that can be heard in most games (squeak, shot, blast). <br><br>  Cartridges with games represent a simple ROM in the size from 2kb (most typically) to 8kb.  In addition to cartridges, for Videopac there are two peripheral devices - a speech synthesizer (LPC compression, a ROM with words) and a chess computer module (with its own z80 processor). <br><br><h2>  Development </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/files/724/f3b/53e/724f3b53eaba4da986dc6e1de1a68be9.png" title="o2em debugger"></div><br>  The best emulator is o2em, and there is a version with a built-in debugger.  Although this is really a very decent emulator, nevertheless the situation when a fairly simple code works in it, but it gives a black screen or not those colors on a real Videopac - quite typical.  It can also be useful emulator 1816BE48 ("SCM - Single Chip Machine by DCA Laboratory").  As an assembler, it is best to use AS (ASW). <br><br>  Build and run look like this: <br><br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">asw</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.exe</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-L</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-x</span></span> %1<span class="hljs-selector-class"><span class="hljs-selector-class">.a48</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">p2bin</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.exe</span></span> %1<span class="hljs-selector-class"><span class="hljs-selector-class">.p</span></span> %1<span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-r</span></span> 1024<span class="hljs-selector-tag"><span class="hljs-selector-tag">-3071</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">o2em</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.exe</span></span> %1<span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-euro</span></span></code> </pre> <br>  To check the code on a real device, <a href="http://www.vectrex.hackermesh.org/index.php/en/mvbd-mvmc-3/faq">Mateos Videopac Multigame Cartridge and Mateos Burner / Dumper</a> (i.e., ROM emulator and programmer for it, with USB port) were purchased. <br><br>  It also makes sense to modify Videopac by making a composite or RGB output (there are many <a href="http://gamesx.com/wiki/doku.php%3Fid%3Dav:g7000_av">schemes</a> on the Internet).  Compared to standard RF, this will give a better image and more regular and pure colors. <br><br>  When the computer is turned on (if any working cartridge is inserted) a colored ‚ÄúSELECT GAME‚Äù appears on the screen (if there is no cartridge, there is rubbish on the screen at best). <br>  After pressing the key, a transition occurs at 0400h - the first address in the cartridge ROM. <br><br>  A typical program is as follows: <br><br><pre> <code class="hljs pgsql">; Hello World <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Philips Videopac (Magnavox Odyssey <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">8048</span></span> CPU ; <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> Frog ( https://github.com/petersobolev ) cpu <span class="hljs-number"><span class="hljs-number">8048</span></span> org <span class="hljs-number"><span class="hljs-number">400</span></span>h <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "g7000.h" ;   Videopac  ;   jmp selectgame ; <span class="hljs-keyword"><span class="hljs-keyword">RESET</span></span>.  VDC,    .   "SELECT GAME"   .     <span class="hljs-number"><span class="hljs-number">0408</span></span>h, ..  jmp <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> (   A). jmp irq ; jmp timer ; jmp vsyncirq ; jmp <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> ;    selectgame jmp soundirq ; timer: ret ;    <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> gfxoff ;        VDC mov r0,#<span class="hljs-number"><span class="hljs-number">010</span></span>h ;    VDC   (  <span class="hljs-number"><span class="hljs-number">12</span></span>) mov r3,#<span class="hljs-number"><span class="hljs-number">40</span></span> ; x mov r4,#<span class="hljs-number"><span class="hljs-number">100</span></span> ; y mov r1,#hellostr &amp; <span class="hljs-number"><span class="hljs-number">0</span></span>ffh ;    (     <span class="hljs-number"><span class="hljs-number">255</span></span>  ) mov r2,#<span class="hljs-number"><span class="hljs-number">11</span></span> ;   <span class="hljs-number"><span class="hljs-number">11</span></span>  nextchar: mov a,r1 movp a,@a ;   A       r1 mov r5,a inc r1 ;    mov r6,#<span class="hljs-number"><span class="hljs-number">0</span></span>eh ;   <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> printchar ;   (  r0  r3) djnz r2,nextchar <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> gfxon ;  ,    VDC <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>: jmp <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> ;   ; <span class="hljs-string"><span class="hljs-string">'HELLO WORLD'</span></span> (ASCII    ) hellostr: db <span class="hljs-number"><span class="hljs-number">01</span></span>dh, <span class="hljs-number"><span class="hljs-number">012</span></span>h, <span class="hljs-number"><span class="hljs-number">00</span></span>eh, <span class="hljs-number"><span class="hljs-number">00</span></span>eh, <span class="hljs-number"><span class="hljs-number">017</span></span>h, <span class="hljs-number"><span class="hljs-number">00</span></span>ch, <span class="hljs-number"><span class="hljs-number">011</span></span>h, <span class="hljs-number"><span class="hljs-number">017</span></span>h, <span class="hljs-number"><span class="hljs-number">013</span></span>h, <span class="hljs-number"><span class="hljs-number">00</span></span>eh, <span class="hljs-number"><span class="hljs-number">01</span></span>ah</code> </pre><br><h2>  Application - Intro Rash </h2><br>  According to the results of the Videopac study, I wrote (for the <a href="http://cc.org.ru/">Chaos Constructions</a> competition) a 256 byte intro ( <a href="https://www.youtube.com/watch%3Fv%3D2i8nf2Fi_h8">video</a> , <a href="https://github.com/petersobolev/rash">source</a> ). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4fe/9dd/d3c/4fe9ddd3c91c4fccb704530fc61c5289.jpg" title="256 bytes intro Rash on Videopac"></div><br>  We use three types of graphic primitives (of the four implemented in the video controller i8245) - grid, sprites and chars.  Only quads (representing a type of chars) are not used. <br><br>  Falling down men - not sprites, as it may seem, but the characters (chars) size 8x8.  However, in 8245 chars and sprites are related concepts.  The maximum number of simultaneously displayed chars is used - 12 pieces.  All of them are taken from the standard character generator (there are characters of men), which saves at least 24 bytes.  This is an important point, because the i8048 architecture and Videopac cartridge format do not contribute to the compactness of the code at all.  In particular, despite the large number of registers (a, r0-r7), in some cases only some (a, r0, r1) can be used, so quite a lot of ‚Äúredundant‚Äù instructions are generated that drive data from the register to the register. <br><br>  The background of the changing orange squares is implemented through the grid.  This is a hardware-generated 9x8 grid (in a special ‚Äúchess‚Äù field mode), in which, according to a certain algorithm, certain segments are included.  The priority of the grid is always the smallest, so people fly over it. <br><br>  Unlucky, but resilient cat consists of two sprites (8x8 each).  At the same time, the data for the sprites during the movement periodically change to others (only two frames)) in order to imitate the moving legs. <br><br>  The collision of chars and sprites is fixed by the video controller, while the color of the sprites of the cat changes according to a certain algorithm, and the special bit is reset or set, shifting the even lines of the sprite by half a pixel relatively odd. <br><br>  As a collision sound, one of the sounds available through the BIOS routine (which saves a few more bytes) is used. <br><br><h2>  Besides </h2><br>  In addition to games, there were also several more serious applications for Videopac - a program for captioning in the form of a running line and a program for teaching programming, which needs special mention. <br><br>  The cartridge is called <a href="https://archive.org/details/Computer_Intro_1980_Philips_US">‚ÄúComputer Programmer‚Äù</a> and allows you to enter the program in machine codes (that is, not even in assembler) and run it.  The cartridge included a <a href="https://archive.org/details/Computer_Programmer_1978_Philips_EU">book</a> with a description of the architecture and 8048 instructions. <br><br>  Let me remind you that it was quite a commercial product, designed for buyers of gaming (!) Consoles. <br><br>  In the <a href="https://www.youtube.com/watch%3Fv%3DJrSM4DxvB5s">video</a> you can see how it works. <br><br><h2>  Links </h2><br><blockquote><ul><li>  <a href="http://www.vectrex.hackermesh.org/index.php/en/mvbd-mvmc-3/faq">Emulator rom</a> </li><li>  <a href="http://atari2600land.com/odyssey2/odyssey2howtoprogram.html">ASW assembler</a> </li><li>  <a href="http://atariage.com/forums/forum/176-odyssey-2-videopac/">Videopac forum</a> </li><li>  <a href="http://videopac.nl/forum">Another Videopac forum</a> </li><li>  <a href="http://patft.uspto.gov/netacgi/nph-Parser%3FSect1%3DPTO1%26Sect2%3DHITOFF%26d%3DPALL%26p%3D1%26u%3D%252Fnetahtml%252FPTO%252Fsrchnum.htm%26r%3D1%26f%3DG%26l%3D50%26s1%3D4169262.PN.%26OS%3DPN/4169262%26RS%3DPN/4169262">Intel 8244 patent</a> </li><li>  <a href="http://www.guttenbrunner.com/videopac/o2emPort.html">Videopac emulator (o2em)</a> </li><li>  <a href="http://dca_lab.tripod.com/">8048 emulator</a> </li><li>  <a href="http://www.atarihq.com/danb/files/o2romsrc.txt">Videopac BIOS Sources</a> </li><li>  <a href="https://archive.org/details/library_magnavox_odyssey2">Games (can be run in the browser)</a> </li><li>  <a href="http://soeren.informationstheater.de/g7000/toc.html">Programming tutorials</a> </li><li>  <a href="http://home.kpn.nl/rene_g7400/vp_info.html">Videopac scheme</a> </li><li>  <a href="">Different documentation in one archive</a> </li></ul></blockquote><br>  <a href="http://enlight.ru/roi/">Here</a> you can see my works for different retro platforms, and <a href="https://github.com/petersobolev">here</a> their sources are on github. <br><br>  <strong>ps</strong> Thanks <a href="https://habr.com/users/tnt23/" class="user_link">tnt23</a> for remaking video output Videopac with RF to composite. </div><p>Source: <a href="https://habr.com/ru/post/313412/">https://habr.com/ru/post/313412/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../313396/index.html">Why is it too late to "make money" in business literature</a></li>
<li><a href="../313398/index.html">10 arguments against email migration to Microsoft cloud</a></li>
<li><a href="../313400/index.html">Hacker dossier: Boris Florikik aka Tron, creator of the first Cryptophone</a></li>
<li><a href="../313402/index.html">The digest of fresh materials from the world of the frontend for the last week No. 233 (October 17‚Äì23, 2016)</a></li>
<li><a href="../313410/index.html">How to explain to granny what Agile is in 15 minutes with pictures</a></li>
<li><a href="../313414/index.html">Synergistic organizations. Part 0</a></li>
<li><a href="../313416/index.html">Android In-app Billing: from a mobile application to server validation and testing</a></li>
<li><a href="../313418/index.html">Preparing to migrate vCenter Server to vSphere 6.0 Update 2m. Part 2</a></li>
<li><a href="../313420/index.html">Procedural generation of planetary maps</a></li>
<li><a href="../313422/index.html">42 lines of code to exit the limb</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>