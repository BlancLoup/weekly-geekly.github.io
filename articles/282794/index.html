<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Two-headed monster in the world of viruses: GozNym</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Employees of IBM X-Force Research discovered a new Trojan that is a hybrid of the rather well-known malware Nymaim and Gozi ISFB. It turned out that t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Two-headed monster in the world of viruses: GozNym</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/9bf/9f5/67f/9bf9f567fe6a4ab1b8acc1e22f29550b.jpg"><br><br>  Employees of <a href="http://www-03.ibm.com/security/xforce/">IBM X-Force Research</a> discovered a new Trojan that is a hybrid of the rather well-known malware Nymaim and Gozi ISFB.  It turned out that the Nymaim developers combined the source code of this virus with a part of the Gozi ISFB code.  The result was a hybrid that was actively used in attacks on a network of 24 banks in the United States and Canada.  With this, malware managed to steal millions of dollars.  Hybrid viral product called GozNym. <br><br>  According to information security experts, this hybrid took the best of the two viruses mentioned above: from Nyamaim the malware inherited the ability to hide its presence from antivirus programs, from Gozi - the ability to penetrate users' PCs.  GozNym unofficially called the "two-headed monster." <br><a name="habracut"></a><br>  <b>Targeting: financial institutions in North America</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The developers of the new virus have sent it to organizations in North America - to the United States and Canada.  Currently, 22 banks affected by the virus, credit institutions and popular e-commerce platforms are known.  Also on the list are two financial companies from Canada. <br><br><img src="https://habrastorage.org/files/348/ed9/560/348ed95608ba4d9e97a1be5ada8801b3.png"><br><br>  <b>Source code - where is it from?</b> <br><br>  How was the hybrid created?  It has already been mentioned above that this virus consists of parts of two other malware.  The source code of the first, Gozi ISFB, has repeatedly laid out on the Net.  For the first time it happened in 2010.  The second time was in 2015, when the source code of a modified version of this software was posted on the Internet. <br><br>  As for Nymaim, the only possible source of source code is its developers.  Most likely, it was the Nymaim team that took part of the Gozi ISFB code, combined it with its product, getting ‚ÄúFrankenstein in the world of viruses‚Äù. <br><br>  <b>From Nymaim to GozNym</b> <br><br>  Nymaim operates in two stages.  Initially, this malware penetrates computers using exploit kits, and after hitting the PC it performs the second stage - launching two executable files that complete the infection of the victim's machine. <br><br>  The original virus, Nymaim, uses encryption, anti-VM, anti-debugging, and obfuscation of the sequence of execution of the program code, i.e.  obfuscating the flow of control.  Until now, this virus has been used mainly as a <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D1%2580%25D0%25BE%25D0%25BF%25D0%25BF%25D0%25B5%25D1%2580">dropper</a> .  Droppers (Eng. Dropper) - a family of malicious programs (usually a Trojan) intended for unauthorized and hidden from the user installation on the computer of the victim of other malicious programs contained in the body of the dropper or downloaded over the network.  This type of malware usually without any messages (with false error messages in the archive, an incorrect version of the operating system, etc.) downloads from the network and saves files on the victim‚Äôs disk and then executes them. <br><br>  Nymaim, as far as is known, has been created by a team of developers who have managed this malware for several years.  At the moment, traces of dropper presence are found on PCs of users in Europe, North America, and South America. <br><br>  Of course, not all intruder operations performed using Nymaim are documented.  However, there are data on 2.5 million infections using the Blackhole Exploit Kit (BHEK) only at the end of 2013. <br><br><img src="https://habrastorage.org/files/283/443/19e/28344319e85b4f018cb4bba4e44b6bb4.png"><br><br>  IBM researchers point out that Nymaim has begun using the Gozi ISFB module, the DLL responsible for web injection, since 2015.  The final version of the hybrid, which is a full-fledged integration of two malicious programs, was discovered only in April 2016.  In its hybrid incarnation, Nymaim is executed first, and then the Gozi ISFB executable is launched. <br><br>  <b>Some technical information</b> <br><br>  Before merging into a single whole, the Nymaim malware used the Gozi ISFB DLL to introduce the victim into the browser and to conduct web injections.  The size of the DLL was about 150 KB and was a valid Portable Executable (PE) file. <br>  New versions of Nymaim began to use not the DLL, but the Gozi ISFB code itself.  Instead of a 150 KB file, Nymaim now injects 40 KB of buffer into the browser.  This buffer has all the features of Gozi ISFB.  But there are some differences: now it is no longer a valid PE file, its structure is different and represents a shell code.  It uses the Import Address Table (IAT) and no PE headers. <br><br><img src="https://habrastorage.org/files/9fc/503/bab/9fc503babdf846c0ac26157cbf542214.png"><br>  <i>The old version of Nymaim, where Gozi ISFB DLL is used</i> <br><br><img src="https://habrastorage.org/files/ee7/8a9/871/ee78a98717a5464fb25363a9b3282a34.png"><br>  <i>New buffer and new hybrid function jmp_nymaim_code (below)</i> <br><br><img src="https://habrastorage.org/files/65f/beb/e10/65fbebe1098a4656868395e3a293570d.png"><br><br>  This part of the code is executed whenever Gozi ISFB is required by Nymaim to perform the operation.  In this case, the function prepares the required parameters, the type of operation, the size of the allocated memory, etc.  for Nymaim.  Then Nymaim comes into operation and returns the result for Gozi ISFB. <br><br>  The MD5 hash in this case is 2A9093307E667CDB71884ECC1B480245. <br><br>  <b>How to protect yourself?</b> <br><br>  It is not so easy to do.  The malware described above is unique and can create major problems for both individuals and the entire company.  In order to avoid such a development of events, it is necessary to follow the usual rules of working with information in organizations. <br><br>  True, this does not always help, especially if the company has many employees working with computer equipment with access to the network. <br><br>  In this case, we also recommend using our security tools: <a href="http://www-03.ibm.com/software/products/en/trusteer-rapport%3Fce%3DISM0484%26ct%3DSWG%26cmp%3DIBMSocial%26cm%3Dh%26cr%3DSecurity%26ccy%3DUS%26ce%3DISM0484%26ct%3DSWG%26cmp%3DIBMSocial%26cm%3Dh%26cr%3DSecurity%26ccy%3DUS">IBM Security Trusteer Pinpoint Malware Detection</a> and <a href="http://www-03.ibm.com/software/products/en/trusteer-rapport%3Fce%3DISM0484%26ct%3DSWG%26cmp%3DIBMSocial%26cm%3Dh%26cr%3DSecurity%26ccy%3DUS%26ce%3DISM0484%26ct%3DSWG%26cmp%3DIBMSocial%26cm%3Dh%26cr%3DSecurity%26ccy%3DUS">IBM Security Trusteer Rapport</a> .  These services provide timely detection of infected devices on the network, destruction of malware if the system is already infected, and prevent the process using various protection methods. </div><p>Source: <a href="https://habr.com/ru/post/282794/">https://habr.com/ru/post/282794/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282784/index.html">The art of rx</a></li>
<li><a href="../282786/index.html">Internet bees, or the green future of M2M applications</a></li>
<li><a href="../282788/index.html">Evolution of programming languages</a></li>
<li><a href="../282790/index.html">Security Week 17: Hacking SWIFT and cash registers, soliciting Android with exploits, bypassing AppLocker</a></li>
<li><a href="../282792/index.html">Disconnection of analog satellite TV: 4 years later (part 2)</a></li>
<li><a href="../282798/index.html">Working with MySQL: how to scale the data warehouse 20 times in three weeks</a></li>
<li><a href="../282800/index.html">Russian translation of the speech by Alex Ionescu "Crazy attempt to rewrite Windows from scratch"</a></li>
<li><a href="../282806/index.html">01100100 years since the birth of Claude Shannon</a></li>
<li><a href="../282808/index.html">UDP / TCP File System, Trivial Remote File System</a></li>
<li><a href="../282810/index.html">JPoint 2016 Java Conference Overview</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>