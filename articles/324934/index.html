<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Getting ready for a PHP interview: Everything about iteration and a little about the ‚Äúiterable‚Äù pseudotype</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is no secret that they like to ask tricky questions at interviews. Not always adequate, not always relevant to reality, but the fact remains that t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Getting ready for a PHP interview: Everything about iteration and a little about the ‚Äúiterable‚Äù pseudotype</h1><div class="post__text post__text-html js-mediator-article">  It is no secret that they like to ask tricky questions at interviews.  Not always adequate, not always relevant to reality, but the fact remains that they are asking.  Of course, a question is a question, and sometimes a question, seemingly stupid at first glance, is actually aimed at checking how well you know the language you write. <br><br>  And, of course, no matter how strange and inappropriate the questions at the interview seem to be, you need to come all the same prepared, knowing the language for programming on which you are going to pay. <br><br><img src="https://habrastorage.org/files/9b9/288/4f0/9b92884f0c7c49599d874f02890c19d3.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The third part of a series of articles is devoted to one of the most voluminous concepts in modern PHP - iteration, iterators and iterated entities.  I tried to reduce in one text a certain minimum of knowledge about this question, suitable for self-preparation for an interview for the position of a PHP developer. <br><br>  Two previous parts: <br><br><ul><li>  <a href="https://habrahabr.ru/post/259627/">Preparing for a PHP interview: the keyword "static"</a> </li><li>  <a href="https://habrahabr.ru/post/259991/">Getting ready for a PHP interview: pseudo-type "callable"</a> </li></ul><br><a name="habracut"></a><br><h3>  PHP arrays </h3><br>  Let's start from the beginning. <br><br>  PHP has arrays.  Arrays in PHP are associative, that is, they store pairs (key, value), where the key must be an int or string, and the value can be of any type. <br><br>  Example: <br><br><pre><code class="php hljs">$arr = [<span class="hljs-string"><span class="hljs-string">'foo'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'bar'</span></span>, <span class="hljs-string"><span class="hljs-string">'baz'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-string"><span class="hljs-string">'arr'</span></span> =&gt; [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]];</code> </pre> <br>  The key and value are separated by the symbol "=&gt;".  Sometimes the key is otherwise called the "index", in PHP these are equivalent terms. <br><br>  A fairly complete set of operations is defined on arrays in PHP: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    $arr['new'] = 'some value'; //      $arr[] = 'another value'; //      echo $arr['foo']; echo $arr[$bar]; //     unset($arr['foo']); // ""  [$foo, $bar, $baz] = $arr;</span></span></code> </pre><br>  There are also many functions for working with arrays - <a href="http://php.net/manual/ru/ref.array.php">tens and hundreds of them!</a> <a href="http://php.net/manual/ru/ref.array.php"><br></a> <br>  However, perhaps the most important feature of arrays in PHP is the ability to sequentially walk through all the elements of an array, obtaining all key-value pairs in order. <br><br><h3>  Array iteration </h3><br>  The process of passing through an array is called ‚Äúiteration‚Äù (or ‚Äúbrute force‚Äù) (by the way, each step, getting each individual key-value pair is also ‚Äúiteration‚Äù), and the array itself is thus iterative (‚Äúiterated‚Äù) the essence. <br><br>  The simplest example of the iteration process is, of course, a joint loop implemented by the foreach operator: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($arr <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $key=&gt;$val) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $key . <span class="hljs-string"><span class="hljs-string">'=&gt;'</span></span> . $val; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; }</code> </pre><br>  Notice the same "=&gt;" sign that separates the key and the value in the loop header. <br><br>  But how does PHP understand - which element of the array should be taken at a specific step of the loop?  Which one to take next?  And when to stop? <br><br>  To answer this question, one should be aware of the existence of a so-called ‚Äúinternal pointer‚Äù that exists in each array.  This invisible pointer points to the ‚Äúcurrent‚Äù element and is able to move one step forward - to the next element or again to drop to the first element. <br><br>  For direct work with an internal pointer in PHP, there are functions that are easiest to learn by example: <br><br><pre> <code class="php hljs">$arr = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//   ,      reset($arr); // key()    ,     ,  null         while ( null !== ($key = key($arr)) ) { // current()    ,      echo $key . '=&gt;' . current($arr); echo "\n"; // next()         next($arr); }</span></span></code> </pre><br>  It is easy to see that the example code shown is actually equivalent to the foreach cycle that was previously used, and that foreach is syntactic sugar for the reset (), key (), current (), next () functions (and there are also functions end () and prev ( ) - to organize the search in the reverse order). <br><br>  This statement was correct before PHP 7, but now the situation is a bit wrong - the foreach loop stopped using the same internal pointer as reset (), next () and other iteration functions, so it stopped changing its position. <br><br><h4>  Subtotal </h4><br>  So let's summarize how iteration through arrays in PHP is organized: <br><br><ul><li>  An internal pointer is associated with each array. </li><li>  It can be dropped to the beginning (or end) of the array. </li><li>  It can be moved to the next (previous) item. </li><li>  We can check if the end is not reached - has the pointer gone out of the array? </li><li>  And we can get the key and the value of the current element (pointed to by the pointer) </li></ul><br>  Such a device allows us to organize an iteration over an array (enumeration of its elements) as a loop.  But it is important to understand that the foreach loop, although similarly structured, does not work with the same internal pointer as the reset (), key (), current (), etc. functions, but with its own local for the loop. <br><br><h3>  Iteration over objects </h3><br>  Objects, like arrays, are iterable entities.  A crawl of objects follows their properties visible in this context, and the keys are the names of the properties. <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $first = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $second = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $third = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">iterate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $key =&gt; $value) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $key . <span class="hljs-string"><span class="hljs-string">'=&gt;'</span></span> . $value; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; } } } $foo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Foo; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($foo <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $key =&gt; $value) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $key . <span class="hljs-string"><span class="hljs-string">'=&gt;'</span></span> . $value; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*   first=&gt;1 second=&gt;2 */</span></span> $foo-&gt;iterate(); <span class="hljs-comment"><span class="hljs-comment">/*   first=&gt;1 second=&gt;2 third=&gt;3 */</span></span></code> </pre><br>  However, such an iteration, according to visible properties, is often completely useless.  The most common example is an object that stores a set of values ‚Äã‚Äãin an internal secure storage.  For example, like this: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Storage</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $storage = []; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($key, $val)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage[$key] = $val; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($key)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage[$key]; } }</code> </pre><br>  How to organize an iteration on such an object that does not have public properties?  And how do you generally organize an iteration on some of your own non-standard algorithm? <br><br><h4>  Interface iterator </h4><br>  To implement its own iteration algorithms, PHP (or more precisely SPL) provides a special Iterator interface consisting of five methods: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//       public function current(); //       public function key(); //    ""    public function next(): void; //    ""    public function rewind(): void; //    -      ? public function valid(): bool</span></span></code> </pre><br>  Your class must implement these methods and then you will be able to iterate objects of this class using the foreach loop in accordance with the implemented algorithm. <br><br>  <i>NB ‚ÄúPointer‚Äù, which is mentioned here in the description of Iterator interface methods, is a pure abstraction, in contrast to the actually existing internal array pointer.</i>  <i>It depends only on you exactly how you implement this abstraction, only the result is important - for example, a sequential call to the rewind () and current () methods must return the value of the first element.</i> <i><br></i> <br><div class="spoiler">  <b class="spoiler_title">The simplest example of implementing an Iterator interface</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Example</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Iterator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $storage = []; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($key, $val)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage[$key] = $val; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($key)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage[$key]; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">current</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> current(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">key</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> key(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ next(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rewind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ reset(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">valid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> !== key(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage); } } $test = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Example; $test-&gt;set(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>); $test-&gt;set(<span class="hljs-string"><span class="hljs-string">'baz'</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($test <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $key =&gt; $val) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $key . <span class="hljs-string"><span class="hljs-string">'=&gt;'</span></span> . $val; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; }</code> </pre><br></div></div><br><h4>  Traversable and IteratorAggregate </h4><br>  Strictly speaking, the Traversable interface allows us to iterate using foreach, and Iterator is its successor.  The peculiarity of Traversable is that it cannot be implemented directly (a sort of ‚Äúabstract interface‚Äù) and you should use the Iterator interface or its ‚Äúyounger brother‚Äù IteratorAggregate in your applications.  About him and talk. <br><br>  The SPL includes several built-in iterator classes that allow you to wrap some other entity into an iterator object, such as an array: <br><br><pre> <code class="php hljs">$iterator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayIterator([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($iterator <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $key =&gt; $val) { <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre><br>  The list of such ready-for-iterator wrappers is quite large and includes such useless classes as DirectoryIterator (iterates over a list of files in a given directory), RecursiveArrayIterator (recursive bypass of nested arrays), FilterIterator (crawling with dropping unwanted values) and others, <a href="http://php.net/manual/ru/spl.iterators.php">again dozens of them</a> . <br><br>  Using ready-made iterators and the IteratorAggregate interface allows us to significantly simplify the creation of our own iterator classes.  So, a very long class under the spoiler above can be reduced to about this: <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Example</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IteratorAggregate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $storage = []; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($key, $val)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage[$key] = $val; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($key)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage[$key]; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIterator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Traversable</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayIterator(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;storage); } }</code> </pre><br>  - the result will be the same as with the manual implementation of the Iterator interface. <br><br><h3>  And the generators? </h3><br>  Well, of course.  We use them through foreach! <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Generator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Iterator</span></span></span></span></code> </pre><br>  However, generators are a topic for a separate article.  For now, suffice it to say that there is nothing magic in the mechanism of the generators - the iterator interface is used for iteration.  With the exception of one ‚Äúbut‚Äù - the generator cannot be ‚Äúrewound to the beginning,‚Äù if the iteration has already begun, the call to the rewind () method will throw an exception. <br><br><h3>  Type iterable </h3><br>  Before PHP 7.1 there was a strange picture.  On the one hand, there were iterable objects implementing Traversable via Iterator or IteratorAggregate.  On the same side were the generators, as using the same mechanism.  And on the other side there are arrays and ‚Äúnative‚Äù iteration on the visible properties of objects.  In fact, there were two types of iterable entities that have identical behavior, but have nothing in common. <br><br>  In 7.1, finally, this illogicality was eliminated and we had another ‚Äúpseudotype‚Äù (or, more specifically, a custom type) ‚Äúiterable‚Äù. <br><br>  When once we wait for the type statement in PHP, the iterable type definition can be written like this: <br><br><pre> <code class="php hljs">type iterable = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> | Traversable;</code> </pre><br>  This type combines arrays and all Traversable heirs and indicates the type of values ‚Äã‚Äãthat can be iterated with foreach: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(iterable $it)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($it <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $key=&gt;$val) { <span class="hljs-comment"><span class="hljs-comment">// do something } }</span></span></code> </pre><br><h4>  And what happens? </h4><br>  It turns out such a type diagram: <br><br><pre> <code class="php hljs">iterable ---&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> --&gt; Traversable ---&gt; Iterator --&gt; IteratorAggregate --&gt; Generator</code> </pre><br>  It is worth noting that objects that allow native iteration in their visible properties (‚Äújust an object‚Äù type) are not included in the iterable type.  However, the practical value of the iteration on such objects is not particularly great, so there is no reason to be upset ... <br><br><h4>  What else to read? </h4><br><ul><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D1%2581%25D1%2581%25D0%25BE%25D1%2586%25D0%25B8%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BC%25D0%25B0%25D1%2581%25D1%2581%25D0%25B8%25D0%25B2">ru.wikipedia.org/wiki/%D0%90%D1%81%D1%81%D0%BE%D1%86%D0%B8%D0%B0%D1%82%D0%B8%D0B2%D0 % BD% D1% 8B% D0% B9_% D0% BC% D0% B0% D1% 81% D1% 81% D0% B8% D0% B2</a> </li><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%25A6%25D0%25B8%25D0%25BA%25D0%25BB_(%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5)">https://ru.wikipedia.org/wiki/%D0%A6%D0%B8%D0%BA%D0%BB_((%D0%BF%D1%80%D0%BE%D0%B3%D1%80 D0% B0% D0% BC% D0% BC% D0% B8% D1% 80% D0% BE% D0% B2% D0% B0% D0% BD% D0% B8% D0% B5) #. D0.A1. D0.BE.D0.B2.D0.BC.D0.B5.D1.81.D1.82.D0.BD.D1.8B.D0.B9_.D1.86.D0.B8.D0.BA.D0. BB</a> </li><li>  <a href="http://php.net/manual/ru/language.types.array.php">php.net/manual/ru/language.types.array.php</a> </li><li>  <a href="http://php.net/manual/ru/control-structures.foreach.php">php.net/manual/ru/control-structures.foreach.php</a> </li><li>  <a href="http://php.net/manual/ru/language.oop5.iterations.php">php.net/manual/ru/language.oop5.iterations.php</a> </li><li>  <a href="http://php.net/manual/ru/spl.iterators.php">php.net/manual/ru/spl.iterators.php</a> </li><li>  <a href="http://php.net/manual/ru/class.traversable.php">php.net/manual/ru/class.traversable.php</a> </li></ul><br>  Successes on interview and in work! </div><p>Source: <a href="https://habr.com/ru/post/324934/">https://habr.com/ru/post/324934/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324922/index.html">Threat Horizon 2017-2019 by the International Security Forum (executive executive)</a></li>
<li><a href="../324924/index.html">Cook ML Boot Camp III: Starter Kit</a></li>
<li><a href="../324926/index.html">We are friends of Angular with Google (Angular Universal)</a></li>
<li><a href="../324930/index.html">WhatsApp messages may be available to outsiders: a serious vulnerability allows access to your correspondence</a></li>
<li><a href="../324932/index.html">Everything you wanted to know about stack traces and hip dumps. Part 1</a></li>
<li><a href="../324936/index.html">SQL or NoSQL - that is the question</a></li>
<li><a href="../324940/index.html">A selection of useful tools with Product Hunt for March</a></li>
<li><a href="../324942/index.html">Solving problems with the memory occupied by the IntelliMemory module in Diskeeper and SSDkeeper</a></li>
<li><a href="../324944/index.html">Web typography</a></li>
<li><a href="../324946/index.html">Omegicus Digest: Antialiasing Fonts and Encryption and Compression Library</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>