<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to modular arithmetic</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In ordinary life, we usually use the positional number system. In the positional number system, the value of each numeric character (number) in the nu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to modular arithmetic</h1><div class="post__text post__text-html js-mediator-article">  In ordinary life, we usually use the positional number system.  In the positional number system, the value of each numeric character (number) in the number record depends on its position (digit) [1].  However, there are also so-called ‚Äúnonpositional numeral systems‚Äù, one of which is the ‚Äúresidual class system‚Äù (SOC) (or the original Residue Number System (RNS)), which is the basis of modular arithmetic.  Modular arithmetic is based on the ‚ÄúChinese remainder theorem‚Äù [2], which for our case is as follows: <br><blockquote>  For any system of mutually prime numbers p <sub>1</sub> , ... p <sub>n</sub> , any number X from the range [0;  M), where M = p <sub>1</sub> * p <sub>2</sub> * ... * p p <sub>n is</sub> mutually uniquely representable as a vector (a <sub>1</sub> , a <sub>2</sub> , ..., a <sub>n</sub> ), where a <sub>i</sub> = X% p <sub>i</sub> (hereinafter "%" - the operation of taking the remainder of the integer division of X by p <sub>i</sub> ). <br>  p <sub>1</sub> , ... p <sub>n</sub> - system modules <br>  a <sub>1</sub> , a <sub>2</sub> , ..., a <sub>n</sub> - residues (deductions) of numbers according to a given system of modules <br></blockquote><br><a name="habracut"></a><br>  At first glance, it is unclear what advantage such a system can give, however, there are 2 properties that allow you to effectively use modular arithmetic in some areas of microelectronics: <br><ol><li>  Lack of transfer of discharges in addition and multiplication.  Let us be given two numbers X <sub>1</sub> and X <sub>2</sub> , represented as a system of residuals (x <sub>11</sub> , x <sub>12</sub> , ..., x <sub>1n</sub> ) and (x <sub>21</sub> , x <sub>22</sub> , ..., x <sub>2n</sub> ) in the system of mutually simple numbers (p <sub>1</sub> , p <sub>2</sub> , ..., p <sub>n</sub> ).  In this case: <br>  X <sub>3</sub> = X <sub>1</sub> + X <sub>2</sub> = ((x <sub>11</sub> + x <sub>21</sub> )% p <sub>1</sub> , (x <sub>12</sub> + x <sub>22</sub> )% p <sub>2</sub> , ..., (x <sub>1n</sub> + x <sub>2n</sub> )% p <sub>n</sub> ) <br>  X <sub>4</sub> = X <sub>1</sub> * X <sub>2</sub> = ((x <sub>11</sub> * x <sub>21</sub> )% p <sub>1</sub> , (x <sub>12</sub> * x <sub>22</sub> )% p <sub>2</sub> , ..., (x <sub>1n</sub> * x <sub>2n</sub> )% p <sub>n</sub> ) <br>  That is, to add or multiply two numbers, it is enough to add or multiply the corresponding elements of the vector, which for microelectronics means that this can be done in parallel and due to the small dimensions p <sub>1</sub> , p <sub>2</sub> , ..., p <sub>n</sub> to do it very quickly. </li><li>  Error in one position of the vector does not affect the calculations in other positions of the vector.  In contrast to the positional number system, all elements of the vector are equivalent and an error in one of them only leads to a reduction in the dynamic range.  This fact allows you to design devices with high fault tolerance and error correction. </li></ol><habracut><table><tbody><tr><td>  Normal multiplication </td><td>  Modular multiplication </td></tr><tr><td><img src="https://habrastorage.org/storage2/1b8/aef/269/1b8aef2694cbdc134268f5c0d426eac0.png"></td><td><img src="https://habrastorage.org/storage2/9b7/e19/5b3/9b7e195b3e9fb2ac71a35d9e4c620d7e.png"></td></tr></tbody></table><br>  But not everything is as smooth as we would like.  Unlike the positional number system, the following operations (called ‚Äúnon-modular‚Äù) are more complicated than in the positional number system: comparison of numbers, control of overflow, division, square root, etc.  The first successful attempts to use modular arithmetic in microelectronics were made as early as the 1950s, but due to difficulties with non-modular operations, interest has somewhat subsided.  However, at present, modular arithmetic is again being returned to microelectronics for the following reasons: <br><ul><li>  large distribution of mobile processors, which require high speed with low power consumption.  The absence of transference in arithmetic operations of addition / multiplication reduces energy consumption. </li><li>  The increasing density of elements on a chip in some cases does not allow for a full test, therefore the importance of the stability of processors to possible errors grows. </li><li>  the emergence of specialized processors with a large number of operations on vectors that require high speed and mainly include addition and multiplication of numbers (as an example, matrix multiplication, scalar product of vectors, Fourier transforms, etc.). </li></ul><br>  At present, modular arithmetic is used in the following areas: digital signal processing, cryptography, image / audio / video processing, etc. <br><br><h2>  Direct conversion </h2><br><br>  Direct conversion from a positional number system (usually in binary form) to a number system in the residuals consists in finding the residuals from the division for each of the modules of the system. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  <b>Example</b> : Suppose you want to find a representation of the number X = 25 by the system of modules (3, 5, 7).  X = (25% 3, 25% 5, 25% 7) = (1, 0, 4). </blockquote><br>  The implementation of finding a deduction in microelectronics for a given module is based on the following properties of deductions: <br>  (a + b)% p = (a% p + b% p)% p <br>  (a * b)% p = (a% p * b% p)% p <br><br>  Any number X can be written as X% p = (x <sub>n-1</sub> * 2 <sup>n-1</sup> + x <sub>n-2</sub> * 2 <sup>n-2</sup> + x <sub>0</sub> * 2 <sup>0</sup> )% p = ((x <sub>n-1</sub> )% p * 2 <sup>n-1</sup> % p) + ((x <sub>n-2</sub> )% p * 2 <sup>n-2</sup> % p) + ... + x <sub>0</sub> % p)% p.  Since in this case x <sub>n-1</sub> , ... x <sub>0 is</sub> equal to 0 or 1, we actually need to add residues of the form (2 <sup>i</sup> % p). <br><blockquote>  <b>Example</b> : let the number 25 be given or in binary notation 11001 and it is required to find the remainder modulo 7. <br>  25% 7 = (1 * 2 <sup>4</sup> + 1 * 2 <sup>3</sup> + 0 * 2 <sup>2</sup> + 0 * <sup>1</sup> + 1 * 2 <sup>0</sup> )% 7 = (2 <sup>4</sup> % 7 + 2 <sup>3</sup> % 7 + 1% 7)% 7 = (2 + 1 + 1)% 7 = 4 </blockquote><br>  The system of modules used is selected for a specific task.  For example, to represent 32-bit numbers, the following system of modules is enough: (7, 11, 13, 17, 19, 23, 29, 31) - they are all mutually simple with each other, their product is 6685349671&gt; 4294967296. Each of the modules is not exceeds 5 bits, that is, addition and multiplication operations will be performed on 5-bit numbers. <br>  Of particular importance is also the system of modules of the form: (2 <sup>n</sup> -1, 2 <sup>n</sup> , 2 <sup>n</sup> +1) due to the fact that the direct and inverse transformations for them are carried out in the simplest way.  To get the remainder of the division by 2 <sup>n, it</sup> suffices to take the last n digits of the binary representation of a number. <br><br><h2>  Arithmetic operations </h2><br><blockquote>  <b>Example</b> : let the system of modules (3, 5, 7) be given, that is, we can perform operations whose result does not exceed 3 * 5 * 7 = 105. Multiply two numbers 8 and 10. <br>  8 = (8% 3, 8% 5, 8% 7) = (2, 3, 1) <br>  10 = (10% 3, 10% 5, 10% 7) = (1, 0, 3) <br>  8 * 10 = ((2 * 1)% 3, (3 * 0)% 5, (1 * 3)% 7) = (2, 0, 3) <br>  Check <br>  80 = (80% 3, 80% 5, 80% 7) = (2, 0, 3) </blockquote><br><h2>  Inverse transform </h2><br><br>  The inverse conversion from the number system in the residual classes to the positional number system is performed in one of two ways: <br><ol><li>  Based on the Chinese theorem on residues or a system of orthogonal bases </li><li>  Based on polyadic code (other names are mixed-radix system, mixed base system) </li></ol><br>  The rest of the methods proposed in various literature are essentially a mixture of these two. <br><br>  The method based on the Chinese theorem on residuals is based on the following idea: <br>  X = (x <sub>1</sub> , x <sub>2</sub> , ... x <sub>n</sub> ) = (x <sub>1</sub> , 0, ..., 0) + (0, x <sub>2</sub> , ..., 0) + ... + (0, 0, ..., x <sub>n</sub> ) = x <sub>1</sub> * (1, 0, ..., 0) + x <sub>2</sub> * (0, 1, ..., 0) + ... + x <sub>n</sub> * (0, 0, ..., 1). <br>  That is, for the inverse transformation, it is required to find the system of orthogonal bases B1 = (1, 0, ..., 0), B2 = (0, 1, ..., 0), ..., BN = (0, 0, ..., 1).  These vectors are found once for a given basis, and for their search it is required to solve an equation of the form: (M <sub>i</sub> * b <sub>i</sub> )% p <sub>i</sub> = 1, where M <sub>i</sub> = M / p <sub>i</sub> , and b <sub>i</sub> is the required number.  In this case, the positional representation of B <sub>i</sub> = M <sub>i</sub> * b <sub>i</sub> and <br>  X = (x <sub>1</sub> * (M <sub>1</sub> * b <sub>1</sub> ) + x <sub>2</sub> * (M <sub>2</sub> * b <sub>2</sub> ) +‚Ä¶ + x <sub>n</sub> * (M <sub>n</sub> * b <sub>n</sub> ))% M <br><br><blockquote>  <b>Example</b> : Let the system of modules (3, 5, 7) be given, find the values ‚Äã‚Äãof M <sub>i</sub> and b <sub>i</sub> (0 &lt;i &lt;= 3) <br>  M = 3 * 5 * 7 = 105 <br>  M <sub>1</sub> = 105/3 = 35 <br>  M <sub>2</sub> = 105/5 = 21 <br>  M <sub>3</sub> = 105/7 = 15 <br>  (35 * b <sub>1</sub> )% 3 = 1 =&gt; b <sub>1</sub> = 2 <br>  (21 * b <sub>2</sub> )% 5 = 1 =&gt; b <sub>2</sub> = 1 <br>  (15 * b <sub>3</sub> )% 7 = 1 =&gt; b <sub>3</sub> = 1 <br>  Now we transform any number in the system of residual classes.  Set <br>  X = (2, 3, 1) = (2 * 35 * 2 + 3 * 21 * 1 + 1 * 15 * 1)% 105 = (140 + 63 + 15)% 105 = 218% 105 = 8 </blockquote><br>  The disadvantage of this method is that the inverse transformation requires multiplication and addition of large numbers (M <sub>1</sub> , ..., M <sub>n</sub> ), as well as the operation of taking the remainder modulo a large number M. <br><br>  The method based on the polyadic code is based on the idea that any number X can be represented in the system of coprime numbers p <sub>1</sub> , ... p <sub>n</sub> , as [4]: <br>  X = a <sub>1</sub> + a <sub>2</sub> * p <sub>1</sub> + a <sub>3</sub> * p <sub>1</sub> * p <sub>2</sub> + ... + a <sub>n-1</sub> * p <sub>1</sub> * p <sub>2</sub> * ... * p <sub>n-2</sub> + a <sub>n</sub> * p <sub>1</sub> * p <sub>2</sub> * ... * p <sub>n-1</sub> , where 0 &lt;a <sub>i</sub> &lt;p <sub>i</sub> <br><ul><li>  X% p <sub>1</sub> = x <sub>1</sub> = a <sub>1</sub> </li><li>  (X - a <sub>1</sub> )% p <sub>2</sub> = (x <sub>2</sub> - a <sub>1</sub> )% p <sub>2</sub> = (a <sub>2</sub> * p <sub>1</sub> )% p <sub>2</sub> =&gt; a <sub>2</sub> = ((p <sub>1</sub> <sup>-1</sup> )% p <sub>2</sub> * (x <sub>2</sub> - a <sub>1</sub> ))% p <sub>2</sub> </li><li>  (X - a <sub>1</sub> - a <sub>2</sub> * p <sub>1</sub> )% p <sub>3</sub> = (a <sub>3</sub> * p <sub>1</sub> * p <sub>2</sub> )% p <sub>3</sub> =&gt; a <sub>3</sub> = ((p <sub>2</sub> <sup>-1</sup> )% p <sub>3</sub> * ((p <sub>1</sub> <sup>- 1</sup> )% p <sub>3</sub> * (x <sub>3</sub> - a <sub>1</sub> ) - a <sub>2</sub> ))% p <sub>3</sub> </li><li>  ... </li></ul><br>  To use this method, constants of the form (p <sub>i</sub> <sup>-1</sup> )% p <sub>k</sub> <sup>-1</sup> are required.  You may also notice that you can start calculating a <sub>3</sub> as soon as the value a <sub>1</sub> appears.  Based on this method, you can build a conveyor converters. <br><br><blockquote>  <b>Example</b> : Consider the same example - find the positional representation of the number X = (2, 3, 1) in the system of modules (3, 5, 7) <br><ul><li>  a <sub>1</sub> = x <sub>1</sub> = 2 </li><li>  a <sub>2</sub> = ((p <sub>1</sub> <sup>-1</sup> )% p <sub>2</sub> * (x <sub>2</sub> - a <sub>1</sub> ))% p <sub>2</sub> = ((3 <sup>-1</sup> )% 5 * (3 - 2))% 5 = 2 * 1 = 2 </li><li>  a <sub>3</sub> = ((p <sub>2</sub> <sup>-1</sup> )% p <sub>3</sub> * ((p <sub>1</sub> <sup>-1</sup> )% p <sub>3</sub> * (x <sub>3</sub> - a <sub>1</sub> ) - a <sub>2</sub> ))% p <sub>3</sub> = ((5 <sup>-1</sup> )% 7 * ((3 <sup>-1</sup> )% 7 * (1 - 2) - 2))% 7 = (3 * (5 * (1-2) -2))% 7 = (3 * (- 7))% 7 = 0 </li><li>  X = a <sub>1</sub> + a <sub>2</sub> * p <sub>1</sub> + a <sub>3</sub> * p <sub>1</sub> * p <sub>2</sub> = a <sub>1</sub> + 3 * a <sub>2</sub> + 15 * a <sub>3</sub> = 2 + 3 * 2 + 15 * 0 = 8 </li></ul><br>  <i>Note</i> : to find a constant of the form (3 <sup>-1</sup> )% 5, it is required to solve the equation (3 * x)% 5 = 1, where 0 &lt;= x &lt;5 <br></blockquote><br><h2>  PS </h2><br>  The article is written somewhat messy, because the topic is quite large and it is not possible to contain everything in one article.  In the following articles I will try to describe in more detail the various aspects of modular arithmetic.  On Habr√©, I did not find anything at all related to this topic, only brief mentions in other articles, so it was decided to write a short review with simple examples.  For those who are interested in the topic, I recommend reading the book number [3] from the list of references (in English), it is written in an accessible language with many examples. <br><br><h2>  Literature </h2><br>  [1] <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25B7%25D0%25B8%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0_%25D1%2581%25D1%2587%25D0%25B8%25D1%2581%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F">en.wikipedia.org/wiki/%D0%9F%D0%BE%D0% B7% D0% B8% D1% 86% D0% B8% D0% BE% D0% BD% D0% BD% D0% B0% D1% 8F_% D1% 81% D0% B8% D1% 81% D1% 82% D0% B5% D0% BC% D0% B0_% D1% 81% D1% 87% D0% B8% D1% 81% D0% BB% D0% B5% D0% BD% D0% B8% D1% 8F</a> <br>  [2] <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B8%25D1%2582%25D0%25B0%25D0%25B9%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D1%2582%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%25BE%25D0%25B1_%25D0%25BE%25D1%2581%25D1%2582%25D0%25B0%25D1%2582%25D0%25BA%25D0%25B0%25D1%2585">en.wikipedia.org/wiki/%D0%9A%D0%B8%D1%82%D0%B0%D0%B9%D1%81 %D0BA0DB %%D0 82% D0% B5% D0% BE% D1% 80% D0% B5% D0% BC% D0% B0_% D0% BE% D0% B1_% D0% BE% D1% 81% D1% 82% D0% B0% D1% 82% D0% BA% D0% B0% D1% 85</a> <br>  [3] Amos Omondi, Benjamin Premkumar, Residue Number Systems: Theory and Implementation, 2007. <br>  [4] MA Soderstrand, WK Jenkins, GA Jullien and FJ Taylor.  1986. Residue Number System Arithmetic: Modern Applications in Digital Signal Processing, IEEE Press, New York. </habracut></div><p>Source: <a href="https://habr.com/ru/post/144886/">https://habr.com/ru/post/144886/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../144877/index.html">Turn on Yandex.Music on iPhone</a></li>
<li><a href="../144880/index.html">Sending letters to Google Docs (Drive)</a></li>
<li><a href="../144881/index.html">Neural networks for dummies. Part 2 - Perceptron</a></li>
<li><a href="../144884/index.html">Phorm</a></li>
<li><a href="../144885/index.html">We correspond with the torrent client</a></li>
<li><a href="../144888/index.html">Powershell: Shuffle Files</a></li>
<li><a href="../144893/index.html">History of displacement sensors</a></li>
<li><a href="../144894/index.html">Default of Greece. Consequences in a nutshell</a></li>
<li><a href="../144895/index.html">Everything you need to know about Mail forwarding for $ 0</a></li>
<li><a href="../144896/index.html">Dell began testing prototype ARM servers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>