<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write our plugin for Windows Media Center. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, habra-community! 

 Small lyrical digression 
 On this wonderful day, all those who are not indifferent to such words as development, code, com...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write our plugin for Windows Media Center. Part 1</h1><div class="post__text post__text-html js-mediator-article">  Hello, habra-community! <br><br><h4>  Small lyrical digression </h4><br>  On this wonderful day, all those who are not indifferent to such words as development, code, compilation and debugging, those who are currently typing their anniversary 100 million line of code and those who have successfully compiled and launched the first Hello, World! I want to congratulate you on your professional holiday.  I wish you fewer bugs, fast compilers, mutual understanding with the debugger and most importantly, that there should be a number of people able to appreciate your work! <br><br><h4>  And now - let's start </h4><br>  Recently, I started writing my application under <abbr title="Windows Media Ceneter">WMC</abbr> . <br>  Translation and quoting SDK is boring and not interesting. <br>  Therefore, today I will describe step by step the creation of a simple plug-in. <br>  Let's try to write a simple analog clock. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What do we need? </h4><br><ol><li>  Windows with MediaCenter installed (I'm using Windows 7 ultimate rtm) </li><li>  Microsoft Visual Studio (I will give examples for version 2008) </li><li>  Microsoft MediaCenter SDK (Hereinafter we focus on version 6.0) </li></ol><br><h4>  Installation </h4><br>  Download the SDK <a href="http://www.microsoft.com/downloads/details.aspx%3Fdisplaylang%3Den%26FamilyID%3D542fc60e-f3c4-43a0-8dad-b8f14a485a74">at this address</a> . <br>  The SDK is installed after installing Visual Studio. <br>  The examples included in the development kit are located in the% Program Files% \ Microsoft SDKs \ Windows Media Center \ v6.0 \ Samples folder. <br><br><h4>  Create a simple empty application template </h4><br>  Launch Visual Studio. <br><pre>  File -&gt; Create -&gt; Project -&gt; New Project </pre><br>  If the installation and integration of the SDK was successful, then you can easily find the Windows Media Center branch in the type tree. <br>  I chose C # as the development language. <br> <a href="http://ipicture.ru/Gallery/Viewfull/23576148.html"><img src="http://pic.ipicture.ru/uploads/090911/thumbs/i40EvK3wIp.jpg"></a> <br>  Select the template Windows Media Center Application - Fundamental. <br>  We give our project a name, for example habraClock. <br>  Click OK. <br><br><h4>  What is in front of us? </h4><br>  I think that the Visual Studio interface should not be separately described, we all are very familiar with it. <br>  Let's better see what we see in the solution browser. <br> <a href="http://ipicture.ru/Gallery/Viewfull/23576530.html"><img src="http://pic.ipicture.ru/uploads/090911/thumbs/VH28n4PUy1.jpg"></a> <br>  In the Code folder is the Launch.cs file.  This file describes our class MyAddIn, inheriting the interfaces IAddInModule, IAddInEntryPoint. <br>  The Launch procedure implements the IAddInEntryPoint interface member and is the entry point.  This is what is called when launching our application in Media Center. <br><br>  The basic navigation objects of WMC are pages described in the xml-based markup language <abbr title="Media Center Markup Language">MCML</abbr> . <br>  The only thing that the Launch procedure will do in our example is to navigate to the Default page described in the Markup folder's Default.mcml file. <br><br>  Also important for us are DevInstall.cmd files in the project bark and Registration.xml in the Setup folder. <br>  DevInstall.cmd is needed to register our build in the system.  Without performing this action, we will not see anything new in WMC applications. <br>  To register our plugin, you need to run the command prompt in administrator mode, go to the project folder, and run there <pre>  DevInstall.cmd / debug </pre><br>  The / debug switch is added if the debug build configuration.  If the Release configuration is going to be, then the key is not needed. <br>  Another startup option is / u.  The key is used to remove information about our plugin from the system. <br><br>  In order not to suffer with a large number of open windows, I do this - in the project properties on the ‚ÄúBuild Events‚Äù tab, I add automatic assembly registration to the event after build.  Accordingly, Visual Studio runs in administrator mode. <br><br><h4>  Sign the assembly </h4><br>  In order for the plugin to run in WMC, it must be signed. <br>  In the project properties, go to the ‚ÄúSigning‚Äù tab, check the ‚ÄúSign the build‚Äù box and select the snk file with your signature. <br>  If you do not already have such a file, then create it by selecting the "Create" item from the drop-down list. <br>  Putting the project (F6). <br>  Run the command line to get the assembly's public key token.  In the command line we execute <pre>  % Program Files% \ Microsoft SDKs \ Windows \ v6.0A \ Bin \ sn.exe -T [path to our project] \ Bin \ Debug \ habraClock.dll </pre><br>  At the output we get a string of the form <pre>  Public key token: 597ac92eb14461f4 </pre><br>  Open the Registration.xml file in the Setup folder and change there <strong>PublicKeyToken = insert_public_key_token_here</strong> to <strong>PublicKeyToken = 597ac92eb14461f4</strong> <br>  We build the project, install DevInstall'om (unless, of course, you have not registered the automatic installation of my recipe). <br><br><h4>  We admire the results of our work </h4><br>  Launch Media Center. <br>  If we did everything correctly, then on the page "Applications" we will see, among others, our habraClock. <br> <a href="http://ipicture.ru/Gallery/Viewfull/23581266.html"><img src="http://pic.ipicture.ru/uploads/090911/thumbs/8wDRoL6u6V.jpg"></a> <br><br>  After its launch, the contents of the Default.mcml file will appear on the screen, namely, the string with the text Hello. <br> <a href="http://ipicture.ru/Gallery/Viewfull/23659743.html"><img src="http://pic.ipicture.ru/uploads/090913/thumbs/tmiVNmbXzJ.jpg"></a> <br><br><h4>  Conclusion </h4><br>  Today we learned how to create, sign and register an application for Windows Media Center. <br>  At this point I want to finish the first part of the article. <br>  And, while I am engaged in its continuation - a small homework. <br>  Since I myself am not a designer at all - think up and change the standard image of the application for something more sane and associated with the habr. <br><br>  Waiting for your suggestions, suggestions, critics. <br><br>  2009 <a href="http://habrahabr.ru/users/lnking/" class="user_link">lnking</a> .  Any use of materials of this article outside the Habr is permitted with the obligatory indication of the source. </div><p>Source: <a href="https://habr.com/ru/post/69371/">https://habr.com/ru/post/69371/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../69365/index.html">Canobuviya, Issue 004</a></li>
<li><a href="../69366/index.html">YouTube API, continued: editing, deleting, retrieving meta data</a></li>
<li><a href="../69367/index.html">FireFox + Firebug vs IE8 Developer Toolbar</a></li>
<li><a href="../69368/index.html">Acer Ferrari One: netbooks become more interesting</a></li>
<li><a href="../69369/index.html">A small blockbuster on Shareware</a></li>
<li><a href="../69372/index.html">Reduce back font in Google search bar (for Firefox)</a></li>
<li><a href="../69374/index.html">From the headquarters of Microsoft take the server</a></li>
<li><a href="../69375/index.html">Obmateru / Yours site</a></li>
<li><a href="../69377/index.html">5 weeks with Intel</a></li>
<li><a href="../69379/index.html">Password as motivation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>