<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Building a network for data storage systems of the small and medium business sector Part 2. Practical issues of organizing small infrastructures</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Preface to the 2nd part 
 The first part dealt with the basic aspects of building storage systems. Now we will talk about the practical component, in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Building a network for data storage systems of the small and medium business sector Part 2. Practical issues of organizing small infrastructures</h1><div class="post__text post__text-html js-mediator-article"><h3>  Preface to the 2nd part </h3><br>  The <a href="https://habrahabr.ru/company/zyxel/blog/351260/">first part</a> dealt with the basic aspects of building storage systems.  Now we will talk about the practical component, in particular, the use of selected equipment, exchange protocols and topology of the internal network. <a name="habracut"></a><br><br><h3>  Network Protocols and Required Functions </h3><br>  Before you begin to build a storage system, you need to decide, it has to be used. <br><br>  At present, there are quite a lot of different protocols that one way or another can be used in the exchange between the server and the storage system.  However, it is best to choose the most versatile, and, at the same time, the most undemanding ones. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All storage systems and protocols for data exchange can be divided according to the type of access into: file and block. <br><br>  File access storages are network resources with which data is exchanged via popular application layer protocols.  The most commonly used: CIFS, NFS, AFP.  Other file transfer protocols are used, such as FTP, TFTP, SFTP, and so on.  Such devices are called Network Attached Storage, in abbreviated form - NAS.  In essence, a NAS is a file server whose hardware and software is optimized for storing and sharing files. <br><br>  Storage with block access provides for the use of specially organized volumes with unique numbers - Logical Unit Number, LUN.  At the same time, connected storage resources from the point of view of logical organization look like local hard drives.  In this case, special access protocols are used, such as FCP (for the Fiber Channel), and iSCSI, FCoE, ATAoE, and others - for Ethernet networks.  Storage systems of this type are called Storage Area Network, abbreviated as ‚ÄúSAN‚Äù and represent disk arrays connected to a high-performance data transfer network.  The iSCSI protocol is very popular among budget storage systems due to its ease of implementation and unpretentiousness to resources. <br><br>  <i><b>IMPORTANT NOTICE</b> .</i>  <i>Within this article it is impossible to talk about all aspects of the creation and operation of storage.</i>  <i>Therefore, for additional information it is worth contacting with other sources.</i>  <i>Some of them are listed at the end of the article.</i> <br><br>  Block-access storage (like a local hard disk) under normal use does not allow for more than one connection without risk of data loss, while file storages may be available to connect to multiple clients. <br><br>  <i><b>NOTE</b> .</i>  <i>Under certain conditions, block storage can be connected to several clients, for example, when using shared disk file systems.</i>  <i>In particular, VMware ESX (i) host servers can simultaneously connect and work with block access storage systems with a VMFS file system.</i> <br><br>  Restriction requires certain access control measures.  In the Fiber Channel networks, zoning is used for this, for the Ethernet family - an authentication mechanism for passwords and division into virtual subnets (VLANs). <br><br>  <i><b>NOTE</b> .</i>  <i>A Virtual Local Area Network (VLAN) is an artificially limited LAN segment as a group of ports with a single set of properties, for example, with the same security requirements.</i>  <i>Allows you to exchange information among themselves within a single virtual broadcast domain, regardless of the physical location of the connected devices.</i> <br><br>  Another important parameter that dictates the block access to us is the reservation of the communication channel.  If in the event of a line break when copying to a network share, you just have to overwrite the file, then with block access this is fraught with serious errors in the file system.  The combination of several data lines in the Ethernet family of networks into one logical channel will come in handy here.  This function is called link aggregation - Link Aggregation, abbreviated - LAGG.  In addition to improving fault tolerance, channel aggregation allows for increased bandwidth. <br><br>  In operating UNIX-like systems: Linux, BSD, Solaris, which are taken as the basis for building various storage systems, the most commonly used protocol is LACP - Link Aggregation Control Protocol.  This open standard protocol is described in the IEEE 802.3ad and IEEE 802.1aq documents and is commonly used to aggregate channels in simple systems. <br><br>  To improve system performance, it is extremely important to reduce the cost of traffic maintenance.  One way is to use larger data packets.  Accordingly, if fewer packets are required to transmit the same information, this will reduce processing time and save hardware resources.  Therefore, the function Jumbo Frame will also be superfluous. <br><br>  <i><b>NOTE</b> .</i>  <i>Jumbo frame - a mechanism in the Ethernet family of networks, thanks to which, it is possible to transmit data blocks exceeding 1500 bytes (the value specified by the IEEE 802.3 group standards) - or, as they say, increase the MTU by more than 1500 bytes).</i>  <i>The most popular practice in IP-based storage systems is to set the frame size to 9000 bytes of data, for example, to speed up the exchange via the iSCSI, NFS, GIFS (SMB) protocols.</i> <br><br>  All the above features: VLAN, LAGG (LACP) and Jumbo Frames - are in our chosen switch Zyxel XS1920 Series. <br><br><h3>  Storage System Topology </h3><br>  Building small storage systems for medium and small businesses, on the one hand, imposes certain restrictions in terms of cost, on the other hand, it allows some relief in the area of ‚Äã‚Äãresiliency and security. <br>  To begin, consider the simple scheme itself in Figure 1. <br><br>  In this case, there is a virtual system of 4 servers connected to one storage through a dedicated switch.  To increase bandwidth, all connections are duplicated via the port aggregation function.  Thus, 10 RJ45 ports on 10 Gigabit Ethernet are involved.  The remaining 2 universal 10 Gigabit Ethernet ports are reserved and can later be used to connect another storage system or server. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/11/ej/y0/11ejy0rea_4zjzgusvhhiuwzwuy.png"></div><br>  <i>Figure 1. A simple storage network.</i> <br><br>  Please note that the switch in the above scheme is used completely offline.  There is no connection to other network segments (Uplink / Downlink) and nothing is connected to it except for servers and the storage system.  This isolation is justified both in terms of fault tolerance, and to optimize and simplify network exchange. <br><br>  When building this simple network, it should be noted that most storage systems and servers have a special port for management, for example, via IPMI.  In addition, to improve the control over home-made storage systems, an additional network card is often used, to which the management interface is sent via HTTP / HTTPS or Telnet / SSH protocols. <br><br>  <i><b>NOTE</b> .</i>  <i>IPMI - Intelligent Platform Management Interface, - a dedicated interface for monitoring and management.</i>  <i>The most famous implementations are: iLO made by HP and IMM2, developed by IBM.</i>  <i>IPMI is available even when the main device is in an inactive state.</i>  <i>Through IPMI, you can turn off, turn on, reboot the system, capture the console to control, take readings from sensors, such as temperature, power, and so on.</i> <br><br>  As an inexpensive solution for the organization of such a network, any switch with a Fast Ethernet interface (100Mb / s) or Gigabit Ethernet is suitable.  In order to minimize the costs of its acquisition, as well as management, staff training, and so on, it makes sense to choose equipment from one manufacturer as the main storage network.  For example, in our case, the Zyxel GS1100-8HP model, a switch with 8 Gigabit ports, will do quite well. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rw/bo/ii/rwboiixiyuiqqowwr6spm3y9o-o.png"></div><br>  <i>Figure 2. An example of the organization of a dedicated control network.</i> <br><br>  If the requirements for fault tolerance are high, you must use a circuit with two switches.  In order to avoid conflict when accessing the same iSCSI volumes across different connections, the multipathing mechanism is used.  An additional bonus in this case will be the possibility of balancing and an increase in the number of ports that can be used both to connect devices and to expand the channel. <br><br>  <i><b>NOTE</b> .</i>  <i>Multipathing is a technology for connecting storage nodes using several independent lines.</i>  <i>For example, one storage device can be connected to a server using multiple iSCSI channels.</i>  <i>In case of failure of one of the connections, the operating system will use the remaining healthy communication lines to access the device.</i>  <i>This architecture increases the resiliency of the system and allows you to distribute the load, which leads to an increase in speed in general.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8x/7w/n3/8x7wn3otdv9popnvgh-fulz-608.png"></div><br>  <i>Figure 3. Diagram with two switches.</i>  <i>(To simplify the perception, the control network is not shown).</i> <br><br>  The Zyxel XS1920 Series Switch is well-suited for small data storage.  For larger infrastructures, we can recommend another model - 24 port switch 10GbE L2 + XS3700 Series. <br><br><h3>  Conclusion </h3><br>  Building an inexpensive data storage system that meets the requirements of a business is not an easy task, but it can be implemented.  Of course, in a brief narrative it is impossible to cover all aspects of this vast area of ‚Äã‚ÄãIT.  For example, issues such as duplication of storage systems for fault tolerance, the creation of geographically distributed storage systems, and so on have remained behind the scenes.  However, as a first step, the experience of building simple solutions for centralized data storage will certainly be useful and will allow in the future to organize an effective infrastructure for various purposes. <br><br><h3>  Sources: </h3><br><ol><li>  <a href="http://samag.ru/archive/article/3383">Berezhnoy A. Use of iSCSI when building storage systems // System Administrator, No. 3, 2017</a> </li><li>  <a href="https://4sysops.com/archives/how-to-configure-esxi-6-5-for-iscsi-shared-storage/">ESXi 6.5 for iSCSI Shared Storage</a> </li><li>  LACP (description) - <a href="http://xgu.ru/wiki/LACP">xgu.ru/wiki/LACP</a> </li><li>  <a href="http://ethernetalliance.org/library/whitepaper/ethernet-jumbo-frames/">Ethernet Alliance.</a>  <a href="http://ethernetalliance.org/library/whitepaper/ethernet-jumbo-frames/">Ethernet Jumbo Frames</a> </li><li>  <a href="https://www.zyxel.com/ru/ru/products_services/12-port-10GbE-Smart-Managed-Switch-XS1920-Series/">Zyxel XS1920 Series Switch Switch Description</a> </li><li>  <a href="https://www.intel.com/content/www/us/en/servers/ipmi/ipmi-home.html">Intelligent Platform Management Interface (IPMI)</a> </li><li>  <a href="https://www.zyxel.com/ru/ru/products_services/8-10-16-24-port-GbE-Unmanaged-Switch-GS1100-Series/">Description of unmanaged switches on 8/10/16/24 GbE ports - Zyxel GS1100 Series</a> </li><li>  <a href="http://xgu.ru/wiki/multipath">Multipath (description)</a> </li><li>  <a href="https://www.zyxel.com/ru/ru/products_services/24-port-10GbE-L2--Switch-XS3700-Series/">Zyxel XS3700 Series Switch Switch Description</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/354194/">https://habr.com/ru/post/354194/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354182/index.html">"Profession - scientist": how to start a career as a researcher in the magistracy ITMO University</a></li>
<li><a href="../354184/index.html">Typography in iOS</a></li>
<li><a href="../354188/index.html">Prefetch and preload webpack directives</a></li>
<li><a href="../354190/index.html">Using the principles of gestalt psychology in web design</a></li>
<li><a href="../354192/index.html">Moscow SPA ‚Ññ4: summary, video, presentations, photo report</a></li>
<li><a href="../354196/index.html">Creating the main menu of the game</a></li>
<li><a href="../354198/index.html">How to transfer a polymorphic object to the STL algorithm</a></li>
<li><a href="../354200/index.html">Unified Scalable Remuneration System: Our Experience</a></li>
<li><a href="../354204/index.html">Morrowind speedran planning using simulated annealing</a></li>
<li><a href="../354206/index.html">Start with full stack and not regret: from senior developer to head of department for six years</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>