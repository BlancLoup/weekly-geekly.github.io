<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bloody Lola on Omega 2 or stifle a python on Halloween</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I never understood this holiday. But the idea was born. Make a creepy doll that will sparkle with its eyes and make creepy sounds. 

 Under this all t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bloody Lola on Omega 2 or stifle a python on Halloween</h1><div class="post__text post__text-html js-mediator-article">  I never understood this holiday.  But the idea was born.  Make a creepy doll that will sparkle with its eyes and make creepy sounds. <br><br><img src="https://habrastorage.org/webt/v_/j7/ng/v_j7ngyryzuvabfo6rnfi58atsu.gif" alt="image" width="400" align="left">  Under this all turned up a cool children's head (thanks to Anton) and a competition from Onion with the drawing of special whales, which my conscience does not allow me to buy.  If so, then the brains of the girl Lola I did on Omega 2, using my work from the previous article. <br><br>  Anyone who cares how to repeat such a thing, please under the cat. <br><a name="habracut"></a><br>  We will need: two LEDs, a speaker, a 12 volt power supply, a motion sensor (12 volts only), a 3.3 volt power converter, a 5 volt power converter, a simple amplifier (any class D with 3-12 volts) and Omega 2. Optionally, you will need either a flash drive or sd card to expand the disk space. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We open the doll and hot-melt we put the LEDs in the eyes and the speaker in the mouth area.  Display wiring in the area of ‚Äã‚Äãthe <s>brain</s> Omega 2. The speaker is soldered to the amplifier, the LEDs are connected to field-effect transistors ... In general, we collect the following scheme. <br><br><img src="https://habrastorage.org/webt/kr/cu/oy/krcuoy7-0pdep9pj8wyl99hkou8.jpeg" alt="image"><br><br>  Instead of a 5 volt converter, you can take a dual power supply for 5 and 12 volts, which is closer at hand. <br><br>  Next, go to setting up the software.  If you want to use i2s sound, we put b193 firmware on omega, because i2s doesn‚Äôt work further.  If not, you can insert a sound card into the USB and then adjust the sound <a href="https://docs.onion.io/omega2-docs/usb-playing-audio.html">on this guide</a> .  If you do like me, then I wrote about working with i2s sound <a href="https://habr.com/post/413623/">here</a> .  We connect to wifi and increase the disk space of omega 2. Everything is in detail in the manual <a href="https://docs.onion.io/omega2-docs/boot-from-external-storage.html">here</a> . After that we perform <br><br><pre><code class="hljs sql">opkg <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> opkg <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> alsa-utils mpg123 python pyOnionGpio nano</code> </pre> <br>  Now, our omega is almost able to speak and it remains only to write a Python script for this business.  The logic is simple.  Motion sensor opens the circuit between the two GPIO.  On one, we submit a logical unit when turned on (I have 15 output), the value of the second is read (I use 17 output).  When there is 0 (because the PIR sensor has triggered and opened the line), we begin to play terrible sounds and blink LEDs.  The rest of the time we are silent, do not touch anyone.  Realization of all this looks like this. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> onionGpio <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random gpioOut = onionGpio.OnionGpio(<span class="hljs-number"><span class="hljs-number">15</span></span>) gpioOut.setOutputDirection(<span class="hljs-number"><span class="hljs-number">0</span></span>) gpioOut.setValue(<span class="hljs-number"><span class="hljs-number">1</span></span>) gpioObj = onionGpio.OnionGpio(<span class="hljs-number"><span class="hljs-number">17</span></span>) status = gpioObj.setInputDirection() <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-comment"><span class="hljs-comment">#   value = gpioObj.getValue() #   if int(value)==0: cmd = "fast-gpio pwm 18 " + str(random.randint(5,15)) + " 50" subprocess.call(cmd, shell=True) cmd = "fast-gpio pwm 19 " + str(random.randint(2,10)) + " 50" subprocess.call(cmd, stdout=subprocess.PIPE, shell=True) cmd = "mpg123 -f 256 -C /mnt/sda1/" + str(random.randint(1,6)) + ".mp3" subprocess.call(cmd, shell=True) #   else: subprocess.call("fast-gpio set 18 0", shell=True) subprocess.call("fast-gpio set 19 0", shell=True)</span></span></code> </pre><br>  Files of terrible sounds are added to / mnt / sda1 under the names 1.mp3, 2.mp3 ... I have them 6. and one of them is randomly turned on.  Also, the PWM frequency of the Omega 2 outputs is switched on randomly separately under the left and right eyes.  It would be possible to use hardware PWM, but here the possible frequency instability is a plus.  Then we write two lines to rc.local by executing the command <code>nano /etc/rc.local</code> <br><br><pre> <code class="hljs pgsql">omega2-ctrl gpiomux <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> i2s i2s python /mnt/sda1/<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>.py</code> </pre><br>  As I think you guessed the script I gave above, you need to save it in the / mnt / sda1 directory as <i>start.py</i> . <br><br>  Next, the last step.  Most creative.  Makeup.  I just asked my wife (cheater) and she did great.  Thank you very much! <br><br><img src="https://habrastorage.org/webt/tn/me/zh/tnmezhhstxnqumqhaeey7ni-vlu.jpeg" alt="image"><br><br>  See how it all works with the sound in the video, which is below.  In the dark, Lola "The Devourer of male hearts" looks pretty creepy, to be honest.  Hope you enjoyed it.  Thanks for attention! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/f-GnMWJSe6k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  And what terrible hand-made you did? </div><p>Source: <a href="https://habr.com/ru/post/427893/">https://habr.com/ru/post/427893/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../427877/index.html">Rockstar programming language: when the code looks like the text of a rock hit</a></li>
<li><a href="../427879/index.html">How I switched from Python to Julia (and why)</a></li>
<li><a href="../427883/index.html">Understanding Virtualization, Containers, and Kubernetes: 18 Cloud Work Stuff</a></li>
<li><a href="../427889/index.html">Wrong, wrong, WRONG! methods of DDoS mitigation</a></li>
<li><a href="../427891/index.html">Millions of people can be attacked through a vulnerability in the Cisco WebEx conferencing platform.</a></li>
<li><a href="../427895/index.html">Deleting data from the shardirovanny base</a></li>
<li><a href="../427899/index.html">JsonWriterSax - a library for creating JSON</a></li>
<li><a href="../427901/index.html">How not to use the Node.js Stream API</a></li>
<li><a href="../427905/index.html">Mining food or "Crossroads" through the eyes of a hacker</a></li>
<li><a href="../427907/index.html">Drone shooting, ‚Äúrakes‚Äù, life hacking, self-development and a photographer / videographer career: a new podcast ‚ÄúGLPH‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>