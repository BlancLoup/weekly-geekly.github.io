<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Snake fruit or fruit python?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Non biblical story 



1. And made Google Android. He settled in the garden of mobile platforms, giving him a wife - Java. 
2. And he ordered Google J...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Snake fruit or fruit python?</h1><div class="post__text post__text-html js-mediator-article"><h4>  Non biblical story </h4><br><img src="https://habrastorage.org/files/681/6e6/831/6816e6831bfa4ba2bf5c11a6f3921276.jpg" align="left"><br><ol><li>  And made Google Android.  He settled in the garden of mobile platforms, giving him a wife - Java. </li><li> And he ordered Google Jav <code>:   Android</code> , beautiful and fast, and Android <code> :      ,  Jav</code> s.  And he forbade them to taste the fruits of the tree of knowledge of frameworks and programming languages, so that their programs do not become slow and objectionable to the user. </li><li>  The oldest snake, dynamic Python, was the smartest on that tree.  He watched Android for a long time <code> , ,      .    Python Android</code>  <code> , ,      .    Python Android</code> : did Google tell you the truth, do not eat the fruits of the tree of knowledge of frameworks and programming languages ‚Äã‚Äãso that your programs do not become slow and objectionable to the user? </li><li>  Just as the all-powerful Google commanded me, Android answered, and my wife, Java, creates my programs. </li><li>  Google deceived you, his cunning Python hissed, for he knows that on the day when you taste the fruits of the tree of knowledge of frameworks and programming languages, you will see the light and other developers will reach out to you and start creating programs, and and fast, as from your wife Java, and they will be cross-platform! </li><li>  And Python plucked the fruit from the tree of knowledge of frameworks and programming languages ‚Äã‚Äãand stretched Android  ªu, and he ate. </li><li>  The name of that fruit is Kivy. </li></ol><br><p>  <b>Kivy Framework Book (Chapter 2, verse 1-7)</b> </p><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ecd/a19/c44/ecda19c44d484f6587f35a83a09a85a4.jpg"></div><br><p>  As you may have guessed, it will be about developing mobile applications for the Android platform using the Kivy framework and the Python programming language.  On Habr√©, there are already several articles on this topic, mostly small essays describing in general what kind of fruit this Kivy is, with which it is eaten and a couple of examples, such as Hello World and tic-tac-toe. </p><br><p>  On the Internet, there are not many Kivy-written applications, and a rather long list of high-quality games with 2D and 3D graphics.  This is partly due to the fact that, thanks to the support of the GPU acceleration, the graphic providers PyGame, OpenGL, SDL, X11, the support of shaders, Kivy, it can be said, by default, it is more oriented for use in the gaming industry, and someone directly says that write a less worthwhile and beautiful application in Kivy will not succeed or you will spend much more time on it than, say, using native code, not to mention projects like WhatsApp. </p><br><p>  Well, you can not trust anyone (I can), so in this article we will personally test the capabilities of Kivy in the development of mobile development.  No, writing an application, like WatsApp from scratch and saying how easy it is between two cigarettes and a cup of coffee, is done in Kivy, we will not (the article format does not allow), but I see that you have installed a wonderful program CleanMaster: animation, custom controllers, transparent progress bar - sexy, not an application - just what we need to demonstrate the capabilities of the framework! </p><br><p>  Here is what it looks like (original Clean Master screens): </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e47/6ce/5ce/e476ce5cec594982be53e498bce8d54b.png"></div><br><p>  We will try to create similar, in Java, Activity: with animation, transformation, beautiful progress, cleared cache counter, etc., and in the next article we will assemble the default installation apk for Android device and analyze its pros and cons.  Immediately, I note that there will be no functionality other than the demonstration of UI elements in our application, and the entire animation of the cache cleaning progress, STORAGE / RAM counting animation, is a regular demonstration. </p><br><p>  The article format is not for beginners and although the code samples are quite densely supplied with comments, they are not educational in nature and, most likely, the article will be interesting to Java developers in the sense that it is interesting to compare native code and the same implementation using the Kivy framework. </p><br><p>  What do we need for this?  Most simple tools are coffee and a couple of packs of cigarettes.  In fact, we simply will not consider installing Kivy and related tools to build apk, since all this can be easily found on the net. </p><br><p>  So, first of all create a directory of our project.  Let's call it KivyCleanMasterDemo. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a43/b09/7f6/a43b097f6b8544f2b65fd4baa1f3eebc.png"></div><br><p>  The project structure is arbitrary.  You can name directories as you wish and keep the files where you want, the benefit of Python and Kivy do not impose any restrictions on this plan.  The only condition: the main.py file must be present in the root folder of the project - this is the entry point to the program.  This file will be imported when you run the already installed apk package. </p><br><p>  So, we enter into our application! </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/826/e06/d42/826e06d42f714152b61ebefa37bd781e.png"></div><br><div class="spoiler">  <b class="spoiler_title">main.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#! /usr/bin/python2.7 # -*- coding: utf-8 -*- # # main.py # #    .     program.py. #   ,       . # from __future__ import print_function import os import sys import traceback try: import kivy kivy.require("1.9.1") from kivy.app import App from kivy.config import Config #     ,   # ,    . Config.set("kivy", "keyboard_mode", "system") # Activity  . from Libs.uix.bugreporter import BugReporter except Exception: print("\n\n{}".format(traceback.format_exc())) sys.exit(1) __version__ = "0.0.1" def main(): app = None try: from program import Program #    #  . app = Program() app.run() except Exception as exc: print(traceback.format_exc()) traceback.print_exc(file=open("{}/error.log".format( os.path.split(os.path.abspath(sys.argv[0]))[0]), "w")) if app: #       app.start_screen.clear_widgets() class Error(App): """    .""" def callback_report(self, *args): """  -""" try: import webbrowser import six.moves.urllib txt = six.moves.urllib.parse.quote( self.win_report.txt_traceback.text.encode( "utf-8")) url = "https://github.com/HeaTTheatR/KivyCleanMasterDemo" \ "/issues/new?body=" + txt webbrowser.open(url) except Exception: sys.exit(1) def build(self): self.win_report = BugReporter( callback_report=self.callback_report, txt_report=str(exc), icon_background="Data/Images/logo.png") return self.win_report Error().run() if __name__ in ("__main__", "__android__"): main()</span></span></code> </pre></div></div><br><p>  Everything is simple and there is no need for additional comments.  We are interested in the code: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> program <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Program <span class="hljs-comment"><span class="hljs-comment">#    app = Program() app.run() #  </span></span></code> </pre> <br><p>  From main.py we follow the code further.  Consider the main class of our demo application from the program.py module </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ecf/ca4/b64/ecfca4b6439349d2b981da8bfc1e4db1.png"></div><br><div class="spoiler">  <b class="spoiler_title">program .py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#! /usr/bin/python2.7 # -*- coding: utf-8 -*- # # program.py # #    . # try: import kivy kivy.require("1.9.1") from kivy.app import App from kivy.uix.button import Button from kivy.uix.screenmanager import Screen, FadeTransition from kivy.clock import Clock from kivy.core.window import Window #      Activity . #   ,   , . from Libs.uix.about import About from Libs.uix.startscreen import StartScreen from Libs.uix.junkfiles import JunkFiles # ,   Activity   . from Libs.programclass import ShowScreens, AnimationProgress except Exception: import traceback raise Exception(traceback.format_exc()) __version__ = "0.0.1" class Program(App, ShowScreens, AnimationProgress): """ """ #  . title = "Clean Master" #    icon = "Data/Images/logo.png" #   def __init__(self, **kvargs): super(Program, self).__init__(**kvargs) #   /   -. Window.bind(on_keyboard=self.on_events) #      programclass. self.About = About self.Clock = Clock self.JunkFiles = JunkFiles self.prog_dir = self.directory self.new_color = \ [0.1568627450980392, 0.34509803921568627, 0.6784313725490196] def build(self): #  Activity . self.start_screen = StartScreen(events_callback=self.on_events) #  Activity      #         # ( ). self.start_screen.body_storage_ram.bind(pos=self.animation_storage_ram) self.start_screen.body_storage_ram.bind(size=self.animation_storage_ram) #     STORAGE/RAM. Clock.schedule_interval(self.calc_elliptical_length, .03) return self.start_screen def on_events(self, *args): """  .""" try: _args = args[0] #   -     event = _args if isinstance(_args, str) else _args.id except AttributeError: event = args[1] #  ,   -    if event == "About": #  Activity About self.show_about() elif event == "on_previous" or event == 27: #     Activity self.back_screen() elif event == "JUNK FILES": #  Activity JUNK FILES self.show_junk_files() self.Clock.unschedule(self.calc_elliptical_length) #    STORAGE/RAM self.Clock.schedule_interval(self.animation_clean, 0.2) #     elif event == "STOP": #   JUNK FILES Clock.unschedule(self.animation_clean) self.back_screen() def show_new_screen(self, instance_new_screen, string_new_name_screen): """  .""" #        , , About  About. name_current_screen = self.start_screen.screen_manager.current if name_current_screen == string_new_name_screen: return self.start_screen.screen_manager.add_widget(screen) #  Activity    self.start_screen.screen_manager.transition = FadeTransition() #     self.start_screen.screen_manager.current = string_new_name_screen #  Activity   self.start_screen.action_previous.title = string_new_name_screen #   Activity  ActionBar self.start_screen.action_previous.app_icon = "Data/Images/arrow_left.png"</span></span></code> </pre></div></div><br><p>  In essence, this class sets the main screen of the application, starts the STORAGE / RAM counting progress animation, monitors events and switches the screens of our demo application. </p><br><p>  The main Activity of the application is displayed in the following piece of code: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  Activity . self.start_screen = StartScreen(events_callback=self.on_events) return self.start_screen</span></span></code> </pre> <br><p>  However, before you see what the layout file of the start-up Activity looks like, a few words about building a UI in Kivy. </p><br><p>  The interface layout in Kivy can be built in two ways - directly in the code: </p><br><pre> <code class="python hljs">root = MyRootWidget() box = BoxLayout() byt1 = Button() byt2 = Button() box.add_widget(btn1) box.add_widget(btn2) root.add_widget(box)</code> </pre> <br><p>  I do not recommend using this method, since it will be quite difficult to trace the hierarchy and interaction of widgets in a more or less complex layout, and you will spend a very long time on making changes to the layout built this way. </p><br><p>  A completely different UI built using a special markup language - Kv Language, is very similar to QML in Qt, where the hierarchy of widgets is distinguished using identities and clearly shows which layout this or that control belongs to, and property management is carried out in the same code class via widget id: </p><br><pre> <code class="python hljs">&lt;MyRootWidget@BoxLayout&gt;: Button: id: btn1 Button: text: <span class="hljs-string"><span class="hljs-string">"  btn2"</span></span></code> </pre> <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyRootWidget</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BoxLayout)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self. **kvargs)</span></span></span><span class="hljs-function">:</span></span> super(MyRootWidget, self).__init__(**kvargs) self.ids.btn1.text = <span class="hljs-string"><span class="hljs-string">"  btn1"</span></span></code> </pre> <br><p>  Well, we gave the basic information for reading the interface layouts (Java programmers should have no difficulty at all on this), now let's see how the starting Activity created in Kivy looks like: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3fd/cea/2c6/3fdcea2c6d7347c59e1ec51f5fcf0754.png"></div><br><p>  But the markup of this Activity in Kv Language: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/44a/72f/3ef/44a72f3efa0e4526a16224f7d0814ac3.png"></div><br><div class="spoiler">  <b class="spoiler_title">startscreen.kv</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#:kivy 1.9.1 &lt;StartScreen&gt; ActionBar: id: action_bar canvas: Color: rgb: root.color_blue Rectangle: pos: self.pos size: self.size ActionView: ActionPrevious: id: action_previous app_icon: "Data/Images/previous_app_icon.png" previous_image: "Data/Images/previous_image.png" with_previous: True on_press: root.events_callback("on_previous") ActionOverflow: id: action_overflow overflow_image: "Data/Images/overflow_image.png" #  . ScreenManager: id: screen_manager #   . Screen: id: screen #  STORAGE/RAM FloatLayout: id: float_layout canvas: Color: rgb: root.color_blue Rectangle: pos: self.pos size: self.size #   STORAGE Color: rgba: root.color_ellipse_static Line: width: 3. circle: (self.center_x / 1.5, self.center_y / .65, \ min(self.width, self.height) / 4.5, 220, 500, 50) #    STORAGE Color: rgba: 1.0, 1.0, 1.0, 1 Line: width: 3. #   RAM Color: rgba: root.color_ellipse_static Line: width: 3. circle: (self.center_x / .65, self.center_y / .69, \ min(self.width, self.height) / 7, 220, 500, 50) #    RAM Color: rgba: 1.0, 1.0, 1.0, 1 Line: width: 3. #    STORAGE Image: id: storage_numeral_one size_hint: .14, .14 pos_hint: {"center_x": .28, "center_y": .76} allow_stretch: True Image: id: storage_numeral_two size_hint: .14, .14 pos_hint: {"center_x": .39, "center_y": .76} allow_stretch: True Image: size_hint: .06, .06 pos_hint: {"center_x": .47, "center_y": .82} allow_stretch: True source: "Data/Images/percent.png" #    RAM Image: id: ram_numeral_one size_hint: .07, .07 pos_hint: {"center_x": .74, "center_y": .72} source: "Data/Images/3.png" allow_stretch: True Image: id: ram_numeral_two size_hint: .07, .07 pos_hint: {"center_x": .80, "center_y": .72} source: "Data/Images/4.png" allow_stretch: True Image: size_hint: .05, .05 pos_hint: {"center_x": .85, "center_y": .74} allow_stretch: True source: "Data/Images/percent.png" #    Label: text: "STORAGE" bold: True pos_hint: {"center_x": .34, "center_y": .63} color: root.color_label Label: text: "124.40MB/704.99MB" bold: True pos_hint: {"center_x": .34, "center_y": .68} color: root.color_label font_size: "10sp" Label: text: "RAM" bold: True pos_hint: {"center_x": .78, "center_y": .63} color: root.color_label #   today_cleaned Label: size_hint: 1, .05 text: "Today cleaned: 0.0B Total: 0.0B" pos_hint: {"top": .45} canvas: Color: rgba: 1.0, 1.0, 1.0, 0.3 Rectangle: pos: self.pos size: self.size #    "JUNK FILES", "MEMORY BOOST" # "APP MANAGER", "SECURITY &amp; PRIVACY" GridLayout: id: body_buttons_menu size_hint: 1, .4 cols: 2 padding: 10 spacing: 5 #    canvas.before: Color: rgb: 1.0, 1.0, 1.0 Rectangle: pos: self.pos size: self.size # ,    Color: rgb: 0, 0, 0 Line: points: [0, self.size[1] / 1.9, self.size[0], self.size[1] / 1.9] width: 1 Line: points: [self.size[0] / 2, 0, self.size[0] / 2, self.size[1] / 1.001] width: 1</span></span></code> </pre> </div></div><br><p>  As you can see, Kv Language is almost Python, in the sense that in addition to marking UI elements, you can perform calculations in kv files, pull callbacks and pass parameters to them, import and use standard or external Python modules. </p><br><p>  Now let's take a look at the class that controls our layout, since it can be seen that not all elements are created in the markup file: for example, there is no spinner in the ActionBar, and only the root box is created under the menu buttons. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ada/7b1/3fc/ada7b13fcb014c4c92e83f955d3243bc.png"></div><br><div class="spoiler">  <b class="spoiler_title">startscreen.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#! /usr/bin/python2.7 # -*- coding: utf-8 -*- # # startscreen.py # #   . # from kivy.uix.boxlayout import BoxLayout from kivy.uix.label import Label from kivy.uix.image import Image from kivy.uix.button import Button from kivy.uix.behaviors import ButtonBehavior from kivy.uix.actionbar import ActionItem from kivy.lang import Builder from kivy.properties import ObjectProperty, ListProperty class ImageButton(ButtonBehavior, Image): pass class MyOwnActionButton(Button, ActionItem): pass class StartScreen(BoxLayout): events_callback = ObjectProperty(None) """   .""" color_blue = ListProperty( [0.1607843137254902, 0.34901960784313724, 0.6784313725490196]) """ background . """ color_label= ListProperty( [0.6784313725490196, 0.7294117647058823, 0.8392156862745098, 1]) """   STORAGE/RAM. """ color_ellipse_static= ListProperty( [0.38823529411764707, 0.5254901960784314, 0.7764705882352941, 1]) """   STORAGE/RAM. """ Builder.load_file("Libs/uix/kv/startscreen.kv") """ """ def __init__(self, **kvargs): super(StartScreen, self).__init__(**kvargs) self.orientation = "vertical" #   . self.layouts = self.ids self.body_storage_ram = self.ids.float_layout self.screen_manager = self.ids.screen_manager self.action_previous = self.ids.action_previous self.background_action_bar = self.ids.action_bar.canvas.children[3] self.ellips_storage = self.body_storage_ram.canvas.children[8] self.ellips_ram = self.body_storage_ram.canvas.children[14] self._action_overflow = self.ids.action_overflow self.create_spinner_items() self.create_menu_buttons() def create_spinner_items(self): """      ActionBar.""" for item_name in ["Settings", "Update", "Like Us", "Feedback", "FAQ", "About"]: item_button = \ MyOwnActionButton( text=item_name, id=item_name, on_press=self.events_callback, color=[.1, .1, .1, 1], background_normal="Data/Images/background_action_item.png", background_down="Data/Images/background_down.png", on_release=lambda *args: self._action_overflow._dropdown.select( self.on_release_select_item_spinner())) self._action_overflow.add_widget(item_button) def create_menu_buttons(self): """    .""" name_path_buttons_menu = { "JUNK FILES": "Data/Images/clean_cache.png", "MEMORY BOOST": "Data/Images/clean_memory.png", "APP MANAGER": "Data/Images/clean_apk.png", "SECURITY &amp; PRIVACY": "Data/Images/clean_privacy.png"} for name_button in name_path_buttons_menu.keys(): item_box = BoxLayout(orientation="vertical") item_label = Label(text=name_button, color=[.1, .1, .1, 1]) item_button = \ ImageButton(source=name_path_buttons_menu[name_button], id=name_button, on_press=self.events_callback) item_box.add_widget(item_button) item_box.add_widget(item_label) self.ids.body_buttons_menu.add_widget(item_box) def on_release_select_item_spinner(self): """  release    ActionBar.   ,     .""" pass</span></span></code> </pre> </div></div><br><p>  This class has only two functions, the task of which is to create buttons for the ActionBar drop-down list, buttons and menu labels.  The class also initializes attributes for further use in the code ‚Äî widgets obtained from their identifiers from the startscreen.kv markup file. </p><br><p>  For further work, we need a custom widget button ... </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/eba/9b2/4e4/eba9b24e454c4688881795e578efa36c.png"></div><br><p>  ... which is used in the next two Activity.  It is small and will help to better understand the interaction between the interface markup and the program code that manipulates its properties. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b85/182/806/b851828061e0442192272f60aadc1e4f.png"></div><br><p>  <b>custombutton.kv</b> </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#:kivy 1.9.1 &lt;CustomButton@Button&gt; #    Button . #   root -    CustomButton. id: root.id text: root.button_text background_normal: "Data/Images/background_action_item.png" background_down: "Data/Images/background_down.png" size_hint_y: None text_size: root.width - 150, root.height valign: "middle" height: root.button_height color: 0.1, 0.1, 0.1, 1 on_press: if callable(root.event_callback): root.event_callback(root.id) #     Image: source: root.icon size_hint_y: None height: root.icon_height pos: root.x - 25, root.y + self.height / 2 #     Image: source: root.icon_load size_hint_y: None pos: root.width / 2 - 25, root.y size: root.size</span></span></code> </pre> <br><p>  <b>custombutton.py</b> </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#! /usr/bin/python2.7 # -*- coding: utf-8 -*- # # custombutton.py # from kivy.lang import Builder from kivy.uix.button import Button from kivy.properties import StringProperty, NumericProperty, ObjectProperty Builder.load_file("Libs/uix/kv/custombutton.kv") class CustomButton(Button): id = StringProperty("") button_height = NumericProperty(65) button_text = StringProperty("") icon = StringProperty("") icon_height = NumericProperty(30) icon_load = StringProperty("Data/Images/loading.gif") event_callback = ObjectProperty(None)</span></span></code> </pre><br><p>  Well, since we already have a spinner ready, a custom button widget and in the main Program class, the on_events function handles the "About" event ... </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/668/37f/45c/66837f45c42446b1b780c27180649fd1.png"></div><br><p>  ... let's create this Activity and its control class. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6ab/3de/1a8/6ab3de1a87c2445bbe1d201da0da7e6f.png"></div><br><div class="spoiler">  <b class="spoiler_title">about.kv</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#:kivy 1.9.1 &lt;About&gt;: orientation: "vertical" ScrollView: GridLayout: cols: 1 size_hint_y: None spacing: 10 padding: 10 height: self.minimum_height canvas: Color: rgb: root.about_background Rectangle: pos: self.pos size: self.size #   Image: source: "Data/Images/logo.png" size_hint_y: None #   Label: text: "Clean Master 5.4.0.1395" size_hint_y: None height: "10pt" color: 0.1, 0.1, 0.1, 1 italic: True #   share GridLayout: id: box_share cols: 1 size_hint_y: None height: self.minimum_height #   Label: text: root.text_license text_size: self.size font_size: dp(12) valign: "top" size_hint_y: None height: root.height / 2.5 color: 0.1, 0.1, 0.1, 1 #   BoxLayout: orientation: "vertical" size_hint: 1, .2 canvas: Color: rgb: root.about_background Rectangle: pos: self.pos size: self.size Color: rgb: 0.5843137254901961, 0.5843137254901961, 0.5843137254901961 Line: points: [0, self.size[1], self.size[0], self.size[1]] width: 1 Label: text: "Copyright 2016 Demo Clean Master\nby HeaTTheatR" halign: "center" color: 0.1, 0.1, 0.1, 1</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">about.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#! /usr/bin/python2.7 # -*- coding: utf-8 -*- # # about.py # from kivy.uix.boxlayout import BoxLayout from kivy.lang import Builder from kivy.properties import ObjectProperty, StringProperty, ListProperty from .custombutton import CustomButton class About(BoxLayout): events_callback = ObjectProperty(None) """   .""" text_license = StringProperty("Clean Master") about_background = ListProperty( [0.7294117647058823, 0.7686274509803922, 0.8470588235294118]) Builder.load_file("Libs/uix/kv/about.kv") """ """ def __init__(self, **kvargs): super(About, self).__init__(**kvargs) self.create_button_share(self.ids.box_share) def create_button_share(self, box_share): """   share  . :type box_share: &lt;'kivy.weakproxy.WeakProxy'&gt; :param box_share: &lt;'kivy.uix.gridlayout.GridLayout'&gt; """ about_items_share = { "Share this app": "Data/Images/about_share.png", "Like us on Facebook": "Data/Images/about_facebook.png", "Join our beta testing group": "Data/Images/google_plus.png", "Help us with localization": "Data/Images/about_localization.png", "For Business Cooperation": "Data/Images/skype_icon.png"} for name_item in about_items_share.keys(): box_share.add_widget( CustomButton(icon_load="Data/Images/previous_image.png", icon=about_items_share[name_item], button_text=name_item, button_height=45, icon_height=25))</span></span></code> </pre></div></div><br><p>  Now we can open the drop-down list in the ActionBar, select the About item and accordingly go to the selected screen.  I allowed myself some liberties regarding the About text, replacing it with the GNU GPL license, but I think this is not essential for our demonstration. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7d6/e47/cae/7d6e47caebed485998f3e78f6484b9fd.png"></div><br><p>  We can return to the start screen by clicking the arrow on the left in the ActionBar.  We recorded the callback callback in the startscreen.kv layout: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/284/378/107/284378107b4f47299259e08e2407fa75.png"></div><br><p>  And they caught him in the main Program class in the on_events function: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/542/83a/e5b/54283ae5b7d8440a812d3c9ed8b9bd3c.png"></div><br><p>  Pay attention to the show_about and back_screen functions - these are functions from the ShowScreens class of the same-name module of the programclass package, which jump in on_events.  This class opens three layouts of our demo application and switches between them. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d52/cf2/8fe/d52cf28fe90d4c4da5e6c093fac91717.png"></div><br><p>  Of course, it was possible to write these functions in the main Program class, but I don‚Äôt like it when the code takes on the appearance of a three-story building, and it‚Äôs much easier to make edits when everything is on the shelves in sight, and not lost in dozens of functions and classes. </p><br><p>  Let's take a look at the ShowScreens class. </p><br><div class="spoiler">  <b class="spoiler_title">ShowScreens</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#! /usr/bin/python2.7 # -*- coding: utf-8 -*- # # ShowScreens.py # class ShowScreens(object): """  .""" background_action_bar = \ [0.1568627450980392, 0.34509803921568627, 0.6784313725490196] def show_about(self): try: text_license = open("{}/LICENSE".format(self.prog_dir)).read() except Exception: text_license = "Clean Master" #   ,  About    "JUNK FILES". if self.start_screen.layouts.screen.manager.current == "JUNK FILES": self.Clock.unschedule(self.animation_clean) self.start_screen.background_action_bar.rgb = self.background_action_bar #       "Memory boost"  # "Cache junk". self.screen_junk.button_memory_bust.remove_widget( self.screen_junk.button_memory_bust_icon_state) self.screen_junk.button_cache_junk.remove_widget( self.screen_junk.button_cache_junk_icon_state) screen_about = \ self.About(events_callback=self.on_events, text_license=text_license) self.show_new_screen(screen_about, "About") def show_junk_files(self): self.set_default_tick_rgb() self.screen_junk = self.JunkFiles(events_callback=self.on_events) self.show_new_screen(self.screen_junk, "JUNK FILES") def back_screen(self): """   ActionPrevious  ActionBar.        .""" current_screen = self.start_screen.screen_manager.current if current_screen in ("About", "JUNK FILES"): #     ,  #  . if current_screen == "JUNK FILES": self.Clock.unschedule(self.animation_clean) #     ,   #  STORAGE/RAM. self.Clock.schedule_interval(self.calc_elliptical_length, .03) if len(self.start_screen.screen_manager.screens) != 1: self.start_screen.screen_manager.screens.pop() self.start_screen.screen_manager.current = \ self.start_screen.screen_manager.screen_names[-1] self.start_screen.action_previous.title = \ self.start_screen.screen_manager.current if current_screen in ("About", "JUNK FILES"): #    actionbar,      # About,    "JUNK FILES". self.start_screen.background_action_bar.rgb = self.new_color #  "",    actionbar. if self.start_screen.screen_manager.screen_names[-1] != \ "JUNK FILES" or current_screen == "": self.start_screen.background_action_bar.rgb = \ self.background_action_bar #   previous    actionbar. if self.start_screen.screen_manager.screens[-1].name != \ "JUNK FILES": self.start_screen.action_previous.app_icon = \ "Data/Images/previous_app_icon.png"</span></span></code> </pre> </div></div><br><p>  So! , , ,   Activity JUNK FILES    .  Activity JUNK FILES      : </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/589/b85/9d7/589b859d723640eea0c11344d8cf231d.png"></div><br><p>   junkfiles.py  junkfiles.kv: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e99/43a/9d7/e9943a9d7cc4496d929138518cd6f455.png"></div><br><div class="spoiler"> <b class="spoiler_title">junkfiles.kv</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#:kivy 1.9.1 &lt;JunkFiles&gt; orientation: "vertical" FloatLayout: id: float_layout canvas: Color: rgb: 0.1607843137254902, 0.34901960784313724, 0.6784313725490196 Rectangle: pos: self.pos size: self.size #    BoxLayout: pos_hint: {"center_x": .5, "center_y": .75} size_hint: .7, 1 Image: id: storage_numeral_one size_hint: .52, .52 source: "Data/Images/6.png" Image: id: storage_numeral_two size_hint: .52, .52 source: "Data/Images/5.png" Image: id: point size_hint: .25, .25 pos_hint: {"center_y": .21} source: "Data/Images/dot.png" Image: id: numeral_float size_hint: .52, .52 source: "Data/Images/8.png" Image: size_hint: .22, .22 pos_hint: {"center_y": .48} source: "Data/Images/gb.png" #   ProgressLine: id: progress_line size_hint: 1, .1 pos_hint: {"center_y": .05} Label: id: progress_label text: "Scanning:" text_size: root.width - 20, root.height pos_hint: {"center_y": .05} valign: "middle" ScrollView: size_hint: 1, .6 canvas.before: Color: rgb: 1.0, 1.0, 1.0, Rectangle: pos: self.pos size: self.size GridLayout: id: grid_layout cols: 1 size_hint_y: None height: self.minimum_height BoxLayout: size_hint_y: None height: 80 padding: 10, 10 canvas.before: Color: rgb: 1.0, 1.0, 1.0, Rectangle: pos: self.pos size: self.size Button: id: button_stop text: "STOP" font_size: "19sp" bold: True markup: True background_normal: "Data/Images/stop_progress.png" background_down: "Data/Images/stop_progress_down.png" color: 0.1, 0.1, 0.1, 1</span></span></code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title">junkfiles.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#! /usr/bin/python2.7 # -*- coding: utf-8 -*- # # junkfiles.py # #   . # from kivy.uix.boxlayout import BoxLayout from kivy.lang import Builder from kivy.properties import ObjectProperty from .progressline import ProgressLine from .custombutton import CustomButton class JunkFiles(BoxLayout): events_callback = ObjectProperty(None) """   .""" Builder.load_file("Libs/uix/kv/junkfikes.kv") """ """ def __init__(self, **kvargs): super(JunkFiles, self).__init__(**kvargs) self.create_custom_button() #   . self.layouts = self.ids self.button_memory_bust = self.layouts.grid_layout.children[0] self.button_cache_junk = self.layouts.grid_layout.children[1] self.button_memory_bust_icon_state = self.button_memory_bust.children[0] self.button_cache_junk_icon_state = self.button_cache_junk.children[0] self.progress_line = self.layouts.progress_line self.progress_label = self.layouts.progress_label self.button_stop = self.layouts.button_stop self.background = self.ids.float_layout.canvas.children[0] def create_custom_button(self): """        .""" junk_files_items = {"Memory boost": "Data/Images/memory_boost.png", "Cache junk": "Data/Images/cache_junk.png"} for action_clean in junk_files_items.keys(): path_to_icon_action = junk_files_items[action_clean] self.ids.grid_layout.add_widget( CustomButton(id=action_clean, icon=path_to_icon_action, button_text=action_clean, on_press=self.events_callback)) self.ids.button_stop.bind( on_press=lambda *args: self.events_callback("STOP"))</span></span></code> </pre> </div></div><br><p>      ProgressLine  junkfiles.kv: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bbc/311/7f7/bbc3117f78ea4e1c89e62c1952c0ce93.png"></div><br><p>     junkfiles.py: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/099/38c/f7e/09938cf7e1c64303b6306c4a860501f8.png"></div><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#! /usr/bin/python2.7 # -*- coding: utf-8 -*- # # progressline.py # from kivy.uix.widget import Widget from kivy.utils import get_color_from_hex from kivy.graphics import Color, Line class ProgressLine(Widget): """ .""" bar_value_percent = 0 color = "#ffffff56" def __init__(self, **kwargs): super(ProgressLine, self).__init__(**kwargs) self.bind(pos=self.redraw) self.bind(size=self.redraw) def redraw(self, *args): """    .""" with self.canvas: self.canvas.clear() line_width = float(self.height) / 2 + 1 new_y = self.y + line_width new_x = self.x + self.width * self.bar_value_percent / 100 Color(*get_color_from_hex(self.color)) Line(points=[self.x, new_y, new_x, new_y], width=line_width, cap="none")</span></span></code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/files/235/b96/af3/235b96af36ab48e3a5f074eedb9eb00b.png"></div><br><p>    ,     . </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/72e/20a/e8e/72e20ae8ef1b4d10b71320c283b69648.png"></div><br><div class="spoiler"> <b class="spoiler_title">AnimationProgress.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#! /usr/bin/python2.7 # -*- coding: utf-8 -*- # # AnimationProgress.py # from random import randint class AnimationProgress(object): """  .""" def __init__(self): self.set_default_tick_rgb() self.scan_packages = range(100) def animation_storage_ram(self, *args): """   STORAGE/RAM.""" if isinstance(args[0], int): #    elliptical_length_storage = elliptical_length_ram = args[0] else: #      elliptical_length_storage = 317 elliptical_length_ram = 401 if self.tick &lt;= 34: self.start_screen.ellips_storage.circle = \ ((self.start_screen.body_storage_ram.center_x / 1.5, self.start_screen.body_storage_ram.center_y / .65, min(self.start_screen.body_storage_ram.width, self.start_screen.body_storage_ram.height) / 4.5, 220, elliptical_length_storage, 50)) if self.tick &lt;= 65: self.start_screen.ellips_ram.circle = \ ((self.start_screen.body_storage_ram.center_x / .65, self.start_screen.body_storage_ram.center_y / .69, min(self.start_screen.body_storage_ram.width, self.start_screen.body_storage_ram.height) / 7, 220, elliptical_length_ram, 50)) def animation_clean(self, interval): #       "Memory boost"  # "Cache junk"  -. if int(self.tick) == 50: self.screen_junk.button_memory_bust_icon_state.source = \ "Data/Images/app_uninatall.png" elif int(self.tick) == 99: self.screen_junk.button_cache_junk_icon_state.source = \ "Data/Images/app_uninatall.png" #      STOP. self.screen_junk.button_stop.background_normal = \ "Data/Images/done_progress.png" self.screen_junk.button_stop.text = \ "CLEAN JUNK {}MB".format(self.tick) self.screen_junk.button_stop.color = [1.0, 1.0, 1.0, 1] #   Activity. self.set_new_color() self.screen_junk.background.rgb = self.new_color self.start_screen.background_action_bar.rgb = self.new_color #     . value = (self.tick * 100) / 100 print value self.screen_junk.progress_line.bar_value_percent = value self.screen_junk.progress_line.redraw() self.screen_junk.progress_label.text = \ "Scanning: org.package {}".format(self.scan_packages[self.tick]) self.animation_percent( self.screen_junk.layouts, self.animation_clean, iteration=100) def animation_percent(self, layout, callback, iteration=65): """   . :type layout: &lt;class 'Libs.uix.startscreen.StartScreen'&gt; and &lt;class 'Libs.uix.junkfiles.JunkFiles'&gt;; :param callback: animation_clean and calc_elliptical_length; """ self.tick += 1 if self.tick == iteration: self.set_default_tick_rgb() self.Clock.unschedule(callback) return numeral_one, numeral_two = divmod(self.tick, 10) if self.tick &lt;= 34 or iteration != 65: layout.storage_numeral_one.source = \ "Data/Images/{}.png".format(int(numeral_one)) layout.storage_numeral_two.source = \ "Data/Images/{}.png".format(int(numeral_two)) try: layout.numeral_float.source = \ "Data/Images/{}.png".format(randint(1, 9)) except AttributeError: pass try: if self.tick &lt;= 65: layout.ram_numeral_one.source = \ "Data/Images/{}.png".format(int(numeral_one)) layout.ram_numeral_two.source = \ "Data/Images/{}.png".format(int(numeral_two)) except AttributeError: pass def calc_elliptical_length(self, interval): """     Activity.""" elliptical_length = ((self.tick * 500) // 178) + 222 self.animation_storage_ram(elliptical_length) self.animation_percent( self.start_screen.layouts, self.calc_elliptical_length) def set_default_tick_rgb(self): """      Activity JUNK FILES.""" self.tick = 9 self.R = 41. self.G = 89. self.B = 173. def set_new_color(self): """      Activity JUNK FILES.""" self.R += 2 self.G += 1 self.B -= 1 self.new_color = self.R / 255., self.R / 255., self.B / 255.</span></span></code> </pre></div></div><br><p>    : </p><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://rutube.ru/play/embed/8524183&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhtaOjTxG8kUoXunL-wqaAZfEG96g" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe><br><p> KivyCleanMasterDemo   githab ‚Äî <a href="https://github.com/HeaTTheatR/KivyCleanMasterDemo">https://github.com/HeaTTheatR/KivyCleanMasterDemo</a> </p><br></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/300960/">https://habr.com/ru/post/300960/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../300946/index.html">Template language for the universal signature code analyzer</a></li>
<li><a href="../300948/index.html">‚ÄúI don‚Äôt remember those moments, I don‚Äôt even remember!‚Äù</a></li>
<li><a href="../300952/index.html">Multithreading in PHP: pthreads</a></li>
<li><a href="../300954/index.html">Writing a forum from scratch on Ruby on Rails and AngularJS</a></li>
<li><a href="../300956/index.html">Lazy event sourcing or how to live for today</a></li>
<li><a href="../300966/index.html">Deep into the core: familiarity with LTTng</a></li>
<li><a href="../300968/index.html">RS232 3-in-1 device for a home Linux server: Part 2 (Server)</a></li>
<li><a href="../300972/index.html">Record of the webinar "Light cloud protection of corporate networks with low total cost of ownership"</a></li>
<li><a href="../300974/index.html">"Astronauts" in Chile: how we did the entire IT infrastructure for four telescopes in the Andes</a></li>
<li><a href="../300976/index.html">8 tips for every day for those who want to be happy (part 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>