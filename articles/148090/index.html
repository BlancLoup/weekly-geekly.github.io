<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>x86 in production: high end industrial controllers, pascal and viruses</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is such a not very correct term: PC based industrial automation. I think that it is not entirely accurate, since no one, of course, connects the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>x86 in production: high end industrial controllers, pascal and viruses</h1><div class="post__text post__text-html js-mediator-article">  There is such a not very correct term: PC based industrial automation.  I think that it is not entirely accurate, since no one, of course, connects the machine to an ordinary personal computer.  <s>And then suddenly freezes, and the machine will cut off something unnecessary</s> .  But there is a rational grain in this term - for many years among the control devices of industrial automation there are devices resembling PCs. <br><br><img src="https://habrastorage.org/storage2/387/707/d7a/387707d7add248da341f52dd5de17610.jpg" alt="Simatic S7">  Reminding, of course, not outwardly. <br><br>  Like in your laptop, the controller can have a Core i5 processor, ordinary DRAM (usually only with ECC), an SSD disk, and regular Ethernet.  The boot process is no different either - the BIOS loads the operating system.  As a rule, OSes - RTOS.  However, sometimes even Windows.  And it is not always Windows Embedded Compact (formerly CE).  Even Windows Embedded 7 is used, and this is a full seven.  (Linux is also found) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  The main classes of computational problems solved in the process of the production line - <a href="http://ru.wikipedia.org/wiki/%25D0%25A7%25D0%259F%25D0%25A3">CNC</a> and <a href="http://ru.wikipedia.org/wiki/SCADA">SCADA</a> . <br><br>  In the case of CAD and SCADA, the questions whether x86 performance is necessary, and whether this platform is sufficiently reliable, have not been worth it for a long time. <br><br>  CNC is a little more complicated.  To manage many industrial devices do not need a powerful number shredder, but the requirements for reliability and guaranteed response time may exceed the capabilities of x86.  Enough microcontroller or the simplest <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D1%2583%25D0%25B5%25D0%25BC%25D1%258B%25D0%25B9_%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25BA%25D0%25BE%25D0%25BD%25D1%2582%25D1%2580%25D0%25BE%25D0%25BB%25D0%25BB%25D0%25B5%25D1%2580">PLC</a> . <br><br>  G-code is typically used for CNC programming, and x86 computational power is not required.  If the machine is more complex, PLC is used.  How is the PLC programmed?  There is a standard IEC61131-3.  It defines the programming methods: ‚Äúassembler type‚Äù IL, as well as graphical diagrams based on Petri nets, block diagrams or ladder logic. <br><br>  Of course, on relay logic, asm or Petri nets it is very difficult to write a program so complex that there is not enough computing power of the microcontroller for its execution.  But then <s>pascal</s> comes to the rescue <s>!</s>  Another PLC code representation defined in IEC61131-3. <br>  Here is the code in this obscure language: <br><pre> Var
                 arr1: ARRAY [1..4,1..4] OF REAL; 
                 arr2: ARRAY [1..4,1..4] OF REAL;
                 arr3: ARRAY [1..4,1..4] OF REAL;
                 i: int;
                 j: int;
                 k: int;
 END_VAR
 FOR i: = 1 TO 4 DO
                 FOR j: = 1 TO 4 DO
                                 arr3 [i, j]: = 0.0;
                                 FOR k: = 1 TO 4 DO
                                                 arr3 [i, j]: = arr3 [i, j] + arr1 [i, k] * arr2 [k, j];
                                 END_FOR
                 END_FOR
 END_FOR
</pre><br>  Nothing like?  I also learned in computer science lessons 20 years ago that if you equip a programmer with Pascal and structured programming, the processor speed is not too high. <br><br>  In some cases, the faster the PLC processor, the better: there are applications where measurements from dozens of sensors are used as input data for a fairly complex calculation, and the data comes in at dozens of kilohertz.  That is, in tens of microseconds, they must be taken, driven through a complex floating-point algorithm, and commands must be given.  Only the latest generation x86 processor with a bunch of gigaflops inside can handle it. <br><br>  In addition, it is convenient if the HMI (that is, the GUI translated to general IT) will spin on the same piece of hardware as the PLC program.  Well, since we started such workload consolidation, even fieldbus communications are also controlled by the same piece of hardware, which is really there!  The blessing of cores in a single processor now happens a lot, creating multi-threaded real-time applications is difficult, and virtualization provides good isolation (if you don‚Äôt forget about the <a href="http://habrahabr.ru/company/intel/blog/117760/">nuances</a> associated with the shared cache and memory controller) <br><br>  In the last paragraph, I used a new word - <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25BE%25D0%25BC%25D1%258B%25D1%2588%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B5%25D1%2582%25D1%258C">fieldbus</a> .  The evolution of industrial data transmission systems is also a good example of how technology comes from IT to supplant specialized dinosaurs.  Modern fieldbus networks Profinet, Ethercat, Sercos III are based on Ethernet, and work with regular network cards made by Intel and, probably, other vendors. <br><br>  What prevents the full transition to x86?  Cautious lawmakers <s>are afraid of an explosion of nuclear power plants from bluskrin</s> require that in particularly important places PLC meet certain <a href="http://en.wikipedia.org/wiki/IEC_61508">safety standards</a> .  There are OSes that meet these standards - for example, VxWorks, QNX, etc.  There is even a virtual machine - Windriver Hypervisor is also SIL3 / SIL4 certified. <br><br>  The issue is certification of iron.  Of course, the corresponding certificate is easier to get on a simple microcontroller that has been produced unchanged for years than on a complex x86 processor and chipset, the generations of which change every year.  But this does not prevent Intel processors from being used in many <a href="http://www.automation.siemens.com/mcms/programmable-logic-controller/en/simatic-s7-controller/s7-1200/pages/default.aspx">popular</a> <a href="http://www.beckhoff.com/english.asp%3Findustrial_pc/c6250.htm">PLCs</a> <a href="http://www.ab.com/en/epub/catalogs/12762/2181376/2416247/1239772/2185363/Introduction.html">from different</a> <a href="http://www.br-automation.com/cps/rde/xchg/br-productcatalogue/hs.xsl/products_62810_ENG_HTML.htm">manufacturers</a> . <br><br>  But what about real time?  We need hard real time, soft real time will not go, that's why: even if we are on the deadline in 99.99999% of cases, the remaining 0.00001% can crash on average several times a day.  Of course, we have to have a safety function in this case, which will de-energize everything, but this is often not fun to do.  I have heard many times the opinion that a complex OOO processor and Real Time are incompatible concepts.  After all, the microcontroller can look at the code, and up to the tact know how long it will take to execute. <br><br>  So?  So, not so.  Watch your hands!  For example, suppose we have a cycle of 100 microseconds.  Let it begin with an interrupt.  To the interrupt handler, the control can go through 2, and maybe (at worst) after 8 microseconds.  Let another 10-15 microseconds spend reading the information received.  And then another 50-75 microseconds will process it (we have a terribly unpredictable superscalar processor with an even more unpredictable cache!).  Total spend from 62 to 98 microseconds.  Terrible jitter;  creepy, not adapted for hard real time x86!  But in the worst case (which occurs once every few hours with a frequency of 10 kilohertz), we still get out in 100 microseconds. <br><br>  But what is 50 microseconds of processing the data on the core i3?  This is 100,000 ticks, or about 120000 instructions with IPC = 1.2 not at all outstanding.  Suppose we also have a not very efficient PLC compiler that generates on average 5 x86 instructions for each IL instruction.  That is, for the cycle, we executed 24,000 instructions of IEC61131-3 IL. <br><br>  And if you imagine the same thing on a very bright, but not x86 PLC?  There is no jitter to interrupt or read data, and you can tell in advance exactly how long it will take to execute 24,000 IL instructions.  Let's look in the documentation of the manufacturer of the PLC from the big three (AB, Siemens, Mitsubishi automation)  How long does one IL instruction execute?  9.5 nanoseconds  24,000 instructions will execute in 228 microseconds.  PM <br><br>  If it is objected that 24,000 processing instructions per cycle are too many, then I will answer: <br>  <s>Are you for me, or for a bear?</s>  .  Clients talked about modern machines, the controller of which each cycle calculates the physical model of dozens of actuators, based on the readings of dozens of sensors.  That is, it is engaged in the numerical solution of the system of equations every clock cycle, which requires more and more FP performance. <br><br>  All of the above related to the performance of a single core.  But we have a lot of them now.  And we can use them to consolidate several functions or PLCs on a single device, or to parallelize the control program.  Latest RTOS versions such as VxWorks, Twincat, etc.  keep hard real time guarantees with multithreading support.  But this is at the level of the OS kernel, hypervisor and libraries.  And at the application level, using the usual primitives of internuclear synchronization, it is very easy to break real time.  Unfortunately, the general recipe for dealing with this problem is unknown to me. <br><br>  I wrote above that multithreaded programming and the use of virtualization are becoming popular in the industry.  That is, there is a lag behind IT years in a few.  Maybe in a few more years they will start introducing something like a private cloud?  And then besides Stuxnet, which everyone has heard about, but no one has seen, will it be necessary to fight malware that can break industrial robots and force automated chemical production to synthesize interesting substances instead of the necessary ones? </div><p>Source: <a href="https://habr.com/ru/post/148090/">https://habr.com/ru/post/148090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148084/index.html">July habraeracheta (DC)</a></li>
<li><a href="../148086/index.html">VK Offline - E-mail client and address book based on the data of your VK profiles</a></li>
<li><a href="../148087/index.html">Competitive Intelligence at PHDays 2012</a></li>
<li><a href="../148088/index.html">Why does everyone work with OOP? Briefly about the main or ‚Äúfood‚Äù for reflection</a></li>
<li><a href="../148089/index.html">How we raised the delivery service</a></li>
<li><a href="../148093/index.html">Parallels puzzle: Bertrand Serlet, mobile apps and new motivation program</a></li>
<li><a href="../148094/index.html">Amazon added ssd storage support to hi1.4xlarge top instance</a></li>
<li><a href="../148095/index.html">Public performance. What? How? What for?</a></li>
<li><a href="../148096/index.html">Geek Picnic - open air for IT-specialists</a></li>
<li><a href="../148098/index.html">Introduction to Javascript Source Maps</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>