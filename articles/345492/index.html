<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Non convolutional networks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The advantages, problems and limitations of convolutional neural networks (CNN) are currently quite well studied. About 5 years have passed since thei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Non convolutional networks</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/yz/9a/sz/yz9asz-bgsa5htvp5lef1fkuimo.png"><br><br>  The advantages, problems and limitations of convolutional neural networks (CNN) are currently quite well studied.  About 5 years have passed since their recognition by the community of engineers, and the first impression ‚Äúnow we will solve all the problems‚Äù, I want to believe, has already passed.  So, it's time to look for ideas that will make the next step in the field of AI.  Hinton, for example, <a href="https://habrahabr.ru/company/recognitor/blog/343726/">suggested CapsuleNet</a> . <br>  Together with Alexey Redozubov, relying on his ideas about the structure of the brain, we also decided to retreat from the mainstream.  And now I have something to show: architecture (goes with the title picture to attract attention) and the <a href="https://gitlab.com/Morzhakov/ContextNet">source code for Tensorflow</a> for MNIST. <br><br>  More formally, the result is described in an <a href="https://arxiv.org/ftp/arxiv/papers/1712/1712.05954.pdf">article on arxiv</a> . <br><a name="habracut"></a><br><h2>  What for? </h2><br>  Always and in everything we deal with ambiguity.  The further information leaves the senses, the more options for its interpretation becomes.  It seems, sight does not bring us.  But no, there are a number of illusions that demonstrate that this is not so: the <a href="https://www.youtube.com/watch%3Fv%3D1ZXO1wiNTmI">illusion of a concave mask</a> (you need to try very hard to realize its concave depth), the famous white-blue-brown dress.  Hearing is the same story that amazes even more than visual illusions: <a href="https://www.youtube.com/watch%3Fv%3D4SwHAhcL5IA">I want to congratulate you on this</a> .  And when the question of perception of information concerns abstract concepts, it is impossible not to recall the endless debate about politics. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This principle of changing the meaning of the observable depending on the context is universal, implemented in one way or another for any information we are dealing with.  And, at the same time, it is poorly or not explicitly reflected in most approaches to machine learning.  Often, the formulation of machine learning tasks eliminates the very possibility of various interpretations.  Although, if you look at the idea of ‚Äã‚Äãconvolutional networks from a different angle, it turns out that the statement of the problem for one convolutional layer is formulated as follows: you must select K features with the size of MxM, regardless of what position (spatial context) they are in.  If at the same time it is assumed that the transfer operation on X, Y is not programmed in advance, then the task becomes very nontrivial.  Similarly with recurrent networks: it is necessary to distinguish sequences in time, regardless of at what point in time T (context of time) it appeared. <br><br>  In addition, after learning, we can use ideas about how data changes due to a change in context.  Show a person a new car model from 4 sides, he will easily recognize it later in perspective from a random angle.  A child will see a cartoon where a certain social model of interaction is demonstrated by beasts, it is not difficult for him to recognize the same situation in his relationship with people.  This is such a powerful and universal principle that I personally wonder why it receives so little attention. <br><br>  I am convinced that Strong Artificial Intelligence will differ precisely in the ability to present any information at any level of processing in various contexts, choose the most appropriate context of the observed situation and experience gained as a result of training. <br><br>  The inspiration for the convolutional networks (or rather the neocognitron) was the research of Hubel and Wiesel, who at one time conducted very effective studies of the visual cortex V1 and the function of minicolumns in it, for which they were awarded the Nobel Prize.  But the results of their experiments can be interpreted differently.  Read more <a href="https://habrahabr.ru/company/recognitor/blog/277163/">here</a> . <br>  Hinton's capsule nets are also a way of rethinking the function of minicolumns. <br><br><h2>  Suppose the minicolumn function </h2><br>  The cerebral cortex is structurally composed of zones with different functions, but at the same time, regardless of the zone, minicolumns are structurally distinguished - columns of neurons, the vertical connections between which are denser than the horizontal ones. <br><br><img src="https://habrastorage.org/webt/gq/uo/c2/gquoc2gemovvtnbdrpxtlzfqgze.png"><br><br>  We assume that the minicarrier presents the input information in its own context.  Then, in each minicolumn, known patterns are recognized, its activity is proportional to the degree of reliability of recognition.  Neighboring minicolumns represent similar transformations, due to this we can choose local maxima of activity on the cortex, which will correspond to the best contexts in which the input information is treated.  The output of the cortical area will be the list: (recognized patterns, context). <br><br><h2>  Model for MNIST </h2><br>  Only one level of information analysis was modeled (one zone), several zones will be the next stage. <br><br>  It is fundamentally important that here we have abandoned spatial convolutions in the image (Conv2D) and max-pooling 2x2, which forgive small geometric distortions, due to which the accuracy on MNIST is noticeably improved. <br><br>  I will repeat the picture so that I don‚Äôt have to wind off far when reading the text: <br><img src="https://habrastorage.org/webt/yz/9a/sz/yz9asz-bgsa5htvp5lef1fkuimo.png"><br><br>  There are 3 important parts: <br><br>  1) Only a vector of length 32 enters the zone ‚Äî the result of compression by the classical autoencoder with 2 fully connected layers for decoding and encoding. <br><br>  2) We set 405 geometric context-transformations: 5 turns X 9 displacements X 9 scales.  We look at how the code changes (32 components) after the input images are transformed, we train for each context transformation 2 fully connected layers (32-&gt; 256-&gt; 32), i.e.  one hidden and one day off.  In fact, of course, just remember. <br><br>  3) We are looking for stable patterns, regardless of the context in which they appeared, for each pattern we choose the best context (max-pooling layer). <br><br>  Then we exit the zone to a small fully meshed network, which decides what the figure is in front of us. <br><br><h2>  Training </h2><br>  Yes, the principle of reverse propagation of errors was used everywhere.  The only thing that his "long-range" was very limited.  Those.  studied in stages, there was hardly any real ‚Äúdeep learning‚Äù.  There is a feeling that everything should work on different approaches, but until the algorithms are written we will use proven tools. <br><br>  First, we train the autoencoder separately: <br><br><img src="https://habrastorage.org/webt/6a/br/hq/6abrhqpvuaae4y8ynfdfmsqdns8.png"><br><br>  And we fix the weights of the layers of the encoder and decoder. <br>  Actually, this is a completely optional step.  Moreover, due to the non-ideal data presentation, the accuracy will deteriorate a little.  But at stage 3, this reduces the number of calculations. <br><br>  Then we train all 405 transformations.  Those.  how the image code changes after these transformations.  Test what happened.  Restore the original images from the converted codes: <br><br><img src="https://habrastorage.org/webt/kp/ti/5l/kpti5ldb_yml_djfmqfvddaroeq.png"><br><br>  It seems that it is trite (and it is)!  But here are a couple of very important points: <br><br>  1) From the point of view of the model, the transformation is not programmed, but obtained by training.  Those.  absolutely no restrictions on what data we are dealing with and what contextual transformations.  And what's even cooler, you can even convert not to the same space.  But more about that later. <br><br>  2) You can take and submit to the input a sign that has never been shown before, and we will know how it changes depending on the context. <br><br>  Let's give the inverted triangle to the entrance and get: <br><br><img src="https://habrastorage.org/webt/je/18/vw/je18vwzev14d1ei-_gqoqhcwp7q.png"><br><br>  It looks, of course, not so impressive.  But ideologically it is very cool!  Due to previous experience, you know how an object that you have never seen before in your life will look in all possible contexts.  And this opens up the possibility for one-shoot learning.  Saw an object in one view, and then find out completely in another!  This drastically reduces the required training sample.  And if we talk about computer vision, then we are not only talking about geometric transformations, but also about color, brightness, etc. <br><br>  And then we need detectors that are common to all contexts.  It was implemented using a convolutional layer with a 1x1 core size and a max-pooling layer, which selected a winner for each core.  The convolutional layer here is just a way to use the same weights for different contexts, it does not perform its usual function (like max-pooling with a kernel of an unusual size of 405x1). <br><br><h2>  results </h2><br>  First of all, it was important to check how things are going with reducing the size of the training sample.  Take the first 1000 images and train only on them. <br><br>  The learning curve is as follows: <br><br><img src="https://habrastorage.org/webt/xp/4v/tu/xp4vtuaqz_ku-wn5iy3v0joywdk.png"><br><br>  Accuracy 96%. <br><br>  It is necessary to compare with a convolutional network, for example, such an architecture: <br><br><img src="https://habrastorage.org/webt/qu/dx/in/qudxin5rvlz_m9slwdq9tt-epum.png"><br><br>  Accuracy after CNN training was 95.3%. <br>  An attentive reader will notice that the comparison is unfair, because  I used implicit augmentation (geometric distortion of input images).  So we introduce a similar augmentation for the convolution network.  We already get 96.2%. <br><br>  Not bad, the result is comparable with the convolutional network. <br><br>  Training in the full base gave an accuracy of 99.1%.  Which is much worse than the convolutional network, but also better than a fully connected network of several levels. <br><br>  Failure to use convolutional layers, presumably, reduced accuracy.  But, in any case, we managed to debug the architecture and get adequate accuracy. <br><br><h2>  Something it all reminds? </h2><br>  Yes, first, of course, unexpectedly it looks like Hinton's CapsuleNet.  He also offers his own interpretation of the functionality of minicolumns.  The main difference is that CapsuleNet does not contain the idea of ‚Äã‚Äãpresenting information in various contexts.  But the fact that the architecture turned out to be similar, suggests a very interesting reflection.  In its implementation, the activity of the minicolumn corresponds to the recognition of one of the numbers, and in our concept it turns out that the figure is the context.  And what does this picture mean in the context of the fact that it is a seven?  And in the context of what is the unit?  And this question is really not devoid of meaning.  The context may be a geometric transformation, and the context may be a type of recognizable object.  About this next. <br><br>  Another transformation idea is contained in <a href="https://arxiv.org/pdf/1506.02025.pdf">Spartial Transformation Networks</a> .  The layer of geometric transformation is included in the gap of layers and another small grid that evaluates the most appropriate transformation using regression.  At the same time, discontinuities in differentiability are not allowed, and all this can be trained using the method of back propagation of errors.  There are 2 differences: it is not formulated what to do with discrete transformations (and, for example, in the grammar of speech, they are discrete), and it seems that a small regression network for assessing the optimal transformation is unnecessary.  The best context is to choose on the basis of in which of the contexts the data form a known pattern, and there is no other optimal way, apart from analyzing each of the transformations. <br><br><h2>  And another thought that never lets go </h2><br>  There is a so-called ‚ÄúTwo-stream hypothesis‚Äù in the visual tract (and in the auditory / speech).  On one side of the brain (ventral stream), minicolumns respond mainly to the characteristics of objects and the types of objects themselves, and on the other side of the brain (dorsal stream) mainly to spatial characteristics. <br><br><img src="https://habrastorage.org/webt/ft/tp/rd/fttprdcb2psrnwmitni5fito8oc.png"><br><br>  In our interpretation, dorsal stream is just about spatial and temporal transformations.  Take a look at V2 and V3: Speed ‚Äã‚ÄãX Direction - transition to the reference system, moving at a given speed with a given direction, Spartical Frequency - just a scale conversion, Temporal Frequency - a change in scale over time. <br><br>  But Ventral Stream looks completely counterintuitive.  What does it mean to go into the context of ‚ÄúSimple shapes‚Äù (context of the form), or the context of curvature?  In the context of color, by the way, is not a problem.  Or in TE / AIT "in the context of the object"?  This problem can be overcome by assuming that the minicolumn code characterizes the properties and characteristics of the object.  For example, the curvature of the border in the image is characterized by contrast, blurring, color, etc. And these characteristics will be common to each of the minicolumns responsible for the curvature. <br><br>  Very close to CapsuleNet, but the styles or features inside the mini columns should be common to some neighborhood.  It remains an open question how to train this type of contextual transformations. <br><br>  It is also remarkable here that the result of recognition obtained in one of the Streams can be used in the other.  Knowing the shape in the context of a particular position in the dorsal stream, orientation and scale, you can increase the probability of activation of the corresponding mini speakers in the ventral stream.  And vice versa. <br><br><h2>  findings </h2><br>  There is still plenty of work ahead. <br><br>  <b>PS: The</b> name ContextNet, which I used in the source code, is <a href="http://citeseerx.ist.psu.edu/viewdoc/download%3Fdoi%3D10.1.1.473.4586%26rep%3Drep1%26type%3Dpdf">in fact already taken</a> , but it is painfully well suited. </div><p>Source: <a href="https://habr.com/ru/post/345492/">https://habr.com/ru/post/345492/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345482/index.html">Key-value for storing metadata in storage. We test the selected databases</a></li>
<li><a href="../345484/index.html">Linear Regression with Go</a></li>
<li><a href="../345486/index.html">20 hits of world cinema that translated from English otherwise</a></li>
<li><a href="../345488/index.html">What is the difference between React and Vue?</a></li>
<li><a href="../345490/index.html">We are launching a new online course ‚ÄúWeb Services Development on Go‚Äù</a></li>
<li><a href="../345494/index.html">xss vulnerability</a></li>
<li><a href="../345496/index.html">As I asked students to write phishing emails</a></li>
<li><a href="../345498/index.html">Frontend performance optimization</a></li>
<li><a href="../345500/index.html">Generative design: on the threshold of a new design era</a></li>
<li><a href="../345502/index.html">Monitoring SMART HDD - windows + python + zabbix</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>