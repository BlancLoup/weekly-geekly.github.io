<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Django do-it-yourself part 3: Routes, debugging, middleware, bottle, beaker</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 1. 
 Part 2. 

 Introduction 
 This article will focus on the intricacies of implementing a wsgi application. We will not consider writing an app...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Django do-it-yourself part 3: Routes, debugging, middleware, bottle, beaker</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/post/144717/">Part 1.</a> <br>  <a href="http://habrahabr.ru/post/146798/">Part 2.</a> <br><br><h4>  Introduction </h4><br>  This article will focus on the intricacies of implementing a wsgi application.  We will not consider writing an application server from scratch, since there are a lot of microframes that already do this, not to mention large ones.  For these purposes, was selected bottle.  Mostly for its minimalism.  We will also talk about routs, statics, and sessions that will be beaker in charge. <br><a name="habracut"></a><br><h4>  Debugging </h4><br>  One of the main problems with microframes is that when errors occur in the application, most of the errors that wsgi gives us should be caught in the logs.  And we would like to see all this on the page in the browser, or in its console in case some post request returned an error. <br><br>  To do this, we simply integrate into the processing chain and intercept all exceptions that the application itself did not intercept, and display it as a beautifully designed page. <br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-comment"><span class="hljs-comment">#  bottle        ,    . @bottle.hook('before_request') def pre_init(): #       , ini_environment() #       #  options_session #   bottle app = bottle.app() app.catchall = False #       . debugger = DebuggerM(app) #     . session = SessionMiddleware(debugger, options_session) #   application    wsgi' application = session except Exception as e: #            #     . exc = sys.exc_info() def error_apps(environ, start_response): start_response('500 INTERNAL SERVER ERROR', [('Content-Type', 'text/html; charset=utf-8')]) return view_error(exc, environ, e) application = error_apps</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The class that directly serves our middleware. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DebuggerM</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""       """</span></span> __app = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, app)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#      bottle # app-    ,  application     middleware self.__app = app def __call__(self, environ, start_response): try: #      (   ) app_iter = self.__app(environ, start_response) for item in app_iter: #      #          yield item except Exception as e: #         . start_response('500 INTERNAL SERVER ERROR', [('Content-Type', 'text/html; charset=utf-8')]) yield view_error(sys.exc_info(), environ, e)</span></span></code> </pre><br><br>  The function itself that draws our error: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">view_error</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(exc, environ, e)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cgi, traceback ee = dict(environ) text= <span class="hljs-string"><span class="hljs-string">''</span></span> text=<span class="hljs-string"><span class="hljs-string">'&lt;h1&gt;ERROR "%s"&lt;/h1&gt;'</span></span> % str(e) text+=<span class="hljs-string"><span class="hljs-string">'&lt;style&gt;pre{border:red solid 1px; max-height:240px; overflow:auto;}&lt;/style&gt;'</span></span> text+=<span class="hljs-string"><span class="hljs-string">'&lt;h2&gt;Stack trace&lt;/h2&gt;&lt;pre&gt;%s&lt;/pre&gt;'</span></span> % <span class="hljs-string"><span class="hljs-string">''</span></span>.join(reversed(traceback.format_exception(*exc))) text+=<span class="hljs-string"><span class="hljs-string">'&lt;h2&gt;Env&lt;/h2&gt;&lt;pre"&gt;%s &lt;/pre&gt;'</span></span> % <span class="hljs-string"><span class="hljs-string">' '</span></span>.join([<span class="hljs-string"><span class="hljs-string">'%s=%s'</span></span> %(k, ee[k])<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ee]) text+=<span class="hljs-string"><span class="hljs-string">'&lt;/pre&gt;'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> text</code> </pre><br><br><h4>  Work with routs </h4><br>  By default, we already have routes in the bootle as a decorator that can be hooked to any function: <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@route('/hello/:name') def index(name='World'): return '&lt;b&gt;Hello %s&lt;/b&gt;' % name</span></span></code> </pre><br><br>  but it is convenient for relatively small projects.  And we would like to expand this moment so that we could create a file of this type in any component. <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> app1 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * routes = { <span class="hljs-string"><span class="hljs-string">'function'</span></span>: (<span class="hljs-string"><span class="hljs-string">'/hello/'</span></span>, hello, <span class="hljs-string"><span class="hljs-string">'GET'</span></span>), <span class="hljs-string"><span class="hljs-string">'function2'</span></span>:(<span class="hljs-string"><span class="hljs-string">'/hello/&lt;_id&gt;'</span></span>, hello_post, <span class="hljs-string"><span class="hljs-string">'POST'</span></span>) }</code> </pre><br>  Accordingly, after that, it is possible in any place, preferably in this component, to call the hello function.  To do this, we write in the file which contains the description of the core core functionality. <br><pre> <code class="python hljs">all_routes = {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">union_routes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dir)</span></span></span><span class="hljs-function">:</span></span> routes = {} <span class="hljs-comment"><span class="hljs-comment">#               . if __builtin__.__import__('routes', globals=globals()): #    module = sys.modules['routes'] #     routes routes.update(module.routes) #     for name in os.listdir(dir): path = os.path.join(dir, name) #       routes.py if os.path.isdir(path) and os.path.isfile(path+'/routes.py'): #           name = 'app.'+path[len(dir)+1:]+'.routes' if __builtin__.__import__(name, globals=globals()): module = sys.modules[name] routes.update(module.routes) return routes def setup_routes(routes): #           bottle        . all_routes.clear() all_routes.update(routes) for name in routes: path, func, method = routes[name] route(path, method=method, name=name)(func)</span></span></code> </pre><br><br>  Now we are replacing the comment that we left in the first part of the debugging devoted to the call initialization of the routes, so that they are immediately connected to us. <br><pre> <code class="python hljs">routes = {} <span class="hljs-comment"><span class="hljs-comment">#      routes.update(union_routes(lib_path)) #      routes.update(union_routes(app_path)) setup_routes(routes)</span></span></code> </pre><br>  All now we have full-fledged routes, we can optionally wrap any function in the decorator, or set out a list of routes with their assigned functions in the file route.py and, if desired, pass the necessary parameters to them through lambda. <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> app1 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * routes = { <span class="hljs-string"><span class="hljs-string">'function2'</span></span>: (<span class="hljs-string"><span class="hljs-string">'/hello/&lt;_id&gt;'</span></span>, hello_post, <span class="hljs-string"><span class="hljs-string">'POST'</span></span>), <span class="hljs-string"><span class="hljs-string">'function3'</span></span>: (<span class="hljs-string"><span class="hljs-string">'/base/1'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span>: test(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">u''</span></span>), <span class="hljs-string"><span class="hljs-string">'GET'</span></span>) }</code> </pre><br>  Also now using the key of our routes dictionary in the given case of function2, we can form links by the name of the route without knowing exactly which parameters will be passed to the link itself, for example, if you take '/ hello / &lt;_ id&gt;' then &lt;_id&gt; will be set dynamically. <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">make_link</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name, params, full=False)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""     &lt;&gt;     """</span></span> <span class="hljs-comment"><span class="hljs-comment">#     templ_link = all_routes[name][0][1:] #      &lt;&gt; r = re.compile(r'&lt;([^:&gt;]+)(:[^&gt;]+)?&gt;') #       ,       . while True: rs = r.search(templ_link) if not rs: break sub = rs.group(0) name = rs.group(1) templ_link = re.sub(sub, params[name], teml_link) link = os.path.sep+ templ_link #        ,     . if full: link = 'http://'+get_name_host()+link return link</span></span></code> </pre><br>  Now we write anywhere in the template or just in the code. <br><pre> <code class="python hljs">link = make_link(<span class="hljs-string"><span class="hljs-string">'test'</span></span>, {<span class="hljs-string"><span class="hljs-string">'id'</span></span>:id, <span class="hljs-string"><span class="hljs-string">'doc_id'</span></span>:doc_id}, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre><br>  It‚Äôs often easier to admit to writing just a link, but sometimes you can‚Äôt do without this function. <br><br><br><h4>  Work with sessions </h4><br>  Working with sessions is to use beaker.  This wonderful module can work with sessions, save them in a selected folder or in the database.  You can configure it to save them for example in postgresql or in memcached.  The first thing we do is import: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> beaker.middleware <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SessionMiddleware</code> </pre><br>  Next, we replace the comment with the initialization immediately after the initialization of the routes. <br><pre> <code class="python hljs"> options_session = { <span class="hljs-string"><span class="hljs-string">'session.cookie_expires'</span></span>: <span class="hljs-number"><span class="hljs-number">30000</span></span>, <span class="hljs-string"><span class="hljs-string">'session.timeout'</span></span>: <span class="hljs-number"><span class="hljs-number">30000</span></span>, <span class="hljs-string"><span class="hljs-string">'session.type'</span></span>: <span class="hljs-string"><span class="hljs-string">'file'</span></span>, <span class="hljs-comment"><span class="hljs-comment">#     'session.data_dir': './s_data' #      }</span></span></code> </pre><br>  And in the pre_init () function, we add a line for dynamic, if so you can tell the definition for which domain we store sessions. <br><pre> <code class="python hljs">session.options[<span class="hljs-string"><span class="hljs-string">'session.cookie_domain'</span></span>] = get_name_host()</code> </pre><br>  get_name_host () - is engaged in obtaining the name of our site. <br>  After that, all we need is a simple function with which you can use the sessions. <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">session</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    s = request.environ.get('beaker.session') return s</span></span></code> </pre><br>  Now anywhere: <br><pre> <code class="python hljs">s = session() s[<span class="hljs-string"><span class="hljs-string">'test'</span></span>] = <span class="hljs-string"><span class="hljs-string">'123'</span></span> s.save()</code> </pre><br><br><h4>  Statics </h4><br>  We will also deal with bottle static, only we, in turn, will expand its capabilities for our needs. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  bottle          ,           . @route('/static/&lt;component&gt;/&lt;fname:re:.*&gt;') def st_file(component, fname): #              ,     bottle path = os.path.join( settings.lib_path, component, 'static') + os.path.sep if not os.path.exists(path + fname): path = os.path.join( settings.lib_path, 'app', component,'static')+ os.path.sep if not os.path.exists( path + fname): path = os.path.join( os.getcwd(), 'app', component, 'static')+ os.path.sep if not os.path.exists(path + fname) and component == 'static': path = os.path.join( os.getcwd(), 'static')+ os.path.sep return static_file(fname, root=path)</span></span></code> </pre><br><br>  Now it remains to learn how to connect statics if desired from the module scripts if such a module exists, and not all without parsing in the main template. <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_resourse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name, append=True)</span></span></span><span class="hljs-function">:</span></span> env = get_environment(); t = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> name.endswith(<span class="hljs-string"><span class="hljs-string">'.css'</span></span>): t = <span class="hljs-string"><span class="hljs-string">'css'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> name.endswith(<span class="hljs-string"><span class="hljs-string">'.js'</span></span>): t = <span class="hljs-string"><span class="hljs-string">'js'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> t: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> env[<span class="hljs-string"><span class="hljs-string">'res_list'</span></span>][t]: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> append: env[<span class="hljs-string"><span class="hljs-string">'res_list'</span></span>][t].append(name) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: env[<span class="hljs-string"><span class="hljs-string">'res_list'</span></span>][t].prepend(name)</code> </pre><br><br>  We call this function in any module and pass the right path as the first argument to the static file of the type '/ static / &lt;component&gt; / &lt;fname: re:. *&gt;': <br><pre> <code class="python hljs">add_resourse(/static/base/base.js, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre><br><br>  And in the main template, just call: <br><pre> <code class="python hljs">{% <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> res <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> env.res_list[<span class="hljs-string"><span class="hljs-string">'js'</span></span>] %} &lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> src=<span class="hljs-string"><span class="hljs-string">"{{res}}"</span></span>&gt;&lt;/script&gt; {% endfor %} {% <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> res <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> env.res_list[<span class="hljs-string"><span class="hljs-string">'css'</span></span>] %} &lt;link rel=<span class="hljs-string"><span class="hljs-string">"stylesheet"</span></span> type=<span class="hljs-string"><span class="hljs-string">"text/css"</span></span> href=<span class="hljs-string"><span class="hljs-string">"{{res}}"</span></span> /&gt; {% endfor %}</code> </pre><br><br><h4>  Hello world </h4><br>  Now a simple Hello world would look something like this. <br>  The route.py route file will be placed in / app / app_one of the project: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> app.app_one.view <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * routes = { <span class="hljs-string"><span class="hljs-string">'hello'</span></span>: (<span class="hljs-string"><span class="hljs-string">'/'</span></span>, hello, <span class="hljs-string"><span class="hljs-string">'GET'</span></span>) }</code> </pre><br>  In the same place, we place the file view.py next to it, although the name here is no longer fundamentally except in terms of logic: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> text = <span class="hljs-string"><span class="hljs-string">'It works'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> templ(<span class="hljs-string"><span class="hljs-string">'hello'</span></span>, text=text)</code> </pre><br>  And in the same directory in the folder / templ put a template called hello.tpl. <br><pre> <code class="python hljs">{{text}}</code> </pre><br>  All go to the root of the site and see the greeting. <br><br><h4>  Summary </h4><br>  Actually the main frame is ready.  Some frameworks in general, to one degree or another, implement what we have considered in this series of lessons.  But it seems to me that it was interesting to look at one of the options as it can be implemented.  The next part will be devoted to the creation of the admin as well as the presentation of data. <br>  For now.  All success. <br><br><h4>  Used and useful materials </h4><br>  <a href="http://bottlepy.org/">Bottle</a> <br>  <a href="http://www.komtet.ru/lib/frameworks/pylons-1/beaker-1.3-sochnoe-vysokokachestvennoe-keshirovanie">Beaker and Caching</a> <br>  <a href="http://beaker.readthedocs.org/en/latest/index.html">Beaker</a> <br>  <a href="http://self.maluke.com/webdev">Introduction to the web for python</a> <br>  <a href="http://www.python.org/dev/peps/pep-0333/">Python Web Server Gateway Interface</a> </div><p>Source: <a href="https://habr.com/ru/post/148261/">https://habr.com/ru/post/148261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148252/index.html">ALEAR project robots create their own language</a></li>
<li><a href="../148253/index.html">17-year-old businessman founded four startups</a></li>
<li><a href="../148254/index.html">Are there many science fiction writers in Habr√©?</a></li>
<li><a href="../148258/index.html">Greet your old new friend</a></li>
<li><a href="../148260/index.html">The story of the mobile Internet. Paranoia or have something to think about?</a></li>
<li><a href="../148266/index.html">Corky</a></li>
<li><a href="../148268/index.html">Managing freelance projects on their own experience</a></li>
<li><a href="../148270/index.html">RoboSub 2012 reconnaissance in battle and reaching the final</a></li>
<li><a href="../148271/index.html">Problems in corporate use of SAAS</a></li>
<li><a href="../148272/index.html">Want to be a programmer - be it!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>