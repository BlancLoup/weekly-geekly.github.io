<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>High DPI values ‚Äã‚Äãin Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows, starting with Vista, provides two mechanisms for adapting applications to monitors with a high pixel density (dots per inch, DPI): enlarged s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>High DPI values ‚Äã‚Äãin Windows</h1><div class="post__text post__text-html js-mediator-article">  Windows, starting with Vista, provides two mechanisms for adapting applications to monitors with a high pixel density (dots per inch, DPI): enlarged system fonts and full-blown windows.  Unfortunately, trying to get some of your applications to work in any of the modes may be unsuccessful, thanks to a combination of negligent developers and bad decisions made by Microsoft. <br><br>  This page is designed to help users understand and correct possible problems when setting high DPI values.  Please note that we will consider only traditional Windows applications, not the Windows Store ("Metro", "Modern UI") applications.  The latter use the new WinRT API, which provides its own scaling mechanism. <br><a name="habracut"></a><br><ol><li>  <a href="https://habr.com/ru/post/248135/">From translator</a> </li><li>  <a href="https://habr.com/ru/post/248135/">Scaling methods</a> <ul><li>  <a href="https://habr.com/ru/post/248135/">Scaling in the style of Windows XP</a> </li><li>  <a href="https://habr.com/ru/post/248135/">Scaling in the style of Windows Vista or DPI virtualization</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/248135/">How to change DPI settings</a> <ul><li>  <a href="https://habr.com/ru/post/248135/">Changes in Windows 8.1, or why is everything blurry?</a> </li><li>  <a href="https://habr.com/ru/post/248135/">Help, my system fonts are not the right size!</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/248135/">Types of applications, how they are scaled (or not scaled)</a> <ul><li>  <a href="https://habr.com/ru/post/248135/">Choosing a scaling method for your applications</a> </li><li>  <a href="https://habr.com/ru/post/248135/">Refusal of DPI virtualization for individual applications</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/248135/">Further reading for developers (no translation)</a> </li></ol><br><a name="part0"></a><br><h2>  From translator <br></h2><br>  In this article, the following abbreviations that I found to translate are not advisable: Graphical User Interface (GUI), Points Per Inch (DPI), DPI-Aware applications ‚Äî applications that can display their GUI correctly, without distortion, Graphic Interface Devices (GDI).  My comments <i>(in italics)</i> . <br><a name="part1"></a><br><h2>  Scaling methods <br></h2><br>  Traditionally, native Windows desktop applications use two display mechanisms: <br><ul><li>  Graphical Device Interface (GDI) functions for accessing the display.  As a rule, GDI coordinates are measured directly in screen pixels, regardless of monitor size and pixel density. <br></li><li>  And text output using Windows system fonts.  This is not mandatory, but most applications use system fonts for most of their graphical user interface (GUI). <br></li></ul><br>  Initially, most monitors had a pixel density of about 96 dots per inch.  So the GUI using this feature looked about the same on any system.  But, as soon as the pixel density increases, the GUI elements of such applications decrease in terms of centimeters or inches <i>(real, which are measured using the ruler attached to the monitor)</i> .  Small text and other small details become harder to see. <br><br>  To fix the situation, Microsoft decided that it was a good idea to incorporate some method of scaling to Windows.  One of the two methods described below (Windows XP or Vista) is used when the user sets the DPI with a value higher than the standard 96 dpi.  Both methods try to increase the size of the image elements. <br><a name="part1_1"></a><br><h4>  Scaling in the style of Windows XP <br></h4><br>  The first of these methods, as you can guess, appeared in Windows XP.  This method, in fact, is not a scaling method for GUI applications per se.  Only system fonts and some elements of the system user interface <i>(I would call it ‚ÄúNOT scaling‚Äù in the style of Windows XP) are</i> scaled, at higher DPI settings. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All other application elements are still displayed at a 1: 1 scale.  The only difference in their appearance is that any text and some GUI elements that are displayed using system functions suddenly become larger.  For example, the text on the buttons.  This causes obvious problems that we will discuss later. <br><a name="part1_2"></a><br><h4>  Scaling in the style of Windows Vista or DPI virtualization <br></h4><br>  Windows Vista introduced the second option with a strange name, ‚Äúscaling the display‚Äù, without any clarification, apparently to finally confuse users.  We will use a more descriptive name - the DPI virtualization method.  When this method is enabled, Windows still scales in the Windows XP style.  As before, the sizes of all system fonts and some elements of the system interface increase. <br><br>  The difference is that applications that can properly use high DPI values ‚Äã‚Äãshould report this to Windows.  Such applications should set the new DPI-Aware flag, either by calling the Win32 API function ‚ÄúSetProcessDPIAware‚Äù, or, preferably, by embedding a manifest with the dpiAware flag.  But if an application does not have a DPI-Aware flag, Windows behaves differently, first it forms an internal display at a scale of 96 dpi <i>(emulating a DPI application of 96)</i> , and then scales the resulting image in accordance with the current DPI settings before output to the screen. <br><br>  This would be a fantastic method of scaling if all our monitors had a pixel density of the latest iPhones (326 dpi).  Unfortunately, this is not the case.  Application windows scaled this way look too blurry, with the popular resolution of 120 dpi (@homm is not a resolution, by the way).  Therefore, Microsoft defaults to DPI virtualization by default if you select a pixel density less than or equal to 120 DPI. <br><a name="part2"></a><br><h2>  How to change DPI settings <br></h2><br>  In Windows 7/8, open the Control Panel, then select Appearance and Personalization, then Display, and finally choose Set Font Size (DPI) (Windows 7) or Custom Size Settings ( Windows 8).  You will see the following dialog box (Windows 7, almost identical in Windows 8): <br><img src="https://habrastorage.org/files/175/f9d/f6b/175f9df6bf224e089ee8d4a89dbd048c.png"><br><img src="https://habrastorage.org/files/4ff/63e/23c/4ff63e23c5e146d2a3a7ea70ddcaf5d4.png"><br>  In the drop-down list, you can select the desired DPI setting as a percentage, where 100% corresponds to 96 DPI, 125% - as in the screenshot, corresponds to 120 dots per inch <i>(you can more accurately record the value manually)</i> .  Before Windows 8, the actual DPI value (‚Äúpixels per inch‚Äù) was displayed next to the size of the system font.  Windows 8, for unknown reasons, does not show the DPI value, so you have to calculate it yourself. <br><br>  You can also attach a ruler <i>(which has a scale in inches)</i> to the screen, and try to combine the marking on it with the marking on the screen by changing the value in the drop-down list.  The box circled in red below determines whether to use only Windows XP-style scaling, or also a new DPI virtualization method.  If the box is not checked, as in the screenshot, then DPI virtualization is enabled. <br><br>  <b>Reclamation.</b>  This dialog is an example of a user-friendly interface.  At first glance it seems that this is a checkbox to disable scaling in the style of Windows XP.  But this scaling method (which only increases the system fonts and other elements of the system's user interface ‚Äî scaling Windows XP) is always included when choosing a high DPI value.  In fact, this flag controls whether this method will be the only <i>(Use <b>only</b> scales in Windows XP style)</i> , or the DPI virtualization method will also be used for applications that do not have the DPI-Aware flag.  So this flag does not control the scaling method specified in its name, but controls another scaling method that is not mentioned anywhere - and allows you to use the new method when the box is unchecked! <br><br>  <b>Error in Windows 8.</b> In addition to this, in Windows 8 this is an error dialog box.  As a rule, everything works as in Windows 7, but the state of the flag is not saved on DPI values ‚Äã‚Äãof 150% or higher.  When you check this box, DPI virtualization is properly disabled.  However, the checkbox itself remains unchecked the next time you open this dialog. <br><a name="part2_1"></a><br><h4>  Changes in Windows 8.1, or why is everything blurry? <br></h4><br>  In Windows 8.1, the flag for scaling in the Windows XP style has disappeared, and now DPI virtualization is never used at DPI values ‚Äã‚Äãup to 120 inclusive, but is always used at higher values ‚Äã‚Äãfor those programs that do not have the DPI-Aware flag.  If some applications seem fuzzy to you, you must manually disable DPI virtualization for them. <br><br>  Windows 8.1 allows you to use multiple monitors with different DPI values.  However, this feature also makes use of DPI virtualization for traditional applications that move between monitors with different DPI values.  To avoid this, you can turn off the ‚ÄúDPI scaling‚Äù settings using the new option ‚ÄúI want to select one scale for all displays‚Äù. <br><br>  Also, Windows 8.1 adds a special switch for setting 200% and a new API, so that developers can selectively disable DPI virtualization. <br><a name="part2_2"></a><br><h4>  Help, my system fonts are not the right size! <br></h4><br>  Sometimes, after changing the DPI settings, you may notice that some system fonts have become too large or too small for new installations.  The likely reason is that you are using a custom desktop theme based on your old DPI settings.  Windows does not scale custom theme fonts. <br><br>  If you actually created a custom desktop theme and want to save it, you will have to adapt the fonts yourself to the new DPI settings.  However, Windows has the annoying habit of "helpfully" creating user themes without your knowledge, for any reason.  So, if you have never created a custom desktop theme, simply delete it and return to the standard theme. <br><br>  In Windows 7/8, open the Control Panel, select Appearance and Personalization, and then Personalize.  If you see the selected entry in the ‚ÄúMy Themes‚Äù line, this means that Windows uses the user's theme, the system fonts of which Windows will not scale.  Choose a standard theme, for example, the first entry in the Aero Themes section (Windows 7) or the Default Themes section (Windows 8) and delete unwanted entries in the My Themes section.  Now, all system fonts should be displayed correctly. <br><a name="part3"></a><br><h2>  Types of applications, how they are scaled (or not scaled) <br></h2><br>  Now let's look at what methods should be used for existing Windows applications at high DPI values.  The following table summarizes, we will look at different cases in more detail later. <br><table><tbody><tr><td></td><td>  <b>DPI-Aware flag not set</b> </td><td>  <b>DPI-Aware flag set</b> </td></tr><tr><td>  <b>Not DPI-Aware</b> </td><td>  Need to use DPI virtualization </td><td>  Need fixes from developers </td></tr><tr><td>  <b>DPI-Aware</b> </td><td>  Need to use Windows XP style scaling </td><td>  Always scaled correctly </td></tr></tbody></table><br>  <b>Applications that don‚Äôt care about DPI at all</b> are either very old or poorly written, but nevertheless still used.  One famous example is Apple's iTunes for Windows.  Here, developers use the system fonts for the GUI and, without worrying about the actual font sizes, they tightly tie the window sizes to a resolution of 96 DPI, naturally distorting the GUI, as the font sizes increase at higher DPI values. <br><br>  Such applications require a new method of scaling "DPI virtualization", unfortunately, this often makes the interface blurry.  Otherwise, you will run into problems starting from clipping text to overlapping controls, sometimes making the GUI completely unusable (fortunately, this rarely happens).  Over the years I have collected several samples of <a href="http://news.kynosarges.org/2012/07/10/fixing-windows-programming/">screenshots of incorrect</a> applications. <br><div class="spoiler">  <b class="spoiler_title">Sample application, works only when DPI is equal to 96</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/7f0/b09/83d/7f0b0983d7984bb6afc310934f146ac5.png"><br><br>  150% resolution (144 DPI) <br><br><img src="https://habrastorage.org/files/116/78a/d8f/11678ad8f833434c99f0153747e40c3e.png"><br><img src="https://habrastorage.org/files/bb5/690/b37/bb5690b37af844fbb9dcc6468fc121ef.png"><br></div></div><br>  <b>Applications that can customize their GUI to different DPI values, but do not have the DPI-Aware flag</b> - These are typical applications of the Windows XP era.  Here, developers took care to get the actual font sizes of the system before creating the GUI.  Such applications are displayed correctly when using scaling in the style of Windows XP.  Unfortunately, since they do not set the DPI-Aware flag to inform Windows of this fact, for them, by default, ‚ÄúDPI virtualization‚Äù will be used, making their GUI fuzzy.  You may not like this, so you may want to forcefully use the Windows XP scaling style for such applications. <br><div class="spoiler">  <b class="spoiler_title">An example of such an application and a resolution of 150% (144 DPI)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/7ff/033/736/7ff0337363ac492fa46ecbe26cbc5f07.png"><br><img src="https://habrastorage.org/files/038/a1d/634/038a1d6343e44b95a438470beae65265.png"><br></div></div><br>  <b>Applications that can customize their GUI to different DPI values ‚Äã‚Äãwith the DPI-Aware flag</b> - This is the newest type of application that is completely seamless, regardless of the DPI settings.  The DPI-Aware flag is set automatically for Windows Presentation Foundation (WPF) and GDI + applications, as these APIs provide built-in scaling tools.  Developers using the old GDI API and (surprisingly) Windows Forms need to manually tag their DPI-Aware applications. <br><br>  <b>Applications that are not adapted to changing the DPI, but having the DPI-Aware flag</b> is even worse than completely ignoring the DPI value.  In the examples you will find GUI applications that are well scalable up to 120 DPI, but not higher, or <a href="http://news.kynosarges.org/2013/08/09/javafx-dpi-scaling/">JavaFX</a> applications.  Here we can not do anything, because  we do not have the ability to force Windows to use DPI virtualization for such programs.  After the DPI-Aware flag is set, the application must scale itself.  We can only "cut" developers to fix their product - or use something else. <br><a name="part3_1"></a><br><h4>  Choosing a scaling method for your applications <br></h4><br>  Once you have decided that you want to use a high DPI value, your choice of scaling method depends on the applications in which you are working.  Keep in mind that to disable ‚ÄúDPI virtualization‚Äù means to check the box (check box) with the incorrect name ‚ÄúUse scales in Windows XP style‚Äù and vice versa. <br><br><ul><li>  If you are so incredibly lucky to use only those applications that are both DPI-Aware and set the desired flag, then it does not matter which scaling method you choose.  All applications will use Windows XP-style scaling, and DPI virtualization will never be used. </li><li>  If you use only well-written DPI-Aware applications, but some of them do not set the required flag, you can disable DPI virtualization.  Thus, all applications will be displayed correctly without any blurring due to scaling.  If your monitor has a very high pixel density, such that scaled bitmaps no longer look blurry, you may want to enable DPI virtualization anyway. </li><li>  If you have one or several applications that are not suitable for changing DPI and do not have a DPI-Aware flag, you must enable DPI virtualization if you are not ready to put up with a skewed GUI application.  Unfortunately, there is another problem, because Microsoft implemented this option is inconvenient.  You can enable DPI virtualization for the entire system, not for a single application, and then selectively disable it for individual applications. </li></ul><br><br>  We remind you that in Windows 8.1 there is no longer a choice in this matter.  If you are working at a resolution of 120 dpi (125%), each program will have to use Windows XP-style scaling, and if you work at a higher resolution, each program that is not DPI-Aware will use the default " DPI virtualization. <br><a name="part3_2"></a><br><h4>  Refusal of DPI virtualization for individual applications <br></h4><br>  After you decide to enable DPI virtualization or you are running Windows 8.1, with a resolution of more than 120 dpi, you can check the system for DPI-Aware applications that do not have the appropriate flag.  And return them the ability to use scaling in the style of Windows XP, for which they are intended.  There are two ways to do this, the first works only for 32-bit applications, the second is universal and is also suitable for 64-bit applications. <br><br>  <b>32-bit applications</b> - It's simple: right-click on the executable file in Windows Explorer, select the "Properties" dialog box, go to the "Compatibility" tab and check the "Disable image scaling with high screen resolution" box.  That's all, in Windows 8.1 it also works for 64-bit applications. <br><br>  <b>64-bit applications</b> - For no apparent reason, it is possible to annoy users of 64-bit applications, in Windows 8 and earlier, the above flag is disabled for 64-bit applications, although the option itself is quite functional if you make the changes directly to the registry!  So start the registry editor and go to this key: <br><br>  HKEY_CURRENT_USER \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ Layers <br><br>  Now add a string value (REG_SZ), whose name is the full path to the executable file of the application and whose value is HIGHDPIAWARE.  I recommend that you first change a few 32-bit applications, as described above, so that you can see some examples of the values ‚Äã‚Äãin this registry key. <br><br>  We looked at how you can use the DPI settings on Windows Vista and later.  And if you ever wondered what the compatibility option is for - ‚ÄúDisable image scaling at high screen resolution‚Äù.  And why it does not do anything on your system, now you know: it is effective only if you have the DPI virtualization system-wide option enabled and only for applications that do not set the DPI-Aware flag properly, but correctly use scaling in Windows XP style. <br><a name="part4"></a><br><h2>  Further reading <br></h2><br>  For more information, see the MSDN article <a href="http://msdn.microsoft.com/en-us/library/dd464660%2528v%3DVS.85%2529.aspx">Writing High-DPI Win32 Applications</a> .  <i><a href="http://msdn.microsoft.com/en-us/library/dn469266(v%3Dvs.85).aspx">DPI-Aware Desktop and Win32 Applications</a></i> .  This is a lengthy article that can be used for a screening program. <br><br>  Unfortunately, the article is currently only covers Windows XP through 7. See the Word <a href="http://download.microsoft.com/download/B/8/0/B80808F2-FC84-40D1-ABBD-D9C4CE0F0B11/Writing%2520DPI-Aware%2520Desktop%2520Applications%2520in%2520Windows%25208_1%2520Preview.docx">Preview</a> for Windows 8 and 8.1. <br><br>  Outside of Microsoft, Gast√≥n Hillar has published two articles targeting Windows 8.1 at Dr.  Dobb's.  C / C ++ sample code for the Win32 API. <br><br>  You can‚Äôt make it a lot of fun and have a lot to do. with regard to DPI scaling. <br><br>  <b>PS</b> <i><a href="https://technet.microsoft.com/en-us/library/dn528847.aspx">Link on the topic and how to see the DPI-Aware application flag.</a></i> <br>  Thanks <a href="https://habrahabr.ru/users/homm/" class="user_link">homm</a> for the help. </div><p>Source: <a href="https://habr.com/ru/post/248135/">https://habr.com/ru/post/248135/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248119/index.html">3D to D</a></li>
<li><a href="../248121/index.html">Apple has blocked developer accounts in Crimea</a></li>
<li><a href="../248129/index.html">Art Feature Engineering in Machine Learning</a></li>
<li><a href="../248131/index.html">International isolation made Cuba an island of hackers</a></li>
<li><a href="../248133/index.html">Status + new hell of trolling on the Internet</a></li>
<li><a href="../248137/index.html">Annotation to "Effective Modern C ++" by Scott Myers</a></li>
<li><a href="../248139/index.html">IO.js or old rake with new sauce</a></li>
<li><a href="../248145/index.html">SoC: we raise simple DMA on FPGA</a></li>
<li><a href="../248147/index.html">Tree - killer JSON, XML, YAML and their ilk</a></li>
<li><a href="../248149/index.html">2D lighting system for Unity3D running on a GPU</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>