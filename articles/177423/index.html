<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attempt to dispel the myths about OpenVZ, or VPS on OpenVZ vs Xen / KVM / Hyper-V / etc</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Attempt to dispel the myths about OpenVZ, or VPS on OpenVZ vs Xen / KVM / Hyper-V / etc 

 For some incomprehensible reason for me, Habrahabr has a ne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attempt to dispel the myths about OpenVZ, or VPS on OpenVZ vs Xen / KVM / Hyper-V / etc</h1><div class="post__text post__text-html js-mediator-article"><h4>  Attempt to dispel the myths about OpenVZ, or VPS on OpenVZ vs Xen / KVM / Hyper-V / etc </h4><br><br>  For some incomprehensible reason for me, Habrahabr has a negative attitude towards OpenVZ technology in general, and OpenVZ hosting in particular.  This post is an attempt to dispel the myths concerning OpenVZ hosting, Although in my opinion, OpenVZ is also perhaps the best solution for separating monogenic (Linux-only services) within the enterprise on its own servers. <br><br>  I am not an interested person, I am writing a post not on behalf of my employer, but on myself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>So, the thesis: budget Linux VPS on OpenVZ, as a rule, work faster and more stable than budget VPS using hypervisors.</b>  <b>Expensive VPS on hypervisors, in ‚Äúclouds‚Äù or with a fixed tariff plan, better than expensive VPS on OpenVZ.</b> <br><br><a name="habracut"></a><br><br>  Since the topic is published not only in the Virtualization hub, I ask you not to be offended by those who administer farms with a large number of virtual machines and nodes: I have to remind less professional readers what VPS is <br><br>  So what is a VPS, and what are they?  A VPS is a Virtual Dedicated Server, which can be conventionally considered a ‚Äúreal‚Äù dedicated server, while the VPS administrator has full (UNIX / Linux root) access to the VPS server, and can install any software compatible with the operating system chosen for the VPS, and used virtualization technology. <br>  A synonym for the term VPS is VDS.  On the "bourgeois" VPS is decrypted as a Virtual Private Server, and VDS as a Virtual Dedecated Server. <br><br>  The word VPS means, rather, not technology, but a service provided by a hosting provider.  In this technology for the implementation of services can be applied fundamentally different. <br><br>  There are two groups of technologies for the implementation of the VPS service: <br><br>  a) Virtualization <br>  b) Containers <br><br>  Virtualization creates a full-fledged virtual machine for the client, with its own kernel, the ability to use VPS based on a large number of different operating systems, while the isolation based on the current implementation of virtualization technology on hypervisors is maximum. <br><br>  The most popular hypervisors: VmWare ESXi (outside the world of the hosting leading virtualization solution), Xen, KVM, Hyper-V. <br><br>  Containers do not create, in contrast to virtualization, their own full-fledged operating system for each VPS, but create a large number of isolated environments on one core (name spaces), which allows not wasting server resources for nothing, but sending them directly to the VPS.  Also plus containers <br>  lies in the fact that memory and other resources, such as disk space, are not allocated to the guest system as a whole (for example, the size of lun given to a virtual machine as a disk cannot be reduced). <br><br>  The most popular (as well as technologically leading, and leading in the number of installations) container VPS technologies are Parallels Virtuozzo Containers and OpenVZ. <br><br>  The main disadvantages are that container-based VPS can be provided only on the same system as the host system (for OpenVZ and Virtuozzo, this is Linux, in principle, and so is the most popular OS for VPS, based on any <br>  technologies). <br><br>  In general, based on hypervisors, you can build a VPS service that is better, more stable and more powerful than renting a dedicated server: <br><br>  A powerful host system with top-end CPUs, divided by a hypervisor into a dozen or one-and-a-half parts, with external disks on a fast disk shelf with dozens of spindles, and a High Available solution restarting the VPS on a new node <br>  in case of a hardware failure of the host system, it is known that it is more stable, more productive, more scalable (you can always go to the next tariff plan, or order a new VPS, which you can deploy in minutes from the template) than, perhaps, the most expensive physical server that you can rent : large operators generally prefer to rent ‚Äúservers‚Äù, collecting them from desktop components, even without ECC memory support, and selling megahertz desktop processors, such as Corei7, to not-great-minded people, while maintaining stability  Such iron in 7/24 mode is not their problem. <br><br>  At the same time, such VPS are often naturally, as the best service, turn out to be more expensive than dedicated servers, and the cost of equipment adequately organized hosting on hypervisor technology requires very small ones, therefore services such as Amazone EC2, or, for example, VPS from Leaseweb on VmWare ESXi with disks on SAN with raid60 and are expensive: the hoster cannot sell the service below its cost. <br><br>  Unfortunately, among the users of the VPS service, the myth prevails, which we will now debunk: <br><br>  ‚ÄúVPS on Xen is better than VPS on OpenVZ / Virtuozzo‚Äù <br><br>  The question ‚Äúthe better‚Äù is usually answered that ‚Äúthe hoster on OVZ oversells, and it lies, and sells my resources, honestly purchased, by the consumer, to other customers, so everything slows down!  You can't oversell Xen! ‚Äù <br><br>  Usually, people do not understand that the hosting provider always has the opportunity to deceive a client by a hundred points, and the technology has nothing to do with it ... <br><br>  This myth is artificially warmed up by some probably not very conscientious companies that provide cheap Xen hosting. <br>  The fact is that it is impossible to get high-quality VPS on hypervisors, for the same money that VPS is selling on OpenVZ. <br><br>  During the operation of hosting servers, there is often a need, for example, to turn off the physical machine for prevention, transport to another data center, upgrade, to provide more resources to customers at new rates, <br>  since computing technology continues to evolve according to Moore's law, doubling the computing power every two years), and even if the server is unstable, it would be nice to transfer the VPS clients to the new server.  <b>More often there is a need for load balancing: on one node VPS sold too much, and on the other too little.</b>  <b>cheap Xen hosters are forced to either turn off some clients, and transport them offline to an underloaded server, or not to pay attention to customer complaints on an overloaded server</b> : maybe someone will leave and stop the rest of the VPS from stopping! <br><br>  So, in order not to shut down the service for several hours for clients, a live migration technology is needed, but it is not compatible with cheap Xen VPS, because it requires the host to invest in SAN and data network, and then it makes no sense buy cheap servers: VPS on hypervisors, or as they often say now, in the ‚Äúclouds‚Äù is a better and ‚Äúadvanced‚Äù service than a regular server, and not at all a competitor to the ‚Äúcontainer‚Äù VPS, primarily for the price. <br><br>  OpenVZ and Virtuozzo containers allow transparently for customers, online, to transfer VPS from a physical server to a physical server without costly investment in storage area network. <br><br>  As for ‚Äúoverselling,‚Äù this is a myth, since, on the contrary, the opportunity for overselling is good for the hosting client, since not a single VPS, if it works stably, is not 100% of the time near the limits of its tariff plan (otherwise the services on the VPS will be unstable and slowly, and the tariff plan was chosen incorrectly). <br><br>  When using regular, dedicated, non-virtualized servers (colocation or dedicated), most of the server resources are also idle, and the client pays for these idle cycles. <br><br>  If a hoster is not blatantly lying to you, and the physical server has enough resources, the opportunity for the end client to transfer unused resources to another VPS without degrading the quality of service to the end client is good for both the hoster and the client, since the hoster will increase its profitability and may, for example, or purchase more powerful servers, so that your nominal megahertz people would mean more, or lower prices, or increase salaries for support. <br><br>  With dozens of VPS per physical server, the likelihood that all clients will simultaneously require their resources tends to zero.  But it is often significant when the number of VPS is up to ten to fifteen per server, which is often found in Xen hosts, thus overselling the CPU for an ‚Äúhonest‚Äù hoster Xen is much more likely than overselling in memory for the OpenVZ hoster <br><br>  It can be added that, within the framework of container technology, performance is higher, as there is no overhead for launching guest cores and switching contexts: for example, you can see HP's Xen vs OpenVZ benchmark in which you can see that the difference is very, very significant: <br>  <a href="http://www.hpl.hp.com/techreports/2007/HPL-2007-59R1.pdf">www.hpl.hp.com/techreports/2007/HPL-2007-59R1.pdf</a> <br><br>  Also, Xen is often criticized about the performance of the disk subsystem, even from the developers of other hypervisors, the same KVM, and Xen-hosters are often cunning: overselling on the CPU in Xen is also possible. <br><br>  In addition, VPS on Xen, KVM, Hyper-V with local disks, without SAN, is always catastrophically slower than VPS on OpenVZ with local disks due to vzswap technology. <br>  <b>I would say that vzswap is such a Uber feature of OpenVZ VPS, which, however, is not included with all OVZ hosters.</b> <b><br></b>  A client who has bought a VPS on the hypervisor does the swap file on his computer.  When his VPS "falls" from, for example, a powerful DDoS, its applications go to the swap, neighbors in the physical server suffer from intensive I / O.  It is very hard to prevent your physical machine neighbor from creating such a file. <br>  Let me remind you, if someone does not know, or forgot, virtual memory can be represented as RAM (DDR / DIMM / SIMM memory bars on x86 / x86_64 computers) + swap (file or swap partition). <br>  In the OpenVZ technology, swaping is performed centrally by the kernel, the client is allocated virtual memory as ‚ÄúRAM‚Äù and ... virtual memory as ‚Äúswap‚Äù.  Memory vzswap is also virtual!  Only artificially slowed down, and usually is not in the physical swap, but in the physical RAM.  When a VPS starts to DDoS, and it goes into a swap from tens to hundreds of Apache processes, or hundreds of thousands of sql queries, the VPS naturally slows down, since vzswap is slow memory!  But the disk of the physical server is not used, since the kernel will only dump data that has not been used for a long time, which will drastically affect I / O performance for all VPS. <br><br>  In conclusion, I would like to remind you of the paradox of prisoners from the Theory of Games, the text from Wikipedia: <br><br><blockquote>  Two criminals, A and B, got caught at about the same time on similar crimes.  There is reason to believe that they acted in collusion, and the police, isolating them from each other, offered them the same deal: if one testifies against the other, and the latter remains silent, the first is released for helping the investigators, and the second gets the maximum time imprisonment (10 years).  If both are silent, their action takes place under a lighter article, and each of them is sentenced to 0.5 years.  If both testify against each other, they receive a minimum period (2 years each).  Each prisoner chooses to keep quiet or testify against another.  However, none of them knows exactly what the other will do.  What will happen? <br></blockquote><br><br>  Hate to overselling, and negative to the hoster‚Äôs desire to sell other customers those resources that you don‚Äôt use anyway, while according to probability theory, when you need them, you‚Äôll almost always get them, is, in my opinion, the most the worst variant of the Paradox of Prisoners game: preventing the hoster from earning more money, you interfere first of all with yourself, since the hoster is profitable, so that you earn and pay for services, and it is profitable for you, so that the hosting is profitable and it has more money on equipment, for  charge technical support, and so on. <br><br>  Here, some Xen-hosters, attacking OpenVZ, often use the basest inclinations of human nature, the desire to play selfishly in the ‚Äúparadox of prisoners‚Äù game, and also lie, slyly silent about the fact that they overclock the processor: they can have CPUs on one core several VPS that will interfere with each other. <br><br>  Summarizing, for today the best choice of a budget VPS is only OpenVZ / Virtuozzo, and the ‚Äúhypervisor‚Äù and ‚Äúcloud‚Äù VPS are already pushing the service of renting physical dedicated servers: if you need flexibility and stability of the service, and there is a budget for the project, there are such VPS think now. <br><br>  <b>UPDATE</b> Judging by the comments, and the negative that I wrote in a personal, not everyone understood that this topic is not against <i>Xen, Kvm, VmWare</i> and other hypervisors in hosting, it is the opposite for them when hosting uses SAN or at least DAS , the topic is a little bit against cheap Xen hosters, and first of all, the topic is written <i>for OpenVZ</i> </div><p>Source: <a href="https://habr.com/ru/post/177423/">https://habr.com/ru/post/177423/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../177411/index.html">The digest of news from the world of mobile development for the last week ‚Ññ10 (April 15 - 21, 2013)</a></li>
<li><a href="../177413/index.html">Applications for Sony NEX-6</a></li>
<li><a href="../177415/index.html">Peter Molyneu pushed two options for monetization in Curiosity</a></li>
<li><a href="../177419/index.html">Nokia: quarterly results</a></li>
<li><a href="../177421/index.html">Objective-C Runtime. Theory and practical application</a></li>
<li><a href="../177425/index.html">The slowest Linux machine</a></li>
<li><a href="../177427/index.html">Editing your article on Habr√© by highlighting a quote in HabrAjax; Iceweasel support</a></li>
<li><a href="../177431/index.html">Analog FreeAndNil with type checking</a></li>
<li><a href="../177433/index.html">The CIA is big tasks and big data. Towards a Global Information Cap</a></li>
<li><a href="../177435/index.html">Explorer-2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>