<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Significance of SPF</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I would like to draw your attention to an important, in my opinion, problem that even the largest and most innovative companies in the world have negl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Significance of SPF</h1><div class="post__text post__text-html js-mediator-article">  I would like to draw your attention to an important, in my opinion, problem that even the largest and most innovative companies in the world have neglected.  The problem is that most domains do not have SPF records that protect the domain from unauthorized use in email. <br>  SPF (Sender Policy Framework) is a text entry in the TXT records of the DNS domain.  The record contains information about the list of servers that have the right to send letters on behalf of this domain and the mechanism for processing letters sent from other servers. <br>  For example, the SPF record ‚Äú <i>example.com.</i>  <i>The TXT "v = spf1 + a + mx-all"</i> ‚Äùmeans that the server specified in the A and MX records of this domain can send letters on behalf of the‚Äú example.com ‚Äùdomain, and letters sent from other servers should be deleted (Fail). <br><img src="https://habrastorage.org/files/0dc/dbb/835/0dcdbb83556c4831863003891e6c7021.png"><br><a name="habracut"></a><br>  It is important to understand: <br><ol><li>  SPF record is not inherited on subdomains.  Each domain of the third (and below) levels requires its own entry. </li><li>  SPF checks only HELO and MAIL FROM fields. </li></ol><br>  All the detailed information about this technology can be found on the <a href="http://www.openspf.org/">site of the project ‚ÄúSender Policy Framework‚Äù</a> . <br><br><h2>  Why is it important? </h2><br>  Currently, all advanced anti-spam systems use 3 main types of email analysis (and variations): <br><ol><li>  Analysis of the IP address of the sending server: its reputation, the correctness of the A and PTR records. </li><li>  Analysis of SPF / DMARC domain records and DKIM digital signature. </li><li>  Content analysis: titles, subject, text, links, etc. </li></ol><br>  In order to successfully go through the anti-spam system, the spammer (or fraudster) will need: ‚Äúpure ip‚Äù, a beautiful letter and a domain without protection (examples 1 and 3).  To prevent sending emails on ‚Äúyour name‚Äù (phishing), all you have to do is add the appropriate TXT record to the domain (example # 2). <br><br><h2>  Examples </h2><br>  As an example, I sent 3 simple letters using telnet and SMTP commands.  2 emails will show the operation of the SpamAssassin spam filter (mail-tester.com service), and the last email will go through the Gmail anti-spam filter.  For the purity of the experiments, I used a ‚Äúclean‚Äù IP address (it was not so difficult to find it) and text without links and HTML. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <table><tbody><tr><td>  <b>#</b> </td><td>  <b>From</b> </td><td>  <b>To</b> </td><td>  <b>Result</b> </td><td>  <b>Sender Domain SPF</b> </td></tr><tr><td>  one </td><td>  bill.gates@microsoft.ru </td><td>  *@mail-tester.com </td><td>  Successfully.  Points in mail-tester.com: 7/10 </td><td>  - </td></tr><tr><td>  2 </td><td>  bill.gates@microsoft.com </td><td>  *@mail-tester.com </td><td>  Unsuccessfully.  Points at mail-tester.com: 2.1 / 10 </td><td>  v = spf1 include: _spf-a.microsoft.com include: _spf-b.microsoft.com include: _spf-c.microsoft.com include: _spf-ssg-a.microsoft.com include: spf-a.hotmail.com ip4: 147.243.128.24 ip4: 147.243.128.26 ip4: 147.243.1.153 ip4: 147.243.1.47 ip4: 147.243.1.48 -all </td></tr><tr><td>  3 </td><td>  bill.gates@microsoft.ru </td><td>  *@gmail.com </td><td>  Successfully </td><td>  - </td></tr></tbody></table><br>  Letter number 1: <br><img src="https://habrastorage.org/files/01a/eac/6e0/01aeac6e0819400d8ade0b6784a6a6aa.png" alt="Example number 1. Mail Tester. SPF is not set."><br>  Letter number 2: <br><img src="https://habrastorage.org/files/290/c77/2e0/290c772e0f16462cb32ec5d39d348632.png" alt="Example number 2. Mail Tester. SPF is set."><br>  Letter number 3: <br><img src="https://habrastorage.org/files/acd/917/ee1/acd917ee1f59425cb75c20994f5dff56.png" alt="Example number 3. Gmail SPF is not set."><br><br><img src="https://habrastorage.org/files/933/366/e47/933366e479df44ddb6113e1972ae50fb.png" alt="Example number 3. Gmail Letter"><br><br><img src="https://habrastorage.org/files/6a8/163/662/6a8163662e104c78b554b49367da6345.png" alt="Example number 3. Gmail Headlines"><br><br>  As can be seen from the results, a letter from the microsoft.com domain would not pass an anti-spam filter, even if it has perfectly clean content.  But the letter on behalf of the domain "microsoft.ru" was tested by both SpamAssassin and Gmail, since it is not protected. <br><br><h2>  Tips </h2><br><ol><li>  Before installing the SPF record, make sure that all servers that send emails to the Internet are taken into account.  Do not forget about the web server and other external systems, otherwise you can lose some of the letters, and thus harm yourself and your business. </li><li>  Choose the right email processing engine (Pass, Fail, SoftFail, Neutral).  If your letter is unconditionally redirected from one mail system to another, a problem may arise, since SPF only checks the last hop. </li><li>  It is recommended that you create SPF records for all second-level domains that belong to you or your company, even if you do not send letters on their behalf.  For such domains, it is desirable to use the simple entry ‚Äú <i>v = spf1 -all</i> ‚Äù, which says that no one can send emails from these domains. </li><li>  Domains of the third level can be protected using wildcard-records of the type " <i>* .example.com.</i>  <i>IN TXT "v = spf1-all</i> ". "  But pay attention to the fact that wildcard only works for non-existent subdomains.  For example, if you have a subdomain moscow.example.com with MX records, the entry ‚Äú <i>* .example.com.</i>  <i>IN TXT "v = spf1 -all"</i> "will not apply to it.  Details are described in the article on <a href="https://en.wikipedia.org/wiki/Wildcard_DNS_record">Wikipedia</a> and <a href="https://tools.ietf.org/html/rfc1034">RFC 1034</a> . <br><blockquote>  Moreover, it is not possible to record the wildcard.  It would not be possible to clarify the code. </blockquote></li><li>  SPF records are recommended to be created not only for domains, but also for mail servers that are engaged in sending emails to the Internet.  This is required to pass the HELO / EHLO Test of the receiving server.  Standard entry: ‚Äú <i>mx.example.com.</i>  <i>IN TXT "v = spf1 a -all</i> ". " </li><li>  If you have a lot of domains that are served by several primary MX servers, then I advise you to use the redirect mechanism.  For example, the main domain "example.com" has the SPF record " <i>v = spf1 + a + mx -all</i> ", then the rest of the domains (example1.com, example2.com, etc.), for ease of maintenance, you can write " <i>V = spf1 redirect = example.com</i> ". </li><li>  If you have many domains and many mail servers of the senders distributed geographically and organizationally, then you can use the ‚Äúinclude‚Äù mechanism and a separate zone ‚Äú_spf.example.com‚Äù.  As an example, you can see the entry for the domain gmail.com - ‚Äú <i>v = spf1 redirect = _spf.google.com</i> ‚Äù. </li><li>  In addition to protecting your domains, it is recommended to protect your mail system and users by turning on SPF / DKIM / DMARC checking of records on your external mail servers.  This will be a good addition even for such powerful software and hardware systems such as Cisco IronPort. </li><li>  As soon as you fully understand SPF, I advise you to study the issue of signing your emails using DKIM technology and DMARC policy, this will significantly increase the reputation of your outgoing emails. </li></ol><br><br>  Comrades IT professionals, do not substitute yourself and your company - set SPF records for all your domains and MX servers. <br><br><h2>  Useful services </h2><br>  <a href="http://www.kitterman.com/spf/validate.html">SPF Recording Testing</a> <br>  <a href="http://www.mail-tester.com/">SpamAssassin anti-spam analysis</a> <br>  <a href="http://mxtoolbox.com/">Many useful tests (MX, SPF, Blacklist, DKIM Lookup, etc.)</a> <br>  <a href="http://www.senderbase.org/">Checking the reputation of mail servers and domains</a> <br>  <a href="https://senderscore.org/">Checking the domain and sending servers (here you will see who is sending letters on behalf of your domain)</a> <br>  <a href="https://www.microsoft.com/mscorp/safety/content/technologies/senderid/wizard/">MS Sender ID Framework SPF Record Wizard</a> </div><p>Source: <a href="https://habr.com/ru/post/270159/">https://habr.com/ru/post/270159/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270147/index.html">PHP html generation</a></li>
<li><a href="../270149/index.html">Microsoft raises prices for its software in the Russian Federation</a></li>
<li><a href="../270151/index.html">Top 10 articles on user eXperience for beginners to understand in an hour what it is</a></li>
<li><a href="../270153/index.html">XVB - Virtual PBX: Customization</a></li>
<li><a href="../270155/index.html">We write the simplest plugin for ReSharper</a></li>
<li><a href="../270161/index.html">Plugin for gulp - collect files in pieces</a></li>
<li><a href="../270163/index.html">As we for the first time in Ukraine held a security event on a grand scale</a></li>
<li><a href="../270165/index.html">Isolate the demons with systemd or ‚Äúyou don't need a docker for this!‚Äù</a></li>
<li><a href="../270167/index.html">Overview of the first elastic data warehouse Snowflake Elastic Data Warehouse</a></li>
<li><a href="../270169/index.html">Data ONTAP 8.3 ADP: FlashPool StoragePools</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>