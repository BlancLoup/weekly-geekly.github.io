<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wi-Fi Controller Access Points on Mikrotik</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 The latest version of the operating system Mikrotik RouterOS, numbered 6.11, added an experimental feature that allows using a router o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wi-Fi Controller Access Points on Mikrotik</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  The latest version of the operating system Mikrotik RouterOS, numbered 6.11, added an experimental feature that allows using a router on this platform as a Wi-Fi access point controller.  Unfortunately, since this functionality has just appeared and is in beta status, information about it is limited to a rather boring article in the Mikrotik Wiki-Directory.  I could not find the step-by-step instructions on how to set up, therefore, it was decided to try to adjust everything by the method of scientific typing.  In this post, I consider a simple controller setup (without going into the wilds of settings, of which there are many) providing the following configuration (in fact, similar to the one that would be configured on a simple DHO-Link DIR-620 SOHO router with native firmware, and used at home): <br><br><ul><li>  Two Wi-Fi routers Mikrotik RouterBoard <br><ul><li>  Routerboard RB951G-2HnD - the main, is a Wi-Fi controller, access point, router, DHCP-and DNS-server.  Next, I will call it a controller </li><li>  Routerboard RB951Ui-2HnD - optional, is only a Wi-Fi access point and a switch to 3 ports (POE in and out ports are not included in the switch and reserved for the future).  Further I will call it an access point or a point. </li></ul></li><li>  WPA / WPA2-PSK authentication with AES encryption </li><li>  Strictly defined channel, with a width of 20 MHz </li><li>  Single SSID, not hidden </li><li>  Clients are not isolated from each other and the wired network (really, why is it at home?) </li></ul><br>  Interested, I suggest to continue reading under a cat.  <b>Attention, traffic!</b> <br><a name="habracut"></a><br><h4>  Disclaimer </h4><br>  So, we realized the fear and risk associated with the use of technologies that are at the testing stage, we understand that only you will be responsible for repeating the actions described in this article.  It is also worth noting that this functionality is not yet compatible with: <br><ul><li>  Nstreme AP support </li><li>  Nv2 AP support </li></ul><br>  That is, only 802.11 works. <br><br><h4>  Training </h4><br>  According to the information from the Wiki, the operation of this system does not require Wi-Fi on the router, in which case the device can perform the functions of a controller. <br>  First of all, you need to update the system on our routers to version 6.11.  You can download the firmware file from the official Mikrotik website, then drag it into the Winbox window, and then restart the router;  or go to the System -&gt; Packages section, click the Check For Updates button and click Check For Updates again in the window that appears, and then Download &amp; Upgrade. <br>  Further, in the download section of the official Mikrotik website, you need to download the Wireless CAPsMAN package file (it is located in the same place as the firmware for your platform), then install it in the same way as the RouterOS update, i.e.  we drag on Winbox'a window and we reboot. <br>  After the reboot, go to the Packages section to make sure that the package is correctly installed and activated. <br><img src="https://habrastorage.org/getpro/habr/post_images/bd4/364/bb2/bd4364bb25168a829b000857a8122932.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Notice that the wireless-fp package has appeared, and the wireless package has become inactive.  In addition, a new item appeared CAPsMAN in the main menu and the CAP button in the Wireless section. <br><br><h4>  Controller Configuration </h4><br>  The steps described in this section need only be performed on the controller. <br>  Go to the CAPsMAN section in the main menu. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/607/219/a0b/607219a0b39e32d94ea1af651b74744d.png"><br><br>  The first Interfaces tab will contain pseudo-interfaces that appear when connecting access points to the controller for each connection over one pseudo-interface.  If you go into any pseudo-interface, you can see the settings that are applied to it. <br><br>  In principle, you can manually create an interface for an access point, for example, if you need to select a specific point with some special settings. <br><br>  To enable the controller mode, click the ‚ÄúManager‚Äù button, set the Enabled checkbox and click OK. <br>  Go to the Configurations tab.  This is where configurations are created that will be deployed at our access points in the future. <br><br><h5>  Create a new configuration </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/fa9/ffe/630/fa9ffe63099dac6db7c24b71bb1434dd.png"><br><br>  Set the configuration name, SSID, only one mode is available, but just in case, I decided not to leave this value empty, although everything works with an empty one too.  We also indicate that all available antennas for reception and transmission should be used (there are two of them on my routers, but the third tick, although set, will not affect anything). <br><br><h5>  Next, we define the channel settings </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/c98/e8f/f60/c98e8ff609d54a2519344a82ed56fd7c.png"><br><br>  Note that any settings can be made both directly in the configuration and you can create a ‚ÄúChannel‚Äù object on the corresponding CAPsMAN tab, and then select it from the list.  This can be convenient when there are complex configurations with a combination of different parameters for several access points.  We indicate the frequency (unfortunately, there is no drop-down list, so you have to specify the value manually), the channel width for some reason only takes 20 MHz (in the field description in the console it is written that it can be a decimal number from 0 to 4294967.295, therefore put 20 / 40 is impossible, and if you specify values ‚Äã‚Äãgreater than 20, an error appears that the access point does not support this frequency).  If the channel width is not specified, then 20 MHz will be accepted by default.  Next, select the broadcast format 2ghz-b / g / n.  The next field, according to its meaning, should give the opportunity to expand the channel to 20/40, but for some reason, regardless of the chosen value, this does not happen.  Just in case, I choose Ce (in previous versions above). <br><br><h5>  The next section allows you to specify network settings. </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/9f1/f34/b9d/9f1f34b9d764af4ca78e8262ea425ae5.png"><br><br>  As in the case of the channel, you can arrange this section of the configuration through a separate object. <br>  The tick local-forwarding allows you to transfer traffic control to access points.  In this case, clients hit a certain subnet (by adding a wlan interface to a certain bridge), routing, etc.  will be carried out in the usual way, i.e.  through the wireless network interface.  Removing this checkmark transfers control to the controller; accordingly, all other settings on this tab are valid only when the checkmark is unchecked. <br><br><h5>  Security Section </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/ab2/737/3b2/ab27373b256b863413db5c03fe8bf7ef.png"><br><br>  Contains, in principle, the usual settings that do not need commenting.  The only thing I want to mention is the lack of WEP authentication.  Here you can also make settings in a separate ‚ÄúSecurity‚Äù object, and then specify it in the corresponding field. <br><br><h5>  Deployment </h5><br>  After we finish editing the configuration, save it.  We will need it in the next stage. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2b/089/a59/c2b089a59be5a9b4f84fc3f3e28714eb.png"><br><br>  On the Provisioning tab, we create a new deployment.  Specify the type of configuration. <br>  Let's create a Provisioning object in this section. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/06c/865/44b/06c86544b476671b97d75f26be578546.png"><br><br>  The ‚ÄúRadio Mac‚Äù field allows you to define a specific access point to which this deployment will be applied, by default - to all.  Action needs to be specified? Create dynamic enabled ?, other options are necessary for static interfaces.  We indicate the newly created configuration as the main one. <br><br><h4>  Configure access points </h4><br>  Everything is much simpler here.  Settings are performed on routers equipped with Wi-Fi modules.  Go to the section Wireless. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/569/502/b19/569502b191f3500e996d9edb24467b59.png"><br><br>  Press the CAP button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/431/144/bbe/431144bbe59bf5e6a700cb00a558a5be.png"><br><br>  Check Enabled, specify the wireless interface, in case the access point and controller are one device, add your IP in the CAPsMAN addresses field. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/578/b88/5fc/578b885fc268333bcb5cc534f5cacc48.png"><br><br>  If the access point and the controller are different devices, then you can leave out the CAPsMAN addresses, instead specify Discovery Interfaces. <br><br>  The Bridge field can be filled in - specify the bridge in which the local network is located; in this case, when a connection to the controller is established, the interface will be automatically added to the bridge, or you may not specify it, then you will have to assign it in the Bridge menu item. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d8e/c57/cde/d8ec57cde57c7569e320af9f5ca3f5fd.png"><br><br>  After clicking the OK button.  The interface will have a red comment indicating that it is controlled by the controller. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/260/014/a83/260014a830dfb0139b49ded61607a9f8.png"><br><br>  After the connection with the controller is established and the settings are received from it, a second line of comments will appear with an indication of the network parameters. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/64a/653/57c/64a65357c6b69cf07282587d8455a5c3.png"><br><br>  And in the Interfaces tab of the menu item CAPsMAN, pseudo-interfaces will appear corresponding to these connections. <br>  After editing the controller settings, you can force the update to the access points in the Remote CAP and Radio sections (depending on what settings have been changed), by selecting the desired point and clicking on the Provision button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8a/220/6d4/e8a2206d443351f60244b5d985c0eacb.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c8d/b79/dd5/c8db79dd5ebdc1f58358259d3129ccd2.png"><br><br>  Connected clients by interfaces can be seen in the Registration Table: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/668/bca/bc6/668bcabc628d1cb75bbc64e866607fde.png"><br><br><h4>  Conclusion </h4><br>  Since the CAPsMAN and CAP functionality has just appeared in the public domain and is still in beta testing status, I assume that the interface, settings, and features may well change in the near future.  But fundamental changes are unlikely to occur, so I hope that the post will not lose relevance. <br><br>  When writing this post, <a href="http://wiki.mikrotik.com/wiki/Manual:CAPsMAN">an article</a> from the official Wiki Mikrotik was used. <br><br>  <b>UPD:</b> re-read the wiki, found an error in the post regarding the datapath tab, made corrections to the article. </div><p>Source: <a href="https://habr.com/ru/post/217657/">https://habr.com/ru/post/217657/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../217647/index.html">while (true) {Apple sues Samsung for $ 2 billion}</a></li>
<li><a href="../217649/index.html">Transferring tabular data from stored procedure</a></li>
<li><a href="../217651/index.html">How to move from the Objectives of the technical support unit to indicators that are understandable to employees</a></li>
<li><a href="../217653/index.html">Moai SDK 1.5 - cross-platform 2D game engine</a></li>
<li><a href="../217655/index.html">Making ‚Äúlife‚Äù in Linux easier or automating process startup using cron</a></li>
<li><a href="../217659/index.html">Forecast for the number of likes in the post. SNA Hackathon 2014</a></li>
<li><a href="../217661/index.html">Science fiction technology: Warp (Star Trek)</a></li>
<li><a href="../217663/index.html">How I tried to crack Bitcoin</a></li>
<li><a href="../217665/index.html">National payment system and horse ass width</a></li>
<li><a href="../217667/index.html">Principles of successful IDM implementation. Business Cases</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>