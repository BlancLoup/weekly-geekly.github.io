<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Multi-window mode: additional competitive advantage for Android applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anyone who has worked in multi-window mode on an Android device can confirm that this is very convenient in certain situations. A simple example: read...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Multi-window mode: additional competitive advantage for Android applications</h1><div class="post__text post__text-html js-mediator-article">  Anyone who has worked in multi-window mode on an Android device can confirm that this is very convenient in certain situations.  A simple example: reading an e-book with the same electronic dictionary.  Especially - on a smartphone or tablet with a fairly large screen. <br>  If the user has to choose between two applications that are similar in almost everything, but differing in support for simultaneous work with several windows, it is not surprising that he will choose what this support provides. <br><br> <a href="http://habrahabr.ru/company/intel/blog/263301/"><img src="https://habrastorage.org/files/660/d52/714/660d52714cd141b8b68ac06f30bb0a1f.jpg"></a> <br><br>  From the article you will learn about multi-window mode in Android, and how to use this feature when building your own applications. <br><a name="habracut"></a><br><h2>  <font color="#0071c5">Overview</font> </h2><br>  Simultaneous work with multiple windows in Android is an interesting feature that can distinguish your application from many others and give it an additional competitive advantage.  Many OEM and ODM manufacturers, such as Samsung, Ramos and Huawei, are refining the basic Android system.  In particular, they are implementing support for multi-window mode.  They do this in order to increase the attractiveness of their smartphones and tablets, to distinguish them from the bulk of devices that do not support this function. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b88/a01/c31/b88a01c3172f1f0d5cf6d46a6225dc6a.png"></div><br>  <font color="#999999"><i>Multiple Mode Scenarios</i></font> <br><br><h2>  <font color="#0071c5">Preliminary Information</font> </h2><br>  In June 2012, <b><a href="http://www.onskreen.com/cornerstone/">Cornerstone</a></b> was introduced, the first open source platform for multitasking on Android.  In August 2012, Samsung released the first device that supports multi-window operation.  Starting from 2013 and up to now, you can observe the explosive growth of solutions to support simultaneous work with several windows in Android. <br><br>  In May 2015, the Android M Developer Preview came out (today, in July, Preview 2 is already available).  The official release of Android M (6.0) is expected in the fall of 2015.  In addition to other innovations, Android M Preview 2 is notable for the fact that it supports multi-window mode. <br><br><img src="https://habrastorage.org/files/076/747/21f/07674721f5504e5a8b29ad95856e27c6.jpg"><br>  <font color="#999999"><i>The development of solutions to support multitasking in Android</i></font> <br><br>  There are two approaches to working with multiple windows: the use of floating (floating) and fixed (docked) windows.  Among the main features of work in multi-window modes are the opening and closing of windows (open / close), changing their size (resize) and relative positioning (swap).  Opening or closing the window, we, respectively, turn on or off the multi-window mode.  The resize feature provides for customizing window sizes.  Changing the location of windows is an action that allows you to swap them. <br><br><img src="https://habrastorage.org/files/da6/188/4c6/da61884c63a64e4c81d0d8bc473fb015.jpg"><br>  <font color="#999999"><i>Multiple window modes</i></font> <br><br>  In 2013, a number of solutions designed to work with multiple windows appeared on the market.  They were developed by OEM and ODM, independent software vendors, and the open source community.  In the table below you can find a comparison of various technologies of organizing multi-window work in the Android environment. <br><table><tbody><tr><td>  Product </td><td>  <b>Cornerstone</b> </td><td>  <b>Standout</b> </td><td>  <b>Xposed</b> </td><td>  <b>Tieto</b> </td></tr><tr><td>  Description <br></td><td>  Framework for multitasking in the Android OS <br></td><td>  An open source library that can be used to create applications with floating windows. <br></td><td>  Multi-window application that supports docked windows <br></td><td>  The project aims to create a working environment that resembles desktop work. <br></td></tr><tr><td>  Support for opening, closing windows, resizing, expanding to full screen <br></td><td>  Yes <br></td><td>  Yes <br></td><td>  Yes <br></td><td>  Yes <br></td></tr><tr><td>  Window style <br></td><td>  Fixed <br></td><td>  Floating <br></td><td>  Fixed <br></td><td>  Fixed and floating <br></td></tr><tr><td>  Code modification <br></td><td>  At the level of the Android platform <br></td><td>  At the application level <br></td><td>  At the level of the Android platform <br></td><td>  At the level of the Android platform <br></td></tr><tr><td>  Application support <br></td><td>  All applications are supported, however, the dynamic configuration of SurfaceView is not available. <br></td><td>  Some helper applications.  For example - a calculator. <br></td><td>  Compatibility and stability of the solution needs to be improved. <br></td><td>  Supports all applications. <br></td></tr><tr><td>  Android version <br></td><td>  Android 4.1.  - Android 4.4. <br></td><td>  Android 4.1.  - Android 4.4. <br></td><td>  Android 4.4. <br></td><td>  Android 4.4 <br></td></tr><tr><td>  Official site <br></td><td>  <a href="http://www.onskreen.com/">Cry</a> <br></td><td>  <a href="http://forum.xda-developers.com/showthread.php%3Ft%3D1688531">Cry</a> <br></td><td>  <a href="http://forum.xda-developers.com/xposed">Cry</a> <br></td><td>  <a href="https://github.com/tieto/multiwindow_for_android">Cry</a> <br></td></tr></tbody></table><br><h2>  <font color="#0071c5">Software architecture</font> </h2><br>  The code of the Android platform can be modified in order to equip it with support for additional features.  The architecture of the Android OS consists of several levels. <br><br>  In the case of Android 4.2 and Android 4.3., The shell (launcher) and other applications are placed on the same stack at the start, called the ‚Äúmain stack‚Äù.  As you know, multi-window mode requires more stacks to accommodate several windows.  As a result, you need to modify the system class ActivityManagerService, adding to it an interface for creating a stack and managing it.  To modify the class platform WIndowManagerService, which allows you to manage the graphical representations of applications, you need to change the InputManager.  This is needed so that it can redirect touch events to the appropriate windows. <br><br>  With the release of Android 4.4 and Android 5.0, the approach to managing the stack has changed significantly.  The shell and other applications can run in different stacks.  The system has added support for multiple stacks and the ability to manage them.  The figure below shows the differences in working with the stack in different versions of Android. <br><br><img src="https://habrastorage.org/files/616/8f2/5c9/6168f25c93084627855f09dfaf7af06a.jpg"><br>  <font color="#999999"><i>Comparison of work with the stack in Android 4.3 and Android 4.4</i></font> <br><br>  Now focus on Android 5 (Lollipop).  The Android OS uses callback mechanisms to perform the interface functions of the Activity.  However, the control function is implemented at the platform level.  Therefore, we now consider two important classes: ActivityManagerService and WindowManagerService. <br><br><img src="https://habrastorage.org/files/38c/850/d54/38c850d5470e47d38663061a651232c4.jpg"><br>  <font color="#999999"><i>Lollipop platform software structure</i></font> <br><br><h2>  <font color="#0071c5">Manage Activity in Lollipop</font> </h2><br>  Since the ability to work in a multi-window mode depends on the stack, below is shown how you can create a stack and how you can start an Activity in this stack.  In Lollipop, the following functions have been added to the IactivityManager.java interface: <br><table><tbody><tr><td>  New interface features IactivityManager.java </td><td>  Description </td></tr><tr><td>  public void moveTaskToStack (int taskId, int stackId, boolean toTop) </td><td>  Move a task to another stack </td></tr><tr><td>  public void resizeStack (int stackBoxId, Rect bounds) <br></td><td>  Change stack size <br></td></tr><tr><td>  public void setFocusedStack (int stackId) <br></td><td>  Set focus on selected task <br></td></tr><tr><td>  Public Boolean isInHomeStack (int taskId) <br></td><td>  Find out if the task is in HomeStack <br></td></tr></tbody></table><br>  After starting, the SystemServer process calls the activity management services (activity manager services) and windows management services.  In order to observe this process, we can add the Runtime exception exception (RuntimeException) command to the appropriate places. <br><br><img src="https://habrastorage.org/files/30c/9a3/7eb/30c9a37eb0f94b3385ccb0299c008001.jpg"><br>  <font color="#999999"><i>The process of creating a stack in Lollipop</i></font> <br><br>  Now let's see how to start the Activity in the stack: <br><br><img src="https://habrastorage.org/files/c3e/739/e63/c3e739e6396e4b0292ddd657e5a67628.jpg"><br>  <font color="#999999"><i>Running an Activity on the Stack</i></font> <br><br>  The following commands have been added to Lollipop to the ADB utility (Android Debug Bridge, Android debugging bridge): <br><table><tbody><tr><td>  ADB Team <br></td><td>  Function <br></td><td>  Description <br></td></tr><tr><td>  Adb shell stack stack <br></td><td>  Launches a new Activity on &lt;DISPLAY_ID&gt; using an Intent <br></td><td>  In Kitkat 4.4, ADB commands contain: adb shell am stack create <br>  In Lollipop 5.0: adb shell stack <br></td></tr><tr><td>  Adb shell stack stack movetask <br></td><td>  Move &lt;TASK_ID&gt; from the current stack up or down the stack &lt;STACK_ID&gt; <br></td><td>  Usage: adb shell am stack movetask task_id stackid true / false <br>  Note: it works in Kitkat, but not in Lollipop <br></td></tr><tr><td>  Adb shell stack stack resize <br></td><td>  Resizes the stack size &lt;STACK_ID&gt; and its position to &lt;LEFT, TOP, RIGHT, BOTTOM&gt; <br></td><td>  Usage: adb shell stack stack resize task_id weight <br></td></tr></tbody></table><br><h2>  <font color="#0071c5">Office windows in Lollipop</font> </h2><br>  WindowManagerService is the central part of the window management system.  Its functionality includes dispatching input events, managing the location of objects on the screen, and surfaces on which graphical elements are displayed. <br><br><img src="https://habrastorage.org/files/43d/dd7/952/43ddd7952b8847679b1374abfdd5be41.jpg"><br><br><img src="https://habrastorage.org/files/096/512/1ef/0965121ef63e46caab14f7be351ca632.jpg"><br>  <i><font color="#999999">The role of WindowsManagerService in the</font> <a href="http://himmele.googlecode.com/svn/trunk/Google%2520Android/Android%2520Graphics%2520Architecture.pdf">Android graphical architecture</a></i> <br><br><h2>  <font color="#0071c5">Multi-Mode Problems</font> </h2><br>  When working in multi-window mode, resizing windows is available.  There are examples when the size of the window that displays the game animation cannot be changed.  The main reason for this is that the Android SurfaceFlinger subsystem cannot dynamically change the size of the displayed image. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9a4/2ef/80f/9a42ef80fcfa34f7ad7840a32c4c6a3d.png"></div><br>  <font color="#999999"><i>Games using SurfaceFlinger cannot dynamically resize a window</i></font> <br><br>  Another problem is that some applications in multi-window mode are displayed incorrectly.  In the figure below you can see that the calculator is not displayed correctly in multi-window mode.  It's all about the layout of the application, which is not designed for such conditions of use. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7c6/458/d72/7c6458d723d2266f2d0a2eb5c91691d6.png"></div><br>  <font color="#999999"><i>Calculator with a layout that is not designed to work in multi-window mode</i></font> <br><br><h2>  <font color="#0071c5">Multi-window support in Android M</font> </h2><br>  Android M Developer Preview 2 can be run on Nexus 5, 6, 9 and Nexus Player.  If you don‚Äôt have such a device, or you don‚Äôt want to install an OS that is in the Preview status, you can get acquainted with Android M using an emulator in Android Studio.  In particular, we are now interested in standard tools for working in a multi-window mode. <br><br>  In order to see this mode in action, it is enough to create a new virtual device using the AVD Manager tool, while selecting one of those available with the Level API MNC as the system image.  In our case, it was the x86_64 image.  Next, you need to start the emulator, go to the settings section For the developer and enable the Multi-window mode option there.  If this option cannot be found, take a look at this <a href="http://www.ibtimes.co.uk/how-enable-multi-window-mode-android-m-developer-preview-nexus-5-nexus-6-nexus-9-1503625">manual.</a> <br><br>  Now the fun part.  For starters, you can run several applications, everything will be as usual.  But if you click on the button to call the list of recently opened applications, a new icon will appear in the window thumbnails headers.  By default, this is a frame indicating that the application is running in full screen mode.  If you click on this icon, the window layout selection menu appears. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a8e/b0c/918/a8eb0c918b0741a941de235b20e1543e.png"></div><br>  <font color="#999999"><i>The menu for choosing the layout of windows in multi-window mode</i></font> <br><br>  Then everything is quite clear.  Select the desired layout and enjoy the multi-window mode: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5e5/699/c80/5e5699c8037376cb697c64f54785e17d.png"></div><br>  <font color="#999999"><i>Multi-mode in Android M</i></font> <br><br>  It is still unknown whether work with several windows will be available in the official release of Android M.  However, for example, the system calculator in this mode feels good.  As a result, we have serious reasons to believe that the day is not far off when adapting applications for a multi-window mode from competitive advantage will become a vital necessity. <br><br>  If you want to equip your applications designed for earlier versions of Android, support for multiple windows, it's time to turn to third-party solutions, which were discussed above.  For example, to Cornerstone. <br><br><h2>  <font color="#0071c5">Example: Cornerstone</font> </h2><br>  The company Onskreen created Cornerstone - the first framework that allows you to work with multiple windows on Android.  It is designed for devices with large screens and tablets.  Source code can be downloaded on <a href="https://github.com/Onskreen/cornerstone">Github</a> .  It supports work with Android versions 4.1 and 4.2.  For later versions of this OS, Cornerstone has not yet been released.  However, you can analyze the source code for Android 4.2 in order to learn the technical details of the system. <br><br><img src="https://habrastorage.org/files/eb5/7b9/949/eb57b99496254d8e8479c3b0ab6499fa.jpg"><br>  <font color="#999999"><i>Cornerstone modifications in Android Jelly Bean</i></font> <br><br><h2>  <font color="#0071c5">Results</font> </h2><br>  Many mobile devices running Android OS use Intel¬Æ processors.  How can developers improve the user experience of working with their applications?  How to make applications more competitive?  These questions lead us to continually improving products on devices with Intel Architecture (IA).  Multi-window support is a good example of a useful feature that provides applications with competitive advantages.  This convenient, multi-window mode allows the user to perform several tasks simultaneously.  For example - to watch videos and write to friends about what they are watching.  For example - to play the game and read its reviews.  Today, work in multi-mode support multiple devices.  For example, these are the Ramos i12, Teclast x98 and Cube i7 tablets, which run under Remix OS. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa0/122/11e/aa012211e0f1ccdd512451ad0b3783d6.png"></div><br>  <font color="#999999"><i>Multi-window mode on IA devices</i></font> <br><br><h2>  <font color="#0071c5">For home reading</font> </h2><br>  ¬ª <a href="http://www.customizeblogging.com/2015/04/android-6-0-muffin-concept-video-shows-multi-windows-quick-reply-feats.html">Android 6.0 Muffin Concept Video Shows Multi-Windows, Quick Reply Feats</a> <br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/263301/">https://habr.com/ru/post/263301/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263285/index.html">VPS (KVM) in the Netherlands - E3-1230 (2 Cores) / 3.5GB DDR3 / 120GB SSD / 1Gbps 25TB until the end of the summer is completely FREE</a></li>
<li><a href="../263291/index.html">Automatic number image rotation for LPR systems</a></li>
<li><a href="../263293/index.html">Translation of the book "Kingpin". Chapter 34. DarkMarket</a></li>
<li><a href="../263295/index.html">How the transition to the cloud changes the role of the internal IT service</a></li>
<li><a href="../263297/index.html">Online stores deliver correctly using DaData.ru</a></li>
<li><a href="../263303/index.html">How to designer to prepare the transfer of Android applications to the developer</a></li>
<li><a href="../263305/index.html">NSA has posted on GitHub utility to ensure network security</a></li>
<li><a href="../263307/index.html">Genome search with Wolfram Language (Mathematica) and HadoopLink</a></li>
<li><a href="../263313/index.html">Introduction to the analysis of social networks on the example of VK API</a></li>
<li><a href="../263319/index.html">Turning off the strip above the tabs and dragging a new assembly for the tab bar Vivaldi 1.0.231.3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>