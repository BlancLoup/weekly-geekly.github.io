<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Nutanix Big Update: NutanixOS 4.6</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While some " market leaders " suddenly "invent hyperconvergence," Nutanix has been selling and selling on the market for five years. And a couple of w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Nutanix Big Update: NutanixOS 4.6</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/439/a37/c67/439a37c677774ac6b5021b882bedd28b.jpg"><br><br>  While some " <i>market leaders</i> " <i>suddenly</i> "invent hyperconvergence," Nutanix has been selling and selling on the market for five years.  And a couple of weeks ago, Nutanix was rolling out a large and important update pulling on a major release, but since we have an even bigger and more important update ahead, we were modest, and this is version 4.6. <br><a name="habracut"></a><br>  First of all, it is necessary to tell about a sharp and significant increase in productivity at times.  No, they didn‚Äôt ‚Äúremove the forgotten debug sleep 10 in the code‚Äù, you don‚Äôt need dirt;) The developers named the following reasons for such an impressive increase: <br><br><ul><li>  Reducing the number of dynamic memory allocations </li><li>  Reduced locking overhead </li><li>  Reduced overhead on context switching </li><li>  Using new language features and C ++ v11 compiler optimizations </li><li>  More granular cheksum calculation </li><li>  Faster I / O categorization for further optimization </li><li>  Improved metadata caching </li><li>  Improved write caching algorithms. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And the results, so as not to be unfounded, are such.  This is our test system NX-3460-G4, in a top configuration, for 4 nodes.  2x E5-2680v3b 512GB DDR4 RAM per node, 2x SSD 1.2TB, 4x SATA 2TB per node, only 4 nodes, our test data for the entire cluster, total for all four nodes, for IOPS results are divided by four. <br>  Conclusion - the result of our embedded test.  On each node, VM is deployed in a CentOS configuration, 1x vCPU 1GB RAM, 7 vDisk, and six of them are being chased by fio in sequential read and write in large blocks (1MB), random read and write in small blocks (4K). <br>  Results: <br><br><div class="spoiler">  <b class="spoiler_title">Update results from 4.5.1.2 to 4.6</b> <div class="spoiler_text">  <u>It was (AHV NOS 4.5.1.2):</u> <br><br>  Waiting for the hot cache to flush ............  done. <br>  2016-02-24_05-36-02: Running test "Sequential write bandwidth" ... <br>  1653 MBps, latency (msec): min = 9, max = 1667, median = 268 <br>  Average CPU: 10.1.16.212: 36% 10.1.16.209: 48% 10.1.16.211: 38% 10.1.16.210: 39% <br>  Duration fio_seq_write: 33 secs <br>  ************************************************** ****************************** <br>  Waiting for the hot cache to flush .......  done. <br>  2016-02-24_05-37-15: Running test "Sequential read bandwidth" ... <br>  3954 MBps, latency (msec): min = 0, max = 474, median = 115 <br>  Average CPU: 10.1.16.212: 35% 10.1.16.209: 39% 10.1.16.211: 30% 10.1.16.210: 31% <br>  Duration fio_seq_read: 15 secs <br>  ************************************************** ****************************** <br>  Waiting for the hot flush ....... done. <br>  2016-02-24_05-38-22: Running test "Random read IOPS" ... <br>  <b>115703 IOPS</b> , latency (msec): min = 0, max = 456, median = 4 <br>  Average CPU: 10.1.16.212: 73% 10.1.16.209: 75% 10.1.16.211: 74% 10.1.16.210: 73% <br>  Duration fio_rand_read: 102 secs <br>  ************************************************** ****************************** <br>  Waiting for the hot cache to flush .......  done. <br>  2016-02-24_05-40-44: Running test "Random write IOPS" ... <br>  <b>113106 IOPS</b> , latency (msec): min = 0, max = 3, median = 2 <br>  Average CPU: 10.1.16.212: 64% 10.1.16.209: 65% 10.1.16.211: 65% 10.1.16.210: 63% <br>  Duration fio_rand_write: 102 secs <br>  ************************************************** ****************************** <br><br>  <u>It became after the update (AHV NOS 4.6):</u> <br><br>  Waiting for the hot cache to flush ............  done. <br>  2016-03-11_03-50-03: Running test "Sequential write bandwidth" ... <br>  1634 MBps, latency (msec): min = 11, max = 1270, median = 281 <br>  Average CPU: 10.1.16.212: 39% 10.1.16.209: 46% 10.1.16.211: 42% 10.1.16.210: 47% <br>  Duration fio_seq_write: 33 secs <br>  ************************************************** ****************************** <br>  Waiting for the hot flush ....... done. <br>  2016-03-11_03-51-13: Running test "Sequential read bandwidth" ... <br>  3754 MBps, latency (msec): min = 0, max = 496, median = 124 <br>  Average CPU: 10.1.16.212: 22% 10.1.16.209: 37% 10.1.16.211: 23% 10.1.16.210: 28% <br>  Duration fio_seq_read: 15 secs <br>  ************************************************** ****************************** <br>  Waiting for the hot cache to flush ............ done. <br>  2016-03-11_03-52-24: Running test "Random read IOPS" ... <br>  <b>218362 IOPS</b> , latency (msec): min = 0, max = 34, median = 2 <br>  Average CPU: 10.1.16.212: 80% 10.1.16.209: 91% 10.1.16.211: 80% 10.1.16.210: 82% <br>  Duration fio_rand_read: 102 secs <br>  ************************************************** ****************************** <br>  Waiting for the hot flush ....... done. <br>  2016-03-11_03-54-43: Running test "Random write IOPS" ... <br>  <b>156843 IOPS</b> , latency (msec): min = 0, max = 303, median = 2 <br>  Average CPU: 10.1.16.212: 69% 10.1.16.209: 72% 10.1.16.211: 64% 10.1.16.210: 74% <br>  Duration fio_rand_write: 102 secs <br>  ************************************************** ****************************** <br></div></div><br><br>  And for Allflash configurations, the growth is even more <a href="">significant</a> . <br>  And you get this growth simply by optimizing and refactoring the code by our programmers, on the system that already exists for you!  Without any hardware upgrade.  Is free.  Automatic update from GUI for half an hour.  Nutanix is ‚Äã‚Äãsuch a Tesla, flooded a new firmware - it went faster and the autopilot appeared.  :) <br>  In my opinion, such cases are the best illustration of the power of software-defined solutions. <br><br>  What else is new, by simple enumeration (in more detail, you should probably write a separate note about each of these features): <br><br>  Nutanix's built-in distributed scale-out, single namespace SMB 2.1 file service, which we call Project Minerva inside.  With it, Nutanix can work as a NAS for external consumers, giving the files "out".  Many have asked this, because there are still areas where I would like file storage for external users, the simplest example is the storage of user profiles for VDI workstations.  Now we can do this within Nutanix only. <br>  Project Minerva is a separate VM (NVM, ‚ÄúNAS VM‚Äù) with a NAS service in it, that is, if you don‚Äôt need it, you don‚Äôt install it, it doesn‚Äôt take up disk space and you need memory, you deploy and install from inside Nutanix.  Currently SMB 2.1 is made, NFS will probably be added in the future.  One of the developers of SAMBA is engaged in them, however Minerva is not SAMBA, it is a ‚Äúfrom scratch‚Äù written file service written to be able to be distributed over an unlimited number of nodes in a cluster while maintaining a single ‚Äúnamespace‚Äù on it, single namespace. <br>  About Project Minerva and all its technical details I will tell you in more detail in a separate article, when it comes to release, but you can watch now, it is published in the Technology Preview status. <br><br><img src="https://habrastorage.org/files/585/8c8/417/5858c84174ce43f1a06ebab097a9b2c9.png"><br><br>  Volume Groups, which appeared in 4.5 and configured there in the CLI, are now controlled from the Prism GUI.  Volume Groups are iSCSI block access volumes available for a VM, if you need to give a block access partition to a VM running inside Nutanix.  Examples of such applications are Microsoft Exchange on ESXi, Windows 2008 Guest Clustering, Microsoft SQL 2008 Clustering, and Oracle RAC. <br><br><img src="https://habrastorage.org/files/632/bc9/aea/632bc9aead9c4d9392bfbdfcca552df2.png"><br>  <i>Blurred on the screenshot, some not yet released features.</i> <br><br>  Update 1-Click Upgrade now works including for BMC and BIOS platform.  Without stopping work, you can update the BIOS of the server platform with our regular update.  Fully automatically, the host platform migrates from VMs to its neighbors, goes into Maintenance Mode, updates the BIOS, reboots with a new one, and returns its VMs to itself, after which it will be done in turn with the rest of the cluster hosts, without administrator intervention. <br><br><img src="https://habrastorage.org/files/e2a/c8c/69a/e2ac8c69aedd4fa08de735bd2a839966.png"><br><br>  Also updated is our firmware embedded and embedded in the hypervisor and CVM - Foundation, now embedded in Nutanix.  Now the user himself can add the new node to the cluster in the Foundation Foundation without the involvement of Nutanix engineers.  A server node comes from the factory with Acropolis Hypervisor flooded into it and the built-in Foundation.  The user has a small Java applet that is launched from the administrator‚Äôs computer, which independently detects a server node not connected to the cluster (each Nutanix has a unique IPv6 address from the link local segment generated from its serial), allows you to fill it with hypervisor, such as ESXi, and include the node being added to your cluster.  Convenient and fast. <br><br><img src="https://habrastorage.org/files/ecb/07d/a61/ecb07da615834a559651cc982392e58a.png"><br><br>  Metro Availability has received a long-awaited opportunity not to restart VM after their migration to the DR-site.  Previously, this was required because of the need to switch NFS descriptors to the new site and its storage (the data was synchronously replicated), now the VMs work through the NFS proxy, and can migrate ‚Äúprofitably‚Äù while continuing to work. <br><br>  Another long-awaited feature - Self-Service Restore.  Now the VM user can independently recover the data stored in the VM's snapshot.  To do this, the so-called Nutanix Guest Tool is installed in the VM, and with its help, VM communicates with Nutanix, allowing you to mount the snapshot as a separate disk inside the VM, from where you can extract the snapshot data by simple copying.  Users who often ‚Äúroll back‚Äù to snapshots, for example, various Test / Dev systems often use this, can do it themselves, not tugging for this admin, and not restoring the entire VM, but only the necessary separate files. <br><br>  There was integration with OpenStack, new drivers for Nova, Cinder, Glance and Neutron.  The integration works through a special Server VM (SVM), an image of which is available for download and installation in Nutanix.  Thus, Nutanix is ‚Äã‚Äãseen from the Open Stack as a hypervisor.  About integration with OpenStack, I will tell you more later. <br><br><img src="https://habrastorage.org/files/93f/f97/c5a/93ff97c5abc74c398a6ad94ab9e6e51a.png"><br><br>  <a href="https://cloudinit.readthedocs.org/">Added</a> support for <a href="https://cloudinit.readthedocs.org/">cloudinit</a> and sysprep scripts.  It has long been asked to do.  Now you can set the post-configuration script for the created or cloned machine, and get a ready-to-use VM with individual settings on output.  Thousands of them.  :) <br><br><img src="https://habrastorage.org/files/b0d/247/992/b0d2479920f74853922c499f5c091bf6.png"><br><br>  Replication between clusters is now possible between different hypervisors.  For example, a production cluster under ESXi can replicate its data to a cluster in a backup data center, under Acropolis Hypervisor.  I like ESXi, but I don‚Äôt like to pay licenses for the sockets of the hosts in the DR used a couple of times a year - OK, use our AHV for it. <br><br>  In the Tech Preview status published Project Dial - <i>1-click in-place hypervisor conversion</i> , the entire cluster migration from ESXi to AHV.  Cluster hypervisors, its CVMs, as well as the user's VM are automatically converted.  Of course, all this will be done without stopping the system (but the VM will restart).  GA release in upcoming NOS versions.  But this is certainly worth a separate big story. <br><br>  So, who already has Nutanix - update, who have not yet - envy :) <br><br>  For experimenting with Nutanix CE - the update for CE <s>will be ready soon, I expect that even before the end of March</s> already updated, it turns out.  Criticized us for the delay - here, get;).  And follow the relevant topic in the forum next.nutanix.com </div><p>Source: <a href="https://habr.com/ru/post/279127/">https://habr.com/ru/post/279127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../279111/index.html">C ++ exception handling under the hood or how exceptions work in C ++</a></li>
<li><a href="../279113/index.html">Observation of internationalized domain names and the letter K</a></li>
<li><a href="../279117/index.html">Linear models: simple regression</a></li>
<li><a href="../279123/index.html">Superscalar stack processor: we continue to cross the grass and the hedgehog</a></li>
<li><a href="../279125/index.html">Dagger 2. Part One. Basics, creating a dependency graph, Scopes</a></li>
<li><a href="../279129/index.html">On the issue of errors</a></li>
<li><a href="../279133/index.html">The digest of interesting materials for the mobile developer # 144 (on March 9-13)</a></li>
<li><a href="../279139/index.html">We invite everyone to the first hackathon in the history of the Stavropol Territory</a></li>
<li><a href="../279143/index.html">A brief course of computer graphics: setting normal maps in a tangent space</a></li>
<li><a href="../279145/index.html">VKontakte launches the third VK Cup championship</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>