<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Was there a hacking of "Gosuslug"? Yandex Hypothesis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Thursday, the network reported that a potentially dangerous code was found on the website of the State Services, and today we want to share with yo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Was there a hacking of "Gosuslug"? Yandex Hypothesis</h1><div class="post__text post__text-html js-mediator-article">  On Thursday, the network reported that a potentially dangerous code was found on the website of the State Services, and today we want to share with you the results of our own investigation and once again remind you of the importance of using Content Security Policy. <br><br> <a href="https://habrahabr.ru/company/yandex/blog/333404/"><img src="https://habrastorage.org/web/4a7/512/5ac/4a75125acde947f8b458a389e55042f4.png"></a> <br><br>  The first threat reports mentioned the introduction of fragments with an iframe on the site‚Äôs pages, loading data from at least 15 questionable domains.  Our analysts quickly began to study the code of the site pages to protect users by using our existing mechanism to prevent such threats.  We will tell about the mechanism a little lower, but the main thing here is in the other - the found code fragments were well known to us. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  If you are familiar with the development of extensions for popular browsers, then you know that the authors have not so many ways to earn money on their own creations.  Paid extensions almost do not occur, and as a result, the majority of attempts to make money is built around the fact that they simply embed advertising in the code of the pages visited by users.  To do this, there are whole affiliate programs that offer authors of extensions to embed code that their extensions must embed in all pages visited by the user.  Usually, the embedded fragment is engaged in showing additional, often not very high-quality advertising, but, generally speaking, technologically it allows for something more dangerous.  At gosuslugi.ru there were code snippets, which in such extensions can be used to collect statistics or display ads. <br><br><img src="https://habrastorage.org/web/677/689/b7c/677689b7c8b24c9f93ac4823777b6956.png"><br><br>  Such fragments fall into the page code on the client side if it has an extension installed.  And here the question arises: ‚Äúhow then did this code end up on the server side?‚Äù And we have a hypothesis. <br><br>  We believe that the appearance of this code on the pages of gosuslugi.ru is not associated with a hacking, targeted attack.  It is more likely that the administrator who edited the contents of these pages had a similar extension installed.  It injected the extraneous code into the document when it was loaded onto the client side, and it appeared on the server after the employee had saved his changes.  One more fact speaks in favor of this version.  We carefully monitored all the found fragments, and none of them began to upload any content - the authors of the code hardly expected that they would get access to the users of the public services portal.  But this does not mean that there was no threat - they could begin to do it at any time, as soon as they understood, on the pages of which site their code appeared. <br><br>  And now about the protection mechanism.  The order of percentage of Yandex users has a similar problem with extraneous content in the pages visited.  And that's a lot.  Therefore, we have long and actively been fighting with such a threat.  First of all, we protect users of Yandex. Browser with the help of a mechanism that prevents the loading of data from identified questionable addresses.  Information about new threats quickly gets into the SafeBrowsing database, which is available to the Browser, Search and our other services using a <a href="https://tech.yandex.ru/safebrowsing/">special API</a> .  This allows us to quickly stop the spread of epidemics without having to release an update for the application itself. <br><br>  Fortunately, in the case of state services, Yandex users for the most part have already been protected: 15 of the found fragments out of 16 have already been entered into the SafeBrowsing database even before the situation with the site as part of the usual process of searching for threats. <br><br>  And something else.  Having a shield on the client side is good, but you should not forget about protection on the service side too.  We recommend that all major services working with private user data implement Content Security Policy support.  This will block the download of third-party content and protect your users.  Yandex services have long <a href="https://habrahabr.ru/company/yandex/blog/206508/">used</a> CSP to prevent the downloading of unauthorized code. </div><p>Source: <a href="https://habr.com/ru/post/333404/">https://habr.com/ru/post/333404/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../333392/index.html">Yandex shares soared after the deal with Uber</a></li>
<li><a href="../333396/index.html">PHP Reflection on closures</a></li>
<li><a href="../333398/index.html">Talk about Yii 2</a></li>
<li><a href="../333400/index.html">We make a website for virtual reality. We build the monitor into the monitor and reflect on the future</a></li>
<li><a href="../333402/index.html">Recommendations for security when working with Docker</a></li>
<li><a href="../333406/index.html">How Angry Birds 2 increased revenue several times over the year</a></li>
<li><a href="../333410/index.html">Developing wrapper scripts using the Sparrow tool</a></li>
<li><a href="../333412/index.html">Creating a schedule for SCADA systems based on cron</a></li>
<li><a href="../333414/index.html">The road to C ++ 20</a></li>
<li><a href="../333418/index.html">We pump over NES Classic Mini - continuation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>