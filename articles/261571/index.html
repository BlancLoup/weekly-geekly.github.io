<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating the Droste effect in Wolfram Language (Mathematica)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translation of the post by John McLune " Droste Effect with Mathematica ". The code given in the article can be downloaded at the end of the post. 
 I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating the Droste effect in Wolfram Language (Mathematica)</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/a07/260/1b0/a072601b0345403093c8945d2ca7f267.png"></div><br>  <i>Translation of the post by John McLune " <a href="http://blog.wolfram.com/2009/04/24/droste-effect-with-mathematica/">Droste Effect with Mathematica</a> ".</i>  <i>The code given in the article can be downloaded at the end of the post.</i> <i><br></i>  <i>I express my deep gratitude to <a href="http://vk.com/ld742">Kirill Guzenko</a> for his help in translating.</i> <hr>  The Droste effect ( <a href="https://en.wikipedia.org/wiki/Droste_effect">wiki</a> ) is a recursive inclusion of an image of itself in itself.  The name comes from the Droste cocoa powder, which in 1904 was sold in a package that showed the nurse who held the box that the nurse was on, and so on.  The simplest implementation is to scale and transform the image, then place it on its unmodified exact copy, then start the process again.  Take a look at a <a href="http://demonstrations.wolfram.com/DrosteEffect/">demonstration</a> that uses original illustrations of Droste packaging.  However, much more interesting results can be achieved if we use the theory of functions of a complex variable (PCT).  Asher M.K. was the first to popularize the idea of <a href="http://mathworld.wolfram.com/ConformalMapping.html">conformal mappings</a> in relation to images, but with the help of computers we can easily implement this idea in photographs to get something like this: <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/bf3/502/db1/bf3502db11c63246ee005e6286175913.png" alt="A photograph conformally mapped in Mathematica" title="A photograph conformally mapped in Mathematica" width="387" height="306"><br><br>  Yes, the idea is not new.  However, when I decided to implement a similar effect, the methods that I found on the network seemed to me unsatisfactory.  Some suggested a lot of handmade copy-and-paste type over images, in others there were problems with inconsistencies in resolution at the joints of parts of images.  And, as usual, I came to the conclusion that <i><a href="http://www.wolfram.com/products/mathematica/">Mathematica</a></i> should be used here, or in this case <a href="http://www.wolfram.com/products/gridmathematica/"><i>Mathematica</i> grid</a> . <br><br>  In essence, the idea is simple.  We create an image where the pixel at position { <i>x, y</i> } of the resulting image is obtained from the pixel at position <i>f</i> [{ <i>x, y</i> }] of our original image.  The magic is in choosing the function <i>f itself</i> .  But before we get to this, we need to prepare something. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Currently, <i>Mathematica</i> does not contain an operation for arbitrary transformation of images, so first I have to implement them ( <b>Post was written by John in the 7th version of Wolfram Mathematica, in the 8th version a special function <a href="http://reference.wolfram.com/language/ref/ImageTransformation.html">ImageTransformation</a> appeared for this purpose, which significantly reduces the code in John‚Äôs article - ed.</b> ).  The important point is to constantly calculate the color between the pixels to prevent resolution matching problems and unnecessary pixelation in enlarged areas of the image.  My method is to linearly interpolate all the colors of pixels in each RGB channel for an image.  This is the most computationally complex approach, especially with 10 megapixel source images, but it gives me the quality I need. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/393/261/afa/393261afa0232998e4cfa6c6641599d4.png" alt="Creating a linear interpolation of all pixel colors" title="Creating a linear interpolation of all pixel colors"><br><br>  To compensate for this approach, I configured everything for parallel computing.  To begin with, I used the <a href="http://www.wolfram.com/products/mathematica/newin7/content/BuiltInParallelComputing/">parallelization tools</a> built into <i>Mathematica</i> .  Thus, instead of simply using <b>Table</b> to generate a grid of pixels, I created a function that calls <b>Table</b> to generate a layer of the final image, which is invoked in parallel by <b><a href="http://reference.wolfram.com/mathematica/ref/ParallelTable.html">ParallelTable</a></b> to redistribute work between several processor cores.  So 3-4 lines more, but this is only half of the work on parallelization. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a28/b3b/393/a28b3b393a287be08c8b195bfc578e5c.png" alt="Generating a slice of the final image" title="Generating a slice of the final image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5cf/b37/4b0/5cfb374b020290b2f79cb5ad5bb94c4d.png" alt="Distributing the task across multiple CPUs" title="Distributing the task across multiple CPUs"><br><br>  Then, I transfer the original image to each processor and set the interpolation function.  This part is very demanding of calculations, so I want to do this only once and then be able to make any kind of images from the source without doing this work again.  Parallelization is carried out here quite simply: the available cores are launched, the program definition is distributed to all cores, and then the <b><a href="http://reference.wolfram.com/mathematica/ref/ParallelEvaluate.html">ParallelEvaluate</a></b> function is used to send an image by reference with a request to create an interpolation function. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f6f/fa7/e9e/f6ffa7e9ec826b5537ccf59f8a342988.png" alt="Parallelizing and interpolating" title="Parallelizing and interpolating"><br><br>  There is an elegant way of transmitting an image as a string with the contents of a JPG file instead of transferring real uncompressed data.  It turns out a much smaller object, which, accordingly, is transferred faster. <br><br>  With such a setup, I can easily attract additional computer cores from my office to speed up computing using the <i>Mathematica</i> grid. <br><br>  In the code you need to add something else.  So I get rid of the need for the original image to be cropped in the right ratio and with the right centering. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a4a/0ec/ad4/a4a0ecad45883a10180633eb7acf0997.png" alt="Cropping the image" title="Cropping the image"><br><br>  Here's what my original image looks like after cropping: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/016/c89/b12/016c89b121c8f29b7edeb327a5cdd748.png" alt="The cropped image" title="Cropped image" width="387" height="306"><br><br>  Well, everything is boring behind, now is the time to have some fun. <br><br>  The twist I use is based on the specific properties of the <b><a href="http://reference.wolfram.com/mathematica/ref/Power.html">Power</a></b> function <b><a href="http://reference.wolfram.com/mathematica/ref/Power.html">Power</a></b> on the complex plane.  We can represent our pairs of coordinates { <i>x, y</i> } as parts of the complex number <i>p</i> = <i>x</i> + <i><b>I</b> y</i> , use the map <i>f</i> [ <i>p</i> ]: = <i>p <sup>c</sup></i> and go back to the Cartesian coordinates.  It is rather difficult to figure out how to take the value of <i>c</i> , especially if you use the more general model <i>a</i> + ( <i>b</i> + <i>c</i> <i>p</i> ) <sup><i>d</i></sup> , where { <i>a, b, c, d</i> } are complex numbers.  So I decided to turn to the Wolfram Demonstrations Project, found a demonstration with <a href="http://demonstrations.wolfram.com/ConformalMaps/">conformal mappings there</a> and <a href="http://demonstrations.wolfram.com/ConformalMapOfExponential">changed the code a</a> bit to get the mapping I was interested in. <br><br>  Having experimented, I found out the effects of the parameters, set up the calibration, got good initial values ‚Äã‚Äãand set the named options in the necessary places of that magic formula.  In the end, I got this design for twisting. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b9d/e8e/699/b9de8e699f7865896fa19a072b4a94b5.png" alt="Placing parameters and default values into the magic formula" title="Default values ‚Äã‚Äãinto the magic formula"><br><br>  I provide this kind of self-replication by jumping inside when I try to access a pixel outside the image, and then out while I get access to a pixel inside a certain area. <br><br>  For reasons of aesthetics, I would like to close the connections between the images to make them more natural.  In my example, I used a picture frame, but I found examples using doorways, windows, computer monitors, and the like. <br><br>  Automating this process allows you to avoid manual copying and subsequent pasting, and also avoids problems with inconsistencies in the resolutions of different parts of the image. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d2e/991/417/d2e9914177f2fb38a09955ceff67a49d.png" alt="Programatically covering the image join" title="Programatically covering the image join"><br><br>  Everything, all the laborious work is over, now is the time to play around.  Initialize the kernels with the original image, specifying the coordinates of the inner region (you can easily get them using the <i>coordinate picker</i> in the <a href="http://reference.wolfram.com/mathematica/tutorial/InteractiveGraphicsPalette.html">2D Drawing</a> palette): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/53d/86a/ed1/53d86aed112fdd78975670df1c7483c9.png" alt="Initialize the kernels with the source image" title="Initialize the kernels with the source image"><br><br>  Now generate an image with a height of 400 pixels in height: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6cb/815/f70/6cb815f7071fbb93e6d6312387f2a694.png" alt="Generating a 400-pixel image" title="Generating a 400-pixel image" width="429" height="329"><br><br>  There are many combinations of parameters, for example, like this one with a double helix: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/003/0de/4f3/0030de4f3835f2511216c59bb79b9a65.png" alt="Image created from double-helix parameters" title="Image created from double-helix parameters" width="429" height="329"><br><br>  One spiral in the opposite direction: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e89/d4b/eeb/e89d4beeb27c0b47989f709e745ebcf8.png" alt="Spiral in the opposite direction" title="Spiral in the opposite direction" width="429" height="329"><br><br>  Without spirals, only replication: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f5/e43/5e8/4f5e435e8e59be62f1bfbde25f281667.png" alt="No spiral, just replication" title="No spiral, just replication" width="429" height="329"><br><br>  This code creates octagons by creating two copies per spiral: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ae/85b/b66/5ae85bb667203a15cb58a89bf197777a.png" alt="Two copies per spiral, resulting in octagonal forms" title="Two copies per spiral, resulting in octagonal forms" width="429" height="329"><br><br>  And this one without recursion and spirals is just two copies rolled together: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1a/b90/cce/d1ab90cce7197bad9ba49172256201f0.png" alt="Just two copies wrapped together" title="Just two copies wrapped together" width="436" height="345"><br><br>  And here, the climax - a movie in DVD quality, showing the effect of Droste twisting the image into a recursive spiral. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/FQPrAjkg1Qo%3Ffeature%3Doembed&amp;xid=25657,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg0El7hjcden22junfa7i63GmLGwQ" frameborder="0" allowfullscreen=""></iframe><br><br>  Creating such a video requires a large amount of computation ‚Äî calling three interpolation functions for each of 10 million pixels about 400 thousand times for each of 60 frames.  This is the moment when my parallelization efforts really pay off.  Of course, being at Wolfram Research, I have on hand several <i>Mathematica</i> grid licenses communicating via <a href="http://www.wolfram.com/products/lightweightgrid/">Wolfram Lightweight Grid Manager</a> ( <b>Starting from the 7th version of Wolfram Mathematica, the parallelization functionality is included in the Wolfram Language core and does not require additional programs when running it is able to use all the kernels available on your computer. However, if you need to connect to the cluster, this will require gridMathematica - ed.</b> ).  I open Parallel Configuration preferences, and they all magically appear.  A few clicks, and now I have 16 more cores, in addition to two on my small laptop, and without any changes in the code, the film is generated 8 times faster (and 16 times faster than without parallelization).  I don‚Äôt know exactly where this code works, but since the program and the source images are transmitted automatically, this is not very interesting for me.  You can watch the on-screen demonstration of how <a href="http://www.wolfram.com/broadcast/screencasts/lightweightgridsystem/">all this is configured</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2bb/159/bdf/2bb159bdf0f596a969310ddb2ef52ebe.gif" alt="Exporting the movie" title="Exporting the movie" width="451" height="114"><br><br>  This code can be modified in different ways;  for example, changing <b>ReplicateRegion</b> will allow you to use non-rectangular frames, in the form of circles, for example, or you can even change the colors and transparency of replications.  Try experimenting yourself and see what can come of it. <br><br><div class="spoiler">  <b class="spoiler_title">The code used in the article</b> <div class="spoiler_text"><pre><code class="hljs markdown">InitializeSources[<span class="hljs-string"><span class="hljs-string">source_,p1_,p2_</span></span>]:=Quiet[<span class="hljs-string"><span class="hljs-string">Block[{imgbytes=Import[source,"Byte"</span></span>],sourcebytestream},If[<span class="hljs-string"><span class="hljs-string">imgbytes===$Failed,$Failed,sourcebytestream=FromCharacterCode[imgbytes</span></span>]; LaunchKernels[<span class="hljs-string"></span><span class="hljs-string"></span>]; DistributeDefinitions[<span class="hljs-string"><span class="hljs-string">OriginalValueFns,DrostifyRegion,ReplicateRegion,TransformCoordinates,CropData</span></span>]; ParallelEvaluate[<span class="hljs-string"><span class="hljs-string">$ImageInterpolationFn=OriginalValueFns[CropData[Reverse@Developer`ToPackedArray[N[ImportString[#,{"JPG","Data"}</span></span>]]],p1,p2]/255.];]&amp;[<span class="hljs-string"><span class="hljs-string">sourcebytestream</span></span>]]]] OriginalValueFns[<span class="hljs-string"><span class="hljs-string">data_</span></span>]:=($AspectRatio=1/Apply[<span class="hljs-string"><span class="hljs-string">Divide,Most[Dimensions[data</span></span>]]]; Apply[<span class="hljs-string"><span class="hljs-string">Function,{{x,y},If[Abs[x</span></span>]&gt;1||Abs[<span class="hljs-string"><span class="hljs-string">y</span></span>]&gt;$AspectRatio,{1.,1.,1.},#]&amp;[<span class="hljs-string"><span class="hljs-string">Table[ListInterpolation[data[[All,All,channel</span></span>]],{{-1,1},$AspectRatio {-1,1}},InterpolationOrder-&gt;1][x,y],{channel,1,3}]]}]); DrostifyRegion[start<span class="hljs-emphasis"><span class="hljs-emphasis">_,end_</span></span>,res<span class="hljs-emphasis"><span class="hljs-emphasis">_,opts:OptionsPattern[]]:=Image[Table[Apply[$ImageInterpolationFn,TransformCoordinates[{x,y},opts]],{x,end,start,-2/(res-1)},{y,-$AspectRatio/$AspectRatio,2/res}]]; DrosteImage[resolution_</span></span>,opts:OptionsPattern[]]:=ImageAssemble[ParallelTable[{DrostifyRegion[-1+2 (slice-1)/#,-1.+2 slice/#,resolution,opts]},{slice,#,1,-1}]]&amp;[Max[Length[Kernels[]],1]]; CropData[data<span class="hljs-emphasis"><span class="hljs-emphasis">_,r1_</span></span>,r2<span class="hljs-emphasis"><span class="hljs-emphasis">_]:=Block[{center,xlo,xhi,ylo,yhi,innerdims},center=Mean[{r1,r2}]; (*Find the center of the selected rectangle*) $DrosteScale=Max[Flatten[{Abs[r2-center]/(center-{1,1}),Abs[r1-center]/Abs[Reverse@Take[Dimensions[data],2]-center]}]]; (*Find the scaling of the cropped image to the rectangle*)innerdims=Abs[r1-r2]/$DrosteScale; {{ylo,xlo},{yhi,xhi}}=Round[{center-innerdims/2,center+innerdims/2}]; Return[data[[xlo;;xhi,ylo;;yhi,All]]]]; TransformCoordinates[{x_</span></span>,y<span class="hljs-emphasis"><span class="hljs-emphasis">_},opts:OptionsPattern[]]:=FixedPoint[ReplicateRegion,{Re[#],Im[#]}&amp;@((OptionValue[Zoom] E^(I OptionValue[Rotation])) (OptionValue[XShift]+I OptionValue[YShift]+x+I y)^(OptionValue[CopiesPerRotation]+OptionValue[Spirals] I Log[$DrosteScale]/(2 \[DoubledPi]))),OptionValue[MaxRecursion]]; Options[TransformCoordinates]={Zoom-&gt;1,XShift-&gt;0,YShift-&gt;0,Rotation-&gt;0,CopiesPerRotation-&gt;1,MaxRecursion-&gt;10,Spirals-&gt;1}; ReplicateRegion[{x_</span></span>,y_}]:=Which[(<span class="hljs-emphasis"><span class="hljs-emphasis">*If outside the image area,move closer*</span></span>)Abs[x]&gt;1||Abs[y]&gt;$AspectRatio,{x,y} $DrosteScale,(<span class="hljs-emphasis"><span class="hljs-emphasis">*If inside the frame move out to the main image*</span></span>)Abs[x]<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">$DrosteScale&amp;&amp;Abs[y]</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">DrosteScale</span></span></span></span><span class="xml"><span class="hljs-tag"> $</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">AspectRatio</span></span></span></span><span class="xml"><span class="hljs-tag">,{</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">}/$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">DrosteScale</span></span></span></span><span class="xml"><span class="hljs-tag">,(*</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">otherwise</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">use</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">the</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">calculated</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">coordinates</span></span></span></span><span class="xml"><span class="hljs-tag">*)</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">True</span></span></span></span><span class="xml"><span class="hljs-tag">,{</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">}];</span></span></span></span></code> </pre> </div></div></div><p>Source: <a href="https://habr.com/ru/post/261571/">https://habr.com/ru/post/261571/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../261559/index.html">New iOS 8.4, years spent on Facebook, Windows Phone success - and other news of the week for a mobile developer</a></li>
<li><a href="../261561/index.html">Parsing Formats: Packed Hashed Resources</a></li>
<li><a href="../261563/index.html">Brief introduction to tensors</a></li>
<li><a href="../261567/index.html">Veeam Availability Suite v9: EMC Storage Integration</a></li>
<li><a href="../261569/index.html">Services for testing penetration testing skills</a></li>
<li><a href="../261573/index.html">How to really use Veeam% ProductName% Free to the fullest</a></li>
<li><a href="../261575/index.html">Python 2.7 performance improvements</a></li>
<li><a href="../261577/index.html">Meet Backup Exec 15</a></li>
<li><a href="../261579/index.html">Yandex.Money does not require the cardholder‚Äôs full name when paying</a></li>
<li><a href="../261581/index.html">IBM Science and Technology Center announces additional recruitment for the internship program for 2015/2016</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>