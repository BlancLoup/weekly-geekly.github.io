<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Solar JSOC - the experience of building a commercial SOC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article opens a series of publications dedicated to the operation of the Information Security Incident Monitoring and Response Center - Security ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Solar JSOC - the experience of building a commercial SOC</h1><div class="post__text post__text-html js-mediator-article">  This article opens a series of publications dedicated to the operation of the Information Security Incident Monitoring and Response Center - Security Operations Center (SOC).  In them, we will talk about what needs to be taken into account when creating a SOC, about the process of preparing monitoring engineers, registering incidents and practical cases that Solar JSOC is facing. <br><br>  The purpose of these articles is not self-advertisement, but a description of practical aspects in the implementation of a service model for the provision of information security services.  The first article will have an introductory character, but it is necessary to dive into a topic that is still fairly new to the Russian information security market. <br><br><h3>  Why do we need SOC </h3><br>  What is SOC, how does it differ from SIEM, and why is it needed at all, I will not describe it - too many articles have recently been written on this topic.  Moreover, in the articles one could meet the view from any side: an expert, a SIEM vendor, an owner or an employee of SOC. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As an introductory information, it is worth mentioning the statistics according to research conducted by the IIDF, as well as by Group-IB and Microsoft: <br><br><ul><li>  The loss of the Russian economy from cybercrime in 2015 is estimated at 123.5 billion rubles. </li><li>  60% of Russian companies noted a 75% increase in the number of cyber incidents, and the amount of damage doubled. </li></ul><br>  I would also like to mention the statistics on our clients, which is reflected in the quarterly reports of the JSOC Security Flash Report: <br><br><ul><li>  The double increase in the number of information security incidents in the first quarter of 2016 compared to the same period of 2015. </li><li>  Significant increase in incidents involving confidential information leaks. </li><li>  Increase critical incidents from 26% to 32% in relation to the total skoupu. </li><li>  Growth in the number of different cyber-groups operating according to known fraud schemes. </li></ul><br><a name="habracut"></a><br>  If we recall the recent public incidents - ‚ÄúMetallinvestbank‚Äù, ‚ÄúRussian International Bank‚Äù, the withdrawal of money through the SWIFT vulnerabilities and the attack on the energy sector of Ukraine, the idea that security needs to be monitored and security incidents to identify and analyze becomes completely logical and understandable. . <br><br>  As one of the most popular solutions of recent years to monitor and detect incidents is the SIEM-system, which becomes the core of SOC.  This choice is primarily due to a significant amount of tasks that can be solved with the help of a SIEM system: <br><br><ul><li>  to close incidents recorded by other systems on their own, within the framework of a single core incident management; </li><li>  get a handy tool for finding necessary events, handling incidents, storing the collected data; </li><li>  identify statistical deviations and slowly developing incidents by analyzing large intervals and amounts of information from specific remedies; </li><li>  compare and correlate data from different systems, and, as a result, build complex chains of incident detection scenarios, ‚Äúenrich‚Äù information in the logs of some systems with data from others. </li></ul><br><h3>  Some methodology </h3><br>  According to the model proposed by HP SIOC, there are several levels of SOC-SOMM maturity (Security Operations Maturity Model): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ae5/e51/3f9/ae5e513f926e41efb55f1af8e23108b2.jpg"></div><br>  <em>Fig.</em>  <em>1. SOMM levels</em> <br><br>  Unfortunately, most companies both in Russia and in the world, having taken the first step towards building their own Security Operations Center, stop there.  According to HP estimates, 24% SOC in the world do not reach level 1, and only 30% SOC correspond to the base (2) level.  Statistics of the distribution of SOMM levels depending on the business area of ‚Äã‚Äãcompanies, collected in 13 countries of the world (including Canada, USA, China, UK, Germany, South Africa, etc.) is as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bfd/661/a7f/bfd661a7fe714bf3a86d274bc62aa20e.gif"></div><br>  <em>Fig.</em>  <em>2. Distribution of SOMM levels by business area</em> <br><br><h3>  Problems of own SOC </h3><br>  The most beaten path in Russia is to acquire a SIEM system for monitoring incidents.  Practically all large Russian companies passed along this path.  At the same time, it is possible, at best, to successfully launch an incident monitoring and response center at 5-10%.  What prevents?  The main difficulties in building your own SOC are observed in three directions: <br><br><ul><li>  <b>Quantitative and qualitative shortage of staff</b> .  The reasons are various: from personnel shortage and the lack of specialized universities to the difficulty of obtaining the required competencies.  In the framework of the average information security department (department), today there are 3-5 people who must carry out the entire cycle of work to ensure the security of the company (from administering protection tools and ensuring compliance with regulatory requirements to continuous risk analysis and developing a development strategy for the company).  Naturally, with such a load, it is almost impossible to devote the proper time to SOC tasks. <br><br></li><li>  <b>The impossibility of building an effective monitoring process with internal SLAs</b> .  In addition to the need to allocate staff, the launch of SOC implies the creation of a full-fledged duty shift operating in the IT-security unit operating in 12/5 or 24/7 mode, and this is from 2 to 5 new staff members.  At the same time, the allocation of personnel is directly related to the need for constant monitoring of personnel routine (extremely rarely IB specialists are ready to work in the night shift), building processes and internal quality control of the work performed. <br><br></li><li>  <b>SOC development should be carried out on an ongoing basis</b> : the development of new scenarios for threat vectors, the connection of new information sources, the aggregation and use of reputation databases.  Static SOC is completely ineffective, and for dynamic development, an analyst is needed.  The presence in the state of a person who is an SOC architect in full time mode is a great luxury even for a large company. </li></ul><br>  Estimating the need for creating SOCs on the market together with the nuances described above led us first to the idea and then to actually build our own commercial SOC. <br><br><h3>  Platform Selection </h3><br>  One of the main issues at the construction stage of the Security Operations Center for us was the choice of a SIEM system.  We have formed a number of requirements for it: <br><br><ul><li>  SIEM should have the ability to build the most complex chains and patterns of interconnection between events, use various reference books and lists (including those loaded according to a schedule) to supplement the incident with important information.  At the same time, we were less interested in the set of rules, scenarios and categories out of the box; we needed a platform for building content on our own. <br><br></li><li>  The system should allow physically and logically to separate the accumulated data across different storage groups (in our case, different customers) with the possibility of separation of access rights, as well as independent repositories of events and incidents of different customers. <br><br></li><li>  The system should have both a sufficient number of ready-made connectors (with the possibility of changing the mapping), and have a convenient mechanism for developing additional connectors to any system that, at least in some form, can give information to the outside.  The API was also important for connecting with external incident management, reporting and visualization systems. <br><br></li><li>  One of the most important tasks that the SIEM should solve is stability of work under heavy load both in the flow of events and in the operation of a large number of correlation rules, retrospective searches and reporting. <br><br></li><li>  The SIEM system should allow customization of internal resources for SOC changing tasks.  In particular, the creation of an internal profile of monitoring sources (System Health), the use of external scripts at various stages of work with fixed incidents, the maintenance and customization of their incident management, etc. </li></ul><br>  We stopped our choice on one of the leaders in the SIEM class - HP ArcSight and, despite various difficulties in the life of the system, we never regretted our decision. <br><br><h3>  SOC components </h3><br>  Following the incident monitoring service, Solar JSOC was supplemented with new services: <br><br><ul><li>  WAF as a service; </li><li>  Anti-DDoS; </li><li>  Vulnerability Assessment, where we chose Qualys as the main solution due to the rich functionality and user-friendly interface, including for writing signatures; </li><li>  Scanner software code for vulnerabilities and NDV Solar inCode. </li></ul><br>  Technologically, Solar JSOC is no longer just HP ArcSight.  SIEM kernel gradually overgrown with various useful addons and features.  A traffic monitoring tool and a Security Intelligence Solar inView class solution have been added, which is: <br><br><ul><li>  a tool for high-level search for anomalies at the client and tracking general trends in activities and incidents; </li><li>  control system and visualization of our performance of SLA to the customer; </li><li>  an effective visual dashboard and reporting system for customer business management. </li></ul><br>  One of the main innovations of the last year is the transition to an external case management system.  As a platform, we chose Kayako, which is optimal for our tasks, has a convenient and flexible customization tool and an excellent API. <br><br>  An important tool for monitoring and detecting incidents is the reputational bases of various domestic and foreign vendors and CERT.  The databases can contain both network and host indicators of compromise (IOC) of various malicious programs, or they can describe the behavior of malicious users.  Depending on the data supplied, we use various tools for identifying indicators: network ones are entered into ArcSight for retrospective search and control in the future, and the host ones turn into indicators of security scanners.  The most important partners in this area are FinCERT and Kaspersky Lab. <br><br>  Integration with the reputation databases of Kaspersky Threat Intelligence is carried out through an API, developed jointly with Kaspersky Lab.  Thanks to this, we get the most up-to-date information - the ‚Äúfeeds‚Äù database is updated every few hours, which is comparable to the rate at which new anti-virus signatures are received (sometimes faster).  This allows you to quickly identify zero-day viruses that fall into the infrastructure of customers due to their callbacks. <br><br>  An interesting format of the information provided is APT Reports, in which the vendor or CERT describes the attack history, the toolkit, the associated exploitation of vulnerabilities, and, of course, the target of the attackers.  This format allows us to take a fresh look at the points of control and detection of incidents, tweak existing or create new correlation rules. <br><br>  Using the above tools, we have formed the following areas of the provision of information services: <br><br><ul><li>  Protection of external web resources of the company - here, first of all, we provide a service for the proactive use of WAF and Anti-DDoS solutions; </li><li>  Comprehensive security for business applications - incident monitoring + source code analysis; </li><li>  Infrastructure monitoring of information security incidents; </li><li>  Complete security control and compliance control; </li><li>  Detection of targeted attacks and zero-day malware - a comprehensive approach that includes regular infrastructure scans using a security scanner + monitoring incidents + using targeted feeds + parsing and analyzing malware instances; </li><li>  Operation of intelligent GIS - DAM, Sandbox, NGFW, traffic analyzers. </li></ul><br><h3>  Architecture </h3> <br><img src="https://habrastorage.org/files/9e8/6e1/225/9e86e12254ec4408acb8158c3e4c9137.jpg"><br>  After the selection of the main technological platform, it was necessary to solve the problems of creating the infrastructure and determine the location of the location.  The experience of our Western colleagues shows that the target accessibility of the architecture should be at least 99.5% (and with maximum disaster recovery). <br><br>  At the same time, the question of geography remained fundamental: collocation is possible only within the borders of the Russian Federation, which ruled out the possibility of using popular western providers.  Natural security issues of infrastructure at all levels of access were superimposed here.  Therefore, it was decided to contact our partner Jet Infosystems, and within the framework of a large colocation, JSOC was allocated several racks in a fragment physically isolated from other servers, where we were able to deploy our architecture, while tightening the security profiles that already exist within ITSC.  The IT infrastructure is deployed in the Tier 3 data center, and its accessibility is 99.8%.  As a result, we were able to reach the target indicators of the availability of our service and received substantial freedom of action in the work and adaptation of the system for ourselves. <br><br><h3>  Team </h3><br>  At the initial stage, the JSOC team consisted of 3 people: two monitoring engineers closing the time interval from 8 to 22 hours, and one analyst / administrator who was involved in the development of the rules.  The SLA for the service, indicated to the clients, was also quite mild: the reaction time to the detected incident was up to 30 minutes, the time for analysis, preparation of analytical information and informing the client up to 2 hours.  But, after the first months of work, we made some very significant conclusions: <br><br><ul><li>  The monitoring shift must necessarily work in the 24 * 7 mode.  Despite the fact that the volume of incidents in the evening and night hours is reduced, the most important and critical events (the launch of DDoS attacks, the final phases of slow attacks on penetration through the outer perimeter, malicious actions of counterparties, etc.) occur at night, and by the time of the start of the morning shift they are no longer relevant. <br><br></li><li>  The time to resolve a critical incident should not exceed 30 minutes.  Otherwise, the chances of preventing it or minimizing damage fall dramatically. <br><br></li><li>  To ensure the required parsing time, for each incident, a full-fledged investigation toolkit must be prepared within ArcSight: active channels with filtered target events for parsing, trends, dashboards, showing statistical changes in suspicious activities, and targeted analytic reports that allow you to quickly analyze activities and take operational solutions, active / session lists for quick access to information about hosts, users, etc. <br><br></li><li>  The administration team for the protection of our customers should be separated from the monitoring and incident detection team.  Otherwise, the risk of the influence of the human factor in the chain "made configuration changes - recorded the incident - noted a false response" could significantly affect the quality of our service. </li></ul><br>  These findings significantly influenced the structure of the JSOC department at Solar Security and helped form a three-tier incident response model.  Now the division has more than 40 people, has a formed structure (see Fig. 4) and includes: <br><br><ul><li>  Two duty shifts that work 24 * 7: one is engaged in monitoring and analysis of incidents, the other - the administration of the system. </li><li>  Personal analysts and service managers for JSOC clients.  By experience, one analyst is able to lead 3-4 companies. </li><li>  Dedicated development team that allows us to maintain the relevance of the service and the threat monitoring profile. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1c1/a01/5e7/1c1a015e711842329a13107cc45991ff.png"></div><br>  <em>Fig.</em>  <em>4 - JSOC Organizational Structure</em> <br><br>  This organizational structure allowed us to reach the SLA targets: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bf5/30c/16a/bf530c16a9664cfca6afe2b24c74f261.jpg"></div><br><h3>  Results </h3><br>  Over the past 4 years of development, our Security Operations Center has gone through the following important stages: <br><br>  year 2012 <br><br><ul><li>  the emergence of the idea of ‚Äã‚Äãcloud SOC. </li></ul><br>  year 2013 <br><br><ul><li>  formation of a JSOC team consisting of 2 monitoring engineers in 12/5 mode, one analyst and a head of the direction; </li><li>  1 customer and 3 pilot projects; </li><li>  SLA: reaction to the incident - 30 minutes, analysis - 2 hours. </li></ul><br>  year 2014 <br><br><ul><li>  the formation of two sites: Moscow and Nizhny Novgorod; </li><li>  the first line of monitoring and operation 24/7; </li><li>  SLA performance - 98.5%; </li><li>  10 customers. </li></ul><br>  2015 <br><br><ul><li>  the staff reached 30 people; </li><li>  a significant increase in the number of customers - 20+, 4 public projects </li><li>  SLA performance - 99.2% </li></ul><br>  This concludes the first introductory article from the series.  In the near future - materials on the technical aspects of the work of Solar JSOC: <br><br><ul><li>  SOC availability: indicators, measurement. </li><li>  Solar JSOC: Incident Recording.  How and why to live in an external ticket system. </li><li>  Solar JSOC: RULING Kitchen, etc. </li><li>  and etc. </li></ul><br>  Stay with us! </div><p>Source: <a href="https://habr.com/ru/post/310470/">https://habr.com/ru/post/310470/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310456/index.html">Custom Software Development</a></li>
<li><a href="../310460/index.html">The Complete Docker Practical Guide: From Scratch to AWS Cluster</a></li>
<li><a href="../310462/index.html">Put on a diet PostgreSQL indices for Zabbix</a></li>
<li><a href="../310464/index.html">Work with Apache Ignite topology</a></li>
<li><a href="../310466/index.html">Automation of IT services</a></li>
<li><a href="../310472/index.html">You do not have enough speed R? We are looking for hidden reserves</a></li>
<li><a href="../310474/index.html">16 myths about CRM-systems</a></li>
<li><a href="../310478/index.html">Stable version of Android Studio 2.2 released</a></li>
<li><a href="../310480/index.html">Why does the network of mobile operators sometimes ‚Äúfall‚Äù?</a></li>
<li><a href="../310482/index.html">Another type of XSS attack on the site</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>