<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Monte Carlo method in particle physics</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is devoted to the well-known Monte Carlo method, which is based on probability theory and mathematical statistics, in particle physics. A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Monte Carlo method in particle physics</h1><div class="post__text post__text-html js-mediator-article">  This article is devoted to the well-known Monte Carlo method, which is based on probability theory and mathematical statistics, in particle physics.  Also, I will tell you how you can play discrete and continuous random variables using the Neumann method, and for a snack we will see how to apply <abbr title="Monte Carlo method">MMK</abbr> in <abbr title="particle physics">FEC</abbr> . <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cb7/ba6/0b3/cb7ba60b3b0c91b51cf4e995bc3afe87.jpg"></div><br>  Immediately, I note that the simulation will be performed in the <abbr title="analytical computing systems">CAB</abbr> <abbr title="Wolfram mathematica">WM</abbr> , which I applied (not so long ago) in my first article. <br><a name="habracut"></a><br><h4>  Discrete random variables </h4><br>  Let's talk a little about probability theory and mathematical statistics using the example of a two-dice model.  So, we are faced with the task of playing a typical situation at a casino playing table: ‚ÄúPlay a certain number of events of simultaneously throwing two dice with numbers.  According to the results of the draw, find the number of simultaneous hits of the numbers 2 and 4 ".  In addition, we still burden ourselves with exception handling, so that this simple program has a zest. <br><div class="spoiler">  <b class="spoiler_title">Throwing 2 dice</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/8b6/986/00c/8b698600c91b82e35be8f5cd22209c3e.jpg"></div></div><br>  As we can see, everything is quite transparent, and the main part of the code is occupied by these same exams ... Let's look at the result of the program: <br><div class="spoiler">  <b class="spoiler_title">Klats</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ce9/10b/283/ce910b283c40e67024e536178b928a9f.jpg"></div><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/f75/db8/5d3/f75db85d3d17e38d6deb3a8e98ea676a.jpg"><br></div></div><br>  Note that the "triple" loss of 2 and 4 per sample of 10 events is an exclusive case, with a very small probability. <br>  Thus, we played a pseudo-random discrete value by means of WM according to the algorithm given below. <br><div class="spoiler">  <b class="spoiler_title">Algorithm</b> <div class="spoiler_text"><ol><li>  It is necessary to divide the interval (0,1) into n - intervals whose lengths are equal <img src="https://habrastorage.org/getpro/habr/post_images/3cd/2db/356/3cd2db35685e5a04cbdc6743dad04087.gif">  respectively. </li><li>  Playing the value of a standard random variable <img src="https://habrastorage.org/getpro/habr/post_images/ca7/554/8f3/ca75548f334f639c728e9ade3b5721bd.gif">  (Standard <abbr title="random number pseudo generator">PRNG</abbr> ). </li><li>  Checking the condition of hitting values <img src="https://habrastorage.org/getpro/habr/post_images/ca7/554/8f3/ca75548f334f639c728e9ade3b5721bd.gif">  in the i-th interval, long <img src="https://habrastorage.org/getpro/habr/post_images/c5a/b99/391/c5ab99391134ef4328139f946ca9383b.gif">  : <img src="https://habrastorage.org/getpro/habr/post_images/380/239/38f/38023938ffb80145f92af6349128ac1c.jpg">  . <br>  If the inequality is true, then we assign to the random variable œá the value corresponding to the given interval ie <img src="https://habrastorage.org/getpro/habr/post_images/1e0/4dd/e0f/1e04dde0fdaeb1915530f83f48e6153a.gif"></li><li>  If necessary, repeat steps 1‚Äì3 several times using new values ‚Äã‚Äãof the standard value Œ≥ to obtain other values ‚Äã‚Äãof a discrete random variable with a law of probability distribution. </li></ol><br></div></div><br><h4>  Neumann Method </h4><br>  Next we turn to playing out continuous random variables with the required probability density, as promised, by the Neumann method.  In addition to the method of Neumann, there are also methods of superposition and inverse function, but the story about them is not the purpose of the article.  And so, we set ourselves the next task: ‚ÄúUsing the Neumann method, play a random variable with a distribution density: <img src="https://habrastorage.org/getpro/habr/post_images/1f6/cff/d69/1f6cffd690941df41815b631a0cad1a3.gif">  on the interval x (0,1) ". <br>  Usually, physicists do not automate such things, but calculate everything in advance, then simply drive them through the cycle and get a sample.  I, as a 21st century physicist, having powerful computer algebra systems in my arsenal, tried to automate the process.  Let's see what came of it. <br><div class="spoiler">  <b class="spoiler_title">Neyman</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/aa0/f8a/242/aa0f8a242aeb467e68e57aeb965db059.jpg"></div></div><br>  We see that everything is quite simple, just like in the book.  The only thing that I would like to note is that for monotonically increasing or decreasing functions, which may be the required probability density type of quark-antiquaque anihilation, it is unlikely that we can find the search for the optimal value for the Neumann constant without exceptions.  the values ‚Äã‚Äãat the ends of the segments will always increase, which will be marked by WM warnings and, as a result, it will not be possible to embed it in the program block.  The normalization constant <b>with is</b> calculated from the condition <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1cb/618/493/1cb61849347c4fe8ef90b280f722ac79.jpg"></div><br><div class="spoiler">  <b class="spoiler_title">Neumann's algorithm</b> <div class="spoiler_text">  This method is based on the following theorem from mathematical statistics and probability theory.  Let be <img src="https://habrastorage.org/getpro/habr/post_images/5e6/f90/c05/5e6f90c0565e69e96adee1f4bd60c8b1.gif">  -random value, with distribution density p (x) ‚â§ <b>c</b> ( <b>c</b> is some positive number) on the interval a &lt;x &lt;b, then if <img src="https://habrastorage.org/getpro/habr/post_images/e0b/635/e65/e0b635e65530ade8a8bbc91be2cb7b55.gif">  and <img src="https://habrastorage.org/getpro/habr/post_images/a3e/079/b00/a3e079b00e7861a6a939ae233e859097.gif">  - independent random variables and <img src="https://habrastorage.org/getpro/habr/post_images/31f/1b9/0bd/31f1b90bd44b5027c8670f92cb78bd58.gif">  , <img src="https://habrastorage.org/getpro/habr/post_images/539/3e1/66f/5393e166f4cd5d491392e8dae6960c3d.gif">  then a random variable <img src="https://habrastorage.org/getpro/habr/post_images/5e6/f90/c05/5e6f90c0565e69e96adee1f4bd60c8b1.gif">  determined by the condition: <img src="https://habrastorage.org/getpro/habr/post_images/5e9/209/6a6/5e92096a60a6dc87831fadc1a4e66280.gif">  , if a <img src="https://habrastorage.org/getpro/habr/post_images/299/6cc/c4c/2996ccc4c4c0a848c86e7d20630854fa.gif">  and has a probability density of p (x). <br><ol><li>  We get a couple of values <img src="https://habrastorage.org/getpro/habr/post_images/e0b/635/e65/e0b635e65530ade8a8bbc91be2cb7b55.gif">  , <img src="https://habrastorage.org/getpro/habr/post_images/a3e/079/b00/a3e079b00e7861a6a939ae233e859097.gif">  with the help of PRNG. </li><li>  With their help, we build two random numbers <img src="https://habrastorage.org/getpro/habr/post_images/31f/1b9/0bd/31f1b90bd44b5027c8670f92cb78bd58.gif">  uniformly distributed on the interval (a, b) and <img src="https://habrastorage.org/getpro/habr/post_images/539/3e1/66f/5393e166f4cd5d491392e8dae6960c3d.gif">  uniformly distributed on the interval (0, c) </li><li>  Using the constructed numbers, we check the condition <img src="https://habrastorage.org/getpro/habr/post_images/299/6cc/c4c/2996ccc4c4c0a848c86e7d20630854fa.gif"></li><li>  If the condition is satisfied, then we assume that the value of a random variable <img src="https://habrastorage.org/getpro/habr/post_images/5e6/f90/c05/5e6f90c0565e69e96adee1f4bd60c8b1.gif">  equally <img src="https://habrastorage.org/getpro/habr/post_images/5f7/4e8/d9f/5f74e8d9f4e75619be68ab5f6a2504f0.gif">  if the condition is not met <br>  then repeat the procedure from step 1. </li></ol><br></div></div><br>  Now we generate 10 kilo-events using our method and build a histogram, simultaneously comparing it with the required probability density <img src="https://habrastorage.org/getpro/habr/post_images/c8e/fd5/e33/c8efd5e33d745dea9e5ea3d008f057e9.jpg">  . <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aba/bc6/bc6/ababc6bc6e3889097acd32a3981a6fea.jpg"></div><br>  As you can see, the result exceeds all expectations!  The effectiveness of this approach is the probability that the random value obtained using a set of standard random numbers ( <img src="https://habrastorage.org/getpro/habr/post_images/e0b/635/e65/e0b635e65530ade8a8bbc91be2cb7b55.gif">  , <img src="https://habrastorage.org/getpro/habr/post_images/a3e/079/b00/a3e079b00e7861a6a939ae233e859097.gif">  , ..., <img src="https://habrastorage.org/getpro/habr/post_images/706/885/185/706885185aa83c874c994c3c24ca1ddf.gif">  ) will be accepted, not discarded.  For the Neumann method, it is easy to find that <img src="https://habrastorage.org/getpro/habr/post_images/469/eb1/cde/469eb1cde492c807593c75f115ddd811.jpg"><br><h4>  Compton scattering of photons </h4><br>  We now turn to the final part of this article and see how MMK works in the FEC.  To do this, we will not get into the wilds, but we will model the process of scattering a gamma-quantum on an electron that is known to everyone from school.  In order not to reinvent the wheel, we‚Äôll visit CERN, or rather in the Geant4 section, without any embarrassment, write off the Butler‚Äôs decomposition in the physics manual (yes, yes, the one I‚Äôm missing) and add formulas for calculating the secondary cosines and angles particles in <abbr title="laboratory coordinate system">lsk</abbr> .  I will not give calculations and do copy-paste because  everything will be in the algorithm. <br><div class="spoiler">  <b class="spoiler_title">Compton scattering</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/c99/e0e/8bd/c99e0e8bdd7a4c21e876e43b651bef64.jpg"></div></div><br>  The differential cross section of this process is described by the Klein-Nishina formula - this is exactly the density of probabilities that we need: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/97e/26b/cbf/97e26bcbfc9ad691d5dec6b3cbdc34e0.jpg"></div><br>  We will conduct 10 kilo-events and construct the energy and angular distributions of secondary particles for the values ‚Äã‚Äãof two energies 0.5 and 1.5 MeV, respectively. <br><img src="https://habrastorage.org/getpro/habr/post_images/b1e/d37/cf1/b1ed37cf10201f4359eade5a0d97e106.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/0ef/658/0cf/0ef6580cfb756f12dc87c697cceea61e.jpg"><br>  How we can estimate on fingers, everything is very well considered and corresponds to the kinematics of the process, and therefore the method is very good. <br><h4>  Conclusion </h4><br>  It turns out that everything is simple enough, the main thing is to figure it out. I would like to tell you more, but I think a large amount will only bore anyone who is interested, I think they will look for literature - it‚Äôs great written in the manual I pulled from CERN, and even better from our teachers in the books.  All calculations were performed in the natural calculus system and laboratory coordinate system. <br><h4>  Literature </h4><br><ol><li>  <a href="http://geant4.web.cern.ch/geant4/G4UsersDocuments/UsersGuides/PhysicsReferenceManual/html/PhysicsReferenceManual.html">geant4.web.cern.ch/geant4/G4UsersDocuments/UsersGuides/PhysicsReferenceManual/html/PhysicsReferenceManual.html</a> </li><li>  Andreev, V. V. ‚ÄúThe Monte Carlo method in particle physics‚Äù.  Curriculum special course, 2005. - 15 p. </li></ol><br><h4>  Links </h4><br>  Used Wolfram Mathematica 9.0 <br><ol><li>  <a href="">.nb Cubes</a> <br></li><li>  <a href="">.nb Neumann</a> <br></li><li>  <a href="">.nb compton</a> <br></li></ol></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/208666/">https://habr.com/ru/post/208666/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208650/index.html">Containers are the future of clouds.</a></li>
<li><a href="../208652/index.html">The Ministry of Culture proposes to impose heavy fines for violating the procedure for blocking pirated content</a></li>
<li><a href="../208658/index.html">GDC Europe and Gamescom - which is more useful?</a></li>
<li><a href="../208662/index.html">Twitter app. Sending tweets and private messages</a></li>
<li><a href="../208664/index.html">Rust 0.9 released</a></li>
<li><a href="../208672/index.html">VKontakte service is not available (at all)</a></li>
<li><a href="../208676/index.html">IPOP - IP over P2P</a></li>
<li><a href="../208678/index.html">Convenient URL generation (CNC). Laravel 4 + third-party packages</a></li>
<li><a href="../208680/index.html">Writing a web service on Go (part one)</a></li>
<li><a href="../208684/index.html">Converting a uniformly distributed random variable to a normally distributed one</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>