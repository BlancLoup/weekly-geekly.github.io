<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Carousel on Vanilla.JS. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. Today we will add the following features to our slider: 



- Obsession roundabout; 
- Automatic slide switching; 
- Touch events; 
- Mouse ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Carousel on Vanilla.JS. Part 2</h1><div class="post__text post__text-html js-mediator-article">  Good day.  Today we will add the following features to our slider: <br><br><ul><li>  Obsession roundabout; </li><li>  Automatic slide switching; </li><li>  Touch events; </li><li>  Mouse events. </li></ul><br>  The first part is <a href="https://habrahabr.ru/post/327246/">here</a> .  The markings of the carousel and its styles will remain the same.  But JS rewrite. <br><a name="habracut"></a><br>  Let's start by creating a renewable timer: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Timer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">callback, delay</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* Private properties */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> timerId, start, remaining = delay; <span class="hljs-comment"><span class="hljs-comment">/* Public methods */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resume = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { start = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(); timerId = setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { remaining = delay; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resume(); callback(); }, remaining); }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pause = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { clearTimeout(timerId); remaining -= <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>() - start; }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.become = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { clearTimeout(timerId); remaining = delay; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resume(); }; <span class="hljs-comment"><span class="hljs-comment">/* Constructor */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resume(); }</code> </pre> <br>  Now we will write the carousel constructor function, its private properties and methods: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Carousel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">setting</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* Scope private methods and properties */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> private = {}, xDown, yDown, xUp, yUp, xDiff, yDiff; <span class="hljs-comment"><span class="hljs-comment">/* Private properties */</span></span> private.default = { <span class="hljs-string"><span class="hljs-string">"touch"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"autoplay"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"autoplayDelay"</span></span>: <span class="hljs-number"><span class="hljs-number">3000</span></span>, <span class="hljs-string"><span class="hljs-string">"pauseOnFocus"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"pauseOnHover"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }; private.setting = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(private.default, setting); private.isAnimationEnd = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; private.sel = { <span class="hljs-string"><span class="hljs-string">"wrap"</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(private.setting.wrap), <span class="hljs-string"><span class="hljs-string">"children"</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(private.setting.wrap).children, <span class="hljs-string"><span class="hljs-string">"prev"</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(private.setting.prev), <span class="hljs-string"><span class="hljs-string">"next"</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(private.setting.next) }; private.opt = { <span class="hljs-string"><span class="hljs-string">"position"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"max_position"</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(private.setting.wrap).children.length }; <span class="hljs-comment"><span class="hljs-comment">/* Constructor */</span></span> <span class="hljs-comment"><span class="hljs-comment">// Clone first elem to end wrap private.sel.wrap.appendChild(private.sel.children[0].cloneNode(true)); // Autoplay if(private.setting.autoplay === true) { private.timer = new Timer(this.next_slide, private.setting.autoplayDelay); } // Control if(private.sel.prev !== null) { private.sel.prev.addEventListener('click', () =&gt; { this.prev_slide(); }); } if(private.sel.next !== null) { private.sel.next.addEventListener('click', () =&gt; { this.next_slide(); }); } // Touch events if(private.setting.touch === true) { private.sel.wrap.addEventListener('touchstart', private.hts, false); private.sel.wrap.addEventListener('touchmove', private.htm, false); } // Pause on hover if(private.setting.autoplay === true &amp;&amp; private.setting.pauseOnHover === true) { private.sel.wrap.addEventListener('mouseenter', () =&gt; { private.timer.pause(); }); private.sel.wrap.addEventListener('mouseleave', () =&gt; { private.timer.become(); }); } private.hts = (e) =&gt; { xDown = e.touches[0].clientX; yDown = e.touches[0].clientY; }; private.htm = (e) =&gt; { if ( ! xDown || ! yDown ) { return; } xUp = e.touches[0].clientX; yUp = e.touches[0].clientY; xDiff = xDown - xUp; yDiff = yDown - yUp; if ( Math.abs( xDiff ) &gt; Math.abs( yDiff ) ) { if ( xDiff &gt; 0 ) { this.next_slide(); } else { this.prev_slide(); } } xDown = 0; yDown = 0; }; }</span></span></code> </pre><br>  The hts and htm methods are needed to handle touch events.  Hts will be called when touchStart.  Htm in event touchMove and, depending on the direction of the mov, call the method of the previous or next slide. <br><br>  Now we will write public methods: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Prev slide this.prev_slide = () =&gt; { if(!private.isAnimationEnd) { return; } private.isAnimationEnd = false; --private.opt.position; if(private.opt.position &lt; 0) { private.sel.wrap.classList.add('s-notransition'); private.sel.wrap.style["transform"] = `translateX(-${private.opt.max_position}00%)`; private.opt.position = private.opt.max_position - 1; } setTimeout(() =&gt; { private.sel.wrap.classList.remove('s-notransition'); private.sel.wrap.style["transform"] = `translateX(-${private.opt.position}00%)`; }, 10); private.sel.wrap.addEventListener('transitionend', () =&gt; { private.isAnimationEnd = true; }); if(private.setting.autoplay === true) { private.timer.become(); } }; // Next slide this.next_slide = () =&gt; { if(!private.isAnimationEnd) { return; } private.isAnimationEnd = false; if(private.opt.position &lt; private.opt.max_position) { ++private.opt.position; } private.sel.wrap.classList.remove('s-notransition'); private.sel.wrap.style["transform"] = `translateX(-${private.opt.position}00%)`; private.sel.wrap.addEventListener('transitionend', () =&gt; { if(private.opt.position &gt;= private.opt.max_position) { private.sel.wrap.style["transform"] = 'translateX(0)'; private.sel.wrap.classList.add('s-notransition'); private.opt.position = 0; } private.isAnimationEnd = true; }); if(private.setting.autoplay === true) { private.timer.become(); } };</span></span></code> </pre><br>  Demo: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://codepen.io/iGetPass/embed/preview/oWWmoE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  It's all!  Less third-party lib =&gt; less traffic for the user =&gt; faster page load. </div><p>Source: <a href="https://habr.com/ru/post/327690/">https://habr.com/ru/post/327690/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327680/index.html">Crowd Marketing: Top 10 Popular Questions</a></li>
<li><a href="../327682/index.html">Encryption in EXT4. How it works?</a></li>
<li><a href="../327684/index.html">How to raise your i2p-site (eepsite) on VDS (VPS) under Ubuntu (LAMP). Briefing for beginners</a></li>
<li><a href="../327686/index.html">Structure and execution model of .NET Core applications</a></li>
<li><a href="../327688/index.html">Structural Classification: Examples and Misconceptions</a></li>
<li><a href="../327692/index.html">Java, first cup</a></li>
<li><a href="../327694/index.html">Search in the Django REST Framework using Elasticsearch</a></li>
<li><a href="../327698/index.html">How to share the environment for building and running a service in Docker today and how to do it tomorrow</a></li>
<li><a href="../327700/index.html">SVG sprite with webpack in one line</a></li>
<li><a href="../327702/index.html">So why all the same need Refresh tokens in OAuth?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>