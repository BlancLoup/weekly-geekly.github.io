<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security starts with a home router</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The author of the article is Security Solutions Architect in the CERT division. 

 Recently, VPNFilter has attracted much attention, especially after ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security starts with a home router</h1><div class="post__text post__text-html js-mediator-article">  <font color="gray">The author of the article is Security Solutions Architect in the CERT division.</font> <br><br>  Recently, <a href="https://en.wikipedia.org/wiki/VPNFilter">VPNFilter has</a> attracted much attention, especially after the <a href="https://www.ic3.gov/media/2018/180525.aspx">public announcement by the FBI</a> on May 25 and a <a href="https://blog.talosintelligence.com/2018/05/VPNFilter.html">number of ads from device manufacturers and security companies</a> .  Consider the VPNFilter malware: what vulnerabilities does it use and how, let's evaluate its impact on the Internet.  I also set out recommendations for device manufacturers of the Internet of Things (IoT), including home routers that have become the target of VPNFilter.  Since the article emphasizes the priority of several critical vulnerabilities, I <a href="https://insights.sei.cmu.edu/sei_blog/2017/03/powered-by-mirai.html">will repeat the recommendations made in March 2017 in the article on the Mirai botnet</a> . <br><br><h2>  Vulnerability History </h2><br>  <a href="https://blog.talosintelligence.com/2018/05/VPNFilter.html">A Cisco blog article</a> on VPNFilter provides details on devices affected by this vulnerability, which affected "at least 500,000 network devices worldwide."  VPNFilter is in some sense similar to Mirai, because it also targets IoT devices, in particular, home routers.  In addition, it is now known that the Mirai botnet used <a href="https://www.wired.com/story/mirai-botnet-minecraft-scam-brought-down-the-internet/amp">four 0day-exploits</a> , in addition to the usual selection of standard login / password pairs to compromise IoT devices.  Recently, a <a href="https://researchcenter.paloaltonetworks.com/2018/07/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/">new version of the</a> Mirai botnet, also aimed at home routers, was discovered. <br><a name="habracut"></a><br>  Among the well-known manufacturers of routers affected by VPNFilter, Linksys and Netgear attracted my attention because, <a href="https://www.statista.com/statistics/798920/united-states-wifi-router-vendor-share/">according to Statistica</a> , their popular models occupy 77% of the home router market.  By exploring the typical vulnerabilities for these popular devices, you can identify some general recommendations that will reduce the risk of attacks on such poorly controlled devices. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The CERT unit at the Institute of Software Engineering (SEI) has collaborated with many manufacturers of home routers to identify and track vulnerabilities.  This collaboration aims to reduce the impact of such vulnerabilities on the Internet as a whole. <br><br>  In the diagram below, I noted and classified vulnerabilities on these devices that are likely to be exploited.  In many cases, <a href="https://www.us-cert.gov/ncas/alerts/TA13-175A">default credentials</a> are also used.  Hackers use these <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/gpon-vulnerabilities-exploited-for-mexico-based-mirai-like-scanning-activities/">vulnerabilities</a> in their toolkit to expand the base of hacked devices. <br><br><img src="https://insights.sei.cmu.edu/sei_blog/security_begins_homerouter_07202018.png"><br><br>  The <a href="https://www.kb.cert.org/vuls">vulnerability database of</a> the CERT Coordination Center has published at least two serious vulnerabilities in routers that have widely affected these two main manufacturers: <br><br><ul><li>  <a href="https://www.kb.cert.org/vuls/id/922681">Multiple buffer overflow vulnerabilities in multiple routers</a> .  A popular library that is used by several router manufacturers has a buffer overflow vulnerability that can be used to compromise a router and install arbitrary programs on it. </li><li>  <a href="https://www.kb.cert.org/vuls/id/582384">Netgear arbitrary remote command injection vulnerabilities</a> .  Numerous Netgear routers are vulnerable to the remote execution of arbitrary commands. </li></ul><br>  These vulnerabilities can be tracked by several exploits that are publicly available on the <a href="http://www.exploit-db.com/">exploit-db.com</a> website.  In some ways, they demonstrate that the software of these devices contains vulnerabilities that can be exploited remotely.  In order to prevent such bugs, it is necessary to apply safe practices when programming.  But it is clear that in mass production, when devices are quickly released to the market, these vulnerabilities are difficult to avoid and almost impossible to eliminate.  We believe that coordination and mitigation due to these shortcomings are essential measures to ensure the reliability and security of the Internet.  But it is possible to take additional measures so that because of these bugs there is no massive hacking and abuse, as it is now. <br><br><h2>  The problem is almost constant uptime </h2><br>  I suspect that if I ask the readers of this article to say when they last rebooted their home router, many would interrupt reading in order to reboot it.  The close to infinite time of continuous operation of modern home routers gives the advantage to attackers who can maintain long-term access to the compromised system, as described in detail in the popular model of the <a href="http://ccss.usc.edu/499/lecture5.html">five stages of hacking</a> . <br><br>  In reality, <a href="https://insights.sei.cmu.edu/sei_blog/2017/03/powered-by-mirai.html">Mirai</a> and VPNFIlter stage-2 malware is an unstable malicious code that does not survive after a reboot.  This fact shows: the attackers are confident that the devices will not restart for a long time. <br><br><h2>  The role of careless maintenance </h2><br>  The second factor that makes the home router vulnerable is the lack of patches or updates.  Updating a home router usually requires a reboot and, probably, a short service interruption.  Many home users never reboot their router because they need uninterrupted daily Internet access for media files, watching videos and even for education.  In many developing countries where routers are supplied by an ISP, he recommends users not to update the device to avoid incompatibility problems.  In other places where the practice of <a href="https://en.wikipedia.org/wiki/Bring_your_own_device">BYOD</a> (using your device) is common, providers are not able to control which equipment is installed in users ( <a href="https://ru.wikipedia.org/wiki/Customer_Premises_Equipment">CPE</a> ). <br><br>  When I recently visited C√¥te d'Ivoire for a lecture on DDoS and botnets, representatives of Internet providers explained that users have cheap routers and even unknown models that the provider cannot update.  Here is another reason why these devices are poorly maintained and never receive the necessary updates or security patches. <br><br><h2>  Call to action </h2><br>  In the <a href="https://insights.sei.cmu.edu/sei_blog/2017/03/powered-by-mirai.html">previous article on Mirai,</a> I offered some recommendations that are practical and available for home routers and IoT devices.  I hope that they will push manufacturers and providers to introduce innovative technical solutions to reduce the risk of using routers for malicious purposes: <br><br><ol><li>  Installing file systems in home routers and read-only Internet of Things devices makes it difficult to install malware. </li><li>  Disabling any batch mode, spoofing, or "illegible" mode [in which the network card allows you to receive all packets, regardless of who they are addressed to - approx.  trans.] at the firmware level to avoid malicious use of a network resource on these devices. </li><li>  Automatic firmware update for proactively resolving vulnerabilities ‚Äî either with scheduled downtime or no downtime. </li></ol><br>  The task of these simple and inexpensive devices is to transmit data over the network or stream the stream in real time (like IP cameras), there is no particular reason to keep some software on the device.  In fact, some of the new home routers support <a href="https://en.wikipedia.org/wiki/Chroot">chroot</a> and the read-only file system, which makes it difficult to install exploits.  Even if a potential attacker finds out or guesses the administrator password, he will not be able to install a malicious program like VPNFilter or Mirai. <br><br>  In both cases, the malware tries to get full control over the network stack, which allows you to create packets, spoof and intercept packets, and also install a <a href="https://en.wikipedia.org/wiki/Promiscuous_mode">‚Äúillegible‚Äù mode</a> on infected devices.  Such functions on simple routers are not required and usually are not used.  Removing the ‚Äúillegible‚Äù mode will completely eliminate the possibility of using compromised systems for malicious purposes, such as <a href="https://insights.sei.cmu.edu/sei_blog/2016/11/distributed-denial-of-service-attacks-four-best-practices-for-prevention-and-response.html">DDoS attacks</a> , installing malware, intercepting messages and changing network packets. <br><br><h2>  Other recommendations </h2><br>  In addition to the recommendations above, there are other practical recommendations that can help both device manufacturers and providers.  Automatic updates are now implemented on many devices - they have become an integral part of smartphones, tablets and PCs.  Some of these updates are non-disruptive. <br><br>  In cases where a service interruption is required (for example, a reboot), the user should be able to request a preferred period of time, for example, midnight local time or a day off to ensure minimal interruption of service.  This type of update is required for devices such as home routers and IoT devices. <br><br>  If manufacturers and providers manage to implement incremental updates without rebooting, and if they can introduce new methods, such as installing real-time patches ( <a href="https://en.wikipedia.org/wiki/Kpatch">kpatch</a> ) on vulnerable systems, then it is even more convenient.  If a reboot is required, manufacturers and providers can provide their customers with a choice of updates to deliver the least inconvenience while keeping devices up-to-date. <br><br><h2>  Recommendations for users </h2><br>  The first and most important recommendation is to <a href="https://www.consumeraffairs.com/news/reminder-change-the-default-password-on-your-home-router-before-a-hacker-does-022715.html">change the default credentials</a> on the home router.  Then update and reboot your home router and other Internet of Things in-home devices.  A weekly reset of the home router is not too burdensome and may even improve its performance. <br><br>  If you like a well-protected home, do not forget to take care of its digital security, and it starts with a home router. </div><p>Source: <a href="https://habr.com/ru/post/418917/">https://habr.com/ru/post/418917/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../418907/index.html">How to teach Zabbix to send problem notifications directly to the desktop</a></li>
<li><a href="../418909/index.html">"Python takes the lead": who uses it and why</a></li>
<li><a href="../418911/index.html">[DotNetBook] Span: new .NET data type</a></li>
<li><a href="../418913/index.html">UE4 | Inventory for Multiplayer # 1 | Data Store on DataAsset</a></li>
<li><a href="../418915/index.html">Balancing traffic between web servers using IP CEF on network equipment</a></li>
<li><a href="../418919/index.html">On the professional growth of the designer and work with stress. And how to find strength in the most difficult times</a></li>
<li><a href="../418921/index.html">4 libraries that simplify the life of a React-developer</a></li>
<li><a href="../418923/index.html">PWA is just</a></li>
<li><a href="../418925/index.html">Big Data - Bro or Not Bro</a></li>
<li><a href="../418927/index.html">Amazon's dark patterns</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>