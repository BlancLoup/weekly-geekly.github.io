<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mathematical Foundations of Bitcoin Blockchain</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, bitcoin continues to gain popularity, and the industry to develop all new applications for working with cryptocurrency. One of the reasons for ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mathematical Foundations of Bitcoin Blockchain</h1><div class="post__text post__text-html js-mediator-article">  Today, bitcoin continues to gain popularity, and the industry to develop all new applications for working with cryptocurrency.  One of the reasons for this popularity is the rigorous mathematical base on which bitcoin is built. <br><br>  Due to this, the system functions in conditions of complete lack of trust between the network participants, excluding the impact of the human factor. <br><br>  Therefore, in today's article we would like to talk about the mathematical foundations of Bitcoin blockchain - elliptic curves, ECDSA and keys. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="https://habrahabr.ru/company/bitfury/blog/340378/"><img src="https://habrastorage.org/webt/59/df/43/59df43e9d01cd724110301.jpeg"></a> <a name="habracut"></a>  <i>/ Image of <a href="https://www.flickr.com/photos/hernanpc/7236866948/">Hern√°n Pi√±era</a> <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY</a></i> <br><br>  The fundamental part of Bitcoin <a href="http://www.coindesk.com/math-behind-bitcoin/">are</a> cryptographic algorithms.  In particular, the ECDSA algorithm is an Elliptic Curve Digital Signature Algorithm, which uses elliptic curves and finite fields to sign data so that a third party can confirm the authenticity of the signature by eliminating the possibility of falsification.  ECDSA uses different procedures for signing and verification, consisting of several arithmetic operations. <br><br><h2>  Elliptic curves </h2><br>  The elliptic curve over the field K is a cubic curve over the algebraic closure of the field K, defined by a third-degree equation with coefficients from the field K and a ‚Äúpoint at infinity‚Äù.  One form of elliptic curves are Weierstrass curves. <br><br>  y¬≤ = x¬≥ + ax + b <br><br>  For coefficients a = 0 and b = 7 (used in Bitcoin), the graph of the function takes the following form: <br><br><img src="https://habrastorage.org/webt/59/df/44/59df44ff7aef2207577028.png" width="300" align="left"><br clear="all">  <i>Elliptical curve</i> <br><br>  Elliptic curves have several interesting properties, for example, a non-vertical line intersecting two non-tangent points on a curve will cross a third point on a curve.  <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25BB%25D0%25B8%25D0%25BF%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25BA%25D1%2580%25D0%25B8%25D0%25B2%25D0%25B0%25D1%258F">The sum of two points on the</a> P + Q <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25BB%25D0%25B8%25D0%25BF%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25BA%25D1%2580%25D0%25B8%25D0%25B2%25D0%25B0%25D1%258F">curve</a> is called the R point, which is a reflection of the -R point (constructed by continuing the straight line (P; Q) to the intersection with the curve) relative to the X axis. <br><br><img src="https://habrastorage.org/webt/59/df/45/59df4538cab24149219297.png" width="300" align="left"><br clear="all">  <i>The sum of two points on the curve ( <a href="http://www.coindesk.com/math-behind-bitcoin/">source</a> )</i> <br><br>  If we draw a straight line through two points that have coordinates of the form P (a, b) and Q (a, -b), then it will be parallel to the ordinate axis.  In this case there will be no third intersection point.  To solve this problem, a so-called point at infinity (point of infinity) is introduced, denoted as O. Therefore, if there is no intersection, the equation takes the following form P + Q = O. <br><br>  If we want to add the point to itself (double it), then in this case the tangent to the point Q is simply drawn. The resulting intersection point is reflected symmetrically with respect to the X axis. <br><br><img src="https://habrastorage.org/webt/59/df/45/59df457f870ba984214293.png" width="300" align="left"><br clear="all">  <i>Double point ( <a href="http://www.coindesk.com/math-behind-bitcoin/">source</a> )</i> <br><br>  These operations allow scalar multiplication of the point R = k * P, adding the point P with itself k times.  However, note that faster methods are used to work with large numbers. <br><br><h2>  Elliptic curve over a finite field </h2><br>  In elliptical cryptography (ECC), the same curve is used, only considered over some finite field.  The final field in the context of the ECC can be represented as a predefined set of positive numbers, which should be the result of each calculation. <br><br>  y¬≤ = x¬≥ + ax + b (mod p) <br><br>  For example, 9 mod 7 = 2. Here we have a finite field from 0 to 6, and all operations modulo 7, no matter how many times they are carried out, will give a result that falls in this range. <br><br>  All the properties mentioned above (addition, multiplication, point at infinity) for such a function remain in force, although the graph of this curve will not resemble an elliptic curve.  The Bitcoin elliptic curve, y¬≤ = x¬≥ + 7, defined on a finite field modulo 67, looks like this: <br><br><img src="https://habrastorage.org/webt/59/df/47/59df47da2d306547493164.png" width="300" align="left"><br clear="all">  <i>Bitcoin elliptic curve defined on a finite field modulo 67 ( <a href="http://www.coindesk.com/math-behind-bitcoin/">source</a> )</i> <br><br>  This is a set of points where all values ‚Äã‚Äãof x and y are integers between 0 and 66. The straight lines drawn on this graph will now ‚Äúwrap‚Äù around the field as soon as they reach barrier 67 and continue from the other end of it. while maintaining the same slope, but with a shift.  For example, the addition of points (2, 22) and (6, 25) in this particular case looks like this: <br><br><img src="https://habrastorage.org/webt/59/df/48/59df484c09ecb520383377.png" width="300" align="left"><br clear="all">  <i>Addition of points (2, 22) and (6, 25) ( <a href="http://www.coindesk.com/math-behind-bitcoin/">source</a> )</i> <br><br>  If you want to see what other elliptic curves look like, you can experiment on this <a href="https://cdn.rawgit.com/andreacorbellini/ecc/920b29a/interactive/modk-add.html">site</a> . <br><br><h2>  Bitcoin ECDSA </h2><br>  The Bitcoin protocol contains a set of parameters for an elliptic curve and its finite field, so that each user uses a well-defined set of equations.  Among the fixed parameters, the equation of the curve (equation), the value of the field modulus (prime modulo), the base point on the curve (base point) and the order of the base point (order) are distinguished.  About calculating the order of the base point you can read <a href="http://bit.nmu.org.ua/ua/student/metod/cryptology/%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2586%25D0%25B8%25D1%258F16.pdf">here</a> .  This parameter is chosen specifically and is a very large prime number. <br><br>  In the case of bitcoin <a href="https://www.slideshare.net/NikeshMistry1/introduction-to-bitcoin-and-ecdsa">, the</a> following values ‚Äã‚Äãare used: <br><br>  The equation of an elliptic curve: y¬≤ = x¬≥ + 7 <br><br>  Simple module: 2 <sup>256</sup> - 2 <sup>32</sup> - 2 <sup>9</sup> - 2 <sup>8</sup> - 2 <sup>7</sup> - 2 <sup>6</sup> - 2 <sup>4</sup> - 1 = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFC2F <br><br>  Base point: <br><br>  04 <b>79BE667E F9DCBBAC 55A06295 CE870B07 029BFCDB 2DCE28D9 59F2815B 16F81798</b> 483ADA77 26A3C465 5DA4FBFC 0E1108A8 FD17B448 A6855419 9C47D08F FB10D4B8 <br><br>  The bold font is the x coordinate in hexadecimal notation.  It is immediately followed by the Y coordinate. <br><br>  Order: FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE BAAEDCE6 AF48A03B BFD25E8C D0364141 <br><br>  This set of parameters for an elliptic curve is known as secp256k1 and is part of the SEC (Standards for Efficient Cryptography) family of standards proposed for use in cryptography.  In Bitcoin, the secp256k1 curve is used in conjunction with the ECDSA (elliptic curve digital signature algorithm).  In ECDSA, a secret key is a random number between one and an order value.  The public key <a href="http://royalforkblog.github.io/2014/09/04/ecc/">is generated</a> based on the secret: the latter is multiplied by the value of the base point.  The equation has the following form: <br><br>  Public key = private key * G <br><br>  This shows that the maximum number of secret keys (therefore bitcoin addresses) is, of course, equal to the order.  However, the order is an incredibly large number, so it is unrealistic to accidentally or intentionally pick up another user's secret key. <br><br>  The public key is calculated using the same doubling and adding points operations.  This is a trivial task that an ordinary personal computer or smartphone solves in milliseconds.  But the inverse problem (obtaining a secret key publicly) is a problem of <a href="https://en.wikipedia.org/wiki/Discrete_logarithm">discrete logarithmization</a> , which is considered computationally complex (although there is no strict proof of this fact).  The best known algorithms for its solution, like <a href="https://en.wikipedia.org/wiki/Pollard%2527s_rho_algorithm_for_logarithms">Pollard's ro</a> , have exponential complexity.  For secp256k1, to solve the problem, you need about <sup>2,128</sup> operations, which will require a computation time on a regular computer, comparable to the lifetime of the Universe. <br><br>  When a private / public key pair is obtained, it can be used to sign data.  This data can be of any length.  Usually, the first step <a href="http://www.intuit.ru/studies/courses/28/28/lecture/20430%3Fpage%3D2">is to</a> hash the data in order to obtain a unique value with the number of bits equal to the bit order of the curve (256).  After hashing, the z data signing algorithm is as follows.  Here, G is the base point, n is the order, and d is the secret key. <br><br><ul><li>  Some integer k is selected from 1 to n-1 </li><li>  Calculate the point (x, y) = k * G using scalar multiplication </li><li>  Is r = x mod n.  If r = 0, then return to step 1 </li><li>  There is s = (z + r * d) / k mod n.  If s = 0, then return to step 1 </li><li>  The resulting pair (r, s) is our signature. </li></ul><br>  After receiving the data and signing it, a third party, knowing the public key, can verify it.  The steps to verify the signature are as follows (Q is the public key): <br><br><ul><li>  Check that both r and s are in the range from 1 to n-1 </li><li>  Calculated w = s <sup>-1</sup> mod n </li><li>  Calculated u = z * w mod n </li><li>  Calculated v = r * w mod n </li><li>  Calculate the point (x, y) = uG + vQ </li><li>  If r = x mod n, then the signature is true, otherwise it is invalid. </li></ul><br>  Indeed, <br><br>  uG + vQ = u + vdG = (u + vd) G = (zs <sup>-1</sup> + rds <sup>-1</sup> ) G = (z + rd) s <sup>-1</sup> G = kG <br><br>  The last equality uses the definition of s at the stage of creating a signature. <br><br>  ECDSA security is related to the complexity of the secret key search task described above.  In addition, the security of the original scheme depends on the ‚Äúrandomness‚Äù of the choice of k when creating a signature.  If the same k value is used more than once, then the secret key can be extracted from the signatures, which is what <a href="https://arstechnica.com/gaming/2010/12/ps3-hacked-through-poor-implementation-of-cryptography/">happened</a> with the PlayStation 3. Therefore, modern implementations of ECDSA, including those used in most bitcoin wallets, generate k <a href="https://tools.ietf.org/html/rfc6979">determinedly</a> based on the secret key and the message being signed. <br><br>  <i>PS Bitfury Group Russia in <a href="https://vk.com/bitfuryrussia">Vk</a> and <a href="https://www.facebook.com/BitfuryRussia/">Fb</a> .</i> </div><p>Source: <a href="https://habr.com/ru/post/340378/">https://habr.com/ru/post/340378/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340368/index.html">Russian laws on new spheres: entertaining facts, or why a dead end is crying</a></li>
<li><a href="../340370/index.html">You fired the most talented employee. I hope you are happy now</a></li>
<li><a href="../340372/index.html">Why SQL prevails over NoSQL, and where it will lead in the future</a></li>
<li><a href="../340374/index.html">Avoiding unnecessary meetings or for the hundredth time about meetings</a></li>
<li><a href="../340376/index.html">Killerphic in vim - these are the modes? Seriously?</a></li>
<li><a href="../340382/index.html">Russian Design Cup 2017</a></li>
<li><a href="../340384/index.html">Creating a component library using Storybook</a></li>
<li><a href="../340386/index.html">SOC for beginners. SOC objectives: monitoring</a></li>
<li><a href="../340388/index.html">ATMii worm allows you to steal money from ATMs</a></li>
<li><a href="../340390/index.html">On the issue of strangeness and the impossible</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>